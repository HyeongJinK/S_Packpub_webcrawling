<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch16lvl1sec177"></a>Running cross-platform T-SQL queries</h2></div></div><hr /></div><p>Thus far, we've seen the steps for <span>loading</span><a id="id325892293" class="indexterm"></a> and configuring SQL Server SMO assembly. Now, let's learn how to expand the cross-platform querying experience using PowerShell Core.</p><p> </p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch16lvl2sec469"></a>Getting ready</h3></div></div></div><p>Instantiate the <code class="literal">Microsoft.SqlServer.Management.Smo.Server</code> class by creating an object. You can create this object using the code:</p><pre class="programlisting"><span class="strong"><strong>PS&gt; New-Object Microsoft.SqlServer.Management.Smo.Server &lt;SQL InstanceName&gt;</strong></span></pre></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch16lvl2sec470"></a>How to do it…</h3></div></div></div><p>Let's connect to a SQL Server instance on a Windows machine from a Linux machine using the SMO object by performing the following steps: </p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Import the <code class="literal">SqlServer</code> module.</li><li>Assign an instance name to a variable called <code class="literal">$SQLServer</code>.</li><li>Initiate the SQL Server object's instantiation for the <code class="literal">Microsoft.SqlServer.Managament.Smo.Server</code> class.</li><li>Define the username and password using <code class="literal">Get-Credential</code> cmdlets.</li><li>Build the SQL Server connection.</li><li>Retrieve the properties of a Windows SQL instance on Linux.</li><li>Format the result set. The following script takes care of the aforementioned tasks:</li></ol></div><pre class="programlisting">$SQLServer='hqdbt01'                                                        
$SQLServerObject=New-Object Microsoft.SqlServer.Management.Smo.Server $SQLServer             
$SQLServerObject.ConnectionContext.LoginSecure=$false                                        
$SQLServerObject.ConnectionContext.set_login("SA")                                           $SQLServerObject.ConnectionContext.set_Password("PackPub@2018")                            
$SQLServerObject.Information | Select-Object FullyQualifiedNetName, Parent, Version, Edition | Format-Table -AutoSize</pre><p> </p><p> </p><p> </p><p> </p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch16lvl2sec471"></a>How it works…</h3></div></div></div><p>The first database name is being assigned to a variable named <code class="literal">$SQLServer</code>. In this case, <code class="literal">hqdbt01</code> is assigned to the variable. Then, create an instance of the object using the <code class="literal">Microsoft.SqlServer.Management.Smo.Server</code> namespace. In the next step, set the object properties based on the authentication type. In this case, the Windows SQL instance is being accessed using mixed-mode authentication. So, set the <code class="literal">ConnectionContext.loginsecure</code> property of the Server object to <code class="literal">$false</code>. This enables the SQL Server to use mixed-mode authentication. This is creating child objects for the parent-object Server property. You'll need to explicitly specify the username and password to build the connection. After logging in using the username and password, the hardcoded values are passed to the <code class="literal">set_login</code> and <code class="literal">set_password</code> methods to build a successful connection.</p><p>Now, select specific columns from the information and format them into a table by using the <code class="literal">Select-Object</code> and <code class="literal">Format-Table</code> cmdlets.</p></div></div>