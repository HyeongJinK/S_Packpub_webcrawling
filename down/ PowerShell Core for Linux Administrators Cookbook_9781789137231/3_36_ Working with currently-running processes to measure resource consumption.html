<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch03lvl1sec43"></a>Working with currently-running processes to measure resource consumption</h2></div></div><hr /></div><p>A good chunk of administration involves working with <span>processes</span><a id="id325901988" class="indexterm"></a> on a given computer. PowerShell contains cmdlets that enable you to work with processes on a computer. In this recipe, we will list out all of the processes running in the system and fetch the amount of resources the processes are collectively consuming.</p><p>In <a class="link" href="#" linkend="ch04">Chapter 4</a>, <span class="emphasis"><em>Passing Data Through Pipelines</em></span>, we will look at other options, such as filtration, using what we learn in this recipe.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec119"></a>How to do it…</h3></div></div></div><p>As we have already discussed, our goal here is to work with <span>processes:</span></p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>List out the cmdlets that help you work with processes:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-Command -Noun Process</strong></span></pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip35"></a>Note</h3><p>Remember that PowerShell uses only singular nouns.</p></div><p>We get five cmdlets. What we initially need is <code class="literal"><span>Get-Process</span></code>.</p><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Run the cmdlet to see what it shows:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-Process</strong></span></pre><p>The output is a long table of processes, the memory they are consuming, the CPU time they are using, and so on.</p><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>Get the total count of processes currently running in the system:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; (Get-Process).Count</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>Fetch the average of the pages of memory used by the processes. The term for this is Working Set, denoted as <code class="literal">WS</code>:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-Process | Measure-Object -Property WS -Average</strong></span></pre><p> </p><div class="orderedlist"><ol class="orderedlist arabic" start="5" type="1"><li>There are other fields in the hash table as well. Let's get all of that information:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-Process | Measure-Object -Property WS -Average -Sum -Minimum -Maximum</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="6" type="1"><li>Get the average, sum, minimum, and maximum for both the <span>working sets</span> as well as the CPU with the help of the command shown in the following screenshot:</li></ol></div><div class="mediaobject"><img src="/graphics/9781789137231/graphics/7bef13b4-34ff-40ab-9694-2a22a89da79b.png" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec120"></a>How it works…</h3></div></div></div><p>The cmdlet, <code class="literal"><span>Get-Process</span></code>, gives out an entire table of all of the processes running in the system. Think of each row as an individual object and the entire table as an array of these rows. <code class="literal">Count</code> (or in other words, length) is, logically, a property of an array. Therefore, we call the cmdlet and, on the object that is output, we run a <span>counting</span><a id="id325905976" class="indexterm"></a> operation. This gives us how many processes are running in the system at the moment.</p><p>The next cmdlet we see is an important one, as well: <code class="literal">Measure-Object</code>. This cmdlet is designed to perform measurements on the objects that are output. In our case, we pick the <code class="literal">WS</code> property to perform measurements on. If no property is specified, PowerShell will pick the property based on its definition in the output object.</p><p> </p><p><code class="literal">Measure-Object</code> is capable of performing some neat arithmetic calculations on the output object. We use this capability of the cmdlet to fetch the average first and then the sum, the minimum value, and the maximum value as well. The <code class="literal">Property</code> parameter accepts a string array as input (<code class="literal">Get-Help Measure-Object -Parameter Property</code>). Therefore, we specify <code class="literal">WS</code> as well as <code class="literal">CPU</code> (separated by commas) in the cmdlet and then perform the measurement operation.</p></div></div>