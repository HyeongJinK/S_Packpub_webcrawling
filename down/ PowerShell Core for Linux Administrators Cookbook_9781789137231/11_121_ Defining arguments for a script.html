<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch11lvl1sec120"></a>Defining arguments for a script</h2></div></div><hr /></div><p>Scripts help with a good amount of automation. Most <span>administrators</span><a id="id325892156" class="indexterm"></a> that I have come across like to create self-contained scripts. However, this means that you have to hardcode a lot of information that you may not want someone to read, such as passwords or keys. This is a limitation with scripts that contain everything in them. Of course, another way to handle such a situation is to use secure files such as a CLI XML with the password or key stored as a secure string, which will work only on that computer, only with your sign-in. But then, what if someone else wanted to use your script with their credentials?</p><p>You get the point. Hardcoding certain things is not a very flexible way to do this—it kills modularity. The other option available to us is to prompt the user for such information. But what if you were writing a script to be used unattended? What if you had your credentials in a secure location stored as a secure CLI XML, but had to use a script stored in a location that is accessible to everyone, and you had to call your script in an unattended mode? What if you could pass arguments to scripts just like you could with cmdlets?</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note71"></a>Note</h3><p>At the time of writing this book, conversion to and from secure strings does not work on PowerShell on Linux. However, this is expected to be fixed in an upcoming release.</p></div><p>Modify the countdown script to accept <code class="literal">TotalTime</code> as an argument, with the default value being 25. Call this script for a countdown from 40.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch11lvl2sec315"></a>How to do it…</h3></div></div></div><p>The difference between the previous script and the one you need to write now is only one line:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Create a copy of the script that you created for the <span class="emphasis"><em>Showing progress of execution</em></span> recipe.</li><li>Replace the first line, <code class="literal">$TotalTime = 25</code>, with <code class="literal">param ($TotalTime = 25)</code>.</li><li>Switch to the terminal, place an <code class="literal">&amp;</code> and a space, and type in the relative path to the script. Add a space, type a hyphen, and hit the <span class="emphasis"><em>Tab</em></span> key. The <code class="literal">TotalTime</code>parameter should auto-resolve.</li></ol></div><p>Now, you can start a seconds-based count to any positive integer you pass to this parameter, like so:</p><div class="mediaobject"><img src="/graphics/9781789137231/graphics/40708951-fd53-45e6-b8ff-3f0ac1f33b45.png" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch11lvl2sec316"></a>How it works…</h3></div></div></div><p>What we did in this recipe was create a parameter for the script. We simply converted a plain vanilla variable into a parameter. A parameter is, in fact, very similar to a variable, except that it can be accessed from outside of the script or function. To convert a variable into a parameter, we place the variable within the <code class="literal">param ()</code> definition.</p><p> </p><p>If a value is assigned to this variable within the <code class="literal">param ()</code> block, this value becomes its default value, which will be used if no value is specified when calling the script. Quite a few parameter <span>options</span><a id="id325585852" class="indexterm"></a> are available when defining a parameter. However, for this recipe, we will stick with the bare basics.</p><p>The working of the rest of the script is similar to the one in the <span class="emphasis"><em>Showing progress of execution</em></span> recipe.</p></div></div>