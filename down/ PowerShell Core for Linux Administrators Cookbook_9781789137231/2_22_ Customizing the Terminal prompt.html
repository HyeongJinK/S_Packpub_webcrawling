<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch02lvl1sec30"></a>Customizing the Terminal prompt</h2></div></div><hr /></div><p>In the previous recipe, we customized the error action preference using the profile. We used an already-demonstrated command to show that commands that can be run on the <span>PowerShell</span><a id="id325909508" class="indexterm"></a> console can be added to the profile as well, and this was a way to automate running a certain set of commands which could be used to increase productivity.</p><p>Now, we will take the next step and customize our console prompt. The options are theoretically endless; this recipe is just another demonstration of how flexible PowerShell is.</p><p> </p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec79"></a>Getting ready</h3></div></div></div><p>You need Visual Studio Code for this recipe. If you did not follow along with the last recipe, follow the steps in the <span class="emphasis"><em>Getting ready</em></span> section of the last recipe to create a PowerShell profile; only this time, run the commands at the <strong class="userinput"><code>PowerShell Integrated Console</code></strong> of Visual Studio Code.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec80"></a>How to do it…</h3></div></div></div><p>Ensure that the profile is empty. If you just created the profile, you can simply proceed further. If not, clear all contents in the profile. If the error action preference is set in the profile, it will become hard to troubleshoot scripts that you create in the future:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Enter the following in the main window:</li></ol></div><pre class="programlisting">functionprompt {
$Location=(Get-Location).Path.ToString()
switch-Wildcard ($Location) {
"/home/$env:USERNAME" { $Location='~';break }
"/home/$env:USERNAME/Documents" { $Location='Documents';break }
"/home/$env:USERNAME/Downloads" { $Location='Downloads';break }
"/home/$env:USERNAME/Pictures" { $Location='Pictures';break }
"/home/$env:USERNAME/Videos" { $Location='Videos';break }
"/home/$env:USERNAME/Music" { $Location='Music';break }
"/home/$env:USERNAME/Documents/code" { $Location='Code';break }
"/home/$env:USERNAME/*" { $Location=$Location.Replace("/home/$env:USERNAME/",'~/');break }
    Default { }
  }
Write-Host"PS "-NoNewline
Write-Host`
($($env:USERNAME)+"@"+"$([System.Net.Dns]::GetHostByName((hostname)).HostName) ")`
-NoNewLine -ForegroundColor Cyan
Write-Host"$Location"-NoNewline -ForegroundColor Green
Write-Host("`n&gt; ")-NoNewline
return" "
}</pre><p> </p><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Save the profile script file.</li><li>Click on the little bin icon at the top of the integrated console to kill the current PowerShell session.</li><li>When Visual Studio Code prompts you whether you would like to restart the session, click <strong class="userinput"><code>Yes</code></strong>.</li></ol></div><p>Your prompt should look like the one shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781789137231/graphics/cf193df0-97dc-412d-ab0c-ac14aef29f8a.png" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec81"></a>How it works…</h3></div></div></div><p>The prompt is controlled by a function called <code class="literal">prompt</code>. To demonstrate this, we could use the following:</p><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-Command prompt</strong></span></pre><p>The output shows that there is indeed such a command, which is of the <code class="literal">Function</code> type. To know the contents of the <code class="literal">prompt</code> function, enter the following:</p><pre class="programlisting"><span class="strong"><strong>PS&gt; (Get-Command prompt).ScriptBlock</strong></span></pre><p>The output shows you the entire function you just wrote. This is, however, the function that overrode the default <code class="literal">prompt</code> function. If you clear your profile, restart the PowerShell session, and type in the preceding command; you would see a simple three-liner output, which is the default <code class="literal">prompt</code> function.</p><p>The function we wrote replaces the default script block with our custom code. Here is what you did:</p><p>First, you declare the function you are about to write. This is done using the keyword, <code class="literal">function</code>, followed by the name of the function. Since we want to work with the prompt, we use the existing function name so as to override the default functionality. The next thing that follows is the script block, which starts with a <code class="literal">{</code>.</p><p>We want the location to appear at the prompt. This is must-have information, for obvious reasons.</p><p>If you notice, PowerShell shows the complete <code class="literal">home</code> path at the prompt. While this works, we are used to the tilde for <code class="literal">home</code>. Also, I know that <code class="literal">Documents</code>, <code class="literal">Music</code>, and other folders reside within my <code class="literal">home</code> folder, and I would rather have just the name of the folder appear at the prompt. This would mean some text manipulation. Therefore, I assign the current location to a variable, <code class="literal">$Location</code>.</p><p>Next, we perform a switch-case operation and arrive at the value for what needs to be displayed at the prompt. Do not worry about the syntax for now; we will look at it in the chapters that follow.</p><p>Later, we use a few <code class="literal">Write-Host</code> statements to construct the prompt text. The <code class="literal">-NoNewLine</code> parameter ensures that the contents of each statement do not go to the next line. When we need a line break, we explicitly add <code class="literal">`n</code>.</p><p> </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note30"></a>Note</h3><p>If you want to break a long-running line in a script, use the backtick (<code class="literal">`</code>) character at the point where you would like to break the line and press <span class="emphasis"><em>Enter</em></span> to break the line after the backtick. PowerShell would treat the line with the backtick, as well as the line that follows, as the same line. Similarly, if you would like to write two statements in the same line, use the semicolon (<code class="literal">;</code>) at the end of the first statement and continue with the second after a space. PowerShell will treat both the clauses as separate statements, just like plain English.</p></div><p>Since <code class="literal">Write-Host</code> just sends text to the host and does not return anything, we add a return statement to the function with merely an empty space.</p><p>When we reload the <strong class="userinput"><code><span>PowerShell</span><a id="id325892147" class="indexterm"></a> Integrated Console</code></strong>, the profile is loaded and, this time, the custom <code class="literal">prompt</code> function in the profile overrides the default <code class="literal">prompt</code> function and presents us with a nice prompt, formatted just the way we defined it.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec82"></a>There's more…</h3></div></div></div><p>Play around with the sequences and the contents of the <code class="literal">Write-Host</code> statements for now to customize your prompt. Once we are comfortable with the syntax in PowerShell, we should be able to <span>customize</span><a id="id325892256" class="indexterm"></a> the profile further.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec83"></a>See also</h3></div></div></div><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">about_Prompts (<a class="ulink" href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_prompts?view=powershell-6" target="_blank">https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_prompts?view=powershell-6</a>)</li></ul></div></div></div>