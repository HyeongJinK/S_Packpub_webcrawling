<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch06lvl1sec73"></a>Using basic string methods</h2></div></div><hr /></div><p>We saw a few operators in the introduction to this chapter, of <span>which</span><a id="id326185270" class="indexterm"></a> quite a few were string-related. Some of these capabilities are given within the <code class="literal">System.String</code> object as methods to offer a quicker way to perform some operations—such as splitting strings, joining strings, replacing strings, changing cases, creating substrings, removing substrings, and so on.</p><p>In this recipe, we will look at a few scenarios based on the input file we created in the <span class="emphasis"><em>Understanding Here-Strings</em></span> recipe. A loop will not be required for these actions since they are simple, single operations. We will learn about looping through these files in the <span class="emphasis"><em>Flow Control using Branches and Loops</em></span> chapter so that we can work with more complex scenarios.</p><p>Here are the operations that need to be performed on the input file:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Remove the leading <code class="literal">.</code> in the paths. (Use the file you created from the non-expanding here-string.)</li><li>Trim the path of the leading and trailing <code class="literal">/</code>.</li><li>List out the directories that would be created from each element.</li><li>Get only the number in the name of the fifth directory in the list.</li><li>The directories need to be all uppercase because that's what the boss wants.</li><li>Replace the hyphens with spaces.</li></ol></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec197"></a>Getting ready</h3></div></div></div><p>This recipe assumes that you have sent the output of each of the literal here-strings to the file. If not, follow the <span class="emphasis"><em>Understanding Here-Strings</em></span> recipe and send the output of the non-expanding here-string to the file.</p><p>Run the following to import the contents of the file into a variable:</p><pre class="programlisting"><span class="strong"><strong>PS&gt; $LiteralString = Get-Content ./ch06/03-input-file.txt</strong></span></pre><p> </p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec198"></a>How to do it…</h3></div></div></div><p>Before we dive into the recipe, it is important to remember that these method-based operations work in simple situations. Complex operations may require the operators that we discussed. An example for a non-simple situation is when we have to use regular expressions. Follow these steps to complete this recipe:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>At the Terminal, enter the following code to remove the leading <code class="literal">.</code>. Use an assignment operator to modify the contents of the variable:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; $LiteralString = $LiteralString.TrimStart('.')</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Type in the following code to remove the leading as well as trailing slashes:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; $LiteralString.TrimStart('/').TrimEnd('/')</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>Can we reduce keystrokes (apart from tab-completion, that is)? Keep assigning the results back to the same variable:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; $LiteralString.Trim('/')</strong></span>
<span class="strong"><strong>PS&gt; $LiteralString = $LiteralString.Trim('/')</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>To list out the directories that would be created, use the <code class="literal">split()</code> method. This will create some <span>repeating</span><a id="id325906005" class="indexterm"></a> elements. Select only the unique values:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; $LiteralString = $LiteralString.Split('/') | Select-Object -Unique</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="5" type="1"><li>Now, to get the number from the name, use the following code (do not assign the value back to the variable):</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; $LiteralString[4] # Get the fifth element from the array</strong></span></pre><pre class="programlisting"><span class="strong"><strong>PS&gt; $LiteralString[4].IndexOf('-') # Get the index of the hyphen</strong></span></pre><pre class="programlisting"><span class="strong"><strong>PS&gt; $LiteralString[4].Substring($LiteralString[4].IndexOf('-')) # Get the substring based on the index</strong></span></pre><pre class="programlisting"><span class="strong"><strong>PS&gt; $LiteralString[4].Substring($LiteralString[4].IndexOf('-') + 1) # Skip the hyphen</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="6" type="1"><li>To make all of the directory names uppercase, use the following command:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; $LiteralString = $LiteralString.ToUpper()</strong></span></pre><p> </p><div class="orderedlist"><ol class="orderedlist arabic" start="7" type="1"><li>To replace all of the hyphens with spaces, use the following command:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; $LiteralString = $LiteralString.Replace('-', ' ')</strong></span></pre></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec199"></a>How it works…</h3></div></div></div><p>The <code class="literal">TrimStart()</code> method removes the specified character from the beginning of the string. The <code class="literal">TrimEnd()</code> method removes the specified character at the end of the string. If we have to remove the same character at both ends of the string, we use the <code class="literal">Trim()</code> method with the specified character. If you do not specify any character as the argument to any of the methods, white space will be removed from the string.</p><p>The <code class="literal">split()</code> method splits the strings at the specified character, and creates an array of the split strings.</p><p>We use the index operator to pick the fifth value from the array. Then, we find the index of the hyphen within the resultant string. Next, we create a substring using the <code class="literal">Substring()</code> method and instruct it to start at the index of the hyphen. The <code class="literal">Substring()</code> method accepts two arguments (the beginning and the end indices of the substring). If you specify only one index, PowerShell will pick up the single-parameter variant of the method and create a substring <span>starting</span><a id="id326082323" class="indexterm"></a> at the specified index, ending at the end of the string.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note50"></a>Note</h3><p>For those that are interested, this is an example of overloading in object-oriented programming.</p></div><p>Next, we added 1 to the index to omit the hyphen. Remember to perform the addition outside of the <code class="literal">IndexOf()</code> method.</p><p>The <code class="literal">ToUpper()</code> method converts the entire string into uppercase. There is also <code class="literal">ToLower()</code>, which does the opposite case conversion.</p><p>The <code class="literal">Replace()</code> method replaces the first argument with the second. These methods work on the entire string. Therefore, you may use the <code class="literal">Replace()</code> method to replace the entire string with another string. For example:</p><pre class="programlisting"><span class="strong"><strong>PS&gt; $LiteralString.Replace('DIR', 'FOLDER')</strong></span></pre><p>However, do note that wildcard or regular expression matching will not work with the <code class="literal">Replace()</code> method.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec200"></a>See also</h3></div></div></div><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">The <span class="emphasis"><em>Replacing substrings within strings</em></span> recipe</li></ul></div></div></div>