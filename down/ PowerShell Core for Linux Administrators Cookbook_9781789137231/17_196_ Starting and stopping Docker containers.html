<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch17lvl1sec189"></a>Starting and stopping Docker containers</h2></div></div><hr /></div><p>In this recipe, you'll find out <span>how</span><a id="id325898620" class="indexterm"></a> containers can be started <span>and</span><a id="id325892294" class="indexterm"></a> stopped using Docker cmdlets.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch17lvl2sec506"></a>Getting ready</h3></div></div></div><p>If you have been following along, you should be able to continue with the same state. Otherwise, follow these steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Open a PowerShell console with SU privileges</li><li>Load the Docker PowerShell module using the manifest</li><li>Create one or more containers, which should be in different states</li></ol></div><p> </p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch17lvl2sec507"></a>How to do it…</h3></div></div></div><p>To start and stop the Docker containers, follow these instructions:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Check the status of the containers in your system using <code class="literal">Get-Container</code>:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-Container</strong></span>

ID                   Image           Command Created        Status       Names
--                   -----           ------- -------        ------       -----
3d8f26818889bbd58... microsoft/po... pwsh 6/4/18 8:46:12 PM Up 6 seconds sleepy...
b41c1cc5fe36eac65... microsoft/po... pwsh 6/4/18 7:44:09 PM Exited (0) 2 seco... upbeat...
5ce6d3f9de452135e... microsoft/po... pwsh 6/4/18 7:44:05 PM Exited (0) 2 seco... sharp_...
af771ace8d1ed692d... microsoft/po... bash 6/4/18 7:14:04 PM Up 3 seconds quirky...</pre><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Get a list of running containers using a conditional <code class="literal">Where-Object</code> clause construct:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-Container |where-object {$_.Status -match 'up'}</strong></span>

ID Image Command Created Status Names
-- ----- ------- ------- ------ -----
3d8f26818889bbd58... microsoft/po... pwsh 6/4/18 8:46:12 PM Up 3 minutes sleepy...
af771ace8d1ed692d... microsoft/po... bash 6/4/18 7:14:04 PM Up 2 hours quirky...</pre><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>Stop the running containers using the <code class="literal">Stop-Container</code> cmdlet. Use the pipe to pass the container objects to <code class="literal">Stop-Container</code>:</li></ol></div><pre class="programlisting">
<span class="strong"><strong>PS&gt; Get-Container | where-object {$_.Status -match 'up'}|Stop-Container </strong></span>
<span class="strong"><strong>PS&gt; Get-Container</strong></span>

ID Image Command Created Status Names
-- ----- ------- ------- ------ -----
3d8f26818889bbd58... microsoft/po... pwsh 6/4/18 8:46:12 PM Exited (0) 4 seco... sleepy...
b41c1cc5fe36eac65... microsoft/po... pwsh 6/4/18 7:44:09 PM Exited (0) About ... upbeat...
5ce6d3f9de452135e... microsoft/po... pwsh 6/4/18 7:44:05 PM Exited (0) About ... sharp_...
af771ace8d1ed692d... microsoft/po... bash 6/4/18 7:14:04 PM Exited (0) 4 seco... quirky...</pre><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>Start the stopped containers:</li></ol></div><pre class="programlisting">
<span class="strong"><strong>PS&gt; Get-Container | where-object {$_.Status -match 'exited'} | Start-Container </strong></span>
<span class="strong"><strong>PS&gt; Get-Container</strong></span>

ID Image Command Created Status Names
-- ----- ------- ------- ------ -----
3d8f26818889bbd58... microsoft/po... pwsh 6/4/18 8:46:12 PM Up 6 seconds sleepy...
b41c1cc5fe36eac65... microsoft/po... pwsh 6/4/18 7:44:09 PM Exited (0) 2 seco... upbeat...
5ce6d3f9de452135e... microsoft/po... pwsh 6/4/18 7:44:05 PM Exited (0) 2 seco... sharp_...
af771ace8d1ed692d... microsoft/po... bash 6/4/18 7:14:04 PM Up 3 seconds quirky...</pre><div class="orderedlist"><ol class="orderedlist arabic" start="5" type="1"><li>Stop the running containers by using the <code class="literal">grep</code> and <code class="literal">awk</code> commands in conjunction with Docker commands:</li></ol></div><pre class="programlisting">
<span class="strong"><strong>PS&gt; docker ps -a | grep "Up" | awk '{print $1}' | xargs docker stop</strong></span>

</pre><div class="orderedlist"><ol class="orderedlist arabic" start="6" type="1"><li>Start the stopped containers using the <code class="literal">grep</code> and <code class="literal">awk</code> commands in conjunction with Docker commands:</li></ol></div><pre class="programlisting">
<span class="strong"><strong>PS&gt; docker ps -a | grep "seconds" | awk '{print $1}' | xargs docker start  </strong></span></pre></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch17lvl2sec508"></a>How it works…</h3></div></div></div><p>Starting and stopping containers is one of the basic tasks in any <span>production</span><a id="id325906060" class="indexterm"></a> Docker workflow. While these tasks can be achieved with Docker CLI commands, the fact that PowerShell has these wrapper functions brings the consistency and <span>friendliness</span><a id="id325906069" class="indexterm"></a> of PowerShell to the table.</p><p><code class="literal">Start-Container</code>, as the name suggests, starts a container. A stopped container can be restarted with all its previous changes intact using <code class="literal">Start-Container</code>. Stopping is equally simply handled.</p><p> </p><p>The use of conditional constructs, such as <code class="literal">Where-Object</code> in PowerShell, comes in very handy for filtering containers. The transparent mechanism of passing values as objects through the pipe has been demonstrated as well.</p></div></div>