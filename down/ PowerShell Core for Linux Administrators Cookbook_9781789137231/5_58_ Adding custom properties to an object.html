<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch05lvl1sec63"></a>Adding custom properties to an object</h2></div></div><hr /></div><p>PowerShell cmdlets are capable of <span>allowing</span><a id="id326071468" class="indexterm"></a> administrators to work with most tasks. However, there are some situations where the returned objects don't satisfy the administrative needs of a certain script. In such situations, we may need to create our own custom objects based on the available .NET classes, or at least, add a custom property to the object.</p><p> </p><p>While a string is an object of the <code class="literal">System.String</code> type, the <code class="literal">Get-Process</code> cmdlet returns an object of type <code class="literal">System.Diagnostics.Process</code>, <code class="literal">Get-ChildItem</code> returns an object with the type <code class="literal">System.IO.FileInfo</code>, and a custom-created object has the object type <code class="literal">PSCustomObject</code>.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec173"></a>How to do it…</h3></div></div></div><p>Now, let's proceed and create a custom object:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>To create a custom object, use the <code class="literal">New-Object</code> cmdlet:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS /home/PacktPub&gt; New-Object -TypeName PSCustomObject</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>That was not of much use to us. Let's add a few properties into it, along with their values, and store these values in a variable:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; $MyCustomObject = [pscustomobject]@{ </strong></span>
<span class="strong"><strong>  Name = 'Prashanth Jayaram'</strong></span>
<span class="strong"><strong>  Title = 'PowerShell'</strong></span>
<span class="strong"><strong>  Publisher = 'Packt' </strong></span>
<span class="strong"><strong>}</strong></span>

<span class="strong"><strong>PS&gt; $MyCustomObject</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>To add properties to an object, use the <code class="literal">Add-Member</code> cmdlet:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; $MyCustomObject | Add-Member -MemberType NoteProperty -Name 'Location' -Value 'United States'</strong></span>
<span class="strong"><strong>PS&gt; $MyCustomObject</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>To remove a property from an object, use the following command:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; $MyCustomObject.PsObject.Properties.Remove('Location')</strong></span>

<span class="strong"><strong>PS&gt; # To see if the property is still available, run:</strong></span>
<span class="strong"><strong>PS&gt; $MyCustomObject.Location</strong></span></pre><p> </p><div class="orderedlist"><ol class="orderedlist arabic" start="5" type="1"><li>To access properties, you can use the member access operator (<code class="literal">.</code>):</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; $MyCustomObject.Name</strong></span>
Prashanth Jayaram

<span class="strong"><strong>PS&gt; $MyCustomObject.Title</strong></span>
PowerShell

<span class="strong"><strong>PS&gt; $MyCustomObject.Publisher</strong></span>
Packt</pre></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec174"></a>How it works…</h3></div></div></div><p>Creating an object is straightforward. All you have to do is tell PowerShell that you are creating a custom object by calling the <code class="literal">[psobject]</code> accelerator and specifying the properties you would like to add to the object. After the accelerator is called, we specify the names of the properties, and assign values to them. Records are added one at a time using the hash literal notation (<code class="literal">Name = 'Prashanth'</code>).</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip45"></a>Note</h3><p>It is easy to confuse a hashtable with a <code class="literal">PSObject</code> at this stage, given that we use the hash literal notation when creating the object. Remember that they are very different from each other. We will get into the details of what a hashtable is in <a class="link" href="#" linkend="ch09">Chapter 9</a>, <span class="emphasis"><em>Using</em></span> <span class="emphasis"><em>Arrays and Hashtables</em></span>.</p></div><p>We mention three properties in the custom object we have created: <code class="literal">Name</code>, <code class="literal">Title</code>, and <code class="literal">Publisher</code>. If we would like to add additional properties in the future, we can simply use the <code class="literal">Add-Member</code> cmdlet, where we specify the object (we pass the object through the pipeline), and the name of the property, and assign a value to it.</p><p>Removing a property is a little more complex, since we do not have a <code class="literal">Remove-Member</code> cmdlet, nor are the members we use in the step easily discoverable. For instance, <code class="literal">[PSCustomObject] | Get-Member</code> does not reveal <code class="literal">PsObject</code> as being its member. We call the <code class="literal">Remove</code> method within the <code class="literal">Properties</code> object, which is within the <code class="literal">PSObject</code> object of the custom object we created. (So many objects!)</p><p>Accessing properties in an object is as simple as using the <span>member</span><a id="id325906039" class="indexterm"></a> access operator with the property name.</p><p>Remember, this object definition will exist as long as your PowerShell session is alive.</p><p> </p><p> </p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec175"></a>See also</h3></div></div></div><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">The <span class="emphasis"><em>Creating and initializing a simple hashtable </em></span>recipe in <a class="link" href="#" linkend="ch09">Chapter 9</a>, <span class="emphasis"><em>Using Arrays and Hashtables</em></span></li></ul></div></div></div>