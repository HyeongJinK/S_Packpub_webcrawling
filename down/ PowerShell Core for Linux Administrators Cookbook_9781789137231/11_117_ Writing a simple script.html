<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch11lvl1sec116"></a>Writing a simple script</h2></div></div><hr /></div><p>In a way, this book began with a script: the lab setup script. This <span>recipe</span><a id="id326228952" class="indexterm"></a> is here to show you that a simple script is nothing more than a series of commands put together. Now, we have been writing scripts throughout this book. However, some of the information may have been scattered across different chapters and recipes. In this recipe, we will bring it all together and write a simple script. Also, given the cookbook structure of this book, it is important that we cover this topic for those who skipped straight to this point.</p><p>The scenario here is that you have to write a script that will give out the current date and time, and show the hostname of the computer the script is running on. It also welcomes the user by his/her username. The catch here is that you need to have a space in the name of the script, and you need to ensure that the script should be called in a platform-agnostic manner.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch11lvl2sec305"></a>How to do it…</h3></div></div></div><p>The requirements are simple. Four things are required of us:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">The script must have a name that contains a space</li><li style="list-style-type: disc">We must write out the current date and time</li><li style="list-style-type: disc">We must show the host name</li><li style="list-style-type: disc">We must greet the user by their username</li></ul></div><p>Create a file called simple <code class="literal">script.ps1</code>. Add the following content to it:</p><pre class="programlisting">Get-Date

hostname

Write-Output "Hello, $env:username!"</pre><p>Then, call the script:</p><pre class="programlisting"><span class="strong"><strong>PS&gt; &amp; './simple script.ps1'</strong></span></pre><p> </p><p> </p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch11lvl2sec306"></a>How it works…</h3></div></div></div><p>Now to the part where this is rocket science. First, identify the payload. Calculate the orbital velocity and the rotational velocity of the Earth. Next… you get the point. However, here are a couple of things to remember when you want to run a script.</p><p>A script, when called simply, will load, execute, and exit. It will not store anything in the memory—neither the functions, nor the variables and other data. If you want the variables, functions, and other information retained in the session, the script has to be called in a specific way, like so:</p><pre class="programlisting">PS&gt; # To retain variable and function information in the session:
<span class="strong"><strong>PS&gt; . ./path/to/script.ps1</strong></span>

PS&gt; # To simply have PowerShell run the script:
<span class="strong"><strong>PS&gt; &amp; ./path/to/script.ps1</strong></span></pre><p>In Bash, we simply add a backslash before the space, that is, if there is a <span>space</span><a id="id325585880" class="indexterm"></a> in the path name. In PowerShell, especially when running a script on Windows, it will not work, because in Windows the backslash is the path separator. The other option would be to enclose the complete path in quotes. However, by default, PowerShell considers anything enclosed in quotes to be a string. Therefore, in order to tell PowerShell to read the path as the path, we use either of the call operators, <code class="literal">&amp;</code> or <code class="literal">.</code>, based on the situation. We have demonstrated using both of these techniques in the preceding code.</p></div></div>