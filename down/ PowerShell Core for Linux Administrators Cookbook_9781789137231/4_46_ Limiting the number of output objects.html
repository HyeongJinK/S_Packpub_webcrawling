<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch04lvl1sec52"></a>Limiting the number of output objects</h2></div></div><hr /></div><p>In the previous recipe, <span class="emphasis"><em>Selecting columns from the output</em></span>, we saw how the <code class="literal">Select-Object</code> cmdlet can be used to select only the columns we want. In this recipe, we will learn how to limit the <span>output</span><a id="id325898621" class="indexterm"></a> of a cmdlet to a subset of the total items returned.</p><p> </p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec143"></a>Getting ready</h3></div></div></div><p>Ensure that you are at a location that has a few files. List out the contents of the current directory and count the number of items returned. If the number is less than 5, you may want to consider adding more items to the directory. Follow these steps to get started:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Enter the following command to count the number of files and directories at the current path:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; (Get-ChildItem -Path .).Count</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>If you would like to reduce keystrokes, given that we are only running commands at the terminal, you could use the alias and the defaults of the cmdlet:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; (gci).Count</strong></span></pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip42"></a>Note</h3><p>Those parentheses are required; the parentheses work similar to how they work in mathematics: the instruction within the parentheses is processed first. In this case, we want <code class="literal">gci</code> to be executed first, and then the <code class="literal">Count</code> property from within the returned object picked.</p></div><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>Get the list of parameters <code class="literal">Select-Object</code> has:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-Help Select-Object</strong></span></pre><p>We can see parameters such as <code class="literal">First</code> and <code class="literal">Last</code>, and they accept integer values.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec144"></a>How to do it…</h3></div></div></div><p>Navigate to the directory where you have the files:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Select only the first five files and directories from the returned list by using the <code class="literal">First</code> parameter:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-ChildItem . | Select-Object -First 5</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Let's say we would like to pick the last five elements:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-ChildItem . | Select-Object -Last 5</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>We are doing this so that we can skip the first three objects:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-ChildItem . | Select-Object -Skip 3</strong></span></pre><p> </p><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>If you would like to skip the last two objects, you can use the following code:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-ChildItem . | Select-Object -SkipLast 2</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="5" type="1"><li>To pick the fourth element from the output, you can use the following code:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-ChildItem . | Select-Object -Index 3</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="6" type="1"><li>Now, combine it with what we learned in the previous recipe. Pick only the filenames and the last modified time of the first four elements:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-ChildItem . | select -Property Name, LastWriteTime -First 4</strong></span></pre></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec145"></a>How it works…</h3></div></div></div><p>This is a simple recipe that helps you work with the <span>number</span><a id="id325885493" class="indexterm"></a> of items returned in the output. With <code class="literal">Select-Object</code> in PowerShell, we need not loop through output, while simultaneously counting to only get the number of elements that we want. The <code class="literal">Select-Object</code> cmdlet has that functionality built in.</p><p>The parameter names are self-explanatory, except perhaps the <code class="literal">Index</code> parameter, which works exactly how the numbering of array elements works with most programming languages: it starts with zero. Therefore, the fourth element in the array would have an index of <code class="literal">3</code>, and not <code class="literal">4</code>.</p><p>The <code class="literal">Property</code> and <code class="literal">First</code> parameters can be combined together since they both feature in the same parameter set in the help documentation for <code class="literal">Select-Object</code>.</p></div></div>