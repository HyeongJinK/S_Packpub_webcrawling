<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch07lvl1sec80"></a>Using Switch–Case conditions to control script flow</h2></div></div><hr /></div><p><code class="literal">If–ElseIf–Else</code> works when you have outcomes <span>coming</span><a id="id325611243" class="indexterm"></a> in categories (weekdays being five days, weekends being two). When the outcomes are specific and/or too many in number, it could be a little tedious to use the <code class="literal">If–ElseIf-Else</code> construct. To understand this better, let's give ourselves a scenario.</p><p>The dress code at your workplace is decided by a child, who likes everyone wearing the colors of the rainbow. Since she does not like anyone working weekends, she's not a big fan of orange, and absolutely hates yellow. She has come up with the following scheme (she doesn't know of Monday Blues yet): red on Mondays, violet on Tuesdays, indigo on Wednesdays, blue on Thursdays, green on Fridays, and orange during the weekends.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec215"></a>How to do it…</h3></div></div></div><p>This situation will require a whole round of <code class="literal">If–ElseIf–Else</code> statements. A more efficient way of handling this situation is to use the <code class="literal">Switch–Case</code> construct:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Open a new PowerShell file and add the following content to it:</li></ol></div><pre class="programlisting">$Date = Get-Date

switch ($Date.DayOfWeek) {
    'Monday' { Write-Output 'Red' }
    'Tuesday' { Write-Output 'Violet' }
    'Wednesday' { Write-Output 'Indigo' }
    'Thursday' { Write-Output 'Blue' }
    'Friday' { Write-Output 'Green' }
    Default { Write-Output 'Orange' }
}</pre><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>If you would rather omit <code class="literal">Default</code> and use a wildcard matching for the weekends, use the following code:</li></ol></div><pre class="programlisting">$Date = Get-Date

switch <span class="strong"><strong>-Wildcard</strong></span> ($Date.DayOfWeek) {
    'Monday' { Write-Output 'Red' }
    'Tuesday' { Write-Output 'Violet' }
    'Wednesday' { Write-Output 'Indigo' }
    'Thursday' { Write-Output 'Blue' }
    'Friday' { Write-Output 'Green' }
    'S*' { Write-Output 'Orange' }
}</pre></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec216"></a>How it works…</h3></div></div></div><p>As we can see, it is more efficient to write, execute, as well as troubleshoot a <code class="literal">Switch–Case</code> construct in such situations, rather than writing a series of <code class="literal">If–ElseIf–ElseIf–ElseIf–...–Else</code> statements. To define a catch-all action in <code class="literal">Switch–Case</code>, use <code class="literal">Default</code>.</p><p>The <code class="literal">Switch–Case</code> construct also supports wildcard (<code class="literal">-Wildcard</code>) and regex (<code class="literal">-Regex</code>). In general, it is not a good practice to omit <code class="literal">Default</code> unless all the possible outcomes have been covered.</p><p>The working of <code class="literal">Switch–Case</code> is simple: it checks the condition against all the values among the definitions, and whenever it finds a condition to be true, it executes the corresponding script block. Therefore, if three conditions among five are met, the three script blocks will be executed. This is a little unlike <code class="literal">If–ElseIf–Else</code>, which exits out of the branching construct the moment the first <code class="literal">$true</code> is met and the script block is executed. Therefore, if you want only one <span>outcome</span><a id="id325585852" class="indexterm"></a> from the construct, consider adding the <code class="literal">break</code> keyword in every script block to break out of the construct the moment a <code class="literal">$true</code> is encountered. For example, check out the following code:</p><pre class="programlisting">...
    'Monday' {
        Write-Output 'Red'
        break
    }
...</pre><p>Of course, in this particular situation, it is not necessary, since the outcome would be exclusive.</p></div></div>