<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch13lvl1sec141"></a>Running a script in Debug mode</h2></div></div><hr /></div><p>We saw that adding <code class="literal">CmdletBinding()</code> and using the debug switch when calling the script <span>shows</span><a id="id325892141" class="indexterm"></a> us debug output. However, what if your function is not designed to support debugging or you are not using a function at all? What if you would like to step through each of the steps in the script?</p><p>Run the following script in Debug mode:</p><pre class="programlisting">function New-File {
    param (
        # The path to the file (or the name)
        [Parameter(Mandatory=$true, Position=0)]
        [string[]]
        $Path
    )
    begin {
        Write-Debug "Entered the begin block."
        Write-Host "$(Get-Date)"
    }
    process {
        Write-Debug "Entered the process block."
        foreach ($Item in $Path) {
            Write-Debug "Iterating for item, $Item."
            New-Item -Path $Path -ItemType File
        }
    }
    end {
        Write-Debug "Entered the end block."
    }
}</pre><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch13lvl2sec360"></a>How to do it…</h3></div></div></div><p>We used a cmdlet to run scripts and functions in Debug mode. Follow these steps to get started:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Run <code class="literal">Set-PsDebug -Step</code> to go into <code class="literal">Debug</code> mode</li><li>Run the script by either dot-sourcing the script or using the Debug tab of Visual Studio Code</li><li>Call the <code class="literal">New-File</code> function with an appropriate parameter</li><li>Exit Debug mode when the script run is complete by using the same cmdlet with the <code class="literal">Off</code> switch:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Set-PsDebug -Off</strong></span></pre></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch13lvl2sec361"></a>How it works…</h3></div></div></div><p>To enter Debug mode in PowerShell, use the <code class="literal">Set-PsDebug</code> cmdlet with the <code class="literal">Step</code> switch to step through the entire process, whatever the script is designed to do. At each step, we can peek into the objects to see what value they hold and perform diagnostics.</p><p>Running the <code class="literal">Set-PsDebug</code> cmdlet when in <span>Debug</span><a id="id325585856" class="indexterm"></a> mode with the <code class="literal">Off</code> parameter exits Debug mode. You can change the behavior of Debug mode from within the Debug mode itself by using other parameters such as <code class="literal">Trace</code> or <code class="literal">Strict</code>.</p><p> </p></div></div>