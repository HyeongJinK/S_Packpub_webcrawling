<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch12lvl1sec126"></a>Defining parameters</h2></div></div><hr /></div><p>In <a class="link" href="#" linkend="ch11">Chapter 11</a>, <span class="emphasis"><em>Building Scripts and Functions</em></span>, we defined parameters in scripts as well as functions. That was a simple parameter, where we simply defined the parameter name. With parameters in PowerShell, you can get as vague or as specific as you want. The idea is to keep things as standard or as flexible as you want. The <span>flexible</span><a id="id325885489" class="indexterm"></a> model may work in a single environment, however, the more standardized approach is advisable when creating shareable scripts (which is generally encouraged).</p><p>Here is the scenario for this recipe: modify the <code class="literal">Start-Count</code> function, which you created in the previous chapter, to remove the default value for <code class="literal">TotalTime</code> and make the parameter mandatory. Also, allow the user to define the <code class="literal">CurrentTime</code> parameter as well. Define the positions in such a way that the user can use <code class="literal">Start-Count 5 10</code> if they want the script to count from <code class="literal">5</code> to <code class="literal">10</code>.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch12lvl2sec328"></a>Getting ready</h3></div></div></div><p>Read the <span class="emphasis"><em>How to do it…</em></span> part of the <span class="emphasis"><em>Writing a simple function</em></span> recipe in <a class="link" href="#" linkend="ch11">Chapter 11</a>, <span class="emphasis"><em>Building Scripts and Functions</em></span>. We will use the same function here to extend it a little.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch12lvl2sec329"></a>How to do it…</h3></div></div></div><p>The modifications will be simple, but they will make a significant difference to how the script behaves:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Create a new PowerShell script file and paste the contents from the <span class="emphasis"><em>How to do it…</em></span> section of the <span class="emphasis"><em>Writing a simple function</em></span> recipe into the text window.</li><li>Make the modifications as follows. Do not copy and paste. Writing them by yourself will help you understand what you are doing:</li></ol></div><pre class="programlisting">function Start-Count {
    param (
        # The current time, or the starting point
        [Parameter(Mandatory=$true, Position=0)]
        [int]
        $CurrentTime,

        # The total number of seconds to count
        [Parameter(Mandatory=$true, Position=1)]
        [int]
        $TotalTime
    )

    while ($CurrentTime -le $TotalTime) {
        Write-Progress -Activity "Counting to $TotalTime" -Status "Counting: $CurrentTime seconds" -PercentComplete ($CurrentTime / $TotalTime * 100)
        Start-Sleep 1
        $CurrentTime++
    }
}</pre><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>Run the script and call the function like so:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; . ./ch12/01-Start-Count.ps1</strong></span>
<span class="strong"><strong>PS&gt; Start-Count 5 10</strong></span>
<span class="strong"><strong>PS&gt; # Verbose version: Start-Count -CurrentTime 5 -TotalTime 10</strong></span></pre></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch12lvl2sec330"></a>How it works…</h3></div></div></div><p>Note how we wrote a multiline <code class="literal">param()</code> block this time. This <span>makes</span><a id="id325898674" class="indexterm"></a> the script more readable. PowerShell understands this, and reads the entire <code class="literal">param()</code> block as follows:</p><pre class="programlisting">param<span class="strong"><strong>(</strong></span>[Parameter(Mandatory=$true,Position=0)][int]$CurrentTime, [Parameter(Mandatory=$true,Position=1)][int]$TotalTime<span class="strong"><strong>)</strong></span></pre><p>The simple definition (without all the specifications) would simply be <code class="literal">param($CurrentTime, $TotalTime)</code>. The primary point of this recipe, though, is the specifications.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip74"></a>Note</h3><p>Use the snippets available in Visual Studio Code if you do not want to type the whole content, or do not remember the exact syntax. The snippets and IntelliSense suggestions improve the speed of creating functions, along with avoiding potential errors. To invoke snippets or suggestions, use the <span class="emphasis"><em>Ctrl + Space</em></span> key combination.</p></div><p>It is customary to add a comment to each parameter in the definition. This helps improve readability. The <code class="literal">[Parameter()]</code> block contains specifications (<code class="literal">AttributeValues</code>) such as whether the parameter is mandatory, input what position should be assigned to the parameter, what parameter set the parameter belongs to, whether it can accept input through the pipeline, and so on.</p><p> </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note75"></a>Note</h3><p>We generally do not make a parameter mandatory, along with assigning a default value to it. That would be redundant.</p></div><p>The next line in the definition is the data type of the parameter. PowerShell understands the data type based on the context most of the time, however, explicitly defining it reduces room for error. This is also where you would specify whether the parameter is an array. Therefore, if you were to take an array of numbers as input for <code class="literal">TotalTime</code>, you would define it in the following way:</p><pre class="programlisting">[Parameter(Mandatory=$true, Position=1)]
[int<span class="strong"><strong>[]</strong></span>]
$TotalTime</pre><p>When a parameter is made mandatory, PowerShell will automatically prompt the user for input for the parameter, that is, if the user does not specify values to them while calling the function:</p><div class="mediaobject"><img src="/graphics/9781789137231/graphics/d3bb30cb-883d-4fda-aee2-b6812aec46ce.png" /></div><p>If the parameter accepts array input, PowerShell will prompt the user in the following way:</p><pre class="programlisting">PS&gt; TotalTime[0]: 3
TotalTime[1]:</pre><p>If you are finished with the array, just send a blank element and PowerShell will take that as the end of the array.</p><p>Also note that position numbers start with <code class="literal">0</code>. Therefore, the first parameter input will be associated with the parameter whose position is <code class="literal">0</code>.</p><p> </p><p> </p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch12lvl2sec331"></a>There's more…</h3></div></div></div><p>Now that you know about the positional parameter, the mandatory parameter, and the default value of a parameter, attempt to modify the function to make it accept two kinds of input:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Count from <code class="literal">0</code> in case only one argument is specified. Here, take <code class="literal">TotalTime</code> as the only input:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Start-Count 10</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>In case a user specifies both the <span>start</span><a id="id325906080" class="indexterm"></a> time and the end time, start at the <code class="literal">CurrentTime</code> and stop counting at <code class="literal">TotalTime</code>:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Start-Count 3 9</strong></span></pre><p>Do not make the user call the parameters by name.</p><p>Compare your script with the <code class="literal">01-Start-CountFlexible.ps1</code> script, which is a solution to this requirement.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch12lvl2sec332"></a>See also</h3></div></div></div><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">Advanced Function Parameter Attributes (TechNet – Social): <a class="ulink" href="https://social.technet.microsoft.com/wiki/contents/articles/15994.powershell-advanced-function-parameter-attributes.aspx" target="_blank">https://social.technet.microsoft.com/wiki/contents/articles/15994.powershell-advanced-function-parameter-attributes.aspx</a></li></ul></div></div></div>