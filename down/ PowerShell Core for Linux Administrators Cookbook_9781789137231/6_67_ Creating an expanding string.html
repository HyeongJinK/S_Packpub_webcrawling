<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch06lvl1sec71"></a>Creating an expanding string</h2></div></div><hr /></div><p>In the previous recipe, we created a really simple literal (or non-expanding) string. A literal <span>string</span><a id="id325945978" class="indexterm"></a> shows everything specified, as it is. An expanding string, on the other hand, is a little different.</p><p>In this recipe, we will create expanding strings. In the process, we will probably take this exercise up a notch.</p><p> </p><p> </p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec192"></a>Getting ready</h3></div></div></div><p>Query the list of directories under your lab directory. If you have not already, clone the Git repository that accompanies this book and use the quick-and-dirty <code class="literal">Initialize-PacktPs6CoreLinuxLab.ps1</code> script under the <code class="literal">ch04</code> directory. Run the script to get the necessary files. If not, specify the path to any directory that has files, like so:</p><pre class="programlisting"><span class="strong"><strong>PS&gt; $Random = Get-ChildItem -Path $HOME\random</strong></span></pre></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec193"></a>How to do it…</h3></div></div></div><p>Let's try to achieve the same thing as in the previous recipe, but use double quotes this time in place of single quotes. Follow these steps to complete this recipe:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Enter the following code to get the object type:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; "I am a string." | Get-Member | Select-Object TypeName -Unique</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>What if you wanted to use a contraction for I am?</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; "I'm a string."</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>That worked without a problem, but what if you wanted to add double quotes within double quotes?</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; "I'm a string, and I'm currently being "double-quote" challenged"</strong></span></pre><p>Here is what this looks like:</p><div class="mediaobject"><img src="/graphics/9781789137231/graphics/51fdb143-d8d3-48a8-911a-6d873b37052e.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>Correct, even the colors did not look right. Try the same syntax that you did in the previous recipe:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; "I'm a string, and I'm currently being ""double-quote"" challenged"</strong></span></pre><p> </p><div class="orderedlist"><ol class="orderedlist arabic" start="5" type="1"><li>The colors changed, and it all works well. But wait a minute, we discussed something about the escape character. Would it work here?</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; "I'm a string, and I'm currently being `"double-quote`" challenged"</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="6" type="1"><li>Now, try to show the value of your home directory within the string:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; "I'm a string, and the home directory I've been asked to show is $HOME."</strong></span></pre><p>Note how <code class="literal">$HOME</code> was replaced by the actual path:</p><div class="mediaobject"><img src="/graphics/9781789137231/graphics/1023486b-f1c7-474f-b0f0-56890b0aeac6.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="7" type="1"><li>What about a line break?</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; "I'm a string.`nI love showing up on the screen."</strong></span></pre><p>Here is what you get:</p><div class="mediaobject"><img src="/graphics/9781789137231/graphics/edc48c11-2742-4747-a83f-18939a15b5ae.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="8" type="1"><li>What if we wanted to show the paths within directories, from <span>within</span><a id="id325909526" class="indexterm"></a> a string?</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; "The files and directories under random are:`n$Random"</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="9" type="1"><li>Try to get the full path of each of those files:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; "The files and directories under random are:`n$Random.FullName"</strong></span></pre><p>The <code class="literal">.FullName</code> was simply added to the output text:</p><div class="mediaobject"><img src="/graphics/9781789137231/graphics/dc0201fb-0b93-4d0b-94a7-93ac814028b5.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="10" type="1"><li>Let's try the subexpression operator; enclose <code class="literal">$Random.FullName</code> within <code class="literal">$()</code>:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; "The files and directories under random are:`n$($Random.FullName)"</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="11" type="1"><li>Let's try to add two strings:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; "I'm a string. " + "I love showing up on the screen."</strong></span></pre><p>There we have it; our recipe.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec194"></a>How it works…</h3></div></div></div><p>Here are our observations:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">The object type did not change when using double quotes.</li><li style="list-style-type: disc">Two double quotes made PowerShell show double quotes <span>within</span><a id="id325938641" class="indexterm"></a> the string.</li><li style="list-style-type: disc">The variable was expanded, and the path to the home directory was shown. This is important.</li><li style="list-style-type: disc">Escape sequences worked.</li><li style="list-style-type: disc">The names of the files in the random directory were shown. Only the filenames were shown, and the names were separated by spaces.</li><li style="list-style-type: disc">The full path was not shown.</li></ul></div><p>The strings we defined in this recipe were all expanding strings. Expanding strings expand the variables and respect escape sequences. One thing to remember is that one kind of string is not better than the other; it is about the context.</p><p>The output string did not show the mode, last write time, or other details from <code class="literal">$Random</code>, because of the formatting set on <code class="literal">System.IO.DirectoryInfo</code> and <code class="literal">System.IO.FileInfo</code>. </p><p> </p><p>Also, when we called the full path without the subexpression operator, PowerShell interpreted <code class="literal">$Random</code> as a variable, but thought <code class="literal">.FullName</code> was part of the string; it simply added <code class="literal">.FullName</code> to the string. The subexpression operator made PowerShell compute <code class="literal">$Random.FullName</code> first, and then placed the computed output in place of the subexpression.</p><p>We also saw another way to concatenate strings: using the <code class="literal">+</code> operator:</p><pre class="programlisting"><span class="strong"><strong>'The quick brown fox jumps over the lazy dog' -split ' ' | ForEach-Object { $Pangram += $PSItem }</strong></span></pre></div></div>