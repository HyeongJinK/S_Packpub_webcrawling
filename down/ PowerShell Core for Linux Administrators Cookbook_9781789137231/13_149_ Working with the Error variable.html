<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch13lvl1sec146"></a>Working with the Error variable</h2></div></div><hr /></div><p>Error <span>codes</span><a id="id326632684" class="indexterm"></a> have traditionally helped identify how errors are caused; the numbers have meanings tagged to them. Today, when we see codes such as <code class="literal">404</code> or <code class="literal">503</code>, we instantly know what they mean. PowerShell operates a little differently.</p><p>Find out whether the following command will result in an error. If it does, show details about the error:</p><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-Item$HOME/random/randompackage.zip -ErrorAction SilentlyContinue</strong></span></pre><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch13lvl2sec370"></a>How to do it…</h3></div></div></div><p>Let us make the series of steps we would like to take into a script.</p><p>Create a new PowerShell script file and add the following to it:</p><pre class="programlisting">Get-Item $HOME/random/randompackage.zip -ErrorAction SilentlyContinue

if (!$?) {
    Write-Host "PowerShell seems to have encountered an error while running the last command."
}

$Error[0] | Select-Object -Property *</pre><p>Execute this script to get error details.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch13lvl2sec371"></a>How it works…</h3></div></div></div><p>Traditionally, a non-zero exit code means that the command or the script did not complete as intended. Querying the exit code told us whether there was an error in execution, and what the error was related to.</p><p>In PowerShell, we use the automatic variable <code class="literal">$?</code> to find out whether there was an error in the last command, or whether the last script exited in error; this addresses the first part.</p><p>The automatic variable <code class="literal">$Error</code> keeps track of all of the errors that occurred in the current PowerShell session. The last error gets stored as the first element in the <code class="literal">$Error</code> array. Errors in PowerShell have several properties, such as <code class="literal">Exception</code> (the name of the exception, as well as the description), <code class="literal">TargetObject</code> (the object on which the action was intended), <code class="literal">FullyQualifiedErrorId</code> (to facilitate searching the documentation as well as the forums for troubleshooting information, irrespective of what language PowerShell is used in, thereby not restricting searches to English), and so on.</p><p>The <code class="literal">$Error</code> variable records errors, irrespective of what the error action preferences are, and enables us to take actions based on the error, such as when using a <code class="literal">try</code>–<code class="literal">catch</code> block.</p><p>If you would like to clear the error messages <span>instead</span><a id="id326633035" class="indexterm"></a> of starting a new PowerShell session just so that the errors are cleared, use the clear method that's available in <code class="literal">$Error</code>: call <code class="literal">$Error.Clear()</code>.</p></div></div>