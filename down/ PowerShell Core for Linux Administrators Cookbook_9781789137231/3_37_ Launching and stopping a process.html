<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch03lvl1sec44"></a>Launching and stopping a process</h2></div></div><hr /></div><p>All pro-terminal administrators launch and stop <span>processes</span><a id="id325892268" class="indexterm"></a> from the Terminal all of the time. This usually happens at the Terminal prompt on Bash. With PowerShell, the process is not <span>very</span><a id="id325892249" class="indexterm"></a> different. This recipe will show you how to work the processes. And by the way, this recipe is where you go on a full information fast.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec121"></a>Getting ready</h3></div></div></div><p>Open Visual Studio Code. If the status bar at the bottom is blue, chances are that a folder is open in Visual Studio Code. Visual Studio Code saves the location it is open at, so even if you start a session of Visual Studio Code after a fresh reboot, you would still see a folder open. We need the folder closed. To do this, press <span class="emphasis"><em>Ctrl + Shift + N</em></span> (or go to <strong class="userinput"><code>File</code></strong> &gt; <strong class="userinput"><code>New Window</code></strong>). Close the window where a folder is open.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec122"></a>How to do it…</h3></div></div></div><p>If you listed out the commands in the previous recipe, scroll up to find what cmdlets might help you with this recipe:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>At the prompt, type in the following to start Visual Studio Code:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Start-Process code</strong></span></pre><p>Ensure that the status bar at the bottom is not blue. If it is blue, read the <span class="emphasis"><em>Getting ready</em></span> section of this recipe. Press <span class="emphasis"><em>Ctrl + Shift +</em></span><span class="emphasis"><em>E</em></span> or click on the Explorer icon on the left sidebar of Visual Studio Code. There should not be any directory open there.</p><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Open Visual Studio Code in the directory where you created the <code class="literal">hello-world</code> script:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Start-Process code -ArgumentList</strong></span> /home/ram/Documents/code/github/powershell/</pre><p>Press <span class="emphasis"><em>Ctrl + Shift + E</em></span> or click on the Explorer icon on the left sidebar of Visual Studio Code. Do you see the directory open?</p><p>Now, let's stop the Visual Studio Code process.</p><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>List out the processes running in the system and see if anything matches <code class="literal">code</code>:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-Process | grep code</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>If you want the PowerShell way of doing it, run the following command and note the name in the <code class="literal">ProcessName</code> column:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-Process *code*</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="5" type="1"><li>PowerShell deals with objects; <code class="literal">grep</code> outputs text. Therefore, now that we know that the exact name of the process is <code class="literal">code</code>, we directly get details on the process:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-Process code</strong></span></pre><p>That gives us a valid output.</p><div class="orderedlist"><ol class="orderedlist arabic" start="6" type="1"><li>Stop all of the <code class="literal">code</code> processes:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Stop-Process code</strong></span></pre><p>That would not work; the cmdlet accepts a <code class="literal">System.Diagnostics.Process</code> object as input.</p><div class="orderedlist"><ol class="orderedlist arabic" start="7" type="1"><li>Enclose <code class="literal">Get-Process</code> within parentheses and pass the input to <code class="literal">Stop-Process</code>:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Stop-Process (Get-Process code)</strong></span></pre><p> </p><p> </p><div class="orderedlist"><ol class="orderedlist arabic" start="8" type="1"><li>See if there is a <code class="literal">code</code> process running any <span>more:</span></li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-Process code</strong></span></pre><div class="mediaobject"><img src="/graphics/9781789137231/graphics/24d2f445-1507-4970-97b1-e901099e8557.png" /></div><p>The best way of stopping a process is by using its ID.</p><div class="orderedlist"><ol class="orderedlist arabic" start="9" type="1"><li>I am running <code class="literal">dconf-editor</code> on my PC right now and <span>would</span><a id="id326097990" class="indexterm"></a> like to close it. You may <span>choose</span><a id="id326098000" class="indexterm"></a> any process to stop; play safe, though:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-Process dconf-editor</strong></span>
<span class="strong"><strong>PS&gt; Stop-Process -Id 20608</strong></span></pre></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec123"></a>How it works…</h3></div></div></div><p>The cmdlet, <code class="literal"><span>Start-Process</span></code>, works with paths. In the case of <code class="literal">code</code>, though, Linux knows the path where the package is installed. Therefore, simply calling the package by command is sufficient.</p><p>The Visual Studio Code process accepts the directory/file location as input. Therefore, we add the <code class="literal">ArgumentList</code> parameter and pass the path to the process as an argument. This opens that directory in Visual Studio Code.</p><p>Stopping a process requires a <span>.NET</span> object as input by default; <code class="literal">Stop-Process</code> would not accept a string as the default input. Therefore, we enclose the <code class="literal">Get-Process</code> cmdlet within parentheses, so that it gets executed first and outputs a <code class="literal">System.Diagnostics.Process</code> object, which is then processed by <code class="literal">Stop-Process</code>.</p><p>In order to be exact with respect to which process we would like to stop, we use the process ID and pass it as the argument to <code class="literal">Stop-Process</code>.</p></div></div>