<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch04lvl1sec54"></a>Filtering objects</h2></div></div><hr /></div><p>In the <span class="emphasis"><em>Limiting the number of output objects</em></span> recipe, we saw <span>how</span><a id="id325892298" class="indexterm"></a> to restrict the output content based on a number. In this recipe, we will look at filtering the output based on a certain criterion, and not a number.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec148"></a>Getting ready</h3></div></div></div><p>Read the <span class="emphasis"><em>Working with date properties</em></span> recipe in <a class="link" href="#" linkend="ch03">Chapter 3</a>, <span class="emphasis"><em>First Steps in Administration Using PowerShell</em></span>, if you have not read it already. This recipe uses one of the properties from the date object to filter content. While it is not critical to understand the filtration of objects, it still demonstrates the simplicity of filtration based on object properties.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec149"></a>How to do it…</h3></div></div></div><p>Navigate to the location where you created files for use with this book:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>List out the contents of this directory to see what content you have (if you are like me, you would have even forgotten where you created this directory, and what content you put in):</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Set-Location ~/random</strong></span>
<span class="strong"><strong>PS&gt; Get-ChildItem -Path .</strong></span></pre><p>Note the names of the properties you got.</p><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Now, pick only those files that are larger than 0 bytes:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-ChildItem -Path . | Where-Object -Property Length -GT -Value 0</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>Pick out all of the JPG files from the lot. To do this, add another condition to the existing condition. However, this time, use the <code class="literal">FilterScript</code> parameter instead of <code class="literal">Property</code>:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-ChildItem -Path . | Where-Object -FilterScript {$_.Length -GT 0 -and $_.Extension -EQ '.jpg'}</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>Add a condition to get only those files whose names start with <code class="literal">c</code>:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-ChildItem -Path . | Where-Object -FilterScript {$_.Length -GT 0 -and $_.Extension -EQ '.jpg' -and $_.Name -CMatch '^c'}</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="5" type="1"><li>Now, choose the files that were created before the 30<sup>th</sup> minute of any hour:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-ChildItem -Path . | Where-Object -FilterScript {$_.Length -GT 0 -and $_.Extension -EQ '.jpg' -and $_.Name -CMatch '^c' -and $_.LastWriteTime.Minute -LT 30}</strong></span></pre><p>There is only one file in the lab directory like this:</p><div class="mediaobject"><img src="/graphics/9781789137231/graphics/4a3eef05-4c33-4cf6-b905-3da4ca32a7d3.png" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec150"></a>How it works…</h3></div></div></div><p>Filtration of the output is very simple in PowerShell. Given that the content <span>output</span><a id="id325885497" class="indexterm"></a> is an object, we could simply use the properties from within the object for the filtration.</p><p>This recipe shows two modes of filtration:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Using one property and comparing its value to the input</li><li>Using a filter script that uses multiple values and multiple conditions</li></ol></div><p>The <code class="literal">Property</code> parameter accepts only one property. A conditional operator and a value for comparison are added to the statement to filter the output.</p><p>The <code class="literal">FilterScript</code> parameter, on the other hand, can handle more complex filtration, for example, when we need the output to meet several conditions.</p><p>A significant difference between using <code class="literal">Property</code> and <code class="literal">FilterScript</code> is the use of the automatic variable, <code class="literal">$_</code>. This variable contains the current object in the pipeline. For example, in this recipe, we pass the object from <code class="literal">Get-ChildItem</code> to <code class="literal">Where-Object</code> through the pipeline. The automatic variable, <code class="literal">$_</code>, contains the object returned by <code class="literal">Get-ChildItem</code>, so that <code class="literal">Where-Object</code> can process it. <code class="literal">$_.LastWriteTime</code>, in this case, picks the <code class="literal">LastWriteTime</code> property from the object returned by <code class="literal">Get-ChildItem</code>.</p><p>Also, the <code class="literal">LastWriteTime</code> object is of type <code class="literal">System.DateTime</code> or <code class="literal">DateTime</code>. (Run <code class="literal">(Get-ChildItem .).LastWriteTime | Get-Member</code> to find out more.) Therefore, it is possible to break it down further into days, hours, minutes, and so on, which is the reason why <code class="literal">$_.LastWriteTime.Minute</code> could be used for filtration.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec151"></a>There's more…</h3></div></div></div><p>Try out the <code class="literal">Where-Object</code> cmdlet on other outputs, such as that of <code class="literal">Get-Process</code>.</p></div></div>