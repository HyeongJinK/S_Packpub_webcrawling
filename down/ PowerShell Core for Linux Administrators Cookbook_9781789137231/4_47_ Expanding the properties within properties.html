<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch04lvl1sec53"></a>Expanding the properties within properties</h2></div></div><hr /></div><p>So far, from <span>what</span><a id="id325906070" class="indexterm"></a> we have seen, two things are clear to us:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>An object output feels richer and makes using the object easier</li><li>An object can have more objects within it</li></ol></div><p>We have handled the first point using the <code class="literal">Select-Object</code> cmdlet, wherein we picked only the object's properties that we needed, and omitted the rest. This recipe is designed to break down the second point for better understanding.</p><p>Let us step into this recipe with one thing in mind: objects can contain objects within them, which in turn can contain more objects within them. To demonstrate this, we will use the <code class="literal">Get-Process</code> cmdlet.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec146"></a>How to do it…</h3></div></div></div><p>Let's begin with listing out the processes; we will look at all of the properties that the <code class="literal">Get-Process</code> cmdlet gives us and look for complex ones:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Select all of the properties that are part of the output of the <code class="literal">Get-Process</code> cmdlet. Pick only the first object so that your console is not filled with content:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-Process | Select-Object -Property * -First 1</strong></span></pre><p>Observe the <code class="literal">Threads</code> property.</p><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Select the name of the process, the ID, and the threads:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-Process | Select-Object -Property Name, Id, Threads</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>List out all of the threads for the <code class="literal">pwsh</code> process:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-Process pwsh | Select-Object -ExpandProperty Threads</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>A lot of content is given as output. Say we want just the ID, the priority, and the start time of the resultant output:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-Process pwsh | Select-Object -ExpandProperty Threads | Select-Object -Property Id, PriorityLevel, StartTime</strong></span></pre><p>This gave us the ID, the priority level, and the start time of all of the threads that are running under <code class="literal">pwsh</code>.</p><div class="orderedlist"><ol class="orderedlist arabic" start="5" type="1"><li>What if we use <code class="literal">ExpandProperty</code> on the ID?</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-Process pwsh | Select-Object -ExpandProperty Threads | Select-Object -ExpandProperty Id</strong></span></pre><p> </p><p>Some partial output of the preceding command is shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781789137231/graphics/81ede6d6-09d7-451d-8987-655aee05d64a.png" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec147"></a>How it works…</h3></div></div></div><p>The default parameter for <code class="literal">Select-Object</code>, as we have seen, is <code class="literal">Property</code>. It accepts property names and shows their values in the output. This parameter can be used to fetch values of multiple properties (<code class="literal">Name</code>, <code class="literal">Id</code>, <code class="literal">Threads</code>).</p><p>However, some properties have more complex objects within them, as we saw in the case of the <code class="literal">Threads</code> property of the object returned by <code class="literal">Get-Process</code>. A simple way to identify complex objects is to see if they are enclosed in curly braces.</p><p>The <code class="literal">ExpandProperty</code> parameter accepts only a single property name as input and expands the property to show its objects. This can again be piped to <code class="literal">Select-Object</code> (or any other relevant cmdlet) for further processing.</p><p>In cases where the object is not complex, <code class="literal">ExpandProperty</code> simply shows the output without its header. As you may have noticed from the output of <code class="literal">ExpandProperty</code>, it does not contain the <span>name</span><a id="id325913506" class="indexterm"></a> of the expanded object itself (<code class="literal">Threads</code>, in our case); it contains only the value. The value, in turn, has multiple properties within it.</p><p>In the case of simple properties, using <code class="literal">ExpandProperty</code> simply strips off the property name from the output.</p></div></div>