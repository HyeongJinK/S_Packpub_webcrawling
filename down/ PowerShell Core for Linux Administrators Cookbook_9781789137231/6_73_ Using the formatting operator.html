<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch06lvl1sec77"></a>Using the formatting operator</h2></div></div><hr /></div><p>Learning about strings is incomplete without formatting. The <span>formatting</span><a id="id325906034" class="indexterm"></a> operator in PowerShell helps with formatting strings the way we want them. There are several options available with the operator, some of which we will see in the <span class="emphasis"><em>How it works…</em></span> section of this recipe. This helps us with several situations, such as generating an HTML report from the output of a cmdlet. You can create complex output files without having to worry about missing out tags or introducing errors when constructing these structured files.</p><p>In this recipe, we will look into a simple usage of the formatting operator. The following is the situation.</p><p> </p><p> </p><p>You have been hired by a bank to provide them with a series of automation solutions. The Recovery Division of the credit card department has a follow-up team that calls up defaulting customers. Given the financial situation, there are many who are behind on their bills. Consequently, the volume of calls each of these team members makes has increased. They are now too busy to type out emails, looking at the email address of the customer, typing the title, the due amount, and so on. The system is able to generate a simple text file with the details necessary for an email. Your job is to generate a <code class="literal">mailto:</code> link, with all the necessary details, which will then be embedded into the customer profile so that the associates simply have to click the link to send emails to the defaulters. A sample input file is as follows:</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note53"></a>Note</h3><p>It must be noted that this script assumes that all of the input is uniform (as given in the following code), with one file generated per customer, each file containing the title in the first line, the full name on the second, and so on. When building a real-life automation solution, ensure that standardization of the input is factored in.</p></div><pre class="programlisting">Mr
Bilbo Baggins
9149-4554-2127-8685
Bag End, The Shire, Hobbiton, Middle Earth
bilbo.baggins@middlearthmail.me
0069928789312
8472</pre><p>The output should be something like this:</p><pre class="programlisting">&lt;a href="mailto:bilbo.baggins@middlearthmail.me?subject=Payment due for 9149-4554-2127-8685&amp;body=Dear Mr Bilbo Baggins,

Hope you are doing well.

This is to notify you that the payment of $8,472.00 for card number 9149-4554-2127-8685 has not been received as yet. We tried to call you at 006-992-878-9312, but could not reach you. We have mailed the statement to the address: Bag End, The Shire, Hobbiton, Middle Earth.

Please write to us in case you need any assistance, or have queries.

Regards,
Central Bank of Imaginary Realms"&gt;Send email&lt;/a&gt;</pre><p> </p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec209"></a>How to do it…</h3></div></div></div><p>The solution is pretty simple, and you are going to involve the <span>formatting</span><a id="id325901985" class="indexterm"></a> operator. Follow these steps to create the function to take care of this task:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Open a Terminal window and import the contents of the file:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; $Details = Get-Content ./ch06/08-details.txt</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Now, build the <code class="literal">mailto:</code> block:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; $Link = @'</strong></span>
<span class="strong"><strong>&lt;a href="mailto:{4}?subject=Payment due for {2}&amp;body=Dear {0} {1},</strong></span>

<span class="strong"><strong>Hope you are doing well.</strong></span>

<span class="strong"><strong>This is to notify you that the payment of {6:c} for card number {2} has not been received as yet. We tried to call you at {5:00#-###-###-####}, but could not reach you. We have mailed the statement to the address: {3}.</strong></span>

<span class="strong"><strong>Please write to us in case you need any assistance, have queries, or would like any of the details corrected.</strong></span>

<span class="strong"><strong>Regards,</strong></span>
<span class="strong"><strong>Central Bank of Imaginary Fields"&gt;Send email&lt;/a&gt;</strong></span>
<span class="strong"><strong>'@</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>Finally, generate the link with the details filled in. Note that the sequence of the details plays a vital role:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; $Link -f $Details[0], $Details[1], $Details[2], $Details[3], $Details[4], [int64]$Details[5], [int]$Details[6]</strong></span></pre></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec210"></a>How it works…</h3></div></div></div><p>String formatting with the formatting operator is simple. To make this easier to understand, let's understand that there are two components to this: the component before the formatting operator, and the component after the formatting operator. Therefore, the sequence that you specify to the command is as follows:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>The string to be output</li><li>The formatting operator</li><li>The content to be inserted into the string</li></ol></div><p> </p><p>Therefore, the third component is the actual data.</p><p>The string to be output contains the formatting instructions. These instructions can be further divided into three:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>The index (mandatory)</li><li>The alignment specifier (optional)</li><li>The format string</li></ol></div><p>Together, they are specified within braces as <code class="literal">{index,alignment:formatString}</code>. In our recipe, we used only the index and the <span>formatting</span><a id="id326071494" class="indexterm"></a> string.</p><p>The <code class="literal">$Details</code> variable was an array. Therefore, we could refer to the elements with the index operator (<code class="literal">$Details[0]</code>). This way, we form the sequence of items to be passed into the string. We passed the email address as the fifth element, and we instructed the formatting operator to place the fifth element, <code class="literal">(...-f $Details[0], $Details[1], $Details[2], $Details[3], $Details[4]...)</code>, in the sequence, right after <code class="literal">mailto:</code> in the resultant string (<code class="literal">mailto:{4}</code>). Therefore, if we said <code class="literal">{4}</code>, it would mean the fifth element after <code class="literal">-f</code>.</p><p>Next comes the alignment. If you would like a series of spaces to be added to the left or the right of the content being formatted, you could use the alignment specifier. The index and the alignment specifier are separated by a comma. Therefore, if you say <code class="literal">"{0,8}" -f 'Joe'</code>, you would get  <code class="literal">    Joe</code>; if you said <code class="literal">"{0,-8}" -f 'Joe'</code>, you would get <code class="literal">Joe     </code>.</p><p>The format string is important. It shows the output in the format specified. In our recipe, we use <code class="literal">:c</code> to show the number as $8,472.00. We use <code class="literal">00#-###-###-####</code> to show the 13 digit number as a phone number; here, the two initial zeros tell PowerShell to pad the number with zeros, while the hashes are simple placeholders. This way, the number does not get displayed as <code class="literal">69928...</code>.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note54"></a>Note</h3><p>When we want to tell PowerShell that the phone number and the amount due are not strings, we use the cast operator to cast the strings as <code class="literal">int64</code> and <code class="literal">int</code>.</p></div><p> </p><p> </p><p>The format string helps you show the content as decimal digits, in scientific notation, percentages, hexadecimal numbers, and various date strings, among other formats. For instance, you could display 3.141592653589 accurately to up to four decimal places by using <code class="literal">"{0:n4}" -f 3.141592653589</code>. Here, <code class="literal">n</code> says that the content needs to be treated as a number, and <code class="literal">4</code> instructs PowerShell to make the output accurate to four digits after the decimal point.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec211"></a>There's more…</h3></div></div></div><p>Here are some exercises to try out:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Show the Avogadro number, 6,02,21,40,76,00,00,00,00,00,00,000, in <span>scientific</span><a id="id326229710" class="indexterm"></a> notation. The number of digits after the decimal point before the <span class="emphasis"><em>e</em></span> should be three.</li><li>Show 65,535 as a hexadecimal number.</li><li>Show 58.25354 as a percentage.</li><li>Format the current date as <code class="literal">yyyy-MM-dd</code> without using the <code class="literal">-Format</code> parameter of <code class="literal">Get-Date</code>.</li></ol></div><p>Done? Here are the solutions:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><code class="literal">"{0:e3}" -f 602214076000000000000000</code></li><li><code class="literal">"0x{0:x}" -f 65535</code></li><li><code class="literal">"{0:p}" -f 58.25354</code></li><li><code class="literal">"{0:yyyy-MM-dd}" -f (Get-Date)</code></li></ol></div></div></div>