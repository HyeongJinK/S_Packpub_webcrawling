<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch02lvl1sec28"></a>Changing shell behavior using variables</h2></div></div><hr /></div><p>In the previous recipe, we took a look at the <span>existing</span><a id="id325885497" class="indexterm"></a> variables. In this recipe, we will <span>change</span><a id="id325885485" class="indexterm"></a> the value of one of the variables to control the behavior of PowerShell. Again, remember that the change in the value is ephemeral; the values would be reset once the PowerShell process is restarted.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec71"></a>Getting ready</h3></div></div></div><p>Read the previous recipe to understand the automatic variables that come predefined. Also, start Visual Studio Code. Perform the following steps to start Visual Studio Code:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Open applications (I use the GNOME desktop environment, which shows all applications with Super + <span class="emphasis"><em>A).</em></span></li><li>Type in <code class="literal">code</code>.</li><li>Press <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>`</em></span> to launch the Terminal.</li><li>Click on <strong class="userinput"><code>New File</code></strong> on the welcome screen (or press <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>N).</em></span></li></ol></div><div class="orderedlist"><ol class="orderedlist arabic" start="5" type="1"><li>At the bottom right of the Visual Studio Code window, you will see the file type set to <strong class="userinput"><code>Plain Text</code></strong>. Click on it; you will be taken to the command bar on top.</li><li>Type in <code class="literal">powershell</code> in the command bar. The <strong class="userinput"><code>PowerShell Integrated Console</code></strong> will open at the bottom:</li></ol></div><div class="mediaobject"><img src="/graphics/9781789137231/graphics/5713707b-6fc0-407c-b86f-31307a6af410.png" /></div><p>We are all set for the recipe now.</p><p> </p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec72"></a>How to do it…</h3></div></div></div><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Let's run a command that will result in an error. For now, let us not focus on the syntax of the command; our only goal for now is to generate an error. At the first line of the script window, type in the following:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-ChildItem /home/ram/random-directory</strong></span>
<span class="strong"><strong>PS&gt; Write-Host "Hello world!"</strong></span></pre><div class="mediaobject"><img src="/graphics/9781789137231/graphics/6fe459f0-a1f0-49e2-9c41-f7b2dc01605e.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Run the two-liner script using the <span class="emphasis"><em>F5</em></span> key:</li></ol></div><div class="mediaobject"><img src="/graphics/9781789137231/graphics/ab1d34ea-2035-4cab-a90b-437bb3605905.png" /></div><p>PowerShell is prompt to show an error. It also displays the <code class="literal">Hello world!</code> string.</p><p> </p><p> </p><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>Let's set the error <span>action</span><a id="id325906045" class="indexterm"></a> preference, using the variable, <code class="literal">ErrorActionPreference</code>. We know there's such a variable from the previous recipe. First, though, restart PowerShell. The easiest <span>way</span><a id="id325906057" class="indexterm"></a> is to click on the little bin icon at the top of the integrated console window. When Visual Studio Code asks if you would like to restart the session, click on <strong class="userinput"><code>Yes</code></strong>:</li></ol></div><div class="mediaobject"><img src="/graphics/9781789137231/graphics/9fb8970b-48a6-4de1-80be-6f76719f5fac.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>Set the <code class="literal">ErrorActionPreference</code> variable. At the <strong class="userinput"><code>PowerShell Integrated Console</code></strong>, enter the following:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Set-Variable ErrorActionPreference SilentlyContinue</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="5" type="1"><li><p>Run the two-liner script again.There is no error this time. And we see <code class="literal">Hello world!</code> at the console.</p></li></ol></div><p> </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip27"></a>Note</h3><p>If you do not want the entire script appear at the prompt, make the first line of the script <code class="literal">Clear-Host</code>; this will clear the screen before showing the output.</p></div><div class="orderedlist"><ol class="orderedlist arabic" start="6" type="1"><li>What if you were to check whether an error was generated at all? We check the value of the automatic variable, <code class="literal">Error</code>:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-Variable Error</strong></span></pre><div class="mediaobject"><img src="/graphics/9781789137231/graphics/f23c81cd-ff9c-48a9-bb60-6dd977d00069.png" /></div><p> </p><div class="orderedlist"><ol class="orderedlist arabic" start="7" type="1"><li>The <code class="literal">Value</code> column contains some text. Let's select and expand the contents of <code class="literal">Value</code>:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-Variable Error | Select-Object -ExpandProperty Value</strong></span></pre><div class="mediaobject"><img src="/graphics/9781789137231/graphics/2fe99c3a-6a8a-42a8-943c-7fbe793322b9.png" /></div><p>The output text is the same as what we <span>received</span><a id="id326000228" class="indexterm"></a> before we set the error <span>action</span><a id="id326000237" class="indexterm"></a> preference.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip28"></a>Note</h3><p>You can also simply call the <code class="literal">Error</code> variable to read all of the errors that occurred in the current session.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec73"></a>How it works…</h3></div></div></div><p>By default, the error action preference is <code class="literal">Continue</code>, which means that PowerShell would display the error and continue with the execution of the rest of the script (this effect is not noticeable when running individual commands; hence, the creation of the two-liner, or three-liner if you added <code class="literal">Clear-Host</code> at the top). By setting <code class="literal">ErrorActionPreference</code> to <code class="literal">SilentlyContinue</code>, we instruct PowerShell to record the error but not show it on the screen and, at the same time, to go on with <span>executing</span><a id="id326071465" class="indexterm"></a> the rest of the script.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec74"></a>See also</h3></div></div></div><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><code class="literal">about_Preference_Variables</code>, <code class="literal">$ErrorActionPreference</code> (<a class="ulink" href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_preference_variables?view=powershell-6#erroractionpreference" target="_blank">https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_preference_variables?view=powershell-6#erroractionpreference</a>)</li></ul></div></div></div>