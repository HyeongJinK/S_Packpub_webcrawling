<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch04lvl1sec56"></a>Sorting the output</h2></div></div><hr /></div><p>It is time for another simple cmdlet, which will <span>build</span><a id="id325913499" class="indexterm"></a> toward the <span class="emphasis"><em>Taking actions on the returned objects</em></span> recipe. In this recipe, we will sort the output objects to meet our requirements.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec156"></a>How to do it…</h3></div></div></div><p>We will continue using the directory and the files we created for this book. If all of your files are of size zero bytes, download a few files with content. The file type does not matter:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>List out the files in the directory:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-ChildItem -Path .</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Filter the output so that you have only files:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-ChildItem -Path . -File</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>Pipe the object to the <code class="literal">Sort-Object</code> cmdlet to sort the output based on the file size:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-ChildItem -Path . -File | Sort-Object -Property Length</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>The shorthand for this expression would be as follows:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; gci . -File | sort Length</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="5" type="1"><li>Sort the files, from the largest file to the smallest file:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-ChildItem -Path . -File | Sort-Object -Property Length -Descending</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="6" type="1"><li>Pick the largest three files in the lot:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-ChildItem -Path . -File | Sort-Object -Property Length -Descending -Top 3</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="7" type="1"><li>Create two files, and, using a text editor, add some content to both of them (or use the following script block to create some random text):</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; $($i = 0; while ($i -lt 520) {(-join ((65..90) + (97..122) | Get-Random -Count 8 | ForEach-Object {[char]$_})).ToString(); $i++}) -join ' ' | Out-File ./random-text-1.txt; Start-Sleep -Seconds 60; $($i = 0; while ($i -lt 500) {(-join ((65..90) + (97..122) | Get-Random -Count 8 | ForEach-Object {[char]$_})).ToString(); $i++}) -join ' ' | Out-File ./random-text-2.txt</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="8" type="1"><li>Now, sort the files in the directory, first by size, and then the name:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-ChildItem -Path . -File | Sort-Object -Property Length, Name</strong></span></pre><p>Observe the output that you get.</p><div class="orderedlist"><ol class="orderedlist arabic" start="9" type="1"><li>Sort the list in descending order:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-ChildItem -Path . -File | Sort-Object -Property Length, Name -Descending</strong></span></pre><p> </p><p>Note the <code class="literal">Length</code> column:</p><div class="mediaobject"><img src="/graphics/9781789137231/graphics/1f9d2605-fcf7-4fd4-9371-17db5c4ee529.png" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec157"></a>How it works…</h3></div></div></div><p>This recipe is another demonstration of passing objects <span>through</span><a id="id325892258" class="indexterm"></a> the pipeline. In the help documentation for <code class="literal">Sort-Object</code>, we can see a parameter called <code class="literal">InputObject</code>. This parameter is a generic term used in PowerShell for a parameter whose input comes through the pipeline.</p><p><code class="literal">Sort-Object</code> accepts input from the pipeline, and sorts the content based on the property specified. If a property is not specified, the default property for the object output from the preceding command is used for sorting. If there are multiple properties being used as input, the sorting happens based on the order in which the properties are specified.</p><p>Sorting can happen in ascending order (default) or descending order.</p><p> </p></div></div>