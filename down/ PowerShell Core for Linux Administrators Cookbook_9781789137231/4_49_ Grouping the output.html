<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch04lvl1sec55"></a>Grouping the output</h2></div></div><hr /></div><p>There are situations where we could group the objects that were given as <span>output</span><a id="id325909507" class="indexterm"></a> so that we could handle each group better, or simply so that we get a more organized output. In this recipe, we will look at passing the output of one cmdlet through the pipeline to <code class="literal">Group-Object</code> and group the output based on a property.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec152"></a>How to do it…</h3></div></div></div><p>To group objects based on a property, we will use the <code class="literal">Get-ChildItem</code> cmdlet on the files that we created for use in this book:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Navigate to the location where you created or downloaded the files:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Set-Location ~/random</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>List out only the files (exclude the directories):</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-ChildItem -Path . -File</strong></span></pre><p>Alternatively, you can use the <span>shorthand</span><a id="id325906037" class="indexterm"></a> version:</p><pre class="programlisting"><span class="strong"><strong>PS&gt; gci -File</strong></span></pre><p> </p><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>Group the objects based on the extension:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-ChildItem . -File | Group-Object Extension</strong></span></pre><p>The shorthand version of this would be as follows:</p><pre class="programlisting"><span class="strong"><strong>PS&gt; gci -File | group Extension</strong></span></pre><p>Here are all of the files, grouped by their extensions:</p><div class="mediaobject"><img src="/graphics/9781789137231/graphics/d93094ef-9d37-4d1b-93c5-361a3c5d2bdd.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>Use the <code class="literal">Select-Object</code> cmdlet to only show the extension and the number of files in each extension:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-ChildItem -Path . -File | Group-Object -Property Extension | Select-Object -Property Name, Count</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="5" type="1"><li>Is there a simpler way to do this? Of course:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-ChildItem -Path . -File | Group-Object -Property Extension -NoElement</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="6" type="1"><li>Now that we know how to handle grouping and expanded property selection, let's pick only the JPG files from the lot:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-ChildItem -Path . -File | Group-Object -Property Extension | Where-Object Name -EQ .jpg | Select-Object -ExpandProperty Group</strong></span></pre><p> </p><p>Here is the output of the preceding command:</p><div class="mediaobject"><img src="/graphics/9781789137231/graphics/c2dce43a-170d-4829-b222-34da89c83923.png" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec153"></a>How it works…</h3></div></div></div><p>What we did in this recipe was certainly non-intuitive, considering that we could use just <code class="literal">Where-Object</code> along with <code class="literal">Get-ChildItem</code>. However, the intention of this recipe was to demonstrate the use of <code class="literal">Group-Object</code>. The <code class="literal">Group-Object</code> cmdlet creates groups based on the criteria we specify, and names the groups on the criteria. In our case, the criteria for grouping was the extension, and so the names of the groups were the extensions.</p><p>Each of these groups contains its elements, which are objects in themselves. If we <span>simply</span><a id="id325913517" class="indexterm"></a> want the count and the names of the groups, we use the <code class="literal">NoElement</code> parameter. If we want only the elements, we use the <code class="literal">ExpandProperty</code> parameter of the <code class="literal">Select-Object</code> cmdlet and expand all of the elements. The elements that are expanded are the objects of the cmdlet preceding the <code class="literal">Group-Object</code> cmdlet (<code class="literal">Get-ChildItem</code>, in our case).</p><p>If <code class="literal">Where-Object</code> and other cmdlets could do what <code class="literal">Group-Object</code> could in a complicated way, why have it in the first place? Read on until the <span class="emphasis"><em>Taking actions on the returned objects</em></span> recipe to find out more.</p><p> </p><p> </p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec154"></a>There's more…</h3></div></div></div><p>If you have gotten the hang of tab-completion, you need not even select the properties that are not shown by default. All you have to do is type<code class="literal">Group-Object</code>after the pipe, add a space, and press the <span class="emphasis"><em>Tab</em></span>key; PowerShell will show you what objects are available to use for grouping. Try it out with the following command:</p><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-ChildItem . -File | Group-Object&lt;Space&gt;&lt;Tab&gt;</strong></span></pre></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec155"></a>See also</h3></div></div></div><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">The <span class="emphasis"><em>Taking actions on the returned objects</em></span> recipe</li></ul></div></div></div>