<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch01lvl1sec11"></a>Introduction</h2></div></div><hr /></div><p>Carl Sagan once said the following:</p><div class="blockquote"><blockquote class="blockquote"><p><span class="emphasis"><em>If you are skeptical, then no new ideas will make it through to you. You will never learn anything new. You become a crotchety old person convinced that nonsense is ruling the world. (There is, of course, much data to support you.) But every now and then, maybe once in a hundred cases, a new idea turns out to be on the mark, valid, and wonderful. If you are too much in the habit of being skeptical about everything, you are going to miss or resent it, and … you will be standing in the way of understanding and progress.</em></span></p></blockquote></div><p> </p><p>Us system administrators start building our arsenal of administration tools from the very first day. Usually, we do not think of adding tools to do something that our favorite already does—this would be like adding a redundant weapon. However, these alternate tools turn out to be great. PowerShell, to me, was one such tool.</p><p>There is a good chance that you are reading this page at a bookstore—digital or physical—and there is a good chance that the question in your mind is, Is this book for me?</p><p>The answer is probably yes, if you are any of the following:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">A Linux administrator, open to other scripting frameworks</li><li style="list-style-type: disc">A system administrator who manages Linux as well as Windows workloads, looking to unify management</li><li style="list-style-type: disc">A Linux administrator who wants a framework that handles—and aces in—structured data (as a side note, PowerShell is probably the only framework in Linux that works well with structured data)</li><li style="list-style-type: disc">A Windows Administrator, new to PowerShell, wanting to learn PowerShell scripting</li><li style="list-style-type: disc">A generally curious system administrator</li></ul></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec9"></a>A brief note on .NET Core</h3></div></div></div><p>Microsoft's announcement of open sourcing .NET in 2014 <span>almost</span><a id="id325896137" class="indexterm"></a> stirred a storm. Many rushed to the stands (so to speak) to read about the unbelievable—how could Microsoft possibly open source the core of their operating system? Some were cynical, while others rejoiced. Then came the announcement—a little louder and clearer—that <span class="strong"><strong>.NET Core</strong></span> was open source, not the <span class="strong"><strong>.NET Framework</strong></span>. Many said that .NET Core was a subset of .NET Framework.</p><p>.NET was first announced in 2000, as a new platform based on internet standards. Along with it, by the end of the year, Microsoft published the <span class="strong"><strong>Common Language Infrastructure</strong></span> as a standard, so that <span>anyone</span><a id="id325896171" class="indexterm"></a> who wanted could write their own .NET framework based on those standards. .NET Framework has been the basis of Windows since the noughties.</p><p>Windows PowerShell was released to the general market in 2006, as an implementation of .NET Framework, and focused on system administrators (or sysadmins), enabling them to better manage their workloads or daily activities and automate them. PowerShell 1.0 was leaps and bounds ahead of the hitherto rulers of automation Windows: Batch and VBScript.</p><p> </p><p>In June, 2016, Microsoft released a collaboratively refactored, more modern and efficient .NET. The .NET Core was officially born. While .NET Framework continues to rule the Windows arena, .NET Core, which is open source and cross-platform, has picked up great momentum and grows every day. .NET Core seems to be the way forward.</p><p>PowerShell Core is based on .NET Core, and therefore is open source, with the same vision as .NET Core: to be cross-platform.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec10"></a>The assumptions</h3></div></div></div><p>This book assumes no experience in PowerShell, and so sticks to the basic and intermediate levels. That is to say, we will not create complex PowerShell modules in this book. We will start by installing PowerShell, understanding the object model, working through scripting by understanding PowerShell constructs, creating functions, creating simple script modules, and so on, as system administrators (and not as programmers). We will also learn how to manage Docker and cloud workloads using PowerShell.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec11"></a>How to read this book</h3></div></div></div><p>You may skip recipes or even chapters. Whenever there is a need for something we created in a recipe that you have skipped, we will mention the recipe in the prerequisites. For example, we will state something similar to the following: follow the <span class="emphasis"><em>How to do it…</em></span> section of the skipped recipe to fulfill this prerequisite.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec12"></a>An important note</h3></div></div></div><p>There are two editions of PowerShell available today:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Windows PowerShell (up to v5.1, proprietary; <code class="literal">powershell</code>)</li><li>PowerShell Core (6.0+, open source; <code class="literal">pwsh</code>)</li></ol></div><p>Windows PowerShell is based on .NET Framework, which is Microsoft's proprietary framework that Windows is built on. PowerShell began at 1.0, and was considered feature-complete at 5.1. Microsoft has stopped developing Windows PowerShell; going forward, it will only receive bug fixes.</p><p>The open source PowerShell Core 6.0 is based on the open source .NET Core. This book is about open source PowerShell. Windows PowerShell and PowerShell Core are two different entities, with two different code bases.</p><p> </p><p> </p><p>While PowerShell to a Windows administrator has so far meant Windows PowerShell, officially, PowerShell now means the open source PowerShell Core. In this book, we follow this convention: going forward, every mention of PowerShell points to the open source <span>PowerShell</span><a id="id325896317" class="indexterm"></a> Core 6. Windows PowerShell is referred to as Windows PowerShell.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec13"></a>Writing the cmdlets (Linux admins note)</h3></div></div></div><p>If you are a Linux administrator, chances are, you do not like long commands—verbosity, to be specific. We will try to make the commands as short as possible, but in the interest of readability (which is an <span>important</span><a id="id325896336" class="indexterm"></a> convention in PowerShell), we will also mention the full commands.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip3"></a>Note</h3><p>Tab completion comes in handy for reducing keystrokes. PowerShell tab-completes cmdlets, parameters, and in many cases, even parameter values. We will learn about this in the <span class="emphasis"><em>Running cmdlets with minimal keystrokes</em></span> section of <a class="link" href="#" linkend="ch02">Chapter 2</a>, <span class="emphasis"><em>Preparing for Administration Using PowerShell</em></span>.</p></div><p>In general, we split scripting from running cmdlets on the console in the following ways:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">By using aliases (carefully) and short parameter names at the Terminal to save keystrokes and time</li><li style="list-style-type: disc">By being verbose in scripts, so that everyone using them can read and understand them</li></ul></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec14"></a>Off we go</h3></div></div></div><p>This is where it all starts: with the installation of <span>PowerShell</span><a id="id325896378" class="indexterm"></a> on your system. The installation of PowerShell is simple and straightforward. Since PowerShell is open source, its source code is available on GitHub. At the moment, Windows, Debian (and Ubuntu), Red Hat Linux (and CentOS), Fedora, OpenSUSE, and macOS are officially supported by the PowerShell project. Arch Linux and Kali Linux are supported by the community, as indicated in the <code class="literal">README</code> project. Community support is also available for the Snapcraft edition of PowerShell, which can be used on many of the modern-day Linux distributions.</p><p>PowerShell 6, at the time of writing this book, is experimentally available for Raspbian Stretch as well as the ARM edition of Windows (<a class="ulink" href="https://github.com/PowerShell/PowerShell/blob/master/README.md" target="_blank">https://github.com/PowerShell/PowerShell/blob/master/README.md</a>).</p></div></div>