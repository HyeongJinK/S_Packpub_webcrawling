<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch12lvl1sec129"></a>Adding default values to the parameter</h2></div></div><hr /></div><p>Sometimes, it is possible to give a <span>parameter</span><a id="id325585847" class="indexterm"></a> in a function a default value. In this case, we do not specify the parameter as a mandatory one (if we do, the function will disregard the default value and prompt for a value anyway).</p><p>In this recipe, we will revisit the count function and focus on the default value.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch12lvl2sec337"></a>How to do it…</h3></div></div></div><p>We will use the same script that we did in the <span class="emphasis"><em>Defining parameters</em></span> recipe, with two small changes in it. Create a PowerShell script file with the following content:</p><pre class="programlisting">function Start-Count {
    param (
        # The current time, or the starting point
        [Parameter(Mandatory=$false)]
        [Alias("CT", "From")]
        [int]
        $CurrentTime=0,

        # The total number of seconds to count
        [Parameter(<span class="strong"><strong>Mandatory=$false</strong></span>, Position=1)]
        [Alias("TT", "To")]
        [int]
        <span class="strong"><strong>$TotalTime=10</strong></span>
    )

    while ($CurrentTime -le $TotalTime) {
        Write-Progress -Activity "Counting to $TotalTime" -Status "Counting: $CurrentTime seconds" -PercentComplete ($CurrentTime / $TotalTime * 100)
        Start-Sleep 1
        $CurrentTime++
    }
}</pre><p>At the terminal, dot-source and run the script. Call the function without passing any parameters.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch12lvl2sec338"></a>How it works…</h3></div></div></div><p>Sometimes, it is possible to assign a default value to a parameter so that the administrators do not have to necessarily specify any value to it when calling the cmdlet. One of the examples for this is the <code class="literal">ResultSize</code> parameter in the <code class="literal">Get-Mailbox</code> cmdlet in Microsoft Exchange. By default, calling <code class="literal">Get-Mailbox</code> without any parameter would return 1,000 mailboxes.</p><p>The default value, of course, can be overridden by explicitly specifying a value for the parameter when calling the function. Let's say we're running the following code:</p><pre class="programlisting"><span class="strong"><strong>PS&gt; Start-Count</strong></span></pre><p>This would count to <code class="literal">10</code>. To override this behavior—to, say, make the function count to <code class="literal">4</code>—you would call the following:</p><pre class="programlisting"><span class="strong"><strong>PS&gt; Start-Count -to 4</strong></span></pre><p>Do not make the <span>parameter</span><a id="id325585851" class="indexterm"></a> mandatory if it has a default value. Not only does it defeat the purpose of having a default value by prompting for input anyway, but it is also illogical to do so.</p><p> </p><p> </p></div></div>