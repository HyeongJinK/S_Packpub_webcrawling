<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch03lvl1sec41"></a>Working with date properties</h2></div></div><hr /></div><p>PowerShell is best learned by starting with <span>simple</span><a id="id326021453" class="indexterm"></a> cmdlets. And <code class="literal">Get-Date</code> is one of the simplest, yet not completely leveraged cmdlets present in PowerShell. In this recipe, we will play with dates and see how they can be used in different scenarios. As always, the possibilities with PowerShell are quite more than a book can cover. In the interest of brevity, we will look at just enough to enable you to launch yourself gracefully into the world of PowerShell automation; the rest, you should be able to handle by yourself.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec113"></a>Getting ready</h3></div></div></div><p>If you followed along with the previous chapters and performed all of the exercises mentioned in them, you should be good to go. Otherwise, go to <a class="link" href="#" linkend="ch01">Chapter 1</a>, <span class="emphasis"><em>Introducing PowerShell Core</em></span>, and get yourself a copy of PowerShell. Come back here to continue. This recipe uses only the Terminal, so there is no need for anything else.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec114"></a>How to do it…</h3></div></div></div><p>Before we start working with dates, let's make a simple call for the date:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Display the current date and time:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-Date</strong></span>

Saturday, 16 June 2018 12:14:07</pre><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Find out what members this returned object <span>has:</span></li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-Date | Get-Member</strong></span></pre><div class="mediaobject"><img src="/graphics/9781789137231/graphics/444f04a4-4cbc-4fdd-86a9-871150d15a75.png" /></div><p>There is a whole bunch of properties and methods.</p><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>Attempt to display the date using the format 16/06/2018<span>:</span></li></ol></div><div class="mediaobject"><img src="/graphics/9781789137231/graphics/187b8a57-9475-4d61-9cb7-68bc0d8c79f0.png" /></div><p>The colors do not look right.</p><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>Change the command as follows. The syntax should look better now, based on <span>your</span><a id="id325901965" class="indexterm"></a> Terminal theme (Don't worry about why the change works for now; we shall look at this when dealing with variables at a later point.):</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; "$($Date.Day)/$($Date.Month)/$($Date.Year)"</strong></span>
16/6/2018</pre><p>But that was a lot of work. Is there an easier way?</p><p> </p><div class="orderedlist"><ol class="orderedlist arabic" start="5" type="1"><li>Look in Help to see what parameters you get:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-Help Get-Date</strong></span></pre><p>The Help text shows that there is a <code class="literal">Format</code> parameter.</p><div class="orderedlist"><ol class="orderedlist arabic" start="6" type="1"><li>Type the following to get the short date:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-Date -Format d</strong></span></pre><p>Try the following as the values for <code class="literal">Format</code>: <code class="literal">g</code>, <code class="literal">U</code>, <code class="literal">yyyy/MM/dd</code> and <code class="literal">yyyyMMddhhmmss</code><span>.</span></p><div class="mediaobject"><img src="/graphics/9781789137231/graphics/83065ddd-96ca-4749-a2c8-a8da93cdf20c.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="7" type="1"><li>If you're more comfortable with the UNIX formatting of date, use the <code class="literal">Uformat</code> parameter:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-Date -Uformat %d/%m/%Y</strong></span></pre><p>Let's take one more step to pass a custom date to the system and fetch a little information from it, leveraging the members of the object that is output by <code class="literal">Get-Date</code>.</p><div class="orderedlist"><ol class="orderedlist arabic" start="8" type="1"><li>Find what day Halloween falls on in 2018:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; (Get-Date -Day 31 -Month 10 -Year 2018).DayOfWeek</strong></span>
Wednesday</pre><div class="orderedlist"><ol class="orderedlist arabic" start="9" type="1"><li>If you know how the date in your locale works, pass the date as follows and get the same information:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; (Get-Date 31/10/2018).DayOfWeek</strong></span></pre><p> </p><div class="orderedlist"><ol class="orderedlist arabic" start="10" type="1"><li>If you remember the concept of cast operators, use it to get the information you need:</li></ol></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note33"></a>Note</h3><p>Remember to use the YMD or MDY format when calling the <code class="literal">DateTime</code> accelerator, in order to avoid errors.</p></div><pre class="programlisting"><span class="strong"><strong>PS&gt; ([datetime]'10/31/2018').DayOfWeek</strong></span></pre><p>To avoid ambiguity, spell out the month:</p><pre class="programlisting"><span class="strong"><strong>PS&gt; ([datetime]'31 October 2018').DayOfWeek</strong></span></pre></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec115"></a>How it works…</h3></div></div></div><p>The <code class="literal">System.DateTime</code> class in .NET packs a good enough amount of properties and methods. The <code class="literal">Get-Date</code> cmdlet leverages these properties and methods by means of encapsulation. The <code class="literal">Get-Date</code> cmdlet, by default, pulls the current date and time of the system and allows you to pick child objects from it, or quickly tie them together as formats.</p><p>Besides these operations, the cmdlet also allows you to pass a simple string format such as date and time and converts the input string into the <code class="literal">DateTime</code> object.</p><p>While <code class="literal">Get-Date</code> takes into account <span>your</span><a id="id326017232" class="indexterm"></a> current locale, the type accelerator, <code class="literal">DateTime</code>, works on the YMD—or the MDY-formatted date-time.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec116"></a>See also</h3></div></div></div><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">The <code class="literal">DateTimeFormatInfo</code> Class | Remarks (<a class="ulink" href="https://docs.microsoft.com/en-us/dotnet/api/system.globalization.datetimeformatinfo?redirectedfrom=MSDN&amp;view=netframework-4.7.2#Remarks" target="_blank">https://docs.microsoft.com/en-us/dotnet/api/system.globalization.datetimeformatinfo?redirectedfrom=MSDN&amp;view=netframework-4.7.2#Remarks</a><a class="ulink" href="https://docs.microsoft.com/en-us/dotnet/api/system.globalization.datetimeformatinfo?redirectedfrom=MSDN&amp;view=netframework-4.7.2#Remarks" target="_blank">)</a></li><li style="list-style-type: disc">The <span class="emphasis"><em>Parsing input from text to object</em></span> recipe <span>from</span><a id="id326017502" class="indexterm"></a><a class="link" href="#" linkend="ch01">Chapter 1</a>, <span class="emphasis"><em>Introducing PowerShell Core</em></span></li></ul></div><p> </p></div></div>