<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch07lvl1sec79"></a>Using If–ElseIf–Else conditions to control script flow</h2></div></div><hr /></div><p>We have seen how operators work. Try out more of these <span>operators</span><a id="id326385998" class="indexterm"></a> until it becomes second nature to you. Most of the flow control, as well as filtration in scripts, happens using these operators.</p><p>In this recipe, we are going to look at conditional script flow, also known as branching. In essence, branching works on two conditions (correct: <code class="literal">$true</code> and <code class="literal">$false</code>). This is generally achieved using two constructs:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">The <code class="literal">If–ElseIf–Else</code> construct</li><li style="list-style-type: disc">The <code class="literal">Switch–Case</code> construct</li></ul></div><p>In this recipe, we will give ourselves a simple problem to solve: finding out if today is one of the days of the weekend.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec212"></a>Getting ready</h3></div></div></div><p>These recipes require that you to try them out so that you understand how they work. These work better on an integrated scripting environment (preferably Visual Studio Code) than at the prompt. To run the scripts in Visual Studio Code, use the <span class="emphasis"><em>F5</em></span> key. These recipes should work identically on Windows PowerShell 3.0+ as well: the syntax for these constructs is exactly the same in PowerShell and Windows PowerShell.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec213"></a>How to do it…</h3></div></div></div><p>Open a new PowerShell file in Visual Studio Code:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Enter the following in the code pane to simply find out if it is a weekend day:</li></ol></div><pre class="programlisting">$Date=Get-Date

<span class="strong"><strong>if ($Date.DayOfWeek-in'Saturday','Sunday'</strong></span><span class="strong"><strong>) {</strong></span>
Write-Host'We party on weekends!'-BackgroundColor Yellow -ForegroundColor Black
}</pre><p> </p><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>If you would like to get an output on weekdays as well, use the following code:</li></ol></div><pre class="programlisting">$Date=Get-Date
<span class="strong"><strong>if ($Date.DayOfWeek-in'Saturday','Sunday'</strong></span><span class="strong"><strong>) {</strong></span>
Write-Host'It is a weekend!'
}
<span class="strong"><strong>else</strong></span><span class="strong"><strong> {</strong></span>
Write-Host'It is a weekday.'
}
</pre><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>If you would like to jazz it up a little, and use the whole of <code class="literal">if</code>–<code class="literal">elseif</code>–<code class="literal">else</code>, use the following code:</li></ol></div><pre class="programlisting">$Date = Get-Date

<span class="strong"><strong>if ($Date.DayOfWeek -in 'Saturday', 'Sunday') {</strong></span>
    Write-Host 'We party on weekends!' -BackgroundColor Yellow -ForegroundColor Black
}
<span class="strong"><strong>elseif ($Date.DayOfWeek -eq 'Wednesday') {</strong></span>
    Write-Host 'Half the week is over, and I want to do so much more!'
}
<span class="strong"><strong>else {</strong></span>
    Write-Host 'Work is worship. Ahem!'
}</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip55"></a>Note</h3><p>In general, <code class="literal">Write-Output</code> is a better cmdlet to use than <code class="literal">Write-Host</code>. <code class="literal">Write-Host</code> writes the output only to the host; this output cannot be sent to anything else without manipulation. Use <code class="literal">Write-Host</code> only on occasions that need it.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec214"></a>How it works…</h3></div></div></div><p>Simple branching could work with just the <code class="literal">If</code> statement. The statement <span>checks</span><a id="id325898630" class="indexterm"></a> for truth, and executes the code block based on the outcome of the condition. In the case of <code class="literal">either–or</code>, where there are only two conditions, use <code class="literal">If–Else</code>. When there are more than two possible outcomes, use <code class="literal">If–ElseIf–Else</code>. The <code class="literal">else</code> block is the catch-all.</p><p> </p><p> </p></div></div>