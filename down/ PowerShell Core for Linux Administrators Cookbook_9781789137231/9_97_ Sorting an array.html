<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch09lvl1sec98"></a>Sorting an array</h2></div></div><hr /></div><p>Sorting an array is no different from <span>sorting</span><a id="id325898672" class="indexterm"></a> anything else in PowerShell. PowerShell treats arrays as objects, too. This recipe will be simple.</p><p>The scenario is that you need to sort the names given in the previous recipe based on the first name. Then, you need to convert the names to the <code class="literal">LastName, FirstName</code> format.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl2sec260"></a>How to do it…</h3></div></div></div><p>This recipe is simple. We simply add another cmdlet to the first line of the script. Here is the flow:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Import the content using <code class="literal">Get-Content</code>. Pipe this output to <code class="literal">Sort-Object</code>.</li><li>Use a <code class="literal">foreach</code> loop to go through the names one by one.</li><li>Split the first name and the last name, swap them, and separate them with a comma and a space.</li></ol></div><p>The following script will accomplish this:</p><pre class="programlisting">$Names = Get-Content ./ch09/02-names.txt <span class="strong"><strong>| Sort-Object</strong></span>
$NewNames = @()

foreach ($Name in $Names) {
    $Name = $Name -split ' '
    $NewName = $Name[1], $Name[0] -join ', '

    $NewNames += $NewName
}
$NewNames</pre></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl2sec261"></a>How it works…</h3></div></div></div><p>The sorting happens at the first line. <code class="literal">Get-Content</code> imports the name as an array of strings. At this point, the input object is an array. <code class="literal">Sort-Object</code> then sorts the elements in this object. From here on, the process is the same as the <span class="emphasis"><em>Accessing and manipulating array items</em></span> recipe.</p><p>Of course, there are other ways to do this, one being to replace the last line of the script with the following:</p><pre class="programlisting">$NewNames = $NewNames | Sort-Object</pre></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl2sec262"></a>There's more…</h3></div></div></div><p>Create a CSV with first names and last names as two different columns. Add the age of each of these <span>members</span><a id="id325585856" class="indexterm"></a> to the CSV. Now, sort based on the age, then on the last name.</p><p> </p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl2sec263"></a>See also</h3></div></div></div><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><span class="emphasis"><em>Sorting the output</em></span> from <a class="link" href="#" linkend="ch04">Chapter 4</a>, <span class="emphasis"><em>Passing Data through the Pipeline</em></span></li></ul></div></div></div>