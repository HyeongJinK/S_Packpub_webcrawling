<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch10lvl1sec112"></a>Working with files and directories</h2></div></div><hr /></div><p>In the previous recipe, <span class="emphasis"><em>Working with locations</em></span>, we created paths. In this recipe, we will create actual <span>files</span><a id="id325901993" class="indexterm"></a> and directories. The scenario is this:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>You have the <code class="literal">random</code> directory within <code class="literal">$HOME</code>. This <span>directory</span><a id="id325901970" class="indexterm"></a> contains <code class="literal">dir-01</code>, <code class="literal">dir-02</code>, <code class="literal">dir-03</code>, and <code class="literal">dir-04</code>. Create a file, called <code class="literal">demo.txt</code> within all of these four directories.</li><li>Create new empty files, <code class="literal">random-text.txt</code>, <code class="literal">himalayas.jpg</code>, <code class="literal">crunched-numbers.csv</code>, <code class="literal">screenshot-001.png</code>, <code class="literal">screenshot-002.png</code>, <code class="literal">screenshot-003.png</code>, <code class="literal">demo.doc</code>, and <code class="literal">my-plugin.rb</code>, within <code class="literal">$HOME/random/dir-01</code>.</li><li>Rename <code class="literal">screenshot-001.png</code> as <code class="literal">myscreenshot.png</code>.</li><li>Copy <code class="literal">myscreenshot.png</code> into <code class="literal">dir-02</code>.</li><li>Finally, remove the <code class="literal">dir-04</code> directory, and everything within it.</li></ol></div><p> </p><p>Ensure that the script is platform-agnostic.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch10lvl2sec296"></a>How to do it…</h3></div></div></div><p>Again, this is quite a set of tasks to do. Let's get cracking and spawn a little script to do this for us:</p><pre class="programlisting">Set-Location (Join-Path $HOME random)

Join-Path dir-01, dir-02, dir-03, dir-04 -ChildPath demo.txt | ForEach-Object { New-Item $PSItem -ItemType File } 'random-text.txt', 'himalayas.jpg', 'crunched-numbers.csv', 'screenshot-001.png', 'screenshot-002.png', 'screenshot-003.png', 'demo.doc', 'my-plugin.rb' | ForEach-Object { New-Item (Join-Path dir-01 -ChildPath $PSItem) -ItemType File } Rename-Item screenshot-001.png myscreenshot.png # Verbose version: Rename-Item -Path screenshot-001.png -NewName myscreenshot.png 
Copy-Item myscreenshot.png dir-02
# Verbose version: Copy-Item -Path myscreenshot.png -Destination ./dir-02

Remove-Item dir-04 -Recurse
# Verbose version: Remove-Item -Path dir-04 -Recurse</pre></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch10lvl2sec297"></a>How it works…</h3></div></div></div><p>The first task that this recipe does is create files and directories. By providing multiple parent paths to the <code class="literal">Join-Path</code> cmdlet, we create <code class="literal">demo.txt</code> at four locations. We use the <code class="literal">Foreach-Object</code> cmdlet to perform this iterative task. Next, we twist the process a little; we pass several strings into the pipeline, and then use a <code class="literal">Join-Path</code> subexpression within <code class="literal">New-Item</code>, thereby creating multiple child paths at the parent location.</p><p><code class="literal">New-Item</code> can create items based on what you define as the <code class="literal">ItemType</code>.</p><p>Next, we rename a file using the <code class="literal">Rename-Item</code> cmdlet, copy a file using the <code class="literal">Copy-Item</code> cmdlet, and recursively delete a directory using the <code class="literal">Remove-Item</code> cmdlet with the <code class="literal">Recurse</code> switch.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip67"></a>Note</h3><p>Many (but not all) parameters in PowerShell accept wildcard input. This is indicated by <code class="literal">Accept wildcard characters?</code> shown upon running <code class="literal">Get-Help</code> with the <code class="literal">Full</code> switch parameter or the <code class="literal">Parameter</code> parameter. For example, the <code class="literal">ChildPath</code> parameter in <code class="literal">Join-Path</code> cannot work with wildcard characters in paths.</p></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note68"></a>Note</h3><p>Any providers that support the concept of items automatically support these cmdlets as well.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch10lvl2sec298"></a>There's more…</h3></div></div></div><p>Try to rename all screenshots as captures. For instance, <code class="literal">screenshot-001.png</code> should be renamed as <code class="literal">capture-001.png</code>. </p></div></div>