<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch07lvl1sec82"></a>Writing a basic looping construct</h2></div></div><hr /></div><p>Automation is perhaps only half-complete without loops. After all, the point of <span>automation</span><a id="id326228473" class="indexterm"></a> in most situations is making the computer do what is repetitive. There are six looping constructs in PowerShell in all:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">Looping using <code class="literal">Foreach-Object</code></li><li style="list-style-type: disc">The <code class="literal">Foreach</code> loop</li><li style="list-style-type: disc">The <code class="literal">For</code> loop</li><li style="list-style-type: disc">The <code class="literal">While</code> loop</li><li style="list-style-type: disc">The <code class="literal">Do–While</code> loop</li><li style="list-style-type: disc">The <code class="literal">Do-Until</code> loop</li></ul></div><p>The <code class="literal">Foreach-Object</code> looping construct is perhaps the simplest of them all.</p><p>Let's imagine that we have a list of five guests to a certain event, and you would like to greet them each individually.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec219"></a>How to do it…</h3></div></div></div><p>Let's assume that the guests are Mr Jain, Mr Jacobs, Ms Sanders, Mr Shah, and Mr Hugo:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Open a new file in Visual Studio Code and, in the script pane, type the following:</li></ol></div><pre class="programlisting">$GuestsRaw = Read-Host "Enter the guest names, separated by commas"
$Guests = $GuestsRaw -split ",$([regex]'[\s]*')"

<span class="strong"><strong>$Guests | ForEach-Object { Write-Output "Welcome, $PSItem!" }</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Run the script and at the prompt, type in the names of the guests:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Mr Jain, Mr Jacobs, Ms Sanders, Mr Shah, Mr Hugo</strong></span></pre><p> </p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec220"></a>How it works…</h3></div></div></div><p>First, you take in the input through a prompt from the host. The raw guest list is taken in. PowerShell then splits the input string based on the commas and a regular expression match (this is necessary so that it works regardless of whether the input contains a space after the comma or not: not all users are alike). We use the <code class="literal">-split</code> and <code class="literal">cast</code> operators for the operation.</p><p>The loop part comes in at <code class="literal">Foreach-Object</code>. You pass the array <span>object</span><a id="id325877532" class="indexterm"></a> into the pipeline. The <code class="literal">Foreach-Object</code> cmdlet picks up the array, and processes one element at a time. When referring to the element within the loop, you use the <code class="literal">$PSItem</code> (that is, <code class="literal">$_</code>) automatic variable, since the object has been passed through the pipeline.</p></div></div>