<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch11lvl1sec118"></a>Displaying an interactive menu</h2></div></div><hr /></div><p>Many of our clients outsource their Service Desks to <span>offshore</span><a id="id326021820" class="indexterm"></a> service providers. Many of these Service Desk agents are not comfortable running commands or scripts, and some of our clients are uncomfortable providing Service Desk agents with a no-UI script. One such L1 Support team came to us with a requirement for a script to partially automate account termination backup. Most importantly, we were asked to provide the agents with a textual menu that they would interact with to start the right kind of backup (mailbox, membership, home drive, and so on).</p><p>In this recipe, we will replicate that menu, but not actually call the backup functions.</p><p> </p><p> </p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch11lvl2sec309"></a>How to do it…</h3></div></div></div><p>The requirements are simple. We will create a script that displays the following menu:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Mailbox backup</li><li>Home drive backup</li><li>Mailbox and home drive backup</li><li>Mailbox, home drive, and group membership backup</li></ol></div><p>Here is the script that will show this menu:</p><pre class="programlisting">$Menu = @'
Hello! Welcome to the Terminated Account Backup Utility (TABU)!

1. Mailbox backup
2. Home drive backup
3. Mailbox and home drive backup
4. Mailbox, home drive, and group membership backup

Choose your backup type and enter the corresponding number
'@

$Choice = Read-Host $Menu

switch ($Choice) {
    1 {
        "You chose the mailbox backup. Initiating..."
        # Call the corresponding function here.
    }
    2 {
        "You chose the home drive backup. Initiating..."
        # Call the corresponding function here.
    }
    3 {
        "You chose to back up the mailbox as well as the home drive. Initiating..."
        # Call the corresponding function here.
    }
    4 {
        "You chose a complete backup. This person must be imporant! Initiating..."
        # Call the corresponding function here.
    }
    Default {
        "Invalid selection. Please try again."
    }
}</pre><p> </p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch11lvl2sec310"></a>How it works…</h3></div></div></div><p>This is another of the hard-to-tackle rocket science problems. To oversimplify this, the choice is assigned to the variable, and a <code class="literal">Switch-Case</code> block is made to proceed with the <span>task</span><a id="id326185404" class="indexterm"></a> based on the branch chosen.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch11lvl2sec311"></a>See also</h3></div></div></div><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">The <span class="emphasis"><em>Using Switch–Case conditions to control script flow</em></span> recipe from <a class="link" href="#" linkend="ch07">Chapter 7</a>, <span class="emphasis"><em>Flow Control using Branches and Loops</em></span></li></ul></div></div></div>