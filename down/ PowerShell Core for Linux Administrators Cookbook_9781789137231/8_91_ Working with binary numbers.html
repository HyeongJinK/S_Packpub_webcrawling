<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch08lvl1sec93"></a>Working with binary numbers</h2></div></div><hr /></div><p>In the interest of specificity, we are going to use the hexadecimal notification for this recipe. If you have <span>worked</span><a id="id325892162" class="indexterm"></a> with colors on your computer, chances are that you are aware of RGB. The levels of these primary colors are commonly represented as numbers ranging from 0 to 255 (24-bit colors). You may have also come across the hexadecimal representation of these colors, especially if you have worked with HTML/CSS.</p><p> </p><p>The scenario here is to write a simple script that converts any given hexadecimal code into decimal RGB.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch08lvl2sec248"></a>How to do it…</h3></div></div></div><p>We will assume that the input is going to be with or without the <code class="literal">#</code> (as in <code class="literal">55bc9a</code> or <code class="literal">#55bc9a</code>):</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Open a new PowerShell file and type the following:</li></ol></div><pre class="programlisting">$Rgb = Read-Host "Enter the hexadecimal RGB value"
$TrimmedRgb = $Rgb.Substring($Rgb.Length - 6)

$R = $TrimmedRgb.Substring(0, 2)
$G = $TrimmedRgb.Substring(2, 2)
$B = $TrimmedRgb.Substring(4, 2)

"Here are the R, G and B levels for the supplied hex value:"
$R, $G, $B | ForEach-Object { [int]("0x" + $PSItem) }</pre><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Run the script.</li><li>Enter any valid hexadecimal RGB value, with or without the preceding <code class="literal">#</code>. Press the <span class="emphasis"><em>Enter</em></span> ke<span class="emphasis"><em>y</em></span>.</li></ol></div><p>Here is an example:</p><div class="mediaobject"><img src="/graphics/9781789137231/graphics/efa53000-041a-4741-857c-7495863230ed.png" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch08lvl2sec249"></a>How it works…</h3></div></div></div><p>First, we will look at how the script works to separate the R, G, and B values. We first trim the hexadecimal string to exclude the <code class="literal">#</code> in case there is one. We need the last six characters of the string. Therefore, we use PowerShell to begin the substring at 1 in case there is a <code class="literal">#</code> and 0 in case the string is six characters long. We then pick two characters at a time, starting at 0 (of the trimmed string), 2, and 4.</p><p> </p><p>The conversion happens at the last line. First, we instruct PowerShell that we would like an integer output using the cast operator. Then, we tell PowerShell that the string is a hexadecimal string by adding <code class="literal">0x</code> to its beginning.</p><p>This is a simple way of converting a hexadecimal into an integer. Next, we will look at a <span>few</span><a id="id326449736" class="indexterm"></a> other conversions.</p></div></div>