<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch06lvl1sec76"></a>Splitting and combining strings</h2></div></div><hr /></div><p>Now that we have learned how to <span>match</span><a id="id325898621" class="indexterm"></a> and replace substrings, the next <span>step</span><a id="id325892297" class="indexterm"></a> for us in the journey of strings in PowerShell is to learn to split and combine them. This will leave us with understanding formatting operators so that we can learn to use strings effectively in PowerShell.</p><p>In this scenario, we have to create a log cleanup script that takes input in the form of a CSV file. This CSV file contains multiple rows of input, each being a location that needs regular cleanup, the number of days, worth of files to retain, the extension of the files to be cleaned up, and the paths to be excluded. The paths to be excluded must have multiple paths, separated by a semicolon. Here is a sample:</p><p> </p><div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; "><colgroup><col /><col /><col /><col /></colgroup><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>Path</strong></span></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>Retention</strong></span></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>Extension</strong></span></p></td><td style="border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>Exclusion</strong></span></p></td></tr><tr><td style="border-right: 0.5pt solid ; "><p><code class="literal">/home/coolapp/logs</code></p></td><td style="border-right: 0.5pt solid ; "><p>7</p></td><td style="border-right: 0.5pt solid ; "><p><code class="literal">.log</code></p></td><td style=""><p><code class="literal">/home/coolapp/logs/devicelogs;/home/coolapp/logs/install</code></p></td></tr></tbody></table></div><p> </p><p>Your task is to only split the exclusion paths so that they can be processed, and join them in a human-understandable way to echo on the Terminal.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec207"></a>How to do it…</h3></div></div></div><p>Our task is simple. We are only going to write the code block that will take the input and separate the various fields into variables. The exclusion list should be a single array variable. When displaying the output, we will display each exclusion path on separate lines. Follow these steps to complete this recipe:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>At the Terminal, type in the following:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; $PathInfo = Import-Csv './ch06/07-input.csv'</strong></span>

PS&gt; # Looping construct here
<span class="strong"><strong>PS&gt; $ExclusionPaths = $PathInfo.Exclusion -split ';'</strong></span>

PS&gt; # Some code block to handle deletion and other things

<span class="strong"><strong>PS&gt; Write-Host "These $($ExclusionPaths.Count) paths will be excluded from deletion: $($ExclusionPaths -join ', ')"</strong></span>
PS&gt; # End loop</pre><p> </p><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Since the script has run in the current session, you can fetch the values of the variables. Run the following commands to see what values you get:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; $PathInfo</strong></span>
<span class="strong"><strong>PS&gt; $ExclusionPaths</strong></span>
<span class="strong"><strong>PS&gt; $ExclusionPaths -join ', '</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>Note how the values differ.</li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec208"></a>How it works…</h3></div></div></div><p>How this works is simple. Based on how comfortable we are with scripting and how readable we would like to make the scripts, we assign values to variables. In our case, for the sake of ease of use, we split <code class="literal">$PathInfo.Exclusion -split ';'</code> into <code class="literal">$ExclusionPaths</code>.</p><p><code class="literal">$PathInfo.Exclusion</code> is a <span>single</span><a id="id325677264" class="indexterm"></a> string. However, <code class="literal">$ExclusionPaths</code> is a string array (which is why the <code class="literal">.Count</code> property returned 2).</p><p>When we had to display the array in a <span>single</span><a id="id325906051" class="indexterm"></a> human-readable sentence, we used the <code class="literal">-join</code> operator to join the two elements with a comma and a space. This works for any number of elements in the array.</p></div></div>