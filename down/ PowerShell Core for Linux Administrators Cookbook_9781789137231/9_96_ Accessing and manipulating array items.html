<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch09lvl1sec97"></a>Accessing and manipulating array items</h2></div></div><hr /></div><p>In this recipe, we will look at using the <span>array</span><a id="id325892260" class="indexterm"></a> in administration.</p><p>The scenario is that one of the administrative assistants has sent you a list of names in the <code class="literal">FirstName LastName</code> format. You need to change the format to <code class="literal">LastName, FirstName</code> so that you can process it further in a system that requires that format. The list <span>contains</span><a id="id325892160" class="indexterm"></a> over 100 names, and manual manipulation is ruled out.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl2sec256"></a>How to do it…</h3></div></div></div><p>We need a simple script to accomplish this. The assumption made for this recipe is that all names consist of two words, separated by a space. Each line in the input file contains only one name.</p><p>Here is the logical flow:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Import the content. <code class="literal">Get-Content</code> would import the names as an array of strings. However, we will not manipulate this array.</li><li>Use a <code class="literal">foreach</code> loop to go through the names one by one.</li><li>Split the first name and the last name. (Each <code class="literal">FirstName LastName</code> pair will be an array consisting of two strings.)</li><li>Place the last name, place a comma, and then place the first name.</li><li>Optionally, output the content to a file.</li></ol></div><p>The following script will accomplish this:</p><pre class="programlisting">$Names = Get-Content ./ch09/02-names.txt
$NewNames = @()

foreach ($Name in $Names) {
    $Name = $Name -split ' '
    $NewName = $Name[1], $Name[0] -join ', '

    $NewNames += $NewName
}
$NewNames</pre><p> </p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl2sec257"></a>How it works…</h3></div></div></div><p>This script block is a simple implementation of array manipulation. The first line of the script imports the names from the input file into the <code class="literal">$Names</code> variable.</p><p>We initialize a new array, <code class="literal">$NewNames</code>, to store the names in the <code class="literal">LastName, FirstName</code> format. <code class="literal">Get-Content</code> imports the text in the input file in the form of an array, the newline character being the separator of elements. Since <code class="literal">$Names</code> is an array, using the <code class="literal">foreach</code> loop to perform operations on the elements is possible.</p><p>Within the loop, we split the single string into two strings using the <code class="literal">split</code> operator. This, of course, converts <code class="literal">$Name</code> from a string into an array; the first name is the first <span>element</span><a id="id325885497" class="indexterm"></a> of the array, and the last name is the second. Next we perform a concatenation using the <code class="literal">join</code> operator.</p><p>We then add the values of <code class="literal">$NewName</code> to the <code class="literal">$NewNames</code> array to get all the <span>names</span><a id="id325898678" class="indexterm"></a> together.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl2sec258"></a>There's more…</h3></div></div></div><p>Try the same operation using the <code class="literal">Foreach-Object</code> cmdlet instead of the <code class="literal">foreach</code> loop.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl2sec259"></a>See also</h3></div></div></div><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><span class="emphasis"><em>Writing a basic looping construct</em></span> from <a class="link" href="#" linkend="ch07">Chapter 7</a>, <span class="emphasis"><em>Flow Control Using Branches and Loops</em></span></li><li style="list-style-type: disc"><span class="emphasis"><em>Writing a more complex loop on a predefined array</em></span> from <a class="link" href="#" linkend="ch07">Chapter 7</a>, <span class="emphasis"><em>Flow Control Using Branches and Loops</em></span></li><li style="list-style-type: disc"><span class="emphasis"><em>Splitting and combining strings</em></span> from <a class="link" href="#" linkend="ch06">Chapter 6</a>, <span class="emphasis"><em>Working with Strings</em></span></li></ul></div></div></div>