<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch03lvl1sec42"></a>Working with date and time methods</h2></div></div><hr /></div><p>In the previous recipe, <span class="emphasis"><em>Working with date properties</em></span>, we <span>focused</span><a id="id325885505" class="indexterm"></a> on the properties that the <code class="literal">DateTime</code> object has. The <span>parameters</span><a id="id325885493" class="indexterm"></a> we saw for <code class="literal">Get-Date</code> also worked on these properties. In this recipe, we shall look at methods within the <code class="literal">DateTime</code> object and learn to use them to our benefit. The main idea behind this recipe, though, is to make you comfortable using methods that are part of the output objects.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec117"></a>How to do it…</h3></div></div></div><p>Let's first start with converting local time into UTC:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>At the prompt, type in <code class="literal">Get-Date</code> and list out the members of the output object:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-Date | Get-Member</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Call the <code class="literal">ToUniversalTime</code> method:</li></ol></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip34"></a>Note</h3><p>Reduce keystrokes by using tab-completion.</p></div><pre class="programlisting"><span class="strong"><strong>PS&gt; (Get-Date).ToUniversalTime()</strong></span></pre><p>Compare the output to your local time.</p><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>Let's see what day it would be, exactly 35 days from today:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; (Get-Date).AddDays(35)</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>If you would like to see what time it would be after 3 hours and 18 minutes, type the following:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; (Get-Date).AddHours(3).AddMinutes(18)</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="5" type="1"><li>Find out how many days have passed since the World Environment Day, 2016. Enter the command as shown in the following screenshot:</li></ol></div><div class="mediaobject"><img src="/graphics/9781789137231/graphics/a5f0d199-5c0e-44c5-a5a2-f0f9256d30af.png" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec118"></a>How it works…</h3></div></div></div><p>The object that is returned by <code class="literal">Get-Date</code> has several methods just as it has properties. In this recipe, we use the methods to manipulate the date the way we need it. Methods are called with arguments. When you do not want to specify any argument, make sure to still call the methods with an empty pair of parentheses.</p><p>Methods can be chained in the way we did when adding hours as well as minutes. As long as the output object does not change, in most cases, you should be able to call methods pertaining to the object by chaining them. If, for instance, you convert the date object into a string at the first method, the second method should be a string input-enabled method. When in doubt, use the <code class="literal">Get-Member</code> cmdlet on the output to see what methods it would support.</p><p>When you look at <code class="literal">Get-Member</code> run against the <code class="literal">DateTime</code> object, you see that the <code class="literal">Subtract</code> method accepts <code class="literal">DateTime</code> as its argument. Hence, the use of <code class="literal">Get-Date</code> within the argument. Passing a cmdlet output as an <span>argument</span><a id="id325648981" class="indexterm"></a> to a method requires the cmdlet, along with the <span>parameters</span><a id="id325648989" class="indexterm"></a> that are passed, to be enclosed within an additional pair of parentheses :<code class="literal">Subtract(<span class="strong"><strong>(</strong></span>Get-Date '5 June 2016'<span class="strong"><strong>)</strong></span>)</code>, as opposed to <code class="literal">Subtract(Get-Date '5 June 2016')</code>. This is so that the inner command is executed first to get a value and then passed to the method.</p><p> </p></div></div>