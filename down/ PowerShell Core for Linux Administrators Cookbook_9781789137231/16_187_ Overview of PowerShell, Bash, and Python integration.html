<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch16lvl1sec181"></a>Overview of PowerShell, Bash, and Python integration</h2></div></div><hr /></div><p>Python has several strong points, which <span>makes</span><a id="id325905964" class="indexterm"></a> it worthy of attention. Apart from being a <span class="strong"><strong>Free and Open Source Software</strong></span> (<span class="strong"><strong>FOSS</strong></span>), it is, far more significantly, easy to learn. It is also easy to read, even for <span>people</span><a id="id325901993" class="indexterm"></a> who are not Python programmers. Python is capable of being used to write full-scale applications and server software, but as database administrators, we'll find it more interesting that it is very handy when it comes to writing quick utility scripts.</p><p>PowerShell's love with the Microsoft <span>community</span><a id="id325901990" class="indexterm"></a> is significant and we use it every day, but there's an entirely new world out there in the open source land. Linux is also a thriving community with a great set of tools and products to manage things more efficiently. In Linux arenas, when it comes to scripting, PowerShell is the weakling on the block. The big boys of scripting in Linux are Python and Perl. Although <span>PowerShell</span><a id="id325901975" class="indexterm"></a> and these languages are all technically cross-platform, it's clear that each language has its dominant audience.</p><p>Of course, SQL database administrators have already been taking advantage of PowerShell to manage databases and database servers, and those non-SQL administrators might have an upper hand with Python. However, when there are multiple ways of managing SQL servers, it cannot hurt to know more than one way to achieve near-perfect administration via APIs.</p><p>PowerShell Core is not meant to replace Python or any other Linux technology. I feel that it is a good companion tool to use in combination with Python. It's just another efficient way to extract and manipulate data as objects using the available .NET libraries and when creating automation solutions.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch16lvl2sec482"></a>Getting ready</h3></div></div></div><p>To get started, open the Linux Terminal and type in the <code class="literal">pwsh</code> command to open the PowerShell console.</p><p> </p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch16lvl2sec483"></a>How to do it…</h3></div></div></div><p>This recipe has a few samples so that you can understand PowerShell Core shell support for Python. The shell also supports any other programming languages such as Ruby, Perl, and so on.</p><p>In this case, let's look at a few Python script samples for beginners:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>To execute a Python script from the PowerShell console, type in the following command:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; python –c "print('Welcome to PowerShell and Python!') "</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>In this sample, you'll see the use of expressions and the integration of Python output with Powershell. The <code class="literal">firstPython.py</code>file has the following content. It has two arguments, that is, first and second. The first argument is referred to by <code class="literal">argv[1]</code>and the second is referred to by<code class="literal">argv[2]</code>. The values will be passed to arguments during the runtime. The output is then integrated with PowerShell values:</li></ol></div><pre class="programlisting">#!/usr/bin/pythonimport 
sysfirst=sys.argv[1]
second=sys.argv[2]
print(float(first)+float(second))</pre><p>The output is then integrated with integer values:</p><pre class="programlisting"><span class="strong"><strong>PS&gt; 3+ (python ./FirstPython.py 2 3) +5                         </strong></span>
<span class="strong"><strong>8</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>This example is of a Python script using <code class="literal">here-string</code> and <code class="literal">no-file-extension</code>. <code class="literal">here-string</code>is used to declare a block of text. It is very helpful for making a string of text an executable command. The text is encoded in ASCII format so that it can be read by search programs such as Findstr and Grep:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; @"&gt;&gt; #!/usr/bin/python</strong></span>
<span class="strong"><strong>&gt;&gt; import sys</strong></span>
<span class="strong"><strong>&gt;&gt; print(float(sys.argv[1])*float(sys.argv[2]))</strong></span>
<span class="strong"><strong>&gt;&gt; "@|Out-File -Encoding ascii multiply</strong></span>

</pre><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>Change the file permission into an executable by using <code class="literal">chmod +x</code>:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt;chmod +x ./multiply</strong></span></pre><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><div class="orderedlist"><ol class="orderedlist arabic" start="5" type="1"><li>Invoke the file in the PowerShell console by executing the following command:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; ./multiply 2 36</strong></span>

</pre></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch16lvl2sec484"></a>How it works…</h3></div></div></div><p>In this recipe, you've seen very basic sample scripts for Python—things like printing text, passing arguments to a file and integrating output to a variable, and the use of <code class="literal">here-string</code>. You also saw how to put it all together in the <span>PowerShell</span><a id="id325913509" class="indexterm"></a> console. Python is an extremely powerful programming language. You can get started almost immediately, with minimal setup required. It is cross-platform, which means that it can run on most major operating systems including, of course, Linux, Windows, and macOS, since you don't have to modify your code at all. This is a beginner-friendly recipe. If you have at least some basic general programming knowledge, you can explore this option to greater heights.</p></div></div>