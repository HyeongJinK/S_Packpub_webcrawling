<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch12lvl1sec128"></a>Working with parameter sets</h2></div></div><hr /></div><p>In the <span class="emphasis"><em>Updating and using Help</em></span> recipe in <a class="link" href="#" linkend="ch01">Chapter 1</a>, <span class="emphasis"><em>Introducing PowerShell Core</em></span>, we saw the term <code class="literal">Parameter Set</code>. We also read that <span>parameters</span><a id="id326635376" class="indexterm"></a> that are present in one parameter set, but absent in another, cannot be combined with a parameter from the latter set. Parameter sets are useful when we have either conflicting functionalities or functionalities that do not get along.</p><p>In this recipe, we will create a function that will be used to relay messages. If a text message is sent, the function calls another function called <code class="literal">Send-TextMessage</code>, which sends an SMS to the recipient, or <code class="literal">New-VoiceCall</code>, which is designed to make a voice call through the phone system in your company. <code class="literal">Send-TextMessage</code> and <code class="literal">New-VoiceCall</code> are already present in the system. Our task is to write a function that accepts a phone number as one of the inputs, and either the path to the WAV file or the SMS message.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch12lvl2sec335"></a>How to do it…</h3></div></div></div><p>This recipe is not dependent on any of the recipes we have already seen. We will create the function from scratch. What we are going to create is a wrapper function. The assumption here is that we already have the two functions, <code class="literal">Send-TextMessage</code> and <code class="literal">New-VoiceCall</code>. Follow these steps to get started:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Open a new PowerShell script file and enter the following into the text field:</li></ol></div><pre class="programlisting">function New-PersonalMessage {
    [CmdletBinding(DefaultParameterSetName='Audio')]
    param (
        # The phone number
        [Parameter(Mandatory=$true, Position=0, ParameterSetName='Audio')]
        [Parameter(Mandatory=$true, Position=0, ParameterSetName='Text')]
        [string]
        $PhoneNumber,

        # The path to the WAV file
        [Parameter(Mandatory=$true, Position=1, ParameterSetName='Audio')]
        [string]
        $WavPath,

        # The message to be sent
        [Parameter(Mandatory=$true, Position=1, ParameterSetName='Text')]
        [string]
        $Message
    )
    
    if ($WavPath) {
        New-VoiceCall -PhoneNumber $PhoneNumber -FilePath $WavPath
    }
    else {
        Send-TextMessage -PhoneNumber $PhoneNumber -Message $Message
    }
}</pre><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Run the script using the <span class="emphasis"><em>F5</em></span> key.</li><li>Run the following command to show the help information:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-Help New-PersonalMessage</strong></span></pre><p>Note the parameter sets:</p><div class="mediaobject"><img src="/graphics/9781789137231/graphics/68cbbaaf-d930-4fbc-b182-008ff16601f8.png" /></div><p> </p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch12lvl2sec336"></a>How it works…</h3></div></div></div><p>Parameter sets have been created so that two incompatible actions are not called for by a cmdlet. However, some parameters can or must be part of multiple parameter sets (for example, the phone number).</p><p>To define these parameters, we must begin with <code class="literal">CmdletBinding</code>, right after defining the function. On this line, we mention the default parameter set name. This helps when using positional and/or mandatory parameters. Next, when defining the parameters, we specify the parameter set that each of the <span>parameters</span><a id="id325585856" class="indexterm"></a> belongs to. If a parameter belongs to more than one parameter set, we specify all of the parameter sets on separate lines (in our case, the <code class="literal">PhoneNumber</code> parameter).</p><p>When you run the <code class="literal">Get-Help</code> cmdlet for the new wrapper function we created, you will be able to see the parameter sets. Now, when you have to send a message, you could either call the <code class="literal">New-PersonalMessage</code> cmdlet with a phone number and the path to the WAV file, or with a phone number and the message body.</p></div></div>