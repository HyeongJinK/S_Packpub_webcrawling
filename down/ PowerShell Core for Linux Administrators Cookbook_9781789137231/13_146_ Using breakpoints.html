<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch13lvl1sec143"></a>Using breakpoints</h2></div></div><hr /></div><p>Breakpoints are crucial to debugging. They help us halt the <span>execution</span><a id="id325885481" class="indexterm"></a> of the script at a desired point and then step through the process slowly. Breakpoints can be created in PowerShell in two ways: using the breakpoint controls in a visual editor (such as Visual Studio Code) or using cmdlets.</p><p> </p><p>Set a breakpoint at line 17 in the script that you used in the previous recipe, <span class="emphasis"><em>Writing debug output.</em></span></p><p>Perform this action on Visual Studio Code as well as the Vim-and-PowerShell-terminal combo.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch13lvl2sec364"></a>How to do it…</h3></div></div></div><p>This process is very simple in Visual Studio Code. All you have to do is open the file in question, hover your mouse around the left of the line number until a red dot appears, and click it to turn the red dot on:</p><div class="mediaobject"><img src="/graphics/9781789137231/graphics/a0c9baff-a7aa-4fde-8fe1-5fde02052daf.png" /></div><p>To make the script halt at the breakpoint, call the function from within the script. Here is what the script should look like:</p><pre class="programlisting">function New-File {
    [CmdletBinding()]
    param (
        # The path to the file (or the name)
        [Parameter(Mandatory=$true, Position=0)]
        [string[]]
        $Path
    )
    begin {
        Write-Debug "Entered the begin block."
        Write-Host "$(Get-Date)"
    }
    process {
        Write-Debug "Entered the process block."
        foreach ($Item in $Path) {
            Write-Debug "Iterating for item, $Item."
            New-Item -Path $Path -ItemType File
        }
    }
    end {
        Write-Debug "Entered the end block."
    }
}

<span class="strong"><strong>New-File One.txt</strong></span></pre><p>If you are, however, not using a desktop environment, use the text editor of your choice to write the script. I use Vim:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Turn on line numbers. On Vim, press the <span class="emphasis"><em>Escape</em></span> key and enter <code class="literal">set number</code>.</li></ol></div><p>Here is what it should look like now:</p><div class="mediaobject"><img src="/graphics/9781789137231/graphics/eb564f99-ea8d-4186-8a78-4007de3e05a2.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Note down the line number where you would like to place the breakpoint.</li><li>Exit Vim and call the following cmdlet to set the breakpoint:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Set-PSBreakpoint -Script ./ch13/04-New-File.ps1 -Line 17</strong></span></pre><p>To find out how the breakpoint works, simply run the script. You do this by entering debugging mode—this applies to both Visual Studio Code as well as the PowerShell Terminal:</p><div class="mediaobject"><img src="/graphics/9781789137231/graphics/2ad5cef4-16b8-4c60-ae3b-c5a98e616c28.png" /></div><p>Follow the on-screen instructions when on the terminal, and the on-screen <span>control</span><a id="id325892254" class="indexterm"></a> keys on top of the script pane when in Visual Studio Code, to step through the script.</p><p>To remove a breakpoint, click on the red dot when using the GUI, or list out the breakpoints using <code class="literal">Get-PsBreakpoint</code> and then remove the breakpoint using <code class="literal">Remove-PsBreakpoint</code>, along with the relevant identifier.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch13lvl2sec365"></a>How it works…</h3></div></div></div><p>When you create a breakpoint and call the script, the execution halts at the breakpoint. From this point on, you could decide on how to step through the script. In the meanwhile, as you may have noticed, you will see updates happening to the variables, which can be seen in real time on the left-hand side of the screen, as discussed in the <span class="emphasis"><em>The Debug tab of Visual Studio Code</em></span> recipe.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note79"></a>Note</h3><p>Remember that, when adding a breakpoint in a function, you must call the function from within the script (hence the last line of the script). If you just create a function and add a breakpoint to it, and call the function from the terminal (instead of from within the script), you would not enter debug mode. This applies to both cmdlet-based breakpoints as well as breakpoints on an IDE.</p></div><p> </p><p>When in the debug mode on the terminal, you could call each of the variables and objects available in the script, just like how you would on a normal prompt. You will notice the prompt change to <code class="literal">[DBG]: PS&gt;&gt;</code> instead of <code class="literal">PS&gt;</code>.</p></div></div>