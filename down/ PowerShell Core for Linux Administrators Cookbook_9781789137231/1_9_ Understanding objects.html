<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch01lvl1sec18"></a>Understanding objects</h2></div></div><hr /></div><p>PowerShell is object-oriented, text <span>being</span><a id="id325585849" class="indexterm"></a> an object too. An object in PowerShell contains entities within it, which are called members. These members can be referred to using what is called the member access operator, which is nothing but a dot (<code class="literal">.</code>). In this recipe, we will look at picking members from within objects.</p><p>Since we are going to be dealing with members of objects, we will now look at one of the most important cmdlets in PowerShell: <code class="literal">Get-Member</code>.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec35"></a>How to do it…</h3></div></div></div><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>We will start by gathering the properties of <span>our</span><a id="id326328446" class="indexterm"></a> home directory. The path to this is stored in the automatic variable known as <code class="literal">$HOME</code>:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-Item $HOME | Get-Member</strong></span></pre><p>Note the <code class="literal">TypeName</code> of the object—the very first line—as well as the <code class="literal">MemberType</code> column in the table.</p><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Next, check when the home directory was last written to:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; (Get-Item $HOME).LastWriteTime</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>Can we find out when the parent of your <code class="literal">$HOME</code> was created?</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; (Get-Item $HOME).Parent | Get-Member</strong></span>
<span class="strong"><strong><span class="strong"><strong>PS&gt; (Get-Item $HOME).Parent.CreationTime</strong></span></strong></span></pre><p> </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note13"></a>Note</h3><p>To reiterate, PowerShell is not case-sensitive. However, to improve readability, we have stuck to the PowerShell convention of using camel case.</p></div><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>What are the members of this object?</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; (Get-Item $HOME).Parent.CreationTime | Get-Member</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="5" type="1"><li>Pick out the year:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; (Get-Item $HOME).Parent.CreationTime.Year</strong></span></pre><p> </p><div class="orderedlist"><ol class="orderedlist arabic" start="6" type="1"><li>Next, let's use a method from within the returned object and convert it into plain text. We saw that <code class="literal">CreationTime</code> is a <code class="literal">DateTime</code> object. Let's convert that into a plain string:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; (Get-Item $HOME).Parent.CreationTime.ToString()</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="7" type="1"><li>Find the type of object returned by the previous command. Press the up arrow key to bring back the previous command and pipe its output to <code class="literal">Get-Member</code>. Compare the output of <code class="literal">Get-Member</code> without <code class="literal">.ToString()</code>:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; (Get-Item $HOME).Parent.CreationTime.ToString() | Get-Member</strong></span></pre><pre class="programlisting"><span class="strong"><strong>PS&gt; (Get-Item $HOME).Parent.CreationTime | Get-Member</strong></span></pre></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec36"></a>How it works…</h3></div></div></div><p>This recipe is only here to show you that PowerShell outputs objects, and what an object looks like. We will look at leveraging the <code class="literal">TypeName</code> much later, when we modify the returned objects.</p><p>For now, we will stick to properties as the first step for understanding the object model of PowerShell. To demonstrate that methods are also available for use, we will use one that's among the simplest of them, the <code class="literal">ToString()</code> method; it's simple because it does not need any arguments—only empty parentheses.</p><p>The <code class="literal">Get-Member</code> cmdlet is very important in PowerShell because it lets <span>you</span><a id="id325913512" class="indexterm"></a> peek into the object that a certain cmdlet returned. It shows the type of the object returned (<code class="literal">TypeName</code>), and shows the properties and methods available. The properties and methods are of different data types themselves, which can be seen in the <code class="literal">Definition</code> column. As you get comfortable with objects, you will start to leverage these data types to simplify your tasks.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec37"></a>There's more…</h3></div></div></div><p>Just because you can (and not because this is the way to do so), create a subdirectory within your home directory using the <code class="literal">CreateSubdirectory()</code> method from the object returned by <code class="literal">Get-Item</code>:</p><pre class="programlisting"><span class="strong"><strong>PS&gt; (Get-Item $HOME).CreateSubdirectory('test-directory')</strong></span></pre><div class="mediaobject"><img src="/graphics/9781789137231/graphics/8a9bd796-9323-4658-94a0-37c68c8a174b.png" /></div><p>This should show you the new directory that you just created:</p><pre class="programlisting"><span class="strong"><strong>PS&gt; Get-ChildItem $HOME # To list the contents of your home directory</strong></span></pre></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec38"></a>See also</h3></div></div></div><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">The <span class="emphasis"><em>Selecting columns from the output </em></span> recipe from <a class="link" href="#" linkend="ch04">Chapter 4</a>, <span class="emphasis"><em>Passing Data Through the Pipeline</em></span></li></ul></div></div></div>