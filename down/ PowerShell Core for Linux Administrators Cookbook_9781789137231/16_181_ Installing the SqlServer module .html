<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch16lvl1sec175"></a>Installing the SqlServer module </h2></div></div><hr /></div><p>This module allows SQL <span>Server</span><a id="id325913501" class="indexterm"></a> developers, administrators, and <span class="strong"><strong>business intelligence</strong></span> (<span class="strong"><strong>BI</strong></span>) professionals to automate database development and server administration, as well as both <span>multidimensional</span><a id="id325909527" class="indexterm"></a> and tabular cube processing.</p><p> </p><p>There are two SQL Server PowerShell modules: <code class="literal">SqlServer</code> and <code class="literal">SQLPS</code>. The <code class="literal">SQLPS</code> module is included with the SQL Server installation (for backward compatibility), but is no longer being updated. The most up-to-date PowerShell module is the <code class="literal">SqlServer</code> module. The <code class="literal">SqlServer</code> module contains updated versions of the cmdlets in <code class="literal">SQLPS</code>, and also includes new cmdlets to support the latest SQL features. Previous versions of the <code class="literal">SqlServer</code> module were included with <span class="strong"><strong>SQL Server Management Studio</strong></span> (<span class="strong"><strong>SSMS</strong></span>), but only with the 16.x <span>versions</span><a id="id325906070" class="indexterm"></a> of SSMS. To use PowerShell with SSMS 17.0 and later, the <code class="literal">SqlServer</code> module must be installed from the PowerShell Gallery.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch16lvl2sec462"></a>Getting ready</h3></div></div></div><p>To install the <code class="literal">SqlServer</code> module, browse the PowerShell Gallery, which is the central repository for PowerShell content. Refer to the <span class="emphasis"><em>Finding and installing PowerShell modules</em></span> recipe from <a class="link" href="#" linkend="ch01">Chapter 1</a>, <span class="emphasis"><em>Introducing PowerShell Core</em></span>, to find out more about modules.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch16lvl2sec463"></a>How to do it…</h3></div></div></div><p>To install modules, you will need to launch PowerShell with elevated privileges. Start PowerShell as a superuser, run the following script to install the module, and list out the cmdlets that are part of the module:</p><pre class="programlisting">Set-PSRepository -Name PsGallery -InstallationPolicy Trusted

Install-Module SqlServer

if ((Get-Module -ListAvailable).Name -contains 'SqlServer') {
    Get-Command -CommandType Cmdlet | Where-Object Source -Match 'SQL' | Group-Object Source
}</pre><p>The <code class="literal">SqlServer</code> module should be installed and the cmdlets within the module should be shown, as follows:</p><div class="mediaobject"><img src="/graphics/9781789137231/graphics/c784b042-925c-4d07-affe-3eeb788fcd5a.png" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch16lvl2sec464"></a>How it works…</h3></div></div></div><p>This script is a simple one that sets <code class="literal">PsGallery</code> as a trusted source for modules, and installs the module.</p><p>Next, the script shows all of the cmdlets that are part of the <code class="literal">SqlServer</code> module.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch16lvl2sec465"></a>There's more…</h3></div></div></div><p>The goal of PowerShell Core is to remain as compatible as <span>possible</span><a id="id325585857" class="indexterm"></a> with Windows PowerShell. PowerShell Core uses .NET Standard 2.0 (<a class="ulink" href="https://docs.microsoft.com/dotnet/standard/net-standard" target="_blank">https://docs.microsoft.com/dotnet/standard/net-standard</a>) to provide binary compatibility with existing .NET assemblies. Many PowerShell modules depend on these assemblies (oftentimes DLLs), so .NET Standard allows them to continue working with .NET Core. PowerShell Core also includes a heuristic to look in well-known folders—such as <span>where</span><a id="id325585869" class="indexterm"></a> the <span class="strong"><strong>Global Assembly Cache</strong></span> (<span class="strong"><strong>GAC</strong></span>) typically resides on disk <span>to</span><a id="id325585884" class="indexterm"></a> find .NET Framework DLL dependencies.</p><p> </p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch16lvl2sec466"></a>See also</h3></div></div></div><p>Refer to the <span>PowerShell</span><a id="id325885495" class="indexterm"></a> Gallery (<a class="ulink" href="https://www.powershellgallery.com/packages/SqlServer/21.0.17199" target="_blank">https://www.powershellgallery.com/packages/SqlServer/21.0.17199</a>) to find out more about the SQL Server package. You can also learn more about <code class="literal">Set-PSRepository</code> at <a class="ulink" href="https://docs.microsoft.com/en-us/powershell/module/powershellget/set-psrepository?view=powershell-6" target="_blank">https://docs.microsoft.com/en-us/powershell/module/powershellget/set-psrepository?view=powershell-6</a>.</p></div></div>