<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch02lvl1sec36"></a>Calling a PowerShell script</h2></div></div><hr /></div><p>PowerShell scripts are nothing but a <span>series</span><a id="id325892280" class="indexterm"></a> of PowerShell cmdlets, each in a line of a <code class="literal">ps1</code> file. These instructions are executed one after the other, similar to the good old shell script. Using Visual Studio Code makes running PowerShell scripts simpler, in that you simply have to run the script to make the script work its magic.</p><p>However, running PowerShell scripts on Visual Studio Code is not the usual way of automation for obvious reasons. Also, there are many ways to run a PowerShell script. We shall look at a very simple way of running the script in this recipe; as we progress in this book, we will also add more features to our scripts and, further, will package them into modules for future use.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec103"></a>Getting ready</h3></div></div></div><p>This recipe uses Visual Studio Code to write the script. While any text or code editor would work for the script, we use Visual Studio Code because, in my experience, it is the friendliest editor for PowerShell scripting:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Open Visual Studio Code and create a new file</li><li>Create a new directory at a convenient location (<code class="literal">~/Code</code>, perhaps?)</li><li>Save the empty file as <code class="literal">hello-world.ps1</code> within the directory you just created</li><li>Observe the bottom right of Visual Studio Code; it should now say, <strong class="userinput"><code>PowerShell</code></strong></li><li>Press <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>`</em></span> to close the console at the bottom to reduce distraction</li></ol></div><p>If everything is as shown in the following screenshot, you are good to go (ignore the color of the status bar at the bottom, as well as the Git status at the bottom-left for now):</p><div class="mediaobject"><img src="/graphics/9781789137231/graphics/384425a8-fefe-4c4e-94e4-fbba70b8a4e7.png" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec104"></a>How to do it…</h3></div></div></div><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>At the script pane, type in the following:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; Write-Host "Hello, World!"</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Save the script (<strong class="userinput"><code>File</code></strong> &gt; <strong class="userinput"><code>Save</code></strong> or <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>S)</em></span>.</li><li>Click on Debug on the left. Alternatively, press <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>Shift</em></span> + <span class="emphasis"><em>D.</em></span> This opens the Debug pane.</li><li>Press the green Start debugging button. The console should pop out and display <code class="literal">Hello, World!</code>.</li><li>Let us run the script one more time. This time, we will not open the Debug pane or press buttons on the screen. Simply, press <span class="emphasis"><em>F5</em></span>.</li></ol></div><p><code class="literal">Hello, World!</code> should again be displayed in the console:</p><div class="mediaobject"><img src="/graphics/9781789137231/graphics/b1b564fe-6e9b-496a-899a-5b5638ca0cd1.png" /></div><p>Let us now call the script without using the debug controls:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Close the file (<span class="emphasis"><em>Ctrl + W</em></span>).</li><li>At the prompt on the console, type in the following:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; ./hello-world.ps1</strong></span></pre><p>You should see <code class="literal">Hello, World!</code> appear.</p><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>Navigate to <code class="literal">home</code>.</li><li>Type <code class="literal">&amp;</code>, add a space, <code class="literal">./</code>, and start typing the path to where you stored the script. Use tab completion just like you would do on Bash.</li><li>When you reach the location of the script file, press <span class="emphasis"><em>Enter</em></span> to call the file:</li></ol></div><div class="mediaobject"><img src="/graphics/9781789137231/graphics/40937ad3-d444-4b9f-94a6-fcc503065697.png" /></div><p> </p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec105"></a>How it works…</h3></div></div></div><p>The simplest way to run a PowerShell script is to debug it at the ISE. We use Visual Studio Code as our IDE of choice in this case. The other two ways of calling the script described in this recipe are from the PowerShell console. You may use the integrated console in Visual Studio Code or a PowerShell console called at the Terminal for this purpose.</p><p>When the script is located at the <span>present</span><a id="id325901976" class="indexterm"></a> working directory, PowerShell just calls the <code class="literal">ps1</code> file and executes it. Another way of calling PowerShell scripts is to use <code class="literal">&amp;</code> (or the call operator): type <code class="literal">&amp;</code> followed by a space, followed by the path to the script file. This way of calling handles spaces in the path well.</p><p>If the path to the script contains spaces, the path would need to be surrounded by quotes. This would make PowerShell think that you are simply giving it a string value. PowerShell would, then, simply display the path as text the moment you press <span class="emphasis"><em>Enter</em></span>.</p><p>When you use the <code class="literal">&amp;</code> call operator, you tell PowerShell that you want to run a script (or a command).</p><p>Another way of calling scripts is to use <code class="literal">.</code> (or the dot operator), which we shall look at in the next recipe.</p></div></div>