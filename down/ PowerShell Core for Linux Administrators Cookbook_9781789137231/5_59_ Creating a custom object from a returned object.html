<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch05lvl1sec64"></a>Creating a custom object from a returned object</h2></div></div><hr /></div><p>We now know how to create a custom <span>object</span><a id="id325892294" class="indexterm"></a> from scratch. In this recipe, we will use a returned object and modify the returned object to create a custom object. When we look at loops, we will extend this capability to create versatile custom objects; in production environments, this capability can be used to do more!</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec176"></a>How to do it…</h3></div></div></div><p>The first step to learning something is to simplify it. Therefore, we will select only one instance of an object and work with it. Follow these steps to get started:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Get all of the processes. Select only the name, ID, working set, and the start time, pick the fifth process in the list, and assign it to a variable:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; $Process = (Get-Process | Select-Object Name, Id, WS, StartTime)[4]</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Let's say that we did not like the names of the properties in the object. Let's change the names:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; $CustomProcess = New-Object -TypeName PSObject -Property @{</strong></span>
<span class="strong"><strong>  ProcessName = $Process.Name</strong></span>
<span class="strong"><strong>  ProcessId = $Process.Id</strong></span>
<span class="strong"><strong>  WorkingSet = $Process.WS</strong></span>
<span class="strong"><strong>  StartedAt = $Process.StartTime</strong></span>
<span class="strong"><strong>}</strong></span>
<span class="strong"><strong>PS&gt; $CustomProcess</strong></span></pre><div class="mediaobject"><img src="/graphics/9781789137231/graphics/9821a46b-108b-4c1d-9079-9ff1a3c48680.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>However, that is not the sequence we specified. Let's get them in sequence:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; $CustomProcess = [ordered]@{</strong></span>
<span class="strong"><strong>  ProcessName = $Process.Name</strong></span>
<span class="strong"><strong>  ProcessId = $Process.Id</strong></span>
<span class="strong"><strong>  WorkingSet = $Process.WS</strong></span>
<span class="strong"><strong>  StartedAt = $Process.StartTime</strong></span>
<span class="strong"><strong>} </strong></span>
<span class="strong"><strong>PS&gt; New-Object -TypeName PSObject -Property $CustomProcess</strong></span></pre><div class="mediaobject"><img src="/graphics/9781789137231/graphics/8836ffc8-80ac-4e6f-b8f2-d12ae761e3f2.png" /></div><p> </p><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>Recreate the <span>object</span><a id="id325885494" class="indexterm"></a> with information regarding how long the process has been running for instead of when it was started:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; $CustomProcess = [ordered]@{</strong></span>
<span class="strong"><strong>  ProcessName = $Process.Name</strong></span>
<span class="strong"><strong>  ProcessId = $Process.Id</strong></span>
<span class="strong"><strong>  WorkingSet = $Process.WS</strong></span>
<span class="strong"><strong>  RunningMins = [math]::Floor(((Get-Date) - $Process.StartTime).TotalMinutes)</strong></span>
<span class="strong"><strong>}</strong></span>
<span class="strong"><strong>PS&gt; New-Object -TypeName PsObject -Property $CustomProcess</strong></span></pre><div class="mediaobject"><img src="/graphics/9781789137231/graphics/13ae2c94-a78f-499d-855f-c0738bcc49ce.png" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec177"></a>How it works…</h3></div></div></div><p>In this recipe, we created a custom object (<code class="literal">$CustomProcess</code>) from an output object (<code class="literal">$Process</code>). The properties within <code class="literal">$Process</code> can be accessed using the member access operator. Values from <code class="literal">$Process</code> are treated as values for the properties in <code class="literal">$CustomObject</code>, however, the names in <code class="literal">$CustomObject</code> are different. In this recipe, we also used a calculated property, <code class="literal">RunningMins</code>.</p><p>An important point to note here is that the outcome of this recipe can also be achieved using calculated properties, along with <code class="literal">Select-Object</code>. However, in situations where object versatility is important and the number of instances of the objects is significantly larger, it is simpler to use a custom object. We will extend this capability in future chapters, after we learn how to use looping constructs.</p><p> </p><p>The other point to note is the use of the <code class="literal">[ordered]</code> accelerator. More often than not, the properties of custom objects do not appear in the sequence we mention them in. In this recipe, we separate the hash literal notation from the creation of the custom object. First, we create an ordered hashtable with the property names, as well as the property values, and then we specify the created hashtable for the <code class="literal">Property</code> parameter of the <code class="literal">New-Object</code> cmdlet to create the custom <span>object</span><a id="id326034632" class="indexterm"></a> with the properties, which are shown in the sequence we want.</p><p>As with the previous recipe, the changes made to this object definition will exist as long as your PowerShell session is alive.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec178"></a>See also</h3></div></div></div><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">Creating .NET and <span>COM</span><a id="id326034656" class="indexterm"></a> Objects (<a class="ulink" href="https://docs.microsoft.com/en-us/powershell/scripting/getting-started/cookbooks/creating-.net-and-com-objects--new-object-?view=powershell-6" target="_blank">https://docs.microsoft.com/en-us/powershell/scripting/getting-started/cookbooks/creating-.net-and-com-objects--new-object-?view=powershell-6</a>)</li></ul></div></div></div>