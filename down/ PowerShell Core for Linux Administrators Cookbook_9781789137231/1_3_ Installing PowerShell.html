<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch01lvl1sec12"></a>Installing PowerShell</h2></div></div><hr /></div><p>In this book, we will focus on installing PowerShell on Ubuntu (16.04 and 18.04) and CentOS 7, since Ubuntu and CentOS were among the first to be supported by the <span>PowerShell</span><a id="id325892274" class="indexterm"></a> project.</p><p>PowerShell is available in two releases: stable and preview. The stable releases are suitable for a production environment since they are more reliable. The preview releases are for test environments where the administrators are allowed to feel a little adventurous. The expectation from the administrators is to report bugs they come across, along with providing feedback on the capabilities of it.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip4"></a>Note</h3><p>As of the Preview 4 release of PowerShell 6.1, <code class="literal">pwsh</code> (stable) and <code class="literal">pwsh-preview</code> (preview) can be installed side by side, without the worry of interference.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec15"></a>Getting ready</h3></div></div></div><p>Linux administrators will already know how to do this. If you are new to Linux, getting ready to install PowerShell on your computer is simple. You simply need a working Linux computer that you have administrator privileges on. Depending on what mode you pick to install PowerShell, you may or may not need a package manager. Chances are, your Linux distribution already has a package manager available.</p><p>Also, many of the future recipes will require a desktop environment so that you can work with tools such as Visual Studio Code.</p><p>Ubuntu does not ship with <code class="literal">curl</code>. Install <code class="literal">curl</code> by running the following command:</p><pre class="programlisting"><span class="strong"><strong>$ sudo apt install curl</strong></span></pre></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec16"></a>How to do it…</h3></div></div></div><p>As we have already discussed, we will look at the procedure of installing PowerShell on Ubuntu (and its derivatives) as well as CentOS (and its derivatives).</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch01lvl3sec0"></a>Installation on Ubuntu</h4></div></div></div><p>There really are many ways to install PowerShell on <span>your</span><a id="id325585870" class="indexterm"></a> computer. Since we are installing PowerShell on Ubuntu, we will look at two ways of doing so. The first is by adding Microsoft's key, registering the repository, and then using the <span class="strong"><strong>Advanced Package Tool</strong></span> (<span class="strong"><strong>APT</strong></span>) to install PowerShell. The second method is by <span>doing</span><a id="id325585853" class="indexterm"></a> so directly, using the <code class="literal">.deb</code> package from GitHub.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h5 class="title"><a id="ch01lvl4sec0"></a>Installing from the repository</h5></div></div></div><p>Ubuntu 16.04 and Ubuntu 18.04 have the <span>stable</span><a id="id325585874" class="indexterm"></a> release of PowerShell available. Follow these steps if you wish to install PowerShell on Ubuntu:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Download the GPG keys for the Microsoft repository:</li></ol></div><pre class="programlisting"><span class="strong"><strong>$ # On Ubuntu 16.04
$ wget -q https://packages.microsoft.com/config/ubuntu/16.04/packages-microsoft-prod.deb

$ # On Ubuntu 18.04
$ wget -q https://packages.microsoft.com/config/ubuntu/18.04/packages-microsoft-prod.deb</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Register the GPG keys:</li></ol></div><pre class="programlisting">$ sudo dpkg -i packages-microsoft-prod.deb</pre><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>Update the package list using the following command:</li></ol></div><pre class="programlisting"><span class="strong"><strong>$ sudo apt update</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>Install PowerShell using <code class="literal">apt-get</code>:</li></ol></div><pre class="programlisting"><span class="strong"><strong>$ # To install PowerShell (stable)
$ sudo apt install -y powershell

$ # To install PowerShell (preview)
$ sudo apt install -y powershell-preview</strong></span></pre><p> </p><div class="orderedlist"><ol class="orderedlist arabic" start="5" type="1"><li>Run PowerShell using the following command:</li></ol></div><pre class="programlisting"><span class="strong"><strong>$ # If you installed PowerShell (stable)
$ pwsh

$ # If you installed PowerShell (preview)
$ pwsh-preview</strong></span></pre></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h5 class="title"><a id="ch01lvl4sec1"></a>Installing via direct download</h5></div></div></div><p>Follow these steps to install <span>PowerShell</span><a id="id326352489" class="indexterm"></a> on Ubuntu:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Go to <a class="ulink" href="https://github.com/powershell/powershell" target="_blank">https://github.com/powershell/powershell</a>.</li><li>Scroll down to the table that contains the list of Linux distributions officially supported by the PowerShell team.</li><li>Click on the relevant link, that is, <code class="literal">.deb</code> under <strong class="userinput"><code>Downloads (stable)</code></strong> or <strong class="userinput"><code>Downloads (preview).</code></strong></li><li>Read the installation instructions if you need additional information.</li><li>Use <code class="literal">dpkg</code> to install the package:</li></ol></div><pre class="programlisting"><span class="strong"><strong>$ sudo dpkg -i powershell-version-os-osversion_architecture.deb</strong></span>
<span class="strong"><strong>$ sudo apt install -f</strong></span></pre></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch01lvl3sec1"></a>Installation on CentOS</h4></div></div></div><p>The installation of PowerShell on <span>CentOS</span><a id="id326660514" class="indexterm"></a> 7 (or Red Hat 7) also has two methods: the repository and a direct download. The process is similar to that of installation on Ubuntu Linux. While it is recommended that PowerShell is installed from the repository, use the second method—the direct download method—should you choose otherwise.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h5 class="title"><a id="ch01lvl4sec2"></a>Installing from the repository</h5></div></div></div><p>To begin the installation, follow <span>these</span><a id="id326660529" class="indexterm"></a> steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>First, register the Microsoft repository:</li></ol></div><pre class="programlisting"><span class="strong"><strong>$ curl https://packages.microsoft.com/config/rhel/7/prod.repo | sudo tee /etc/yum.repos.d/microsoft.repo</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Next, install PowerShell using <code class="literal">yum</code>:</li></ol></div><pre class="programlisting"><span class="strong"><strong>$ sudo yum install -y powershell</strong></span></pre><p> </p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h5 class="title"><a id="ch01lvl4sec3"></a>Installing via direct download</h5></div></div></div><p>Follow <span>these</span><a id="id325587908" class="indexterm"></a> steps to install PowerShell on CentOS:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Go to <a class="ulink" href="https://github.com/powershell/powershell" target="_blank">https://github.com/powershell/powershell</a>.</li><li>Scroll down to the table that contains the list of Linux distributions officially supported by the PowerShell team.</li><li>Click on the relevant link, that is, <code class="literal">.rpm</code> under <strong class="userinput"><code>Downloads (stable)</code></strong>—we will stick to the stable release.</li><li>Read the installation instructions if you need additional information.</li><li>Install the RPM package using the following command (assuming your download is at <code class="literal">~/Downloads</code> and your <code class="literal">pwd</code> is <code class="literal">~/Downloads</code>):</li></ol></div><pre class="programlisting"><span class="strong"><strong>$ sudo yum install &lt;the-downloaded-file.rpm&gt;</strong></span></pre></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch01lvl3sec2"></a>Using the Snapcraft package</h4></div></div></div><p>If your distribution supports the <span>installation</span><a id="id325589948" class="indexterm"></a> of Snapcraft (snap) packages, you can install PowerShell using the <code class="literal">snap</code> command:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Install <code class="literal">snapd</code> if you do not already have it. Here is how you do this on Ubuntu:</li></ol></div><pre class="programlisting"><span class="strong"><strong>$ sudo apt install snapd</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Next, install the PowerShell Snapcraft package:</li></ol></div><pre class="programlisting"><span class="strong"><strong>$ snap install powershell --classic</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>You may be prompted for your credentials. Enter your credentials at the prompt.</li><li>Launch PowerShell:</li></ol></div><pre class="programlisting"><span class="strong"><strong>$ pwsh</strong></span></pre><p> </p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch01lvl3sec3"></a>Using the binary archives</h4></div></div></div><p>If your package manager <span>does</span><a id="id325590942" class="indexterm"></a> not have PowerShell, use the binary archives:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Install the dependencies based on your operating system. Here are the dependencies required in the case of Ubuntu 16.04, Ubuntu 18.04, and CentOS:</li></ol></div><div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; "><colgroup><col /><col /></colgroup><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>Operating System</strong></span></p></td><td style="border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>Dependencies</strong></span></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Ubuntu 16.04</p></td><td style="border-bottom: 0.5pt solid ; "><p><code class="literal">libc6</code>, <code class="literal">libgcc1</code>, <code class="literal">libgssapi-krb5-2</code>, <code class="literal">liblttng-ust0</code>, <code class="literal">libstdc++6</code>, <code class="literal">libcurl3</code>, <code class="literal">libunwind8</code>, <code class="literal">libuuid1</code>, <code class="literal">zlib1g</code>, <code class="literal">libssl1.0.0</code>, <code class="literal">libicu52</code></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Ubuntu 18.04</p></td><td style="border-bottom: 0.5pt solid ; "><p><code class="literal">libc6</code>, <code class="literal">libgcc1</code>, <code class="literal">libgssapi-krb5-2</code>, <code class="literal">liblttng-ust0</code>, <code class="literal">libstdc++6</code>, <code class="literal">libcurl3</code>, <code class="literal">libunwind8</code>, <code class="literal">libuuid1</code>, <code class="literal">zlib1g</code>, <code class="literal">libssl1.0.0</code>, <code class="literal">libicu60</code></p></td></tr><tr><td style="border-right: 0.5pt solid ; "><p>CentOS7</p></td><td style=""><p><code class="literal">libunwind</code>, <code class="literal">libcurl</code>, <code class="literal">openssl-libs</code>, <code class="literal">libicu</code></p></td></tr></tbody></table></div><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Use <code class="literal">curl</code> to get the archived file:</li></ol></div><pre class="programlisting"><span class="strong"><strong>$ curl -L -o /tmp/powershell.tar.gz https://github.com/PowerShell/PowerShell/releases/download/v6.1.0/powershell-6.1.0-linux-x64.tar.gz</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>Create the directory where PowerShell will be installed:</li></ol></div><pre class="programlisting"><span class="strong"><strong>$ sudo mkdir -p /opt/microsoft/powershell/6.1.0</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>Unpack the binaries into the directory you just created:</li></ol></div><pre class="programlisting"><span class="strong"><strong>$ sudo tar zxf /tmp/powershell.tar.gz -C /opt/microsoft/powershell/6.1.0</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="5" type="1"><li>Add execute permissions to the file:</li></ol></div><pre class="programlisting"><span class="strong"><strong>$ sudo chmod +x /opt/microsoft/powershell/6.1.0/pwsh</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="6" type="1"><li>Create a symbolic link to point to <code class="literal">pwsh</code>:</li></ol></div><pre class="programlisting"><span class="strong"><strong>$ sudo ln -s /opt/microsoft/powershell/6.1.0/pwsh /usr/bin/pwsh</strong></span></pre></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch01lvl3sec4"></a>Bonus– using the Install-PowerShell script (including on macOS)</h4></div></div></div><p>The official PowerShell repository has a script that detects your <span>operating</span><a id="id325614861" class="indexterm"></a> system and installs PowerShell based on the operating system and the distribution.</p><p> </p><p> </p><p>Your computer must have the following:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">The Bash shell</li><li style="list-style-type: disc"><code class="literal">sed</code></li><li style="list-style-type: disc">A native package manager</li></ul></div><p>We need the Visual Studio Code IDE so that we can follow the exercises in this book. Run the following command to commence the installation:</p><pre class="programlisting"><span class="strong"><strong>$ bash <span><span>&lt;(</span>wget -O - https://raw.githubusercontent.com/PowerShell/PowerShell/master/tools/install-powershell.sh<span>)</span></span> -includeide</strong></span></pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note5"></a>Note</h3><p>If you do not have a desktop environment on your computer, you will not be able to install Visual Studio Code. Either install a desktop environment or omit the <code class="literal">-includeide</code> switch.</p></div><p>For more information, go <span>through</span><a id="id325614918" class="indexterm"></a> the <code class="literal">README</code> file at <a class="ulink" href="https://github.com/PowerShell/PowerShell/blob/master/tools/install-powershell-readme.md" target="_blank">https://github.com/PowerShell/PowerShell/blob/master/tools/install-powershell-readme.md</a>.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec17"></a>How it works…</h3></div></div></div><p>The package manager installs the package with all of its dependencies and makes the relevant commands available for use.</p><p>Starting with Snap 2.20, you can install Snapcraft packages with relaxed security boundaries using the <code class="literal">--classic</code> switch. Snaps usually run in a sandboxed environment, meaning that they are separated from the host, so to speak. However, PowerShell, being a shell, needs access to all of the host resources so that it can function as desired, hence the <code class="literal">--classic</code> install. Also note that this is not supported on systems such as Ubuntu Core.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec18"></a>See also</h3></div></div></div><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">The <span class="emphasis"><em>Comparing Windows PowerShell and PowerSh</em></span><span class="emphasis"><em>ell Core</em></span> recipe</li></ul></div></div></div>