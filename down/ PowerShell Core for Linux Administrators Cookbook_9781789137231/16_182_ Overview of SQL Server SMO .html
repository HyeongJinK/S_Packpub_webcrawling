<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch16lvl1sec176"></a>Overview of SQL Server SMO </h2></div></div><hr /></div><p><span class="strong"><strong>SQL Server Management Objects</strong></span> (<span class="strong"><strong>S</strong></span><span class="strong"><strong>MO</strong></span>) is a collection of <span>objects</span><a id="id326063032" class="indexterm"></a> that are designed for programming all aspects of managing Microsoft SQL Server. The SMO framework is a set of objects that have been <span>designed</span><a id="id326062906" class="indexterm"></a> for the programmatic management of <span class="strong"><strong>Microsoft SQL Server</strong></span> and <span class="strong"><strong>Microsoft Azure SQL Database</strong></span>.</p><p>SMO is further categorized into two classes: instance classes and utility classes.</p><p>SQL Server objects are represented by instance classes and explicit representation of tasks such as backup and restore, scripting, and object transfers. These are carried out by using the following utility classes:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"> The <code class="literal">Microsoft.SqlServer.Management.Smo</code> namespace contains classes that represent the core SQL Server Database Engine objects. These include instances, databases, tables, stored procedures, and views.</li><li style="list-style-type: disc">The <code class="literal">Microsoft.SqlServer.Management.Sdk.Sfc</code> namespace contains a set of classes that form an inheritance base for other SQL Server Management namespaces, such as <a class="ulink" href="https://msdn.microsoft.com/en-us/library/microsoft.sqlserver.management.smo.aspx" target="_blank">Microsoft.SqlServer.Management.Smo</a>. Do not reference this member directly in your code. It supports the SQL Server infrastructure.</li><li style="list-style-type: disc">The <code class="literal">Microsoft.SqlServer.ConnectionInfo</code> namespace contains a set of classes that have support for connecting to an instance of SQL Server. This gets or sets the <span>Boolean</span><a id="id325913517" class="indexterm"></a> property (<a class="ulink" href="https://docs.microsoft.com/en-us/dotnet/api/system.boolean?redirectedfrom=MSDN&amp;view=netframework-4.7.2" target="_blank">https://docs.microsoft.com/en-us/dotnet/api/system.boolean?redirectedfrom=MSDN&amp;view=netframework-4.7.2</a>) that specifies whether the connection is established to the server by using Windows Authentication or SQL Server Authentication.</li><li style="list-style-type: disc">Namespaces such as <code class="literal">Microsoft.SqlServer.SmoExtended</code> and <code class="literal">Microsoft.SqlServer.SqlEnum</code> contain the class libraries or APIs that support SMO classes.
</li><li style="list-style-type: disc">The <code class="literal">Microsoft.SqlServer.Management.PSProvider</code> namespace implements the SQL Server PowerShell provider and associated cmdlets such as <code class="literal">Encode-SqlName</code> and <code class="literal">Decode-SqlName</code>.</li><li style="list-style-type: disc">The <code class="literal">Microsoft.SqlServer.Management.PSSnapin</code> namespace implements the <code class="literal">Invoke-Sqlcmd</code> and <code class="literal">Invoke-PolicyEvaluation</code> cmdlets.</li></ul></div><p>The different stages of the SMO object creation and instantiation are as follows:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Create an instance of the object</li><li>Set the object properties</li><li>Create instances of the child objects</li><li>Set the child object properties</li><li>Create the object</li></ol></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch16lvl2sec467"></a>How to do it…</h3></div></div></div><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Install and load the <code class="literal">SqlServer</code> modules on a Linux machine by following the <span class="emphasis"><em>Finding and installing PowerShell</em></span><span class="emphasis"><em>modules</em></span> recipe from <a class="link" href="#" linkend="ch01">Chapter 1</a>, <span class="emphasis"><em>Introducing PowerShell Core</em></span>.</li><li>Import the module into the session using <code class="literal">Import-Module</code>.</li><li>To find out whether the installation went through, call the <code class="literal">AppDomain.GetAssemblies()</code>method. The<code class="literal">AppDomain.GetAssemblies</code>method gets the assemblies that have been loaded into the execution context of this application domain:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; [AppDomain]::CurrentDomain.GetAssemblies() | where FullName -match "SQL" | sort-object -property fullname | format-table fullname</strong></span>
<span class="strong"><strong>PS&gt; [AppDomain]::CurrentDomain.GetAssemblies() |  where FullName -match "SQL" | Select-Object -ExpandProperty Location</strong></span></pre><p> </p><p>The output of the preceding PowerShell <span>code</span><a id="id325905994" class="indexterm"></a> is as follows:</p><div class="mediaobject"><img src="/graphics/9781789137231/graphics/98f0829b-9a14-45a2-9d3e-687912fb099c.png" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch16lvl2sec468"></a>See also</h3></div></div></div><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">Find out more about <span>SMO</span><a id="id325906049" class="indexterm"></a> (<a class="ulink" href="https://docs.microsoft.com/en-us/sql/relational-databases/server-management-objects-smo/overview-smo?view=sql-server-2017" target="_blank">https://docs.microsoft.com/en-us/sql/relational-databases/server-management-objects-smo/overview-smo?view=sql-server-2017</a>). </li></ul></div></div></div>