<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch05lvl1sec62"></a>Storing the output of an instance of a .NET Core object</h2></div></div><hr /></div><p>.NET is object-oriented, and works on classes and objects. PowerShell, being an <span>extension</span><a id="id325901968" class="indexterm"></a> of this framework, allows you to work with the .NET framework and COM interfaces so that you can perform many system administration tasks. This way, you are not limited to the tasks that can be performed using cmdlets.</p><p>In this recipe, we will define a simple class from within PowerShell.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec169"></a>Getting ready</h3></div></div></div><p>We recommend using Visual Studio Code for this recipe. To find out how to install and configure it, visit the <span class="emphasis"><em>Installing Visual Studio Code</em></span> recipe in <a class="link" href="#" linkend="ch02">Chapter 2</a>, <span class="emphasis"><em>Preparing for Administration Using PowerShell</em></span>.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec170"></a>How to do it…</h3></div></div></div><p>Launch Visual Studio Code and address any immediate requirements it asks for. Then, follow these steps to get started:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Open a new file in Visual Studio Code and set the file type as PowerShell.</li><li>Type in the following in the script pane. The file does not have to be saved; execute it using the <span class="emphasis"><em>F5</em></span> key to make it available in PowerShell:</li></ol></div><pre class="programlisting">classPerson {
    [string]$Name
    [Int32]$Age
    [int32]$Salary

    Person () {}

    Person ([string]$Name, [int32]$Age) {
$this.Name=$Name
$this.Age=$Age
    }

    [int32] sal ([int32]$Salary, [int32]$Comm) {
return$Salary*$Comm
    }
}</pre><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>To find the constructors of a class, call the static method <code class="literal">New</code>; type in the following at the prompt:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; [Person]::New</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>This gives us two functions of the same name; these are overload definitions. Now, create a new object by passing in the parameters:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; [Person]::New('Prashanth',34) </strong></span></pre><div class="mediaobject"><img src="/graphics/9781789137231/graphics/dc3427f6-9f87-4a3f-a3f1-35568eeb2624.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="5" type="1"><li>Now, let us invoke the constructor the PowerShell way, which in turn calls the .NET constructor. This creates an instance of the <code class="literal">Person</code> class (which, by definition, is an object):</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; $Person = New-Object -TypeName Person -ArgumentList 'Prashanth', 34</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="6" type="1"><li>To list the <span>properties</span><a id="id325885493" class="indexterm"></a> of the object (and by extension, the class), run the <code class="literal">Get-Member</code> cmdlet:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; $Person | Get-Member </strong></span>

<span class="strong"><strong>PS&gt; $Person | Select-Object Name, Age, Salary | Format-Table -AutoSize </strong></span>

<span class="strong"><strong>PS&gt; $Person.sal(200,2)</strong></span></pre><div class="mediaobject"><img src="/graphics/9781789137231/graphics/37561d3e-a748-4271-9adb-20571f359776.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="7" type="1"><li>Next, let's take a look at the other samples. Let's use the <code class="literal">system-defined</code> class libraries:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; $MailClient=New-Object-TypeName System.Net.Mail.SmtpClient 'packtpub.smtpdomain.com'
PS&gt; $Message=New-Object System.Net.Mail.MailMessage('pjayaram@packtpub.com','pjayaram@packtpub.com','Subject','Welcome to Packt!')
PS&gt; $MailClient.Send($Message)</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="8" type="1"><li>Let's look at another example of password encryption by using <code class="literal">System.Management.Automation</code> class objects:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; $User = 'Prashanth' </strong></span>
<span class="strong"><strong>PS&gt; $Password = 'Y94b^E$85CBLU%at' </strong></span>
<span class="strong"><strong>PS&gt; $SecurePassword = ConvertTo-SecureString $Password -AsPlainText -Force </strong></span>
<span class="strong"><strong>PS&gt; $Credentials = New-Object -TypeName System.Management.Automation.PSCredential -ArgumentList $User, $SecurePassword </strong></span>
<span class="strong"><strong>PS&gt; $Credentials | Get-Member</strong></span></pre><div class="mediaobject"><img src="/graphics/9781789137231/graphics/64f58ca1-cfe4-40f0-a56b-988a5083fdda.png" /></div><p> </p><p> </p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec171"></a>How it works…</h3></div></div></div><p>The goal of this recipe is to demonstrate how PowerShell works hand-in-hand with .NET, and to show you that objects that are created the .NET way can be called (and stored) easily in PowerShell. First, we declare a class with the <code class="literal">class</code> keyword. We then declare its parameters, and then create two constructors: one default and one that's parameterized.</p><p>We also create a method called <code class="literal">sal</code>. We define its <span>return</span><a id="id326084284" class="indexterm"></a> type as <code class="literal">int32</code>, and define two parameters. Within it, we define what needs to be returned.</p><p>Back at the PowerShell prompt, we call the static (method of the class, not of an object) <code class="literal">New</code> method. The syntax is to mention the class name, followed by two consecutive colons (<code class="literal">::</code>) to call it in the global namespace, followed by the name of the method.</p><p>If you follow these steps, you'll also see an example of using the two different system class libraries, <code class="literal">System.Net.Mail.SmtpClient</code> and <code class="literal">System.Net.Mail.MailMessage</code>, and the instantiation of a method by integrating the output of <code class="literal">mail-message</code> with the <code class="literal">SMTP-client</code> object.</p><p>Next, we use the system class library <code class="literal">System.Management.Automation.PSCredential</code>. In this example, we send some text to <code class="literal">ConvertTo-SecureString</code>, which takes input as plain text and converts it into a secure string. Then, we pass the encrypted string to the <code class="literal">PSCrendital</code> system class to store the username and the secure string in the <code class="literal">$Credentials</code> variable. </p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec172"></a>See also</h3></div></div></div><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">The <span class="emphasis"><em>Installing Visual Studio Code </em></span>recipe in <a class="link" href="#" linkend="ch02">Chapter 2</a>, <span class="emphasis"><em>Preparing for Administration Using PowerShell</em></span></li></ul></div></div></div>