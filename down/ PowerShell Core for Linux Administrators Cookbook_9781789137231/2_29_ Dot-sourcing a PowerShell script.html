<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch02lvl1sec37"></a>Dot-sourcing a PowerShell script</h2></div></div><hr /></div><p>In the previous recipe, we saw how to call <span>PowerShell</span><a id="id325898617" class="indexterm"></a> scripts from outside of the IDE. We gave PowerShell the path and explicitly mentioned that we would like it to run the script, by using a call operator.</p><p>This way is ideal if you would just like the script to perform its task and not leave anything behind, such as variable values. However, there are situations where we would like to run a script and, say, retain values of the variables we declared and assigned in them or use the functions we declared in them.</p><p>In such situations where we would like the functions, variables, and even aliases retained in the current session, we use dot-sourcing.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec106"></a>How to do it…</h3></div></div></div><p>If you deleted the file after the previous recipe, restore it or recreate it using the steps in the previous recipe. Then, perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Open the script file that you created in the previous recipe. At the second line, type the following:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; $Message = "I was dot-sourced!"</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Save the script. Do not run it yet.</li><li>Place your cursor at the integrated console, and call the script using the call operator:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; &amp; ./hello-world</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>We declared <code class="literal">$Message</code> and assigned a string value to it. Call the variable to see what value it contains:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; $Message</strong></span></pre><p>It contains nothing.</p><div class="orderedlist"><ol class="orderedlist arabic" start="5" type="1"><li>Dot-source the script (there are two dots; one is the operator, and the other after the space is reference to the current directory):</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; . ./hello-world.ps1</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="6" type="1"><li>Call the <code class="literal">$Message</code> variable again:</li></ol></div><pre class="programlisting"><span class="strong"><strong>PS&gt; $Message</strong></span></pre><div class="mediaobject"><img src="/graphics/9781789137231/graphics/31638141-7c76-4db9-bf21-689aa0e8b3d8.png" /></div><p> </p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec107"></a>How it works…</h3></div></div></div><p>When a script or a command is called using the call operator, the script or <span>command</span><a id="id325585851" class="indexterm"></a> is simply run without the current session (or technically, the scope) being modified. The command or script runs and exits without changing anything pertaining to the session, including changes to built-in/automatic variables.</p><p>When changes to the scope are desired, the script or command must be dot-sourced. This way, whatever variables, functions, or aliases are defined in it are retained in the current scope.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec108"></a>There's more…</h3></div></div></div><p>Create a new alias using <code class="literal">New-Alias</code> within the <code class="literal">hello-world.ps1</code> script. Try to get the value of the alias after first calling the script (using the debug control, as well as using the call operator), and then by dot-sourcing the script. Observe the outcomes.</p></div></div>