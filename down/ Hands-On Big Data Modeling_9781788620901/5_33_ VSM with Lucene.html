<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch05lvl1sec37"></a>VSM with Lucene</h2></div></div><hr /></div><p>The VSM, or term <span class="strong"><strong>vector model</strong></span>, is an <span>algebraic</span><a id="id326195179" class="indexterm"></a> model for <span>representing</span><a id="id326195182" class="indexterm"></a> text documents as vectors of identifiers such as index terms. It is used in information filtering, information retrieval, indexing, and relevancy rankings. </p><p>In VSM, weights associated with the terms are calculated based on the following two numbers:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><span class="strong"><strong>Term frequency</strong></span> (<span class="strong"><strong>TF</strong></span>): How many times a <span>particular</span><a id="id326195140" class="indexterm"></a> term appears in the document</li><li style="list-style-type: disc"><span class="strong"><strong>Inverse document frequency</strong></span> (<span class="strong"><strong>IDF</strong></span>): How <span>important</span><a id="id326195133" class="indexterm"></a> a word is to a document in a collection</li></ul></div><p>VSM is implemented in a lot of open source software, including <span>Apache</span><a id="id326094905" class="indexterm"></a> Lucene, Elasticsearch, Genism, Numpy, Weka, word2vec, and <span class="strong"><strong>Konstanz Information Miner</strong></span> (<span class="strong"><strong>KNIME</strong></span>). </p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec46"></a>Lucene</h3></div></div></div><p>In this section, we are going to explore the <span>VSM</span><a id="id326094894" class="indexterm"></a> using an open <span>source</span><a id="id325337685" class="indexterm"></a> tool called Lucene. When you run this program, if you get the <code class="literal">Exception in thread "main" java.lang.NoClassDefFoundError</code> error when running the commands in this activity, you will need to download Lucene by running these commands:</p><pre class="programlisting"><span class="strong"><strong>cd $HOME/Downloads</strong></span>
<span class="strong"><strong>wget http://archive.apache.org/dist/lucene/java/5.5.0/lucene-5.5.0.tgz</strong></span>
<span class="strong"><strong>tar -xvzf lucene-5.5.0.tgz</strong></span></pre><p>Let's have a look at the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Open a Terminal shell by clicking on the square black box on the top-left of the screen. Download the vector data from the GitHub link. Change into the <code class="literal">vector</code> directory:</li></ol></div><pre class="programlisting"><span class="strong"><strong>cd Downloads/CH05/vector</strong></span></pre><p> </p><p>Run <code class="literal">ls</code> to see the scripts and the <code class="literal">data</code> directory. The <code class="literal">data</code> directory contains three CSV files, that contain textual data from the news.</p><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Import and query the text documents.<span class="strong"><strong> </strong></span>Run the <code class="literal">runLuceneQuery.sh</code> data to import the documents in the <code class="literal">data</code> directory:</li></ol></div><pre class="programlisting"><span class="strong"><strong>./runLuceneQuery.sh data</strong></span></pre><p>The output of the command is as follows:</p><div class="mediaobject"><img src="/graphics/9781788620901/graphics/373e429b-20c6-4332-a172-6e4d1e5312c4.png" /></div><p>Enter <code class="literal">voters</code> to query that term:</p><div class="mediaobject"><img src="/graphics/9781788620901/graphics/e531db0f-ac00-4936-89ec-3c5e734df1e0.png" /></div><p>The output shows the rankings and score for each of the three CSV files for the term <code class="literal">voters</code>. This shows that <code class="literal">news1.csv</code> is ranked first, <code class="literal">news2.csv</code> is second, and <code class="literal">news3.csv</code> is third.</p><p> </p><p>Next, enter <code class="literal">delegates</code> to query that term:</p><div class="mediaobject"><img src="/graphics/9781788620901/graphics/72ff323a-a313-40d1-ae6d-362ac5887df2.png" /></div><p>The output shows that <code class="literal">news2.csv</code> is ranked first, <code class="literal">news1.csv</code> is ranked second, and <code class="literal">news3.csv</code> is not shown since the term <code class="literal">delegates</code> do not appear in this document.</p><p>We can query <span>multiple</span><a id="id325804938" class="indexterm"></a> terms by entering them together; enter <code class="literal">voters delegates</code> to query for both terms:</p><div class="mediaobject"><img src="/graphics/9781788620901/graphics/7863b10e-5c05-4930-a667-dc53b042d445.png" /></div><p>The output shows that <code class="literal">news2.csv</code> is ranked first, <code class="literal">news1.csv</code> is ranked second, and <code class="literal">news3.csv</code> is ranked third.</p><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>We can perform a weighted query (or <span class="emphasis"><em>boosting</em></span>) to give one term more important than the others. Enter <code class="literal">voters^5 delegates</code> to give the term <code class="literal">voters</code> a boost factor of <code class="literal">5</code>:</li></ol></div><div class="mediaobject"><img src="/graphics/9781788620901/graphics/a6cf588f-173a-495d-95e8-57a11454617a.png" /></div><p> </p><p>The output shows that <code class="literal">news1.csv</code> is ranked first and <code class="literal">news2.csv</code> is ranked second. Note that these two rankings are reversed from when we performed the same query without boosting.</p><p>Enter <code class="literal">q</code> to quit this script.</p><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>View the TF-IDF. Run the <code class="literal">runLuceneTF-IDF.sh</code> data to see the TF-IDF for terms in the documents:</li></ol></div><pre class="programlisting"><span class="strong"><strong>./runLuceneTFIDF.sh data</strong></span></pre><p>The output <span>should</span><a id="id325808141" class="indexterm"></a> look like the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781788620901/graphics/c78c2d8b-322b-4db1-bb15-3699a3395504.png" /></div><p>Enter <code class="literal">voters</code> to see the <code class="literal">TF-IDF</code> for that term:</p><div class="mediaobject"><img src="/graphics/9781788620901/graphics/6ffad2a2-613d-4870-93a1-f8d63cec6e14.png" /></div><p>Enter <code class="literal">delegates</code> to see the <code class="literal">TF-IDF</code> for that term:</p><div class="mediaobject"><img src="/graphics/9781788620901/graphics/d3560d7d-4c0c-42ee-9534-12f7fde094c5.png" /></div><p>Enter <code class="literal">q</code> to quit this script.</p><p> </p></div></div>