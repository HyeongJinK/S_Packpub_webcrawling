<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch01lvl1sec13"></a>Machine learning, classification, and logistic regression</h2></div></div><hr /></div><p>Let's now <span>learn</span><a id="id326530811" class="indexterm"></a> about <span>machine</span><a id="id326530807" class="indexterm"></a> learning, classification, and <span>logistic</span><a id="id326530554" class="indexterm"></a> regression.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec15"></a>Machine learning</h3></div></div></div><p>Machine learning refers to <span>the</span><a id="id326530535" class="indexterm"></a> application of algorithms to make computers learn from data. The models that are learned by computers are used to make predictions and forecasts. Machine learning has been successfully applied in a variety of areas, such as natural language processing, self-driving vehicles, image and speech recognition, chatbots, and computer vision.</p><p>Machine learning algorithms are broadly categorized into three types:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><span class="strong"><strong>Supervised learning</strong></span>: In supervised learning, the machine learns the model from a <span>training</span><a id="id326530524" class="indexterm"></a> dataset that consists of features and labels. The supervised learning problems are generally of two types: <span class="emphasis"><em>regression</em></span> and <span class="emphasis"><em>classification</em></span>. Regression refers to predicting future <span>values</span><a id="id326530506" class="indexterm"></a> based on the model, while classification refers to predicting the categories of the input values.</li><li style="list-style-type: disc"><span class="strong"><strong>Unsupervised learning</strong></span>: In unsupervised learning, the machine learns the model from a <span>training</span><a id="id326530494" class="indexterm"></a> dataset that <span>consists</span><a id="id326420193" class="indexterm"></a> of features only. One of the most common types of unsupervised learning is known as <span class="strong"><strong>clustering</strong></span>. Clustering <span>refers</span><a id="id326420179" class="indexterm"></a> to dividing the input data into multiple groups, thus producing clusters or segments.</li><li style="list-style-type: disc"><span class="strong"><strong>Reinforcement learning</strong></span>: In reinforcement learning, the agent starts with an initial model <span>and</span><a id="id325613100" class="indexterm"></a> then continuously learns the model based on the feedback from the environment. A reinforcement learning <span>agent</span><a id="id325615014" class="indexterm"></a> learns or updates the model by applying supervised or unsupervised learning techniques as part of the reinforcement learning algorithms.</li></ul></div><p>These machine learning problems are abstracted to the following equation in one form or another:</p><div class="mediaobject"><img src="/graphics/9781789132212/graphics/c90834f4-0249-4061-a374-1b0cd1cd37dd.png" /></div><p>Here, <span class="emphasis"><em>y</em></span> represents the <span class="emphasis"><em>target</em></span> and <span class="emphasis"><em>x</em></span> represents the <span class="emphasis"><em>feature</em></span>. If <span class="emphasis"><em>x</em></span> is a collection of features, it is also called a feature vector and denoted with <span class="emphasis"><em>X</em></span>. The model is the function <span class="emphasis"><em>f</em></span> that maps features to targets. Once the computer learns <span class="emphasis"><em>f</em></span>, it can use the new values of <span class="emphasis"><em>x</em></span> to predict the values of <span class="emphasis"><em>y</em></span>.</p><p>The preceding simple equation can be rewritten in the context of linear models for machine learning as follows:</p><div class="mediaobject"><img src="/graphics/9781789132212/graphics/7645d8e9-a560-4db6-bf10-a3985e081fa1.png" /></div><p>Here, <span class="emphasis"><em>w</em></span> is known as the weight and <span class="emphasis"><em>b</em></span> is known as the bias. Thus, the machine learning problem now can be stated as a problem of finding w and <span class="emphasis"><em>b</em></span> from the current values of <span class="emphasis"><em>X</em></span> so that the equation can now be used to predict the values of <span class="emphasis"><em>y</em></span>. </p><p>Regression analysis or regression modeling refers to the methods and techniques used to estimate relationships among variables. The variables that are used as input for regression models are called independent variables, predictors, or features, and the output variables from regression models are called dependent variables or targets. Regression models are defined as follows:</p><div class="mediaobject"><img src="/graphics/9781789132212/graphics/caaccde0-0106-470a-b7a2-50d69ce6df2e.png" /></div><p>Where <span class="emphasis"><em>Y</em></span> is the target variable, <span class="emphasis"><em>X</em></span> is a vector of features, and <span class="emphasis"><em>β</em></span> is a vector of parameters (<span class="emphasis"><em>w</em></span>,<span class="emphasis"><em>b</em></span> in the preceding equation).</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec16"></a>Classification</h3></div></div></div><p>Classification is one of the classical problems in machine learning. Data <span>under</span><a id="id325748227" class="indexterm"></a> consideration could belong to one class or another, for example, if the images provided are data, they could be pictures of cats or dogs. Thus, the classes, in this case, are cats and dogs. Classification means identifying the label or class of the objects under consideration. Classification falls under the umbrella of supervised machine learning. In classification problems, a training dataset is provided that has features or inputs and their corresponding outputs or labels. Using this training dataset, a model is trained; in other words, the parameters of the model are computed. The trained model is then used on new data to find its correct labels.</p><p>Classification problems can be of two types: <span class="strong"><strong>binary class</strong></span> or <span class="strong"><strong>multiclass</strong></span>. Binary class <span>means</span><a id="id325748254" class="indexterm"></a> that the data is to be classified into two distinct and discrete labels; for example, the patient has cancer or the patient does not have cancer, and the images are of cats or dogs and so on. Multiclass <span>means</span><a id="id326034368" class="indexterm"></a> that the data is to be classified among multiple classes, for example, an email classification problem will divide emails into social media emails, work-related emails, personal emails, family-related emails, spam emails, shopping offer emails, and so on. Another example would be of pictures of digits; each picture could be labeled between 0 and 9, depending on what digit the picture represents. In this chapter, we will look at examples of both kinds of classification.</p><p>The most popular method for classification is logistic regression. Logistic regression is a probabilistic and linear classifier. The probability that the vector of input features belongs to a specific class can be described mathematically by the following equation: </p><div class="mediaobject"><img src="/graphics/9781789132212/graphics/0338114a-77c6-4e54-a128-8d4a550e0116.png" /></div><p>In the preceding equation, the following applies:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><span class="emphasis"><em>Y</em></span> represents the output</li><li style="list-style-type: disc"><span class="emphasis"><em>i</em></span> represents one of the classes</li><li style="list-style-type: disc"><span class="emphasis"><em>x</em></span> represents the inputs</li><li style="list-style-type: disc"><span class="emphasis"><em>w</em></span> represents the weights</li><li style="list-style-type: disc"><span class="emphasis"><em>b</em></span> represents the biases</li><li style="list-style-type: disc"><span class="emphasis"><em>z</em></span> represents the regression equation <div class="mediaobject"><img src="/graphics/9781789132212/graphics/08ca8f4b-323a-466f-bc0b-1541e4a2d75b.png" /></div></li><li style="list-style-type: disc"><span class="emphasis"><em>ϕ</em></span> represents the smoothing function (or model, in our case)</li></ul></div><p>The <span class="emphasis"><em>ϕ(z)</em></span> function represents the probability that <span class="emphasis"><em>x</em></span> belongs to class <span class="emphasis"><em>i</em></span> when <span class="emphasis"><em>w</em></span> and <span class="emphasis"><em>b</em></span> are given. Thus, the model has to be trained to maximize the value of this probability.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec17"></a>Logistic regression for binary classification</h3></div></div></div><p>For binary classification, the <span>model</span><a id="id326070788" class="indexterm"></a> function <span class="emphasis"><em>ϕ(z)</em></span> is defined as<span class="emphasis"><em> </em></span>the sigmoid function, which can be described as follows:</p><div class="mediaobject"><img src="/graphics/9781789132212/graphics/a3deb71d-d576-431b-9521-5deec4004203.png" /></div><p>The sigmoid function transforms the <span class="emphasis"><em>y</em></span> value to be between the range [0,1]. Thus, the value of <span class="emphasis"><em>y=ϕ(z)</em></span> can be used to predict the class: if <span class="emphasis"><em>y</em></span> &gt; 0.5, then the object belongs to 1, otherwise the object belongs to 0.</p><p>The <span>model</span><a id="id326237212" class="indexterm"></a> training means to search for the parameters that minimize the loss function, which can either be the sum of squared errors or the sum of mean squared errors. For logistic regression, the likelihood is maximized as follows:</p><p> </p><div class="mediaobject"><img src="/graphics/9781789132212/graphics/ce304586-5044-41a3-a2aa-cf84734b7aed.png" /></div><p>However, as it is easier to maximize the log-likelihood, we use the log-likelihood (<span class="emphasis"><em>l(w)</em></span>) as the cost function. The loss function (<span class="emphasis"><em>J(w)</em></span>) is written as <span class="emphasis"><em>-l(w)</em></span>, and can be minimized by using optimization algorithms such as gradient descent.</p><p>The loss function for binary logistic regression is written mathematically as follows:</p><div class="mediaobject"><img src="/graphics/9781789132212/graphics/4d99be96-7f23-4689-8228-a0bb09f72e26.png" /></div><p>Here, <span class="emphasis"><em>ϕ(z)</em></span> is the sigmoid function.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec18"></a>Logistic regression for multiclass classification</h3></div></div></div><p>When more than two <span>classes</span><a id="id326237514" class="indexterm"></a> are involved, logistic regression is <span>known</span><a id="id326237523" class="indexterm"></a>as multinomial logistic regression. In multinomial logistic regression, instead of sigmoid, use the softmax function, which can be described mathematically as <span>follows</span>:</p><div class="mediaobject"><img src="/graphics/9781789132212/graphics/fa60e35a-c473-41aa-8b94-66d3fcf3b94b.png" /></div><p>The softmax function produces the probabilities for each class so that the probabilities vector adds up to <span class="emphasis"><em>1</em></span>. At the time of inference, the class with the highest softmax value becomes the output or predicted class. The loss function, as we discussed earlier, is the negative log-likelihood function, <span class="emphasis"><em>-l(w)</em></span>, that can be minimized by the optimizers, such as gradient descent.</p><p>The loss function for multinomial logistic regression is written formally as follows:</p><div class="mediaobject"><img src="/graphics/9781789132212/graphics/1acb1fcd-269a-43a2-bd5a-f793676900a5.png" /></div><p>Here, <span class="emphasis"><em>ϕ(z)</em></span> is the softmax function.</p><p>We will implement this loss function in the next section. In the following section, we will dig into our example for multiclass classification with logistic regression in TensorFlow.</p></div></div>