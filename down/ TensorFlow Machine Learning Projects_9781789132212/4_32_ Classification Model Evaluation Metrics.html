<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch04lvl1sec37"></a>Classification Model Evaluation Metrics</h2></div></div><hr /></div><p>Just building a model does not suffice; we need to make sure that our model functions well and gives us a <span>good</span><a id="id325290156" class="indexterm"></a> and accurate output. To do this, we need to understand some classification metrics that will be used to evaluate the model throughout this book.</p><p>Let's begin by defining some building blocks of the metrics that will be used to evaluate the classification models. To do this, take a simple example of spam detection that is done by any online mailbox for reference. A spam email shall be considered to be of a positive class and the normal email to be of a negative class. We can summarize this spam detection model into four categories, which are illustrated in the following matrix:</p><div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; "><colgroup><col /><col /></colgroup><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>True positives</strong></span> (<span class="strong"><strong>TP</strong></span>)</p></td><td style="border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>False positives</strong></span> (<span class="strong"><strong>FP</strong></span>)</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Reality: Email is spam</p></td><td style="border-bottom: 0.5pt solid ; "><p>Reality: Email is NOT spam</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Model Prediction: Email is spam</p></td><td style="border-bottom: 0.5pt solid ; "><p>Model Prediction: Email is spam</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>False negatives</strong></span> (<span class="strong"><strong>FN</strong></span>)</p></td><td style="border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>True negatives</strong></span> (<span class="strong"><strong>TN</strong></span>)</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Reality: Email is spam</p></td><td style="border-bottom: 0.5pt solid ; "><p>Reality: Email is NOT spam</p></td></tr><tr><td style="border-right: 0.5pt solid ; "><p>Model Prediction: Email is NOT spam</p></td><td style=""><p>Model Prediction: Email is NOT spam</p></td></tr></tbody></table></div><p>This matrix is also <span>commonly</span><a id="id325610523" class="indexterm"></a> known as the <span class="strong"><strong>confusion matrix.</strong></span></p><p>The three major metrics that we will use to define classifier quality, primarily in an unbalanced dataset, are as follows:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><span class="strong"><strong>Accuracy: </strong></span>Accuracy is the <span>most</span><a id="id325611570" class="indexterm"></a> basic metric used for classification problems. It is defined as follows:</li></ul></div><div class="mediaobject"><img src="/graphics/9781789132212/graphics/45baea24-dfc2-453d-83d1-a93b2301bd46.png" /></div><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><span class="strong"><strong>Precision: </strong></span>Precision tries to <span>measure</span><a id="id325611686" class="indexterm"></a> the true positives out of all predicted positives from the model. If your Gmail doesn't misclassify a lot of emails from your friends (or normal emails) and put them into spam, then it has very high precision. It is mathematically represented as follows: </li></ul></div><div class="mediaobject"><img src="/graphics/9781789132212/graphics/f699fce9-563f-4657-98df-e4f03f10221e.png" /></div><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><span class="strong"><strong>Recall: </strong></span>Recall tries to <span>measure</span><a id="id325611717" class="indexterm"></a> the number of values classified as positive out of all real positives in the dataset. In simple terms, if your Gmail doesn't misclassify a lot of your spam emails as normal emails and sends them to your inbox, then it has very high recall:</li></ul></div><div class="mediaobject"><img src="/graphics/9781789132212/graphics/752aa285-86e3-4c05-a356-74ec1574005e.png" /></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note30"></a>Note</h3><p>Ideally, we want a model with high precision and high recall. However, there is always a trade-off between high precision and high recall in machine learning.</p></div></div>