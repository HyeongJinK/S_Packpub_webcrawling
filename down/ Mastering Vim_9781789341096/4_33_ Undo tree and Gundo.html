<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch04lvl1sec37"></a>Undo tree and Gundo</h2></div></div><hr /></div><p>Most modern editors support an undo stack, with undoing and <span>replaying</span><a id="id326437194" class="indexterm"></a> operations. Vim takes that one step further by introducing an undo tree. If you make a change, X, undo it, and then make a change, Y—Vim still saves the change, X. Vim supports manually browsing <span>undo</span><a id="id326437188" class="indexterm"></a> tree leaves, but there's a better way to do this.</p><p>Gundo is a plugin that visualizes the <span>undo</span><a id="id326437172" class="indexterm"></a> tree and is available from GitHub at: <a class="ulink" href="https://github.com/sjl/gundo.vim.git" target="_blank">https://github.com/sjl/gundo.vim.git</a>.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note88"></a>Note</h3><p>If you're using <code class="literal">vim-plug</code> to manage your plugins, add the following to your <code class="literal">.vimrc</code> file: <code class="literal">Plug 'sjl/gundo.vim'</code>. Execute <code class="literal">:w | so $MYVIMRC | PlugInstall</code> and you'll have Gundo installed and ready to go.</p></div><p>Let's say you're working on <code class="literal">animal_farm.py</code>, with your cursor on line 15:</p><div class="mediaobject"><img src="/graphics/9781789341096/graphics/568451cb-1b97-4604-9feb-c41041b0ffa7.png" /></div><p> </p><p>You're editing the highlighted line: <code class="literal">if kind == 'cat'</code>. You perform the following operations:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Replace the <code class="literal">cat</code> text with <code class="literal">leopard</code></li><li>Undo the edit using the undo command (<code class="literal">u</code>)</li><li>Replace the <code class="literal">cat</code> text with <code class="literal">lion</code></li></ol></div><p>Normally, you'd expect the edit where you changed <code class="literal">cat</code> to <code class="literal">leopard</code> to be lost, but since Vim has an undo tree, the change is preserved!</p><p>Executing <code class="literal">:GundoToggle</code> will open two new windows in a split: the visual representation of the tree (top-left) and the difference between that version and a previous snapshot (bottom-left). Here's how it looks:</p><div class="mediaobject"><img src="/graphics/9781789341096/graphics/75fc7709-1211-4913-bb93-aa4018350ee1.png" /></div><p></p><p>With your cursor over the Gundo window, you can navigate up and down the the tree with <code class="literal">j</code> and <code class="literal">k</code>. Go to the last change at the top of the tree if you're not already on it (you can use <code class="literal">gg</code> to quickly make your way to the top of the buffer). You can see how we changed the line containing <code class="literal">cat</code> to contain <code class="literal">lion</code> in our last change (lines starting with <code class="literal">-</code> signify a <span>removal</span><a id="id325850108" class="indexterm"></a> of the line, while lines starting with <code class="literal">+</code> show the addition of a line).</p><p>Now, hit <code class="literal">j</code> to go down the <span>tree</span><a id="id325853096" class="indexterm"></a> to a different (now unused) branch:</p><div class="mediaobject"><img src="/graphics/9781789341096/graphics/aa11ebdf-2ced-413d-89e6-bd337d4e4e47.png" /></div><p> </p><p>This is the edit we thought we had lost! You can see how we replaced the word <code class="literal">cat</code> with <code class="literal">leopard</code>. Hit <span class="emphasis"><em>Enter</em></span>, and Gundo will restore the edit!</p><p>Run <code class="literal">:GundoToggle</code> again to hide the undo tree.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip89"></a>Note</h3><p>If you're anything like me, you'll use the Gundo tree a lot. I have it mapped to the <span class="emphasis"><em>F5</em></span> key, to make it easier to invoke:<code class="literal">noremap &lt;f5&gt; :GundoToggle&lt;cr&gt;  " Map Gundo to &lt;F5&gt;.</code></p></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note90"></a>Note</h3><p>If you want to learn more about the undo tree, see <code class="literal">:help undo-tree</code>.</p></div></div>