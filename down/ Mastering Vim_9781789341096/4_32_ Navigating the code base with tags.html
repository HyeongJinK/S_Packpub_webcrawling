<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch04lvl1sec36"></a>Navigating the code base with tags</h2></div></div><hr /></div><p>A common task when navigating code bases is trying to <span>figure</span><a id="id325868188" class="indexterm"></a> out where certain methods are defined, and looking for occurrences of a certain method.</p><p>Vim has a built-in feature that allows you to navigate to the <span>definition</span><a id="id325868177" class="indexterm"></a> of a variable in the same file. With the cursor over a word, press <code class="literal">gd</code> to go to the declaration of the variable. For instance, open <code class="literal">animal_farm.py</code> and position your cursor at the beginning of <code class="literal">make_animal</code> on line 26. Press <code class="literal">gd</code>, and your cursor will jump to line 13, where the function is defined:</p><div class="mediaobject"><img src="/graphics/9781789341096/graphics/fab36d5a-621a-4b85-98f0-685018408e12.png" /></div><p><code class="literal">gd</code> will look for a local variable declaration first. There's also <code class="literal">gD</code><span class="emphasis"><em>,</em></span> which will look for a global declaration (starting at the beginning of at the file instead of the beginning of the current scope).</p><p>This feature is not syntax aware, as out-of-the-box Vim does not know how your code is structured semantically. However, Vim supports tags—a file of semantically meaningful words and constructs across your files. For example, in Python, likely candidates for tags are classes, functions, and methods.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec38"></a>Exuberant Ctags</h3></div></div></div><p>Exuberant Ctags is an external utility that generates tag files. Ctags is available at the following link: <a class="ulink" href="http://ctags.sourceforge.net" target="_blank">http://ctags.sourceforge.net</a>.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip84"></a>Note</h3><p>If you're on a Debian-flavored distribution, you can install Exuberant Ctags by running <code class="literal">sudo apt-get install ctags</code>.</p></div><p>Ctags introduces a <code class="literal">ctags</code> binary, which allows <span>you</span><a id="id325865730" class="indexterm"></a> to generate a <code class="literal">tags</code> file for your code base. Let's navigate to our project and try it out:</p><pre class="programlisting"><span class="strong"><strong>$ ctags -R .</strong></span></pre><p>This creates a <code class="literal">tags</code> file in the directory you're in.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip85"></a>Note</h3><p>You may want to set the following option in your <code class="literal">.vimrc</code> file:<code class="literal">set tags=tags;  " Look for a tags file recursively in</code>                                     <code class="literal">" parent directories.</code>
This will make sure that Vim looks for the  <code class="literal">tags</code> file recursively in parent directories to allow you to use a single <code class="literal">tags</code> file for the whole project. Semicolon (<code class="literal">;</code>) is what tells Vim to keep looking in parent directories until a <code class="literal">tags</code> file is found.</p></div><p></p><p>Now, open <code class="literal">animal_farm.py</code> in Vim. Place your cursor over a semantically meaningful keyword, for example, the <code class="literal">add_animal</code> method on line 26:</p><div class="mediaobject"><img src="/graphics/9781789341096/graphics/4cc094da-8194-49a0-b4e9-48d1d4cfbae7.png" /></div><p> </p><p>Hit <span class="emphasis"><em>Ctrl </em></span>+ <code class="literal">]</code> to follow the tag to the definition (which is in a different file—<code class="literal">farm.py</code>):</p><div class="mediaobject"><img src="/graphics/9781789341096/graphics/e5512792-c3d1-47e1-bdbe-ab5342249675.png" /></div><p>Use <span class="emphasis"><em>Ctrl </em></span>+ <span class="emphasis"><em>t </em></span>to go back in the tag stack (this will place your cursor back to where it was in the previous file).</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip86"></a>Note</h3><p>Jump list navigation with <span class="emphasis"><em>Ctrl </em></span>+ <span class="emphasis"><em>o </em></span>and <span class="emphasis"><em>Ctrl </em></span>+ <span class="emphasis"><em>i </em></span>also works, however, the two are using different lists.</p></div><p></p><p>If you have multiple tags with the same name, you can cycle through the available options by using the <code class="literal">:tn</code> (<span class="strong"><strong>next tag</strong></span>) and <code class="literal">:tp</code> (<span class="strong"><strong>previous tag</strong></span>) commands.</p><p>You can also bring up a list of tags by using the <code class="literal">:ts</code> (<span class="strong"><strong>tag select</strong></span>) menu. For example, if you jump to the definition of <code class="literal">get_kind</code> (using <span class="emphasis"><em>Ctrl </em></span>+ <code class="literal">]</code> from <code class="literal">animal.get_kind()</code> in <code class="literal">farm.py</code>, for instance) and execute <code class="literal">:ts</code>, you'll see the following menu:</p><div class="mediaobject"><img src="/graphics/9781789341096/graphics/a6889d45-24c9-4a70-a2bb-3d6a8bec417c.png" /></div><p> </p><p> </p><p>You can see what file, class, and method the tag refers to, and you can jump to the desired tag by entering a number.</p><p>You can also open a tag and select the menu instead of jumping to the tag under the cursor using <code class="literal">g]</code>.</p><p>You can jump to a tag location immediately as you open Vim. From your prompt, execute the following:</p><pre class="programlisting"><span class="strong"><strong>$ vim -t get_kind</strong></span></pre><p>This will take you directly to the <code class="literal">get_kind</code> tag.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec39"></a>Automatically updating the tags</h3></div></div></div><p>You probably don't want to have to <span>manually</span><a id="id325850081" class="indexterm"></a> run the <code class="literal">ctags -R .</code> command every time you make changes to the code. The simplest way to address this is to add the following to your <code class="literal">.vimrc</code> file:</p><pre class="programlisting">" Regenerate tags when saving Python files.
autocmd BufWritePost *.py silent! !ctags -R &amp;</pre><p>The preceding snippet runs <code class="literal">ctags -R</code> every time you save a Python file.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip87"></a>Note</h3><p>You can replace the preceding <code class="literal">*.py</code> extension with different file extensions depending on the language you'd like to work with. For example, the following will generate a <code class="literal">tags</code> file for C++ files:<code class="literal">autocmd BufWritePost *.cpp *.h silent! !ctags -R &amp; </code></p></div></div></div>