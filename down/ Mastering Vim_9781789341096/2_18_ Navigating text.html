<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch02lvl1sec24"></a>Navigating text</h2></div></div><hr /></div><p>We've covered some basic movements (by characters, words, and paragraphs), but Vim supports a lot more options for navigation.</p><p>Check the following if you want some <span>movement</span><a id="id326086384" class="indexterm"></a> within the current line:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">As you already know, <code class="literal">h</code> and <code class="literal">l</code> move the cursor left and right, respectively</li><li style="list-style-type: disc"><code class="literal">t</code> (un<span class="strong"><strong>t</strong></span>il) followed by a character allows you to search the line for that character and place the cursor before the character, while <code class="literal">T</code> allows you to search backward</li><li style="list-style-type: disc"><code class="literal">f</code> (<span class="strong"><strong>fi</strong></span>nd) followed by a character allows you to search the current line for that character and move the cursor to the character, while <code class="literal">F</code> allows you to search backward</li><li style="list-style-type: disc"><code class="literal">_</code> takes you to the beginning of the line and <code class="literal">$</code> takes you to the end of the line</li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note54"></a>Note</h3><p>A word consists of numbers, letters, and underscores. A WORD consists of any characters except for whitespace (like spaces, tabs, or newlines). This distinction helps with more precise navigation. For instance, <code class="literal">farm.add_animal(animal)</code> is a single WORD, while <code class="literal">farm</code>, <code class="literal">add_animal</code>, and <code class="literal">animal</code> are individual words.</p></div><p>For free-form movement, you're already familiar with these bits:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p><code class="literal">j</code> and <code class="literal">l</code> move the cursor down and up, respectively</p></li><li style="list-style-type: disc"><p><code class="literal">w</code> moves you to the beginning of the next word (<code class="literal">W</code> for WORD)</p></li><li style="list-style-type: disc"><p><code class="literal">b</code> moves you to the beginning of the previous word (<code class="literal">B</code> for WORD)</p></li><li style="list-style-type: disc"><p><code class="literal">e</code> moves you to the end of the next word (<code class="literal">E</code> for WORD)</p></li><li style="list-style-type: disc"><p><code class="literal">ge</code> moves you to the end of the previous word (<code class="literal">gE</code> for WORD)</p></li><li style="list-style-type: disc"><p><span class="emphasis"><em>Shift </em></span>+ <code class="literal">{</code> and <span class="emphasis"><em>Shift </em></span>+ <code class="literal">}</code> takes you to the beginning and the end of a paragraph</p></li></ul></div><p>Here are some new free-form movement options:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p><span class="emphasis"><em>Shift </em></span>+ <code class="literal">(</code> and <span class="emphasis"><em>Shift </em></span>+ <code class="literal">)</code> takes you to the beginning and the end a sentence</p></li><li style="list-style-type: disc"><p><code class="literal">H</code> takes you to the top of the current window, and <code class="literal">L</code> takes you to the bottom of the current window</p></li><li style="list-style-type: disc"><span class="emphasis"><em>Ctrl </em></span>+ f (or the <span class="emphasis"><em>Page Down</em></span> key) scrolls the buffer one page down, and <span class="emphasis"><em>Ctrl </em></span>+ b (or the <span class="emphasis"><em>Page Up</em></span> key) scrolls one page up</li><li style="list-style-type: disc"><p><code class="literal">/</code> followed by a string searches the document for a string and <span class="emphasis"><em>Shift </em></span>+ <code class="literal">?</code> to search backward</p></li><li style="list-style-type: disc"><p><code class="literal">gg</code> takes you to the top of the file</p></li><li style="list-style-type: disc"><p><code class="literal">G</code> takes you to the bottom of the file</p></li></ul></div><p>This handy visualization is based on the Vim movement cheat sheet Ted Nailed published on his blog sometime in 2010:</p><div class="mediaobject"><img src="/graphics/9781789341096/graphics/c36d8316-5f52-40ac-b5ab-337b953c0312.png" /></div><p>You can also move by line numbers. To enable line number display, run <code class="literal">:set nu</code>, followed by <span class="emphasis"><em>Enter</em></span> (or add <code class="literal">:set number</code> to your <code class="literal">.vimrc</code> file). Vim will dedicate a few columns on the left of the screen to display line numbers:</p><div class="mediaobject"><img src="/graphics/9781789341096/graphics/73b2ecf9-5cfa-4f41-b164-1167661685df.png" /></div><p>You can jump to a specific line by typing <code class="literal">:N</code> followed by <span class="emphasis"><em>Enter</em></span>, where N is the absolute line number. For instance, to jump to line 20, you'll run <code class="literal">:20</code> followed by <span class="emphasis"><em>Enter</em></span>.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note55"></a>Note</h3><p>You can also tell Vim to open a file and immediately place a cursor at a particular line. For that, add +N after the filename when invoking Vim, where N is the line number. For example, to open <code class="literal">animal_farm.py</code> on line 14, you'd run <code class="literal">$ vim animal_farm.py +14</code>.</p></div><p>Vim also supports relative line movement. To move <span>down</span><a id="id326470656" class="indexterm"></a> N lines you'll run <code class="literal">:+N</code> and to move down you'll run <code class="literal">:-N</code>. You can also ask Vim to display line numbers relative to the current cursor position with <code class="literal">:set relativenumber</code>. In the following screenshot, our cursor is on line 11, and Vim displays the relative distance to other lines:</p><div class="mediaobject"><img src="/graphics/9781789341096/graphics/dd162fc9-16b6-4c3b-bf0d-e6d0477a8b3c.png" /></div><p>For example, you could tell Vim to move to the line containing <code class="literal">def main(animals):</code> by typing <code class="literal">:+5</code>, followed by <span class="emphasis"><em>Enter</em></span>.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec20"></a>Jumping into insert mode</h3></div></div></div><p>You've already learned to enter insert mode using <code class="literal">i</code>, which puts you in <span>insert</span><a id="id326470779" class="indexterm"></a> mode at the position of the cursor.</p><p>There are a few more convenient shortcuts for entering insert mode:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p><code class="literal">a</code> places you in insert mode after the cursor</p></li><li style="list-style-type: disc"><p><code class="literal">A</code> places you in insert mode at the end of the line (equivalent of <code class="literal">$a</code>)</p></li><li style="list-style-type: disc"><p><code class="literal">I</code> places you in insert mode at the beginning of the line, but after indentation (equivalent of <code class="literal">_i</code>)</p></li><li style="list-style-type: disc"><code class="literal">o</code> adds a new line below the cursor before entering insert mode</li><li style="list-style-type: disc"><code class="literal">O</code> adds a new line above the cursor before entering insert mode</li><li style="list-style-type: disc"><code class="literal">gi</code> places you in insert mode where you last exited it</li></ul></div><p>You've also learned how to enter insert mode after deleting some code with the change command (<code class="literal">c</code>). Here are more ways to chain change commands:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><code class="literal">C</code> deletes text to the right of the cursor (until the end of the line) before entering insert mode</li><li style="list-style-type: disc"><code class="literal">cc</code> or <code class="literal">S</code> deletes the contents of the line before entering insert mode, while preserving indentation</li><li style="list-style-type: disc"><code class="literal">s</code> deletes a single character (prefix by a number to delete multiple) before placing you in insert mode</li></ul></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec21"></a>Searching with / and ?</h3></div></div></div><p>Most times one of the fastest ways to navigate somewhere is to search for a particular string. Vim allows you to search for a match by typing in <code class="literal">/</code> (which puts you in command-line mode) followed by a search string. Once you hit <span class="emphasis"><em>Enter</em></span>, your cursor will move to the first match.</p><p>Cycling through the matches in the same <span>buffer</span><a id="id326471013" class="indexterm"></a> can be done by pressing <code class="literal">n</code> to go to the next match and <code class="literal">N</code> to the previous match.</p><p>A useful option for searching is <code class="literal">set hlsearch</code> (consider setting it in your <code class="literal">.vimrc</code> file), since it highlights every match on the screen. For example, this is how running <code class="literal">/kind</code> in <code class="literal">animal_farm.py</code> looks with <code class="literal">hlsearch</code> enabled:</p><div class="mediaobject"><img src="/graphics/9781789341096/graphics/2a609515-0b9f-487d-a405-a3fe256ad9df.png" /></div><p>You can clear the highlights by executing <code class="literal">:noh</code>.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip56"></a>Note</h3><p>Another nifty trick is using<code class="literal">set incsearch</code>. This will make Vim dynamically move you to the first match as soon as you type.</p></div><p>In case you want to search backwards, replace<code class="literal">/</code>with<code class="literal">?</code>. This will also affect the way<code class="literal">n</code>and<code class="literal">N</code>will behave, showing a next backward match, and a previous backward match respectively.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch02lvl3sec10"></a>Searching across files</h4></div></div></div><p>Vim has two commands to <span>help</span><a id="id326497910" class="indexterm"></a> you search across files, <code class="literal">:grep</code> and <code class="literal">:vimgrep</code>:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><code class="literal">:grep</code> uses system <code class="literal">grep</code>, and is a great tool if you're already familiar with how <code class="literal">grep</code> works</li><li style="list-style-type: disc"><code class="literal">:vimgrep</code> is a part of Vim, and might be easier to use if you are not already familiar with <code class="literal">grep</code></li></ul></div><p>We'll focus on <code class="literal">:vimgrep</code>, since the <code class="literal">grep</code> tool is outside the scope of this book.</p><p>The syntax is as follows: <code class="literal">:vimgrep &lt;pattern&gt; &lt;path&gt;</code>. <code class="literal">pattern</code> could either be a string or a Vim-flavored regular expression. <code class="literal">path</code> will often be a wildcard; use <code class="literal">**</code> as a path to search recursively (or <code class="literal">**/*.py</code> to restrict by filetype).</p><p>Let's try searching for a <code class="literal">calc</code> substring in our code base:</p><pre class="programlisting"><span class="strong"><strong>:vimgrep animal **/* .py</strong></span></pre><p>This will take us to the first match, displaying the number of matches at the bottom of the screen:</p><div class="mediaobject"><img src="/graphics/9781789341096/graphics/bb7584c0-7845-4197-bad0-8ab0de78502a.png" /></div><p> </p><p>To navigate through the matches, use <code class="literal">:cn</code> or <code class="literal">:cp</code>. However, you might want to open a visual quickfix window by using <code class="literal">:copen</code>, as follows:</p><div class="mediaobject"><img src="/graphics/9781789341096/graphics/62a9b80b-718f-4638-ae15-d47a03558d66.png" /></div><p>You can navigate the quickfix list with the <code class="literal">j</code> and <code class="literal">k</code> keys and jump to a match by pressing <span class="emphasis"><em>Enter</em></span>. The quickfix window can be closed like any other window by typing <code class="literal">:q</code> or running <span class="emphasis"><em>Ctrl </em></span>+ <span class="emphasis"><em>w, </em></span><code class="literal">q</code>. You can read more about it in the <span class="emphasis"><em>Quickfix</em></span> <span class="emphasis"><em>List</em></span> section<span class="emphasis"><em> </em></span>in <a class="link" href="#" linkend="ch05">Chapter 5</a>, <span class="emphasis"><em>Build, Test, and Execute.</em></span></p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch02lvl3sec11"></a>ack</h4></div></div></div><p>On Linux, you can use Vim in conjunction with <code class="literal">ack</code> to <span>search</span><a id="id326632024" class="indexterm"></a> through code bases. <code class="literal">ack</code> is the spiritual successor of <code class="literal">grep</code>, and is focused on working with code. Install it using your favorite package manager; here's an <span>example</span><a id="id325877158" class="indexterm"></a> of using <code class="literal">apt-get</code>:</p><pre class="programlisting"><span class="strong"><strong>$ sudo apt-get install ack-grep</strong></span></pre><p> </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note57"></a>Note</h3><p>Visit <a class="ulink" href="https://beyondgrep.com/install" target="_blank">https://beyondgrep.com/install</a> to learn more about <code class="literal">ack</code> and for installation instructions.</p></div><p>For example, you can now use <code class="literal">ack</code> from the command line to search for all Python files recursively (starting in the current directory) containing the word <code class="literal">Animal</code>:</p><pre class="programlisting"><span class="strong"><strong>$ ack --python Animal</strong></span></pre><p>The preceding code will produce output similar to <code class="literal">grep</code>:</p><div class="mediaobject"><img src="/graphics/9781789341096/graphics/86e33fc3-c84b-4fae-bbe4-ac730ac0ec32.png" /></div><p>Vim has a plugin that integrates the result of <code class="literal">ack</code> in Vim's quickfix window (see the <span class="emphasis"><em>Quickfix List</em></span> section in <a class="link" href="#" linkend="ch05">Chapter 5</a>, <span class="emphasis"><em>Build, Test, and Execute</em></span>, to learn more about quickfix). The plugin is available from <a class="ulink" href="https://github.com/mileszs/ack.vim" target="_blank">https://github.com/mileszs/ack.vim</a>. After installation, you will be able to execute <code class="literal">:Ack</code> from Vim:</p><pre class="programlisting"><span class="strong"><strong>:Ack --python Animal</strong></span></pre><p> </p><p>This will run <code class="literal">ack</code> and populate the quickfix window (see the preceding section, as well as <span class="emphasis"><em>Quickfix</em></span> <span class="emphasis"><em>List</em></span> in <a class="link" href="#" linkend="ch05">Chapter 5</a>, <span class="emphasis"><em>Build, Test, and Execute</em></span>, for more information about a quickfix window) with the output:</p><div class="mediaobject"><img src="/graphics/9781789341096/graphics/31e4f9dd-9177-4a29-915c-38a5909818ea.png" /></div></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec22"></a>Utilizing text objects</h3></div></div></div><p>Text objects are an additional type of object in Vim. Text <span>objects</span><a id="id325902350" class="indexterm"></a> allow you to manipulate text within parentheses or quotes, which becomes really useful when working with code. Text objects are only available when combined with other operators like change or delete or a visual mode (see <span class="emphasis"><em>Visual and Select Modes</em></span> in <a class="link" href="#" linkend="ch03">Chapter 3</a>, <span class="emphasis"><em>Follow the Leader – Plugin Management</em></span>).</p><p>Let's give it a shot. Navigate your cursor to the text between parentheses:</p><div class="mediaobject"><img src="/graphics/9781789341096/graphics/0dcb367d-acdd-49bd-982f-716f026a4184.png" /></div><p>Now, type in <code class="literal">di)</code> (delete inside parentheses). This will delete the text inside parentheses:</p><div class="mediaobject"><img src="/graphics/9781789341096/graphics/7d5d27b8-dee1-4217-bceb-e0021f535e59.png" /></div><p>This works similarly with a change command. Undo the previous change (<code class="literal">u</code>) and start in the same spot:</p><div class="mediaobject"><img src="/graphics/9781789341096/graphics/0dcb367d-acdd-49bd-982f-716f026a4184.png" /></div><p>Execute <code class="literal">c2aw</code> (change the outside of two words) to delete two words (with the surrounding spaces) and enter insert mode:</p><div class="mediaobject"><img src="/graphics/9781789341096/graphics/f70bf43e-cb26-4ef2-8a58-f004dc804713.png" /></div><p>Text objects come in two flavors—inner objects (prefixed by <code class="literal">i</code>) and outer objects (prefixed by <code class="literal">a</code>). Inner objects do not include white space (or other surrounding characters), while outer objects do.</p><p>A full list of text objects can be looked up through <code class="literal">:help text-objects</code>, but some interesting ones are as follows:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><code class="literal">w</code> and <code class="literal">W</code> for words and WORDs</li><li style="list-style-type: disc"><code class="literal">s</code> for sentences</li><li style="list-style-type: disc"><code class="literal">p</code> for paragraphs</li><li style="list-style-type: disc"><code class="literal">t</code> for HTML/XML tags</li></ul></div><p>Pairs of characters that are most often used in programming are all supported as text objects: <code class="literal">`</code>, <code class="literal">'</code>, <code class="literal">"</code>, <code class="literal">)</code>, <code class="literal">]</code>, <code class="literal">&gt;</code>, and <code class="literal">}</code> select the text enclosed by the characters.</p><p>One way to think about working with text objects is that it's like constructing sentences. Here are the two examples that we used previously broken down:</p><div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; "><colgroup><col /><col /><col /><col /></colgroup><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>Verb</strong></span></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>(Number)</strong></span></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>Adjective</strong></span></p></td><td style="border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>Noun</strong></span></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">d</code> delete</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p> </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">i</code> inside</p></td><td style="border-bottom: 0.5pt solid ; "><p><code class="literal">)</code> parentheses</p></td></tr><tr><td style="border-right: 0.5pt solid ; "><p><code class="literal">c</code> change</p></td><td style="border-right: 0.5pt solid ; "><p><code class="literal">2</code></p></td><td style="border-right: 0.5pt solid ; "><p><code class="literal">a</code> outside</p></td><td style=""><p><code class="literal">w</code> word</p></td></tr></tbody></table></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec23"></a>Plugin spotlight – EasyMotion</h3></div></div></div><p>EasyMotion has been in an essential <span>part</span><a id="id325931831" class="indexterm"></a> of my kit since I came across it. It simplifies navigation by <span>allowing</span><a id="id325931840" class="indexterm"></a> you to jump to the desired position with speed and precision. It's available from <a class="ulink" href="https://github.com/easymotion/vim-easymotion.git" target="_blank">https://github.com/easymotion/vim-easymotion</a> (see <span class="emphasis"><em>Installing plugins</em></span> for installation instructions). </p><p>After installing it, you can invoke the plugin by hitting the leader key (<code class="literal">\</code>) twice, followed by the desired movement key.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note58"></a>Note</h3><p>The leader key is often used by plugins to provide additional key mappings. By default, Vim's leader key is <code class="literal">\</code>. We'll go into more detail about the leader key in <a class="link" href="#" linkend="ch03">Chapter 3</a>, <span class="emphasis"><em>Follow the Leader – Plugin Management</em></span>.</p></div><p>Try using it with a word-wise motion by invoking <code class="literal">\ \ w</code> (backslash, followed by a backslash, followed by <code class="literal">w</code>):</p><div class="mediaobject"><img src="/graphics/9781789341096/graphics/0a5a5b15-6664-4a58-b273-fc9fbc6c0a88.png" /></div><p>You can see that the beginning of every word on the screen have been replaced with a letter (or two letters, once EasyMotion runs out of English letters from the alphabet). Pressing the letter (or two in order) will instantly transport your cursor to that spot on the screen.</p><p>EasyMotion supports the following movement commands by default (all prefixed by double tapping the leader key):</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><code class="literal">f</code>, to look for a character to the right and <code class="literal">F</code> to look for the character on the left</li><li style="list-style-type: disc"><code class="literal">t</code>, to move until the character on the right and <code class="literal">T</code> until the character on the left</li><li style="list-style-type: disc"><code class="literal">w</code>, to move by word (and <code class="literal">W</code> by WORD)</li><li style="list-style-type: disc"><code class="literal">b</code>, to move backward by word (and <code class="literal">B</code> by WORD)</li><li style="list-style-type: disc"><code class="literal">e</code>, to move forward to the end of the word (and <code class="literal">E</code> for the WORD)</li><li style="list-style-type: disc"><code class="literal">ge</code>, to move backward to the end of the word (and <code class="literal">gE</code> for the WORD)</li><li style="list-style-type: disc"><code class="literal">k</code> and <code class="literal">j</code> to go to the beginning of the line up or down</li><li style="list-style-type: disc"><code class="literal">n</code> and <code class="literal">N</code> for jumping through search results on the page (based on the last <code class="literal">/</code> or <code class="literal">?</code> search)</li></ul></div><p>EasyMotion leaves many keys unassigned, leaving it up to the user to <span>build</span><a id="id325944193" class="indexterm"></a> their own set of mappings. You should check <code class="literal">:help easymotion</code> to see everything EasyMotion can do.</p></div></div>