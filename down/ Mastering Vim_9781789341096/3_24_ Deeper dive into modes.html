<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch03lvl1sec29"></a>Deeper dive into modes</h2></div></div><hr /></div><p>You've already encountered a few different modes Vim operates in, and this <span>section</span><a id="id326436741" class="indexterm"></a> will cover these and the remaining modes in depth. As you have already learned, Vim uses modes to know how to respond to input: a key press in normal mode will produce different results from a key press in insert or command-line mode.</p><p>Vim has seven primary modes, and it's important to understand what each mode does in order to comfortably navigate Vim.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec29"></a>Normal mode</h3></div></div></div><p>This is where <span>you</span><a id="id326436715" class="indexterm"></a> will (and already have) spend most of your time with Vim. You enter <span class="strong"><strong>normal mode</strong></span> by default when opening Vim, and you can go back to <span>normal</span><a id="id326436708" class="indexterm"></a> mode from other modes by pressing the <span class="emphasis"><em>Esc </em></span>key (sometimes twice).</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec30"></a>Command-line and ex modes</h3></div></div></div><p><span class="strong"><strong>Command-line mode</strong></span> is entered by <span>typing</span><a id="id326415385" class="indexterm"></a> a colon (:) or when searching for text with <code class="literal">/</code> or <code class="literal">?</code>, and allows <span>you</span><a id="id326415381" class="indexterm"></a> to input a command until you hit <span class="emphasis"><em>Enter</em></span>. Command-line mode <span>provides</span><a id="id326415351" class="indexterm"></a> some useful shortcuts:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">The up and down arrows (or <span class="emphasis"><em>Ctrl </em></span>+ <span class="emphasis"><em>p</em></span> and <span class="emphasis"><em>Ctrl </em></span>+ <span class="emphasis"><em>n</em></span>) let you traverse command history one by one </li><li style="list-style-type: disc"><span class="emphasis"><em>Ctrl </em></span>+ <span class="emphasis"><em>b</em></span> and <span class="emphasis"><em>Ctrl </em></span>+ <span class="emphasis"><em>e</em></span> let you go to the <span class="strong"><strong>b</strong></span>eginning and the <span class="strong"><strong>e</strong></span>nd of the line respectively</li><li style="list-style-type: disc">The <span class="emphasis"><em>Shift </em></span>or <span class="emphasis"><em>Ctrl </em></span>keys combined with left or right arrows allows you to move by words</li></ul></div><p>A highly useful shortcut is <span class="emphasis"><em>Ctrl </em></span>+ <span class="emphasis"><em>f</em></span>, which opens an editable command-line window with a history of the commands you ran:</p><p> </p><div class="mediaobject"><img src="/graphics/9781789341096/graphics/5d60ea88-a8ee-4223-a846-b357a96b1509.png" /></div><p>For editing purposes, it's a regular buffer, so you can find a command you've executed before, edit it (the way you'd edit any text in Vim), and execute it again. You can press <span class="emphasis"><em>Enter</em></span> to execute the line your cursor is on or <span class="emphasis"><em>Ctrl </em></span>+ <span class="emphasis"><em>c</em></span> to close the buffer.</p><p>You can learn more about working with command-line mode by looking up <code class="literal">:help cmdline-editing</code>.</p><p>Vim has a variation of the command-line mode called <span class="strong"><strong>ex mode</strong></span>, which is entered by pressing <code class="literal"><span class="emphasis"><em>Q</em></span></code>. Ex mode is a compatibility mode with Vim's precursor—<code class="literal">ex</code>. It allows you to execute multiple commands without exiting the <span>mode</span><a id="id325633659" class="indexterm"></a> after each command, but has very limited uses today.</p><p> </p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec31"></a>Insert mode</h3></div></div></div><p><span class="strong"><strong>Insert mode</strong></span> is used to type in text, and that's about it. Hitting <span class="emphasis"><em>Esc</em></span> takes you back to <span>normal</span><a id="id325844904" class="indexterm"></a> mode, which is where you should be performing most of your work. When in insert mode, you can also use<span class="emphasis"><em>Ctrl </em></span>+ <span class="emphasis"><em>o</em></span> to execute a single normal <span>mode</span><a id="id325844919" class="indexterm"></a> command and end up back in insert mode.</p><p>Insert mode is indicated by <strong class="userinput"><code>-- INSERT --</code></strong> displayed in a status line.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec32"></a>Visual and select mode</h3></div></div></div><p>Vim's <span class="strong"><strong>visual mode</strong></span> allows for an <span>arbitrary</span><a id="id325844944" class="indexterm"></a> selection of text (usually to perform <span>some</span><a id="id325844984" class="indexterm"></a> sort of operations on). It's useful when you want to work with a section of a file that does not map to <span>an</span><a id="id325844990" class="indexterm"></a> existing text objects (word, sentence, paragraph, and so on). There are <span>three</span><a id="id325844999" class="indexterm"></a> ways to enter visual mode:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p><code class="literal"><span class="emphasis"><em>v</em></span></code> enters a character-wise visual mode (status line text: <strong class="userinput"><code>-- VISUAL --</code></strong>)</p></li><li style="list-style-type: disc"><p><code class="literal"><span class="emphasis"><em>V</em></span></code> enters a line-wise visual mode (status line text: <strong class="userinput"><code>-- VISUAL LINE --</code></strong>)</p></li><li style="list-style-type: disc"><p><span class="emphasis"><em>Ctrl </em></span>+ <span class="emphasis"><em>v </em></span>enters a block-wise visual mode (status line text: <strong class="userinput"><code>-- VISUAL BLOCK --</code></strong>)</p></li></ul></div><p>Once you enter visual mode, you are able to move your cursor using the usual movement commands, which would expand the selection. In the following example, we've entered a character-wise visual mode and moved the cursor by three words and one character to the right (by executing <span class="emphasis"><em><code class="literal">3e</code> </em></span>and then <code class="literal"><span class="emphasis"><em>l</em></span></code>). You can see <code class="literal">animal_farm.add_animal()</code> being selected in visual mode:</p><div class="mediaobject"><img src="/graphics/9781789341096/graphics/3056d42d-af1f-40c1-9a4c-34a6df70e95d.png" /></div><p> </p><p> </p><p>You can control the selection by doing the following:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">Pressing <code class="literal">o</code> to go to the other end of the highlighted text (hence allowing the selection to expand from the other side)</li><li style="list-style-type: disc">Pressing <code class="literal">o</code> when in block-wise visual mode to the other end of the current line</li></ul></div><p>After you're satisfied with the selection, you can run a command you'd like to execute on a selection. For example, hit <code class="literal">d</code> to delete the selected text:</p><div class="mediaobject"><img src="/graphics/9781789341096/graphics/396c360d-69ca-4175-b0c0-c604ff4955bb.png" /></div><p>In the preceding screenshot, Vim is back to normal mode (<strong class="userinput"><code>-- VISUAL --</code></strong> is not in a status line anymore), and the selection has been deleted. You can always hit <span class="emphasis"><em>Esc</em></span> to come back to normal mode without making a change.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note71"></a>Note</h3><p>Text objects become a powerful tool when used in visual mode. See <span class="emphasis"><em>Utilizing Text Objects</em></span> in <a class="link" href="#" linkend="ch02">Chapter 2</a>, <span class="emphasis"><em>Advanced Editing and Navigation</em></span>, for more information.</p></div><p>Vim also has a <span class="strong"><strong>select mode</strong></span>, which emulates selection mode in <span>other</span><a id="id325978672" class="indexterm"></a> editors: pressing any printable character immediately erases the selected text and enters the insert mode (so the usual movement commands don't work here). Just like the ex mode shown before, select mode has a very specific and limited set of uses. In fact, I have never used it myself, except for when doing research for this book.</p><p>You can enter select mode by pressing <code class="literal">gh</code> from normal mode or <span class="emphasis"><em>Ctrl </em></span>+ <span class="emphasis"><em>g </em></span>from visual mode and exit it by pressing (you guessed it) <span class="emphasis"><em>Esc</em></span>.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec33"></a>Replace and virtual replace mode</h3></div></div></div><p>Replace mode behaves similarly to those times you accidentally press the <span class="emphasis"><em>Insert</em></span> key on your keyboard and wonder why typing erases text. When working with replace mode, the text you type is placed <span>over</span><a id="id325978704" class="indexterm"></a> existing text (as opposed to <span>moving</span><a id="id325978712" class="indexterm"></a> the existing text in insert mode). This is great when you don't want to change the character count in the original line, for example.</p><p>Enter replace mode by hitting <code class="literal"><span class="emphasis"><em>R</em></span></code>:</p><div class="mediaobject"><img src="/graphics/9781789341096/graphics/333c2607-5b29-490c-826e-08715bc0fb94.png" /></div><p>You'll see <strong class="userinput"><code>--REPLACE--</code></strong> in the status line. Now, you'll be replacing text as you type:</p><div class="mediaobject"><img src="/graphics/9781789341096/graphics/4e68d5e6-0425-4142-ad0b-bd94e6544ae1.png" /></div><p> </p><p>Hit <span class="emphasis"><em>Esc</em></span> to exit replace mode and go back to normal mode.</p><p>You can press <code class="literal">r</code> to enter replace mode for a single character press before being switched back to normal mode.</p><p>Vim also provides virtual replace mode, which behaves similarly to replace mode, but operates in terms of screen real estate as opposed to characters in a file. The main noticeable differences include <span class="emphasis"><em>Tab</em></span> replacing multiple characters (as opposed to a single character in replace mode) or <span class="emphasis"><em>Enter</em></span> not creating an addition line, but moving onto the next line. You can enter virtual replace mode using <code class="literal">gR</code>, and you can read more about it by reading <code class="literal">:help vreplace-mode</code>.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec34"></a>Terminal mode</h3></div></div></div><p>Terminal mode came to Vim in version 8.1, and it allows you to run a <span>Terminal</span><a id="id325978894" class="indexterm"></a> in a split window. You can enter terminal mode by typing the following:</p><pre class="programlisting"><span class="strong"><strong>:terminal</strong></span></pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note72"></a>Note</h3><p>You can shorten the command to <code class="literal">:term</code>.</p></div><p>This will open your system's shell (your default shell in Linux, or <code class="literal">cmd.exe</code> in Windows) in a horizontal split:</p><div class="mediaobject"><img src="/graphics/9781789341096/graphics/6c9eb3d6-7961-4148-b3b6-69edc8e72a94.png" /></div><p> </p><p>This is a wrapper around your system's Terminal, which lets you work with your shell as you normally would. This window is treated similarly to any other window (you can navigate between split using <span class="emphasis"><em>Ctrl </em></span>+ <span class="emphasis"><em>w</em></span> commands), but the window is effectively locked into insert mode. You may also want to consider using tmux or a screen under Linux or macOS to work with a Terminal alongside Vim.</p><p>You can also use <code class="literal">:term</code> to execute a single command and place its output in a buffer. For example, we can run <code class="literal">animal_farm.py</code> as follows:</p><pre class="programlisting"><span class="strong"><strong>:term python3 animal_farm.py cat dog</strong></span></pre><p>The output is immediately available to us in a horizontal split:</p><div class="mediaobject"><img src="/graphics/9781789341096/graphics/8f2a9854-0843-4990-a328-ffdfc6430b47.png" /></div></div></div>