<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch04lvl1sec34"></a>High availability</h2></div></div><hr /></div><p>High availability, in simple terms, means <span>achieving</span><a id="id325092395" class="indexterm"></a> very close to 100 percent system uptime by ensuring that there is no single point of failure. This is typically done by incorporating redundancy mechanisms, such as backup processes; taking our instances from the failed ones; and so on. So, by design, Mesos provides a fault-tolerant environment for running applications. The master daemon and the slave daemon operate in a distributed and highly available manner, ensuring that no one component can cause an outage of the entire cluster.</p><p>Let's learn about high availability. To ensure that Mesos is highly available to the application that uses its cluster manager, the Mesos master uses a single leader and multiple standby masters, which are ready to take over in the event that the leader's master fails. The master uses a ZooKeeper to coordinate leadership among the multiple nodes, and Mesos slaves and frameworks query ZooKeeper to determine the leading master. Let's take a look the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781789137385/graphics/3e92db13-dda2-4242-8393-7eecb3241e60.png" /></div><p>Here, the Mesos that's running is in high availability mode. We can see the frameworks. In our case, it's our Marathon. Then, we have three ZooKeepers, which have elected a leading master. The other two are in standby, and all of the others are slaves that communicate with ZooKeeper to understand who their master is. This is how Mesos runs in high availability mode if your leading master is down. Mesos master failure recovery uses a standby master. So, as soon as our leading master is down, ZooKeeper once again re-elects a new leader. In the preceding diagram, you can see that it has elected another master as a leading master, then the framework connects to the leading master, and the slave communicates with the ZooKeeper to understand who the leading master is now. This is how Mesos provides high availability to the application.</p><p>Let's quickly and practically observe exactly how this happens as soon as one of your masters goes down. We have the Mesos console; our leading master is <code class="literal">master3</code>; our other <code class="literal">masters</code>, <code class="literal">master1</code> and <code class="literal">master2</code>, are in standby mode. What we are going to do is stop <code class="literal">master3</code> and see what happens. You can do this using the following command:</p><pre class="programlisting">sudo service mesos-master stop</pre><p>Check the status. We can see that our Mesos <span>master</span><a id="id325245083" class="indexterm"></a> has stopped on the <code class="literal">master3</code> server. Let's quickly go to the console. The previous master was <code class="literal">mesos-master3</code>, but now the master is <code class="literal">mesos-master2</code>. Now, we've seen how high availability works for your Mesos cluster. Next, let's go ahead and understand fault tolerance and how it handles failures.</p></div>