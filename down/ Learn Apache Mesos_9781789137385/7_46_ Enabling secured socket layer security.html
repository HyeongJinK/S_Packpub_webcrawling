<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch07lvl1sec47"></a>Enabling secured socket layer security</h2></div></div><hr /></div><p>So far, we have seen how to <span>secure</span><a id="id325092087" class="indexterm"></a> the masters, agents, and our Mesos framework; we will now learn about securing Marathon. This will give you insight into enabling SSL, a protocol that is widely used in the security domain on our Mesos Marathon, and securing it by providing basic authentication mechanisms.</p><p>We will see how to make communication secure and limit the possibility of unauthorized interception of communication by enabling SSL.</p><p>Marathon enables you to secure its API endpoints via SSL and limit access to them with HTTP basic access authentication. It is advisable to use SSL if we are just enabling basic authentication to eliminate the possibility of data being accessed by third parties.</p><p>These are some simple steps to follow to enable SSL:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Generate the keystore using keytool</li><li>Use a self-signed certificate or if you can use an organization-wide trusted SSL certificate</li><li>Save the Marathon keystore configuration, this will include your password, the keystore path, and your credentials, such as username and password</li><li>Restart Marathon services</li></ol></div><p>Check the service's response on the HTTPS port.</p><p> </p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec33"></a>Generating marathon.jks file</h3></div></div></div><p>Let's <span>look</span><a id="id325092334" class="indexterm"></a> at <span>these</span><a id="id325092343" class="indexterm"></a> steps in detail:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Go to <strong class="userinput"><code>marathon1</code></strong> tab in PuTTy and create a folder:</li></ol></div><pre class="programlisting"><span class="strong"><strong>$ cd /etc/marathon/ssl</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Use <code class="literal">keytool</code> to generate the <code class="literal">marathon.jks</code> file:</li></ol></div><pre class="programlisting"><span class="strong"><strong>$ sudo keytool - keystore marathon.jks - deststorepass 123456 -alias marathon -genkey -keyalg RSA</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>Surprise! A few questions will pop up on your screen. Answer the questions and enter the password that we created in the preceding step. Here is a sample:</li></ol></div><div class="mediaobject"><img src="/graphics/9781789137385/graphics/592132e4-face-4597-ae79-de63ce2f4fef.png" /></div><p>We <span>have</span><a id="id325092438" class="indexterm"></a> successfully <span>created</span><a id="id325092446" class="indexterm"></a> the <code class="literal">marathon.jks</code> keystore.</p><p> </p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec34"></a>Adding marathon.jks file in configuration</h3></div></div></div><p>After <span>creating</span><a id="id325092814" class="indexterm"></a> a <code class="literal">marathon.jks</code> file, we <span>will</span><a id="id325092826" class="indexterm"></a> now add this to configuration:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Go to the default directory:</li></ol></div><pre class="programlisting"><span class="strong"><strong>$ cd /etc/default/</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Edit the marathon file:</li></ol></div><pre class="programlisting"><span class="strong"><strong>$ sudo vi marathon</strong></span></pre><p>You will see the following:</p><div class="mediaobject"><img src="/graphics/9781789137385/graphics/95df593f-c7c5-4798-97f4-725995abba1d.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>At the end of the line, where you see the cursor in the screenshot, insert the following parameters:</li></ol></div><pre class="programlisting">MARATHON_SSL_KEYSTORE_PATH=/etc/marathon/ssl/marathon.jks 
MARATHON_SSL_KEYSTORE_PASSWORD=123456 
MARATHON_HTTP_CREDENTIALS=admin:password </pre><p> </p><p> </p><p>If you look carefully, in the marathon <code class="literal">keystore</code> path, you can see we have appended a path where we have stored the <code class="literal">marathon.jks</code> keystore, the password, and the credential you want. Here, <code class="literal">admin</code> is the username and <code class="literal">password</code> is the password</p><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>Save <span>and</span><a id="id325485814" class="indexterm"></a> exit using <code class="literal">:wq!</code></li><li>Restart the <span>marathon</span><a id="id325485827" class="indexterm"></a> services:</li></ol></div><pre class="programlisting"><span class="strong"><strong>$ sudo service marathon restart</strong></span></pre><div class="orderedlist"><ol class="orderedlist arabic" start="6" type="1"><li>Check the status of the services:</li></ol></div><pre class="programlisting"><span class="strong"><strong>$ sudo service marathon status</strong></span>
<span class="strong"><strong>$ sudo service marathon status -l</strong></span></pre><p>You will need to wait until all the services get started. Check for this on your screen:</p><div class="mediaobject"><img src="/graphics/9781789137385/graphics/7723e666-ba85-4885-a28e-0b7f10f8a09c.png" /></div><p> </p><div class="orderedlist"><ol class="orderedlist arabic" start="7" type="1"><li>Go to the browser and check whether we have configured properly. Key in the <code class="literal">https://marathon1:8443</code> address.</li></ol></div><p>You will see that our connection is not private as we are using self-signed certificates:</p><div class="mediaobject"><img src="/graphics/9781789137385/graphics/1f6f4f63-96f9-4c64-b679-29d6b697954f.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="8" type="1"><li>Click on <strong class="userinput"><code>ADVANCED,</code></strong> as <span>shown</span><a id="id325489696" class="indexterm"></a> in the <span>preceding</span><a id="id325489739" class="indexterm"></a> screenshot, and then click <strong class="userinput"><code>proceed to marathon1</code></strong>. You will get the following screen:</li></ol></div><div class="mediaobject"><img src="/graphics/9781789137385/graphics/4f1dac5d-9e71-439c-a0c9-4011733a9a2d.png" /></div><p>We have now logged into the Marathon console.</p><div class="orderedlist"><ol class="orderedlist arabic" start="9" type="1"><li>But are you wondering why it didn't ask for a password? This is because this console was cached in your browser; to test that, you can copy and paste the path of the console in an incognito tab, a private tab, or on another browser where this console is not cached, then clear your cache and restart the browser, and you will see the following:</li></ol></div><div class="mediaobject"><img src="/graphics/9781789137385/graphics/8caf4ed3-ecbd-4068-8e68-25b1800d9eaa.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="10" type="1"><li>Enter <strong class="userinput"><code>Username</code></strong> as <code class="literal">admin</code> and <strong class="userinput"><code>Password</code></strong> as <code class="literal">password</code>.</li></ol></div><p>Now we have seen how simple it was to configure SSL security in Marathon using basic authentication and self-signed certificates, and hence our <span>communication</span><a id="id325490082" class="indexterm"></a> is sure to be encrypted and we can avoid attacks, such as man-in-the-middle, wherein people with malicious intent can <span>intercept</span><a id="id325490091" class="indexterm"></a> our messages.</p></div></div>