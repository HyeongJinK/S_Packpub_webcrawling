<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch04lvl1sec43"></a>DesiredCapabilities</h2></div></div><hr /></div><p>Let's next understand a very important <span>class</span><a id="id325162060" class="indexterm"></a> in Selenium: <code class="literal">DesiredCapabilities</code>. Before understanding the <code class="literal">DesiredCapabilities</code> class, knowing what <span>Desired Capability</span> means is necessary.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec43"></a>What is a Desired Capability?</h3></div></div></div><p> All server implementations will rarely support every feature of WebDriver. It is advised that the client and server should use JSON objects with certain predefined properties when describing which features a user requests that has to be supported by a session. If a session cannot support a certain capability that is requested in the Desired Capabilities, a capabilities object is returned, which is read-only, and this object indicates the capabilities the session supports.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch04lvl3sec13"></a>The DesiredCapabilities class</h4></div></div></div><p><code class="literal">DesiredCapabilities</code> is a class in the <code class="literal">org.openqa.selenium.remote.DesiredCapabilities</code> package. It gives one the facility to set the properties of the browser, which are mainly BrowserName, Platform, and the version of the browser.</p><p>Generally, the <code class="literal">DesiredCapabilities</code> class is <span>used</span><a id="id325450486" class="indexterm"></a> when we need to use Selenium Grid and multiple test cases have to be executed on multiple systems with different browsers having different versions with different operating systems. Earlier, this was a major concern but now browsers autoupdate by themselves. We will see one example for Internet Explorer, where our tests may fail because of protected mode settings.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h5 class="title"><a id="ch04lvl4sec6"></a>Enabling protected mode settings in Internet Explorer</h5></div></div></div><p>Sometimes, while using Internet Explorer for the <span>first</span><a id="id325433722" class="indexterm"></a> time, a <code class="literal">Session not found</code> exception is thrown. To resolve this exception, do either of the following:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">Manually click the <strong class="userinput"><code>Enable Protected Mode Setting</code></strong> checkbox under the <strong class="userinput"><code>Security</code></strong> tab of <strong class="userinput"><code>Internet Options</code></strong>. Click the checkbox for <strong class="userinput"><code>Internet</code></strong>, <strong class="userinput"><code>Local Intranet</code></strong>, <strong class="userinput"><code>Trusted Sites</code></strong>, <strong class="userinput"><code>and Restricted Sites</code></strong>. This checkbox should be checked for all four tabs; the settings should be the same.</li><li style="list-style-type: disc">Write the following code. The code ignores Internet Explorer's protected mode settings:</li></ul></div><pre class="programlisting">      InternetExplorerOptions options = <span>new</span> InternetExplorerOptions();
      options.IntroduceInstabilityByIgnoringProtectedModeSettings = 
<span>      true</span>;
      WebDriver driver = new InternetExplorerDriver(options);
      driver.get("http://www.google.com");</pre><p>Here, Internet Explorer options are passed as an argument to the <code class="literal">InternetExplorerDriver</code> constructor. This code does the same work as is done by enabling the protected mode setting manually. We will look at Internet Explorer options in the next section. </p><p><code class="literal">DesireCapabilities</code> is now going to be deprecated and hence Selenium has introduced Chrome, Firefox, and Internet Explorer options, which we will look at next.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h5 class="title"><a id="ch04lvl4sec7"></a>Learning Chrome options</h5></div></div></div><p>The WebDriver APIs provide <span>techniques</span><a id="id325546676" class="indexterm"></a> to pass capabilities to <code class="literal">ChromeDriver</code>. The <code class="literal">ChromeOptions</code> class is one such technique that is supported by Java.</p><p>Let's look at an example of the <strong class="userinput"><code>Save password</code></strong> dialog that shows up when you log in to an application on Google Chrome, as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781789612486/graphics/6094cd2b-8eec-4bc4-9a06-120369220465.png" /></div><p>We need to prevent this dialog from appearing, so we need to use <code class="literal">ChromeOptions</code>. We create an object of <code class="literal">ChromeOptions</code>, which is then passed to the <code class="literal">ChromeDriver</code> constructor. This object contains convenient methods for setting ChromeDriver- specific capabilities.</p><p>The following code disables the <code class="literal">Save password</code> popup for Chrome:</p><pre class="programlisting"> ChromeOptions options = new ChromeOptions();
 Map&lt;String, Object&gt; prefs = new HashMap&lt;String, Object&gt;();
 prefs.put("credentials_enable_service", false);
 prefs.put("profile.password_manager_enabled", false);
 options.addArguments("disable-extensions");
 options.addArguments("--start-maximized");
 options.setExperimentalOption("prefs", prefs);
 System.out.println("Before logging");
 logMessage(log, "Opening Browser");
 System.out.println("After logging");
 driver = new ChromeDriver(options);</pre><p>Here, the log is the Logger object <code class="literal">(Log4J). setExperimentalOption</code> sets an experimental option. It is used for setting new <code class="literal">ChromeDriver</code> options that are not yet exposed through the <code class="literal">ChromeOptions</code> API. The preceding code starts a Chrome browser session in which <span>notifications</span><a id="id325635664" class="indexterm"></a> are suppressed.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h5 class="title"><a id="ch04lvl4sec8"></a>Learning the Firefox options and the Firefox profile</h5></div></div></div><p>We have similar <span>options</span><a id="id325635680" class="indexterm"></a> for the Firefox browser. T<span>he way to do that is</span> by <span>including</span><a id="id325635693" class="indexterm"></a> the following two lines:</p><p><code class="literal">FirefoxOptions options =<span>new</span>FirefoxOptions();</code></p><p><code class="literal">WebDriver driver =<span>new</span>FirefoxDriver(options);</code></p><p>The Firefox profile is used because when we start the Firefox browser through Selenium using a temp profile with no plugins or bookmarks attached to it. If we want to start Firefox with either of these attached, then we need a Firefox profile. The following short code enables a flash player in Firefox:</p><pre class="programlisting">FirefoxProfile ffprofile = <span>new</span> FirefoxProfile(); profile.setPreference(<span>'dom.ipc.plugins.enabled.libflashplayer.so'</span>, <span>'false'</span>); FirefoxOptions ffoptions = <span>new</span> FirefoxOptions(); options.setProfile(ffprofile);</pre></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h5 class="title"><a id="ch04lvl4sec9"></a>Learning the Internet Explorer options</h5></div></div></div><p>We have similar options for the Internet Explorer browser. The way <span>to do incorporate these options</span> is by including the two lines. The <span>following</span><a id="id325676469" class="indexterm"></a> code ignores the protected mode setting, which is required when we want to ignore the protected mode settings for Internet Explorer:</p><pre class="programlisting">InternetExplorerOptions options = <span>new</span> InternetExplorerOptions();
options.IntroduceInstabilityByIgnoringProtectedModeSettings = <span>true</span>;
InternetExplorerDriver driver = <span>new</span> InternetExplorerDriver(options);</pre></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h5 class="title"><a id="ch04lvl4sec10"></a>autograntpermissions capability on Android</h5></div></div></div><p>This capability helps Appium to <span>automatically</span><a id="id325676499" class="indexterm"></a> determine the permissions required by a particular app and grants these permissions to the app on install:</p><pre class="programlisting">DesiredCapabilities capabilities = new DesiredCapabilities();
capabilities.setCapability("autoGrantPermissions","true");</pre><p>For iOS, the <code class="literal">autoAcceptAlerts</code> capability accepts all iOS alerts if they pop up. This includes permission alerts for location, photos, camera, and so on. This works only on the <code class="literal">XCUITest</code> or <code class="literal">UIAutomation</code> drivers.</p></div></div></div></div>