<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch12lvl1sec87"></a>Exploring SpriteKit</h2></div></div><hr /></div><p><span class="strong"><strong>SpriteKit</strong></span> is mostly used by <span>developers</span><a id="id325333120" class="indexterm"></a> to build two-dimensional games. SpriteKit has been around for quite some time already, and it has helped developers to create many successful games over the years. SpriteKit contains a full-blown physics simulation engine, and it can render many sprites at a time. A <span class="strong"><strong>sprite</strong></span><span>represents</span> a <span>graphic</span><a id="id325333245" class="indexterm"></a> in a game. A sprite could be an image for the player, but also a coin, an enemy, or even the floor that a player walks on. When sprites are mentioned in the context of SpriteKit, it is meant to refer to one of the nodes that are visible on the screen.</p><p> </p><p>Because SpriteKit has a built-in physics engine, it can detect collisions between objects, apply forces to them, and more. This is pretty similar to what UIKit Dynamics is capable of. If you're a bit rusty on what UIKit Dynamics are and how they work, be sure to have a look at <a class="link" href="#" linkend="ch04">Chapter 4</a>, Immersing Your Users with Animation for a refresher.</p><p>To render content, SpriteKit uses scenes. These scenes can be considered levels or major building parts of a game. In the context of AR, you will find that you typically only need a single scene. A SpriteKit scene is responsible for updating the position and state of the scene. As a developer, you can hook into the rendering of frames through the <code class="literal">update(_:)</code> method of <code class="literal">SKScene</code>. This method is called every time SpriteKit is about to render a new frame for your game or ARKit scene. It is essential that this method's execution time is as short as possible, as a slow implementation of the <code class="literal">update(_:)</code> method will cause frames to drop, which is considered bad. You should always aim to maintain a steady 60 frames per second. This means that the <code class="literal">update(_:)</code> method should always perform its work in less than 1/60th of a second.</p><p>To begin <span>exploring</span><a id="id325604084" class="indexterm"></a> SpriteKit, create a new project in XCode and choose the <strong class="userinput"><code><span class="strong"><strong>Game</strong></span></code></strong> template. Pick SpriteKit as the underlying game technology and give the project a name. For instance, <span class="strong"><strong>SpriteKitDefault</strong></span>, as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781789133202/graphics/e1fc14af-1782-414a-99c7-8438c85ffedd.png" /></div><p>When Xcode generates this project for you, you should notice some new files that you haven't seen before:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><code class="literal">GameScene.sks</code></li><li style="list-style-type: disc"><code class="literal">Actions.sks</code></li></ul></div><p>These two files are to SpriteKit games what storyboards are to regular apps. You can use these to set up all nodes for your game scene or to set up reusable actions that you can attach to your nodes. We will not get into these files for now as they are pretty specific to game development. </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note40"></a>Note</h3><p><span>If you are interested</span> in learning all the ins and outs of SpriteKit, go ahead pick up <span class="strong"><strong>Swift 3 Game Development - Second Edition, by Stephen <span>Haney</span></strong></span>. This book goes in-depth about game development on iOS with SpriteKit.</p></div><p>If you build and run the <span>sample</span><a id="id325606043" class="indexterm"></a> project that Xcode provides, you can tap the screen to make new sprite nodes appear on the screen. Each node performs a little animation before it disappears. This isn't very special in itself, but it does contain a lot of valuable information. For instance, it shows you how to add something to a scene and how to animate it. Let's see exactly how this project is set up so you can apply this knowledge in case you wish to build an AR experience with SpriteKit at some point.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch12lvl2sec71"></a>Creating a SpriteKit scene</h3></div></div></div><p>SpriteKit games use a special type of view to render its contents. This <span>special</span><a id="id325606058" class="indexterm"></a> view is always an instance or subclass of <code class="literal">SKView</code>. If you want to use SpriteKit with ARKit, you should use <code class="literal">ARSKView</code> instead because that view implements some special AR-related behavior, such as rendering the camera feed.</p><p>The view itself usually doesn't do much work regarding managing the games or its child views. Instead, the <code class="literal">SKScene</code> that contains the view is responsible for doing this work. This is similar to how you usually work with view controllers in other apps.</p><p>When you have created a scene, you can tell an <code class="literal">SKView</code> to present the scene. From this moment on, your game is running. In the sample code for the game project you created earlier, the following lines take care of loading and presenting the scene:</p><pre class="programlisting">if let scene = SKScene(fileNamed: "GameScene") {
    scene.scaleMode = .aspectFill
    view.presentScene(scene)
}</pre><p>When you create your scenes, you can choose whether you want to use <code class="literal">.sks</code> files or create scenes programmatically.</p><p>When you open the <code class="literal">GameScene.swift</code> file that Xcode created for you, most of the code should be pretty self-explanatory. When the scene is added to a view, a couple of <code class="literal">SKNode</code> instances are created and configured. The most interesting lines of code in this file are the following:</p><pre class="programlisting">spinnyNode.run(SKAction.repeatForever(SKAction.rotate(byAngle: CGFloat(Double.pi), duration: 1)))
spinnyNode.run(SKAction.sequence([SKAction.wait(forDuration: 0.5), SKAction.fadeOut(withDuration: 0.5), SKAction.removeFromParent()]))</pre><p>These lines set up an animation sequence for the spinning squares that get added when you tap the screen. In SpriteKit, actions are the preferred way to set up animations. You can group, chain, and combine actions to achieve pretty complicated effects. This is one of the many powerful tools that SpriteKit has to offer.</p><p>If you examine the code a <span>little</span><a id="id325607102" class="indexterm"></a> bit more, you'll find that copies of <code class="literal">spinnyNode</code> are created every time the user taps on the screen, moves their finger, or lifts their finger. Each interaction produces a slightly different copy of <code class="literal">spinnyNode</code> so you can determine why <code class="literal">spinnyNode</code> was added to the scene by looking at its appearance.</p><p>Study this code, play around with it, and try to make sure that you grasp what it does. You don't have to become a SpriteKit expert by any means. Let's have a look at how SceneKit works to prepare to implement your Augmented Reality gallery.</p></div></div>