<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch12lvl1sec88"></a>Exploring SceneKit</h2></div></div><hr /></div><p>When you're looking for a game framework that has excellent support for 3D games, SceneKit is a great candidate. SceneKit is Apple's framework for creating 3D games, and it is <span>structured</span><a id="id325333110" class="indexterm"></a> very similarly to how SpriteKit is set up.</p><p>Of course, SceneKit is entirely different from SpriteKit because it's used for 3D games rather than 2D games. Because of this, SceneKit also has very different ways of creating views and positioning them on screen. For instance, when you want to create a simple object and place it on the screen, you will see terms such as geometry and materials. These terms should be familiar to game programmers, but if you're an AR enthusiast, you will probably have to get used to the terminology.</p><p>This section will walk you through setting up a straightforward SceneKit scene that closely resembles a part of the AR gallery you will implement later. This should provide you with enough information to begin experimenting with SceneKit.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note41"></a>Note</h3><p><span>If you're left longing</span> for more SceneKit knowledge by the end of this chapter, make sure to have a look at <span class="strong"><strong>3D iOS Games by Tutorials written by Chris <span>Language</span></strong></span>. That book goes in-depth regarding 3D game development using SceneKit.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch12lvl2sec72"></a>Creating a basic SceneKit scene</h3></div></div></div><p>To practice your SceneKit knowledge, <span>create</span><a id="id325333156" class="indexterm"></a> a new project and instead of choosing the <span class="strong"><strong>Game</strong></span> template, pick the <span class="strong"><strong>Single View Application</strong></span> template. Of course, you are free to explore the default project Xcode creates for you when you choose the <span class="strong"><strong>Game</strong></span> template with SceneKit, but it's not terribly useful for the AR gallery.</p><p>After creating your project, open the main storyboard and look for a <span class="strong"><strong>SceneKit view</strong></span>. Drag this view into the view controller. You should notice that the view you just added to the view controller has replaced the default view entirely. Because of this, the <code class="literal">view</code> property on <code class="literal">ViewController</code> will not be a regular <code class="literal">UIView</code>, it will be an instance of <code class="literal">SCNView</code> instead. This is the view that will be used to render the SceneKit scene in.</p><p>Add the following code to <code class="literal">viewDidLoad()</code> in <code class="literal">ViewController.swift</code> to cast the <code class="literal">view</code> property from a <code class="literal">UIView</code> to an <code class="literal">SCNView</code>:</p><pre class="programlisting">guard let sceneView = self.view as? SCNView
      else { return }</pre><p>Similar to how SpriteKit works, SceneKit uses a scene to render its nodes in. Create an instance of <code class="literal">SCNScene</code> right after <code class="literal">guard</code> in <code class="literal">viewDidLoad()</code>, as shown:</p><pre class="programlisting">let scene = SCNScene()
sceneView.scene = scene
sceneView.allowsCameraControl = true
sceneView.showsStatistics = true
sceneView.backgroundColor = UIColor.black</pre><p>The preceding code creates a simple scene that will be used render all elements in. In addition to creating the scene, several debugging features are enabled to monitor the performance of the scene. Also, note that the <code class="literal">allowsCameraControl</code> property on the scene view is set to <code class="literal">true</code>. This will allow users to move a virtual camera around so they can explore the scene by swiping around in it.</p><p>Every SceneKit scene is viewed as if you're looking at it through a camera. You will need to add this camera to the scene yourself, and you must set it up appropriately for your purpose. The fact that SceneKit uses a camera is very convenient because the camera that you are going to set up in a second is replaced by the actual camera of a device when the scene is run with ARKit.</p><p>Add the following lines of code to <code class="literal">viewDidLoad()</code> to create and configure the camera:</p><pre class="programlisting">let cameraNode = SCNNode()
cameraNode.camera = SCNCamera()
cameraNode.position = SCNVector3(x: 0, y: 0, z: 15)
scene.rootNode.addChildNode(cameraNode)</pre><p>Setting up a basic camera isn't very complicated. All you need is an <code class="literal">SCNNode</code> to add the camera to and an <code class="literal">SCNCamera</code> that will be used to view your scene through. Note that the camera is positioned using an <code class="literal">SCNVector3</code> object. All nodes in a SceneKit scene use this object to express their positions in 3D space.</p><p>In addition to using a simulated camera, SceneKit also simulates real lighting conditions. When you run your scene with ARKit, the lighting conditions will be automatically managed by ARKit, making your objects look as if they truly are part of the environment. When you create a plain scene, however, you will need to add the lights yourself. Add the following lines of code to implement some ambient lighting:</p><pre class="programlisting">let ambientLightNode = SCNNode()
ambientLightNode.light = SCNLight()
ambientLightNode.light!.type = .ambient
ambientLightNode.light!.color = UIColor.orange
scene.rootNode.addChildNode(ambientLightNode)</pre><p>You can add different types of lights to a SceneKit scene. You can use ambient light as this sample does, but you can also add directional lights that focus on a particular direction, spotlight, or light points that light in all directions.</p><p>Now that you have lighting and a camera in place, you can add an object to the scene. You can use several pre-made shapes, also known as geometries, in your scene. Alternatively, you could import an entire 3D model in your scene. If you take a look at the default SceneKit app that Xcode generates if you <span>create</span><a id="id325578420" class="indexterm"></a> a new project with the <span class="strong"><strong>Game</strong></span> template, you can see that it imports a 3D model of an airplane.</p><p>In the AR gallery you will build later, the artwork is augmented with digital information signs that are attached to the piece of art they belong to. To practice building such a sign, you will add a rectangular shape, or plane, to your SceneKit scene and place some text on top of it.</p><p>Add the following code to create a simple white plane, a node that renders the plane, and add it to the scene:</p><pre class="programlisting">let plane = SCNPlane(width: 15, height: 10)
plane.firstMaterial?.diffuse.contents = UIColor.white
plane.firstMaterial?.isDoubleSided = true
plane.cornerRadius = 0.3

let planeNode = SCNNode(geometry: plane)
planeNode.position = SCNVector3(x: 0, y: 0, z: -15)
scene.rootNode.addChildNode(planeNode)</pre><p>If you were to build and run your app now, you would see a white square that is positioned in front of the camera. By swiping on the scene, you can make the camera move around the plane to view it from all possible sides. Note that the plane appears to be quite large even though it was only set to be <span>15 wide and 10 height</span>. You might have guessed that these numbers represent points on the screen, just like in other apps. In SceneKit, there is no concept of points. All values for size and distance must be specified in meters. This means that everything you do is done relative to other objects or their real-world sizes. Using real sizes is essential when you take your SceneKit knowledge to ARKit.</p><p>To add some text to the plane you just created, use the following code:</p><pre class="programlisting">let text = SCNText(string: "Hello, world!", extrusionDepth: 0)
text.font = UIFont.systemFont(ofSize: 2.3)
text.isWrapped = true
text.containerFrame = CGRect(x: -6.5, y: -4, width: 13, height: 8)
text.firstMaterial?.diffuse.contents = UIColor.red

let textNode = SCNNode(geometry: text)
planeNode.addChildNode(textNode)</pre><p>The preceding code creates a text geometry. Since all values in <span>SceneKit</span><a id="id325602493" class="indexterm"></a> are in meters, the text size will be a lot smaller than you would probably expect. To make sure the text is positioned properly in the plane, text wrapping is enabled, and a <code class="literal">containerFrame</code> is used to specify the bounds for the text. Since the origin for the text field will be in the center of the plane it is displayed on, the x and y positions are offset negatively from the center to make sure the text appears in the correct place. You can try to play with this frame to see what happens. After configuring the text, it is added to a node, and the node is added to the plane node.</p><p><span>If you run your app now</span>, you can see the <span class="emphasis"><em>Hello, World!</em></span> text rendered on the white plane you created before. This sample is an excellent taste of what you're going to create next. Let's dive straight into building your AR gallery!</p></div></div>