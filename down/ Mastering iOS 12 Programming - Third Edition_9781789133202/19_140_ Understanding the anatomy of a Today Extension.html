<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch19lvl1sec130"></a>Understanding the anatomy of a Today Extension</h2></div></div><hr /></div><p>The terms <strong class="userinput"><code><span>Today</span><a id="id325333111" class="indexterm"></a> Extension</code></strong> and widget can be used interchangeably; they both refer to a component that is present in iOS's <strong class="userinput"><code>Today View</code></strong>. In this chapter, the term <span class="emphasis"><em>widget</em></span> is used throughout.</p><p> </p><p>If you swipe down from the top of the screen to open <strong class="userinput"><code>Spotlight</code></strong> and swipe right after that, you're presented with the <strong class="userinput"><code>Today View</code></strong>. On the simulator, this view tends to look rather empty, but on your device, there's probably a lot more going on. The following screenshot shows the <strong class="userinput"><code>Today View</code></strong> on the simulator with a couple of widgets added to it:</p><div class="mediaobject"><img src="/graphics/9781789133202/graphics/8b3c5ff9-651c-4dbb-a413-8ca85e430e3b.png" /></div><p> </p><p> </p><p> </p><p> </p><p> </p><p>Users can scroll to the bottom of this view and manage their widgets from there. They can add new widgets and remove existing ones. All these widgets have one thing in common: they provide relevant information for the current moment or day. For the <strong class="userinput"><code>Calendar</code></strong>, this means showing events that you have planned for <span>today</span><a id="id325606048" class="indexterm"></a> or tomorrow. The <strong class="userinput"><code>Favorites</code></strong> widget in the screenshot usually contains contacts that the user interacts with often. Users can even add a widget that suggests apps that the user is likely to use based on the current time and the user's location.</p><p>Any widget that you implement for your app should aim to provide your users with relevant, easy-to-scan information. Doing this makes your widget more useful and more likely to be added to a user's Today View.</p><p>Before you implement your own Today Extension, let's take a closer look at how a Today Extension works and where a user can find them in iOS.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch19lvl2sec104"></a>Finding Today Extensions in iOS</h3></div></div></div><p>In iOS, there are several places where people can discover and use widgets. For most scenarios, the way the widget looks will be similar to how it looks in the <span>Today</span><a id="id325606070" class="indexterm"></a> View, apart from some very minor modifications. You are already aware that users can find widgets in the Today View, which can be found by swiping right on the lock screen or Notification Center. In addition to these two places, the Today View is also shown on the <span>leftmost</span><a id="id325606078" class="indexterm"></a> screen on the user's Springboard.</p><p>One more place where users can find and use Today Extensions is directly on the home screen. When a user 3D-Touches on an app icon for an app that has implemented a Today Extension, the corresponding widget will pop up, as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781789133202/graphics/36151595-f802-4158-86ef-120676484a30.png" /></div><p>If a user hasn't added the widget for the app that they pressed to the Today View yet, the widget will feature an <strong class="userinput"><code>Add Widget</code></strong> button that allows users to quickly add the extension to the Today View so they can access it there in the future.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch19lvl2sec105"></a>Understanding Today Extensions</h3></div></div></div><p>A <strong class="userinput"><code>Today Extension</code></strong> isn't much more than a <span>view</span><a id="id325607107" class="indexterm"></a> controller that is embedded inside the notification center's Today View. This means that when your <strong class="userinput"><code>Today Extension</code></strong> is initialized, there is no <code class="literal">AppDelegate</code> involved at all. The extension does not have any application life cycle methods, such as <code class="literal">application(_:didFinishLaunchingWithOptions:)</code>.</p><p>The Today View displays your widget by showing the view controller that you set up for it. This is very similar to how a <strong class="userinput"><code>Notification Content Extension</code></strong> works since that extension also has a single view controller to define its functionality.</p><p>The Today View is in control of positioning and rendering all of its widgets. This means that you can't set the frame for the widget's view yourself. When you implemented your <strong class="userinput"><code>Notification Content Extension</code></strong> in the previous chapter, you could force your notification to be shown at a certain height through AutoLayout. This isn't possible when you implement a <strong class="userinput"><code>Today Extension</code></strong>.</p><p>Before iOS 10, a widget would resize itself based on its contents or the size that the widget would set as its <code class="literal">preferredContentSize</code>. Since iOS 10, this behavior has changed, and widgets have a user-defined compact mode and an expanded mode. The compact mode should typically be about 110 points in height, but in reality, this height varies based on the user's text-size preferences.</p><p>Because there are no real guarantees regarding the height of your widget can use, it's essential that you only show the most critical information in your widget. Because widgets tend to resize based on the user's text size preferences, it's a good idea to adopt dynamic type in your widget. This makes your widget more accessible by scaling the text inside your widget based on the user's preferences. You'll learn more about this when you implement the widget.</p><p>If your widget supports it, the user can switch to the expanded state for your widget. In the expanded state, you have a bit more freedom to set the size of the widget yourself. You will also explore this more when you implement your own widget.</p><p>One more key principle of the <strong class="userinput"><code>Today Extension</code></strong> is that the widget never communicates with its host app directly. If you have a widget that the user can tap on to open the app, the widget doesn't directly instruct the app to do this. Instead, URLs are used. You can use a custom URL scheme or a Universal Link to achieve this. In several snippets of example code, Apple uses custom URL schemes to redirect users from a widget to an app. <strong class="userinput"><code>The Daily Quote</code></strong> app you will extend in this chapter will work similarly.</p><p>Now that you're up to speed with <strong class="userinput"><code>Today Extensions</code></strong>, it's time to see how you can add your own <strong class="userinput"><code>Today Extension</code></strong> to <strong class="userinput"><code>The Daily Quote</code></strong>.</p></div></div>