<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch03lvl1sec24"></a>Installing Postman and body-parser</h2></div></div><hr /></div><p>In this section, we're going to <span>work</span><a id="id325268059" class="indexterm"></a> on our environment to make our development process a little bit easier. The first thing that we're going to do is install a new package called <code class="literal">nodemon</code>. In our <code class="literal">blockchain</code> directory in our terminal, we will write the <code class="literal">npm i nodemon --save</code>command:</p><div class="mediaobject"><img src="/graphics/9781789618822/graphics/13036bdc-862c-4932-9b53-31a4d8b04113.png" /></div><p>Whenever we make a change in one of our files and save it, this nodemon library will automatically restart our server for us so that we don't have to go back and forth from the terminal to our code to restart the server every time we make a change.</p><p>To use nodemon, we are going to open up our <code class="literal">package.json</code> file. Where it says <code class="literal">"scripts"</code>, we're going to add a new script:</p><pre class="programlisting">{
 "name": "javaScript-blockchain",
 "version": "1.0.0",
 "description": "",
 "main": "index.js",
 "scripts": {
     "test": "echo \"Error: no test specified\" &amp;&amp; exit 1",
     "start": "nodemon --watch dev -e js dev/api.js"
 }
 "author": "",
 "license": "ISC",
 "dependencies": {
     "express": "^4.16.3",
     "nodemon": "^1.17.3",
     "sha256": "^0.2.0"
 }
}</pre><p>We have added <code class="literal">"start": "nodemon --watch dev -e js dev/api.js"</code>. This means that when we run the <code class="literal">start</code> command, we want <code class="literal">nodemon</code> to watch our <code class="literal">dev</code> folder and keep an eye on all of our JavaScript files. Whenever one of these JS files is changed and saved, we want <span>nodemon</span><a id="id325704611" class="indexterm"></a> to restart our <code class="literal">dev/api.js</code> file for us. Save the <code class="literal">package.json</code> file. Now, whenever we make a change inside of our <code class="literal">dev</code> folder and save it, our server will restart itself. Let's test this out.</p><p>Let's go to our terminal. Our server should now be using nodemon: </p><div class="mediaobject"><img src="/graphics/9781789618822/graphics/87e65980-a132-4485-95a3-cc60c6702bf5.png" /></div><p>We have started the server by using the <code class="literal">npm start</code> command. You can see that this is listening on port <code class="literal">3000</code>.  Whenever we make a change in one of our JS files and save it, we will see that our server restarts itself:</p><div class="mediaobject"><img src="/graphics/9781789618822/graphics/d136fcee-e9f4-495e-bcc9-e4558fc4d2cd.png" /></div><p>As you can see, the <span>server</span><a id="id325945361" class="indexterm"></a> is listening to port <code class="literal">3000</code> again. This is just a tool that we use to make development slightly easier for us. Now, one other tool that we <span>want</span><a id="id325945373" class="indexterm"></a> to use is called Postman. </p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec16"></a>Installing Postman </h3></div></div></div><p>The Postman tool <span>allows</span><a id="id325945389" class="indexterm"></a> us to make calls to any of our post endpoints, as well as send data into these endpoints with our requests. Let's understand how to install it: </p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Head over to <a class="ulink" href="https://www.getpostman.com" target="_blank">https://www.getpostman.com</a> and download the app. Once you have downloaded the app, we can run through a little test trial of how we can use this Postman app to hit our <code class="literal">/transaction</code> endpoint.</li></ol></div><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Open the Postman app after downloading it. You will see something similar to the following screenshot:</li></ol></div><div class="mediaobject"><img src="/graphics/9781789618822/graphics/24e2c775-13f7-404a-b09a-ea5fa53a62f9.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>Now, in the Postman app we're going to make a post request to <code class="literal">http://localhost:3000/transaction</code>:</li></ol></div><div class="mediaobject"><img src="/graphics/9781789618822/graphics/149b3b92-e4d7-4c78-86dc-d576186bad6c.png" /></div><p> </p><p> </p><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>To test that the <code class="literal">/transaction</code> endpoint is working, let's send something back in the output. In our <code class="literal">/transaction</code> endpoint, we have added the following line:</li></ol></div><pre class="programlisting">app.post('/transaction', function(req, res) {
    res.send('It works!!!');
});</pre><div class="orderedlist"><ol class="orderedlist arabic" start="5" type="1"><li>Let's save the file, and now when we hit this endpoint, we should get the text <code class="literal">It works!!!</code> returned to us. Click on the <strong class="userinput"><code>Send</code></strong> button, and <span>you</span><a id="id325946043" class="indexterm"></a> will get the output, as shown in the following screenshot:</li></ol></div><div class="mediaobject"><img src="/graphics/9781789618822/graphics/afc672cc-b4ad-4b39-9279-c224f5326eaf.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="6" type="1"><li>Now, most of the time we hit a <code class="literal">post</code> endpoint in our API, we are going to want to send data to it. For example, when we hit the <code class="literal">/transaction</code> endpoint, we want to create a new transaction. Consequently, we have to send the transaction data, such as the amount for the transaction, the sender, and the recipient to the <code class="literal">/transaction</code> endpoint. We can do this by using Postman, and it's actually pretty straightforward. What we're going to do here is send some information in the body of our post request. You can do that by clicking on the <strong class="userinput"><code>Body</code></strong> tab:</li></ol></div><div class="mediaobject"><img src="/graphics/9781789618822/graphics/1e361345-c9b7-4f71-8309-90f8b744ca84.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="7" type="1"><li>Next, make sure that the <strong class="userinput"><code>raw</code></strong> <span>option</span><a id="id325946583" class="indexterm"></a> is checked and <strong class="userinput"><code>JSON (application/json)</code></strong> is selected from the dropdown list. You can also see that we have made a JSON object and put some data in it. We have added the <code class="literal">amount</code> as <code class="literal">20</code> bitcoins, the address of <code class="literal">sender</code>, and the address of <code class="literal">recipient</code>.</li></ol></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip7"></a>Note</h3><p>Remember that everything has to be in JSON format, so we need all of our quotations to be in double quotes or the terms won't work. </p></div><div class="orderedlist"><ol class="orderedlist arabic" start="8" type="1"><li>To test whether or not we are receiving all of this information inside of our endpoint, we are going to print out the entire <code class="literal">req.body</code>. The <code class="literal">req.body</code> is simply the information that we created in the JSON object:</li></ol></div><pre class="programlisting">app.post('/transaction', function(req, res) {
    console.log(req.body);
    res.send(`The amount of the transaction is ${req.body.amount}
     bitcoin.`);
});</pre><p> </p><p>As you can see, we have also sent some different information back in the response. We have added a sentence in back ticks, and we also did some string interpolation with <code class="literal">${req.body.amount}</code>, which will return just the <code class="literal">amount</code>. </p><div class="orderedlist"><ol class="orderedlist arabic" start="9" type="1"><li>Now, for <code class="literal">${req.body.amount}</code> to work, we need to install another library in order to access this information. Let's go back in our terminal; we're going to quit the current process where we were listening to port <code class="literal">3000</code> and we're going to install a package called <code class="literal">body-parser</code>:</li></ol></div><div class="mediaobject"><img src="/graphics/9781789618822/graphics/d77604ea-9f7a-4921-9b1d-c12bb7311009.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="10" type="1"><li>Now let's start our server up again with<code class="literal">npm start</code>.</li><li>When it comes to using <code class="literal">body-parser</code>, we simply want to import this at the top of our file after the line where we imported <code class="literal">app</code>:</li></ol></div><pre class="programlisting">const express = require('express');
const app = express();
const bodyParser = require('body-parser');

app.use(bodyParser.json());
app.use(bodyParser.urlencoded({ extended: false }));</pre><p>To use this <code class="literal">body-parser</code> library, we have <span>added</span><a id="id326014739" class="indexterm"></a> the next two lines. All these two lines is doing are stating that if a request comes in with JSON data or with form data, we simply want to parse that data so that we can access it in any of the endpoints. So, with any endpoint we hit, our data is first going to go through the <code class="literal">body-parser</code> so that we can access the data and is then used in whichever endpoint will be receiving it.</p><div class="orderedlist"><ol class="orderedlist arabic" start="12" type="1"><li>Now that we're using <code class="literal">body-parser</code>, we should be able to access the amount. Let's save the <code class="literal">api.js</code> file and try to send the request, as follows:</li></ol></div><div class="mediaobject"><img src="/graphics/9781789618822/graphics/76b501c4-b8bf-49fe-b923-c49755625ec2.png" /></div><p>It worked! We got the string returned, which <span>states</span><a id="id326014779" class="indexterm"></a> that <strong class="userinput"><code>The amount of the transaction is 20 bitcoin.</code></strong></p><p>In our terminal, since we logged out of the entire <code class="literal">req.body</code>, we can see that the entire information regarding the amount, sender, and recipient is displayed:</p><div class="mediaobject"><img src="/graphics/9781789618822/graphics/d573808a-3758-45cb-bce2-fe083bda2522.png" /></div><p>Great! Now, one more important thing to note is that throughout the rest of this chapter, you should always have your server running, which means you should <span>always</span><a id="id326086969" class="indexterm"></a> run the <code class="literal">npm start</code> command so that we can use our API, hit the different endpoints, and test it to see if it works.</p></div></div>