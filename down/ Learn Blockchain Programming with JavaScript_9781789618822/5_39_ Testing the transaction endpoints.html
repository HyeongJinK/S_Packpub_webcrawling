<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch05lvl1sec42"></a>Testing the transaction endpoints</h2></div></div><hr /></div><p>Let's test the <code class="literal">/transaction/broadcast</code> and <code class="literal">/transaction</code> endpoints to <span>make</span><a id="id325690798" class="indexterm"></a> sure that they are <span>both</span><a id="id325690807" class="indexterm"></a> working together correctly.</p><p>For this test, the first thing that we need to do is connect all the nodes together to make a network. You might remember how to do this, as we learned about it in <a class="link" href="#" linkend="ch04">Chapter 4</a>, <span class="emphasis"><em>Creating a Decentralized Blockchain Network</em></span>. We'll run through the steps quickly anyway, to refresh your memory.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec34"></a>Recapping how to create the network </h3></div></div></div><p>Take a look at the following steps to <span>understand</span><a id="id325693395" class="indexterm"></a> how to connect all the nodes: </p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Go to Postman and hit the <code class="literal">/register-and-broadcast-node</code> route. This can be done on any of your nodes. In our example, let's use <code class="literal">localhost:3001</code>.</li><li>Now, inside the body, we want to add a new node to our network by passing its URL. Let's start with our second node. Take a look at the following screenshot:</li></ol></div><div class="mediaobject"><img src="/graphics/9781789618822/graphics/c60be7ea-5aaf-4a6f-990c-87a783c3ff04.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>Then, click on the <strong class="userinput"><code>Send</code></strong> button to send the request. After sending the request, you'll receive a response that says <strong class="userinput"><code>New node registered with the network successfully</code></strong>. You can send all the remaining nodes in the same way.</li><li>To verify if all the nodes are connected properly to form a network, head over to the browser, type <code class="literal">localhost:3001/blockchain</code> in the address bar, and press <span class="emphasis"><em>Enter</em></span>. You will see all the nodes in the<code class="literal">networkNodes</code>array. </li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec35"></a>Testing the transaction endpoints</h3></div></div></div><p>Now that the blockchain network is set up, let's the test <span>the</span><a id="id325698338" class="indexterm"></a> endpoints that we created in the previous sections. </p><p>Let's create a transaction and send it to the <code class="literal">/transaction/broadcast</code> endpoint. Go back to Postman and hit the <code class="literal">/transaction/broadcast</code> endpoint at the node, which is hosted on port <code class="literal">3001</code>. Here, send some data as a transaction, as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781789618822/graphics/f2e65a26-d61c-41bb-8723-cc21de5837d5.png" /></div><p>The transaction data that you're sending can be any random data. All we need is the amount, the sender, and the recipient. Once the transaction data is added, let's send this request by clicking on the <strong class="userinput"><code>Send</code></strong> button. If the transaction is sent successfully, a response will be received that says, <strong class="userinput"><code>Transaction created and broadcast successfully</code></strong>.</p><p>Now, go to the browser, and you should be able to see the transaction that we created on every single node of the network. Let's check whether this worked. In the address bar of the browser, type <code class="literal">localhost:3001/blockchain</code> and then press <span class="emphasis"><em>Enter</em></span>. You should see the transaction data inside the <code class="literal">pendingTransactions</code> array, as shown in the following screenshot: </p><div class="mediaobject"><img src="/graphics/9781789618822/graphics/6be896ca-5fe1-45d0-8fca-07523a548051.png" /></div><p>Here, the transaction that is <span>inside</span><a id="id325803760" class="indexterm"></a> the <code class="literal">pendingTransactions</code> array now also has a <code class="literal">transactionId</code> value, which starts with a random hash.</p><p> </p><p>Next, open another tab and type <code class="literal">localhost:3002/blockchain</code> in the address bar, then press <span class="emphasis"><em>Enter</em></span>. You can see that the same transaction data can be seen in the array:</p><div class="mediaobject"><img src="/graphics/9781789618822/graphics/f418caee-e598-4fa7-bb4a-0a378c5dc0c1.png" /></div><p>If you go over to the other nodes in the network, you can carry out a similar check for all the remaining nodes. You can observe the same transaction data in the <code class="literal">pendingTransactions</code> array of each node. Every node inside the blockchain network is now aware that a new transaction was created.</p><p>You can try testing the endpoints with other transaction data as well. Try to change the amount to <code class="literal">500</code>, and the address of the sender and the recipient to a random hash string, and try sending this request to the node that's hosted on <code class="literal">localhost:3004</code>. This shouldn't <span>make</span><a id="id325803814" class="indexterm"></a> a difference, because the broadcast endpoint sends the transaction data to all the nodes inside of the network. Therefore, this request should work just like the last one. Checking the response on the browser, you should be able to see two transactions with different transaction IDs. </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip13"></a>Note</h3><p>Try experimenting with different transaction data to gain a clear understanding of how the <code class="literal">/transaction</code> and <code class="literal">/transaction/broadcast</code> endpoints work. </p></div><p>From the test, we can conclude that the <code class="literal">/transaction/broadcast</code> endpoint and the <code class="literal">/transaction</code> endpoint are both working properly as we expected them to. </p><p>In the next section, we'll continue synchronizing the network by refactoring the <code class="literal">/mine</code> endpoint, so that it will broadcast the new blocks that are created to the entire network.</p></div></div>