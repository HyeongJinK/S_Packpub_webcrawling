<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch06lvl1sec35"></a>Changing code-hosting platform</h2></div></div><hr /></div><p>Many organizations, and even just established personal projects, already have a <span>preferred</span><a id="id325524430" class="indexterm"></a> code-hosting platform. There are a lot on the market and they all have benefits and drawbacks that can lead to them being chosen. However, times change and sometimes business or project needs can force a move to a different platform. We'll now look at some common reasons that your organization might have<span> for changing their code-hosting platform:</span></p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><span class="strong"><strong>Cost</strong></span>: <a class="ulink" href="http://GitLab.com" target="_blank">GitLab.com</a> is free to use; paid accounts only unlock extra features. You can also host a GitLab instance on your existing hardware.</li><li style="list-style-type: disc"><span class="strong"><strong>Data sovereignty</strong></span>: You can host your own GitLab instance on your own hardware and be in control of your data.</li><li style="list-style-type: disc"><span class="strong"><strong>Trust and transparency</strong></span>: GitLab is free and open source software (FOSS); you can examine the code that runs on your instance or GitLab.com, and be certain that it's free of nasties.</li><li style="list-style-type: disc"><span class="strong"><strong>Features</strong></span>: Many code-hosting platforms are simply places to host your code. GitLab provides a whole continuous integration/continuous deployment suite as well as tools to help you monitor your production environment or host the outputs from your build process for public download.</li><li style="list-style-type: disc"><span class="strong"><strong>End-of-life</strong></span>: Nothing lasts forever and your existing code-hosting platform may be shutting down, so moving to another platform is recommended before you lose everything.</li><li style="list-style-type: disc"><span class="strong"><strong>No one examined the competition</strong></span>: Maybe someone originally picked one they knew without considering the benefits and disadvantages of the competition, and now it's time to check out the playing field.</li></ul></div><p>Let's take a look at a few of the common platforms for code hosting and demonstrate how to move from them to GitLab.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec44"></a>GitHub</h3></div></div></div><p>One of the biggest names in code hosting, GitHub is probably the <span>most</span><a id="id325524468" class="indexterm"></a> well-known place to store your code. If you want to move from <span>GitLab</span><a id="id325524476" class="indexterm"></a> to GitHub, thankfully there's an easy way to do it:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>From the main screen, click the <strong class="userinput"><code>+</code></strong> icon up at the top and then select <strong class="userinput"><code>New Project</code></strong>. On this page, select the <strong class="userinput"><code>Import project</code></strong> tab:  </li></ol></div><div class="mediaobject"><img src="/graphics/9781789534344/graphics/b661ece5-7c55-4a1d-bfec-42109ddb4710.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Click the <strong class="userinput"><code>GitHub</code></strong> button and you'll be taken to the <strong class="userinput"><code>Import repositories from GitHub</code></strong> page. The content on this page will differ depending on whether you're using your own GitLab instance (and haven't enabled the GitHub integration) or if you're using an instance integrated with GitHub, such as GitLab. Enabling GitHub integration is outside the scope of this chapter but GitLab online administration documentation can walk you through it if you desire. If you don't have GitLab integration, you'll still have the option of importing via a personal access token, you'll simply be missing the first option.</li></ol></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch06lvl3sec20"></a>GitLab.com or GitHub integration enabled</h4></div></div></div><p>If you have GitHub integration enabled or are using GitLab.com and click the first <strong class="userinput"><code>List your <span>GitHub</span><a id="id325640005" class="indexterm"></a> repositories</code></strong> button visible on the page, you'll be taken to a page that asks you to authorize <span>GitLab</span><a id="id325640014" class="indexterm"></a> to access your account. It'll also show you all the data requested by GitLab, as you can see here:</p><div class="mediaobject"><img src="/graphics/9781789534344/graphics/e7ea2bbe-541d-424a-8d48-7e5f05d0d93e.png" /></div><p>Click the authorize button and the OAuth flow will redirect you back to GitLab.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch06lvl3sec21"></a>Personal access token</h4></div></div></div><p>If you don't have GitHub integration on your <span>GitLab</span><a id="id325640043" class="indexterm"></a> instance, are not using GitLab.com, or don't want to go through the OAuth flow for accessing your GitHub account from GitLab, you can also choose to use a personal access token from GitHub. This is so it can list repositories and you can choose which ones to import from. <span>To get your personal access token, go through the following steps:</span></p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><span>Go to</span><a class="ulink" href="https://github.com/settings/tokens" target="_blank">https://github.com/settings/tokens</a><span>(you might need to log in to do this), and you'll be faced with the following page:</span></li></ol></div><div class="mediaobject"><img src="/graphics/9781789534344/graphics/d47cc419-f66f-4068-8fe9-ae416ff48d67.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Click <strong class="userinput"><code>Generate new token</code></strong> to be taken to the <strong class="userinput"><code>New personal access token</code></strong> page. It should look as <span>follows</span>:</li></ol></div><div class="mediaobject"><img src="/graphics/9781789534344/graphics/be2ccff3-f63d-4764-8c65-b14724a4aec6.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>Give it a relevant description such as <strong class="userinput"><code><span>GitLab</span><a id="id326293073" class="indexterm"></a> Importer</code></strong> and then tick the checkbox next to <strong class="userinput"><code>repo</code></strong>. Then, click <strong class="userinput"><code>Generate token</code></strong>. You'll be shown your new personal access token. Please copy this down, as once you move away from the following screen, you won't be able to view it again. I've included a screenshot of this view (with my personal token obscured) as follows:</li></ol></div><div class="mediaobject"><img src="/graphics/9781789534344/graphics/a2311678-827a-4652-886e-46a99ead4dca.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>Now, go back to the GitLab page, paste in your personal access token, and click <strong class="userinput"><code>List your GitHub repositories</code></strong>.</li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch06lvl3sec22"></a>Importing repositories</h4></div></div></div><p>Now, you'll be faced with a list of not just all your <span>public</span><a id="id326293189" class="indexterm"></a> and private repositories, but also the repositories in all the groups to which you belong. These are shown here:</p><div class="mediaobject"><img src="/graphics/9781789534344/graphics/aa6fa474-31ac-400e-b027-96bcae60216d.png" /></div><p>You can choose to <strong class="userinput"><code>Import all repositories</code></strong> using the button at the top, or you can import individual repositories using the button to the right of each row. You can also change which user/group the repository will belong to and rename it if you want. Please note that when you click <strong class="userinput"><code>Import</code></strong>, the process begins and runs automatically. Once it's done, the <span>repositories</span><a id="id326293218" class="indexterm"></a> you imported should be available on the GitLab home screen.</p><p>What's important to note is that GitLab doesn't just import the Git repository; it also imports the following:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">Repository description</li><li style="list-style-type: disc">Issues, including comments</li><li style="list-style-type: disc">Pull requests (now merge requests), including comments</li><li style="list-style-type: disc">Wiki pages</li><li style="list-style-type: disc">Milestones</li><li style="list-style-type: disc">Labels</li></ul></div></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec45"></a>BitBucket</h3></div></div></div><p>BitBucket is another <span>popular</span><a id="id325218438" class="indexterm"></a> code-hosting platform, run by Atlassian, who <span>you</span><a id="id325218446" class="indexterm"></a> may know of for their famous Jira issue tracking and project management software. Thankfully, GitLab can import Git projects directly from BitBucket. Please note that if you run your own GitLab <span>instance (rather than using GitLab.com), you'll need to enable OAuth integration, which is beyond the scope of this chapter, but the GitLab online help can assist you with this. Once you've enabled OAuth integration – or if you're using GitLab.com – you can follow these steps:</span></p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>From the main screen, click the <strong class="userinput"><code>+</code></strong> icon up the top and then select <strong class="userinput"><code>New Project.</code></strong></li><li>On this page, select the <strong class="userinput"><code>Import project</code></strong> tab.</li><li>On this tab, select <strong class="userinput"><code>BitBucket Cloud</code></strong> and you'll be taken to an OAuth2 confirmation page (visible in the following screenshot) asking whether you'd like to allow GitLab to access your BitBucket account:
</li></ol></div><div class="mediaobject"><img src="/graphics/9781789534344/graphics/40003187-c02c-44e7-a862-b629bbedaaaa.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>Click <strong class="userinput"><code>Grant access</code></strong> and you'll be taken back to GitLab, where you'll be presented with a list of your repositories that you can import from directly, as follows:</li></ol></div><div class="mediaobject"><img src="/graphics/9781789534344/graphics/d0dc4736-3d97-4f07-b610-b428fc073ee7.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="5" type="1"><li>Now, you can choose to <strong class="userinput"><code>Import all compatible projects</code></strong> immediately, or you can import only the ones that you want to move to GitLab.</li></ol></div><p>Note that you can also rename the repositories on import, as well as change the user/group to which they'll belong. In the preceding screenshot, you'll also note one repository listed as an <strong class="userinput"><code>Incompatible project</code></strong>. This project is controlled by a different version control system, such as SVN or Mercurial, and thus can't be imported directly from BitBucket into GitLab. <span>Thankfully</span>, there are methods of converting SVN and Mercurial projects to Git projects, which are covered later in this chapter.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec46"></a>Project URL</h3></div></div></div><p>If your existing code-hosting platform allows you to check out the Git repository via a <code class="literal">http://</code>, <code class="literal">https://</code>, or <code class="literal">git://</code> link, you can also directly import the project into GitLab. This is <span>useful</span><a id="id325235181" class="indexterm"></a> if your code-hosting platform is not currently supported for full integration by GitLab. This can also be used to import public repositories that you see on other platforms and would like to make your own fork of on GitLab:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>From the main screen, click the <strong class="userinput"><code>+</code></strong> icon up the top and then select <strong class="userinput"><code>New Project</code></strong>. On this page, select the <strong class="userinput"><code>Import project</code></strong> tab.</li><li>Select <strong class="userinput"><code>Repo by URL</code></strong> and you'll be provided with a form to fill in:</li></ol></div><div class="mediaobject"><img src="/graphics/9781789534344/graphics/79d7aa00-8592-4506-a17b-0e5a584c2ead.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>Up at the top, you need to fill in the repository URL, which must be preceded by the protocol identifier, such as <code class="literal">http://</code>, <code class="literal">https://</code>, or <code class="literal">git://</code> (as appropriate). If your repository is behind a basic authentication mechanism, you can put your authentication details in the URL, as demonstrated in the notes. Please note that there is a 180-minute timeout for importing repositories and anything longer than that should be done manually (covered as follows):</li></ol></div><p><span>You</span> should also fill in the project name, select the user/group for the project, provide a description, and choose the visibility.</p><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>Once you've done this, click the <strong class="userinput"><code>Create project</code></strong> button down at the bottom and it will automatically import your existing project. Keep in mind that this only copies across the Git data; no issues, merge requests, or other features provided by your existing code-hosting platform will be brought across using this method.</li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec47"></a>Clone and push</h3></div></div></div><p>The least high-tech method for importing a repository is <span>the</span><a id="id325247968" class="indexterm"></a> manual <span class="emphasis"><em>clone</em></span> and <span class="emphasis"><em>push</em></span> process, useful for repositories not accessible from your GitLab instance or too large to be copied across using the previous <strong class="userinput"><code>Project URL</code></strong> method. In this case, you must first check out the repository so <span>you</span><a id="id325247986" class="indexterm"></a> have a copy of it available locally:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>From the main screen, click the <strong class="userinput"><code>+</code></strong> icon up at the top and then select <strong class="userinput"><code>New Project</code></strong>.</li><li>Stay on the <strong class="userinput"><code>Blank project</code></strong> tab and do the following:
<div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Select a user/group for the project.</li><li>Provide a project name.</li><li>Fill out the project description.</li><li>Set the project visibility level.</li></ol></div></li><li>Do not initialize the project with a <code class="literal">README</code>. Click the <strong class="userinput"><code>Create project</code></strong> button and you'll see your new repository.</li><li>Now, you need to go to your existing repository that you want to import and run the following commands:</li></ol></div><pre class="programlisting"><span class="strong"><strong>      git remote rename origin old-origin</strong></span>
<span class="strong"><strong>      git remote add origin [PROJECT GIT URL]</strong></span>
<span class="strong"><strong>      git push -u origin --all</strong></span>
<span class="strong"><strong>      git push -u origin --tags</strong></span></pre><p>This will back up any existing <code class="literal">remote</code> that is named <code class="literal">origin</code> and set up your project URL as the new default <code class="literal">remote</code>. Then, it will push all the data, including all tags, to GitLab.</p></div></div>