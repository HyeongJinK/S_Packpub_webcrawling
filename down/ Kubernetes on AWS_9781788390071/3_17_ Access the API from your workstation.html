<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch03lvl1sec23"></a>Access the API from your workstation</h2></div></div><hr /></div><p>It is convenient to be able to <span>access</span><a id="id325162570" class="indexterm"></a> the Kubernetes API server via <code class="literal">kubectl</code> on your workstation. It means that you can submit any manifests that you may have been developing to your cluster running on AWS.</p><p>We need to allow traffic from the bastion server to access the API server. Let's add a rule to the <code class="literal">K8S-MASTER</code> security group to allow this traffic, as follows:</p><pre class="programlisting"><span class="strong"><strong>$ aws ec2 authorize-security-group-ingress \</strong></span><span class="strong"><strong>--group-id $K8S_MASTER_SG_ID \</strong></span><span class="strong"><strong>--protocol tcp \</strong></span><span class="strong"><strong>--port 6443 \</strong></span><span class="strong"><strong>--source-group $BASTION_SG_ID</strong></span></pre><p>If you haven't already installed kubectl on your workstation, turn back to <a class="link" href="#" linkend="ch02">Chapter 2</a>, <span class="emphasis"><em>Start Your Engines</em></span>, to learn how.</p><p>Now we can copy the <code class="literal">kubeconfig</code> file from the master instance.</p><p>If you do not already have any clusters configured in your local <code class="literal">~/.kube/config</code> file, you can copy the file from the master, as follows:</p><pre class="programlisting"><span class="strong"><strong>$ scp ubuntu@10.0.0.10:~/.kube/config ~/.kube/config</strong></span></pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip20"></a>Note</h3><p>If you already have a cluster configured (for example, minikube), then you may wish to merge the config for your new cluster, or use another file and pass its location to <code class="literal">kubectl</code> with the <code class="literal">--kubeconfig</code> flag, or in the <code class="literal">KUBECONFIG</code> environment variable.</p></div><p>Check that you can connect to the API server using your local <code class="literal">kubectl</code>, as follows:</p><pre class="programlisting"><span class="strong"><strong>$ kubectl get nodes</strong></span><span class="strong"><strong>NAME               STATUS     AGE       VERSION</strong></span><span class="strong"><strong>ip-10-0-9-172...   NotReady   5m        v1.9.3  </strong></span></pre><p>If you have any problem connecting, check that <code class="literal">sshuttle</code> is still running, and that you have correctly allowed access from the bastion host to the k8s-master security group.</p></div>