<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch07lvl1sec49"></a>Building a cluster</h2></div></div><hr /></div><p>The information contained within this chapter is just one possible way that you could approach building <span>and</span><a id="id325162570" class="indexterm"></a> managing a cluster. When building a Kubernetes cluster, there are many choices to be made, and almost as many tools that could be chosen. For the purposes of this chapter, I have chosen to use tools that make it simple to illustrate the process of building a cluster. If you or your team has a preference for using different tools, then the concepts and architecture outlined in this chapter will transfer quite easily to other tools.</p><p>In this chapter, we are going to launch our cluster in a way that will make it more suitable for production workloads. Much of what we do here will be familiar to you from <a class="link" href="#" linkend="ch03">Chapter 3</a>, <span class="emphasis"><em>Reach for the Cloud</em></span>, but we are going to build on the process we outlined there in two key ways. Firstly, when building infrastructure that you depend on, it is very important that you are able to quickly roll out a new instance of your infrastructure in a manner that is repeatable. We want to be able to do this because it makes it simple to test changes that we want to make to our infrastructure in a risk-free way. By automating the provisioning of a Kubernetes cluster, we enable the patterns of immutable infrastructure that we previously discussed. Instead of risking upgrading or changing our production infrastructure, we can quickly provision a replacement cluster that we can then test before moving our workloads to the new cluster.</p><p>In order to achieve this, we are going to use the Terraform infrastructure provisioning tool to interact with AWS. Terraform allows us to define our infrastructure as code using a programming language of sorts. By defining our infrastructure as code, we are able to use tools such as version control and follow other software development practices to manage the evolution of our infrastructure.</p><p>In this chapter, we are about to make a lot of decisions about what a Kubernetes cluster running on AWS should look like and how it should be managed. For the purposes of this chapter and the example that we will be dealing with, I have the following requirements in mind.</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><span class="strong"><strong>Illustrative</strong></span>: We will see what a <span>Kubernetes</span><a id="id325750967" class="indexterm"></a> cluster that meets the requirements of an average production use case might look like. This cluster reflects the decisions that I have personally taken when designing Kubernetes clusters that are intended for real production use. In order to make this chapter as clear and easy to understand as I can, I have tried to keep the cluster and its configuration as simple as possible.</li><li style="list-style-type: disc"><span class="strong"><strong>Flexible</strong></span>: We will create something <span>that</span><a id="id325751171" class="indexterm"></a> you can treat as a template and add to or alter to meet your needs.</li><li style="list-style-type: disc"><span class="strong"><strong>Extendable</strong></span>: Whenever you are designing a Kubernetes cluster (or indeed any infrastructure), you should think about the decisions that you make now <span>that</span><a id="id325751185" class="indexterm"></a> might prevent you from extending or expanding that infrastructure later.</li></ul></div><p>Clearly, when you are building your own cluster, you should have a much more concrete idea of your requirements so that you will be able to tailor your cluster to your own needs. The cluster we will build here will be a great starting point for any production-ready system that you can then customize and add to as required.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note55"></a>Note</h3><p>Much of the configuration in this chapter has been shortened. You can check out the full configuration used in this chapter at <a class="ulink" href="https://github.com/PacktPublishing/Kubernetes-on-AWS/tree/master/chapter07" target="_blank">https://github.com/PacktPublishing/Kubernetes-on-AWS/tree/master/chapter07</a>.</p></div></div>