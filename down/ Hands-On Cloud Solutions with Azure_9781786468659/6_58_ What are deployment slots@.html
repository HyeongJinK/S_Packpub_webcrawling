<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch06lvl1sec61"></a>What are deployment slots?</h2></div></div><hr /></div><p><span class="strong"><strong>Deployment slots</strong></span> are parallel containers that exist within an Azure resource, such as App Services. These slots <span>can</span><a id="id324953581" class="indexterm"></a> be used as <span class="emphasis"><em>environments</em></span>, such as staging, QA, or dev. I leverage slots as a staging environment that can be used to <span class="emphasis"><em>test</em></span> code being deployed in a production environment. Once you are done with your verification testing, you can switch slots for zero downtime. Now, as I mentioned, you can use them for QA and dev environments but this can create issues with downstream resources such as databases or services. I always prefer and recommend keeping a division between environments, for data security, access, and so on, as you can see in the following daigram:</p><div class="mediaobject"><img src="/graphics/9781786468659/graphics/43ed0f2d-c113-4b6e-a7cf-e93aad0108e4.png" /></div><p>Deployment slots</p><p>Deployment slots:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">They act like an App Service instance</li><li style="list-style-type: disc">The main slot is referred to as the production slot</li><li style="list-style-type: disc">They can leverage the configuration of App Services</li><li style="list-style-type: disc">They are scaled by App Service Plan and are not separate</li><li style="list-style-type: disc">The pricing is included with the App Service Plan</li><li style="list-style-type: disc">They have their own URL and site extensions</li></ul></div><p>You can create a deployment slot, as you can see in the following screenshot. Remember, this is only available if they are included in your App Service plan:</p><div class="mediaobject"><img src="/graphics/9781786468659/graphics/0876526d-90a9-4f74-ba18-c38f6bbf634f.png" /></div><p>Create a deployment slot</p><p>The big benefit of using deployment slots is that you can roll back a deployment if needed, quickly and easily. </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip26"></a>Note</h3><p>You need to remember the following when swapping. It changes the following:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">IP Address (always changes)</li><li style="list-style-type: disc">Publishing endpoints</li><li style="list-style-type: disc">Custom domain names</li><li style="list-style-type: disc">SSL certificates and bindings</li><li style="list-style-type: disc">Scale settings</li><li style="list-style-type: disc">Webjob schedulers (if used)</li><li style="list-style-type: disc">Site extensions</li></ul></div></div><p>Now, I would like to point <span>out</span><a id="id325433789" class="indexterm"></a> that you can, which I do not recommend, turn on Auto Swap in your application settings in Azure.  The setting to do so is shown in the following screenshot, with a note that this cannot be done with production slots:</p><div class="mediaobject"><img src="/graphics/9781786468659/graphics/617579e8-6845-477c-b70f-5b0ca2a35076.png" /></div><p>Turn on Auto Swap</p><p>One of the biggest benefits of using slots in production is that you can use the <span class="strong"><strong>testing in production</strong></span> feature. This allows you to direct a percentage of your traffic to the slot to fully test code changes in production. This can give you an <span class="emphasis"><em>extra</em></span> layer of testing and monitoring your application, and provide unique insight before you open the floodgates for your changes. I highly recommend using this for your overall sanity. Let's see how we configure it, as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781786468659/graphics/174de08f-1079-4007-b15b-b3b4896ca2b9.png" /></div><p>Testing in production</p><p> </p><p> </p><p>As you can see in the following diagram, we are directing 10% of our production users to the new slot and because it is its own App Service container, we can monitor it separately from the main production slot, which is pretty cool:</p><div class="mediaobject"><img src="/graphics/9781786468659/graphics/3c334445-f99f-4a83-ae9c-c503f86dfbf2.png" /></div><p>Testing in production summary</p><p>So, as you can see, deployment <span>slots</span><a id="id325433883" class="indexterm"></a> offer to allot and can be leveraged from Azure DevOps pipelines and other deployment mechanisms. But, let's review the pros and cons:</p><p><span class="strong"><strong>Pros:</strong></span></p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">Zero-downtime code deploys</li><li style="list-style-type: disc">Testing in production feature</li><li style="list-style-type: disc">Great to verify code deploys in the exact environment</li></ul></div><p><span class="strong"><strong>Cons:</strong></span></p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">Are considered <span class="emphasis"><em>new App Services</em></span>, so extensions and configurations need to redeployed</li><li style="list-style-type: disc">Based on App Service Plan, need Standard or above to use</li><li style="list-style-type: disc">Because they are based on the App Service Plan, they don't scale separately</li></ul></div><p> </p></div>