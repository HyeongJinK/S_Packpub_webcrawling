<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch03lvl1sec30"></a>Key Vault</h2></div></div><hr /></div><p><span class="strong"><strong>Key Vault</strong></span> was designed as a tool to store <span>keys</span><a id="id324953584" class="indexterm"></a> and secrets, which helps you control access to the vault. It can be used by anyone who has an Azure subscription and have subscription boundaries. Azure Key Vault is also a service that lets you easily provision, manage, and <span>deploy</span><a id="id324953592" class="indexterm"></a> public and private <span class="strong"><strong>Secure Sockets Layer</strong></span>/<span class="strong"><strong>Transport Layer Security</strong></span> (<span class="strong"><strong>SSL</strong></span>/<span class="strong"><strong>TLS</strong></span>) certificates for use with Azure and your internal connected resources.</p><p>I work with Key Vault to help with the following:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><span class="strong"><strong>Key management</strong></span>: To store my keys <span>like</span><a id="id325438583" class="indexterm"></a> encryption keys for securing my data</li><li style="list-style-type: disc"><span class="strong"><strong>Secret management</strong></span>: To <span>store</span><a id="id325438597" class="indexterm"></a> my tokens, certificates, API Keys, passwords, and other secrets.</li></ul></div><p>There are three ways to authenticate to Key Vault:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">Use managed identities for Azure resources, which is the recommended approach, as the secrets are rotated automatically</li><li style="list-style-type: disc">Use a services principle and certificate, which requires the owner to rotate the certificate rather than being automatic like identities for Azure resources</li><li style="list-style-type: disc">Use a service principle and secret, which is the most basic approach to accessing the vault</li></ul></div><p>To create a Key Vault, you can either be in the Azure portal or go through PowerShell. I prefer PowerShell because of its reuse. Let’s see how that is done:</p><pre class="programlisting"><span class="strong"><strong>New-azKeyVault -VaultName 'BookDemo-KeyVault’ -ResourceGroupName 'keyvault-prod-rg-01' -Location 'East US'</strong></span></pre><p>Now, let’s add a secret to the vault, again using PowerShell:</p><pre class="programlisting"><span class="strong"><strong>$secretvalue = ConvertTo-SecureString 'Pass@word1' -AsPlainText -Force</strong></span>
<span class="strong"><strong>$secret = Set-AzureKeyVaultSecret -VaultName 'BookDemo-KeyVault’ -Name 'DemoPassword' -SecretValue $secretvalue</strong></span></pre><p> </p><p>One of the biggest examples of usage in Azure is if you use App Services, as I leverage App Services Certificates, which secure App Services and I don’t need to remember to rotate them, as Azure does that for me.</p><p>Let’s look at pricing for Key Vault:</p><div class="mediaobject"><img src="/graphics/9781786468659/graphics/d47c168e-6893-4b32-ba02-d21f654c5c2c.png" /></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec13"></a>VNet</h3></div></div></div><p>When you have an internal network, you usually <span>care</span><a id="id325644445" class="indexterm"></a> about the network you plug your resources into. In Azure, that piece is abstracted out of your view in most scenarios. However, you might need to control how your resources interact or you may need to connect your own network to Azure.</p><p>I like to use <span>VNet</span><a id="id325644456" class="indexterm"></a> for the following reasons:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">Isolation and segmentation</li><li style="list-style-type: disc">Communication between Azure resources</li></ul></div><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">Communication with o-premise resources</li><li style="list-style-type: disc">Filtering network traffic</li><li style="list-style-type: disc">Routing network traffic, using routing tables to move traffic between subnets and networks on-premise or via the internet</li><li style="list-style-type: disc">Connecting virtual networks in different regions</li></ul></div><p>Let’s take a quick look at a simplified VNet implementation that has a public frontend and a private backend:</p><div class="mediaobject"><img src="/graphics/9781786468659/graphics/9d728f65-e73c-48a7-9e11-07eb0451509d.png" /></div><p>As you can see, we are using a <span class="strong"><strong>Network Security Group</strong></span> (<span class="strong"><strong>NSG</strong></span>), to apply policies to the subnets. One of the policies on the backend subnet is limiting access to the internet.  We have an Azure front door service running in front of our app services to provide load balancing and SSL off-loading. In our backend subnet, we are using Key Vault to store our secrets and keys. This is just a simple way to show how to use a VNet in Azure.</p><p> </p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec14"></a>Mobile</h3></div></div></div><p>Azure can assist with mobile development <span>for</span><a id="id325644517" class="indexterm"></a> using Azure AD or Azure B2C to secure your app so as to use CosmosDB to store telemetry. Mobile apps generally rely on services within the cloud to provide or store data. One of the biggest things I like is that you can use these services in Xamarin. This allows you to create a native app all from a single code base written in C#. So, to quickly summarize, mobile apps can provide the following:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">Authentication and authorization, through directory services or OAuth services</li><li style="list-style-type: disc">Data access</li><li style="list-style-type: disc">Offline sync</li><li style="list-style-type: disc">Push notification</li></ul></div><p>Mobile apps function like App Services and while native device development isn’t truly about Azure, I wanted to make note that mobile development will be one of the cornerstone services provided by Azure.  So, I would recommend that you get your team up to speed with Xamarin development so you can rapidly provide mobile solutions when needed.  This is how I would approach a mobile app in Azure, with my team using Xamarin to do the development:</p><div class="mediaobject"><img src="/graphics/9781786468659/graphics/4bfe61f4-a18e-472c-9704-720b8aeefc68.png" /></div><p>As you can see, I would use a social account, Azure B2C, or both to secure my app, plan for offline syncing (if data is important), while leveraging an app/mobile service with SQL and/or CosmosDB as the data repository. Application Insight would be my error log, to not only trap my application errors but also my service-based errors.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec15"></a>IoT</h3></div></div></div><p>IoT devices, such as mobile devices, have a similar <span>flow</span><a id="id325644558" class="indexterm"></a> in Azure, as generally, the backend services are consumed by the IoT device. There are a few caveats. IoT devices have two specialized elements in Azure; one is the IoT hub, which is an implementation of an event hub but targets IoT, and IoT Central. Let’s look at how we can use IoT Central to discover an IoT story for an organization.</p><p>Head to <a class="ulink" href="https://apps.azureiotcentral.com/" target="_blank">https://apps.azureiotcentral.com/</a> and log in. Once there, create an app:</p><div class="mediaobject"><img src="/graphics/9781786468659/graphics/691b745c-ac06-4aa3-91da-60883793cf0c.png" /></div><p>Click the <span class="strong"><strong>+</strong></span> sign and then enter the application info. I like to use the samples to get started hooking things up:</p><div class="mediaobject"><img src="/graphics/9781786468659/graphics/1a8a7659-486c-4db5-b95d-b76d3c73ec10.png" /></div><p>Add your device, then work on an application POC. You will work off the following dashboard:</p><div class="mediaobject"><img src="/graphics/9781786468659/graphics/d5b62132-00a9-4ad4-94e9-6ce422f0a828.png" /></div><p>This is a great way to not only learn but also to leverage IoT in Azure. Let’s look at how an architecture might look for an IoT device:</p><div class="mediaobject"><img src="/graphics/9781786468659/graphics/87dea494-514c-464c-801f-0a1dd143235b.png" /></div><p>You can connect as many IoT devices as needed to this model and you can leverage machine learning to tell you things about your environment and devices, such as monitoring devices for errors and predicting when failures will occur or doors left open</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec16"></a>AI and Machine Learning</h3></div></div></div><p><span class="strong"><strong>Artificial intelligence</strong></span> (<span class="strong"><strong>AI</strong></span>), is a set of tools that <span>allow</span><a id="id325645024" class="indexterm"></a> you to make <span>predictive</span><a id="id325645032" class="indexterm"></a> models that learn. Generally, AI application leverage three key factors:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">Ingesting data from multiple connected sources</li><li style="list-style-type: disc">Building a model and training the data</li><li style="list-style-type: disc">Deploying the model and tracking</li></ul></div><p>The AI services in the cloud come in a few versions. Let’s take a quick look:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><span class="strong"><strong>Pre-built</strong></span>: These are as-a-service offerings. The types are as follows:</li><li style="list-style-type: disc"><span class="strong"><strong>Vision</strong></span>: Used to identify and analyze image content.</li><li style="list-style-type: disc"><span class="strong"><strong>Speech</strong></span>: To convert the spoken word to text.</li><li style="list-style-type: disc"><span class="strong"><strong>Language</strong></span>: To understand the meaning behind a speaker’s intent.</li><li style="list-style-type: disc"><span class="strong"><strong>Knowledge</strong></span>: Knowledge-based services.</li><li style="list-style-type: disc"><span class="strong"><strong>Search</strong></span>: Search-based services.</li><li style="list-style-type: disc"><span class="strong"><strong>Custom</strong></span>: It allows you to rapidly prototype your own model. Great information is available at <a class="ulink" href="https://docs.microsoft.com/en-us/azure/machine-learning/service/" target="_blank">https://docs.microsoft.com/en-us/azure/machine-learning/service/</a>.</li><li style="list-style-type: disc">Azure Machine Learning.</li><li style="list-style-type: disc">Visual Studio Code Tools for AI.</li><li style="list-style-type: disc">Machine Learning Studio.</li><li style="list-style-type: disc">Conversational; the bot side of the world to naturally interact with folks.</li><li style="list-style-type: disc"><span class="strong"><strong>Bot Service</strong></span>: Interactive bot that can answer questions.</li><li style="list-style-type: disc">Language Understanding</li><li style="list-style-type: disc"><span class="strong"><strong>QnA Maker</strong></span>: A question and answer maker</li></ul></div><p>AI has a lot of real-world uses, such as predictive maintenance and defect detection. Bots also provide tons of interaction scenarios and you can use cognitive services with your apps, including SaaS solutions. I have used the speech service in D365 for dictation for a healthcare app and I have used search to rapidly search data repositories. It has also been used to enhance how developers write code.</p><p>So, when you want to build or leverage a cognitive service, let’s look at the dashboard:</p><div class="mediaobject"><img src="/graphics/9781786468659/graphics/d3c55abb-8be7-499f-9272-a93412231212.png" /></div><p>You can see that there are a lot of services and ways to interact and leverage AI. Later in this book, we will discuss how to use these services when developing solutions.</p></div></div>