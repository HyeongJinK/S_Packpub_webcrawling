<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch01lvl1sec15"></a>How do I start using Azure?</h2></div></div><hr /></div><p>When one starts using Azure, there are <span>many</span><a id="id325432068" class="indexterm"></a> new things to learn, like how resources are configured and used in the environment. So, I headed over to the Azure portal (<a class="ulink" href="https://portal.azure.com" target="_blank">https://portal.azure.com</a>) and created an account. There are several things to consider here; you can <span>pay</span><a id="id325438577" class="indexterm"></a> as you go, configure an Enterprise Agreement, use an Azure Pass, sign up for Dev Essentials, or use an MSDN subscription to set up how you will pay for the resources. You can also configure spending limits to help control costs and also control enterprise costs. With an Enterprise Agreement, you can use a Dev/Test subscription to help offset costs. Enterprise Agreement Dev/Test subscriptions get you a significant price reduction, percentage-wise, over production versions. If you plan on using Azure a lot, I would recommend engaging with Microsoft to get an Enterprise Agreement. To get an Enterprise Agreement, you will need to reach out to a Microsoft account representative for the requirements, which you can review here: <a class="ulink" href="https://www.microsoft.com/en-us/licensing/licensing-programs/enterprise.aspx" target="_blank">https://www.microsoft.com/en-us/licensing/licensing-programs/enterprise.aspx</a><a class="ulink" href="https://www.microsoft.com/en-us/licensing/licensing-programs/enterprise.aspx" target="_blank">.</a> As a side note, you can also create your account through Office 365 services, but for the sake of simplification, we will stick with the Azure portal side. Once your account has been created, you will access the portal and be presented with the Azure default dashboard. For a Tenant to be created, you must have what is referred to as a privileged account, which is defined as an Azure account in the Tenant or Enterprise Agreement. At the end of the day, it is an organization's network account.</p><p>Once the Tenant has been created, it will act as a virtual representation of your organization within Azure. This equates to the earlier physical network structures that were used within an organization which was secured by firewalls, network resources, and directory services that were usually housed in a data center. A Tenant in Azure follows the same structural basis but is a virtual instance of the organization <span>that</span><a id="id325438596" class="indexterm"></a> is backed by the <span class="strong"><strong>Azure Active Directory</strong></span> (<span class="strong"><strong>AAD</strong></span>) services. All Tenants require AAD, as this is the digital identity service model for securing all SaaS, IaaS, and PaaS resources. Think of the Tenant as your organization container, with the same type of physical boundaries as a physical data center network would have. The following diagram shows a simplified view of a Tenant:</p><div class="mediaobject"><img src="/graphics/9781786468659/graphics/b0d821ed-6da2-40f3-b703-f8dd6a18822d.png" /></div><p>AAD services, as shown in the preceding diagram, can be synchronized <span>with</span><a id="id325611416" class="indexterm"></a> an on-premise <span class="strong"><strong>Active Directory</strong></span> (<span class="strong"><strong>AD</strong></span>) through a process called <span class="strong"><strong>Active Directory Federation Service</strong></span> (<span class="strong"><strong>ADFS</strong></span>). This is the process of <span class="emphasis"><em>syncing</em></span> users/groups and helps with providing access to cloud and on-premises resources without the need to add users to both directory services. Now that we have our Tenant, it has <span>hard</span><a id="id325611444" class="indexterm"></a> resource sharing boundaries that can’t be broken, just like your physical network. A Tenant is also assigned a Tenant ID that is used to identify the organization, and the privileged account is assigned the owner. Within your Tenant, you have an Office 365 or O365 container that houses your SaaS products such as Exchange, SharePoint, Power App, and so on, and the Azure Container that houses your subscriptions and resource groups. This book isn’t about O365 and the SaaS-based container, but more about the Azure container and the guidance needed to architect, develop and deploy solutions. Now, regarding Azure, we need to discuss the structure of how resources are handled: you start with a Tenant, then you have a subscription, and then you have a resource group, as shown in the following diagram:</p><div class="mediaobject"><img src="/graphics/9781786468659/graphics/c1252f33-400e-47b7-bd25-afdcbafdc4f6.png" /></div><p>A <span class="strong"><strong>Subscription</strong></span> (<span class="strong"><strong>Sub</strong></span>) in Azure is a container <span>that</span><a id="id325611472" class="indexterm"></a> groups together resources and users, and also has limits. The limits have changed over time and can be increased with support tickets from Microsoft. You can review the limits at <a class="ulink" href="https://docs.microsoft.com/en-us/azure/azure-subscription-service-limits" target="_blank">https://docs.microsoft.com/en-us/azure/azure-subscription-service-limits</a>. Subs themselves have sharing limits as well. For instance, currently, Key Vaults, App Service Certs, and Express Routes, to name a few, do not span subscriptions. You can also include resources in <span class="strong"><strong>Resource Groups</strong></span> (<span class="strong"><strong>RG</strong></span>) from another subscription. You also do not have the <span class="strong"><strong>intellisense</strong></span> in the <span>portal</span><a id="id325611974" class="indexterm"></a> for resources, not in the <span>same</span><a id="id325611980" class="indexterm"></a> subscriptions. RGs are application life cycle resource containers within a subscription that houses all the resources that make an application or piece of an application or infrastructure. You create a subscription when your tenant is created. You can also do this through your Enterprise Portal.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip3"></a>Note</h3><p>Architectural tip:
When you have created your Tenant and start building out your Subs, you should keep to a simplistic approach. This means that you should start minimally, for example, you should have a Tenant and a Sub or two. I generally start with a production Sub and a non-production Sub. In your non-production Sub, you should get Dev/Test pricing through you EA or use MSDN as your non-production Sub by using resource groups at application containers.The reason for this suggestion is that resources have boundaries, and hybrid solutions require VPNs or Express Route, which have Sub boundaries and require VNet integration to other Subs, which will become multiple points of failure. I suggest you only add more Subs based on very specific needs, such as client work you need to transfer later on to a client.</p></div><p> </p><p> </p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec4"></a>I have set up my Tenant – what's next?</h3></div></div></div><p>After you have configured and <span>set</span><a id="id325612006" class="indexterm"></a> up your Tenant and Subs, perform <span>the</span><a id="id325612014" class="indexterm"></a> following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Let’s login into the portal at <a class="ulink" href="https://portal.azure.com/" target="_blank">https://portal.azure.com/</a>. Once you have signed into Azure, you will enter the default dashboard.</li></ol></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note4"></a>Note</h3><p><span class="strong"><strong>Dashboards</strong></span> are extremely powerful, and we will discuss leveraging them at each step in supporting and monitoring the resources that are built.</p></div><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Now, there are several ways we can add resources through the portal, but in this first section, we will add them into the portal. There are several ways to search for resources using the portal once you have logged in, as shown in the following screenshot:</li></ol></div><div class="mediaobject"><img src="/graphics/9781786468659/graphics/92f7ef5f-0153-43bf-ac1f-70c9a740c8ff.png" /></div><p>Resource search on Azure Portal</p><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>You can use the top search for quick resource lookup by typing in the name of the resource you need, for example, <code class="literal">App Service Cert</code> or <code class="literal">Certificates</code>.</li></ol></div><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>If you would like to search by visible name, you can use the <strong class="userinput"><code>All Services</code></strong> link from the side menu. This will bring up the services blade, as shown in the following screenshot:</li></ol></div><div class="mediaobject"><img src="/graphics/9781786468659/graphics/23612d70-080c-4f03-b03b-0d3b6fb685ef.png" /></div><p>All services blade</p><p>Now, some resources come from the Azure Marketplace, such as VM images and Web Applications. These are provided from the Marketplace via ARM resource deployments <span>that</span><a id="id325810629" class="indexterm"></a> are created by Microsoft or certified vendors. The <span class="strong"><strong>Azure Resource Management</strong></span> (<span class="strong"><strong>ARM</strong></span>) are template systems that are used by Azure deployment mechanisms. These are basically JSON files that describe the resources being deployed.  We will discuss them in details in <a class="link" href="#" linkend="ch06">Chapter 6</a>, <span class="emphasis"><em>Deploying Solutions to Azure</em></span>.  The marketplace is a great starting place for applications such as WordPress.</p><p> </p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch01lvl3sec0"></a>Let's walk through a marketplace example</h4></div></div></div><p>Let's walk through an example of how to <span>set</span><a id="id325810662" class="indexterm"></a> up a WordPress <span>site</span><a id="id325810670" class="indexterm"></a> using on the Portal and Marketplace. This will not only provide an understanding of how to use the Marketplace but how the underlying ARM templates are leveraged in the deployment of resources from the Marketplace:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>In the top search bar, type <code class="literal">Marketplace</code>, as follows:</p></li></ol></div><div class="mediaobject"><img src="/graphics/9781786468659/graphics/47d8f47c-862d-463c-911c-d097a1026b90.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Select <span class="strong"><strong>Marketplace</strong></span> from the services menu.</li></ol></div><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>Once the <span class="strong"><strong>Marketplace</strong></span> blade is open, select <strong class="userinput"><code>Everything</code></strong> and type <code class="literal">WordPress</code>, as follows:</li></ol></div><div class="mediaobject"><img src="/graphics/9781786468659/graphics/1f691abd-9d6c-4a36-9f6d-57086d219ae5.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>Select the first <strong class="userinput"><code>WordPress</code></strong> in the list.</li></ol></div><p> </p><div class="orderedlist"><ol class="orderedlist arabic" start="5" type="1"><li>Click on the <strong class="userinput"><code>Create</code></strong> button, as shown in the following screenshot:</li></ol></div><div class="mediaobject"><img src="/graphics/9781786468659/graphics/00de0e8b-9fb7-4fc3-9e51-1a2390535a13.png" /></div><p></p><div class="orderedlist"><ol class="orderedlist arabic" start="6" type="1"><li>Enter an <strong class="userinput"><code>App Name</code></strong>, <strong class="userinput"><code>Subscription</code></strong>, <strong class="userinput"><code>Resource Group Name</code></strong>, and <strong class="userinput"><code>Database Provider</code></strong> to <strong class="userinput"><code>Azure Database for MySQL</code></strong>. Leave the <strong class="userinput"><code>App Service plan/Locations</code></strong> settings as their default options for the demo:</li></ol></div><div class="mediaobject"><img src="/graphics/9781786468659/graphics/14351710-5e33-462a-a96e-de31c5ef5995.png" /></div><p></p><div class="orderedlist"><ol class="orderedlist arabic" start="7" type="1"><li>For this walk-through, when you click on <strong class="userinput"><code>Database</code></strong> and the <strong class="userinput"><code>Database</code></strong> blade comes up, just add a password, select a basic pricing tier, and click <strong class="userinput"><code>OK</code></strong>:</li></ol></div><div class="mediaobject"><img src="/graphics/9781786468659/graphics/834711e7-b40f-4e8a-9ec9-126e8785f3db.png" /></div><p></p><div class="orderedlist"><ol class="orderedlist arabic" start="8" type="1"><li>Then, click the <strong class="userinput"><code>Create</code></strong> button.</li><li>Once this has been created, you will receive a notification stating that is has been completed. Click on <strong class="userinput"><code>Go to resource</code></strong>, where you will be able to access and configure your WordPress site.</li></ol></div><p>Optional steps to <span>add</span><a id="id325868720" class="indexterm"></a> a custom domain <span>and</span><a id="id325868728" class="indexterm"></a> SSL Certificate</p><div class="orderedlist"><ol class="orderedlist arabic" start="10" type="1"><li>Go to your App Service Resource and click on <strong class="userinput"><code>Custom Domains</code></strong>, use the IP Address to point your domain at, once you add your A record, then click on <strong class="userinput"><code>+ Add Hostname</code></strong> to add.</li></ol></div><div class="mediaobject"><img src="/graphics/9781786468659/graphics/a35ae495-bd57-4166-9658-a340264f95bd.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="11" type="1"><li>You will need to add your private or public certs, which you can leverage App Service Certificates (which I recommend), and once added, <span class="strong"><strong>+Add a Binding</strong></span> and turn on HTTPS only.</li></ol></div><div class="mediaobject"><img src="/graphics/9781786468659/graphics/37c1232e-2e1e-496f-b786-059f67de4977.png" /></div><p> </p><p>During this exercise, we created several things: an App Service, an App Service Plan, a MySQL server, and a MySQL database instance. An <span class="strong"><strong>App Service</strong></span>is the instance of code <span>needed</span><a id="id325868829" class="indexterm"></a> to run the application. In this case, this is the WordPress PHP code. This is connected to the Marketplace code repository that, in most cases, keeps the code updated based on refreshes to the Marketplace.  It is deployed from the Marketplace using a process called ARM template. An<span class="strong"><strong>ARM template</strong></span>is a JSON representation of the resources <span>that</span><a id="id325868840" class="indexterm"></a> are deployed to an Azure Resource Group.  The ARM template process leverages a<span class="strong"><strong>Desired State Configuration</strong></span>(<span class="strong"><strong>DSC</strong></span>), to manage the configuration state of the resources, and this process helps with creating or updating the resources should the <span>template</span><a id="id325903501" class="indexterm"></a> be run again to update the resources within the application Resource Group.  In the <span>case</span><a id="id325903508" class="indexterm"></a> of WordPress, the updates are handled by the portal. An<span class="strong"><strong>App Service Plan</strong></span>, commonly call VM backed, is the virtual resources allocated to the App Service. Think of the VM as something that houses the web server, and the App Service as an IIS <span>app</span><a id="id325903518" class="indexterm"></a> on the box. The<span class="strong"><strong>MySQL server</strong></span>instance houses the MySQL database instance for the WordPress site, which is almost the same as the on-premise version in IIS, but is instance-based and hides the server's implementation. So, as you can see, the implementation of the application is basically the same as it would be on-premise, but it is more instance-based in Azure. There is no need to worry about the infrastructure implementation as you would with an on-premise solution.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note5"></a>Note</h3><p>The App Service Plan controls the resources used to back up your App Service for dev or demo environments. I would use Free or Shared to help keep the cost down.  If you require custom URLs or SSL, you will need to use a basic or standard plan, which will increase the cost significantly, so be mindful of the requirements you need for your App Service. For larger organization you can get premium tiers and for those using PII or GDPR you can leverage isolated tier or App Service Environment or ASE to isolate applications and protect data.</p></div></div></div></div>