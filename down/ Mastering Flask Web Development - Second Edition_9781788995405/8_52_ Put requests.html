<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch08lvl1sec53"></a>Put requests</h2></div></div><hr /></div><p>As listed in the table at the beginning of this chapter, <code class="literal">PUT</code> requests are <span>used</span><a id="id324993881" class="indexterm"></a> to change the values <span>of an existing resource</span>. Like the <code class="literal">post</code> method, the first thing that we should do is create a new parser in <code class="literal">parsers.py</code>, as follows:</p><pre class="programlisting">post_put_parser = reqparse.RequestParser()
post_put_parser.add_argument(
'title',
type=str,
location=('json', 'values')
)
post_put_parser.add_argument(
'text',
type=str,
location=('json', 'values')
)
post_put_parser.add_argument(
'tags',
type=str,
action='append',
location=('json', 'values')
)</pre><p>The logic for the <code class="literal">put</code> method is very similar to the <code class="literal">post</code> method. The main difference is that each change is optional and any request that does not provide <code class="literal">post_id</code> is denied, as shown in the following code:</p><pre class="programlisting">...
def add_tags_to_post(post, tags_list):
for item in tags_list:
        tag = Tag.query.filter_by(title=item).first()

# Add the tag if it exists. If not, make a new tag
if tag:
            post.tags.append(tag)
else:
            new_tag = Tag(item)
            post.tags.append(new_tag)
...

@jwt_required
def put(self, post_id=None):
if not post_id:
            abort(400)
        post = Post.query.get(post_id)
if not post:
            abort(404)
        args = post_put_parser.parse_args(strict=True)
if get_jwt_identity() != post.user_id:
            abort(403)
if args['title']:
            post.title = args['title']
if args['text']:
            post.text = args['text']
if args['tags']:
print("Tags %s" % args['tags'])
            add_tags_to_post(post, args['tags'])

        db.session.merge(post)
        db.session.commit()
return {'id': post.id}, 201</pre><p>Also note that, just as we did with the controller for web views, we are denying any request to change a blog post that was not made by the creator of the blog post him or herself.</p><p>To test this method, <code class="literal">curl</code> can also create <code class="literal">PUT</code> requests with the <code class="literal">-X</code> flag, as follows:</p><pre class="programlisting"><span class="strong"><strong>$ curl -X PUT -H "Authorization: Bearer $ACCESS" -H "Content-Type: application/json" \</strong></span>
<span class="strong"><strong>    -d '{"title": "Modified From REST", "text": "this is from REST", "tags": ["tag1","tag2"]}' \</strong></span>
<span class="strong"><strong>http://localhost:5000/api/post/5</strong></span></pre><p> </p><p> </p></div>