<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch08lvl1sec48"></a>What is REST?</h2></div></div><hr /></div><p>Before getting into the details of REST, and since it is a style for <span>communication</span><a id="id324993883" class="indexterm"></a> between systems, let's first have a quick dive into the actual protocol that it uses, on which this whole book is based.</p><p> </p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch08lvl2sec58"></a>HTTP</h3></div></div></div><p>The <span class="strong"><strong>Hypertext Transfer Protocol</strong></span> (<span class="strong"><strong>HTTP</strong></span>) is a request–response <span>protocol</span><a id="id325714906" class="indexterm"></a> that belongs to layer 7 (the application layer). This layer interacts with the application itself. Some other <span>protocols</span><a id="id325714915" class="indexterm"></a> that belong to layer 7 are the <span class="strong"><strong>Simple Mail Transfer protoco</strong></span>l (<span class="strong"><strong>SMTP</strong></span>), <span class="strong"><strong>Network File System</strong></span> (<span class="strong"><strong>NFS</strong></span>), and the <span class="strong"><strong>File Transfer Protocol</strong></span> (<span class="strong"><strong>FTP</strong></span>), to name a few.</p><p>HTTP was designed to be used by clients (user agents) to request <span>resources</span><a id="id325731709" class="indexterm"></a> from a server. These resources can be HTML files or any other content, such as JSON, XML, or media files. These requests for <span>resources</span><a id="id325731717" class="indexterm"></a> are identified by the network using <span class="strong"><strong>unified resource locators</strong></span> (<span class="strong"><strong>URLs</strong></span>).</p><p>A URL is a specific type of URI, composed of the following elements:</p><pre class="programlisting">&lt;scheme&gt;://&lt;authority&gt;/&lt;path&gt;/&lt;query&gt;&lt;fragment&gt;</pre><p>The preceding <code class="literal">&lt;authority&gt;</code><span>part</span>:</p><pre class="programlisting">&lt;userinfo&gt;@&lt;host&gt;:&lt;port&gt;</pre><p>The following is an example URL using our application:</p><pre class="programlisting">http://someserver.com:5000/blog/user/user1?title=sometitle#1</pre><p>Let's separate out the elements of this:</p><div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; "><colgroup><col /><col /></colgroup><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>Scheme</strong></span></p></td><td style="border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>HTTP</strong></span></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">authority.host</code></p></td><td style="border-bottom: 0.5pt solid ; "><p><code class="literal">someserver.com</code></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">authority.port</code></p></td><td style="border-bottom: 0.5pt solid ; "><p><code class="literal">5000</code></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">path</code></p></td><td style="border-bottom: 0.5pt solid ; "><p><code class="literal">blog/user/user1</code></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">query</code></p></td><td style="border-bottom: 0.5pt solid ; "><p><code class="literal">title=sometitle</code></p></td></tr><tr><td style="border-right: 0.5pt solid ; "><p><code class="literal">fragment</code></p></td><td style=""><p><code class="literal">1</code></p></td></tr></tbody></table></div><p> </p><p> </p><p>Next, we will quickly look at an HTTP request message from a user agent to a server. This is a GET request from a Mozilla browser, as shown in the highlighted text in the following code:</p><pre class="programlisting"><span class="strong"><strong>GET /blog/user/user1</strong></span> HTTP/1.1
Host: someserver.com
Accept: image/gif, image/jpeg, */*
Accept-Language: en-us
Accept-Encoding: gzip, deflate
User-Agent: <span class="strong"><strong>Mozilla</strong></span>/4.0 (compatible; MSIE 6.0; Windows NT 5.1)
Cookie: cookie1=somevalue; cookie2=othervalue; session:dsofksdfok439349i3sdkfoskfoskfosdkfo
(blank line)</pre><p>So an HTTP request is composed of the following:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><span class="strong"><strong>Request line</strong></span>: Further composed of <code class="literal">&lt;Request method&gt; &lt;Request URI&gt; &lt;HTTP version&gt;</code></li><li style="list-style-type: disc"><span class="strong"><strong>Request header</strong></span>: Contains information about what the client accepts, the user agent, cookies, and even basic authentication credentials</li><li style="list-style-type: disc"><span class="strong"><strong>A</strong></span><span class="strong"><strong>blank line</strong></span>: Separates the header from the body section</li><li style="list-style-type: disc"><span class="strong"><strong>Request body</strong></span>: Optional</li></ul></div><p>Accepted HTTP request methods are <code class="literal">GET</code>, <code class="literal">HEAD</code>, <code class="literal">POST</code>, <code class="literal">PUT</code>, <code class="literal">DELETE</code>, <code class="literal">CONNECT</code>, <code class="literal">OPTIONS</code>, <code class="literal">TRACE</code>, and <code class="literal">PATCH</code>. The REST specification will use them to identify application type operations.</p><p>An HTTP response to a request looks like the following:</p><pre class="programlisting">HTTP/1.0 200 OK
Content-Type: application/json
Content-Length: 1330
Server: Werkzeug/0.14.1 Python/2.7.10
Date: Thu, 19 Jul 2018 11:14:16 GMT
{ "author": "user1" ... }</pre><p> </p><p>It's composed of the following elements: </p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><span class="strong"><strong>Status line</strong></span>: The status of the response</li><li style="list-style-type: disc"><span class="strong"><strong>Response headers</strong></span>: Contains information about the content type, length, the server type (in our example, it's Flask's development server itself), date, and whether it <span>can send set-cookie operations</span></li><li style="list-style-type: disc">A blank line</li><li style="list-style-type: disc"><span class="strong"><strong>Response body</strong></span>: In our example, this is a JSON response, probably a REST service response</li></ul></div><p>Status response codes are also very significant to REST. These fall into the <span>following</span><a id="id325841834" class="indexterm"></a> categories:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><span class="strong"><strong>Informational</strong></span>: 1XX</li><li style="list-style-type: disc"><span class="strong"><strong>Successful</strong></span>: 2XX</li><li style="list-style-type: disc"><span class="strong"><strong>Redirection</strong></span>: 3XX</li><li style="list-style-type: disc"><span class="strong"><strong>Client error</strong></span>: 4XX</li><li style="list-style-type: disc"><span class="strong"><strong>Server error</strong></span>: 5XX</li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip34"></a>Note</h3><p>For further details on status response codes, take a look at RFC2616 at <a class="ulink" href="https://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html" target="_blank">https://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html</a>.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch08lvl2sec59"></a>REST definition and best practices</h3></div></div></div><p>Before getting into the details of REST, let's look at an example. With a client—in this case, a web browser—and a server, the client sends a request to the <span>server</span><a id="id325893090" class="indexterm"></a> over HTTP for <span>some</span><a id="id325893098" class="indexterm"></a> models, as follows:</p><div class="mediaobject"><img src="/graphics/9781788995405/graphics/3be13954-184b-49e3-bcfa-a5cea9cf9ada.png" /></div><p>The server will then respond with a document containing all the models, as follows:</p><div class="mediaobject"><img src="/graphics/9781788995405/graphics/3f623739-2122-4838-add2-5f796c30e308.png" /></div><p>The client can then modify the data on the server through a <code class="literal">PUT</code> HTTP request, as follows:</p><div class="mediaobject"><img src="/graphics/9781788995405/graphics/9eb0102a-18e5-46e2-bc86-328fee5fc974.png" /></div><p>Then, the server will respond that it has modified the data. This is a very simplified example, but it will serve as a backdrop to how REST is defined.</p><p>Rather than a strict standard, REST lays out a set of constraints on communications to define a methodology that can be implemented in many ways. These constraints are born out of years of trial and error with other communication protocols, such as the <span class="strong"><strong>Remote Procedure Call</strong></span> (<span class="strong"><strong>RPC</strong></span>) or <span class="strong"><strong>Simple Object Access Protocol</strong></span> (<span class="strong"><strong>SOAP</strong></span>). These protocols fell by the wayside because of their strictness, verbosity, and the fact that it is difficult to use them to create APIs. The issues with these systems <span>were</span><a id="id325976587" class="indexterm"></a> identified, and REST's constraints <span>were</span><a id="id325976594" class="indexterm"></a> created to keep these issues from happening again.</p><p> </p><p>REST provides the following guiding constraints:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><span class="strong"><strong><span>Separation of concerns between the client and server</span></strong></span><span>:</span> The client and <span>server</span><a id="id325976622" class="indexterm"></a> should be able to evolve or change independently as long as the API does not change.</li><li style="list-style-type: disc"><span class="strong"><strong>Stateless</strong></span>: Any information that is necessary to handle requests is stored in the request itself or <span>by</span> the client. An example of the server being stateless is the <code class="literal">session</code> object in Flask. The <code class="literal">session</code> object does not store its information on the server, but stores it on the client in a cookie. The cookie is sent along with every request for the server to parse and determine whether the necessary data for the requested resource is stored inside it, rather than the server storing session information for every user.</li><li style="list-style-type: disc"><span class="strong"><strong>Uniform interface</strong></span>: There are many different parts to this constraint, which are as follows:
<div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">The interface is based around resources, which in our case are models.</li><li style="list-style-type: disc">Data sent by the server is not the actual data in the server, but a representation. For example, a JSON abstraction of the data is sent with each request, rather than the actual database.</li><li style="list-style-type: disc">The data sent by the server is enough to allow the client to modify the data on the server. In the preceding example, the IDs that are passed to the client fill this role.</li><li style="list-style-type: disc">Every resource provided by the API must be represented and accessed in the same manner. For example, one resource cannot be represented in XML and while another is represented in JSON.</li></ul></div></li><li style="list-style-type: disc"><span class="strong"><strong>Layered system:</strong></span> Load balancers, proxies, caches, and other servers and services can act between the client and the server, as long as the final result is the same as if they were not there. This improves performance, scalability, and availability.</li><li style="list-style-type: disc"><span class="strong"><strong>Cacheability: </strong></span>Clients can cache responses, so a server must define whether a response is cacheable or not. This improves performance.</li></ul></div><p>When a system adheres to all these constraints, it is considered to be a RESTful system. The most common forms of RESTful systems are built of HTTP and JSON. Each resource is located on its own URL path and is modified with different HTTP request methods. Generally, this takes the following form:</p><div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; "><colgroup><col /><col /><col /></colgroup><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>HTTP method</strong></span></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>URL</strong></span></p></td><td style="border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>Action</strong></span></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">GET</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">http://host/resource</code></p></td><td style="border-bottom: 0.5pt solid ; "><p>Get all the resource representations</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">GET</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">http://host/resource/1</code></p></td><td style="border-bottom: 0.5pt solid ; "><p>Get the resource with an ID of <code class="literal">1</code></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">POST</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">http://host/resource</code></p></td><td style="border-bottom: 0.5pt solid ; "><p>Create a new resource from the form data in the <code class="literal">POST</code></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">PUT</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">http://host/resource/1</code></p></td><td style="border-bottom: 0.5pt solid ; "><p>Modify the existing data of the resource with the ID of <code class="literal">1</code></p></td></tr><tr><td style="border-right: 0.5pt solid ; "><p><code class="literal">DELETE</code></p></td><td style="border-right: 0.5pt solid ; "><p><code class="literal">http://host/resource/1</code></p></td><td style=""><p>Delete the resource with the ID of <code class="literal">1</code></p></td></tr></tbody></table></div><p> </p><p>As an example, a response to the second <code class="literal">GET</code> request would look like the following:</p><pre class="programlisting">HTTP/1.0 200 OK
Content-Type: application/json
Content-Length: 1330
Server: Werkzeug/0.14.1 Python/2.7.10
Date: Thu, 19 Jul 2018 11:14:16 GMT

{ "id": 100, "title": "Some blog post title" }</pre><p>In RESTful APIs, it is also very important that we return the correct HTTP status code with the response data to notify the clients of what actually happened on the server without the clients resorting to parsing the returned message. Here is a list of the main HTTP codes that are used in RESTful APIs, along with their <span>meaning</span>:</p><div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; "><colgroup><col /><col /><col /></colgroup><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>HTTP code</strong></span></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>Name</strong></span></p></td><td style="border-bottom: 0.5pt solid ; "><p><span class="strong"><strong><span>Meaning</span></strong></span></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">200</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>OK</p></td><td style="border-bottom: 0.5pt solid ; "><p>The default code of HTTP. The request was successful, and the data was returned.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">201</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Created</p></td><td style="border-bottom: 0.5pt solid ; "><p>The request was successful, and a new resource was created on the server.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">204</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>No content</p></td><td style="border-bottom: 0.5pt solid ; "><p>The request was successful, but the response returned no content.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">400</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Bad request</p></td><td style="border-bottom: 0.5pt solid ; "><p>The request was denied because of some perceived client error—either it was a malformed request or it was missing the required data.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">401</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Unauthorized</p></td><td style="border-bottom: 0.5pt solid ; "><p>The request was denied because the client was not authenticated, and it should be authenticated before requesting this resource again.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">403</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Forbidden</p></td><td style="border-bottom: 0.5pt solid ; "><p>The request was denied because the client does not have permission to access this resource. This is in contrast to the <code class="literal">401</code> code, which assumes that the user is not authenticated. The <code class="literal">403</code> code says the resource is not accessible regardless of authentication.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">404</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Not found</p></td><td style="border-bottom: 0.5pt solid ; "><p>The requested resource does not exist.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">405</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Method not allowed</p></td><td style="border-bottom: 0.5pt solid ; "><p>The request was denied because the HTTP method is not available for the URL.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">500</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Internal server error</p></td><td style="border-bottom: 0.5pt solid ; "><p>The web server responds with this status code when it has encountered an unexpected condition that prevented it from fulfilling the request from the client.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">501</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Not implemented</p></td><td style="border-bottom: 0.5pt solid ; "><p>This error is shown when <span>it</span> does not support the functionality required to process the request. This is the appropriate response when the server does not recognize the request method.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">502</code></p><p> </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Bad gateway</p></td><td style="border-bottom: 0.5pt solid ; "><p>When the server is acting as a gateway or proxy and receives an invalid response from the upstream server.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">503</code></p><p> </p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Service unavailable</p></td><td style="border-bottom: 0.5pt solid ; "><p>Currently unable to handle the request because of temporary overloading or maintenance of the server. </p></td></tr><tr><td style="border-right: 0.5pt solid ; "><p><code class="literal">504</code></p></td><td style="border-right: 0.5pt solid ; "><p>Gateway timeout</p></td><td style=""><p>Did not receive a timely response from the upstream server.</p></td></tr></tbody></table></div></div></div>