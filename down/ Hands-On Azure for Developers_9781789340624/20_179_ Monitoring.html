<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch20lvl1sec168"></a>Monitoring</h2></div></div><hr /></div><p>Besides routing traffic to a different endpoint, Azure <span>Traffic</span><a id="id325213580" class="indexterm"></a> Manager<span class="emphasis"><em> </em></span>offers some additional functionalities when it comes to monitoring. Besides the traditional <strong class="userinput"><code>Metrics </code></strong>blade, there is an extra feature available called <strong class="userinput"><code>Traffic view</code></strong>, which enables you to monitor. What is more, you can use many different built-in mechanisms (like <code class="literal">nslookup</code><span class="strong"><strong> </strong></span>in Windows OS), to check the current configuration of the service.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch20lvl2sec199"></a>Nslookup</h3></div></div></div><p>To use <code class="literal">nslookup</code>, you have to run the <span>command</span><a id="id325213544" class="indexterm"></a> line in Windows using your administrator account. Once it is loaded, enter the following command:</p><pre class="programlisting"><span class="strong"><strong>nslookup &lt;Traffic-Manager-DNS-name&gt;</strong></span></pre><p>After a moment, it should return a result showing the command resolution:</p><pre class="programlisting"><span class="strong"><strong>DNS request timed out.</strong></span>
<span class="strong"><strong>    timeout was 2 seconds.</strong></span>
<span class="strong"><strong>DNS request timed out.</strong></span>
<span class="strong"><strong>    timeout was 2 seconds.</strong></span>
<span class="strong"><strong>Non-authoritative answer:</strong></span>
<span class="strong"><strong>Name: waws-prod-db3-119.cloudapp.net</strong></span>
<span class="strong"><strong>Address: 40.85.74.227</strong></span>
<span class="strong"><strong>Aliases: handsonazure.trafficmanager.net</strong></span>
<span class="strong"><strong>         handsonazure02-eun-appservice.azurewebsites.net</strong></span>
<span class="strong"><strong>         waws-prod-db3-119.sip.azurewebsites.windows.net</strong></span></pre><p>As you can see, it points to the second instance of my application (<code class="literal">handsonazure02</code> hosted within the North Europe region). The reason why I got this response is that my primary endpoint was considered to be downgraded. Once it went back online, I ran the command once more and got a quite different response:</p><pre class="programlisting"><span class="strong"><strong>Name: waws-prod-am2-229.cloudapp.net</strong></span>
<span class="strong"><strong>Address: 104.40.250.100</strong></span>
<span class="strong"><strong>Aliases: handsonazure.trafficmanager.net</strong></span>
<span class="strong"><strong>         handsonazure01-euw-appservice.azurewebsites.net</strong></span>
<span class="strong"><strong>         waws-prod-am2-229.sip.azurewebsites.windows.net</strong></span></pre><p> </p><p>Now it returned the primary server (as expected, by using the <strong class="userinput"><code>Priority </code></strong>routing method).</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note232"></a>Note</h3><p>Remember that you have to wait a fixed amount time before all DNS changes will be propagated. The value can be configured in the <strong class="userinput"><code>Configuration</code></strong><span class="strong"><strong> </strong></span>blade by changing the <strong class="userinput"><code>DNS time to live</code></strong><span class="strong"><strong> </strong></span>field.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch20lvl2sec200"></a>Traffic view</h3></div></div></div><p><strong class="userinput"><code>Traffic view</code></strong><span class="strong"><strong> </strong></span>is an additional <span>monitoring</span><a id="id325115431" class="indexterm"></a> feature that enables you to check how the selected routing method works exactly at the DNS level. It gives you extra helpful information like:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">Real latency level</li><li style="list-style-type: disc">Volume of traffic</li><li style="list-style-type: disc">Users location</li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note233"></a>Note</h3><p>Remember that this feature takes up to 24 hours to propagate and gather all necessary information.</p></div><p>By default, the screen for this functionality looks such as the following:</p><div class="mediaobject"><img src="/graphics/9781789340624/graphics/febd1adf-352d-45ac-9e72-1ba4648199ff.png" /></div><p>Once the information is gathered, you can leverage a graphical representation of collected data, and better understand the behaviour of the selected routing method (and possibly improve it).</p><p> </p></div></div>