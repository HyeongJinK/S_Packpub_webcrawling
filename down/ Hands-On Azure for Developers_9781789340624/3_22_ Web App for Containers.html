<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch03lvl1sec28"></a>Web App for Containers</h2></div></div><hr /></div><p>You do not have to use AKS or ACI to leverage features of containers in Azure—currently, there is one <span>more</span><a id="id325453756" class="indexterm"></a> feature available that you can use to deploy web applications written in an unsupported language (such as Go). Web App for Containers is an extension to App Services that uses Linux under the hood with Docker to run a service built on a stack, which is not currently supported by Azure.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec27"></a>Creating a web app hosted in a container</h3></div></div></div><p>To create an App Service running with a Docker instance, you have to follow the very same steps from <a class="link" href="#" linkend="ch01">Chapter 1</a>, <span class="emphasis"><em>Azure App Service</em></span>, when we were discussing the creation of a <span>web</span><a id="id325453293" class="indexterm"></a> app using Azure Portal.</p><p> </p><p> </p><p>Once you reach the web app creation blade, take a look at the <strong class="userinput"><code>OS</code></strong><span class="strong"><strong> </strong></span>field:</p><div class="mediaobject"><img src="/graphics/9781789340624/graphics/9216dbcd-dde4-4fe2-9421-14e704c69fa9.png" /></div><p>As you can see, the <strong class="userinput"><code>Docker</code></strong><span class="strong"><strong> </strong></span>option is available. When you click on it, two more fields will need to be set:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><strong class="userinput"><code>App Service plan/Location</code></strong>: This is the same as with "traditional" App Services with one important note. When you select <strong class="userinput"><code>Docker</code></strong>, all App Service Plans you can choose from will be powered by the <strong class="userinput"><code>Linux</code></strong><span class="strong"><strong> </strong></span>operating system. This will impact both pricing and feature availability.</li><li style="list-style-type: disc"><strong class="userinput"><code>Configure container</code></strong>: When you select this option, you will see another screen with many different options depending on container settings. Currently, we have three different options to choose from—<strong class="userinput"><code>Single Container</code></strong>, <strong class="userinput"><code>Docker Compose</code></strong>, and <strong class="userinput"><code>Kubernetes</code></strong>. The latest two are currently in preview, but we will also cover them. For now, select <strong class="userinput"><code>Single Container</code></strong><span class="strong"><strong> </strong></span>and use the <strong class="userinput"><code>Quickstart</code></strong><span class="strong"><strong> </strong></span>option.</li></ul></div><p>Here you can find my configuration:</p><div class="mediaobject"><img src="/graphics/9781789340624/graphics/f7cb0c23-ca25-46dd-9c23-13c216fc52e3.png" /></div><p>Now, after clicking on <strong class="userinput"><code>Create</code></strong>, Azure finishes provisioning new resources after several seconds. After creation, go to the freshly created App Service and take a look at the blades on the left. You will see that some of them are disabled:</p><div class="mediaobject"><img src="/graphics/9781789340624/graphics/a41354e0-ee8c-4b43-aeb2-26270a353d09.png" /></div><p>As you can see, using Web <span>App</span><a id="id325128286" class="indexterm"></a> for Containers doesn't allow us to use features such as <strong class="userinput"><code>WebJobs</code></strong> or <strong class="userinput"><code>Application Insights</code></strong><span class="emphasis"><em>.</em></span> Yet, we are still able to scale an application, attach a custom domain, or set a backup. Notice that one more blade is available—<strong class="userinput"><code>Container settings</code></strong>. When you click on it, you will see the same screen as during App Service creation:</p><div class="mediaobject"><img src="/graphics/9781789340624/graphics/de7507ca-1024-4dd0-aa80-4a003510830f.png" /></div><p>Let's see what happens when we change the image for our container. Change the <strong class="userinput"><code>Image and optional tag</code></strong><span class="strong"><strong> </strong></span><strong class="userinput"><code>(eg 'image:tag')</code></strong><span class="strong"><strong> </strong></span>field to <code class="literal">appsvc/dotnetcore</code><span class="strong"><strong> </strong></span>and then click <strong class="userinput"><code>Save</code></strong>. After restarting an application, you should see a change in the visible logs:</p><div class="mediaobject"><img src="/graphics/9781789340624/graphics/c299477e-0dc6-4c3a-99c2-28ed4b641844.png" /></div><p>Also, you should see a success message when browsing your web application:</p><div class="mediaobject"><img src="/graphics/9781789340624/graphics/7b0de9f6-ea14-4412-8055-0b14b657bb8a.png" /></div><p>Now we will try to deploy our own code and see whether it works.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec28"></a>Deploying a custom application</h3></div></div></div><p>In this section, we will focus <span>on</span><a id="id325143086" class="indexterm"></a> creating and deploying a custom application to our Docker container in the web app. For the purpose of this exercise, we will reuse the container image from the previous part of this chapter where we were discussing ACI.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note52"></a>Note</h3><p>If you would like to prepare a brand new application, go through the steps defined in the <span class="emphasis"><em>Creating and deploying an application and container</em></span> section where we created a Docker image and pushed it to Azure Container Registry. </p></div><p>When you go once more to the <strong class="userinput"><code>Container settings</code></strong><span class="strong"><strong> </strong></span>blade, you can change <strong class="userinput"><code>Image source </code></strong>to three different options:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><strong class="userinput"><code>Azure Container Registry</code></strong>: It allows you to select images pushed to your own instance of ACR</li><li style="list-style-type: disc"><strong class="userinput"><code>Docker Hub</code></strong>: Provides access to all images available in this repository</li><li style="list-style-type: disc"><strong class="userinput"><code>Private registry</code></strong>: You can also define a private repository from which to deploy your images</li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip53"></a>Note</h3><p>Note that, if you use ACR, the two other sources will also point to ACR as it acts as your own private Docker Hub with your images.</p></div><p>Select the <strong class="userinput"><code>Azure Container Registry</code></strong> tab<strong class="userinput"><code> </code></strong>and fill in all required fields as suggested by the portal:</p><div class="mediaobject"><img src="/graphics/9781789340624/graphics/611182d8-1ae2-41a9-ae37-37c233445bc7.png" /></div><p> </p><p> </p><p>After a moment, a new image <span>should</span><a id="id325217507" class="indexterm"></a> be reloaded and working. If you browse to the URL of your application, you should be able to see changes:</p><div class="mediaobject"><img src="/graphics/9781789340624/graphics/173589ff-3289-42d3-ac44-808a0ac51aec.png" /></div><p>As you can see, the very same container image I used while working with ACI is fully functional here in Web App for Containers.</p></div></div>