<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch06lvl1sec55"></a>Rich content notifications</h2></div></div><hr /></div><p>In the last section of this chapter, we will talk a bit about another type of notification, which is called <span class="strong"><strong>rich content notification</strong></span>. Sometimes you would like to send something <span>more</span><a id="id325117153" class="indexterm"></a> than plain text. In Notification Hub, it is possible to send, for example, an image to enhance the look and feel of an application.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note88"></a>Note</h3><p>Please note that receiving rich content notifications requires making changes on the client side. We will not cover that in this chapter but, at the end of it, you will find a link where such an operation is described in detail.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec52"></a>Creating and sending a rich content notification</h3></div></div></div><p>To create and send a rich <span>content</span><a id="id325117139" class="indexterm"></a> notification, you will <span>need</span><a id="id325115453" class="indexterm"></a> two things:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">A model of a notification</li><li style="list-style-type: disc">The notification payload and content</li></ul></div><p>The idea is to send it in a way that will enable a client application to fetch rich content and handle it on its side. In fact, the simplest way to do so would be to have an API that provides two operations:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">Send a notification</li><li style="list-style-type: disc">Fetch notification data</li></ul></div><p>In the following, you can find example code for both actions:</p><pre class="programlisting">public class HubController : ApiController
{
  public static Lazy&lt;NotificationHubClient&gt; Hub = new Lazy&lt;NotificationHubClient&gt;(() =&gt;
    NotificationHubClient.CreateClientFromConnectionString("&lt;connection string&gt;", "&lt;hub&gt;"));

  [HttpPost]
  public async Task&lt;HttpResponseMessage&gt; Send()
  {
    var notification = new Notification("Hey, check this out!");
    var fullNotification = "{\"aps\": {\"content-available\": 1, \"sound\":\"\"}, \"richId\": \"" + notification.Id +
            "\", \"richMessage\": \"" + notification.Message + "\", \"richType\": \"" +
            notification.RichType + "\"}";

    await Hub.Value.SendAppleNativeNotificationAsync(fullNotification, "&lt;tag&gt;");
    return Request.CreateResponse(HttpStatusCode.OK);
  }

  public HttpResponseMessage Get(string id)
  {
    var image = Notification.ReadImage(id);
    var result = new HttpResponseMessage(HttpStatusCode.OK) {Content = new StreamContent(image)};
    result.Content.Headers.ContentType = new System.Net.Http.Headers.MediaTypeHeaderValue("image/{png}");

    return result;
  }
}</pre><p>As you can see, the only thing we have to do is to keep the correct schema for sending a notification to a particular PNS. In the previous example, I used APNS but, of course, it is possible for other vendors (as long as their software supports receiving images or audio through push notifications). You can find the example in the source code for this chapter.</p></div></div>