<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch16lvl1sec135"></a>Differences between Microsoft SQL Server and Azure SQL</h2></div></div><hr /></div><p><span class="strong"><strong>Microsoft SQL Server</strong></span> is a well-known and widely used <span>SQL</span><a id="id326398824" class="indexterm"></a> database server that has <span>gained</span><a id="id325128370" class="indexterm"></a> much popularity and is considered a default choice for many projects ranging from very simple websites to enterprise-class services that handle high load and are considered critical for a business. As cloud technologies gain more and more popularity, the natural consequence of such a situation is the expectation that by moving an application to Azure, it is also possible to move its database. To meet such needs, Microsoft has developed Azure SQL<span class="emphasis"><em> </em></span>Service—a PaaS version of Microsoft SQL Server that is managed and upgraded by their teams; the only things you are responsible for are configuration and data management. There is also one more offering from Azure called SQL Server VMs, which is one more option for using this database in the cloud. In this section, we will focus on the differences between these two offerings and try to identify different use cases for them.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch16lvl2sec158"></a>Azure SQL fundamentals</h3></div></div></div><p>By using PaaS services in the cloud, you are <span>shifting</span><a id="id325128388" class="indexterm"></a> responsibilities a little bit:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">You are no longer the maintainer of the infrastructure</li><li style="list-style-type: disc">You are no longer responsible for different updates when software is considered</li><li style="list-style-type: disc">By signing SLA with you, your provider is responsible for making sure that a service is up and running</li></ul></div><p>Instead, you should focus on the following points:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">Properly configuring a service, so it meets your performance targets and legal requirements</li><li style="list-style-type: disc">Integrating different services and applications, so they reflect the best practices when it comes to communicating with a service</li><li style="list-style-type: disc">Implementing HA/DR scenarios, so an outage or disaster in one region does not impact your systems</li></ul></div><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p>By using Microsoft SQL Server, you are fully on your/leased machines, which you have to maintain and monitor. While such a case is valid in many scenarios (as there can be some legal requirements that disallow you from storing data outside your own data center or simply, for some reason, Azure does not provide you with the expected performance you seek), yet in many situations, having a PaaS instance of your SQL database is a big improvement. In fact, you are given a few different options when using this service:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">A single database with isolated resources</li><li style="list-style-type: disc">A pooled database in an elastic pool</li><li style="list-style-type: disc">Managed instance, which is the closest model when it comes to comparing it with on-premise SQL Server</li></ul></div><p>The important thing to know is that all new features and updates are deployed to SQL databases hosted within Azure. This gives you an advantage in comparison with traditional Microsoft SQL Server, as you are always up to date: you do not have to schedule updates on your servers on your own.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip183"></a>Note</h3><p>The more servers and databases you have, the more complicated and difficult the process of updating them becomes. Take that into account when comparing these two offerings.</p></div><p>Another crucial thing when talking about Azure SQL<span class="emphasis"><em> </em></span>is its purchasing model. Currently, you have two options:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><span class="strong"><strong>DTU-based</strong></span>: A DTU is a mix of computing, memory, and I/O <span>resources</span><a id="id325181934" class="indexterm"></a> that are given to your database</li><li style="list-style-type: disc"><span class="strong"><strong>vCore-based</strong></span>: This one simply allows you to <span>select</span><a id="id325181948" class="indexterm"></a> all things on your own (including the number of vCores, the amount of memory, and storage performance)</li><li style="list-style-type: disc"><p> </p></li></ul></div><p>You may wonder how a DTU reflects the actual hardware; there is a good article that tries to explain these metrics a little bit in the <span class="emphasis"><em>Further reading</em></span><span class="strong"><strong> </strong></span>section for this chapter.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip184"></a>Note</h3><p>In most cases, using DTU as the metric is the better choice—very often it is hard to predict the exact hardware requirements for your application. Use the vCore-based model when you are an advanced SQL server user and know how many cores or memory you really need.</p></div><p>You may wonder, What are the scaling capabilities of Azure SQL<span class="emphasis"><em> </em></span>Service? While of course you can assign more (or fewer) resources to your database, there are scenarios when this makes things much more complicated (or simply your application has different demands when it comes to database performance, and such a model simply will not work). To cover those situations, you are given the option to use elastic pools. The concept is pretty simple—normally you allocate resources to a single database:</p><div class="mediaobject"><img src="/graphics/9781789340624/graphics/945f2314-5a09-47c8-8119-5e135140324f.png" /></div><p>With elastic pools, you change the model a little bit and instead your pool has resources allocated, as follows:</p><div class="mediaobject"><img src="/graphics/9781789340624/graphics/a6f3787d-f338-4274-b2fa-3307f0ec0c7b.png" /></div><p>What does that change? Well, this gives you much more flexibility; instead of hosting a huge single database (when it comes to resources allocated), you can easily scale it out, so it can share the load with other instances. What is more, it gives you better control when it comes to costs; you can scale your databases at the same time without the need to control what their individual needs are.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note185"></a>Note</h3><p>Scaling Azure SQL<span class="emphasis"><em> </em></span>is an important topic that requires initially much attention—we will come back to it at the end of this chapter.</p></div><p>Besides performance and different scaling capabilities, Azure SQL<span class="emphasis"><em> </em></span>gives you many additional features that are very important when considering it as storage for your data. Because an <span>application</span><a id="id325194173" class="indexterm"></a> without information stored in a database is, in most cases, useless, availability considerations are also very important here. Fortunately, Azure SQL<span class="emphasis"><em> </em></span>has implemented many great features that make it a full-fledged storage option:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><span class="strong"><strong>Automatic backups</strong></span>: In the on-premise world, configuring and managing backups is much more complicated, as it requires you to know the server configuration and find a place to store them. In Azure, things are greatly simplified by integrating automatic backups for Azure Storage for performance and reliability.</li><li style="list-style-type: disc"><span class="strong"><strong>Geo-replication</strong></span>: Even if a single region fails, you can still serve data for your customers. With Azure SQL,<span class="emphasis"><em> </em></span>you can configure a secondary read region that will make sure you can stay online until an outage is resolved.</li><li style="list-style-type: disc"><span class="strong"><strong>Failover groups</strong></span>: Instead of implementing failover capabilities and logic on your own, you can rely on what Azure SQL<span class="emphasis"><em> </em></span>currently provides. This makes creating globally <span>distributed</span><a id="id325215556" class="indexterm"></a> applications much easier as you care only about the configuration and not infrastructure.</li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note186"></a>Note</h3><p>To know exactly what is different in Azure SQL<span class="emphasis"><em> </em></span>in comparison with Microsoft SQL Server, you can refer to the following link : <a class="ulink" href="https://docs.microsoft.com/en-us/azure/sql-database/sql-database-features" target="_blank">https://docs.microsoft.com/en-us/azure/sql-database/sql-database-features</a>.</p></div><p> </p><p> </p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch16lvl2sec159"></a>Advanced Azure SQL features</h3></div></div></div><p>Besides some basic functionalities that <span>ensure</span><a id="id325215590" class="indexterm"></a> Azure SQL<span class="emphasis"><em> </em></span>is a full version of a relational database on which you can rely and build your system, there are plenty of additional features that make using this service real fun:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><span class="strong"><strong>Automatic monitoring and tuning</strong></span>: How many times, after using a database for several months, have you ended up with a database full of outdated indexes, procedures, and functions? Azure SQL<span class="emphasis"><em> </em></span>makes things much easier by actively monitoring how you use and maintain your database and advising you whenever an improvement is possible. I find this feature extremely helpful—nowadays, when development is especially rapid and focused on delivering new values to the market, it is really easy to get lost and lose track of what should be removed from a database. With the service recommendations for dropping indexes, schema improvements, and queries parameterization, I find my storage in much better shape for most of the time.</li><li style="list-style-type: disc"><span class="strong"><strong>Adaptive query processing</strong></span>: While this feature is also available for SQL Server, having it in Azure SQL<span class="emphasis"><em> </em></span>is a great addition to other performance recommendations. Basically, when it is enabled, the server engine tries to find the best execution plan for your queries.</li><li style="list-style-type: disc"><span class="strong"><strong>Security and compliance features</strong></span>: It is really important to ensure that the data you store is secure and all vulnerabilities are detected as quickly as possible. In Azure SQL,<span class="emphasis"><em> </em></span>you are given plenty of additional features that try to analyze your data in terms of sensitivity and compliance. There are in-built tools which search for any kind of anomalies and threats that could affect data integrity or lead to their leak. Additionally, Azure SQL<span class="emphasis"><em> </em></span>is integrated with the Azure <span class="strong"><strong>Active Directory</strong></span> (<span class="strong"><strong>AD</strong></span>)<span class="emphasis"><em> </em></span>and allows for <span class="strong"><strong>multi-factor authentication</strong></span> (<span class="strong"><strong>MFA</strong></span>)—this makes things such as <span>auditing</span><a id="id325216043" class="indexterm"></a> and authorization <span>much</span><a id="id325216050" class="indexterm"></a> easier without additional effort.</li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note187"></a>Note</h3><p>The security features for Azure SQL<span class="emphasis"><em> </em></span>will be described later in this chapter so you have the whole picture of this service's capabilities that matter.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch16lvl2sec160"></a>SQL Server on VMs</h3></div></div></div><p>If you do not want to go full PaaS, you <span>can</span><a id="id325310669" class="indexterm"></a> create a virtual machine with a SQL Server image already in-built. In that option, the performance of the service will rely on the performance of the VM—if you find the database running low on CPU or memory, the only thing you have to do is to scale up the machine. To create a VM in the portal, you have to search for a SQL Server running on an OS of your choice, as follows:</p><div class="mediaobject"><img src="/graphics/9781789340624/graphics/0d2ce5e1-9622-4da3-abf9-3660e5493354.png" /></div><p>As you can see, there are free SQL Server licenses available and what is more, newer versions can run on Linux machines. Once you select the image you are interested in, you can click on the <strong class="userinput"><code>Create</code></strong><span class="strong"><strong> </strong></span>button to begin the machine's configuration.</p><p> </p><p>As you can see in the following screenshot, there are many fields which have to be filled in to be able to actually use the service:</p><div class="mediaobject"><img src="/graphics/9781789340624/graphics/d2b219f2-e8ea-4ec7-8ab9-33df6330d75e.png" /></div><p>This is, of course, related to the IaaS model of that way of hosting <span>SQL</span><a id="id325310855" class="indexterm"></a> Server inside Azure. The configuration wizard will advise you about the default size of the VM and other parameters required for the machine. Once the configuration is completed, you will be able to connect to it either via RDP or a secured SSH tunnel.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip188"></a>Note</h3><p>Remember to open the <code class="literal">1433</code>port if you want to connect to SQL Server remotely.</p></div></div></div>