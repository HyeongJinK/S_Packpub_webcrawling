<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch07lvl1sec61"></a>Configuring the local environment for developing Azure Functions</h2></div></div><hr /></div><p>To get started with Azure Functions, we will need an environment that will allow us to test our functions and start developing them quickly and seamlessly. Fortunately, this particular Azure <span>service</span><a id="id325326256" class="indexterm"></a> comes with multiple tools that help us during programming and running them locally. I will describe some extra applications as well, which should help you analyze and debug possible problems and test triggers before deploying to the cloud.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec56"></a>Starting with Azure Functions locally</h3></div></div></div><p>If you have installed all of the <span>required</span><a id="id325326243" class="indexterm"></a> software mentioned at the beginning of this chapter, you should be able to start developing them without any additional configuration. To get started, we will create a simple function that we will try to run to make sure that everything is set and ready.</p><p> </p><p>When you open your Visual Studio instance, click on <strong class="userinput"><code>File</code></strong> | <strong class="userinput"><code>New Project</code></strong>. In the new screen, search for the <strong class="userinput"><code>Cloud</code></strong> | <strong class="userinput"><code>Azure Functions</code></strong> template:</p><div class="mediaobject"><img src="/graphics/9781789340624/graphics/837ffce4-4840-469d-ba21-a9f38b6e4adc.png" /></div><p>This is the first step that will ensure that everything on your side is configured correctly. When you click <strong class="userinput"><code>OK</code></strong>,<strong class="userinput"><code> </code></strong>you will see another screen that lets you select a few different things:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><span class="strong"><strong>Runtime version</strong></span>: You can choose between <strong class="userinput"><code>v1</code></strong> and <strong class="userinput"><code>v2</code></strong>. In this book, we will focus on <strong class="userinput"><code>v1</code></strong> as <strong class="userinput"><code>v2</code></strong> is still in preview.</li><li style="list-style-type: disc"><span class="strong"><strong>Trigger type</strong></span>: Depending on the SDK version you have, you will have different options available. Of course, this is not the full list of available triggers for Azure Functions.</li><li style="list-style-type: disc"><span class="strong"><strong>Storage Account</strong></span>: Most functions require a storage account to work. Fortunately, you can use <strong class="userinput"><code>Storage Emulator</code></strong> locally, which is a simple database running under the <code class="literal">LocalDB</code> instance that's installed on your computer.
</li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note96"></a>Note</h3><p>A new version of SDK for Azure should install <strong class="userinput"><code>Storage Emulator</code></strong> automatically. If, for some reason, you are missing it, go to the following page and install the missing component: <a class="ulink" href="https://docs.microsoft.com/en-us/azure/storage/common/storage-use-emulator#get-the-storage-emulator" target="_blank">https://docs.microsoft.com/en-us/azure/storage/common/storage-use-emulator#get-the-storage-emulator</a>.</p></div><p>For the purpose of this exercise, I chose <strong class="userinput"><code>Http trigger</code></strong> and left all of the <span>fields</span><a id="id325115414" class="indexterm"></a> with their default values:</p><div class="mediaobject"><img src="/graphics/9781789340624/graphics/b42e502a-9abc-4fed-837c-b16f5bad7067.png" /></div><p>When you click <strong class="userinput"><code>OK </code></strong>and wait for a second, you will see that a new function file has been created with some boilerplate code already inserted. Since I will explain both creating a function and its features in the next section, I will not explain this in detail at this moment. To make sure that everything is working correctly, press <span class="emphasis"><em>F5</em></span> and wait until the project is compiled. You will notice two things:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><strong class="userinput"><code>Storage Emulator</code></strong> will be started in the background to handle function requests</li><li style="list-style-type: disc">A new window with the console application will open, displaying some diagnostic messages regarding Azure Functions</li></ul></div><p> </p><p>The former is the actual Azure Functions runtime, which handles the whole work when you communicate with your functions. Here, you can see how it looks on my computer:</p><div class="mediaobject"><img src="/graphics/9781789340624/graphics/5c16bf6c-e54e-4d58-9277-dab6b9b82744.png" /></div><p>It's important to notice a few things:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">It displays under which port the runtime listens to incoming requests</li><li style="list-style-type: disc">It tells you from which location the configuration file is fetched and loaded</li><li style="list-style-type: disc">It notifies you about loaded custom extensions (as I said, it is possible to <span>introduce</span><a id="id325117148" class="indexterm"></a> custom bindings, which will be loaded in the runtime)</li><li style="list-style-type: disc">It displays the names (and URLs, in the case of HTTP triggers) of all found functions</li></ul></div><p>When you scroll down, you should be able to see an endpoint to the function you have just created:</p><div class="mediaobject"><img src="/graphics/9781789340624/graphics/82d847b6-1c31-44ae-9cc4-24ecf0887fe4.png" /></div><p>Now, we will try to call it to see whether it works (I am using Postman, but you can use any kind of tool you are familiar with):</p><div class="mediaobject"><img src="/graphics/9781789340624/graphics/04652a07-9f9f-478b-a7be-a9df71044655.png" /></div><p>As you can see, it works—it returned a result (though the result itself is not a success—we are missing a required field, but that is not an issue right now). If you send the same request, you should be able to see the same result. If, for some reason, you are unable to do so, do the following:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">Make sure that your function's host is still working and that it displays no error</li><li style="list-style-type: disc">Make sure that the port under which the runtime listens for incoming requests is open</li><li style="list-style-type: disc">Make sure that the Azure Functions CLI is not blocked by your firewall</li><li style="list-style-type: disc">Make sure that you are calling the correct endpoint</li></ul></div><p>In the next section, I will describe the function's structure in detail so that you will be able to proceed with more advanced scenarios and features.</p></div></div>