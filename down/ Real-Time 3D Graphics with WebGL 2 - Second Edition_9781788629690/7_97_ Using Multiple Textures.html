<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch07lvl1sec102"></a>Using Multiple Textures</h2></div></div><hr /></div><p>So far, we've done all of our <span>rendering</span><a id="id325357458" class="indexterm"></a> by using a single texture. However, there are times when we may want to have multiple textures contribute to a fragment to create more complex effects. In such cases, we can use WebGL's ability to access multiple textures in a single draw call, commonly referred to as <span class="strong"><strong>multi-texturing</strong></span>.</p><p>We briefly covered multi-texturing earlier, so let's go back and look at it again. When talking about exposing a texture to a shader as a sampler uniform, we used the following code:</p><pre class="programlisting">gl.activeTexture(gl.TEXTURE0);
gl.bindTexture(gl.TEXTURE_2D, texture);</pre><p>The first line, <code class="literal">gl.activeTexture</code>, is the key to <span>utilizing</span><a id="id325358947" class="indexterm"></a> multi-texturing. We use it to tell the WebGL state machine which texture we're going to use in subsequent texture functions. In this case, we passed <code class="literal">gl.TEXTURE0</code>, which means that any following texture calls (such as <code class="literal">gl.bindTexture</code>) will alter the state of the first texture unit. If we want to attach a different texture to the second texture unit, we would use <code class="literal">gl.TEXTURE1</code> instead.</p><p>Different devices will support different numbers of texture units, but WebGL specifies that compatible hardware must always support at least two texture units. We can find out how many texture units the current device supports with the following function call:</p><pre class="programlisting">gl.getParameter(gl.MAX_COMBINED_TEXTURE_IMAGE_UNITS);</pre><p>WebGL provides explicit enumerations for <code class="literal">gl.TEXTURE0</code> through <code class="literal">gl.TEXTURE31</code>. It may be more convenient to specify the texture unit programmatically or find a need to refer to a texture unit above <code class="literal">31</code>. In such situations, you can always substitute <code class="literal">gl.TEXTURE0 + i</code> for <code class="literal">gl.TEXTUREi</code>, as in the following example:</p><pre class="programlisting">gl.TEXTURE0 + 2 === gl.TEXTURE2;</pre><p>Accessing multiple textures in a shader is as simple as declaring multiple samplers:</p><pre class="programlisting">uniform sampler2D uSampler;
uniform sampler2D uOtherSampler;</pre><p>When setting up your draw call, tell the shader which texture is associated with which sampler by providing the texture unit to <code class="literal">gl.uniform1i</code>. The code to bind two textures to the samplers above would look something like this:</p><pre class="programlisting">// bind the first texture
gl.activeTexture(gl.TEXTURE0);
gl.bindTexture(gl.TEXTURE_2D, texture);
gl.uniform1i(program.uSampler, 0);

// bind the second texture
gl.activeTexture(gl.TEXTURE1);
gl.bindTexture(gl.TEXTURE_2D, otherTexture);
gl.uniform1i(program.uOtherSampler, 1);</pre><p>We now have two textures available for our fragment shader, but what do we want to do with them?</p><p>As an example, we're going to implement a simple multi-texture effect that layers another texture on top of a simple textured cube to simulate static lighting.</p></div>