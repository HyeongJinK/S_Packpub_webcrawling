<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch02lvl1sec32"></a>Advanced Geometry-Loading Techniques</h2></div></div><hr /></div><p>So far, we’ve rendered very simple objects. Now, let's investigate how to load a geometry (vertices and indices) from a file instead of <span>declaring</span><a id="id325357458" class="indexterm"></a> the vertices and indices every time we call <code class="literal">initBuffers</code>. To do this, we will make asynchronous calls to the web server using AJAX. We will retrieve the file with our geometry from the web server and then use the built-in JSON parser to convert the context of our files into JavaScript objects. In our case, these objects will be the vertices and indices arrays.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec32"></a>Introduction to JavaScript Object Notation (JSON)</h3></div></div></div><p><span class="strong"><strong>JSON</strong></span> stands for <span class="strong"><strong>JavaScript Object Notation</strong></span>. It is a lightweight, text-based, open <span>format</span><a id="id325359401" class="indexterm"></a> used for data interchange. JSON is <span>commonly</span><a id="id325617373" class="indexterm"></a> used as an alternative to XML.</p><p>The power of JSON is that it's language-agnostic. This means that there are parsers in many languages to read and interpret JSON objects. Also, JSON is a subset of the object literal notation of JavaScript. Therefore, we can define JavaScript objects using JSON.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec33"></a>Defining JSON-Based 3D Models</h3></div></div></div><p>Let's assume, for example, that we <span>have</span><a id="id325617388" class="indexterm"></a> a model object with two arrays: vertices and indices. Say that these arrays contain the information described in the <span>cone</span><a id="id325631834" class="indexterm"></a> example (<code class="literal">ch02_06_cone.html</code>), as follows:</p><pre class="programlisting">function initBuffers() {
const vertices = [
1.5, 0, 0,
-1.5, 1, 0,
-1.5, 0.809017, 0.587785,
-1.5, 0.309017, 0.951057,
-1.5, -0.309017, 0.951057,
-1.5, -0.809017, 0.587785,
-1.5, -1, 0,
-1.5, -0.809017, -0.587785,
-1.5, -0.309017, -0.951057,
-1.5, 0.309017, -0.951057,
-1.5, 0.809017, -0.587785
];

indices = [
0, 1, 2,
0, 2, 3,
0, 3, 4,
0, 4, 5,
0, 5, 6,
0, 6, 7,
0, 7, 8,
0, 8, 9,
0, 9, 10,
0, 10, 1
];

  // ...
}</pre><p>Following the JSON notation, we would represent these two arrays as an object, as follows:</p><pre class="programlisting">{
"vertices": [
1.5, 0, 0,
-1.5, 1, 0,
-1.5, 0.809017, 0.587785,
-1.5, 0.309017, 0.951057,
-1.5, -0.309017, 0.951057,
-1.5, -0.809017, 0.587785,
-1.5, -1, 0,
-1.5, -0.809017, -0.587785,
-1.5, -0.309017, -0.951057,
-1.5, 0.309017, -0.951057,
-1.5, 0.809017, -0.587785
],
"indices": [
0, 1, 2,
0, 2, 3,
0, 3, 4,
0, 4, 5,
0, 5, 6,
0, 6, 7,
0, 7, 8,
0, 8, 9,
0, 9, 10,
0, 10, 1
]
}</pre><p>Based on this example, we can infer the following syntax rules:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">The extent of a JSON object is defined by curly brackets (<code class="literal">{}</code>).</li><li style="list-style-type: disc">Attributes in a JSON object are separated by commas (<code class="literal">,</code>).</li><li style="list-style-type: disc">There is no comma after the last attribute.</li><li style="list-style-type: disc">Each attribute of a JSON object has two parts: a <span class="strong"><strong>key </strong></span>and a <span class="strong"><strong>value.</strong></span></li><li style="list-style-type: disc">The name of an attribute is enclosed by quotation marks (<code class="literal">""</code>).</li><li style="list-style-type: disc">Each attribute key is separated from its corresponding value with a colon (<code class="literal">:</code>).</li><li style="list-style-type: disc">Attributes of the array are defined in the same way you would define them in JavaScript.</li></ul></div></div></div>