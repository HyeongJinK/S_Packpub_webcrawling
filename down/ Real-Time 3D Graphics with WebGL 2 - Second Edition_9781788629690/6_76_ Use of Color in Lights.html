<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch06lvl1sec82"></a>Use of Color in Lights</h2></div></div><hr /></div><p>Colors are light properties. In <a class="link" href="#" linkend="ch03">Chapter 3</a>, <span class="emphasis"><em>Lights</em></span>, we <span>learned</span><a id="id325358935" class="indexterm"></a> that the number of light properties depends on the lighting-reflection model selected for a scene. For instance, using a Lambertian reflection model, we would only need to model one shader uniform: the light diffuse property/color. In contrast, if the Phong reflection model were selected, each light source would need to have three properties: the ambient, diffuse, and specular colors.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip63"></a>Note</h3><p><strong class="userinput"><code>Positional Lights</code></strong>
The light position is usually modeled as a uniform when the shader needs to know the position of the light. Therefore, a Phong model with a positional light would have four uniforms: ambient, diffuse, specular, and position.
For directional lights, the fourth uniform is the light direction. For more information, refer to <a class="link" href="#" linkend="ch03">Chapter 3</a>, <span class="emphasis"><em>Lights</em></span>.</p></div><p>We have seen that <span>each</span><a id="id325358962" class="indexterm"></a> light <span>property</span><a id="id325614928" class="indexterm"></a> is represented by a JavaScript four-element array with mappings to <code class="literal">vec4</code> uniforms in the shaders.</p><p>As a quick reminder, which WebGL methods should we use to retrieve and set a uniform? In our case, the two methods we use to pass lights to the shaders are as follows:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><code class="literal">getUniformLocation</code>: Locates the <span>uniform</span><a id="id325617271" class="indexterm"></a> in the program and returns an index we can use to set the value.</li><li style="list-style-type: disc"><code class="literal">uniform4fv</code>: Since the light <span>components</span><a id="id325617282" class="indexterm"></a> are RGBA, we need to pass a four-element float vector.</li></ul></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec107"></a>Scalability Problem</h3></div></div></div><p>Given the desire to use more than one <span>light</span><a id="id325617294" class="indexterm"></a> in our scene, we need to define and map the number of appropriate uniforms of the lighting model of choice. If we have four properties per light (ambient, diffuse, specular, and location), we need to define four uniforms for each light. If we want to have three lights, we <span>need</span><a id="id325617303" class="indexterm"></a> to write, use, and map twelve uniforms! We need to resolve this complexity before it gets out of hand.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch06lvl3sec30"></a>How Many Uniforms Can We Use?</h4></div></div></div><p>The OpenGL Shading Language ES specification delineates the number of uniforms that we are allowed to use.</p><div class="blockquote"><blockquote class="blockquote"><p><span class="emphasis"><em><strong class="userinput"><code>Section 4.3.4 Uniforms</code></strong>
There is an implementation dependent limit on the amount of storage for uniforms that can be used for each type of shader. If this is exceeded, it will cause a compile-time or link-time error.</em></span></p></blockquote></div><p>To find out the limit for your WebGL implementation, you can query WebGL using the <code class="literal">gl.getParameter</code> function with these constants:</p><pre class="programlisting">gl.MAX_VERTEX_UNIFORM_VECTORS
gl.MAX_FRAGMENT_UNIFORM_VECTORS</pre><p>The implementation limit is given by your browser and heavily depends on your graphics hardware. That said, even though your machine may have enough variable space, it does not necessarily mean that the problem is solved. We still have to define and map each of the uniforms and that can often lead to brittle and verbose code, as we will see in a later exercise.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch06lvl3sec31"></a>Simplifying the Problem</h4></div></div></div><p>In order to simplify the problem, we can <span>assume</span><a id="id325643404" class="indexterm"></a> that the ambient component is the same for all of the lights. This will reduce the number of uniformsâ€”one fewer uniform for each light. However, this is not an extensible solution for more general cases where we cannot assume that the ambient light is constant.</p><p>Before we start diving deeper into our scene with multiple lights, let's update our architecture to cover some of the concepts we've addressed.</p></div></div></div>