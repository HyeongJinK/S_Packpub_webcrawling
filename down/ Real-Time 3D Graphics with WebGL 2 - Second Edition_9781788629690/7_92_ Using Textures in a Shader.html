<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch07lvl1sec97"></a>Using Textures in a Shader</h2></div></div><hr /></div><p>Texture coordinates are <span>exposed</span><a id="id325358908" class="indexterm"></a> to the shader code in the same way that they are with any other vertex attribute. We'll want to include a two-element vector attribute in our vertex shader that will map to our texture coordinates:</p><pre class="programlisting">in vec2 aVertexTextureCoords;</pre><p>Additionally, we will also want to add a new uniform to the fragment shader that uses a type we haven't seen before: <code class="literal">sampler2D</code>. The <code class="literal">sampler2D</code> uniform is what allows us to access the texture data in the shader:</p><pre class="programlisting">uniform sampler2D uSampler;</pre><p>In the past, when we've used uniforms, we set them to the value that we want them to be in the shader, such as a light color. <span class="strong"><strong>Samplers</strong></span> work a bit differently. The following code shows how to associate a texture with a specific sampler uniform:</p><pre class="programlisting">gl.activeTexture(gl.TEXTURE0);
gl.bindTexture(gl.TEXTURE_2D, texture);
gl.uniform1i(program.uSampler, 0);</pre><p>So, what's going on here? First off, we are changing the active texture index with <code class="literal">gl.activeTexture</code>. WebGL supports the use of multiple textures at once (which we'll talk about later in this chapter), so it's good practice to specify which texture index we're working with, even though it won't change for the duration of this program. Next, we bind the texture we wish to use, which associates it with the currently active texture, <code class="literal">TEXTURE0</code>. Finally, we tell the sampler uniform which texture it should be associated with given the texture unit provided via <code class="literal">gl.uniform1i</code>. Here, we give it <code class="literal">0</code> to indicate that the sampler should use <code class="literal">TEXTURE0</code>.</p><p>We are now ready to use our texture in the fragment shader! The simplest way to use a texture is to return its value as the fragment color, as shown here:</p><pre class="programlisting">texture(uSampler, vTextureCoord);</pre><p><code class="literal">texture</code> takes in the sampler uniform we wish to query and the coordinates to lookup, and returns the color of the texture image at those coordinates as <code class="literal">vec4</code>. If the image has no alpha channel, <code class="literal">vec4</code> will still be returned with the alpha component always set to <code class="literal">1</code>.</p></div>