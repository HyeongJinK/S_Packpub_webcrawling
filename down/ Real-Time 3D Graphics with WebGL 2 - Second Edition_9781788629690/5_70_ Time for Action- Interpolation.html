<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch05lvl1sec77"></a>Time for Action: Interpolation</h2></div></div><hr /></div><p>Let's cover an example showcasing various <span>interpolation</span><a id="id325358908" class="indexterm"></a> techniques:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Open <code class="literal">ch05_05_interpolation.html</code> using your browser. You should see something similar to the following:</li></ol></div><div class="mediaobject"><img src="/graphics/9781788629690/graphics/38dbcb43-ae57-4568-a918-4c4866a2aa7a.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Inspect the code in an editor. Nearly all of the functions are the same as before, except for the new function called <code class="literal">interpolate</code>. This function interpolates the position in a linear fashion:</li></ol></div><pre class="programlisting">function interpolate() {
const [X0, Y0, Z0] = initialPosition;
const [X1, Y1, Z1] = finalPosition;

const dX = (X1 - X0) / incrementSteps;
const dY = (Y1 - Y0) / incrementSteps;
const dZ = (Z1 - Z0) / incrementSteps;

for (let i = 0; i &lt; incrementSteps; i++) {
    position.push([X0 + (dX * i), Y0 + (dY * i), Z0 + (dZ * i)]);
}
}</pre><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>Open up <code class="literal">ch05_06_interpolation-final.html</code> in your browser. You should see something similar to the following:</li></ol></div><div class="mediaobject"><img src="/graphics/9781788629690/graphics/fffcd381-d069-4a22-8333-74d0b17e05ff.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>Select <span class="strong"><strong>Linear</strong></span> interpolation if it is not already selected.</li><li>Move the start and end points using the slider provided.</li><li>Change the number of <span>interpolation</span><a id="id325617272" class="indexterm"></a> steps. What happens to the animation when you decrease the number of steps?</li><li>The code for the linear interpolation has been implemented in the <code class="literal">doLinearInterpolation</code> function.</li><li>Select <span class="strong"><strong>Polynomial</strong></span> interpolation. In this example, we have implemented Lagrange's interpolation method. You can see the source code in the <code class="literal">doLagrangeInterpolation</code> function.</li><li>Three new control points (flags) appear on screen. Using the sliders provided on the web page, you can change the location of these control points. You can also change the number of interpolation steps:</li></ol></div><div class="mediaobject"><img src="/graphics/9781788629690/graphics/3f226222-21c6-4929-b95c-69a30c8f98a0.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="10" type="1"><li>You may have also noticed that whenever the ball approaches one of the flags (with the exception of the start and end points), the flag changes color. To do that, we have written the ancillary <code class="literal">close</code> function. We use this function inside the <code class="literal">draw</code> routine to determine the color of the flags. If the current position of the ball, determined by <code class="literal">position[sceneTime]</code>, is close to one of the flag positions, the respective flag changes color. When the ball is far from the flag, the flag changes back to its original color.</li><li>Modify the source code so that each flag remains <span class="emphasis"><em>activated</em></span>; that is, activated with the new color after the ball passes by until the animation loops back to the beginning. This happens when <code class="literal">sceneTime</code> is equal to <code class="literal">incrementSteps</code> (see the <code class="literal">animate</code> function).</li><li>Select the <span class="strong"><strong>B-Spline</strong></span> interpolation. Notice how the ball does not reach any of the intermediate flags in the initial configuration. Is there any configuration you can test so that the ball passes through at least two of the flags?</li></ol></div><p><span class="emphasis"><em><span class="strong"><strong>What just happened?</strong></span></em></span></p><p>Weâ€™ve learned how to use <span>interpolation</span><a id="id325643488" class="indexterm"></a> to describe the movement of an object in our 3D world. We've also created very simple scripts to detect object proximity and alter our scene accordingly (changing flag colors, in this example). Reaction to proximity is a key element in game design!</p></div>