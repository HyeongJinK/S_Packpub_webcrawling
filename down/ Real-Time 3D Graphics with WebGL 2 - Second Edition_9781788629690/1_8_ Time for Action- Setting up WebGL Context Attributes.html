<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch01lvl1sec19"></a>Time for Action: Setting up WebGL Context Attributes</h2></div></div><hr /></div><p>In this example, we are going to learn to modify <span>the</span><a id="id325628670" class="indexterm"></a> color we use to clear the <code class="literal">canvas</code> element:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Using your favorite text editor, open the <code class="literal">ch01_03_attributes.html</code> file:</li></ol></div><pre class="programlisting">&lt;html&gt;
&lt;head&gt;
  &lt;title&gt;Real-Time 3D Graphics with WebGL2&lt;/title&gt;
  &lt;link rel="shortcut icon" type="image/png" 
   href="/common/images/favicon.png" /&gt;

  &lt;style&gt;
canvas {
border: 5px dotted blue;
}
&lt;/style&gt;

  &lt;script type="text/javascript"&gt;
'use strict';

let gl;

function updateClearColor(...color) {
// The ES6 spread operator (...) allows for us to
      // use elements of an array as arguments to a function
gl.clearColor(...color);
gl.clear(gl.COLOR_BUFFER_BIT);
gl.viewport(0, 0, 0, 0);
}

function checkKey(event) {
switch (event.keyCode) {
// number 1 =&gt; green
case 49: {
updateClearColor(0.2, 0.8, 0.2, 1.0);
break;
}
// number 2 =&gt; blue
case 50: {
updateClearColor(0.2, 0.2, 0.8, 1.0);
break;
}
// number 3 =&gt; random color
case 51: {
updateClearColor(Math.random(), Math.random(), 
           Math.random(), 1.0);
break;
}
// number 4 =&gt; get color
case 52: {
const color = gl.getParameter(gl.COLOR_CLEAR_VALUE);
// Don't let the following line confuse you.
          // It basically rounds up the numbers to one
          // decimal cipher for visualization purposes.

          // TIP: Given that WebGL's color space ranges
          // from 0 to 1 you can multiply these values by 255
          // to display in their RGB values.
alert(`clearColor = (
${color[0].toFixed(1)},
${color[1].toFixed(1)},
${color[2].toFixed(1)}
          )`);
window.focus();
break;
}
      }
    }

function init() {
const canvas = document.getElementById('webgl-canvas');

if (!canvas) {
        console.error('Sorry! No HTML5 Canvas was found on this page');
return;
}

      gl = canvas.getContext('webgl2');

const message = gl
        ? 'Hooray! You got a WebGL2 context'
: 'Sorry! WebGL is not available';

alert(message);

// Call checkKey whenever a key is pressed
window.onkeydown = checkKey;
}

    window.onload = init;
&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;

  &lt;canvas id="webgl-canvas" width="800" height="600"&gt;
Your browser does not support the HTML5 canvas element.
&lt;/canvas&gt;

&lt;/body&gt;
&lt;/html&gt;</pre><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>You will see that this file is similar to our previous example. However, there are new code constructs that we will explain briefly. This <span>file</span><a id="id325643396" class="indexterm"></a> contains three JavaScript functions:</li></ol></div><div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; "><colgroup><col /><col /></colgroup><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>Function</strong></span></p></td><td style="border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>Description</strong></span></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">updateClearColor</code></p></td><td style="border-bottom: 0.5pt solid ; "><p>Updates <code class="literal">clearColor</code> and then sets the <code class="literal">canvas</code> element clear color, which is one of the WebGL context attributes. As previously mentioned, WebGL works as a state machine. Therefore, it will maintain this color until it's changed using the <code class="literal">gl.clearColor</code> WebGL function (see the <code class="literal">checkKey</code> source code).</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">checkKey</code></p></td><td style="border-bottom: 0.5pt solid ; "><p>This is an auxiliary function that has been attached to the window <code class="literal">onkeydown</code> event. It captures the keyboard input and executes code depending on the key entered.</p></td></tr><tr><td style="border-right: 0.5pt solid ; "><p><code class="literal">init</code></p></td><td style=""><p>This function gets called on the document <code class="literal">onload</code> event. It obtains a WebGL context and sets it to the global <code class="literal">gl</code> variable.</p></td></tr></tbody></table></div><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>Open the <code class="literal">ch01_03_attributes.html</code>file in your browser.</li></ol></div><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>Press <span class="emphasis"><em>1</em></span>. You will see how the <code class="literal">canvas</code> changes its color to green. If you want to query the exact color used, press <span class="emphasis"><em>4</em></span>.</li><li>The <code class="literal">canvas</code> element will maintain the green color until we change it by calling <code class="literal">gl.clearColor</code>. Let's change it by pressing 2. If you look at the source code, this will change the <code class="literal">canvas</code> clear color to blue. If you want to know the exact color, press 4.</li><li>You can press <span class="emphasis"><em>3</em></span><span class="strong"><strong> </strong></span>to set the clear color to a random color. As before, you can get the color by pressing <span class="emphasis"><em>4</em></span><span class="emphasis"><em>:</em></span></li></ol></div><div class="mediaobject"><img src="/graphics/9781788629690/graphics/bda716a9-c9f1-4794-b5e3-6df4eb6d1495.png" /></div><p><span class="emphasis"><em><span class="strong"><strong>What just happened?</strong></span></em></span></p><p>In this example, we saw that we can change the color that WebGL uses to clear the <code class="literal">canvas</code> element by calling the <code class="literal">clearColor</code> function. Correspondingly, we used <code class="literal">getParameter(gl.COLOR_CLEAR_VALUE)</code> to obtain the current value of the <code class="literal">canvas</code> clear color.</p><p>Throughout this book, we will encounter similar constructs where specific functions establish attributes of the WebGL context while the <code class="literal">getParameter</code> function <span>retrieves</span><a id="id325647211" class="indexterm"></a> the current values for such attributes whenever the respective argument (in our example, <code class="literal">COLOR_CLEAR_VALUE</code>) is used.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec11"></a>Using the Context to Access the WebGL API</h3></div></div></div><p>It is essential to <span>note</span><a id="id325652487" class="indexterm"></a> that all of the WebGL functions are accessed through the WebGL context. In our examples, the context is being held by the <code class="literal">gl</code> variable. Therefore, any call to the WebGL API will be performed using this variable.</p></div></div>