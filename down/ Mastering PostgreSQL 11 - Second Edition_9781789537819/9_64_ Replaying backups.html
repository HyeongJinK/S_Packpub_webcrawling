<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch09lvl1sec64"></a>Replaying backups</h2></div></div><hr /></div><p>Having a backup is pointless unless you have tried to <span>actually</span><a id="id325863427" class="indexterm"></a> replay it. Fortunately, this is easy to do. If you have created a plain text backup, simply take the SQL file and execute it. The following example shows how that can be done:</p><pre class="programlisting"><span class="strong"><strong>psql your_db &lt; your_file.sql</strong></span></pre><p>A plain text backup is simply a text file containing everything. We can always simply replay a text file.</p><p>If you have decided on a custom format or directory format, you can use <code class="literal">pg_restore</code> to replay the backup. Additionally, <code class="literal">pg_restore</code> allows you to do all kinds of fancy things such as replaying just part of a database and so on. In most cases, however, you will simply replay the entire database. In this example, we will create an empty database and just replay a custom format dump:</p><pre class="programlisting"><span class="strong"><strong>[hs@linuxpc backup]$ createdb new_db</strong></span><span class="strong"><strong>[hs@linuxpc backup]$ pg_restore -d new_db -j 4 /tmp/dump.fc</strong></span></pre><p>Note that <code class="literal">pg_restore</code> will add data to an existing database. If your database is not empty, <code class="literal">pg_restore</code> might error out but continue.</p><p>Again, <code class="literal">-j</code> is used to throw up more than one process. In this example, four cores are used to replay the data; however, this only works when more than one table is being replayed. </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip72"></a>Note</h3><p>If you are using a directory format, you can simply pass the name of the directory instead of the file.</p></div><p>As far as performance is concerned, dumps are a good solution if you are working with small or medium amounts of data. There are two major downsides:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">We will get a snapshot, so everything since the last snapshot will be lost</li><li style="list-style-type: disc">Rebuilding a dump from scratch is <span>comparatively</span><a id="id325862957" class="indexterm"></a> slow compared to binary copies because all of the indexes have to be rebuilt</li></ul></div><p>We will take a look at binary backups in Chapter 10, <span class="emphasis"><em>Making Sense of Backups and Replication</em></span>.</p></div>