<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch02lvl1sec30"></a>Modules for data structures and algorithms</h2></div></div><hr /></div><p>In addition to the built-in types, there <span>are</span><a id="id326234982" class="indexterm"></a> several Python modules that we can use to <span>extend</span><a id="id326234976" class="indexterm"></a> the built-in types and functions. In many cases, these Python modules may <span>offer</span><a id="id326234549" class="indexterm"></a> efficiency <span>and</span><a id="id326234531" class="indexterm"></a> programming advantages that allow us to simplify our code.</p><p>So far, we have looked at the built-in datatypes of strings, lists, sets, and dictionaries as well as the <span>decimal</span><a id="id326234496" class="indexterm"></a> and fraction modules. They are often described by the term <span class="strong"><strong>Abstract </strong></span><span class="strong"><strong>Data Types</strong></span> (<span class="strong"><strong>ADTs</strong></span>). ADTs can be considered mathematical specifications for the set of operations that can be performed on data. They are defined by their behavior rather than their implementation. In addition to the ADTs that we have looked at, there are several Python libraries that provide extensions to the built-in datatypes. These will be discussed in the following section.</p><p> </p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec16"></a>Collections</h3></div></div></div><p>The <code class="literal">collections</code> module provides <span>more</span><a id="id326168366" class="indexterm"></a> specialized, high-performance alternatives for the built-in data types as well as a utility function to create named tuples. The following <span>table</span><a id="id326168230" class="indexterm"></a> lists the datatypes and operations of the collections module and their descriptions:</p><div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; "><colgroup><col /><col /></colgroup><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>Datatype or operation</strong></span></p></td><td style="border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>Description</strong></span></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">namedtuple()</code></p></td><td style="border-bottom: 0.5pt solid ; "><p>Creates tuple subclasses with named fields.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">deque</code></p></td><td style="border-bottom: 0.5pt solid ; "><p>Lists with fast appends and pops either end.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">ChainMap</code></p></td><td style="border-bottom: 0.5pt solid ; "><p>Dictionary-like class to create a single view of multiple mappings.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">Counter</code></p></td><td style="border-bottom: 0.5pt solid ; "><p>Dictionary subclass for counting hashable objects.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">OrderedDict</code></p></td><td style="border-bottom: 0.5pt solid ; "><p>Dictionary subclass that remembers the entry order.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">defaultdict</code></p></td><td style="border-bottom: 0.5pt solid ; "><p>Dictionary subclass that calls a function to supply missing values.</p></td></tr><tr><td style="border-right: 0.5pt solid ; "><p><code class="literal">UserDict UserList UserString</code></p></td><td style=""><p>These three data types are simply wrappers for their underlying base classes. Their use has largely been supplanted by the ability to subclass their respective base classes directly. Can be used to access the underlying object as an attribute.</p></td></tr></tbody></table></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch02lvl3sec3"></a>Deques</h4></div></div></div><p>Double-ended queues, or deques (usually pronounced <span class="emphasis"><em>decks</em></span>), are list-like objects that support thread-safe, memory-efficient appends. Deques are mutable and support <span>some</span><a id="id325837831" class="indexterm"></a> of the operations of lists, such as indexing. Deques can be assigned by index, for example, <code class="literal">dq[1] = z</code>; however, we <span>cannot</span><a id="id325837843" class="indexterm"></a> directly slice deques. For example, <code class="literal">dq[1:2]</code> results in <code class="literal">TypeError</code> (we will look at a way to return a slice from a deque as a list shortly).</p><p>The major advantage of deques over lists is that inserting items at the beginning of a deque is much faster than inserting items at the beginning of a list, although inserting items at the end of a deque is very slightly slower than the equivalent operation on a list. Deques are thread-safe and can be serialized using the <code class="literal">pickle</code> module.</p><p>A useful way of thinking about deques is in terms of <span>populating</span><a id="id325851491" class="indexterm"></a> and <span>consuming</span><a id="id325851497" class="indexterm"></a> items. Items in deques are usually populated and consumed sequentially from either end:</p><div class="mediaobject"><img src="/graphics/9781788995573/graphics/eb2f50f9-6a76-406c-ad0c-a07e3d5a7f92.png" /></div><p>We can use the <code class="literal">pop()</code>and <code class="literal">popleft()</code> methods for consuming items in the deque, as in the following example:</p><div class="mediaobject"><img src="/graphics/9781788995573/graphics/135b659f-23d7-465c-a723-cea1081a6088.png" /></div><p>We can also use the <code class="literal">rotate(n)</code> method to move and rotate all items of <code class="literal">n</code> steps to the right for positive values of the <code class="literal">n</code> integer or negative values of <code class="literal">n</code> steps to the left, using positive integers as the argument, as in the following example:</p><div class="mediaobject"><img src="/graphics/9781788995573/graphics/969f96d7-f0f4-4a79-b68e-33f5955a2ec7.png" /></div><p>Note that we can use the <code class="literal">rotate</code> and <code class="literal">pop</code> methods to delete selected elements. Also worth knowing is a simple way to return a slice of a deque, as a list, which can be done as follows:</p><div class="mediaobject"><img src="/graphics/9781788995573/graphics/d138ae29-bbc8-463a-83f4-0c93e914c560.png" /></div><p>The <code class="literal">itertools.islice()</code> method works in the same way that slice works on a list, except rather than taking a list for an argument, it takes an iterable and returns selected values, by start and stop indices, as a list.</p><p>A useful feature of deques is <span>that</span><a id="id325855582" class="indexterm"></a> they support a <code class="literal">maxlen</code> optional parameter that restricts the size of the deque. This makes it ideally suited to a data structure known as a <span class="strong"><strong>circular buffer</strong></span>. This is a fixed-size structure that is effectively connected end to end and they are typically used for buffering data streams. The following is a basic example:</p><pre class="programlisting">dq2=deque([],maxlen=3) 
for i in range(6):
    dq2.append(i) 
    print(dq2)</pre><p>This prints out the following:</p><div class="mediaobject"><img src="/graphics/9781788995573/graphics/f8e88106-0dee-49bf-85b6-efed34e322c7.png" /></div><p>In this example, we are populating from the right and consuming from the left. Notice that once the buffer is full the oldest values are consumed first and values are replaced from the right. We will look at circular buffers again in <a class="link" href="#" linkend="ch04">Chapter 4</a>, <span class="emphasis"><em>Lists and Pointer Structures</em></span>, when implementing circular lists.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch02lvl3sec4"></a>ChainMap objects</h4></div></div></div><p>The <code class="literal">collections.chainmap</code> class was added in Python 3.2, and it provides a way to link a number of dictionaries, or other mappings, so that they can be treated as one object. In addition, there is a <code class="literal">maps</code> attribute, a <code class="literal">new_child()</code> method, and a <code class="literal">parents</code> property. The underlying mappings for <code class="literal">ChainMap</code> objects are stored in a list <span>and</span><a id="id325896314" class="indexterm"></a> are accessible using the <code class="literal">maps[i]</code> attribute to retrieve the <code class="literal">ith</code> dictionary. Note that, even though dictionaries themselves are unordered, <code class="literal">ChainMap</code> objects are ordered lists of dictionaries.</p><p><code class="literal">ChainMap</code> is useful in applications where we are using a number of dictionaries containing related data. The <span>consuming</span><a id="id325896337" class="indexterm"></a> application expects data in terms of a priority, where the same key in two dictionaries is given priority if it occurs at the beginning of the underlying list. <code class="literal">ChainMap</code> is typically used to simulate nested contexts such as when we have multiple overriding configuration settings. The following example demonstrates a possible use case for <code class="literal">ChainMap</code>:</p><pre class="programlisting">&gt;&gt;&gt; import collections
&gt;&gt;&gt; dict1= {'a':1, 'b':2, 'c':3}
&gt;&gt;&gt; dict2 = {'d':4, 'e':5}
&gt;&gt;&gt; chainmap = collections.ChainMap(dict1, dict2)  # linking two dictionaries
&gt;&gt;&gt; chainmap
ChainMap({'a': 1, 'b': 2, 'c': 3}, {'d': 4, 'e': 5})
&gt;&gt;&gt; chainmap.maps
[{'a': 1, 'b': 2, 'c': 3}, {'d': 4, 'e': 5}]
&gt;&gt;&gt; chainmap.values
&lt;bound method Mapping.values of ChainMap({'a': 1, 'b': 2, 'c': 3}, {'d': 4, 'e': 5})
&gt;&gt;&gt;&gt; chainmap['b']   #accessing values 
2
&gt;&gt;&gt; chainmap['e']
5</pre><p>The advantage of using <code class="literal">ChainMap</code> objects, rather than just a dictionary, is that we retain previously set values. Adding a child context overrides values for the same key, but it does not remove it from the data structure. This can be useful when we may need to keep a record of changes so that we can easily roll back to a previous setting.</p><p>We can retrieve and change any value in any of the dictionaries by providing the <code class="literal">map()</code> method with an appropriate index. This index represents a dictionary in <code class="literal">ChainMap</code>. Also, we can retrieve the parent setting, that is, the default settings, by using the <code class="literal">parents()</code> method:</p><pre class="programlisting">&gt;&gt;&gt; from collections import ChainMap
&gt;&gt;&gt; defaults= {'theme':'Default','language':'eng','showIndex':True, 'showFooter':True}
&gt;&gt;&gt; cm= ChainMap(defaults)   #creates a chainMap with defaults configuration
&gt;&gt;&gt; cm.maps[{'theme': 'Default', 'language': 'eng', 'showIndex': True, 'showFooter': True}]
&gt;&gt;&gt; cm.values()
ValuesView(ChainMap({'theme': 'Default', 'language': 'eng', 'showIndex': True, 'showFooter': True}))
&gt;&gt;&gt; cm2= cm.new_child({'theme':'bluesky'}) # create a new chainMap with a child that overrides the parent.
&gt;&gt;&gt; cm2['theme']  #returns the overridden theme'bluesky'
&gt;&gt;&gt; cm2.pop('theme')  # removes the child theme value
'bluesky' 
&gt;&gt;&gt; cm2['theme']
'Default'
&gt;&gt;&gt; cm2.maps[{}, {'theme': 'Default', 'language': 'eng', 'showIndex': True, 'showFooter': True}]
&gt;&gt;&gt; cm2.parents
ChainMap({'theme': 'Default', 'language': 'eng', 'showIndex': True, 'showFooter': True})</pre></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch02lvl3sec5"></a>Counter objects</h4></div></div></div><p><code class="literal">Counter</code> is a subclass of a dictionary <span>where</span><a id="id325919501" class="indexterm"></a> each dictionary key is a hashable <span>object</span><a id="id326096213" class="indexterm"></a> and the associated value is an integer count of that object. There are three ways to initialize a counter. We can pass it any sequence object, a dictionary of <code class="literal">key:value</code> pairs, or a tuple of the format <code class="literal">(object=value,...)</code>, as in the following example:</p><pre class="programlisting">&gt;&gt;&gt; from collections import Counter
&gt;&gt;&gt; Counter('anysequence')
Counter({'e': 3, 'n': 2, 'a': 1, 'y': 1, 's': 1, 'q': 1, 'u': 1, 'c': 1})
&gt;&gt;&gt; c1 = Counter('anysequence')
&gt;&gt;&gt; c2= Counter({'a':1, 'c': 1, 'e':3})
&gt;&gt;&gt; c3= Counter(a=1, c= 1, e=3)
&gt;&gt;&gt; c1
Counter({'e': 3, 'n': 2, 'a': 1, 'y': 1, 's': 1, 'q': 1, 'u': 1, 'c': 1})
&gt;&gt;&gt; c2
Counter({'e': 3, 'a': 1, 'c': 1})
&gt;&gt;&gt; c3
Counter({'e': 3, 'a': 1, 'c': 1})</pre><p> </p><p> </p><p>We can also create an empty counter object and populate it by passing its <code class="literal">update</code> method an iterable or a dictionary. Notice how the <code class="literal">update</code> method adds the counts rather than replacing them with new values. Once the counter is populated, we can access stored values in the same way we would do for dictionaries, as in the following example:</p><pre class="programlisting">&gt;&gt;&gt; from collections import Counter
&gt;&gt;&gt; ct = Counter()  # creates an empty counter object
&gt;&gt;&gt; ct
Counter()
&gt;&gt;&gt; ct.update('abca') # populates the object
&gt;&gt;&gt; ct
Counter({'a': 2, 'b': 1, 'c': 1})
&gt;&gt;&gt; ct.update({'a':3}) # update the count of 'a'
&gt;&gt;&gt; ct
Counter({'a': 5, 'b': 1, 'c': 1})
&gt;&gt;&gt; for item in ct:
 ...  print('%s: %d' % (item, ct[item]))
 ...
a: 5
b: 1
c: 1</pre><p>The most notable difference between counter objects and dictionaries is that counter objects return a zero count for missing items rather than raising a key error. We can create an iterator out of a <code class="literal">Counter</code> object by using its <code class="literal">elements()</code> method. This returns an iterator where counts below one are not included and the order is not guaranteed. In the following code, we perform some updates, create an iterator from <code class="literal">Counter</code> elements, and use <code class="literal">sorted()</code> to sort the keys alphabetically:</p><pre class="programlisting">&gt;&gt;&gt; ct
Counter({'a': 5, 'b': 1, 'c': 1})
&gt;&gt;&gt; ct['x']
0
&gt;&gt;&gt; ct.update({'a':-3, 'b':-2, 'e':2})
&gt;&gt;&gt; ct
Counter({'a': 2, 'e': 2, 'c': 1, 'b': -1})
&gt;&gt;&gt;sorted(ct.elements())
['a', 'a', 'c', 'e', 'e']</pre><p>Two other <code class="literal">Counter</code> methods worth mentioning are <code class="literal">most_common()</code> and <code class="literal">subtract()</code>. The most common method takes a positive integer argument that determines the number of most common elements to return. Elements are returned as a list of (key,value) tuples.</p><p>The subtract method works exactly like update except, instead of adding values, it subtracts them, as in the following example:</p><pre class="programlisting">&gt;&gt;&gt; ct.most_common()
[('a', 2), ('e', 2), ('c', 1), ('b', -1)]
&gt;&gt;&gt; ct.subtract({'e':2})
&gt;&gt;&gt; ct
Counter({'a': 2, 'c': 1, 'e': 0, 'b': -1})</pre></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch02lvl3sec6"></a>Ordered dictionaries</h4></div></div></div><p>The important thing about <span>ordered</span><a id="id326234542" class="indexterm"></a> dictionaries is that they remember the <span>insertion</span><a id="id326234554" class="indexterm"></a> order, so when we iterate over them, they return values in the order they were inserted. This is in contrast to a normal dictionary, where the order is arbitrary. When we test to see whether two dictionaries are equal, this equality is only based on their keys and values; however, with <code class="literal">OrderedDict</code>, the insertion order is also considered an equality test between two <code class="literal">OrderedDict</code> objects with the same keys and values, but a different insertion order will return <code class="literal">False</code>:</p><pre class="programlisting">&gt;&gt;&gt; import collections
&gt;&gt;&gt; od1=  collections.OrderedDict()
&gt;&gt;&gt; od1['one'] = 1
&gt;&gt;&gt; od1['two'] = 2
&gt;&gt;&gt; od2 =  collections.OrderedDict()
&gt;&gt;&gt; od2['two'] = 2
&gt;&gt;&gt; od2['one'] = 1
&gt;&gt;&gt; od1==od2
False</pre><p>Similarly, when we add values from a list using <code class="literal">update</code>, <code class="literal">OrderedDict</code> will retain the same order as the list. This is the order that is returned when we iterate the values, as in the following example:</p><pre class="programlisting">&gt;&gt;&gt; kvs = [('three',3), ('four',4), ('five',5)]
&gt;&gt;&gt; od1.update(kvs)
&gt;&gt;&gt; od1
OrderedDict([('one', 1), ('two', 2), ('three', 3), ('four', 4), ('five', 5)])
&gt;&gt;&gt; for k, v in od1.items(): print(k, v)</pre><pre class="programlisting">...
one 1
two 2
three 3
four 4
five 5</pre><p><code class="literal">OrderedDict</code> is often used in conjunction with the sorted method to create a sorted dictionary. In the following example, we use a Lambda function to sort the values, and here we use a numerical expression to sort the integer values:</p><pre class="programlisting">&gt;&gt;&gt; od3 = collections.OrderedDict(sorted(od1.items(), key= lambda t : (4*t[1])- t[1]**2))
&gt;&gt;&gt;od3
OrderedDict([('five', 5), ('four', 4), ('one', 1), ('three', 3), ('two', 2)])
&gt;&gt;&gt; od3.values() 
odict_values([5, 4, 1, 3, 2])</pre></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch02lvl3sec7"></a>defaultdict</h4></div></div></div><p>The <code class="literal">defaultdict</code> object is a subclass of <code class="literal">dict</code>, and <span>therefore</span><a id="id326235812" class="indexterm"></a> they share methods and operations. It acts as a convenient way to initialize dictionaries. With <code class="literal">dict</code>, Python will throw <code class="literal">KeyError</code> when attempting to access a key that is not already in the dictionary. The <code class="literal">defaultdict</code> overrides one method, <code class="literal">missing (key)</code>, and creates a <span>new</span><a id="id326631320" class="indexterm"></a> instance variable, <code class="literal">default_factory</code>. With <code class="literal">defaultdict</code>, rather than throw an error, it will run the function supplied as the <code class="literal">default_factory</code> argument, which will generate a value. A simple use of <code class="literal">defaultdict</code> is to set <code class="literal">default_factory</code> to <code class="literal">int</code> and use it to quickly tally the counts of items in the dictionary, as in the following example:</p><pre class="programlisting">&gt;&gt;&gt; from collections import defaultdict
&gt;&gt;&gt; dd = defaultdict(int)
&gt;&gt;&gt; words = str.split('red blue green red yellow blue red green green red')
&gt;&gt;&gt; for word in words: dd[word] +=1
...
&gt;&gt;&gt; dd
defaultdict(&lt;class 'int'&gt;, {'red': 4, 'blue': 2, 'green': 3, 'yellow': 1})
</pre><p>You will notice that if we tried to do this with an ordinary dictionary, we would get a key error when we tried to add the first key. The <code class="literal">int</code> we supplied as an argument to the <code class="literal">defaultdict</code> is really the <code class="literal">int()</code>function that simply returns a zero.</p><p> </p><p> </p><p>We can, of course, create a function that will determine the dictionary's values. For example, the following function returns <code class="literal">True</code> if the supplied argument is a primary color, that is <code class="literal">red</code>, <code class="literal">green</code>, or <code class="literal">blue</code>, or returns <code class="literal">False</code> otherwise:</p><pre class="programlisting">def isprimary(c):
     if (c=='red') or (c=='blue') or (c=='green'): 
         return True 
     else: 
         return False</pre></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch02lvl3sec8"></a>Learning about named tuples</h4></div></div></div><p>The <code class="literal">namedtuple</code> method returns a tuple-like object that has fields accessible with named indexes as well as the integer indexes of normal tuples. This allows for code that is, to a certain extent, self-documenting and more readable. It can be especially useful in an application where there are a large <span>number</span><a id="id325951605" class="indexterm"></a> of <span>tuples</span><a id="id325951611" class="indexterm"></a> and we need to easily keep track of what each tuple represents. Furthermore, <code class="literal">namedtuple</code> inherits methods from tuple and it is backward-compatible with tuple.</p><p>The field names are passed to the <code class="literal">namedtuple</code> method as comma and/or whitespace-separated values. They can also be passed as a sequence of strings. Field names are single strings, and they can be any legal Python identifier that does not begin with a digit or an underscore. A typical example is shown here:</p><pre class="programlisting">&gt;&gt;&gt; from collections import namedtuple
&gt;&gt;&gt; space = namedtuple('space', 'x y z')
&gt;&gt;&gt; s1= space(x=2.0, y=4.0, z=10) # we can also use space(2.0,4.0, 10)
&gt;&gt;&gt; s1
space(x=2.0, y=4.0, z=10)
&gt;&gt;&gt; s1.x * s1.y * s1.z   # calculate the volume
80.0</pre><p>In addition to the inherited tuple methods, the named tuple also defines three methods of its own, <code class="literal">_make()</code>, <code class="literal">asdict()</code>, and <code class="literal">_replace</code>. These methods begin with an underscore to prevent potential conflicts with field names. The <code class="literal">_make()</code> method takes an iterable as an argument and turns it into a named tuple object, as in the following example:</p><pre class="programlisting">&gt;&gt;&gt; sl = [4,5,6]
&gt;&gt;&gt; space._make(sl)
space(x=4, y=5, z=6)
&gt;&gt;&gt; s1._1
4</pre><p> </p><p>The <code class="literal">_asdict</code> method returns an <code class="literal">OrderedDict</code> object with the field names mapped to index keys and the values mapped to the dictionary values. The <code class="literal">_replace</code> method returns a new instance of the tuple, replacing the specified values. In addition, <code class="literal">_fields</code> returns the tuple of string listing the fields names. The <code class="literal">_fields_defaults</code> method provides dictionary mapping field names to the default values. Consider the example code snippet:</p><pre class="programlisting">&gt;&gt;&gt; s1._asdict()
OrderedDict([('x', 3), ('_1', 4), ('z', 5)])
&gt;&gt;&gt; s1._replace(x=7, z=9)
space2(x=7, _1=4, z=9)
&gt;&gt;&gt; space._fields
('x', 'y', 'z')
&gt;&gt;&gt; space._fields_defaults
{}</pre></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch02lvl3sec9"></a>Arrays</h4></div></div></div><p>The <code class="literal">array</code> module defines a data type <span>array</span><a id="id325952029" class="indexterm"></a> that is similar to the list data type except for the constraint that their contents must be of a single type of the underlying representation, as is determined by the machine architecture or underlying C implementation.</p><p>The type of an array is determined at creation time and it is indicated by one of the following type codes:</p><div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; "><colgroup><col /><col /><col /><col /></colgroup><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>Code</strong></span></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>C type</strong></span></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>Python type</strong></span></p></td><td style="border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>Minimum bytes</strong></span></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>'b'</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">signedchar</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>int</p></td><td style="border-bottom: 0.5pt solid ; "><p>1</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>'B'</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">unsignedchar</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>int</p></td><td style="border-bottom: 0.5pt solid ; "><p>1</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>'u'</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">Py_UNICODE</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Unicodecharacter</p></td><td style="border-bottom: 0.5pt solid ; "><p>2</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>'h'</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">signedshort</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>int</p></td><td style="border-bottom: 0.5pt solid ; "><p>2</p></td></tr><tr><td style="border-right: 0.5pt solid ; "><p>'H'</p></td><td style="border-right: 0.5pt solid ; "><p><code class="literal">unsignedshort</code></p></td><td style="border-right: 0.5pt solid ; "><p>int</p></td><td style=""><p>2</p></td></tr></tbody></table></div><p> </p><p> </p><div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; "><colgroup><col /><col /><col /><col /></colgroup><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>'i'</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">signedint</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>int</p></td><td style="border-bottom: 0.5pt solid ; "><p>2</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>'I'</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">unsignedint</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>int</p></td><td style="border-bottom: 0.5pt solid ; "><p>2</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>'l'</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">signedlong</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>int</p></td><td style="border-bottom: 0.5pt solid ; "><p>4</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>'L'</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">unsignedlong</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>int</p></td><td style="border-bottom: 0.5pt solid ; "><p>8</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>'q'</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">signedlonglong</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>int</p></td><td style="border-bottom: 0.5pt solid ; "><p>8</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>'Q'</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">unsignedlonlong</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>int</p></td><td style="border-bottom: 0.5pt solid ; "><p>8</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>'f'</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">float</code></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>float</p></td><td style="border-bottom: 0.5pt solid ; "><p>4</p></td></tr><tr><td style="border-right: 0.5pt solid ; "><p>'d'</p></td><td style="border-right: 0.5pt solid ; "><p><code class="literal">double</code></p></td><td style="border-right: 0.5pt solid ; "><p>float</p></td><td style=""><p>8</p></td></tr></tbody></table></div><p> </p><p> </p><p>T<span>he array objects support the attributes</span> and methods:</p><div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; "><colgroup><col /><col /></colgroup><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>Attribute or method</strong></span></p></td><td style="border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>Description</strong></span></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">a.itemsize</code></p></td><td style="border-bottom: 0.5pt solid ; "><p>The size of one array item in bytes.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">a.append(x)</code></p></td><td style="border-bottom: 0.5pt solid ; "><p>Appends an <code class="literal">x</code>element at the end of the <code class="literal">a</code> array.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">a.buffer_info()</code></p></td><td style="border-bottom: 0.5pt solid ; "><p>Returns a tuple containing the current memory location and length of the buffer used to store the array.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">a.byteswap()</code></p></td><td style="border-bottom: 0.5pt solid ; "><p>Swaps the byte order of each item in the <code class="literal">a</code> array.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">a.count(x)</code></p></td><td style="border-bottom: 0.5pt solid ; "><p>Returns the occurrences of <code class="literal">x</code> in the <code class="literal">a</code> array.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">a.extend(b)</code></p></td><td style="border-bottom: 0.5pt solid ; "><p>Appends all the elements from iterable <code class="literal">b</code> at the end of the <code class="literal">a</code> array.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">a.frombytes(s)</code></p></td><td style="border-bottom: 0.5pt solid ; "><p>Appends elements from an <code class="literal">s</code> string, where the string is an array of machine values.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">a.fromfile(f,n)</code></p></td><td style="border-bottom: 0.5pt solid ; "><p>Reads <code class="literal">n</code> machine values from the file and appends them at the end of the array.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">a.fromlist(l)</code></p></td><td style="border-bottom: 0.5pt solid ; "><p>Appends all of the elements from the <code class="literal">l</code> list to the array.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">a.fromunicode(s)</code></p></td><td style="border-bottom: 0.5pt solid ; "><p>Extends an array of the <code class="literal">u</code> type with the Unicode string, <code class="literal">s</code>.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">index(x)</code></p></td><td style="border-bottom: 0.5pt solid ; "><p>Returns the first (smallest) index of the <code class="literal">x</code> element.</p></td></tr><tr><td style="border-right: 0.5pt solid ; "><p><code class="literal">a.insert(i,x)</code></p></td><td style=""><p>Inserts an item of which the value is <code class="literal">x</code>, in the array at <code class="literal">i</code> index position.</p></td></tr></tbody></table></div><div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; "><colgroup><col /><col /></colgroup><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">a.pop([i])</code></p></td><td style="border-bottom: 0.5pt solid ; "><p>Returns the item at index, <code class="literal">I</code>, and removes it from the array.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">a.remove(x)</code></p></td><td style="border-bottom: 0.5pt solid ; "><p>Removes the first occurrence of the <code class="literal">x</code>item from the array.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">a.reverse()</code></p></td><td style="border-bottom: 0.5pt solid ; "><p>Reverses the order of items in the <code class="literal">a</code> array.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">a.tofile(f)</code></p></td><td style="border-bottom: 0.5pt solid ; "><p>Writes all the elements to the <code class="literal">f</code> file object.</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">a.tolist()</code></p></td><td style="border-bottom: 0.5pt solid ; "><p>Converts the array into a list.</p></td></tr><tr><td style="border-right: 0.5pt solid ; "><p><code class="literal">a.tounicode()</code></p></td><td style=""><p>Converts an array of the <code class="literal">u</code> type into a Unicode string</p></td></tr></tbody></table></div><p> </p><p>Array objects support all of the normal sequence operations such as indexing, slicing, concatenation, and multiplication.</p><p>Using arrays, as opposed to lists, is a much more efficient way of storing data that is of the same type. In the following example, we have created an integer array of the digits from <code class="literal">0</code> to one million minus <code class="literal">1</code>, and an identical list. Storing one million integers in an integer array requires around 90% of the memory of an equivalent list:</p><pre class="programlisting">&gt;&gt;&gt; import array
&gt;&gt;&gt; ba = array.array('i', range(10**6))
&gt;&gt;&gt; bl = list(range(10**6))
&gt;&gt;&gt; import sys
&gt;&gt;&gt; 100*sys.getsizeof(ba)/sys.getsizeof(bl)
90.92989871246161</pre><p>Because we are interested in saving space, that is, we are dealing with large datasets and limited memory size, we usually perform in-place operations on arrays, and only create copies when we need to. Typically, enumerate is used to perform an operation on each element. In the following snippet, we perform the simple operation of adding one to each item in the array.</p><p>It should be noted that when performing operations on arrays that create lists, such as list comprehensions, the memory efficiency gains of using an array in the first place will be negated. When we need to create a new data object, a solution is to use a generator expression to perform the operation.</p><p>Arrays created with this module are unsuitable for work that requires a matrix of vector operations. In the next chapter, we will build our own abstract data type to deal with these operations. Also important for numerical work is the NumPy extension, available at <a class="ulink" href="http://www.numpy.org/" target="_blank">www.numpy.org</a> .</p></div></div></div>