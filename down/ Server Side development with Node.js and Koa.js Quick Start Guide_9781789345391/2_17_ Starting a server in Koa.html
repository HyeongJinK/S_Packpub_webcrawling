<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch02lvl1sec24"></a>Starting a server in Koa</h2></div></div><hr /></div><p>To get started with starting a server in Koa, we <span>should</span><a id="id326415319" class="indexterm"></a> first create a <span>project</span><a id="id326415275" class="indexterm"></a> directory and enter that directory. We can do so with the following commands:</p><pre class="programlisting"><span class="strong"><strong>mkdir koa-server
</strong></span><span class="strong"><strong>cd koa-server</strong></span></pre><p>Next, we initialize a project in <code class="literal">npm</code> with the following command:</p><pre class="programlisting"><span class="strong"><strong>npm init</strong></span></pre><p>After running this command, follow the prompts to help create a <code class="literal">package.json</code> file for your project.</p><p> </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip7"></a>Note</h3><p>You can run <code class="literal">npm init –y</code> to create a <code class="literal">package.json</code> file for your project with default values.</p></div><p>Next, we can install Koa to our project with the following command:</p><pre class="programlisting"><span class="strong"><strong>npm i koa</strong></span></pre><p>Now that we have Koa installed, we can create our server file. Let's call the file <code class="literal">index.js</code>. If you are using a Unix-based operating system such as Linux or macOS, you can create the file with the following command:</p><pre class="programlisting"><span class="strong"><strong>touch index.js</strong></span></pre><p>This file will serve as the entry point to our application, and we will write the main logic for our simple server in this file. Using your code or text editor of choice, write the following into the <code class="literal">index.js</code> file:</p><pre class="programlisting">// ./index.js

const Koa = require('koa');
const app = new Koa();

app.use(async ctx =&gt; {
  ctx.body = 'Hello World';
});

app.listen(1234, () =&gt; {
  console.log('Server is running on port 1234')
});</pre><p>In the preceding code snippet, first, we require the <span>needed</span><a id="id325756275" class="indexterm"></a> Koa application <span>class</span><a id="id325756283" class="indexterm"></a> and assign it to the <code class="literal">Koa</code> variable. Next, we initialize a new Koa application instance with <code class="literal">new Koa()</code> and assign it to <code class="literal">app</code>. One interesting thing we see next is the definition of a simple middleware.</p><p>The middleware we define simply sends back the text <code class="literal">Hello World</code> as a response to every request. We define the middleware using the <code class="literal">.use()</code> method available in Koa. The <code class="literal">.use()</code> method accepts the middleware function as its only argument. The middleware function also takes the context object (defined as <code class="literal">ctx</code>) as its only argument, which it uses to process requests and send responses. It specifically uses the <code class="literal">context.body</code> method to send the <code class="literal">Hello World</code> response. If you feel a little lost at this point, don't worry. We will discuss more Koa core concepts and the context object in <a class="link" href="#" linkend="ch03">Chapter 3</a>, <span class="emphasis"><em>Koa Core Concepts</em></span>.</p><p> </p><p>Finally, we start the server with the <code class="literal">app.listen()</code> function, which takes the port to run the server as its first argument. In our case, we defined <code class="literal">1234</code> as the port to run our server on. The second argument is a callback function, which is called once the server starts.</p><p>We can now start the app with the following command:</p><pre class="programlisting"><span class="strong"><strong>node index.js</strong></span></pre><p>This starts our server, and if we visit <code class="literal">http://localhost:1234</code>, we will see the <code class="literal">Hello World</code> response. We can also test this in  the Terminal using the <code class="literal">curl</code> command:</p><pre class="programlisting"><span class="strong"><strong>curl -i http://localhost:1234</strong></span></pre><p>It should <span>send</span><a id="id325905046" class="indexterm"></a> back a <span>response</span><a id="id325905054" class="indexterm"></a> similar to this:</p><pre class="programlisting"><span class="strong"><strong>HTTP/1.1 200 OK</strong></span>
<span class="strong"><strong>Content-Type: text/plain; charset=utf-8</strong></span>
<span class="strong"><strong>Content-Length: 11</strong></span>
<span class="strong"><strong>Connection: keep-alive</strong></span>
<span class="strong"><strong>Hello World</strong></span></pre></div>