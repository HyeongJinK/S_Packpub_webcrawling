<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch04lvl1sec32"></a>Producers</h2></div></div><hr /></div><p>CDI producers comes with the <code class="literal">@Produces</code> annotation. It is <span>useful</span><a id="id325813076" class="indexterm"></a> when we need to have complete control over the instantiation of the bean, with some custom code execution, before actually creating the instance.</p><p>Let's write an <code class="literal">IdentityCreator</code> class. It has a function called <code class="literal">createPerson()</code>, which takes <code class="literal">inputData</code> as an argument. If the person has preferred choice of language, it is represented by the <code class="literal">preferredLanguage</code> attribute. If <code class="literal">preferredLanguage</code> is not given in <code class="literal">inputData</code>, we will have to create a <code class="literal">person</code> instance with <code class="literal">defaultPreferredLanguage</code>. This is shown in the following code:</p><pre class="programlisting">class IdentityCreator {
private lateinit var defaultPreferredLanguage:PreferredLanguage

fun createPerson(inputData: InputData): Person {
val person = Person()
if (inputData.preferredLangauge == null)
         person.preferredLangauge = defaultPreferredLanguage
else
inputData.preferredLangauge
    }
}</pre><p>Let's say that creating <code class="literal">defaultPreferredLanguage</code> is not the concern of the <code class="literal">IdentityCreator</code> class and we want to inject this default property from outside  using  <code class="literal">@Inject</code>:</p><pre class="programlisting">@Inject
private lateinit var defaultPreferredLanguage:PreferredLanguage</pre><p>However, <code class="literal">PreferredLanguage</code> is an <code class="literal">enum</code>:</p><pre class="programlisting">enum class PreferredLanguage (val preferredLanguage: String) {
EN_US("en-us"), EN_UK("en-gb")
}</pre><p>Wiring <code class="literal">defaultPreferredLanguage</code> to the <code class="literal">IdentityCreator</code> class is not possible, since <code class="literal">PreferredLanguage</code> is not a managed bean.</p><p>We need to create producers to achieve this. This is done with the following code:</p><pre class="programlisting">class PreferredLanguageProducer {

@Produces
    fun exposeDefaultPreferredLanguage(): PreferredLanguage {
return PreferredLanguage.EN_US
}
}</pre><p>We can now inject this <code class="literal">defaultPreferredLanguage</code> in the <code class="literal">IdentityCreator</code> class, as shown here:</p><pre class="programlisting">@Inject
private lateinit var defaultPreferredLanguage: PreferredLanguage</pre><p>The <code class="literal">PreferredLanguage</code> type is now injectable as we specify the <code class="literal">Producer</code>. <code class="literal">defaultPreferredLanguage</code> is injected in the <code class="literal">IdentityCreator</code> class and we can use it further in the <code class="literal">IdentityCreator</code> class.</p><p>We can also specify the <code class="literal">@Produces</code> annotation at the <span>field</span><a id="id325816209" class="indexterm"></a> level. This can be done as shown in the following code:</p><pre class="programlisting">class PreferredLanguageProducer {
@Produces
    private val defaultPreferredLanguage: PreferredLanguage
}</pre><p>Within the scope of the <code class="literal">PreferredLanguageProducer</code> bean class, we can set the value for <code class="literal">defaultPreferredLanguage</code>. When the bean is injected by CDI, the value set to <code class="literal">defaultPreferredLanguage</code> will be injected in the <code class="literal">IdentityCreator</code> class.</p><p> </p><p> </p></div>