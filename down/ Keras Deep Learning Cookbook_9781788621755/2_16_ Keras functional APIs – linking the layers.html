<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch02lvl1sec24"></a>Keras functional APIs – linking the layers</h2></div></div><hr /></div><p>In the functional model, we must create and define an input layer, which <span>specifies</span><a id="id324879982" class="indexterm"></a> the shape of the input data. The input layer takes a <code class="literal">shape</code> argument that is a tuple, which indicates the dimensionality of the input data. When the input data is one-dimensional (for example, for a multilayer perceptron), the shape must leave space for the shape of the mini-batch size, which is determined while splitting the data when training the network. The shape tuple is always defined with an open last dimension when the input is a one-dimensional example (32).</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec26"></a>How to do it...</h3></div></div></div><p>In the following code, we define the first layer:</p><pre class="programlisting">from keras.layers import Input
visible = Input(shape=(32,))</pre><p>We connect the layers together:</p><pre class="programlisting">visible = Input(shape=(32,))
hidden = Dense(32)(visible)</pre><p> </p><p> </p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch02lvl3sec26"></a>Model class</h4></div></div></div><p>Here we can use the <code class="literal">Model</code> class to <span>create</span><a id="id325345120" class="indexterm"></a> the model instance, as shown in the following snippet:</p><pre class="programlisting"><span>from </span><span>keras</span><span>.</span><span>models </span><span>import </span><span>Model
</span><span>from </span><span>keras</span><span>.</span><span>layers </span><span>import </span><span>Input
</span><span>from </span><span>keras</span><span>.</span><span>layers </span><span>import </span><span>Dense

</span><span>visible</span><span></span><span>=</span><span></span><span>Input</span><span>(</span><span>shape</span><span>=</span><span>(3</span><span>2</span><span>,</span><span>)</span><span>)
</span><span>hidden</span><span></span><span>=</span><span></span><span>Dense</span><span>(3</span><span>2</span><span>)</span><span>(</span><span>visible</span><span>)
</span><span>model</span><span></span><span>=</span><span></span><span>Model</span><span>(</span><span>inputs</span><span>=</span><span>visible</span><span>,</span><span></span><span>outputs</span><span>=</span><span>hidden</span><span>)</span></pre><p>We define <code class="literal">Model</code> with multiple inputs and outputs:</p><pre class="programlisting">model = Model(inputs=[a1, a2], outputs=[b1, b2, b3])</pre><p>In the preceding code, we have multiple layers defined as inputs and outputs. In the next recipe, let's look at how Keras functional APIs can be used for image classification.</p></div></div></div>