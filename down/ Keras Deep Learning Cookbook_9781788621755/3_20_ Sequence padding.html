<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch03lvl1sec27"></a>Sequence padding</h2></div></div><hr /></div><p>In this recipe, we will learn how <span>Keras</span><a id="id324602825" class="indexterm"></a> can be used for sequence padding. Padding is <span>useful</span><a id="id324812534" class="indexterm"></a> when sequences are sent in batches to the LSTM network. </p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec30"></a>Getting ready</h3></div></div></div><p>Import the function:</p><pre class="programlisting">from keras.preprocessing.sequence import pad_sequences</pre><p><code class="literal">pad_sequences</code> is a function defined as follows:</p><pre class="programlisting">pad_sequences(sequences, maxlen=<span>None</span>, dtype=<span>'int32'</span>, padding=<span>'pre'</span>, truncating=<span>'pre'</span>, value=<span>0.0</span>)</pre></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec31"></a>How to do it...</h3></div></div></div><p>Let's look at the various padding options.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch03lvl3sec28"></a>Pre-padding with default 0.0 padding</h4></div></div></div><p>First, let's look at how to use <code class="literal">pad_sequences</code> with <span>default</span><a id="id324812594" class="indexterm"></a> pre-padding:</p><pre class="programlisting">from keras.preprocessing.sequence import pad_sequences
 # define sequences
 sequences = [
 [1, 2, 3, 4],
 [5, 6, 7],
 [5]
 ]
 # pad sequence
 padded = pad_sequences(sequences)
 print(padded)</pre><p>An output of the preceding <code class="literal">print</code> statement will show all the sequences padded to length 4. </p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch03lvl3sec29"></a>Post-padding</h4></div></div></div><p>To pad 0.0 on at the <span>end</span><a id="id325345220" class="indexterm"></a> of shorter arrays, use <code class="literal">padding='post'</code>, as shown in the following code snippet:</p><pre class="programlisting">padded_post = pad_sequences(sequences,padding='post')
print(padded_post)</pre><p>The preceding output shows how post-padding happens:</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch03lvl3sec30"></a>Padding with truncation</h4></div></div></div><p>Let's look at how to use the <code class="literal">maxlen</code> parameter to <span>truncate</span><a id="id325348252" class="indexterm"></a><code class="literal">pre</code> and <code class="literal">post</code>:</p><pre class="programlisting">padded_maxlen_truncating_pre = pad_sequences(sequences,maxlen=3, truncating='pre')
print(padded_maxlen_truncating_pre)</pre><p>The output of the preceding code is shown here:</p><pre class="programlisting">[[2 3 4]
 [5 6 7]
 [0 0 5]]</pre><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p> </p><p>In the preceding output, the first value of first row was truncated:</p><pre class="programlisting">padded_maxlen_truncating_post = pad_sequences(sequences,maxlen=3, truncating='post')
print(padded_maxlen_truncating_post)</pre><p>The output of the preceding code is as follows:</p><pre class="programlisting">[[1 2 3]
 [5 6 7]
 [0 0 5]]</pre><p>In the preceding output, the last value of first row was truncated.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch03lvl3sec31"></a>Padding with a non-default value</h4></div></div></div><p>Let's look at how to pad <span>with</span><a id="id325354160" class="indexterm"></a> a non-default value (1.0, in this case):</p><pre class="programlisting">padded_value = pad_sequences(sequences, value=1.0)
print(padded_value)</pre><p>The following is the output of the preceding code snippet. Notice that all the arrays have been made of length 4 with 1 as the padding value:</p><pre class="programlisting">[[1 2 3 4]
 [1 5 6 7]
 [1 1 1 5]]</pre></div></div></div>