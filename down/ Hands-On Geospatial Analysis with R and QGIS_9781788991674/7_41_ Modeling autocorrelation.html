<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch07lvl1sec43"></a>Modeling autocorrelation</h2></div></div><hr /></div><p>We have so far learned how to <span>check</span><a id="id325302946" class="indexterm"></a> for spatial autocorrelation, but we have not yet learned how to incorporate this into our model. We'll now learn how to do this.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec65"></a>Spatial autoregression</h3></div></div></div><p>The spatial autoregression <span>model</span><a id="id325302961" class="indexterm"></a> considers the dependence of the value upon near regions and integrates that dependence into the data-generation process. We'll be working with a <span class="strong"><strong>Simultaneous Autoregressive</strong></span> (<span class="strong"><strong>SAR</strong></span>) model here. One important parameter here is <code class="literal">lambda</code>, which indicates the level of spatial dependence, where a positive <span>value</span><a id="id325302984" class="indexterm"></a> indicates positive correlation, a negative value indicates negative correlation, and zero means no spatial dependence.</p><p>First, we fit a SAR model without a predictor (that is, as an intercept-only model) using the <code class="literal">spautolm()</code> function of the <code class="literal">spdep</code> package. The first argument to <code class="literal">spautolm()</code> specifies the model and the second argument specifies the <code class="literal">listw</code> object, containing neighbors and weights. We make an SAR of the migration rate as a percentage as follows:</p><pre class="programlisting">syl_sar = spautolm(migration_spdf$val~1, listw=nb2listw(neighbor_syl))
summary(syl_sar)</pre><p>Here is the summary of this SAR model:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/dcc337d2-261d-4292-a9e3-d9e64540d113.png" /></div><p>In the output, we see that the <code class="literal">p-value</code> instance corresponding to <code class="literal">Lambda</code> is <code class="literal">0.0019148</code>, which is much less than 0.05, and so we can reject the null hypothesis of no spatial dependence.</p><p>Now we'll consider a SAR model with predictors. We'll check now whether the percentage of the population that migrated depends on the ratio of agricultural land to total land (here, the area of the <span class="emphasis"><em>thana</em></span> or polygon), indicated by the <code class="literal">agri</code> column; the population density of each area being captured in the <code class="literal">density</code> column. We can do so by writing the following commands:</p><pre class="programlisting">syl_sar_predictor = spautolm(val~agri+density, weights=pop, data=migration_spdf, listw=nb2listw(neighbor_syl))
summary(syl_sar_predictor)</pre><p>The summary of this model is as follows:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/4696e916-1d84-465f-8ad0-0e05eb361a58.png" /></div><p>As <code class="literal">p-value</code> for all of the predictors is higher than 0.05, there is the suggestion that the proportion of agricultural land to total land and population density do not affect the migration rate. As the <code class="literal">p-value</code> of <code class="literal">Lambda</code> is less than 0.05, we can say that migration rates are spatially correlated.</p></div></div>