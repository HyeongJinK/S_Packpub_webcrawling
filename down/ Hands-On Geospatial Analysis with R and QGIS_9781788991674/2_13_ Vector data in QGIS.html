<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch02lvl1sec20"></a>Vector data in QGIS</h2></div></div><hr /></div><p>Now, we will work with a <span>shapefile</span><a id="id325302949" class="indexterm"></a> in QGIS and find out its projection system. First, we import a shapefile named <code class="literal">BGD_adm4.shp</code> from the folder <code class="literal">Data</code> under <code class="literal">Chapter 2</code>. To recall how to import a vector file, refer back to <a class="link" href="#" linkend="ch01">Chapter 1</a>,  <span class="emphasis"><em>Setting Up R and QGIS Environments for Geospatial Tasks</em></span>.</p><p>Now, we will see the shapefile as follows:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/890c0658-c9ec-43c5-ab09-431396e8be3e.png" /></div><p>Now, to check out the projection system it is using, we need to click on <strong class="userinput"><code>Project Properties</code></strong> under <strong class="userinput"><code><span>Project</span><a id="id325536948" class="indexterm"></a></code></strong> in the menu bar as instructed in the following screenshot:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Click on <strong class="userinput"><code>Project</code></strong> and then <strong class="userinput"><code>Properties...</code></strong> under it:</li></ol></div><div class="mediaobject"><img src="/graphics/9781788991674/graphics/3d449086-f7ee-4359-8a20-e829b8a2bde7.png" /></div><p> </p><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Now, click on <strong class="userinput"><code>CRS</code></strong>:</li></ol></div><div class="mediaobject"><img src="/graphics/9781788991674/graphics/e1f5d18f-b671-4bcd-ab0f-9fbb1cd2c20d.png" /></div><p>Now, we can see the coordinate system (<span class="strong"><strong>a</strong></span>) and the spatial extent and projection (<span class="strong"><strong>b</strong></span>) as shown <span>in</span><a id="id325751173" class="indexterm"></a> this screenshot:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/b5f9387f-458a-4dca-8301-047d6c08eaf1.png" /></div><p>We can also select and change CRS from the <strong class="userinput"><code>Layer</code></strong> panel. We can do so using the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Right-click on the <code class="literal">BGD_adm4</code> layer in the <strong class="userinput"><code>Layer</code></strong> panel. Click on <strong class="userinput"><code>Properties</code></strong> as highlighted.</li><li>Now, right-click on <strong class="userinput"><code><span>Layer</span><a id="id325751216" class="indexterm"></a></code></strong> and then on <strong class="userinput"><code>Properties</code></strong>:</li></ol></div><div class="mediaobject"><img src="/graphics/9781788991674/graphics/d8363a00-c481-4446-b65f-b431ffd3c4a9.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>Now, left-click <strong class="userinput"><code>Source</code></strong>.</li></ol></div><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>We can see CRS now. We can also change CRS here by selecting our preferred CRS and <span>then</span><a id="id325753591" class="indexterm"></a> by pressing <strong class="userinput"><code>Apply</code></strong> and subsequently by pressing <strong class="userinput"><code>OK</code></strong>:</li></ol></div><div class="mediaobject"><img src="/graphics/9781788991674/graphics/82da1c0b-7004-424d-bbf3-234cba8cbd7b.png" /></div><p>For simplicity, we will work now with <code class="literal">BGD_adm3.shp</code> and there is no snapshot of this as we know how to load a vector file by now. In its attribute table, we can find its unique identifier field <code class="literal">ID_3</code>.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec16"></a>Adding Excel data in QGIS using joins </h3></div></div></div><p>Now, we will add data from an Excel file called <code class="literal">value.xlsx</code> to this attribute table (this file is located in the <code class="literal">Data</code> folder). This file contains information from a fictitious survey and <span>has</span><a id="id325756092" class="indexterm"></a> four columns: the first one <code class="literal">ID_Dis</code> (a unique identifier matching with the shapefile's attribute table), two columns with quantitative values, and one column with a qualitative value showing the opinion of participants regarding an imagined view. We can add this Excel file in the same way as we have done with vector (shapefile) data. Then, we can add this Excel file following the steps outlined next:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>First, load <code class="literal">BGD_adm3.shp</code> and then right-click on <code class="literal">BGD_adm3</code> and then click <strong class="userinput"><code>Properties</code></strong>.</li></ol></div><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Now, left-click <strong class="userinput"><code>Joins</code></strong> and then click on the plus sign situated in the lower left of the window:</li></ol></div><div class="mediaobject"><img src="/graphics/9781788991674/graphics/06ecf6b8-e3f1-4300-ab17-464f2fe74998.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>We will now see our Excel file <code class="literal">value Sheet1</code> in the <strong class="userinput"><code>Join layer</code></strong>. We can select the unique ID of the Excel file by selecting <code class="literal">ID_Dis</code> from the drop-down <span>for</span><a id="id325756211" class="indexterm"></a> the <strong class="userinput"><code>Join field</code></strong>. Now, we will select the unique ID of the shapefile, <code class="literal">ID_3</code>, for the <strong class="userinput"><code>Target field</code></strong>. After that, click <strong class="userinput"><code>OK</code></strong>:</li></ol></div><div class="mediaobject"><img src="/graphics/9781788991674/graphics/0395cdee-726a-444e-bd3d-44ff969de98d.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>Finally, we click <strong class="userinput"><code>Apply</code></strong> and then click <strong class="userinput"><code>OK</code></strong>.</li></ol></div><p>Now, we should have the values from our Excel file added to the attribute table of the shapefile. We can check whether that's the case by investigating the attribute table as follows:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Open the attribute table of <code class="literal">BGD_adm3</code>. </li><li>Three new columns have been added to the attribute table. Note that the names now look different than the original ones.</li></ol></div><p>Next, we will save this shapefile with the name <code class="literal">BGD_adm3_val</code> using the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>First, right-click on the <code class="literal">BGD_adm3</code> layer and then press <strong class="userinput"><code>Save as</code></strong> as highlighted:</li></ol></div><div class="mediaobject"><img src="/graphics/9781788991674/graphics/0e304f42-1201-4f4b-9ffd-abab23fa1af9.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Select ESRI Shapefile <span>for</span><a id="id325759339" class="indexterm"></a> the file format. After that, click on a box indicated by ... under <strong class="userinput"><code>File name</code></strong> to browse to the file.</li><li>Then, browse to a folder where we want to save it and then click <strong class="userinput"><code>Save</code></strong>.</li><li>Left-click <strong class="userinput"><code>OK</code></strong> and a new shapefile named <code class="literal">BGD_adm3_data</code> with columns from the Excel file is saved. </li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec17"></a>Adding CSV layers in QGIS </h3></div></div></div><p>Suppose we have the value of an arbitrary indicator collected from all the districts (administrative units) of Bangladesh. This result is saved in a CSV file, named <code class="literal">indicator.csv</code>, and it contains the longitude and latitude values of all the locations as <span class="emphasis"><em>x</em></span> and <span class="emphasis"><em>y</em></span> columns in the file, and it has another column containing the values of that indicator. Now, we want to plot it on a map or on <code class="literal">BGD_adm3_data.shp</code> and customize <span>the</span><a id="id325759384" class="indexterm"></a> visualization. So, first we open the shapefile that we created in the preceding segment and we can then follow the steps outlined hereafter to map the point data on the map or shapefile:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Click <strong class="userinput"><code>Layer</code></strong> in the menu bar. Then, click <strong class="userinput"><code>Add Delimited Text Layer</code></strong> under <strong class="userinput"><code>Add Layer</code></strong>:</li></ol></div><div class="mediaobject"><img src="/graphics/9781788991674/graphics/f5d5bfdb-fa7c-4ecc-a0a0-65c030f2b0b6.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Now, browse to the folder where the <code class="literal">indicator.csv</code> file is located (under the <code class="literal">Data</code> folder for our case). Select the CSV file <span class="strong"><strong>indicator.csv</strong></span> and left-click <strong class="userinput"><code>Open</code></strong>.</li><li>Now, click on <strong class="userinput"><code>Geometry Definition</code></strong> to set the coordinate system.</li></ol></div><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>Now, select <code class="literal">x</code> for the <strong class="userinput"><code>X field</code></strong> (this sets the longitude), select <code class="literal">y</code> for the <strong class="userinput"><code>Y</code></strong><strong class="userinput"><code> field</code></strong> (setting latitude). Select <code class="literal">WGS 84</code> for <strong class="userinput"><code>Geometry CRS</code></strong>, then press <strong class="userinput"><code>Add</code></strong>, and then press <strong class="userinput"><code>Close</code></strong>.</li></ol></div><div class="mediaobject"><img src="/graphics/9781788991674/graphics/8753fd1d-ee38-4d5f-ab9f-3d00b5b5090d.png" /></div><p>Now, we can see that values from the CSV file are plotted on the map. Note how the values from the CSV file are plotted according to longitude and latitude. It’s worth noting that <span>the</span><a id="id325971106" class="indexterm"></a> indicator layer should come after the <code class="literal">BGD_adm3_data</code> layer if we want to map those points on the top of the shapefile. Our map should look such as the following:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/eb58a7f5-c107-4260-835b-510ad52d3748.png" /></div><p> </p><p>We can select different symbols for these points mapped on the shapefile. For example, we can select a green-colored pentagon shape from QGIS to be the symbol for these values. We can <span>do</span><a id="id325971131" class="indexterm"></a> so following these guidelines:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Double click the <strong class="userinput"><code>indicator</code></strong> layer: </p></li></ol></div><div class="mediaobject"><img src="/graphics/9781788991674/graphics/c787d3ac-5c00-4c2e-bceb-0380f01192fe.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Now click on <strong class="userinput"><code>Symbology</code></strong>, then select <strong class="userinput"><code>Single symbol</code></strong> from the top drop-down menu. Then select a <strong class="userinput"><code>Color</code></strong>, select a <strong class="userinput"><code>Symbol</code></strong>, then click <strong class="userinput"><code>Apply</code></strong>, and then click <strong class="userinput"><code>OK</code></strong>:</li></ol></div><div class="mediaobject"><img src="/graphics/9781788991674/graphics/22ea1ba9-5b5c-44d7-83e9-416ee0719684.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li><p>Now, we will find a plot according to our specification; that is, we can see the symbols and also will observe that the colors of the symbols have changed. </p></li></ol></div><p>We have just seen one example of changing symbols, but as we can see, there are numerous other options for selecting different symbols and colors. It is encouraged that the readers explore some of the options under <strong class="userinput"><code>Symbology</code></strong> to get a better grasp of this.</p><p>Now, we will work with the attribute table of the shapefile <code class="literal">BGD_adm3_data</code> itself. We will <span>work</span><a id="id325980707" class="indexterm"></a> with qualitative data that is in the column named <code class="literal">value Sh_2</code>, which contains values such as <strong class="userinput"><code>Agree</code></strong>, <strong class="userinput"><code>Disagree</code></strong>, and so on. Note that this column name could be different on your computer and if you have followed sequentially along the steps outlined so far, this column should be the last of the attribute table for this shapefile. Now, we will learn to stylize vector data (shapefile) according to qualitative variables, as outlined as follows:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>First double-click on the <code class="literal">BGD_adm3_data</code> layer and then select <strong class="userinput"><code>Symbology</code></strong> in the <strong class="userinput"><code>Layer Properties</code></strong> and select:
<div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><strong class="userinput"><code>Categorized</code></strong></li><li style="list-style-type: disc">Under <strong class="userinput"><code>Columns</code></strong> select <strong class="userinput"><code>value Sh_2</code></strong></li><li style="list-style-type: disc">Then, left-click <span class="strong"><strong><strong class="userinput"><code>Classify</code></strong></strong></span>:</li></ul></div></li></ol></div><div class="mediaobject"><img src="/graphics/9781788991674/graphics/4d70f539-7fec-4bb9-990b-9aea103b1665.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Now, we will find that the map is filled with different colors corresponding to the <span>different</span><a id="id325986650" class="indexterm"></a> values of the <code class="literal">value Sh_2</code> column:</li></ol></div><div class="mediaobject"><img src="/graphics/9781788991674/graphics/aca22056-a0b4-495d-a769-1a560fabda9f.png" /></div><p>We can also label this shapefile according to the value of categorical attribute. For the preceding case, we need to <span>click</span><a id="id325986675" class="indexterm"></a> <strong class="userinput"><code>Labels</code></strong> of <strong class="userinput"><code>Layer Properties</code></strong> and take the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Open the <code class="literal">BGD_adm3_data</code> layer.</p></li><li>Select <strong class="userinput"><code>Single labels</code></strong>, then select <code class="literal">value Sh_2</code> for the <strong class="userinput"><code>Label with</code></strong> field. Then, click <strong class="userinput"><code>Apply</code></strong> and then <strong class="userinput"><code>OK</code></strong>:</li></ol></div><div class="mediaobject"><img src="/graphics/9781788991674/graphics/d9aa8fe9-541b-42e1-ae3c-48b1066f37bf.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>We get a labeled map now:</li></ol></div><div class="mediaobject"><img src="/graphics/9781788991674/graphics/5a4a098f-80dc-4461-a6a9-a1acab9cecae.png" /></div><p>Now, using <strong class="userinput"><code>Graduated</code></strong> from QGIS, we can classify and map numeric variables. We will use the Jenkins method which classifies data so it has the most homogeneity within classes. The steps <span>are</span><a id="id325987060" class="indexterm"></a> shown in the following screenshot:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Double-click on the layer <code class="literal">BGD_adm3_data</code>.</p></li><li><p>Select <strong class="userinput"><code>Graduated</code></strong>, then select <strong class="userinput"><code>Column</code></strong> <code class="literal">value Sh_1</code> <strong class="userinput"><code>. </code></strong>Select <strong class="userinput"><code>Natural Breaks (Jenks)</code></strong> for the method of classification and then click <strong class="userinput"><code>Classify</code></strong>.</p></li></ol></div><div class="mediaobject"><img src="/graphics/9781788991674/graphics/d286c3aa-bbb3-42c3-ae14-f0a3af8aad73.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>Now, click on <strong class="userinput"><code>Color ramp</code></strong> and then hover the mouse over all the color ramps and select any <span>color</span><a id="id326000571" class="indexterm"></a> ramp (for this example, we have stuck to the default). Now, click on <strong class="userinput"><code>Apply</code></strong> and then on <strong class="userinput"><code>OK</code></strong> to get the map:</li></ol></div><div class="mediaobject"><img src="/graphics/9781788991674/graphics/3999f315-3978-40be-9b31-18b6a912964b.png" /></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch02lvl3sec14"></a>Showing multiple labels using text chart diagrams</h4></div></div></div><p>Text chart diagrams show <span>attribute</span><a id="id326000602" class="indexterm"></a> values in a circle by dividing the circle into horizontal slices where each slice shows the value of each attribute we intend to show. It is useful for showing multiple values on the map at the same time.</p><p>Using the <strong class="userinput"><code>Diagrams</code></strong> tab from <strong class="userinput"><code>Layer Properties</code></strong>, we can label our map with multiple attributes of both numerical and categorical types. Suppose we want to map the last three attributes of <code class="literal">BGD_adm3_data</code> in the map; we can do so using <strong class="userinput"><code>Text diagram</code></strong>. The steps are outlined as follows:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Open the <code class="literal">BGD_adm3_data</code> layer by double-clicking. Double-click this layer and select the <strong class="userinput"><code>Labels</code></strong> tab and click on it. </li></ol></div><div class="mediaobject"><img src="/graphics/9781788991674/graphics/3bf3e60e-b6f9-4775-94bd-6955ae7c0c5f.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li><p>Now, left-click on the <strong class="userinput"><code>Diagrams</code></strong> tab and select <strong class="userinput"><code>Text diagram</code></strong> under <strong class="userinput"><code>No diagrams</code></strong>:</p></li></ol></div><div class="mediaobject"><img src="/graphics/9781788991674/graphics/afdd2344-2e10-424e-8680-b8f711a43c47.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>Select the attributes we want to show on the map. We select three attributes: <strong class="userinput"><code>value</code></strong> <strong class="userinput"><code>Shee</code></strong>, <strong class="userinput"><code>value Sh1</code></strong>, and <strong class="userinput"><code>value Sh2</code></strong> here. To do this, we first select <strong class="userinput"><code>Attributes</code></strong>, then we see a list of attributes under <strong class="userinput"><code>Available attributes</code></strong>, we select any of the attributes that we want to show on the map and <span>then</span><a id="id325828776" class="indexterm"></a> click on the green <strong class="userinput"><code>+</code></strong> sign to send it to the right panel under <strong class="userinput"><code>Assigned attributes</code></strong>. We do this for all three attributes and then we press <strong class="userinput"><code>Apply</code></strong> and then <strong class="userinput"><code>OK</code></strong>:</li></ol></div><div class="mediaobject"><img src="/graphics/9781788991674/graphics/185e91ef-a149-4e08-bfdc-a1599e45804c.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>Now, we get a map labelled <span>with</span><a id="id325752083" class="indexterm"></a> all three attributes:</li></ol></div><div class="mediaobject"><img src="/graphics/9781788991674/graphics/d0e2f0fe-b4cb-422d-a5c1-b5ffd72bcd57.png" /></div></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec18"></a>Adding a background map</h3></div></div></div><p>We can add a background to our <span>map</span><a id="id325752108" class="indexterm"></a> of vector data by using the available plugins of QGIS. Here, we will add an OSM background by using the <strong class="userinput"><code>QuickMapServices</code></strong> plugin. The steps for doing this are outlined as follows:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Click on <strong class="userinput"><code>Manage and Install Plugins...</code></strong> under <strong class="userinput"><code>Plugins</code></strong>.</p></li><li><p>In the <strong class="userinput"><code>Plugins</code></strong> window, search for <code class="literal">QuickMapServices</code> and then click on <strong class="userinput"><code>Upgrade plugin</code></strong>. After the installation is completed, press <strong class="userinput"><code>Close</code></strong>:</p></li></ol></div><div class="mediaobject"><img src="/graphics/9781788991674/graphics/e664f187-00e2-41a8-ac9a-ee64c7ed1c5d.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>Add the shapefile <code class="literal">indicator_point.shp</code>. We need to enable the <strong class="userinput"><code>on the fly</code></strong> CRS and write <code class="literal">Pseudo</code> and select <strong class="userinput"><code><span>Pseudo</span><a id="id325752178" class="indexterm"></a> Mercator</code></strong> for compatibility with OSM:</li></ol></div><div class="mediaobject"><img src="/graphics/9781788991674/graphics/eafd3c75-a276-4796-a755-7e36f4a43647.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>We can then add OSM by clicking the <strong class="userinput"><code>Web</code></strong> menu, followed by <strong class="userinput"><code>QuickMapServices</code></strong>, and then <strong class="userinput"><code>OSM</code></strong> <span>and</span><a id="id325752213" class="indexterm"></a>finally by clicking on <strong class="userinput"><code>OSM Standard</code></strong>:</li></ol></div><div class="mediaobject"><img src="/graphics/9781788991674/graphics/6609d1f6-76f8-4e80-83c6-7d8d2d51f9cf.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="5" type="1"><li>Ultimately, we will get the <span>following</span><a id="id325752244" class="indexterm"></a> map with OSM at the background:</li></ol></div><div class="mediaobject"><img src="/graphics/9781788991674/graphics/14e69994-b9c9-46b5-9127-2991b18a2953.png" /></div></div></div>