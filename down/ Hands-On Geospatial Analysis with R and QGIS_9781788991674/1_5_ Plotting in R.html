<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch01lvl1sec13"></a>Plotting in R</h2></div></div><hr /></div><p>We can make a simple plot using the <code class="literal">plot()</code> function of R. Now we will simulate 50 values from a <span>normal</span><a id="id325232775" class="indexterm"></a> distribution using <code class="literal">rnorm()</code> and assign these to <code class="literal">x</code> and similarly generate and assign 50 normally distributed values to <code class="literal">y</code>. We can plot these values in the following way:</p><pre class="programlisting">x = rnorm(50)
y = rnorm(50)
# pch = 19 stands for filled dot
plot(x, y, pch = 19, col = 'blue')</pre><p> </p><p>This gives us the following scatterplot with blue-colored filled dots as symbols for each data point:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/425f6ac6-c6de-47e4-af7e-6f3eabb38fea.png" /></div><p>We can also generate a line plot type of graph by using <code class="literal">type = "l"</code> inside <code class="literal">plot()</code>.</p><p>Now we will briefly look at a very strong graphical library called <code class="literal">ggplot2</code> developed by Hadley Wickham. Remember, the <code class="literal">all_prices</code> data frame? If you don't, let's have <span>another</span><a id="id325536950" class="indexterm"></a> look at that:</p><pre class="programlisting">str(all_prices)</pre><p>We see that it has 12 rows and four columns, it has three numeric variables and one factor variable:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/7df1262a-2c66-4fe4-aa10-5886a3340b55.png" /></div><p>We first need to install and then load the <code class="literal">ggplot2</code> package:</p><pre class="programlisting">install.packages("ggplot2")
library(ggplot2)</pre><p></p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip7"></a>Note</h3><p>In any R session, if we want to use an R package, we need to load it using <code class="literal">library()</code>. But once loaded, we don't need to load it any further to use any of the functions inside the package.</p></div><p>Now we need to define the data frame we want to use inside the <code class="literal">ggplot()</code> command, and inside this command, after the <span>data</span><a id="id325748893" class="indexterm"></a> frame name, we need to write <code class="literal">aes()</code>, which stands for <span class="strong"><strong>aesthetics</strong></span>. Inside this <code class="literal">aes()</code>, we define the <span class="emphasis"><em>x </em></span>axis variable and the <span class="emphasis"><em>y</em></span> axis variable. So, if we want to plot the prices of different items in January <span>against</span><a id="id325752077" class="indexterm"></a> these items, we can do the following:</p><pre class="programlisting"> ggplot(all_prices,aes(x = items, y = jan_price)) +
 geom_point()</pre><p>Now we see the plot as follows:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/00d3405c-2b62-41a7-9b55-3a75a97aa0ec.png" /></div><p> </p><p>We can also compute and mark the mean price in January of these different items over all the years under consideration using <code class="literal">stat = "summary"</code> and <code class="literal">fun.y = "mean"</code>. We will just need to add another layer, <code class="literal">geom_point()</code>, and mention these arguments inside this:</p><pre class="programlisting">ggplot(all_prices, aes(x = items, y = jan_price)) +
 geom_point() +
 geom_point(stat = "summary", fun.y = "mean", colour = "red", size = 3)</pre><p>The following screenshot shows <span>that</span><a id="id325759378" class="indexterm"></a> along with data points, the mean values for each item are marked as red:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/cffaf0d2-70a7-4a42-beb5-f84f8b29c870.png" /></div><p>We can also plot the price of January against the price of June and make separate plots for each of the items using <code class="literal">facet_grid(. ~ items)</code>:</p><pre class="programlisting">ggplot(all_prices, aes(x = jan_price, y = june_price)) +
 geom_point() +
 facet_grid(. ~ items)</pre><p> </p><p>As a result, we see a scatterplot for three different items as follows:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/b59de3e6-01bd-4ff6-98d7-ca8c92c139e2.png" /></div><p>We can also add a <span>linear</span><a id="id325750349" class="indexterm"></a> model fit using a <code class="literal">stat_smooth()</code> layer:</p><pre class="programlisting">ggplot(all_prices, aes(x = jan_price, y = june_price)) +
 geom_point() +
 facet_grid(. ~ items) +
 # se = TRUE inside stat_smooth() shows confidence interval
 stat_smooth(method = "lm", se = TRUE, col = "red")</pre><p> </p><p>The preceding code gives a linear model fit and a 95% confidence interval along with the scatterplot:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/7137cf96-2b6b-4189-a8d5-ed49d3896c9d.png" /></div><p>We get this weird-looking confidence interval for the <code class="literal">oil</code> price and the <code class="literal">rice</code> price, as there are very few points available. </p><p>We can do so many more things, and we <span>have</span><a id="id325750391" class="indexterm"></a> so many other things to cover in this book that we will not be covering any more plotting functionalities here. But we will explain many other aspects of plotting as and when appropriate when dealing with spatial data in upcoming chapters. I have also listed books to refer to for a deeper understanding of R in the <span class="emphasis"><em>Further reading </em></span>section.</p></div>