<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch07lvl1sec44"></a>Generalized linear model</h2></div></div><hr /></div><p>The observed variable might <span>not</span><a id="id325302936" class="indexterm"></a> always be amenable to the assumptions of normal distribution and, in those cases, using a linear model is not a good idea. Instead, we can use a GLM, which allows the observed variable to have an error distribution different to the normal distribution. </p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec66"></a>Modeling count data using Poisson GLM</h3></div></div></div><p>Suppose we have the migration <span>rates</span><a id="id325752049" class="indexterm"></a> for each of the areas we have considered so far. This is the count data, and if it can be assumed that the migration rate is constant, we can use the Poisson model to get the probability of a specified rate of migration. In a Poisson model, the mean and variance are the same.</p><p>Using the <code class="literal">glm()</code> function, we can fit a different GLM model. Here we model the rate of migration, <code class="literal">migration</code>, on <code class="literal">agri</code> and <code class="literal">density</code>, as we have done before. The code for this is as follows:</p><pre class="programlisting">migration_glm = glm(migration ~ agri+density, offset = pop, data=migration_spdf, family = poisson)
summary(migration_glm)</pre><p>The result of this model is as follows:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/eed03f35-ed0a-4af2-adb7-49208dfcedbf.png" /></div><p>Well, the result is now surprising, as <code class="literal">agri</code> and <code class="literal">density</code> are both significant now. But, using a SAR model, we saw that these were insignificant. So, what happened? The answer lies in the residuals of the model. If we have correctly specified the model, the map of residuals should not show any pattern and should instead look random. So, let's map the residuals of this model on the map:</p><pre class="programlisting">migration_spdf$residual = residuals(migration_glm)
spplot(migration_spdf, "residual")</pre><p>This gives us the following map:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/be2a9280-773c-4f19-aa33-e3aab0149314.png" /></div><p>This residual map looks to have some pattern, and the residuals look like they have correlation among them. To be sure, we can further conduct Moran's I test on the residuals:</p><pre class="programlisting">moran.mc(migration_spdf$residual, nb2listw(neighbor_syl), 499)</pre><p>This gives us the following result:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/222daafb-3d0f-4a51-a67a-049d5016b1b6.png" /></div><p>As <code class="literal">p-value</code> is much lower than 0.05, we can say that the residuals are spatially correlated. This means that we need to model this data with other models, and that the Poisson model, with our specifications, is not a good fit here. We'll not discuss other ways of doing so, but we have already seen that we can model this using the spatial autoregression model.</p></div></div>