<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch08lvl1sec48"></a>GRASS GIS</h2></div></div><hr /></div><p>GRASS is a free and open <span>source</span><a id="id325302936" class="indexterm"></a> software that is installed by default along with QGIS Desktop. We can use GRASS both as a stand-alone software or from within QGIS.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch08lvl2sec72"></a>Basics of GRASS GIS</h3></div></div></div><p>Storage of data in GRASS is <span>different</span><a id="id326414100" class="indexterm"></a> from QGIS, and we need to be familiar with the basics before we can start working on the different functionalities provided in GRASS. We need to understand the following terminology before going deeper into GRASS:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">Database</li><li style="list-style-type: disc">Location</li><li style="list-style-type: disc">Mapset</li></ul></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch08lvl3sec24"></a>Database</h4></div></div></div><p>Before we start <span>working</span><a id="id326414124" class="indexterm"></a> on a GRASS GIS project, we need to connect to a <span class="strong"><strong>database</strong></span>. This database is a folder <span>containing</span><a id="id326414138" class="indexterm"></a> a location and a mapset, which are again subdirectories under the database folder.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch08lvl3sec25"></a>Location</h4></div></div></div><p>A <span class="strong"><strong>location</strong></span> contains the coordinate <span>system</span><a id="id326414157" class="indexterm"></a> or map projection of all the spatial data that will be <span>used</span><a id="id326414166" class="indexterm"></a> in a project, and it also has information on map projection and geographical boundaries. A subset of a location bound to different spatial operations <span>using</span><a id="id326414172" class="indexterm"></a> a rectangular box is called a <span class="strong"><strong>region</strong></span>.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch08lvl3sec26"></a>Mapset</h4></div></div></div><p>A <span class="strong"><strong>mapset</strong></span> is a required subdirectory <span>under</span><a id="id326414194" class="indexterm"></a> a location <span>that</span><a id="id326427686" class="indexterm"></a> contains spatial data. Using a mapset, a project can be subdivided into different regions. There are two types of mapset:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><span class="strong"><strong>Permanent</strong></span>: This type of <span>mapset</span><a id="id326427704" class="indexterm"></a> contains read-only data.</li><li style="list-style-type: disc"><span class="strong"><strong>Owner</strong></span>: This contains project-specific <span>spatial</span><a id="id326427718" class="indexterm"></a> data.</li></ul></div></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch08lvl2sec73"></a>Creating a mapset</h3></div></div></div><p>In creating a mapset, the first <span>step</span><a id="id326427733" class="indexterm"></a> is to create a <span>connection</span><a id="id326427741" class="indexterm"></a> to a database. But, first, we will open <strong class="userinput"><code>QGIS Desktop with GRASS</code></strong> instead of <strong class="userinput"><code>QGIS Desktop</code></strong>, which is what we have used so far:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/2dad0b54-5073-4676-8ddc-8ef79a17469c.png" /></div><p> </p><p> </p><p>Now <strong class="userinput"><code>QGIS Desktop with GRASS </code></strong>will open, which looks the same as <strong class="userinput"><code>QGIS Desktop</code></strong>. We need to install the plugin for GRASS by clicking on <strong class="userinput"><code>Manage and Install Plugins</code></strong> under <span class="strong"><strong>Plugins</strong></span>:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/02c190d3-0ba1-42f7-a2cd-421385db50fe.png" /></div><p>The <strong class="userinput"><code>Plugins</code></strong> window will now appear. Select <strong class="userinput"><code>GRASS 7</code></strong> and then click <strong class="userinput"><code>Install Plugin</code></strong>. After the plugin is installed, click <strong class="userinput"><code>Close</code></strong> to start working with this plugin:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/16f8baa5-3e5c-4685-bc61-5e1d0c0f88bc.png" /></div><p> </p><p><strong class="userinput"><code>GRASS</code></strong> comes under the <strong class="userinput"><code>Plugins</code></strong> menu. Click <strong class="userinput"><code>GRASS</code></strong> under <strong class="userinput"><code>Plugins</code></strong> and then click on <strong class="userinput"><code>New Mapset</code></strong>:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/516f3d44-6f56-44e2-b414-3b4063f481c7.png" /></div><p>This prompts us with a <span>new</span><a id="id326495240" class="indexterm"></a> window that <span>asks</span><a id="id326495249" class="indexterm"></a> for <strong class="userinput"><code>Database directory</code></strong>. This is the directory inside which we need to keep all of the spatial data that is to be used for GRASS operations:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/7ccdbabb-c87e-47b1-843a-90f4926f0a7e.png" /></div><p>Browse to the <code class="literal">DB_GRASS</code> directory under the <code class="literal">Data</code> folder of <code class="literal">Chapter 8</code> (if it is not created, create a new folder called <code class="literal">DB_GRASS</code> in this location):</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/5e334b78-1b2e-4058-9e22-93df3934b19d.png" /></div><p>Now, we are prompted with a new window, <strong class="userinput"><code>New Mapset</code></strong>, asking for the <strong class="userinput"><code>GRASS Location</code></strong>. Name the location <code class="literal">BD</code> and click <strong class="userinput"><code>Next</code></strong>, as shown in the screenshot here:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/642dca8e-dca1-4f98-9f44-f06550290e84.png" /></div><p>We now see options for <span>defining</span><a id="id326017938" class="indexterm"></a> coordinate <span>reference</span><a id="id326214828" class="indexterm"></a> systems. Write <code class="literal">4326</code> in <strong class="userinput"><code>Filter</code></strong> and select <strong class="userinput"><code>WGS 84</code></strong> corresponding to <strong class="userinput"><code>EPSG:4326</code></strong>, and then click <strong class="userinput"><code>OK</code></strong>:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/2e24dd47-5215-4311-ad95-b0c4f8b6d7ec.png" /></div><p>Now, we need to select the region for this mapset. Choose <code class="literal">Bangladesh</code> from the dropdown, as we will be working with data from Bangladesh, and then click <strong class="userinput"><code>Next</code></strong>:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/59d9ce38-4c4c-4c59-af5d-df5450989491.png" /></div><p> </p><p> </p><p>Now, we need to give the mapset a name; in this case, write <code class="literal">mapset1</code> (or any other name of your choosing) and click <strong class="userinput"><code>Next</code></strong>:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/e5f91936-c0cc-47b5-8464-dd1c29b8dcce.png" /></div><p>We will now see a new <span>window</span><a id="id326413875" class="indexterm"></a> similar to <span>the</span><a id="id326413883" class="indexterm"></a> following. Click on <strong class="userinput"><code>Finish</code></strong> and then click <strong class="userinput"><code>OK</code></strong>. When successful, a final success message will pop up:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/405ef2c5-77c9-47fa-8a71-83cdc9a34e81.png" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch08lvl2sec74"></a>Importing vector data in GRASS</h3></div></div></div><p>We can add a vector layer as <span>before</span><a id="id326413915" class="indexterm"></a> by clicking on <strong class="userinput"><code>Layer</code></strong> in the top menu, then on <strong class="userinput"><code>Add Layer</code></strong>, and then on <strong class="userinput"><code>Add Vector Layer</code></strong>, before selecting <code class="literal">BGD_adm.shp</code>:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/612ab122-5105-45a5-b934-9eb186bb8d4a.png" /></div><p>The shapefile will be loaded:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/225aff9e-b81a-4ed0-b5b3-dbb6eff31ac7.png" /></div><p>The red box surrounding the map confirms that this file is shown using the facilities of GRASS GIS. Now, to <span>import</span><a id="id326413963" class="indexterm"></a> it into GRASS GIS, we need to write <code class="literal">v.in.ogr.qgis</code> in <strong class="userinput"><code>Filter</code></strong> under <strong class="userinput"><code>GRASS Tools</code></strong>:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/d83b3407-e3bc-4b6a-baac-c8c9bb548b51.png" /></div><p>We now double-click on <code class="literal">v.in.ogr.qgis</code>, which prompts us with another window. Give a new name for the output vector map, <code class="literal">BGD_GRASS</code>, and then click <strong class="userinput"><code>Run</code></strong>:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/b0bc62fb-f39f-4240-b4ad-552acadaa5cf.png" /></div><p>Now we will see a new message, <strong class="userinput"><code>Successfully finished</code></strong>, which means that we have successfully imported the vector data into QGIS:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/766ae2b6-26ab-496a-b566-a60670a09616.png" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch08lvl2sec75"></a>Importing raster data in GRASS</h3></div></div></div><p>We will now import raster <span>data</span><a id="id326495105" class="indexterm"></a> into GRASS QGIS. But, first, we add the <code class="literal">LC08_L1TP_137043_20180410_20180417_01_T1_B2.TIF</code> raster layer into QGIS. We have to ensure that the raster data is in the <code class="literal">WGS 84</code> coordinate reference system, as we have defined <code class="literal">WGS84</code> as the coordinate reference system for our new mapset. We need to reproject the raster into this <code class="literal">WGS 84</code>. To do this, we click on <strong class="userinput"><code>Raster</code></strong> in the top menu and then click on <strong class="userinput"><code>Projections</code></strong>, followed by <strong class="userinput"><code>Warp (Reproject)</code></strong>, as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/c61a2605-b401-4e7d-9f71-d4af10dd1650.png" /></div><p>Now, select any output location and write <code class="literal">EPSG:4326</code> in the <strong class="userinput"><code>Target SRS</code></strong> area. Select <strong class="userinput"><code>Near</code></strong> as <strong class="userinput"><code>Resampling method</code></strong> and select <strong class="userinput"><code>Load into canvas when finished</code></strong>, and then click <strong class="userinput"><code>OK</code></strong>:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/24c35652-87d6-489d-af8b-42895551b9d9.png" /></div><p>Now, we see the raster file with a red, rectangular, hollow box around it, as follows:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/61ce5049-007f-4768-a306-aeac2949d8fa.png" /></div><p>Now, to import <span>raster</span><a id="id326495194" class="indexterm"></a> data into GRASS, write <code class="literal">r.in.gdal.qgis</code> in <strong class="userinput"><code>Filter</code></strong> inside <strong class="userinput"><code>GRASS Tools</code></strong>. Click on that:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/0261fd47-7cf3-4bbf-a24a-5258579a88b9.png" /></div><p> </p><p>We now give a new name for our output raster map; we name it <code class="literal">b1_GRASS</code> here. This will now save <code class="literal">b1_GRASS</code> in our mapset. Finally, click <strong class="userinput"><code>Run</code></strong>, and then after it has finished running, click <strong class="userinput"><code>Close</code></strong>:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/5007fa16-63f8-43ed-b352-107d34b8b397.png" /></div><p><span>Similarly</span>, do this for Band 4, Band 5, and Band 7, and save them as <code class="literal">b4_GRASS</code>, <code class="literal">b5_GRASS</code>, and <code class="literal">b7_GRASS</code>, respectively.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch08lvl2sec76"></a>False color composite in GRASS</h3></div></div></div><p>We will create a false <span>color</span><a id="id326410421" class="indexterm"></a> composite in GRASS QGIS. First, we click on <strong class="userinput"><code>GRASS</code></strong> and then on <strong class="userinput"><code>Open Mapset</code></strong>, as shown in following screenshot:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/79eb3d2e-8cea-49f1-9e10-ab2fb780ff72.png" /></div><p>Now, we select the <code class="literal">DB_GRASS</code> database that we created before and select <strong class="userinput"><code>mapset1</code></strong>, as follows:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/e0e7d4f0-f551-488c-8051-cf3fbc49c9d8.png" /></div><p>Within <strong class="userinput"><code>GRASS Tools</code></strong>, in <strong class="userinput"><code>Filter</code></strong>, type <code class="literal">r.composite</code>. Click on<strong class="userinput"><code>r.composite</code></strong>:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/162e73da-cfe5-4fb9-a7f6-9020a4d4e04a.png" /></div><p>Select <code class="literal">b4_GRASS</code> for red, <code class="literal">b5_GRASS</code> for green, and <code class="literal">b7_GRASS</code> for blue. Write <code class="literal">composite</code> in the <strong class="userinput"><code>Name for output raster map</code></strong> section and then click <strong class="userinput"><code>Run</code></strong>:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/fd7fd002-12b1-4e61-baef-2f3f1bd27a19.png" /></div><p> </p><p>If everything goes well, we will <span>see</span><a id="id326410530" class="indexterm"></a> something like this:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/8222742f-739c-480a-b62a-74eaec5610c7.png" /></div><p>The composite map will look like the following raster screenshot:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/31c6d5f9-9221-400a-8980-e54dfbe87653.png" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch08lvl2sec77"></a>Graphical modeler</h3></div></div></div><p>The graphical modeler provides a <span>wonderful</span><a id="id326292604" class="indexterm"></a> functionality in QGIS that helps us to automate repetitive tasks in QGIS. Suppose we want to clip a raster file according to a shapefile. The steps for this clipping for different sets of rasters and vector files would require us to repeat the same number of steps again and again for different combinations. We can reduce our workload by using a graphical modeler.</p><p>Here, we will clip the <code class="literal">LC08_L1TP_137043_20180410_20180417_01_T1_B2.TIF</code> raster file by the <code class="literal">gazipur</code> shapefile. Let's see how they look by loading them into QGIS:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/28efaa17-57e9-4134-8430-dd149f1bb5ce.png" /></div><p>The <strong class="userinput"><code>Graphical Modeler</code></strong> can be accessed under <strong class="userinput"><code>Processing</code></strong>:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/c1525470-bdfb-42a9-b33c-04db6ca38489.png" /></div><p> </p><p>Now <strong class="userinput"><code>Processing Modeler</code></strong> will open. We see that there are two tabs: <strong class="userinput"><code>Inputs</code></strong> and <strong class="userinput"><code>Algorithms</code></strong>. Using the <strong class="userinput"><code>Inputs</code></strong> tab, we define the inputs for our model; and using <strong class="userinput"><code>Algorithms</code></strong>, we state what to do with those inputs:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/85abba9a-4b94-408d-bc79-1a963d8b60d7.png" /></div><p>First, double-click on <strong class="userinput"><code>Raster Layer</code></strong><span>under</span><a id="id326292689" class="indexterm"></a> the <strong class="userinput"><code>Inputs</code></strong> tab. Give a name for the parameter; here, write <code class="literal">landsat</code>. Click on <strong class="userinput"><code>Mandatory</code></strong> and then click <strong class="userinput"><code>OK</code></strong>:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/16998c2d-7485-4cfd-a182-2f7ab1b8b269.png" /></div><p>Now double-click on <strong class="userinput"><code>Vector Layer</code></strong> under the <strong class="userinput"><code>Inputs</code></strong> tab. For <strong class="userinput"><code>Parameter name</code></strong>, we write <code class="literal">district</code>, but you could provide any name that you feel is appropriate. Select the <strong class="userinput"><code>Geometry type</code></strong> as <strong class="userinput"><code>Polygon</code></strong> and click on <strong class="userinput"><code>Mandatory</code></strong>, then click <strong class="userinput"><code>OK</code></strong>:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/48ca69f6-d554-4176-8435-2dbf52b43ea0.png" /></div><p>Now, the right side of the window will <span>look</span><a id="id326292762" class="indexterm"></a> similar to what we see here:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/dca98bb8-d2d9-4d6c-8468-ae92c1553b79.png" /></div><p>Now click <strong class="userinput"><code>GDAL</code></strong>, then <strong class="userinput"><code>Raster extraction</code></strong>, and then double-click on <strong class="userinput"><code>Clip raster by mask layer</code></strong>. Select <strong class="userinput"><code>landsat</code></strong> as <strong class="userinput"><code>Input layer</code></strong> and <strong class="userinput"><code>district</code></strong> as <strong class="userinput"><code>Mask layer</code></strong>. Give the clipped image a name <strong class="userinput"><code>clipped</code></strong> is what we have provided. Click <strong class="userinput"><code>OK</code></strong>:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/18e94bca-bc8c-4891-98dd-870e586ad472.png" /></div><p>Click on the <strong class="userinput"><code>Play</code></strong> button in the top menu to run this. This will prompt us with yet another window. Under <strong class="userinput"><code>landsat</code></strong>, select the Band 2 image, and under <strong class="userinput"><code>district</code></strong>, select <strong class="userinput"><code>gazipur</code></strong>:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/422f7a17-1079-4986-a3b3-ef848faca8a8.png" /></div><p>Click <strong class="userinput"><code>Run</code></strong> and now we will get a clipped raster:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/1ba40504-ba12-483d-8a3c-9e51d10303a4.png" /></div><p>To remove the black region, right-click the <strong class="userinput"><code>clipped</code></strong> layer and click on <strong class="userinput"><code>Properties</code></strong>. Click on <strong class="userinput"><code>Transparency</code></strong><span>and</span><a id="id325303147" class="indexterm"></a> write <code class="literal">0</code> in the <strong class="userinput"><code>Additional no data value</code></strong> box:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/5005481b-0240-43a3-99a2-854b048adb6a.png" /></div><p> </p><p>Now, we see that the black region is removed from the raster file:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/31851b9f-45ff-4a6a-b03b-ba142a0b88ff.png" /></div></div></div>