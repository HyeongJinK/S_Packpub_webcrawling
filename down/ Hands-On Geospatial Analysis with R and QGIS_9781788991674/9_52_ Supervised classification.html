<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch09lvl1sec52"></a>Supervised classification</h2></div></div><hr /></div><p>In supervised classification, training <span>data</span><a id="id325302936" class="indexterm"></a> is used for classification. This training data is made in such a way that it is representative of the classes or land cover types we want to classify. An unclassified image is classified using the spectral <span>signature</span><a id="id325302951" class="indexterm"></a> of the pixels in <span>the</span><a id="id325302957" class="indexterm"></a> training data or area. There are three main supervised classification algorithms that are used in QGIS: minimum distance, <span class="strong"><strong>maximum likelihood</strong></span> (<span class="strong"><strong>ML</strong></span>), and <span class="strong"><strong>spectral angle mapper</strong></span> (<span class="strong"><strong>SAM</strong></span>). For minimum distance, a pixel is assigned to a class that has a lower Euclidean distance to mean vector of a class than all other classes. In ML, each pixel is assigned to the class that has the highest probability. The SAM algorithm works by computing the angle between the mean vector of the class and the unclassified raster data, and the class for which the angle is the smallest is assigned to be the class of the unclassified pixels.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl2sec79"></a>Supervised classification in QGIS</h3></div></div></div><p>We will classify l<span>andsat 8</span>images <span>looking</span><a id="id325974166" class="indexterm"></a> at different land use patterns. We will use Band 3 (red), Band 4 (near infrared), and Band 5, or<span class="strong"><strong>shortwave infrared</strong></span>(<span class="strong"><strong>SWIR</strong></span>), here. We use the <span>band</span><a id="id325974183" class="indexterm"></a> combination 5, 4, and 3 for a<span class="strong"><strong>color infrared</strong></span>(<span class="strong"><strong>CIR</strong></span>) image. In the following outputs, vegetation will pop up as red, and dead or unhealthy <span>plants</span><a id="id325987921" class="indexterm"></a> will appear in less intense red, green, pink, or tan. Sandy soil will appear as white, gray, or light tan, and water and roads will appear as shades of blue to black.</p><p>First, we load bands 3, 4, and 5 from <code class="literal">folder 2</code> under the <code class="literal">Mosaic</code> folder, which is inside the <code class="literal">Data</code> folder of <code class="literal">Chapter 4</code>:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/51615a61-8a6a-4acc-8170-17ad826e8ac6.png" /></div><p>As landsat is multispectral and as we want to work with three bands, we need to make a false color composite using these three bands. To merge these three raster bands, click on <strong class="userinput"><code>Raster</code></strong>, then on <strong class="userinput"><code>Miscellaneous</code></strong>, and then on <strong class="userinput"><code>Merge</code></strong>, as follows:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/fe73af3a-cc08-4797-ae2b-92486ec19c2b.png" /></div><p>Now, we will see this window. Click on <strong class="userinput"><code>Place each input file into a separate band</code></strong> so that we can assign different bands to different colors of red, green, and blue later. We need to select all three of these rasters for <strong class="userinput"><code>Input layers</code></strong>. We do so by clicking on the <strong class="userinput"><code>...</code></strong> box to the right of the <strong class="userinput"><code>Input</code></strong> layers:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/58577d15-a41c-48a2-93c4-4301105f5307.png" /></div><p>Now, tick all the required bands or rasters, or for this case, click <strong class="userinput"><code>Select all</code></strong>, and then click <strong class="userinput"><code>OK</code></strong>:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/85c393df-b41d-4704-95aa-9c5c3a8e191d.png" /></div><p>At the bottom of the <strong class="userinput"><code>Merge</code></strong> window, under <strong class="userinput"><code>Merged</code></strong>, browse to the folder where we want to save the file <span>and</span><a id="id326002092" class="indexterm"></a> give a name (here, the name we give is <code class="literal">merged_b3_b4_b5.tif</code>). Click on <strong class="userinput"><code>Open output file after running algorithm</code></strong> and then click on <strong class="userinput"><code>Run in Background</code></strong>:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/5c253b79-5ebc-41dd-9c98-f69c172acbd6.png" /></div><p> </p><p>In seconds, we will see the merged TIF file. But, <span class="strong"><strong>RGB</strong></span> ( short for <span class="strong"><strong>red</strong></span>, <span class="strong"><strong>green</strong></span>, and <span class="strong"><strong>blue</strong></span>) color has not been assigned as we would want:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/dffc7e34-f18e-42aa-857f-6a817bc62336.png" /></div><p> </p><p>We can do so by right-clicking on this raster and clicking on <strong class="userinput"><code>Properties</code></strong>. Click on <strong class="userinput"><code>Symbology</code></strong>, then select <strong class="userinput"><code>Multiband color</code></strong> as <strong class="userinput"><code>Render type</code></strong>. Now, assign <strong class="userinput"><code>Band 3</code></strong> to <strong class="userinput"><code>Red band</code></strong>, <strong class="userinput"><code>Band 2</code></strong> to <strong class="userinput"><code>Green band</code></strong>, and <strong class="userinput"><code>Band 1</code></strong> to <strong class="userinput"><code>Blue band</code></strong>. Click on <strong class="userinput"><code>Apply</code></strong> and then click on <strong class="userinput"><code>OK</code></strong>:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/329975a6-e420-4677-bdab-9534d2817714.png" /></div><p>Now, we will get the following CIR image. With the naked eye, we can now differentiate land cover classification to some extent, but as we zoom into this image, it becomes <span>clear</span><a id="id326017906" class="indexterm"></a> that this classification is rather nuanced, and if we wanted to digitize this image by ourselves, the process would be very time-consuming and prone to error. This is where supervised classification comes in: </p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/5caf316b-3b0e-4fb3-8afd-f7924bdb0676.png" /></div><p> </p><p>We can also use the SCP in QGIS to get a CIR image. We need to install the SCP from <strong class="userinput"><code>Plugins</code></strong> and then, under <strong class="userinput"><code>SCP</code></strong>, click on <strong class="userinput"><code>Band set</code></strong>:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/fc252078-dc57-42bc-8de9-271e26bfe5e5.png" /></div><p>Under <strong class="userinput"><code>Single band list</code></strong>, click on the bands that we want to work on (Band 5, 4, and 3) and then click on the <span class="strong"><strong><strong class="userinput"><code>+</code></strong></strong></span> under <strong class="userinput"><code>Single band list</code></strong> to create a <strong class="userinput"><code>Band set</code></strong>. Now, use the arrow under the <strong class="userinput"><code>Band set</code></strong> definition to put <strong class="userinput"><code>Band 5</code></strong> first, followed by <strong class="userinput"><code>Band 4</code></strong>, and then <strong class="userinput"><code>Band 3</code></strong>. Click on <strong class="userinput"><code>Quick wavelength settings</code></strong> and then select <strong class="userinput"><code>Landsat 8 OLI (bands 2, 3, 4, 5, 6, 7)</code></strong>, tick <strong class="userinput"><code>Create raster of band set</code></strong><strong class="userinput"><code>(stack bands)</code></strong>, and then click on <strong class="userinput"><code>Run</code></strong>:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/a31f1c3b-f247-4640-a69a-7ec8dd5d969d.png" /></div><p>Now, inside <strong class="userinput"><code>SCP &amp;Dock</code></strong>, click on <strong class="userinput"><code>Training input</code></strong> and then click on <strong class="userinput"><code>Create a new training input box</code></strong> (the box with the yellow symbol at the top):</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/bcecc568-b743-46e5-adf3-c780d19db858.png" /></div><p> </p><p>This now creates an SCP file; the training <span>data</span><a id="id326055979" class="indexterm"></a> that we will create now will be populated into this SCP file:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/64f1ee79-09a0-488f-a5ff-765d45bd5042.png" /></div><p>Now, we need to create a training file, and we do so by selecting different areas of the raster file and classifying them according to our judgement or knowledge. Now, to create polygons that will be assigned to different classes, click on the symbol third from the right to start digitizing, and generate the training data:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/6fe1f96a-23bd-429d-ba97-242017094a1c.png" /></div><p>Start making a polygon by left-clicking, then right-click when the polygon covers the desired area sufficiently. Here we are digitizing to create a signature for the river:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/6e29f874-80af-432e-989a-1dcf2cbfc009.png" /></div><p>Now, in the <strong class="userinput"><code>SCP &amp;Dock</code></strong> window, for <strong class="userinput"><code>MC Info</code></strong> (short for <span class="strong"><strong>macro class</strong></span>) and for <strong class="userinput"><code>C info</code></strong> (short for <span class="strong"><strong>class</strong></span>) , enter <code class="literal">Water</code> in both fields. For <strong class="userinput"><code>MC ID</code></strong> and <strong class="userinput"><code>C ID</code></strong>, enter <code class="literal">1</code> in <span>both</span><a id="id326091073" class="indexterm"></a> fields. Now, click on <strong class="userinput"><code>Signature</code></strong> to <span>calculate</span><a id="id326091084" class="indexterm"></a> the signature for the <code class="literal">Water</code> polygon:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/ff629859-4968-4299-bd82-81ec44680765.png" /></div><p>Similarly, do this for other areas of <code class="literal">Water</code>; that is, make a couple more such polygons of <code class="literal">Water</code>. Now we will create polygons for <code class="literal">Vegetation</code>. Select a dark red area and create a polygon as previously outlined:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/7f13bd41-5f67-4046-be17-a8535d5f7bfc.png" /></div><p>Similar to how we did with <code class="literal">Water</code>, write <code class="literal">Vegetation</code> for <strong class="userinput"><code>MC Info</code></strong> and <strong class="userinput"><code>C Info</code></strong> and write <code class="literal">2</code> for <strong class="userinput"><code>MC ID</code></strong> and <strong class="userinput"><code>C ID</code></strong>, and then click on <strong class="userinput"><code>Signature</code></strong>:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/547f8c13-3588-4c86-be93-e8c5bb1d8319.png" /></div><p> </p><p>For soil, move to a tan area and make a polygon there:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/7b08d10f-43a0-43aa-9927-87e661fd4c7e.png" /></div><p> </p><p>Similar to how we did for <strong class="userinput"><code>Water</code></strong> and <strong class="userinput"><code>Vegetation</code></strong>, create a signature for <strong class="userinput"><code>Soil</code></strong>:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/10dec37e-51dc-4aa8-ad6e-a88e084b3ddb.png" /></div><p>If we find that we have <span>wrongly</span><a id="id326112092" class="indexterm"></a> classified or wrongly generated a signature for a classification, we can remove that item by clicking on the <span class="strong"><strong>-</strong></span> sign in the bottom-left corner of this screenshot:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/8b6ed885-53b5-400f-a26e-205dc517f3c7.png" /></div><p>If we want to get the average signature for a class, we can select all relevant signatures (for example, <strong class="userinput"><code>Water</code></strong>) by clicking on all signatures of <strong class="userinput"><code>Water</code></strong> and then clicking on Merge highlighted spectral signatures obtaining the average signature:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/93b8c312-1070-436d-b8a9-b36d7d50bbfe.png" /></div><p>The preceding input results in another signature called <strong class="userinput"><code>merged_Water</code></strong>. We can also do this for <strong class="userinput"><code>Vegetation</code></strong>, for which we will again get <strong class="userinput"><code>merged_Vegetation</code></strong>. After we do the same for <strong class="userinput"><code>Soil</code></strong>, also, we get <strong class="userinput"><code>merged_Soil</code></strong>:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/d931a23e-d042-41ac-9955-d76113d51383.png" /></div><p> </p><p>Now, we can click on the plotting <span>symbols</span><a id="id326112915" class="indexterm"></a> to look at how well the spectral separability is. Click on <strong class="userinput"><code>Classification</code></strong> and then select <strong class="userinput"><code>Maximum Likelihood</code></strong> under <strong class="userinput"><code>Algorithm</code></strong>, then tick <strong class="userinput"><code>Classification report</code></strong> and click on <strong class="userinput"><code>OK</code></strong>:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/0f049ebf-1f8d-4280-884f-94fe1efb635c.png" /></div><p>This will now give us an image classified according to the signature that we have generated.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl2sec80"></a>Creating a validation shapefile</h3></div></div></div><p>We will learn here how to <span>create</span><a id="id326112956" class="indexterm"></a> a validation shapefile. To do so, we need to create a new shapefile and then digitize a raster file to populate the shapefile with attribute information. Now, click on <strong class="userinput"><code>Layer</code></strong>, then <strong class="userinput"><code>Create Layer</code></strong>, and then on <strong class="userinput"><code>New Shapefile Layer...</code></strong></p><p>Now, save it to your desired location and <span>create</span><a id="id326115468" class="indexterm"></a> a new field named <strong class="userinput"><code>class</code></strong>, as follows:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/ea165915-9836-4c17-8f78-ef8fc04e5416.png" /></div><p>Again, we need to digitize, and so we need to click on <strong class="userinput"><code>Toggle Editing</code></strong>:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/f946efef-41aa-423a-8c9c-2fe4cbfd4ae6.png" /></div><p> </p><p>Now, create a polygon by left-clicking and stopping by right-clicking when the desired shape is formed. As soon as we are finished with that, fill in as required:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/f4deef18-48b7-4756-9f42-cb03b280ed35.png" /></div><p>Similarly, do this for <strong class="userinput"><code>Vegetation</code></strong> and <strong class="userinput"><code>Soil</code></strong> and write their attributes as <code class="literal">2</code> and <code class="literal">3</code>. Now, if we open the attribute table of this shapefile, we will see something similar to this:</p><div class="mediaobject"><img src="/graphics/9781788991674/graphics/f409d72e-c1d0-473e-a5fe-fce68c260f61.png" /></div><p> </p><p> </p></div></div>