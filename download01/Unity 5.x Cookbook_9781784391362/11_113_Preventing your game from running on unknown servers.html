<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch11lvl1sec110"></a>Preventing your game from running on unknown servers</h2></div></div><hr /></div><p>After all the hard <a id="id1183" class="indexterm"></a>work you've had to go through to complete your web game project, it wouldn't be fair if it ended up generating traffic and income on someone else's website. In this recipe, we will create a script that prevents the main game menu from showing up unless it's hosted by an authorized server.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch11lvl2sec343"></a>Getting ready</h3></div></div></div><p>To test this recipe, you will need access to a webspace provider where you can host the game.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch11lvl2sec344"></a>How to do it...</h3></div></div></div><p>To prevent your web <a id="id1184" class="indexterm"></a>game from being pirated, follow these steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>From the <span class="strong"><strong>Hierarchy</strong></span> view, use the <span class="strong"><strong>Create</strong></span> drop-down menu to create a <span class="strong"><strong>UI Text</strong></span> GameObject (<span class="strong"><strong>Create</strong></span> | <span class="strong"><strong>UI</strong></span> | <span class="strong"><strong>Text</strong></span>). Name it <code class="literal">Text – warning</code>. Then, from the <span class="strong"><strong>Text</strong></span> component in the <span class="strong"><strong>Inspector</strong></span>, change its <span class="strong"><strong>text</strong></span> field to <code class="literal">Getting Info. Please wait</code>.</p></li><li><p>Add the following C# script to the <code class="literal">Text – warning</code> game object:</p><div class="informalexample"><pre class="programlisting">using UnityEngine;
using System.Collections;
using UnityEngine.UI;

public class BlockAccess : MonoBehaviour {
  public bool checkDomain = true;
  public bool fullURL = true;
  public string[] domainList;
  public string warning;


  private void Start(){
    Text scoreText = GetComponent&lt;Text&gt;();
    bool illegalCopy = true;

    if (Application.isEditor)
      illegalCopy = false;

    if (Application.isWebPlayer &amp;&amp; checkDomain){
      for (int i = 0; i &lt; domainList.Length; i++){
        if (Application.absoluteURL == domainList[i]){
          illegalCopy = false;
        }else if (Application.absoluteURL.Contains(domainList[i]) &amp;&amp; !fullURL){
          illegalCopy = false;
        }
      }
    }

    if (illegalCopy)
      scoreText.text = warning;
    else
      Application.LoadLevel(Application.loadedLevel + 1);
  }
}</pre></div></li><li><p>From the <span class="strong"><strong>Inspector</strong></span> view, leave the options <span class="strong"><strong>Check Domain</strong></span> and <span class="strong"><strong>Full URL</strong></span> checked, and increase <span class="strong"><strong>Size</strong></span> of <span class="strong"><strong>Domain List</strong></span> to <code class="literal">1</code> and fill out <span class="strong"><strong>Element 0</strong></span> with the complete <a id="id1185" class="indexterm"></a>URL for your game. Type in the sentence <code class="literal">This is not a valid copy of the game</code> in the <span class="strong"><strong>Message</strong></span> field, as shown in the following screenshot. You might have to change the paragraph's <span class="strong"><strong>Horizontal Overflow</strong></span> to <span class="strong"><strong>Overflow</strong></span>.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note56"></a>Note</h3><p>Note: Remember to include the Unity 3D file name and extension in the URL, and not the HTML where it is embedded.</p></div><div class="mediaobject"><img src="/graphics/9781784391362/graphics/1362OT_11_08.jpg" /></div></li><li><p>Save your scene as <code class="literal">menu</code>.</p></li><li><p>Create a new scene and change its <span class="strong"><strong>Main Camera</strong></span> background color to black. Save this scene as <code class="literal">nextLevel</code>.</p></li><li><p>Let's build the game. Go to the <span class="strong"><strong>File | Build Settings…</strong></span> menu and include the scenes <span class="strong"><strong>menu</strong></span> and <span class="strong"><strong>nextLevel</strong></span>, in that order, in the build list (<span class="strong"><strong>Scenes</strong></span> in <span class="strong"><strong>Build</strong></span>). Also, select <span class="strong"><strong>Web Player</strong></span> as your platform and click on <span class="strong"><strong>Build</strong></span>.</p></li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch11lvl2sec345"></a>How it works...</h3></div></div></div><p>As soon as the scene starts, the script compares the actual URL of the <code class="literal">.unity3d</code> file to the ones listed in the <code class="literal">Block Access</code> component. If they don't match, the next level in the build is not loaded and a message appears on the screen. If they do match, the line of code <code class="literal">Application.LoadLevel(Application.loadedLevel + 1)</code> will load the next scene from the<a id="id1186" class="indexterm"></a> build list.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch11lvl2sec346"></a>There's more...</h3></div></div></div><p>Here is some information on how to fine tune and customize this recipe.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch11lvl3sec91"></a>Improving security by using full URLs in your domain list</h4></div></div></div><p>Your game will be<a id="id1187" class="indexterm"></a> more secure if you fill out the domain list with complete URLs (such as <a class="ulink" href="http://www.myDomain.com/unitygame/game.unity3d" target="_blank">http://www.myDomain.com/unitygame/game.unity3d</a>). In fact, it's recommended that you leave the <span class="strong"><strong>Full URL</strong></span> option selected so that your game won't be stolen and published under a URL such as <code class="literal">www.stolenGames.com/yourgame.html?www.myDomain.com</code>.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch11lvl3sec92"></a>Allowing redistribution with more domains</h4></div></div></div><p>If you want <a id="id1188" class="indexterm"></a>your game to run from several different domains, increase <span class="strong"><strong>Size</strong></span> and fill out more URLs. Also, you can leave your game completely free of protection by leaving the <span class="strong"><strong>Check Domain</strong></span> option unchecked.</p></div></div></div>