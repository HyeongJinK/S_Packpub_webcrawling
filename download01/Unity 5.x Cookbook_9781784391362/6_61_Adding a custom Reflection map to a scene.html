<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch06lvl1sec63"></a>Adding a custom Reflection map to a scene</h2></div></div><hr /></div><p>Whereas<a id="id539" class="indexterm"></a> Unity <span class="strong"><strong>Legacy Shaders</strong></span> use individual <span class="strong"><strong>Reflection Cubemaps</strong></span> per material, the new <span class="strong"><strong>Standard Shader</strong></span> gets its reflection from the scene's <span class="strong"><strong>Reflection Source</strong></span>, as configured in the <span class="strong"><strong>Scene</strong></span> section of the <span class="strong"><strong>Lighting</strong></span> window. The level of reflectiveness for each material is now given by its <span class="strong"><strong>Metallic</strong></span> value or <span class="strong"><strong>Specular</strong></span> value (for materials using Specular setup). This new method can be a <span class="emphasis"><em>real</em></span> time saver, allowing you to quickly assign the same reflection map to every object in the scene. Also, as you can imagine, it helps keep the overall look of the scene coherent and cohesive. In this recipe, we will learn how to take advantage of the <span class="strong"><strong>Reflection Source</strong></span> feature.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec175"></a>Getting ready</h3></div></div></div><p>For this recipe, we will prepare a <span class="strong"><strong>Reflection Cubemap</strong></span>, which is basically the environment to be projected as a reflection onto the material. It can be made from either six or, as shown in this recipe, a single image file.</p><p>To help us with this recipe, it's been provided a Unity package, containing a prefab made of a 3D object and a basic Material (using a TIFF as Diffuse map), and also a JPG file to be used as the reflection map. All these files are inside the <code class="literal">1362_06_02</code> folder.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec176"></a>How to do it...</h3></div></div></div><p>To add Reflectiveness and Specularity to a material, follow these steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Import <code class="literal">batteryPrefab.unitypackage</code> to a new project. Then, select <code class="literal">battery_prefab</code> object from the <span class="strong"><strong>Assets</strong></span> folder, in the <span class="strong"><strong>Project</strong></span> view.</p></li><li><p>From the <span class="strong"><strong>Inspector</strong></span> view, expand the <span class="strong"><strong>Material</strong></span> component and observe the asset preview window. Thanks to the <span class="strong"><strong>Specular</strong></span> map, the material already features a reflective look. However, it looks as if it is reflecting the scene's default <span class="strong"><strong>Skybox</strong></span>, as shown:</p><div class="mediaobject"><img src="/graphics/9781784391362/graphics/1362_06_06.jpg" /></div></li><li><p>Import the<a id="id540" class="indexterm"></a> <code class="literal">CustomReflection.jpg</code> image file. From the <span class="strong"><strong>Inspector</strong></span> view, change its <span class="strong"><strong>Texture Type</strong></span> to <span class="strong"><strong>Cubemap</strong></span>, its <span class="strong"><strong>Mapping</strong></span> to <span class="strong"><strong>Latitude - Longitude Layout (Cylindrical)</strong></span>, and check the boxes for <span class="strong"><strong>Glossy Reflection</strong></span> and <span class="strong"><strong>Fixup Edge Seams</strong></span>. Finally, change its <span class="strong"><strong>Filter Mode</strong></span> to <span class="strong"><strong>Trilinear</strong></span> and click on the <span class="strong"><strong>Apply</strong></span> button, shown as follows:</p><div class="mediaobject"><img src="/graphics/9781784391362/graphics/1362_06_07.jpg" /></div></li><li><p>Let's replace the Scene's Skybox with our newly created <span class="strong"><strong>Cubemap</strong></span>, as the <span class="strong"><strong>Reflection</strong></span><a id="id541" class="indexterm"></a><span class="strong"><strong> map</strong></span> for our scene. In order to do this, open the <span class="strong"><strong>Lighting</strong></span> window by navigating to the <span class="strong"><strong>Window</strong></span> | <span class="strong"><strong>Lighting</strong></span> menu. Select the <span class="strong"><strong>Scene</strong></span> section and use the drop-down menu to change the <span class="strong"><strong>Reflection Source</strong></span> to <span class="strong"><strong>Custom.</strong></span> Finally, assign the newly created <code class="literal">CustomReflection</code> texture as the <span class="strong"><strong>Cubemap</strong></span>, shown as follows:</p><div class="mediaobject"><img src="/graphics/9781784391362/graphics/1362_06_08.jpg" /></div></li><li><p>Check out<a id="id542" class="indexterm"></a> for the new reflections on the <code class="literal">battery_prefab</code> object.</p><div class="mediaobject"><img src="/graphics/9781784391362/graphics/1362_06_09.jpg" /></div></li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec177"></a>How it works...</h3></div></div></div><p>While it is the material's specular map that allows for a reflective look, including the intensity and smoothness of the reflection, the refection itself (that is, the image you see on the reflection) is given by the <a id="id543" class="indexterm"></a><span class="strong"><strong>Cubemap</strong></span> that we have created from the image file.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec178"></a>There's more...</h3></div></div></div><p>Reflection Cubemaps can be achieved in many ways and have different mapping properties.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch06lvl3sec53"></a>Mapping coordinates</h4></div></div></div><p>The <span class="strong"><strong>Cylindrical</strong></span> mapping that we applied was well-suited for the photograph that we used. However, depending<a id="id544" class="indexterm"></a> on how the reflection image is generated, a <span class="strong"><strong>Cubic</strong></span> or <span class="strong"><strong>Spheremap</strong></span>-based mapping can be more appropriate. Also, note that the <span class="strong"><strong>Fixup Edge Seams</strong></span> option will try to make the image seamless.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch06lvl3sec54"></a>Sharp reflections</h4></div></div></div><p>You might have noticed<a id="id545" class="indexterm"></a> that the reflection is somewhat blurry compared to the original image; this is because we have ticked the <span class="strong"><strong>Glossy Reflections</strong></span> box. To get a sharper-looking reflection, deselect this option; in which case, you can also leave the <span class="strong"><strong>Filter Mode</strong></span> option as default (Bilinear).</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch06lvl3sec55"></a>Maximum size</h4></div></div></div><p>At 512 x 512 pixels, our reflection map will probably run fine on the lower-end machines. However, if the<a id="id546" class="indexterm"></a> quality of the reflection map is not so important in your game's context, and the original image dimensions are big (say, 4096 x 4096), you might want to change the texture's <span class="strong"><strong>Max Size</strong></span> at the <span class="strong"><strong>Import Settings</strong></span> to a lower number.</p></div></div></div>