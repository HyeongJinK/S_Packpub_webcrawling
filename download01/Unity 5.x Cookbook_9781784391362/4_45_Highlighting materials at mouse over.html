<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch04lvl1sec49"></a>Highlighting materials at mouse over</h2></div></div><hr /></div><p>Changing the color of an object at runtime can be a very effective way of letting players know that they <a id="id402" class="indexterm"></a>can interact with it. This is very useful in a number of game <span class="emphasis"><em>genres</em></span>, such as puzzles and point-and-click adventures, and it can also be used to create 3D user interfaces.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec128"></a>Getting ready</h3></div></div></div><p>For this recipe, we'll use objects created directly in Unity. Alternatively, you can use any 3D model you like.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec129"></a>How to do it...</h3></div></div></div><p>To highlight a material at mouse-over, follow these steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Create a new 3D project, and add a <span class="strong"><strong>Cube</strong></span> to the scene (from the <span class="strong"><strong>Hierarchy</strong></span> view, navigate to <span class="strong"><strong>Create</strong></span> | <span class="strong"><strong>3D Object</strong></span> | <span class="strong"><strong>Cube</strong></span>).</p></li><li><p>From the <span class="strong"><strong>Project</strong></span> view, click the <span class="strong"><strong>Create</strong></span> drop-down menu and choose <span class="strong"><strong>Material</strong></span>. Name it <code class="literal">HighlightMaterial</code>.</p></li><li><p>Select <span class="strong"><strong>HighlightMaterial</strong></span>, and, from the <span class="strong"><strong>Inspector</strong></span> view, change its <span class="strong"><strong>Albedo</strong></span> color to gray (R: <code class="literal">135</code>, G: <code class="literal">135</code>, B: <code class="literal">135</code>), its <span class="strong"><strong>Emission</strong></span> intensity to <code class="literal">1</code>, as shown in the screenshot below, and it's <span class="strong"><strong>Emission</strong></span> color to R: <code class="literal">1</code>, G: <code class="literal">1</code>, <span class="strong"><strong>B: </strong></span>
<code class="literal">1</code>:</p><div class="mediaobject"><img src="/graphics/9781784391362/graphics/1362OT_04_56.jpg" /></div></li><li><p>Assign <span class="strong"><strong>HighlightMaterial</strong></span> to the <span class="strong"><strong>Cube</strong></span> that you previously created.</p></li><li><p>From the <span class="strong"><strong>Project</strong></span> view, click on the <span class="strong"><strong>Create</strong></span> drop-down menu and choose <span class="strong"><strong>C# Script</strong></span>. Rename it <code class="literal">HighlightObject</code> and open it in your editor.</p></li><li><p>Replace everything with the following code:</p><div class="informalexample"><pre class="programlisting">using UnityEngine;
using System.Collections;
public class HighlightObject : MonoBehaviour{
  private Color initialColor;
  public bool noEmissionAtStart = true;
  public Color highlightColor = Color.red;
  public Color mousedownColor = Color.green;

  private bool mouseon = false;
  private Renderer myRenderer;

  void Start() {
    myRenderer = GetComponent&lt;Renderer&gt;();
    if (noEmissionAtStart)
    initialColor = Color.black;
    else
    initialColor = myRenderer.material.GetColor("_EmissionColor");
  }

  void OnMouseEnter(){
    mouseon = true;
    myRenderer.material.SetColor("_EmissionColor", highlightColor);
  }

  void OnMouseExit(){
    mouseon = false;
    myRenderer.material.SetColor("_EmissionColor",initialColor);
  }

  void OnMouseDown(){
    myRenderer.material.SetColor("_EmissionColor", mousedownColor);
  }

  void OnMouseUp(){
    if (mouseon)
    myRenderer.material.SetColor("_EmissionColor", highlightColor);
    else
    myRenderer.material.SetColor("_EmissionColor", initialColor);
  }
}</pre></div></li><li><p>Save <a id="id403" class="indexterm"></a>your script and attach it to the <span class="strong"><strong>Cube</strong></span>.</p></li><li><p>Select the <span class="strong"><strong>Cube</strong></span>, and, in the <span class="strong"><strong>Inspector</strong></span> view, set the <span class="strong"><strong>Highlight Color</strong></span> and <span class="strong"><strong>Mousedown Color</strong></span> values to any colors that you would like:</p><div class="mediaobject"><img src="/graphics/9781784391362/graphics/1362OT_04_29.jpg" /></div></li><li><p>If you are using the script with your own imported 3D mesh, please make sure you add a <span class="strong"><strong>Collider</strong></span> component to your object.</p></li><li><p>Test the scene. The <span class="strong"><strong>Cube</strong></span> will be highlighted red when the mouse is over it (and green when clicked on).</p></li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec130"></a>How it works...</h3></div></div></div><p>The cube is automatically sent the mouse enter/exit/down/up events as the user moves the mouse pointer over and away from the part of the screen where the cube is visible. Our script adds a behavior to the cube when these events are detected. The <code class="literal">Start()</code> method gets a reference to the <code class="literal">Renderer</code> component of the GameObject that the script has been added to, and stores it in the variable <code class="literal">myRenderer</code> (note that 'renderer' already has a meaning in Unity so it is not appropriate as a private variable name for this script). The Boolean variable called <code class="literal">mouseon</code> records whether or not the mouse pointer is currently over the object. When the mouse button is released, we use the <code class="literal">mouseon</code> variable to decide whether to change the cube back to its initial color (<code class="literal">mouseon</code> FALSE, so the mouse pointer is away from the cube), or back to its highlight color (<code class="literal">mouseon</code> TRUE, so the mouse pointer is over the cube).</p><p>The reason we needed to change the material's original <span class="strong"><strong>Emission</strong></span> color to ultra, dark gray is that leaving it black would have caused Unity to optimize the Shader by removing the <span class="strong"><strong>Emission</strong></span> property from the material. Our script wouldn't have worked if this had happened.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec131"></a>There's more...</h3></div></div></div><p>You can achieve other interesting results by changing the other properties of your material (by changing the <code class="literal">_EmissionColor</code> script to <code class="literal">_Color</code> or <code class="literal">"_SpecularColor</code>, for instance). For a full list of properties, select your material, and, in the <span class="strong"><strong>Inspector</strong></span> view, click on the <span class="strong"><strong>Edit</strong></span> button, at the side of the <span class="strong"><strong>Shader</strong></span> drop-down menu.</p></div></div>