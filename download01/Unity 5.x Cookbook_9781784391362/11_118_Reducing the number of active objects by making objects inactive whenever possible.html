<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch11lvl1sec115"></a>Reducing the number of active objects by making objects inactive whenever possible</h2></div></div><hr /></div><p>
<span class="strong"><strong>Optimization principal 1</strong></span>: Minimize the number of active and enabled objects in a scene.</p><p>Sometimes, we<a id="id1220" class="indexterm"></a> may not want to completely remove an object, but it is possible to go one step further than disabling a scripted component by making the parent <code class="literal">GameObject</code> that contains the scripted component <code class="literal">inactive</code>. This is just like deselecting the checkbox next to the <code class="literal">GameObject</code> in the <span class="strong"><strong>Inspector</strong></span>, as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781784391362/graphics/1362OT_11_19.jpg" /></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch11lvl2sec361"></a>How to do it...</h3></div></div></div><p>To reduce computer processing <span class="emphasis"><em>workload</em></span> requirements by making an object inactive when it becomes invisible, follow these steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Copy the previous recipe.</p></li><li><p>Remove the scripted component <code class="literal">DisableWhenNotVisible</code> from your <span class="strong"><strong>Cube</strong></span>, and instead, add the following C# script class <code class="literal">InactiveWhenNotVisible</code> to <span class="strong"><strong>Cube</strong></span>:</p><div class="informalexample"><pre class="programlisting">using UnityEngine;
using System.Collections;
using UnityEngine.UI;

public class InactiveWhenNotVisible : MonoBehaviour {
  // button action
  public void BUTTON_ACTION_MakeActive(){
    gameObject.SetActive(true);
    makeActiveAgainButton.SetActive(false);
  }

  public GameObject makeActiveAgainButton;

  private GameObject player;

  void Start(){
    player = GameObject.FindGameObjectWithTag("Player");
  }

  void OnBecameInvisible() {
    makeActiveAgainButton.SetActive(true);
    print ("cube became invisible");
    gameObject.SetActive(false);
  }

  void Update(){
    float d = Vector3.Distance( transform.position, player.transform.position);
    print(Time.time + ": distance from player to cube = " + d);
  }
}</pre></div></li><li><p>Create a new <span class="strong"><strong>Button</strong></span>, containing the text <code class="literal">Make Cube Active Again</code>, and position the button so that it is at the top of the <span class="strong"><strong>Game</strong></span> panel and stretches the entire width<a id="id1221" class="indexterm"></a> of the <span class="strong"><strong>Game</strong></span> panel, as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781784391362/graphics/1362OT_11_20.jpg" /></div></li><li><p>With the <span class="strong"><strong>Button</strong></span> selected in the <span class="strong"><strong>Hierarchy</strong></span>, add a new <span class="strong"><strong>On Click()</strong></span> event for this button, dragging the <span class="strong"><strong>Cube</strong></span> as the target GameObject and selecting public function <code class="literal">BUTTON_ACTION_makeCubeActiveAgain()</code>.</p></li><li><p>Uncheck the active checkbox next to the <span class="strong"><strong>Button</strong></span> name in the <span class="strong"><strong>Inspector</strong></span> (in other words, manually deactivate this <span class="strong"><strong>Button</strong></span> so that we don't see the <span class="strong"><strong>Button</strong></span> when the scene first runs).</p></li><li><p>Select the <span class="strong"><strong>Cube</strong></span> in the <span class="strong"><strong>Inspector</strong></span> and drag the <span class="strong"><strong>Button</strong></span> into the <code class="literal">MakeActiveAgainButton</code> variable slot of its script class <code class="literal">InactiveWhenNotVisible</code> component, as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781784391362/graphics/1362OT_11_21.jpg" /></div></li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch11lvl2sec362"></a>How it works...</h3></div></div></div><p>Initially, the <span class="strong"><strong>Cube</strong></span> is visible and the <span class="strong"><strong>Button</strong></span> is inactive (so not visible to the user). When the <span class="strong"><strong>Cube</strong></span> receives an <code class="literal">OnBecameInvisible</code> event message, its <code class="literal">OnBecameInvisible()</code> method will execute. This method performs two actions:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>It first <a id="id1222" class="indexterm"></a>enables (and therefore makes visible) the <code class="literal">Button</code>.</p></li><li style="list-style-type: disc"><p>It then makes inactive the script's parent <code class="literal">gameObject</code> (that is, the <code class="literal">Cube</code> GameObject).</p></li></ul></div><p>When the <span class="strong"><strong>Button</strong></span> is clicked, it makes the <span class="strong"><strong>Cube</strong></span> object active again and makes the <span class="strong"><strong>Button</strong></span> inactive again. So, at any one time, only one of the <span class="strong"><strong>Cube</strong></span> and <span class="strong"><strong>Button</strong></span> objects are active, and each makes itself inactive when the other is active.</p><p>Note that an inactive <code class="literal">GameObject</code> does not receive <span class="emphasis"><em>any</em></span> messages, so it will not receive the <code class="literal">OnBecameVisible()</code> message, and this may not be appropriate for every object that is out of sight of the camera. However, when deactivating objects is appropriate, a larger performance saving is made compared to simply disabling a single scripted <code class="literal">Monobehaviour</code> component of a <code class="literal">GameObject</code>.</p><p>The only way to reactivate an inactive object is for another object to set the <code class="literal">GameObject</code> component's active property back to <code class="literal">true</code>. In this recipe, it is the <code class="literal">Button</code> GameObject, which, when clicked, runs the <code class="literal">BUTTON_ACTION_makeCubeActiveAgain()</code> method, which allows our game to make the <span class="strong"><strong>Cube</strong></span> active again.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch11lvl2sec363"></a>See also</h3></div></div></div><p>Refer to the following<a id="id1223" class="indexterm"></a> recipes in this chapter for more information:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>
<span class="emphasis"><em>Reducing the number of objects by destroying objects at a death time</em></span>
</p></li><li style="list-style-type: disc"><p>
<span class="emphasis"><em>Reducing the number of enabled objects by disabling objects whenever possible</em></span>
</p></li></ul></div></div></div>