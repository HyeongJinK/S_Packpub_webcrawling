<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch01lvl1sec19"></a>Displaying a countdown timer graphically with a UI Slider</h2></div></div><hr /></div><p>There are many <a id="id86" class="indexterm"></a>cases where we wish to inform the player of the proportion of time remaining, or at the completion of some value at a point in time, for example, a loading progress bar, the time or health remaining compared to the<a id="id87" class="indexterm"></a> starting maximum, how much the player has filled up their water bottle from the fountain of youth, and so on. In this recipe, we'll illustrate how to remove the interactive 'handle' of a <span class="strong"><strong>UI Slider</strong></span>, and change the size and color of its components to provide us with an easy-to-use, general purpose progress/proportion bar. In this recipe, we'll use our modified slider to graphically present to the user how much time remains for a countdown timer.</p><div class="mediaobject"><img src="/graphics/9781784391362/graphics/1362OT_01_18.jpg" /></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec45"></a>Getting ready</h3></div></div></div><p>This recipe adapts the previous one. So, make a copy of the project for the previous recipe, and work on this copy to follow this recipe.</p><p>For this recipe, we have prepared the script and images that you need in the folders named <code class="literal">Scripts</code> and <code class="literal">Images</code> in the <code class="literal">1362_01_10</code> folder.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec46"></a>How to do it...</h3></div></div></div><p>To create a <a id="id88" class="indexterm"></a>digital countdown timer with a graphical display, follow these steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Delete the <a id="id89" class="indexterm"></a><span class="strong"><strong>Text</strong></span> GameObject.</p></li><li><p>Import the <code class="literal">CountdownTimer</code> script and the <code class="literal">red_square</code> and <code class="literal">green_square</code> images to this project.</p></li><li><p>Ensure that the <span class="strong"><strong>Slider</strong></span> GameObject is selected in the <span class="strong"><strong>Hierarchy</strong></span> tab.</p></li><li><p>Deactivate the <span class="strong"><strong>Handle Slide Area</strong></span> child GameObject (by unchecking it)</p></li><li><p>You'll see the "drag circle" disappear in the <span class="strong"><strong>Game</strong></span> panel (the user will not be dragging the slider, since we want this slider to be display-only), as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781784391362/graphics/1362OT_01_17.jpg" /></div></li><li><p>Select the <span class="strong"><strong>Background</strong></span> child:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>Drag the <code class="literal">red_square</code> image into the <span class="strong"><strong>Source Image</strong></span> property of the <span class="strong"><strong>Image (Script)</strong></span> component in the <span class="strong"><strong>Inspector</strong></span> view</p></li></ul></div></li><li><p>Select the <span class="strong"><strong>Fill</strong></span> child:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>Drag the <code class="literal">green_square</code> image into the <span class="strong"><strong>Source Image</strong></span> property of the <span class="strong"><strong>Image (Script)</strong></span> component in the <span class="strong"><strong>Inspector</strong></span> tab</p></li></ul></div></li><li><p>Select the<a id="id90" class="indexterm"></a> <span class="strong"><strong>Fill Area</strong></span> child:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>In the <span class="strong"><strong>Rect Transform</strong></span> component, use the <span class="strong"><strong>Anchors</strong></span> preset position of <span class="strong"><strong>left-middle</strong></span>
</p></li><li style="list-style-type: disc"><p>Set <span class="strong"><strong>Width</strong></span> to 155 and <span class="strong"><strong>Height</strong></span> to 12, as shown here:</p></li></ul></div><div class="mediaobject"><img src="/graphics/9781784391362/graphics/1362OT_01_19.jpg" /></div></li><li><p>Ensure<a id="id91" class="indexterm"></a> that the <span class="strong"><strong>Slider</strong></span> GameObject is selected in the <span class="strong"><strong>Hierarchy</strong></span>. Then, attach an instance of C# script class called <code class="literal">CountdownTimer</code> as a component of this GameObject.</p></li><li><p>Create a C# script class called <code class="literal">SliderTimerDisplay</code> containing the following code, and add an instance as a scripted component to the <span class="strong"><strong>Slider</strong></span> GameObject:</p><div class="informalexample"><pre class="programlisting">using UnityEngine;
using System.Collections;
using UnityEngine.UI;

public class SliderTimerDisplay : MonoBehaviour {
  private CountdownTimer countdownTimer;
  private Slider sliderUI;
  private int startSeconds = 30;

  void Start (){
    SetupSlider();
    SetupTimer();
  }

  void Update () {
    sliderUI.value = countdownTimer.GetProportionTimeRemaining();
    print (countdownTimer.GetProportionTimeRemaining());
  }

  private void SetupSlider (){
    sliderUI = GetComponent&lt;Slider&gt;();
    sliderUI.minValue = 0;
    sliderUI.maxValue = 1;
    sliderUI.wholeNumbers = false;
  }

  private void SetupTimer (){
    countdownTimer = GetComponent&lt;CountdownTimer&gt;();
    countdownTimer.ResetTimer(startSeconds);
  }
}</pre></div></li><li><p>Run your game and you will see the slider move with each second, revealing more and more of the red background to indicate the time remaining.</p></li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec47"></a>How it works...</h3></div></div></div><p>You hid the<a id="id92" class="indexterm"></a> <span class="strong"><strong>Handle Slide Area</strong></span> child so<a id="id93" class="indexterm"></a> that <span class="strong"><strong>Slider</strong></span> is for display only, and cannot be interacted with by the user. The <span class="strong"><strong>Background</strong></span> color of the <span class="strong"><strong>Slider</strong></span> was set to red, so that, as the counter goes down, more and more red is revealed—warning the user that the time is running out. The <span class="strong"><strong>Fill</strong></span> of the <span class="strong"><strong>Slider</strong></span> was set to green, so that the proportion remaining is displayed in green (the more green it becomes, the larger the value of the slider/timer).</p><p>An instance of the provided <code class="literal">CountdownTimer</code> script class was added as a component to the Slider. The <code class="literal">ResetTimer(…)</code> method records the number of seconds provided and the time the method was called. The <code class="literal">GetProportionRemaining()</code> method returns a value from 0.0-1.0, representing the proportion of the seconds remaining (1.0 being all seconds, 0.5 half the seconds, and 0.0 meaning that no seconds are left).</p><p>You have added to the <span class="strong"><strong>Slider</strong></span> GameObject an instance of the <code class="literal">SliderTimerDisplay</code> scripted class. The <code class="literal">Start()</code> method calls the <code class="literal">SetupSlider()</code> and <code class="literal">SetupTimer()</code> methods.</p><p>The <code class="literal">SetupSlider()</code> method sets the <code class="literal">sliderUI</code> variable to be a reference to the <span class="strong"><strong>Slider</strong></span> component, and sets up this slider mapped to float (decimal) values between <code class="literal">0.0</code> and <code class="literal">1.0</code>.</p><p>The <code class="literal">SetupTimer()</code> method sets<a id="id94" class="indexterm"></a> the <code class="literal">countdownTimer</code> variable to be a reference for the <span class="strong"><strong>CountdownTimer</strong></span> component, and starts this timer scripted component to count down from 30 seconds.</p><p>In each frame, the <a id="id95" class="indexterm"></a>
<code class="literal">Update()</code>method sets the slider value to the float returned by calling the <code class="literal">GetProportionRemaining()</code>method from the running timer.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note13"></a>Note</h3><p>
<span class="strong"><strong>Try to work with floats between 0.0-1.0 whenever possible.</strong></span>
</p><p>Integers could have been used, setting the Slider min to 0 and max to 30 (for 30 seconds). However, changing the total number of seconds would then also require the Slider settings to be changed. In most cases working with a float proportion between 0.0 and 1.0 is the more general-purpose and reusable approach to adopt.</p></div></div></div>