<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch04lvl1sec50"></a>Adding Detail maps to a material</h2></div></div><hr /></div><p>When creating<a id="id404" class="indexterm"></a> a large object, there is not only the desire to texture it as a whole, but also to add details that can<a id="id405" class="indexterm"></a> make it look better at closer distances. To overcome the need for gigantic texture maps, the use of Detail maps can make a real difference. In this recipe, we will add Detail maps to a rocket toy by applying a Detail mask and a Detail Normal map. In our case, we want to add a textured quality (and a stripe pattern) to the green plastic, except in the region where there is a battery compartment and the toy's logo:</p><div class="mediaobject"><img src="/graphics/9781784391362/graphics/1362OT_04_30.jpg" /></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec132"></a>Getting ready</h3></div></div></div><p>For this recipe, we have prepared a Unity package, containing the prefab for a rocket toy. The prefab includes the 3D model and a material, featuring a Diffuse map and a Normal map (made from a Heightmap). The file can be found in the <code class="literal">1362_04_06</code> folder.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec133"></a>How to do it...</h3></div></div></div><p>To add the Detail maps to your object, follow these steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Import the <code class="literal">rocket.unitypackage</code> file into your project. Then, select the prefab named <code class="literal">rocketToy</code> from the <span class="strong"><strong>Assets</strong></span> folder, in the <span class="strong"><strong>Project</strong></span> view, and place it in your scene.</p></li><li><p>From the <span class="strong"><strong>Hierarchy</strong></span> view, expand the <span class="strong"><strong>rocketToy</strong></span> GameObject and select its child called <span class="strong"><strong>rocketLevel1</strong></span>. Then, scroll down the <span class="strong"><strong>Inspector</strong></span> view to the <span class="strong"><strong>Material</strong></span> component. Observe that it uses the <code class="literal">DIFF_ship</code> texture as the <span class="strong"><strong>Diffuse</strong></span> map. Duplicate this file and rename the new copy <code class="literal">COPY_ship</code>.</p></li><li><p>Open <code class="literal">COPY_ship</code> in your image editor. Select all the solid green pixels around the logo and battery compartment (in Photoshop, this can be done with the Magic Wand tool, keeping the <span class="emphasis"><em>Shift</em></span> key pressed while selecting multiple areas):</p><div class="mediaobject"><img src="/graphics/9781784391362/graphics/1362OT_04_31.jpg" /></div></li><li><p>Keeping your selection active, access the image <span class="strong"><strong>Channels</strong></span> window (in Photoshop, this <a id="id406" class="indexterm"></a>can be done by navigating to <span class="strong"><strong>Window</strong></span> | <span class="strong"><strong>Channels</strong></span>). Click on <span class="strong"><strong>New Channel</strong></span>. This will be our <span class="strong"><strong>Alpha</strong></span> channel:</p><div class="mediaobject"><img src="/graphics/9781784391362/graphics/1362OT_04_32.jpg" /></div></li><li><p>Hide the <span class="strong"><strong>Red</strong></span>, <span class="strong"><strong>Green</strong></span> and <span class="strong"><strong>Blue</strong></span> channels. Select the <span class="strong"><strong>Alpha</strong></span> channel and paint the selection <a id="id407" class="indexterm"></a>white. Then, select the area of the battery compartment and paint it grey (R, G and B: <code class="literal">100</code>):</p><div class="mediaobject"><img src="/graphics/9781784391362/graphics/1362OT_04_33.jpg" /></div></li><li><p>Save it in the <a id="id408" class="indexterm"></a>TIFF format as <code class="literal">MASK_ship.TIF</code>, in the <code class="literal">Assets</code> folder. Make sure that you include <span class="strong"><strong>Alpha Channels</strong></span>:</p><div class="mediaobject"><img src="/graphics/9781784391362/graphics/1362OT_04_34.jpg" /></div></li><li><p>Now that we have the mask, let's create a diffuse map for our detail. In your image editor, create a new image with the following dimensions: <span class="strong"><strong>width</strong></span>: <code class="literal">64</code>, and <span class="strong"><strong>height</strong></span>: <code class="literal">64</code>.</p></li><li><p>Fill the new image with grey (R, G and B: <code class="literal">128</code>). Then, use shapes or rectangular <a id="id409" class="indexterm"></a>fills to create a dark grey (R, G, and B: <code class="literal">100</code>) horizontal line that is about 16 pixels tall:</p><div class="mediaobject"><img src="/graphics/9781784391362/graphics/1362OT_04_35.jpg" /></div></li><li><p>Save the image as <code class="literal">DIFF_detail.PNG</code> in the <code class="literal">Assets</code> folder.</p></li><li><p>Create a new<a id="id410" class="indexterm"></a> 64 x 64 image. Use a <span class="strong"><strong>Gradient</strong></span> tool to create a black and white <span class="strong"><strong>Radial Gradient</strong></span> (in Photoshop, this can be done with the <span class="strong"><strong>Gradient </strong></span>Tool in <span class="strong"><strong>Radial</strong></span> mode):</p><div class="mediaobject"><img src="/graphics/9781784391362/graphics/1362OT_04_36.jpg" /></div></li><li><p>Save the image as <code class="literal">HEIGHT_detail.PNG</code> in the <code class="literal">Assets</code> folder.</p></li><li><p>Go back to Unity. From the <code class="literal">Assets</code> folder, select <code class="literal">HEIGHT_detail</code>. Then, from the <span class="strong"><strong>Inspector</strong></span> view, change its <span class="strong"><strong>Texture Type</strong></span> to <span class="strong"><strong>Normal map</strong></span>, check the <span class="strong"><strong>Create from Grayscale</strong></span> option, adjust <span class="strong"><strong>Bumpiness</strong></span> to <code class="literal">0.25</code>, and set <span class="strong"><strong>Filtering</strong></span> to <code class="literal">smooth</code>. Click on <span class="strong"><strong>Apply</strong></span> to save the changes:</p><div class="mediaobject"><img src="/graphics/9781784391362/graphics/1362OT_04_37.jpg" /></div></li><li><p>From the <span class="strong"><strong>Hierarchy</strong></span> view, expand the <span class="strong"><strong>rocketToy</strong></span> GameObject and select its child called <span class="strong"><strong>rocketLevel1</strong></span>. Then, scroll down the <span class="strong"><strong>Inspector</strong></span> view to the <span class="strong"><strong>Material</strong></span> component. Assign <code class="literal">MASK_ship</code> to the <span class="strong"><strong>Detail Mask</strong></span> slot; <code class="literal">DIFF_detail</code> as <span class="strong"><strong>Secondary Maps</strong></span> | <span class="strong"><strong>Detail Diffuse x 2</strong></span>; and <code class="literal">HEIGHT_detail</code> as <span class="strong"><strong>Secondary Maps</strong></span> | <span class="strong"><strong>Normal Map</strong></span>. Also, turn the <span class="strong"><strong>Normal Map</strong></span> intensity down to <code class="literal">0.6</code>.</p></li><li><p>In the <span class="strong"><strong>Secondary Maps</strong></span> section, change the <span class="strong"><strong>Tiling</strong></span> values to <span class="strong"><strong>X</strong></span>: <code class="literal">200</code>, and <span class="strong"><strong>Y</strong></span>: <code class="literal">50</code>. You might <a id="id411" class="indexterm"></a>notice that the pattern is not seamless. This is<a id="id412" class="indexterm"></a> because we are using the same <span class="strong"><strong>UV Set</strong></span> from our <span class="strong"><strong>Diffuse</strong></span> texture. However, the object has been assigned to two different<a id="id413" class="indexterm"></a> <span class="strong"><strong>UV channels</strong></span> (back when it was being modeled). While UV channel 1 contains the mapping for our <span class="strong"><strong>Diffuse</strong></span> map, UV channel 2 uses a basic cylindrical mapping. We need to change the <span class="strong"><strong>Secondary Maps</strong></span> section's <span class="strong"><strong>UV Set</strong></span> from <span class="strong"><strong>UV0</strong></span> to <span class="strong"><strong>UV1</strong></span>. The Detail map for your material is ready:</p><div class="mediaobject"><img src="/graphics/9781784391362/graphics/1362OT_04_38.jpg" /></div></li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec134"></a>How it works...</h3></div></div></div><p>When in use, <span class="strong"><strong>Secondary Maps</strong></span> are blended onto the material's primary <span class="strong"><strong>Diffuse</strong></span> and <span class="strong"><strong>Normal</strong></span> maps (that's why <a id="id414" class="indexterm"></a>our object is green even after the <span class="strong"><strong>Detail Diffuse</strong></span> is applied: the grey tones are superimposed on the original <span class="strong"><strong>Diffuse</strong></span> texture). By using a <span class="strong"><strong>Detail Mask</strong></span>, the artist defines which areas of the object should be affected by Secondary Maps. This is great for customization, and also for creating nuances (like the semi-bumped battery compartment in our example).</p><p>Another helpful feature is the possibility of using a separate UV channel for Details maps and Tiling. Besides adding variation to texture mapping, this allows us to paint the details that can be<a id="id415" class="indexterm"></a> perceived even at a very close distance by dramatically enhancing the visual quality of our objects.</p></div></div>