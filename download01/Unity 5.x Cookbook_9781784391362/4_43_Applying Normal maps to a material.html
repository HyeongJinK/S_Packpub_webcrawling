<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch04lvl1sec47"></a>Applying Normal maps to a material</h2></div></div><hr /></div><p>Normal maps<a id="id362" class="indexterm"></a> are generally used to simulate complex geometry that would be too expensive, in terms of computer processing, to be actually represented by the 3D polygons during the game's runtime. Oversimplifying, Normal maps fake complex<a id="id363" class="indexterm"></a> geometry on low-definition 3D meshes. These maps can be generated either by projecting high-definition 3D meshes onto low-poly ones (a technique usually referred to as <span class="emphasis"><em>baking</em></span>), or, as will be the case for this recipe, from another texture map.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec120"></a>Getting ready</h3></div></div></div><p>For this recipe, we will prepare two texture maps: the<a id="id364" class="indexterm"></a> <span class="strong"><strong>Heightmap</strong></span> and the <span class="strong"><strong>Normal map</strong></span>. The<a id="id365" class="indexterm"></a> former will be made from simple shapes in an image editor. The latter will be automatically processed from the Heightmap. Although there are a number of tools that can be used to generate Normal maps (see the <span class="emphasis"><em>There is more</em></span> section of this chapter for a list of resources), we will use a free online tool, Windows and Mac compatible, to generate our texture. Developed by Christian Petry, the <span class="strong"><strong>NormalMap Online</strong></span> feature <a id="id366" class="indexterm"></a>can be accessed at <a class="ulink" href="http://cpetry.github.io/NormalMap-Online/" target="_blank">http://cpetry.github.io/NormalMap-Online/</a>.</p><p>To help you with this recipe, it's been provided a Unity package, containing a prefab made of a 3D object and its material; and also an UVW template texture (in PNG format) to guide you when creating the diffuse texture map. All the files are in the <code class="literal">1362_04_03</code> folder.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec121"></a>How to do it...</h3></div></div></div><p>To apply a Normal map to a material, follow these steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Import the <code class="literal">1362_04_03.unitypackage</code> file to your project. Select the <code class="literal">batteryPrefab</code> object from the <span class="strong"><strong>Assets</strong></span> | <code class="literal">1362_04_03</code> folder, in the <span class="strong"><strong>Project</strong></span> view. After comparing it with some reference photos, inform yourself about the features that should be reproduced by the Normal map: (<span class="strong"><strong>A</strong></span>) a bumpy ring at the top; and (<span class="strong"><strong>B</strong></span>) some circular creases at the bottom, shown in the following image:</p><div class="mediaobject"><img src="/graphics/9781784391362/graphics/1362OT_04_14.jpg" /></div></li><li><p>In an image editor, open <code class="literal">uvw_template.png</code>. Create a new layer, fill it with grey (RGB: 128), and position it <a id="id367" class="indexterm"></a>below the pre-existing<a id="id368" class="indexterm"></a> layer as shown:</p><div class="mediaobject"><img src="/graphics/9781784391362/graphics/1362OT_04_15.jpg" /></div></li><li><p>On a separate layer, draw a white circle centered on the battery's top. Then, on another layer, draw a black circle, centered on the battery's bottom, as shown below:</p><div class="mediaobject"><img src="/graphics/9781784391362/graphics/1362OT_04_16.jpg" /></div></li><li><p>If you have used vector shapes to make the circles, rasterize their layers (in Adobe Photoshop, right-click on the layer's name and select the <span class="strong"><strong>Rasterize Layer</strong></span> option from the context menu).</p></li><li><p>Blur the white circle (in Photoshop, this can be done by navigating to <span class="strong"><strong>Filter</strong></span> | <span class="strong"><strong>Blur</strong></span> | <span class="strong"><strong>Gaussian Blur...</strong></span>). Use <span class="strong"><strong>4,0</strong></span> pixels as the <span class="strong"><strong>Radius</strong></span>.</p></li><li><p>Hide the UVW<a id="id369" class="indexterm"></a> template layer and save the image as <code class="literal">Battery_height.png</code>.</p></li><li><p>If you want to<a id="id370" class="indexterm"></a> convert the Heightmap directly from Unity, import it to your project. Select it from the <span class="strong"><strong>Project</strong></span> view and, from the <span class="strong"><strong>Inspector</strong></span> view, change its <span class="strong"><strong>Texture Type</strong></span> to <span class="strong"><strong>Normal map</strong></span>. Check the <span class="strong"><strong>Create from Grayscale</strong></span> option, adjust <span class="strong"><strong>Bumpiness</strong></span> and <span class="strong"><strong>Filtering</strong></span> as you like, and click on <span class="strong"><strong>Apply</strong></span> to save the changes:</p><div class="mediaobject"><img src="/graphics/9781784391362/graphics/1362OT_04_17.jpg" /></div></li><li><p>To convert your<a id="id371" class="indexterm"></a> Heightmap externally, access the website at <a class="ulink" href="http://cpetry.github.io/NormalMap-Online/" target="_blank">http://cpetry.github.io/NormalMap-Online/</a>. Then, drag the <code class="literal">HEIGHT_battery.png</code> file to<a id="id372" class="indexterm"></a> the appropriate image slot. Feel free to play with the <span class="strong"><strong>Strength</strong></span>, <span class="strong"><strong>Level</strong></span> and <span class="strong"><strong>Blur/Sharp</strong></span> parameters:</p><div class="mediaobject"><img src="/graphics/9781784391362/graphics/1362OT_04_18.jpg" /></div></li><li><p>Save the resulting <a id="id373" class="indexterm"></a>Normal map as <code class="literal">Battery_normal.jpg</code> and add it to your Unity project.</p></li><li><p>In Unity, select <code class="literal">Battery_normal</code> from the <span class="strong"><strong>Project</strong></span> view. Then, from the <span class="strong"><strong>Inspector</strong></span> view, change its <span class="strong"><strong>Texture Type</strong></span> to <span class="strong"><strong>Normal</strong></span>, leaving the <span class="strong"><strong>Create from Grayscale</strong></span> box unchecked. Click on <span class="strong"><strong>Apply</strong></span> to save the changes:</p><div class="mediaobject"><img src="/graphics/9781784391362/graphics/1362OT_04_19.jpg" /></div></li><li><p>In the <span class="strong"><strong>Project</strong></span><a id="id374" class="indexterm"></a> view, select <code class="literal">batteryPrefab</code>. Then, in the <span class="strong"><strong>Inspector</strong></span> view, scroll down to the <span class="strong"><strong>Material</strong></span> component, and assign <code class="literal">Battery_normal</code> to the <span class="strong"><strong>Normal Map</strong></span><a id="id375" class="indexterm"></a> slot. To adjust its intensity and direction, change its value to <code class="literal">-0.35</code>:</p><div class="mediaobject"><img src="/graphics/9781784391362/graphics/1362OT_04_20.jpg" /></div></li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec122"></a>How it works...</h3></div></div></div><p>The <span class="strong"><strong>Normal</strong></span> map was calculated from the grey<a id="id376" class="indexterm"></a> values on the <span class="strong"><strong>Heightmap</strong></span>, where the lighter tones were<a id="id377" class="indexterm"></a> interpreted as recesses (applied to the top of the battery), and the darker tones as bulges (applied to the bottom). Since the desired output was actually the opposite, it was necessary to adjust the Normal map to a negative value (<code class="literal">-0.35</code>). Another possible solution to the issue would have been to redraw the Heightmap and <a id="id378" class="indexterm"></a>switch the colors for the white and black circles.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec123"></a>There's more...</h3></div></div></div><p>If you wish to explore Normal mapping beyond the limitations of NormalMap Online, there is an ever-growing list of full-featured software that can produce Normal maps (and much more). Here are some resources that you might want to check out:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>
<span class="emphasis"><em>CrazyBump</em></span> is a <a id="id379" class="indexterm"></a>standalone tool for Windows and Mac, which is available at <a class="ulink" href="http://www.crazybump.com" target="_blank">http://www.crazybump.com</a>
</p></li><li style="list-style-type: disc"><p>
<span class="emphasis"><em>nDo</em></span> is a Photoshop plugin by <a id="id380" class="indexterm"></a>Quixel (Windows only), available at <a class="ulink" href="http://quixel.se/ndo" target="_blank">http://quixel.se/ndo</a>
</p></li><li style="list-style-type: disc"><p>
<span class="emphasis"><em>GIMP normalmap Plugin</em></span>, available for <a id="id381" class="indexterm"></a>Windows only, is available at <a class="ulink" href="http://code.google.com/p/gimp-normalmap/" target="_blank">http://code.google.com/p/gimp-normalmap/</a>
</p></li><li style="list-style-type: disc"><p>
<span class="emphasis"><em>NVIDIA Texture Tools for Adobe Photoshop</em></span>, available for Windows only, is available at <a class="ulink" href="http://developer.nvidia.com/nvidia-texture-tools-adobe-photoshop" target="_blank">http://developer.nvidia.com/nvidia-texture-tools-adobe-photoshop</a>
</p></li><li style="list-style-type: disc"><p>
<span class="emphasis"><em>Bitmap2Material</em></span> is an <a id="id382" class="indexterm"></a>amazing texture generating tool from <a id="id383" class="indexterm"></a>Allegorithmic, which is available at <a class="ulink" href="http://www.allegorithmic.com/" target="_blank">http://www.allegorithmic.com/</a>
</p></li></ul></div></div></div>