<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch01lvl1sec17"></a>Organizing images inside panels and changing panel depths via buttons</h2></div></div><hr /></div><p>UI <span class="strong"><strong>Panels</strong></span> are <a id="id68" class="indexterm"></a>provided by Unity to allow UI controls to be grouped and moved together, and also to visually group elements with an <span class="strong"><strong>Image</strong></span> background (if desired). The <span class="strong"><strong>sibling depth</strong></span> is what <a id="id69" class="indexterm"></a>determines which UI <a id="id70" class="indexterm"></a>elements will appear above or below others. We can see the sibling depth explicitly in the <span class="strong"><strong>Hierarchy</strong></span>, since the top-to-bottom sequence of UI GameObjects in the <span class="strong"><strong>Hierarchy</strong></span> sets the sibling depth. So, the first item has a depth of 1, the second has a depth of 2, and so on. The UI GameObjects with larger sibling depths (further down the <span class="strong"><strong>Hierarchy</strong></span>) appear above the UI GameObjects with lower sibling depths.</p><p>In this recipe, we'll create three UI panels, each showing a different playing card image. We'll also add four triangle arrangement buttons to change the display order (move to bottom, move to<a id="id71" class="indexterm"></a> top, move up one, and move down one).</p><div class="mediaobject"><img src="/graphics/9781784391362/graphics/1362OT_01_28.jpg" /></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec39"></a>Getting ready</h3></div></div></div><p>For this recipe, we<a id="id72" class="indexterm"></a> have prepared the images that you need in a folder named <code class="literal">Images</code> in the <code class="literal">1362_01_08</code> folder.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec40"></a>How to do it...</h3></div></div></div><p>To create the UI <span class="strong"><strong>Panels</strong></span> whose layering can be changed by the user-clicking buttons, follow these steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Create a new Unity 2D project.</p></li><li><p>Create a new UI <span class="strong"><strong>Panel</strong></span> named <code class="literal">Panel-jack-diamonds</code>. Position it in the middle-center part of the screen, and size it 200 pixels wide by 300 pixels high. Uncheck the <span class="strong"><strong>Image (Script)</strong></span> component for this panel (since we don't want to see the default semi-transparent rectangular grey background image of a panel).</p></li><li><p>Create a new UI <span class="strong"><strong>Image</strong></span>, and child this image to <span class="strong"><strong>Panel-jack-diamonds</strong></span>.</p></li><li><p>Position the <span class="strong"><strong>Panel-jack-diamonds </strong></span>image at center-middle, and size it to 200 x 300. Drag the <span class="strong"><strong>Jack-of-diamonds</strong></span> playing card image into the <span class="strong"><strong>Source Image</strong></span> property, for the <span class="strong"><strong>Image (Script)</strong></span> component in the <span class="strong"><strong>Inspector</strong></span> tab.</p></li><li><p>Create a UI <span class="strong"><strong>Button</strong></span> named <span class="strong"><strong>Button-move-to-front</strong></span>. Child this button to <span class="strong"><strong>Panel-jack-diamonds</strong></span>. Delete the <span class="strong"><strong>Text</strong></span> child GameObject of this button (since we'll use an icon to indicate what this button does).</p></li><li><p>Size the <span class="strong"><strong>Button-move-to-front</strong></span> button to 16 x 16, and position it top-center of the player card image, so that it can be seen at the top of the playing card. Drag the <code class="literal">icon_move_to_front</code> arrangement triangle icon image into the <span class="strong"><strong>Source Image</strong></span> property, for the <span class="strong"><strong>Image (Script)</strong></span> component, in the <span class="strong"><strong>Inspector </strong></span>view.</p></li><li><p>Ensure that the <span class="strong"><strong>Button-move-to-front</strong></span> button is selected in the <span class="strong"><strong>Hierarchy</strong></span>. Then, click <a id="id73" class="indexterm"></a>on the plus sign (<span class="strong"><strong>+</strong></span>) at the bottom of the <span class="strong"><strong>Button (Script)</strong></span> component, in the <span class="strong"><strong>Inspector</strong></span> view to create a new <span class="strong"><strong>OnClick</strong></span> event handler for this button.</p></li><li><p>Drag <span class="strong"><strong>Panel-jack-diamonds</strong></span> from the <span class="strong"><strong>Hierarchy</strong></span> over the <span class="strong"><strong>Object</strong></span> slot (immediately below the menu saying <span class="strong"><strong>Runtime Only</strong></span>).</p></li><li><p>Now, select <a id="id74" class="indexterm"></a>the <span class="strong"><strong>RectTransform.SetAsLastSibling</strong></span> method from the drop-down function list (initially showing <span class="strong"><strong>No Function</strong></span>).</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note10"></a>Note</h3><p>This means that when the <span class="strong"><strong>Button</strong></span> receives an <span class="strong"><strong>OnClick</strong></span> event, the <span class="strong"><strong>RectTransform</strong></span> of the <span class="strong"><strong>Panel</strong></span> will be sent the <span class="strong"><strong>SetAsLastSibling</strong></span> message – this will move the <span class="strong"><strong>Panel</strong></span> to the bottom of the GameObjects in the <span class="strong"><strong>Canvas</strong></span>, and therefore will move this <span class="strong"><strong>Panel</strong></span> in front of all other GameObjects in the <span class="strong"><strong>Canvas</strong></span>.</p></div><div class="mediaobject"><img src="/graphics/9781784391362/graphics/1362OT_01_35.jpg" /></div></li><li><p>Repeat <span class="emphasis"><em>step 2</em></span>; create a second <span class="strong"><strong>Panel</strong></span> with a move-to-front button. Name this<a id="id75" class="indexterm"></a> second Panel <span class="strong"><strong>Panel-2-diamonds</strong></span>, then move and position it slightly to the right of <span class="strong"><strong>Panel-jack-diamonds</strong></span>, allowing both the move-to-front buttons to be seen.</p></li><li><p>Save your <a id="id76" class="indexterm"></a>scene and run the game. You will be able to click the move-to-front button on either of the cards to move that card's panel to the front. If you run the game with the Game panel not maximized, you'll actually see the panels changing order in the list of the children of the <span class="strong"><strong>Canvas</strong></span> in the <span class="strong"><strong>Hierarchy</strong></span>.</p></li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec41"></a>How it works...</h3></div></div></div><p>You've created two UI <span class="strong"><strong>Panels</strong></span>, each panel containing an image of a playing card and a button whose action will make its parent panel move to the front. The button's action illustrates how the <span class="strong"><strong>OnClick</strong></span> function does not have to be the calling of a public method of a scripted component of an object, but it can be sending a message to one of the components of the targeted GameObject—in this instance we send the <span class="strong"><strong>SetAsLastSibling</strong></span> message to the <span class="strong"><strong>RectTransform</strong></span> of the <span class="strong"><strong>Panel</strong></span> in which the <span class="strong"><strong>Button</strong></span> is located.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec42"></a>There's more...</h3></div></div></div><p>There are some details that you don't want to miss.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch01lvl3sec08"></a>Moving up or down by just one position, using scripted methods</h4></div></div></div><p>While the Rect Transform offers a useful <span class="strong"><strong>SetAsLastSibling</strong></span> (move to front) and <span class="strong"><strong>SetAsFirstSibling</strong></span> (move to back), and even <span class="strong"><strong>SetSiblingIndex</strong></span> (if we knew exactly what position in the sequence to type in), there isn't a built-in way to make an element move up or down, just a single position in the<a id="id77" class="indexterm"></a> sequence of GameObjects in the <span class="strong"><strong>Hierarchy</strong></span> panel. However, we can write two straightforward methods in C# to do this, and we can add buttons to call these methods, providing full control<a id="id78" class="indexterm"></a> of the top-to-bottom arrangement of the UI controls on the screen. To implement four buttons (move-to-front/move-to-back/up one/down one), do the following:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Create a C# script class called <code class="literal">ArrangeActions</code>, containing the following code, and add an instance as a scripted component to each of your <span class="strong"><strong>Panels</strong></span>:</p><div class="informalexample"><pre class="programlisting">using UnityEngine;
using UnityEngine.UI;
using UnityEngine.EventSystems;
using System.Collections;

public class ArrangeActions : MonoBehaviour {
  private RectTransform panelRectTransform;

  void Start(){
    panelRectTransform = GetComponent&lt;RectTransform&gt;();
  }

  public void MoveDownOne(){
    print ("(before change) " + GameObject.name +  " sibling index = " + panelRectTransform.GetSiblingIndex());

    int currentSiblingIndex = panelRectTransform.GetSiblingIndex();
    panelRectTransform.SetSiblingIndex( currentSiblingIndex - 1 );

    print ("(after change) " + GameObject.name +  " sibling index = " + panelRectTransform.GetSiblingIndex());
  }

  public void MoveUpOne(){
    print ("(before change) " + GameObject.name +  " sibling index = " + panelRectTransform.GetSiblingIndex());

    int currentSiblingIndex = panelRectTransform.GetSiblingIndex();
    panelRectTransform.SetSiblingIndex( currentSiblingIndex + 1 );

    print ("(after change) " + GameObject.name +  " sibling index = " + panelRectTransform.GetSiblingIndex());
  }
}</pre></div></li><li><p>Add a second button to each card panel, this time, using the arrangement triangle icon image called <code class="literal">icon_move_to_front</code>, and set the <span class="strong"><strong>OnClick</strong></span> event function for these buttons to <span class="strong"><strong>SetAsFirstSibling</strong></span>.</p></li><li><p>Add two further buttons to each card panel with the up and down triangle icon images: <code class="literal">icon_down_one</code> and <code class="literal">icon_up_one</code>. Set the <span class="strong"><strong>OnClick</strong></span> event handler<a id="id79" class="indexterm"></a> function for the down-one buttons to call the <code class="literal">MoveDownOne()</code> method, and set the functions for the up-one buttons to call the <code class="literal">MoveUpOne()</code> method.</p></li><li><p>Copy one of the <a id="id80" class="indexterm"></a>panels to create a third card (this time showing the Ace of diamonds). Arrange the three cards so that you can see all four buttons for at least two of the cards, even when those cards are at the bottom (see the screenshot at the beginning of this recipe).</p></li><li><p>Save the scene and run your game. You will now have full control over the layering of the three card panels.</p></li></ol></div></div></div></div>