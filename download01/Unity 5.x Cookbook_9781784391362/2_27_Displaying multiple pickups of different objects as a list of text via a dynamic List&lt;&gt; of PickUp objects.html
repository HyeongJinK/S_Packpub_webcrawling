<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch02lvl1sec33"></a>Displaying multiple pickups of different objects as a list of text via a dynamic List&lt;&gt; of PickUp objects</h2></div></div><hr /></div><p>When working <a id="id225" class="indexterm"></a>with different kinds of pickups, one approach is to use a C# <span class="strong"><strong>List</strong></span> to maintain a flexible-length data structure of the items currently in the inventory. In this recipe, we will show you how, each time an item is picked up, a new object is added to such a <span class="strong"><strong>List</strong></span> collection. An iteration through the <span class="strong"><strong>List</strong></span> is how the text display of items is generated each time the inventory changes. We introduce a very simple <code class="literal">PickUp</code> script class, demonstrating how information about a pickup can be stored in a scripted component, extracted upon collision, and stored in our <span class="strong"><strong>List</strong></span>.</p><div class="mediaobject"><img src="/graphics/9781784391362/graphics/1362OT_02_36.jpg" /></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec84"></a>Getting ready</h3></div></div></div><p>This recipe assumes that you are starting with the project <code class="literal">Simple2Dgame_SpaceGirl</code> setup from the first recipe in this chapter. The font you need can be found in the <code class="literal">1362_02_02</code> folder.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec85"></a>How to do it...</h3></div></div></div><p>To display inventory total text for multiple pickups of different object types, follow these steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Start with a new copy of the mini-game <code class="literal">Simple2Dgame_SpaceGirl</code>.</p></li><li><p>Edit the tags, changing tag <span class="strong"><strong>Star</strong></span> to <span class="strong"><strong>Pickup</strong></span>. Ensure that the <code class="literal">star</code> GameObject now has the tag <span class="strong"><strong>Pickup</strong></span>.</p></li><li><p>Add the following C# Script <code class="literal">PickUp</code> to GameObject <code class="literal">star</code> in the <span class="strong"><strong>Hierarchy</strong></span>:</p><div class="informalexample"><pre class="programlisting">using UnityEngine;
using System.Collections;

public class PickUp : MonoBehaviour {
  public string description;
}</pre></div></li><li><p>In the <span class="strong"><strong>Inspector</strong></span>, change the description property of component <span class="strong"><strong>Pick Up (Script)</strong></span> of GameObject <code class="literal">star</code> to the text <code class="literal">star</code>, as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781784391362/graphics/1362OT_02_37.jpg" /></div></li><li><p>Select the GameObject <code class="literal">star</code> in the <span class="strong"><strong>Hierarchy</strong></span> panel and make a copy of this GameObject, renaming the copy <code class="literal">heart</code>.</p></li><li><p>In the <span class="strong"><strong>Inspector,</strong></span> change the description property of component <span class="strong"><strong>Pick Up (Script)</strong></span> of <a id="id226" class="indexterm"></a>GameObject <code class="literal">heart</code> to the text <code class="literal">heart</code>. Also, drag from the <span class="strong"><strong>Project</strong></span> panel (folder <code class="literal">Sprites</code>) image <span class="strong"><strong>healthheart</strong></span> into the Sprite property of GameObject <code class="literal">heart</code>. The player should now see the heart image on screen for this pickup item.</p></li><li><p>Select the GameObject <code class="literal">star</code> in the <span class="strong"><strong>Hierarchy</strong></span> panel and make a copy of this GameObject, renaming the copy <code class="literal">key</code>.</p></li><li><p>In the <span class="strong"><strong>Inspector,</strong></span> change the description property of component <span class="strong"><strong>Pick Up (Script)</strong></span> of GameObject <code class="literal">key</code> to the text <code class="literal">key.</code> Also, drag from the <span class="strong"><strong>Project</strong></span> panel (folder <span class="strong"><strong>Sprites</strong></span>) image <span class="strong"><strong>icon_key_green_100</strong></span> into the <span class="strong"><strong>Sprite</strong></span> property of GameObject <code class="literal">key</code>. The player should now see the key image on screen for this pickup item.</p></li><li><p>Make another one or two copies of each pickup GameObject and arrange them around the screen, so there are two or three each of star, heart, and key pickup GameObjects.</p></li><li><p>Add the following C# Script <code class="literal">Player</code> to GameObject <code class="literal">player-SpaceGirl</code> in the <span class="strong"><strong>Hierarchy</strong></span>:</p><div class="informalexample"><pre class="programlisting">using UnityEngine;
using System.Collections;
using UnityEngine.UI;
using System.Collections.Generic;

public class Player : MonoBehaviour {
  private PlayerInventoryDisplay playerInventoryDisplay;
  private List&lt;PickUp&gt; inventory = new List&lt;PickUp&gt;();

  void Start(){
    playerInventoryDisplay = GetComponent&lt;PlayerInventoryDisplay&gt;();
    playerInventoryDisplay.OnChangeInventory(inventory);
  }
  
  void OnTriggerEnter2D(Collider2D hit){
    if(hit.CompareTag("Pickup")){
      PickUp item = hit.GetComponent&lt;PickUp&gt;();
      inventory.Add( item );
      playerInventoryDisplay.OnChangeInventory(inventory);
      Destroy(hit.gameObject);
    }
  }
}</pre></div></li><li><p>Add a UI <span class="strong"><strong>Text</strong></span> object (<span class="strong"><strong>Create</strong></span> | <span class="strong"><strong>UI</strong></span> | <span class="strong"><strong>Text</strong></span>). Rename it <code class="literal">Text-inventory-list</code>. Change its text to <span class="strong"><strong>the quick brown fox jumped over the lazy dog the quick brown fox jumped over the lazy dog</strong></span>, or another long list of nonsense words, to test the overflow settings you change in the next step.</p></li><li><p>In the <span class="strong"><strong>Text (Script)</strong></span> component, ensure that <span class="strong"><strong>Horizontal Overflow</strong></span> is set to <span class="strong"><strong>Wrap</strong></span>, and set <span class="strong"><strong>Vertical Overflow</strong></span> to <span class="strong"><strong>Overflow</strong></span>—this will ensure that the text will wrap onto a second or third line (if needed) and not be hidden if there are lots of pickups.</p></li><li><p>In the <span class="strong"><strong>Inspector</strong></span> panel, set its font to <span class="strong"><strong>Xolonium-Bold</strong></span> (folder <code class="literal">Fonts</code>) and set its color to <a id="id227" class="indexterm"></a>yellow. For the <span class="strong"><strong>Alignment</strong></span> property, center the text horizontally and ensure that the text is top aligned vertically, and set the <span class="strong"><strong>Font Size</strong></span> to 28 and choose a yellow text <span class="strong"><strong>Color</strong></span>.</p></li><li><p>Edit its <span class="strong"><strong>Rect Transform</strong></span> and set its <span class="strong"><strong>Height</strong></span> to <code class="literal">50</code>. Then, while holding down <span class="emphasis"><em>SHIFT</em></span> and <span class="emphasis"><em>ALT</em></span> (to set pivot and position), choose the top-stretch box. The text should now be positioned at the middle top of the <span class="strong"><strong>Game</strong></span> panel, and its width should stretch to match that of the whole panel.</p></li><li><p>Your text should now appear at the top of the game panel.</p></li><li><p>Add the following C# Script <code class="literal">PlayerInventoryDisplay</code> to GameObject <code class="literal">player-SpaceGirl</code> in the <span class="strong"><strong>Hierarchy</strong></span>:</p><div class="informalexample"><pre class="programlisting">using UnityEngine;
using System.Collections;
using UnityEngine.UI;
using System.Collections.Generic;

public class PlayerInventoryDisplay : MonoBehaviour
{
  public Text inventoryText;

  public void OnChangeInventory(List&lt;PickUp&gt; inventory){
    // (1) clear existing display
    inventoryText.text = "";

    // (2) build up new set of items
    string newInventoryText = "carrying: ";
    int numItems = inventory.Count;
    for(int i = 0; i &lt; numItems; i++){
      string description = inventory[i].description;
      newInventoryText += " [" + description+ "]";
    }

    if(numItems &lt; 1) newInventoryText = "(empty inventory)";

    // (3) update screen display
    inventoryText.text = newInventoryText;
  }
}</pre></div></li><li><p>From the <span class="strong"><strong>Hierarchy</strong></span> view, select the GameObject <code class="literal">player-SpaceGirl</code>. Then, from the <span class="strong"><strong>Inspector</strong></span>, access the <span class="strong"><strong>Player Inventory Display (Script)</strong></span> component and<a id="id228" class="indexterm"></a> populate the <span class="strong"><strong>Inventory Text</strong></span> public field with the UI <span class="strong"><strong>Text</strong></span> object <code class="literal">Text-inventory-list</code>.</p></li><li><p>Play the game—each time you pick up a star or key or heart, the updated list of what you are carrying should be displayed in the form <span class="strong"><strong>carrying: [key] [heart]</strong></span>.</p></li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec86"></a>How it works...</h3></div></div></div><p>In the script class <code class="literal">Player</code>, the variable <code class="literal">inventory</code> is a C# <span class="strong"><strong>List&lt;&gt;</strong></span>. This is a flexible data structure, which can be sorted, searched, and dynamically (at run time, when the game is being played) have items added to and removed from it. The <code class="literal">&lt;PickUp&gt;</code> in pointy brackets means that variable <code class="literal">inventory</code> will contain a list of <code class="literal">PickUp</code> objects. For this recipe, our <code class="literal">PickUp</code> class just has a single field, a string description, but we'll add more sophisticated data items in <code class="literal">PickUp</code> classes in later recipes.</p><p>When the scene starts, the <code class="literal">Start()</code> method of script class <code class="literal">Player</code> gets a reference to the <code class="literal">PlayerInventoryDisplay</code> scripted component and also initializes variable <code class="literal">inventory</code> to be a new, empty C# List of <code class="literal">PickUp</code> objects. When the <code class="literal">OnColliderEnter2D(…)</code> method detects collisions with items tagged <code class="literal">Pickup</code>, the <code class="literal">PickUp</code> object component of the item hit is added to our <code class="literal">inventory</code> list. A call is also made to the <code class="literal">OnChangeInventory(…)</code> method of <code class="literal">playerInventoryDisplay </code>to update out inventory display to the player, passing the updated <code class="literal">inventory</code> <span class="strong"><strong>List</strong></span> as a parameter.</p><p>The script class <code class="literal">playerInventoryDisplay</code> has a public variable, linked to the UI <span class="strong"><strong>Text</strong></span> object <code class="literal">Text-inventory-list</code>. The <code class="literal">OnChangeInventory(…)</code> method first sets the UI text to empty, and then loops through the inventory list, building up a string of each items description in square brackets ([key], [heart], and so on). If there were no items in the list, then the string is set to the text <code class="literal">(empty inventory)</code>. Finally, the text property of the UI <span class="strong"><strong>Text</strong></span> object <code class="literal">Text-inventory-list</code> is set to the value of this string representation of what is inside <a id="id229" class="indexterm"></a>variable <code class="literal">inventory</code>.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec87"></a>There's more...</h3></div></div></div><p>Some details you don't want to miss:</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch02lvl3sec19"></a>Order items in the inventory list alphabetically</h4></div></div></div><p>It would be<a id="id230" class="indexterm"></a> nice to alphabetically sort the words in the <code class="literal">inventory</code> list—both for neatness and consistency (so, in a game, if we pick up a key and a heart, it will look the same regardless of which order), but also so that items of the same type will be listed together, so we can easily see how many of each item we are carrying.</p><div class="mediaobject"><img src="/graphics/9781784391362/graphics/1362OT_02_38.jpg" /></div><p>To implement the alphabetic sorting of the items in the <code class="literal">inventory</code> list, we need to do the following:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Add the following C# code to the beginning of method <code class="literal">OnChangeInventory(...)</code> in the script class <code class="literal">PlayerInventoryDisplay</code>:</p><div class="informalexample"><pre class="programlisting">public void OnChangeInventory(List&lt;PickUp&gt; inventory){
  inventory.Sort(
    delegate(PickUp p1, PickUp p2){
      return p1.description.CompareTo(p2.description);
    }
  );

  // rest of the method as before …
}</pre></div></li><li><p>You should now see all the items listed in alphabetic sequence. This C# code takes advantage of the <code class="literal">List.Sort(…)</code> method, a feature of collections whereby each<a id="id231" class="indexterm"></a> item can be compared to the next, and they are swapped if in the wrong order (if the <code class="literal">CompareTo(…)</code> methods returns false).</p></li></ol></div></div></div></div>