<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch02lvl1sec28"></a>Displaying single object pickups with carrying and not-carrying text</h2></div></div><hr /></div><p>Often the <a id="id182" class="indexterm"></a>simplest inventory situation is to display text to tell players if they are carrying a single item (or not).</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec68"></a>Getting ready</h3></div></div></div><p>This recipe assumes that you are <a id="id183" class="indexterm"></a>starting with the project <code class="literal">Simple2Dgame_SpaceGirl</code> setup from the first recipe in this chapter. So, either make a copy of that project or do the following:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Create a new, empty 2D project.</p></li><li><p>Import the <code class="literal">Simple2Dgame_SpaceGirl</code> package.</p></li><li><p>Open scene <span class="strong"><strong>Scene1</strong></span> (in the <code class="literal">Scenes</code> folder).</p></li><li><p>Set the Unity Player screen size to 800 x 600 (see the previous recipe for how to do this) and select this resolution in the <span class="strong"><strong>Game</strong></span> panel the drop-down menu.</p></li><li><p>Convert each sprite image to be of type <span class="strong"><strong>Sprite (2D and UI)</strong></span>. In the <span class="strong"><strong>Inspector,</strong></span> choose <span class="strong"><strong>Sprite (2D and UI)</strong></span> from drop-down menu <span class="strong"><strong>Texture Type</strong></span>, and click on the <span class="strong"><strong>Apply</strong></span> button.</p></li></ol></div><p>For this recipe, we have prepared the font you need in a folder named <code class="literal">Fonts</code> in the <code class="literal">1362_02_02</code> folder.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec69"></a>How to do it...</h3></div></div></div><p>To display text to inform the user about the status of carrying a single object pickup, follow these<a id="id184" class="indexterm"></a> steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Start with <a id="id185" class="indexterm"></a>a new copy of mini-game <code class="literal">Simple2Dgame_SpaceGirl</code>.</p></li><li><p>Add a UI <span class="strong"><strong>Text</strong></span> object (<span class="strong"><strong>Create</strong></span> | <span class="strong"><strong>UI</strong></span> | <span class="strong"><strong>Text</strong></span>). Rename it <code class="literal">Text-carrying-star</code>. Change its text to <code class="literal">Carrying star: false</code>.</p></li><li><p>Import the provided <code class="literal">Fonts</code> folder into your project.</p></li><li><p>In the <span class="strong"><strong>Inspector</strong></span> panel, set the font of <code class="literal">Text-carrying-star</code> to <span class="strong"><strong>Xolonium-Bold</strong></span> (folder <code class="literal">Fonts</code>), and set its color to yellow. Center the text horizontally and vertically, and set its <span class="strong"><strong>Height</strong></span> to <code class="literal">50</code>, and set the <span class="strong"><strong>Font Size</strong></span> to <code class="literal">32</code>, as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781784391362/graphics/1362OT_02_05.jpg" /></div></li><li><p>In its <span class="strong"><strong>Rect Transform</strong></span> component, set its <span class="strong"><strong>Height</strong></span> to <code class="literal">50</code>, as shown in the next screenshot:</p><div class="mediaobject"><img src="/graphics/9781784391362/graphics/1362OT_02_53.jpg" /></div></li><li><p>Edit its <span class="strong"><strong>Rect Transform</strong></span>, and while holding down <span class="emphasis"><em>SHIFT</em></span> and <span class="emphasis"><em>ALT</em></span> (to set pivot and<a id="id186" class="indexterm"></a> position), choose the top-stretch box, as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781784391362/graphics/1362OT_02_06.jpg" /></div></li><li><p>Your text <a id="id187" class="indexterm"></a>should now be positioned at the middle top of the <span class="strong"><strong>Game</strong></span> panel, and its width should stretch to match that of the whole panel, as shown in the next screenshot:</p><div class="mediaobject"><img src="/graphics/9781784391362/graphics/1362OT_02_07.jpg" /></div></li><li><p>Add the<a id="id188" class="indexterm"></a> following<a id="id189" class="indexterm"></a> C# Script <code class="literal">Player</code> to GameObject <code class="literal">player-SpaceGirl</code> in the <span class="strong"><strong>Hierarchy</strong></span>:</p><div class="informalexample"><pre class="programlisting">using UnityEngine;
using System.Collections;
using UnityEngine.UI;

public class Player : MonoBehaviour {
  public Text starText;
  private bool carryingStar = false;

  void Start(){
    UpdateStarText();
  }

  void OnTriggerEnter2D(Collider2D hit){
    if(hit.CompareTag("Star")){
      carryingStar = true;
      UpdateStarText();
      Destroy(hit.gameObject);
    }
  }

  private void UpdateStarText(){
    string starMessage = "no star :-(";
    if(carryingStar) starMessage = "Carrying star :-)";
    starText.text = starMessage;
  }
}</pre></div></li><li><p>From the <span class="strong"><strong>Hierarchy</strong></span> view, select the GameObject <code class="literal">player-SpaceGirl</code>. Then, from the <span class="strong"><strong>Inspector</strong></span>, access the <span class="strong"><strong>Player (Script)</strong></span> component and populate the <span class="strong"><strong>Star Text</strong></span> public field with UI <span class="strong"><strong>Text</strong></span> object <code class="literal">Text-carrying-star</code>, as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781784391362/graphics/1362OT_02_10.jpg" /></div></li><li><p>When you play<a id="id190" class="indexterm"></a> the scene, after moving the character into the star, the star should disappear, and the onscreen<a id="id191" class="indexterm"></a> UI <span class="strong"><strong>Text</strong></span> message should change to <span class="strong"><strong>Carrying star :-)</strong></span> , as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781784391362/graphics/1362OT_02_09.jpg" /></div></li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec70"></a>How it works...</h3></div></div></div><p>The <code class="literal">Text</code> variable <code class="literal">starText</code> is a reference to the UI <span class="strong"><strong>Text</strong></span> object <code class="literal">Text-carrying-star</code>. The <code class="literal">bool</code> variable <code class="literal">carryingStar</code> represents whether or not the player is carrying the star at any point in time; it is initialized to false.</p><p>The <code class="literal">UpdateStarText()</code> method <a id="id192" class="indexterm"></a>copies the contents of the <code class="literal">starMessage </code>string to the text property of <code class="literal">starText</code>. The default value of this string tells the user that the player is not carrying the<a id="id193" class="indexterm"></a> star, but an <code class="literal">if</code> statement tests the value of <code class="literal">carryingKey</code>, and, if that is true, then the message is changed to inform the player that they are carrying the star.</p><p>Each time the player's character collides with any object that has its <span class="strong"><strong>Is Trigger</strong></span> set to <code class="literal">true</code>, an <code class="literal">OnTriggerEnter2D()</code> event message is sent to both objects involved in the collision. The <code class="literal">OnTriggerEnter2D()</code> message is passed a parameter that is the <code class="literal">Collider2D</code> component inside the object just collided with.</p><p>Our player's <code class="literal">OnTriggerEnter2D()</code> method<a id="id194" class="indexterm"></a> tests the <code class="literal">tag</code> string of the object collided with to see if it has the <a id="id195" class="indexterm"></a>value <span class="strong"><strong>Star</strong></span>. Since the GameObject <span class="strong"><strong>star</strong></span> we created has its trigger set, and has the tag <span class="strong"><strong>Star</strong></span>, the <code class="literal">if</code> statement inside this method will detect a collision with <span class="strong"><strong>star</strong></span> and complete three actions: it sets the Boolean variable <code class="literal">carryingStar</code> to <code class="literal">true</code>, it calls the method <code class="literal">UpdateStarText()</code>, and it destroys the GameObject it has just collided with (in this case, <span class="strong"><strong>star</strong></span>).</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note22"></a>Note</h3><p>NOTE: Boolean variables are often<a id="id196" class="indexterm"></a> referred to as <span class="strong"><strong>flags.</strong></span>
</p><p>The use of a bool (true/false) variable to represent whether some feature of the game state is true or false is very common. Programmers often refer to these variables as flags. So, programmers might refer to the <code class="literal">carryingStar</code> variable as the star-carrying flag.</p></div><p>When the scene begins, via the <code class="literal">Start()</code>method, we call the <code class="literal">UpdateStarText()</code>method; this ensures that we are not relying on text typed into the UI <span class="strong"><strong>Text</strong></span> object <code class="literal">Text-carrying-star</code> at design time, but that the UI seen by the user is always set by our run-time methods. This avoids problems where the words to be displayed to the user are changed in code and not in the <span class="strong"><strong>Inspector</strong></span> panel—which leads to a mismatch between the onscreen text when the scene first runs and after it has been updated from a script.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note23"></a>Note</h3><p>A golden rule in Unity game design is to <span class="strong"><strong>avoid duplicating content in more than one place</strong></span>, and, therefore, we avoid having to maintain two or more copies of the same content. Each duplicate is an opportunity for maintenance issues when some, but not all, copies of a value are changed.</p><p>Maximizing use of prefabs is another example of this principle in action. This is also know as the DRY principal - Do Not Repeat Yourself.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec71"></a>There's more...</h3></div></div></div><p>Some details you don't want to miss:</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch02lvl3sec18"></a>The separation of view logic</h4></div></div></div><p>A game design pattern (best practice approach) called<a id="id197" class="indexterm"></a> the <span class="strong"><strong>Model-View-Controller</strong></span> pattern (<span class="strong"><strong>MVC</strong></span>) is to separate the code that updates the UI from the code that changes player and game <a id="id198" class="indexterm"></a>variables such as score and inventory item lists. Although this recipe has only one variable and one method to update the UI, well structured game architectures scale up to cope with more complex games, so it is often worth the effort of a little more code and an extra script class, even at this game-beginning stage, if we want our final game architecture to be well structured and maintainable.</p><p>To implement the separation of view pattern for this recipe, we need to do the following:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Add the following C# Script <code class="literal">PlayerInventoryDisplay</code> to GameObject <code class="literal">player-SpaceGirl</code> in the <span class="strong"><strong>Hierarchy</strong></span>:</p><div class="informalexample"><pre class="programlisting">using UnityEngine;
using System.Collections;
using UnityEngine.UI;

public class PlayerInventoryDisplay : MonoBehaviour
{
  public Text starText;

  public void OnChangeCarryingStar(bool carryingStar){
    string starMessage = "no star :-(";
    if(carryingStar) starMessage = "Carrying star :-)";
    starText.text = starMessage;
  }
}</pre></div></li><li><p>From the <span class="strong"><strong>Hierarchy</strong></span> view, select the GameObject <code class="literal">player-SpaceGirl</code>. Then, from the <span class="strong"><strong>Inspector</strong></span>, access the <code class="literal">PlayerInventoryDisplay</code>
<span class="strong"><strong> (Script)</strong></span> component and populate the <span class="strong"><strong>Score Text</strong></span> public field with the UI <span class="strong"><strong>Text</strong></span> object <code class="literal">Text-carrying-star</code>.</p></li><li><p>Remove the existing C# Script component <code class="literal">Player</code> and replace it with this C# Script <code class="literal">PlayerInventory</code> containing the following (simplified) code:</p><div class="informalexample"><pre class="programlisting">using UnityEngine;
using System.Collections;

public class PlayerInventory : MonoBehaviour {
  private PlayerInventoryDisplay playerInventoryDisplay;
  private bool carryingStar = false;

  void Start(){
    playerInventoryDisplay = GetComponent&lt;PlayerInventoryDisplay&gt;();
  playerInventoryDisplay.OnChangeCarryingStar(carryingStar);
  }

  void OnTriggerEnter2D(Collider2D hit){
    if(hit.CompareTag("Star")){
      carryingStar = true;
  playerInventoryDisplay.OnChangeCarryingStar(carryingStar);
      Destroy(hit.gameObject);
    }
  }
}</pre></div></li></ol></div><p>As can be seen, the <a id="id199" class="indexterm"></a>
<code class="literal">PlayerInventory</code> script class no longer has to maintain a link to the UI <span class="strong"><strong>Text</strong></span> or worry about changing the text property of that UI component—all that work is now the responsibility of the <code class="literal">PlayerInventoryDisplay</code> script. When the Player instance component detects a collision with the star, after changing the <code class="literal">carryingStar</code> bool flag's value to <code class="literal">true</code>, it just calls the <code class="literal">OnChangeCarryingStar()</code>method of the <code class="literal">PlayerInventoryDisplay</code> component.</p><p>The result is that the code for the script class <code class="literal">PlayerInventory</code> concentrates on the player collision and status variables, while the code for the script class <code class="literal">PlayerInventoryDisplay</code> handles the communication to the user. Another advantage of this design pattern is that the method in which the information is communicated to the user via the UI can be changed (for example, from text to an icon), without any change to the code in script class <code class="literal">Player</code>.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note24"></a>Note</h3><p>Note: There is no difference in the experience of the player, and all the changes are to improve the architectural structure of our game code.</p></div></div></div></div>