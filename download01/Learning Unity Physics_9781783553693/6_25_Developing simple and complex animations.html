<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch06lvl1sec26"></a>Developing simple and complex animations</h2></div></div><hr /></div><p>As <a id="id249" class="indexterm"></a>mentioned earlier, you will learn how to handle <a id="id250" class="indexterm"></a>and create simple and complex animations using Physics, for example, creating a rope animation and hanging ball. Let's start with the Physics properties of a Rigidbody component, which help in syncing animation.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec25"></a>Interpolate and Extrapolate</h3></div></div></div><p>Unity3D <a id="id251" class="indexterm"></a>offers a way that its Rigidbody <a id="id252" class="indexterm"></a>component can help in the syncing <a id="id253" class="indexterm"></a>of animation. Using the interpolation <a id="id254" class="indexterm"></a>and extrapolation properties, we sync animations.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note22"></a>Note</h3><p>Interpolation is not only for animation, it also works with Rigidbody.</p></div><p>Let's see in detail how interpolation and extrapolation work:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Create a new scene and save it.</p></li><li><p>Create a <span class="strong"><strong>Cube</strong></span> game object and apply <span class="strong"><strong>Rigidbody</strong></span> on it.</p></li><li><p>Look <a id="id255" class="indexterm"></a>at the <span class="strong"><strong>Inspector</strong></span> panel <a id="id256" class="indexterm"></a>shown in the following<a id="id257" class="indexterm"></a> screenshot. On <a id="id258" class="indexterm"></a>clicking <span class="strong"><strong>Interpolate</strong></span>, a drop-down list that contains three options will appear, which are <span class="strong"><strong>None</strong></span>, <span class="strong"><strong>Interpolate</strong></span>, and <span class="strong"><strong>Extrapolate</strong></span>. For details, refer to the previous chapter. By selecting any one of them, we can apply the feature.</p><div class="mediaobject"><img src="/graphics/9781783553693/graphics/3693OT_06_01.jpg" /></div></li></ol></div><p>In interpolation, the position of an object is calculated by the current update time, moving it backwards one Physics update delta time.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note23"></a>Note</h3><p>
<span class="strong"><strong>Delta time</strong></span> or <span class="strong"><strong>delta timing</strong></span> is a concept used among programmers in relation to <a id="id259" class="indexterm"></a>frame<a id="id260" class="indexterm"></a> rate and time. For more details, check out <a class="ulink" href="http://docs.unity3d.com/ScriptReference/Time-deltaTime.html" target="_blank">http://docs.unity3d.com/ScriptReference/Time-deltaTime.html</a>.</p></div><p>If you look closely, you will observe that there are at least two Physics updates, which are as follows:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>Ahead of the chosen time</p></li><li style="list-style-type: disc"><p>Behind the chosen time</p></li></ul></div><p>Unity interpolates between these two updates to get a position for the update position. So, we can say that the interpolation is actually lagging behind one Physics update.</p><p>The <a id="id261" class="indexterm"></a>second option is <span class="strong"><strong>Extrapolate</strong></span>, which<a id="id262" class="indexterm"></a> is to use for extrapolation. In this <a id="id263" class="indexterm"></a>case, Unity predicts the future position for<a id="id264" class="indexterm"></a> the object. Although this does not show any lag, incorrect prediction sometime causes a visual jitter.</p><p>One more<a id="id265" class="indexterm"></a> important component that is widely used to animate cloth is the <span class="strong"><strong>Cloth component</strong></span>. Here, you will learn about its properties and how to use it.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec26"></a>The Cloth component</h3></div></div></div><p>To make <a id="id266" class="indexterm"></a>animation easy, Unity provides an interactive <a id="id267" class="indexterm"></a>component called <span class="strong"><strong>Cloth</strong></span>. In the <span class="strong"><strong>GameObject</strong></span> menu, you can directly create the <span class="strong"><strong>Cloth</strong></span> game object. Have a look at the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783553693/graphics/3693OT_06_02.jpg" /></div><p>Unity<a id="id268" class="indexterm"></a> also provides Cloth components in its Physics sections. To <a id="id269" class="indexterm"></a>apply this, let's look at an example:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Create a new scene and save it.</p></li><li><p>Create a <span class="strong"><strong>Plane</strong></span> game object. (We can also create a <span class="strong"><strong>Cloth</strong></span> game object.)</p></li><li><p>Navigate to <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>Physics</strong></span> and choose <span class="strong"><strong>InteractiveCloth</strong></span>.</p><p>As shown in the following screenshot, you will see the following properties in the <span class="strong"><strong>Inspector</strong></span> panel:</p><div class="mediaobject"><img src="/graphics/9781783553693/graphics/3693OT_06_03.jpg" /></div></li></ol></div><p>Let's have<a id="id270" class="indexterm"></a> a look at the properties one by one. <span class="strong"><strong>Blending Stiffness</strong></span> and <span class="strong"><strong>Stretching Stiffness</strong></span> define the blending and stretching stiffness of the Cloth<a id="id271" class="indexterm"></a> while <span class="strong"><strong>Damping</strong></span> defines the damp motion of the Cloth. Using the <span class="strong"><strong>Thickness</strong></span> property, we decide the thickness of the Cloth, which ranges from 0.001 to 10,000. If we enable the <span class="strong"><strong>Use Gravity</strong></span> property, it will affect the Cloth simulation. Similarly, if we enable <span class="strong"><strong>Self Collision</strong></span>, it allows the Cloth to collide with itself. For a constant or random acceleration, we apply the <span class="strong"><strong>External Acceleration</strong></span> and <span class="strong"><strong>Random Acceleration</strong></span> properties, respectively.</p><p>
<span class="strong"><strong>World Velocity Scale</strong></span> decides the movement of the character in the world, which will affect the Cloth vertices. The higher the value, the more movement of the character will affect. <span class="strong"><strong>World Acceleration</strong></span> works similarly. The <span class="strong"><strong>Interactive Cloth</strong></span> component depends on the <span class="strong"><strong>Cloth Renderer</strong></span> components. Lots of Cloth components in a game reduces the performance of game. To simulate clothing in characters, we use the <span class="strong"><strong>Skinned Cloth</strong></span> component.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch06lvl3sec26"></a>Important points while using the Cloth component</h4></div></div></div><p>The following <a id="id272" class="indexterm"></a>are the important points to remember while using the Cloth component:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>Cloth simulation will not generate tangents. So, if you are using a tangent dependent shader, the lighting will look wrong for a Cloth component that has been moved from its initial position.</p></li><li style="list-style-type: disc"><p>We cannot directly change the transform of moving the Cloth game object. This is not supported.</p></li><li style="list-style-type: disc"><p>Disabling the Cloth before changing the transform is supported.</p></li><li style="list-style-type: disc"><p>The <span class="strong"><strong>SkinnedCloth</strong></span> component works together with <span class="strong"><strong>SkinnedMeshRenderer</strong></span> to simulate clothing on a character. As shown in the following screenshot, we can apply <span class="strong"><strong>Skinned Cloth</strong></span>:</p><div class="mediaobject"><img src="/graphics/9781783553693/graphics/3693OT_06_04.jpg" /></div></li></ul></div><p>As you can <a id="id273" class="indexterm"></a>see in the following screenshot, there are different properties that we can use to get the desired effect:</p><div class="mediaobject"><img src="/graphics/9781783553693/graphics/3693OT_06_05.jpg" /></div><p>We can <a id="id274" class="indexterm"></a>disable or enable the<span class="strong"><strong> Skinned Cloth</strong></span> component at any time to turn it on or off.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec27"></a>ConstantForce</h3></div></div></div><p>When a <a id="id275" class="indexterm"></a>force is applied constantly on a game object, it is known as<a id="id276" class="indexterm"></a> constant force. We use the <code class="literal">ConstantForce</code> Physics utility class to apply constant force on a game object. <code class="literal">AddForce</code> applies a force to the Rigidbody only for one frame whereas <code class="literal">ConstantForce</code> applies a force in every frame until we change the force or torque to a new value.</p><p>We use this for one-shot objects such as rockets.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch06lvl3sec27"></a>An example of animation using ConstantForce</h4></div></div></div><p>We <a id="id277" class="indexterm"></a>will look at the example of animation <a id="id278" class="indexterm"></a>using ConstantForce with the help of the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Create a new scene and save it as <code class="literal">Constant Force Example</code>.</p></li><li><p>Create a <span class="strong"><strong>Cube</strong></span> game object.</p></li><li><p>As shown in the following screenshot, apply <span class="strong"><strong>Constant Force</strong></span> on it:</p><div class="mediaobject"><img src="/graphics/9781783553693/graphics/3693OT_06_06.jpg" /></div></li><li><p>To make a cube that accelerates forward, we set <span class="strong"><strong>Relative Force</strong></span> to be along the positive <span class="emphasis"><em>z</em></span> axis.</p></li><li><p>Then, use the Rigidbody's <span class="strong"><strong>Drag</strong></span> property to set the maximum velocity and turn off gravity so that the game object will always stay on its path.</p><div class="mediaobject"><img src="/graphics/9781783553693/graphics/3693OT_06_07.jpg" /></div></li><li><p>Run the scene and you will see that the cube game object moves constantly.</p></li></ol></div><p>Till <a id="id279" class="indexterm"></a>now, you have learned different Physics <a id="id280" class="indexterm"></a>components. Now, you'll learn how we can use Physics in scripting. In this chapter, we will learn <code class="literal">AddForce</code> and <code class="literal">AddTorque</code>. By applying <code class="literal">AddForce</code> on a Rigidbody, we make it move while <code class="literal">AddTorque</code> adds a torque to the Rigidbody to make it spin around the torque axis.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch06lvl3sec28"></a>An example of animation using AddForce</h4></div></div></div><p>
<code class="literal">AddForce</code> adds <a id="id281" class="indexterm"></a>force to the Rigidbody.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note24"></a>Note</h3><p>In <a id="id282" class="indexterm"></a>Physics, a <span class="strong"><strong>force</strong></span> is any interaction<a id="id283" class="indexterm"></a> that tends to change the motion of an object. In other words, a force can cause an object with mass to change its velocity (which includes beginning moving from a state of rest), that is, to accelerate. Force can also be described by intuitive concepts such as a push or a pull.</p></div><p>In this example, we will create a projectile using <code class="literal">AddForce</code> Physics:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Create a new scene and save it as <code class="literal">addForce example</code>.</p></li><li><p>Use a <span class="strong"><strong>Plane</strong></span> game object to create ground.</p></li><li><p>Apply a green material on it.</p></li><li><p>Create a <span class="strong"><strong>Capsule</strong></span> object and apply <span class="strong"><strong>Rigidbody</strong></span> on it as shown in the following screenshot. Now, name it <code class="literal">bullet</code>.</p><div class="mediaobject"><img src="/graphics/9781783553693/graphics/3693OT_06_08.jpg" /></div></li><li><p>Create <a id="id284" class="indexterm"></a>a new JavaScript or UnityScript <a id="id285" class="indexterm"></a>and name it <code class="literal">projectile</code>. Write the following code inside it:</p><div class="informalexample"><pre class="programlisting">var speed:int=10000;
var bulletObject: GameObject;
private var hitPoint:Vector3;
private var hit : RaycastHit;
function Update ()
{
  var ray = Camera.main.ScreenPointToRay (Input.mousePosition);
  if (Input.GetMouseButtonDown (0))
  {
    if (Physics.Raycast (ray, hit, 300.0f))
    {
      if (hit.collider.tag == "ground")
      {
// Add "ground " tag to the plane game object.
        var bullet = Instantiate(bulletObject, Vector3(0,1.5,-12), transform.rotation);
        bullet.rigidbody.AddForce( Vector3(0,0.5,0.5) * speed);
      }
    }
  }
}</pre></div></li><li><p>As shown in the following screenshot, you will need to specify <span class="strong"><strong>Bullet Object</strong></span>:</p><div class="mediaobject"><img src="/graphics/9781783553693/graphics/3693OT_06_09.jpg" /></div></li><li><p>Drag<a id="id286" class="indexterm"></a> the <span class="strong"><strong>bullet</strong></span> game object and <a id="id287" class="indexterm"></a>put it on the <span class="strong"><strong>Bullet Object</strong></span> section as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783553693/graphics/3693OT_06_10.jpg" /></div></li><li><p>Now, test the scene and you will see that on a click, the bullet is fired and it is moved in a projectile.</p></li></ol></div><p>In this example, we saw how to use <code class="literal">AddForce</code> to create a projectile animation. Similarly, in the next example, we will see how to use <code class="literal">AddTorque</code> to create an animation.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch06lvl3sec29"></a>An example of animation using AddTorque</h4></div></div></div><p>
<code class="literal">AddTorque</code> <a id="id288" class="indexterm"></a>adds<a id="id289" class="indexterm"></a> torque to the Rigidbody.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note25"></a>Note</h3><p>Torque is a measure of the turning force on an object such as a bolt or a flywheel. For example, pushing or pulling the handle of a wrench connected to a nut or bolt produces a torque (turning force) that loosens or tightens the nut or bolt.</p></div><p>In this <a id="id290" class="indexterm"></a>example, we will use <code class="literal">AddTorque</code> to create an <a id="id291" class="indexterm"></a>animation:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Create a new scene and save it as <code class="literal">AddTorque example</code>.</p></li><li><p>Create a <span class="strong"><strong>Cube</strong></span> game object and name it <code class="literal">box</code>.</p></li><li><p>Add <span class="strong"><strong>Rigidbody</strong></span> on a <span class="strong"><strong>Box</strong></span> game object.</p></li><li><p>Create a new JavaScript and use the following code:</p><div class="informalexample"><pre class="programlisting">// Spins the rigidbody around the global y-axis
  var box:GameObject;
  var speed:int=10;
  function FixedUpdate () {
    box.rigidbody.AddTorque (Vector3.up * speed);
  }</pre></div></li><li><p>Add the script file to <span class="strong"><strong>Main Camera</strong></span> and drag the game object box to the box variable.</p></li><li><p>Run the scene and you will see the spin movement of the box.</p></li></ol></div><p>In another example, we will create an animation using different joints. In the previous chapter, you learned different joints, including the character joint, which is used for a Ragdoll effect. Now, we will create a rope animation using <span class="strong"><strong>Fixed Joint</strong></span> and <span class="strong"><strong>Hinge Joint</strong></span>.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch06lvl3sec30"></a>An example of rope animation using different joints</h4></div></div></div><p>In the <a id="id292" class="indexterm"></a>following example, we will create a<a id="id293" class="indexterm"></a> rope using different joints. Joints help to create flexible animation, and this is why we are going to use joints for the rope animation.</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Create a new scene and save it as <code class="literal">Rope Animation example</code>.</p></li><li><p>Create a <span class="strong"><strong>Sphere</strong></span> game object and apply a material to make it colorful.</p></li><li><p>Now, apply <span class="strong"><strong>Rigidbody</strong></span> and <span class="strong"><strong>Fixed Joint</strong></span> on it as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783553693/graphics/3693OT_06_11.jpg" /></div></li><li><p>Create<a id="id294" class="indexterm"></a> a <span class="strong"><strong>Cylinder</strong></span> game object <a id="id295" class="indexterm"></a>and name it <code class="literal">Chain 1</code>.</p></li><li><p>Now, apply <span class="strong"><strong>Rigidbody</strong></span> and <span class="strong"><strong>Hinge Joint</strong></span> on it. As shown in the following screenshot, you will see the <span class="strong"><strong>Connected Body</strong></span> property:</p><div class="mediaobject"><img src="/graphics/9781783553693/graphics/3693OT_06_12.jpg" /></div></li><li><p>In the <span class="strong"><strong>Connected Body</strong></span> property of the <span class="strong"><strong>Sphere</strong></span> game object, drag the <span class="strong"><strong>Chain 1</strong></span> game object.</p><div class="mediaobject"><img src="/graphics/9781783553693/graphics/3693OT_06_13.jpg" /></div></li><li><p>Now, run<a id="id296" class="indexterm"></a> the scene; you will <a id="id297" class="indexterm"></a>see that the sphere falls along with the <span class="strong"><strong>Cylinder</strong></span> game object as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783553693/graphics/3693OT_06_14.jpg" /></div></li><li><p>As shown in the following screenshot, now create the <code class="literal">Chain 2</code> game object and apply <span class="strong"><strong>Rigidbody</strong></span> and <span class="strong"><strong>Hinge Joint</strong></span>. Specify its position above the <span class="strong"><strong>Chain 1</strong></span> and drag <span class="strong"><strong>Chain 2</strong></span> as connected body for <span class="strong"><strong>Chain 1</strong></span>.</p><div class="mediaobject"><img src="/graphics/9781783553693/graphics/3693OT_06_15.jpg" /></div></li><li><p>Similarly, create <a id="id298" class="indexterm"></a>
<span class="strong"><strong>Chain 3</strong></span> and<a id="id299" class="indexterm"></a> <span class="strong"><strong>Chain 4</strong></span>. Now, rotate all the game objects as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783553693/graphics/3693OT_06_16.jpg" /></div></li><li><p>Test <a id="id300" class="indexterm"></a>this application; you will <a id="id301" class="indexterm"></a>see a sphere hanging from a rope:</p><div class="mediaobject"><img src="/graphics/9781783553693/graphics/3693OT_06_17.jpg" /></div></li></ol></div><p>In the preceding steps, you learned how to create an animation using different joints.</p></div></div></div>