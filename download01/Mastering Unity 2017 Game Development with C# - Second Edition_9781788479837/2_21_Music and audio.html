<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch02lvl1sec27"></a>Music and audio</h2></div></div><hr /></div><p>To complete basic level configuration and structure, let's add music, specifically, the main background music that should play continuously throughout the level. In the last chapter, we imported audio assets, both music and <span>sound</span> effects, and configured these optimally. As discussed earlier, it is most important that music is configured for <strong class="userinput"><code>Streaming</code></strong> as the <strong class="userinput"><code>Load Type</code></strong>, and the <strong class="userinput"><code>Compression Format</code></strong> should be set to <strong class="userinput"><code>Vorbis</code></strong>. This ensures that Unity doesn't load the complete track into memory as it would do with sound and audio. Loading complete music tracks will be performance prohibitive, especially for mobile devices and legacy hardware:</p><div class="mediaobject"><img src="/graphics/9781788479837/graphics/d4bae1d7-80f7-4f55-a9cb-da4ca0c09b74.png" /></div><p>Configuring music audio</p><p>In addition to importing music assets, let's create an <strong class="userinput"><code>Audio Mixer</code></strong> asset. This is optional in theory, as Unity can play audio without a mixer. However, mixers give you more control over different audio types and their independent volumes and balance (SFX, music, voice, and more). To create an <strong class="userinput"><code>Audio Mixer</code></strong> asset, right-click inside the <strong class="userinput"><code>Project</code></strong> panel and navigate to <strong class="userinput"><code>Create</code></strong> | <strong class="userinput"><code>Audio Mixer</code></strong> from the context menu. As with all assets, this should be contained in an appropriately named folder:</p><div class="mediaobject"><img src="/graphics/9781788479837/graphics/3fb9b6ba-c2a7-4d02-b905-74860b45bad5.png" /></div><p>Creating an Audio Mixer asset</p><p>By double-clicking on the <strong class="userinput"><code>Audio Mixer</code></strong> asset on the <strong class="userinput"><code>Project</code></strong> panel, it'll open automatically in the <strong class="userinput"><code>Audio Mixer</code></strong> window, which can also be <span>shown</span> by navigating to <strong class="userinput"><code>Window</code></strong> | <strong class="userinput"><code>Audio Mixer</code></strong> on the application menu. By default, the <strong class="userinput"><code>Audio Mixer</code></strong> is created with a <strong class="userinput"><code>Master</code></strong> group, which controls the volume for all audio (hence the name <strong class="userinput"><code>Master</code></strong>). This is displayed in the <strong class="userinput"><code>Audio Mixer</code></strong> as both a visual controller and a named listed in the <strong class="userinput"><code>Groups</code></strong> hierarchy:</p><div class="mediaobject"><img src="/graphics/9781788479837/graphics/ce18425f-ff9c-4827-93ec-7ea651a07e69.png" /></div><p>A new Audio Mixer</p><p>In addition to the <strong class="userinput"><code>Master</code></strong> volume group, we want independent control over the volume for music, sound effects, and voice, as appropriate. This lets us balance volume levels to arrive at a harmonious soundtrack. To achieve this, right-click on the <strong class="userinput"><code>Master</code></strong> group from the hierarchy and choose <strong class="userinput"><code>Add child group</code></strong>. Repeat this process to create three child groups, and then rename themÂ <strong class="userinput"><code>Music</code></strong>, <strong class="userinput"><code>SFX</code></strong>, and <strong class="userinput"><code>Voice</code></strong>:</p><div class="mediaobject"><img src="/graphics/9781788479837/graphics/669c2401-b2fe-4f4f-8d30-7eeec7c2f24c.png" /></div><p>Adding child groups: Music, SFX, and Voice</p><p>As the <strong class="userinput"><code>Music</code></strong>, <strong class="userinput"><code>SFX</code></strong>, and <strong class="userinput"><code>Voice</code></strong> groups are children of the <strong class="userinput"><code>Master</code></strong> group, their volume is dependent, that is, volume changes in <strong class="userinput"><code>SFX</code></strong>, <strong class="userinput"><code>Music</code></strong>, or <strong class="userinput"><code>Voice</code></strong> do not change the <strong class="userinput"><code>Master</code></strong> volume, but the master volume cascades downward to child groups. Having configured the <strong class="userinput"><code>Audio Mixer</code></strong> in this way, we can now route scene audio through a specific group to have high-level control over its volume. Select the root object in the scene (the topmost object), and drag and drop the music asset on to it from the <strong class="userinput"><code>Project</code></strong> panel. This creates an <strong class="userinput"><code>Audio Source</code></strong> component automatically on the root object, wired to the music track. Alternatively, you can <span>select</span> the root object and navigate to <strong class="userinput"><code>Component</code></strong> | <strong class="userinput"><code>Audio</code></strong> | <strong class="userinput"><code>Audio Source</code></strong> from the application menu to add an <strong class="userinput"><code>Audio Source</code></strong> component. Once added, you should drag and drop the music track from the <strong class="userinput"><code>Project</code></strong> panel into the <strong class="userinput"><code>AudioClip</code></strong> slot to assign the track to the component:</p><div class="mediaobject"><img src="/graphics/9781788479837/graphics/cd9d6d77-3a8c-42a9-931d-bbc8aa2aac9a.png" /></div><p>Assigning a music track to the Audio Source component</p><p>The <strong class="userinput"><code>Audio Source</code></strong> component features an <strong class="userinput"><code>Output</code></strong> field, defining the mixer group to which the audio should be routed. For the music track, this should route to the <strong class="userinput"><code>Music</code></strong> child group of the <strong class="userinput"><code>Master</code></strong> group. To choose this, simply click on the <strong class="userinput"><code>Group Selection</code></strong> button in the object <strong class="userinput"><code>Inspector</code></strong>, and then choose the appropriate group:</p><div class="mediaobject"><img src="/graphics/9781788479837/graphics/6f77ba57-8cf6-4aed-9e0c-54e087e63740.png" /></div><p>Selecting an Output group</p><p>The <strong class="userinput"><code>Audio Source</code></strong> component for the music track is almost configured. The music should play as the scene begins, and it should play endlessly in a loop. This behavior can be created in code, but we can simply enable the <strong class="userinput"><code>Play on Awake</code></strong> and <strong class="userinput"><code>Loop</code></strong> checkboxes from the <strong class="userinput"><code>Audio Source</code></strong> component:</p><div class="mediaobject"><img src="/graphics/9781788479837/graphics/c0c2b842-21aa-41d1-9f25-6c5aa4305f5e.png" /></div><p>Enabling Play on Awake and Loop</p><p>In addition, the music track should be a 2D type of audio, that is, its volume and speaker-pan is unrelated to player position; the music should <span>play</span> at a consistent volume, regardless of player movement. To achieve this, ensure that the <strong class="userinput"><code>Spatial Blend</code></strong> of the <strong class="userinput"><code>Audio Source</code></strong> component is set to 2D:</p><div class="mediaobject"><img src="/graphics/9781788479837/graphics/ea74353f-cd53-4254-8a1c-c6982ea209a5.png" /></div><p>Setting Spatial Blend to 2D</p><p>The <strong class="userinput"><code>Audio Source</code></strong> component for the music track is now configured. To hear audio, however, the scene should have one and only one <strong class="userinput"><code>Audio Listener</code></strong> component. This is typically attached to the player camera, representing the player ears. Select the player camera, and then navigate to <strong class="userinput"><code>Component</code></strong> | <strong class="userinput"><code>Audio</code></strong> | <strong class="userinput"><code>Audio Listener</code></strong> to attach a listener to the camera, if not present already. That's it! You can now test out the level, complete with music:</p><div class="mediaobject"><img src="/graphics/9781788479837/graphics/ae3e8715-4bad-416d-8936-404bbd09bf9e.png" /></div><p>Adding an Audio Listener to the Scene</p></div>