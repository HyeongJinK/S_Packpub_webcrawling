<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch02lvl1sec22"></a>Lighting FAQ</h2></div></div><hr /></div><p>This section takes time out to explore lighting <span>issues</span> and problems that sometimes arise and common methods to solve them. The issues listed here may not arise for the <span class="emphasis"><em>Dead Keys</em></span> project specifically, but it's likely that you'll encounter them somewhere, on some projects. Consequently, it's good to know how the issues are solved, or at least avoided. This section takes a question and answer format:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><span class="strong"><strong>Scene lighting appears wrong when opening a scene in the editor</strong></span>: This happens when <strong class="userinput"><code>Auto Generate</code></strong> is enabled from the <strong class="userinput"><code>Lighting</code></strong> window. As the scene is opened, lighting is rebaked. This may take time or may fail entirely for various reasons. The result is that scene lighting may not appear correct instantly when a scene is opened. You can resolve this by disabling auto generate from the <strong class="userinput"><code>Lighting</code></strong> window and then saving the scene to confirm the change. The next time the scene is opened, the existing baked data will be used instead:</li></ul></div><div class="mediaobject"><img src="/graphics/9781788479837/graphics/45450d9b-55f9-4362-b0ab-d900107d5ba3.png" /></div><p>Disabling Auto for baking</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><span class="strong"><strong>Scene lighting is baked, but appears messed up in the scene</strong></span>: If lighting looks wrong on the meshes, such as a jumbled mess with shadows, colors, and highlights appearing in the wrong places, then you can try the following two steps in order. First, ensure that all meshes either have a second UV channel for a lightmap or have the <strong class="userinput"><code>Generate Lightmap UV</code></strong> option enabled via the object <strong class="userinput"><code>Inspector</code></strong>. This is important because lightmaps are baked to a texture through a second UV channel:</li></ul></div><div class="mediaobject"><img src="/graphics/9781788479837/graphics/09e8b86a-8ac0-4ba0-a23f-b57812f8e883.png" /></div><p>Generating Lightmap UVs</p><p>Secondly, you can try enabling the <strong class="userinput"><code>Swap UVs</code></strong> option when <strong class="userinput"><code>Generate Lightmap UV</code></strong> is disabled, from the object <strong class="userinput"><code>Inspector</code></strong>, as the wrong UV channel may have been used for the lightmap. In any case, a complete rebake is required:</p><div class="mediaobject"><img src="/graphics/9781788479837/graphics/4b11158a-8a46-49dc-86fb-f2e71c7ec353.png" /></div><p>Swapping Lightmap UVs</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><span class="strong"><strong>Some lights don't work!</strong></span>: Here's a common problem. You add a light to the scene and it works fine. Then you add a second, and that works fine too. Then, after adding more, you soon discover that additional lights behave differently in an important way. Some have no affect at all, or some illuminate the environment with less or more intensity than expected, despite having the same settings as the earlier lights. This problem can be related to the light quality settings and per-pixel lights. In Unity, there are two main light types: vertex-based and pixel-based. Vertex-based lights are less accurate and typically produce lower quality lighting, but they're cheaper to calculate and work better on legacy hardware. This is because they illuminate meshes by interpolating light across their vertices. Pixel-based lights, in contrast, produce better lighting, but are calculated on pixel basis, as opposed to vertices, which makes them computationally expensive. By default, Unity specifies a maximum of four per-pixel lights in the <strong class="userinput"><code>QualitySettings</code></strong>, and it makes a determination at runtime as to whether a light should be pixel-based or vertex-based, in line with the <strong class="userinput"><code>QualitySettings</code></strong>.</li></ul></div><p>This means that after four per-pixel lights are added to the scene and are active, Unity automatically converts additional lights to vertex-based lights, and these illuminate differently. There are two different ways to solve this problem. First, you can <span>increase</span> the number of per-pixel lights permitted at one time in a scene, using the <strong class="userinput"><code>QualitySettings</code></strong>. To do this, navigate to <strong class="userinput"><code>Edit</code></strong> | <strong class="userinput"><code>Project Settings</code></strong> | <strong class="userinput"><code>Quality</code></strong> from the application menu, to display <strong class="userinput"><code>QualitySettings</code></strong> in the object <strong class="userinput"><code>Inspector</code></strong>:</p><div class="mediaobject"><img src="/graphics/9781788479837/graphics/41b36155-0923-45f1-9409-d6cff82e2f90.png" /></div><p>Accessing QualitySettings</p><p>From here, specify a new maximum for the <strong class="userinput"><code>Pixel Light Count</code></strong> field in the object <strong class="userinput"><code>Inspector</code></strong>. This increases the maximum number of per-pixel lights permitted:</p><div class="mediaobject"><img src="/graphics/9781788479837/graphics/b09efe7c-dfe6-456c-9adc-edd6e52bac70.png" /></div><p>Setting the maximum number of per-pixel lights</p><p>You can force Unity to recognize a light as either vertex-based or pixel-based using the <strong class="userinput"><code>Render Mode</code></strong> setting for the light object in the <strong class="userinput"><code>Light</code></strong> component from the object Inspector. This overrides the determination Unity makes for each light. Simply <span>change</span> the <strong class="userinput"><code>Render Mode</code></strong> from <strong class="userinput"><code>Auto</code></strong> (let Unity decide) to either <strong class="userinput"><code>Important</code></strong> (pixel-based) or <strong class="userinput"><code>Not Important</code></strong> (vertex-based):</p><div class="mediaobject"><img src="/graphics/9781788479837/graphics/45eaeb19-5dd8-47fc-a8c4-2eaee948a975.png" /></div><p>Setting the Light Render Mode</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><span class="strong"><strong>Objects don't cast or receive shadows</strong></span>: If your scene is missing shadows and you don't know why, there are several important stages where problems can occur. First, ensure that the selected light is configured for shadow casting. To do this, set the <strong class="userinput"><code>Shadow Type</code></strong> field, from the object Inspector, to either <strong class="userinput"><code>Soft Shadows</code></strong> or <strong class="userinput"><code>Hard Shadows</code></strong>:</li></ul></div><div class="mediaobject"><img src="/graphics/9781788479837/graphics/03ca3807-33d8-4558-8cd6-e2744bad88cb.png" /></div><p>Specifying Shadow Type for a light</p><p>Next, ensure that other renderable meshes can <span class="emphasis"><em>cast</em></span> and <span class="emphasis"><em>receive</em></span> shadows as needed. Shadow casting is the ability for a mesh to cast a shadow elsewhere; and shadow receiving defines whether the mesh can have shadows cast upon its own surface. To enable <span>these</span> features, select each mesh to cast and/or receive shadows and, from the <strong class="userinput"><code>Mesh Renderer</code></strong> component in the object <strong class="userinput"><code>Inspector</code></strong>, enable the <strong class="userinput"><code>Receive Shadows</code></strong> checkbox. In addition, set <strong class="userinput"><code>Cast Shadows</code></strong> to <code class="literal">On</code>:</p><div class="mediaobject"><img src="/graphics/9781788479837/graphics/64ff546a-2435-432b-80b4-2b1355cac678.png" /></div><p>Enabling shadow casting and receiving for meshes</p><p>Finally, from the <strong class="userinput"><code>QualitySettings</code></strong> window, ensure that shadows are enabled overall, and that your viewport and scene camera are within the <strong class="userinput"><code>Shadow Distance</code></strong>. The <strong class="userinput"><code>QualitySettings</code></strong> window is displayed by navigating to <strong class="userinput"><code>Edit</code></strong> | <strong class="userinput"><code>Project Settings</code></strong> | <strong class="userinput"><code>Quality</code></strong>. Both values (<strong class="userinput"><code>Shadow Casting</code></strong> and <strong class="userinput"><code>Shadow Distance</code></strong>) can be controlled from the <strong class="userinput"><code>QualitySettings</code></strong> window. Shadows can be enabled and disabled altogether using the <strong class="userinput"><code>Shadows</code></strong> drop-down field. A value of <strong class="userinput"><code>Hard and Soft Shadows</code></strong> permits all kinds of shadows, while Disable Shadows disables any shadows, regardless of light and mesh settings:</p><div class="mediaobject"><img src="/graphics/9781788479837/graphics/6fff778c-0b9d-4718-a1db-3bfa5adf7362.png" /></div><p>Shadow settings master control</p><p>The <strong class="userinput"><code>Shadow Distance</code></strong> field specifies a distance in meters from the camera, beyond which any shadow casting or receiving is disabled. Shadows beyond the <strong class="userinput"><code>Shadow Distance</code></strong> are not rendered, regardless of the other shadow settings. Increasing <span>the</span><strong class="userinput"><code>Shadow Distance</code></strong> brings more shadows into view at the expense of performance:</p><div class="mediaobject"><img src="/graphics/9781788479837/graphics/57bf869c-e604-4420-a6eb-6ba3d3986930.png" /></div><p>Tweaking Shadow Distance</p></div>