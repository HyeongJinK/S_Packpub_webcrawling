<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch07lvl1sec77"></a>Player preferences - saving data</h2></div></div><hr /></div><p>For <span class="emphasis"><em>Dead Keys</em></span>, the <span>player</span> progresses through a sequence of levels, one after another. Upon reaching the end of one level, the next begins. As the player moves from level to level, their progress should be saved so that the most recent player can easily resume their progress from the highest attained level on their next play session. To achieve this, we need to use only the <code class="literal">PlayerPrefs</code> class for storing the highest attained level. Progress cannot be resumed within a level, that is, the player may resume play from the highest attained level, but always from the beginning of that level.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note49"></a>Note</h3><p>As we'll see later in this chapter, the <code class="literal">PlayerPrefs</code> class is all we'll need for saving and loading user data in <span class="emphasis"><em>Dead Keys</em></span>. This makes our persistent data needs very simple. Nevertheless, we'll cover a range of data storage solutions here, for games of all sizes, both small and <span>large</span>.</p></div><p>Saving Data for Dead Keys will be an important gameplay element...</p><div class="mediaobject"><img src="/graphics/9781788479837/graphics/796c4acd-92fb-4958-a9be-d72de19e2170.jpg" /></div><p>Preparing to save data for Dead Keys</p><p>Before <span>saving</span> data with <code class="literal">PlayerPrefs</code>, you should specify the title and company name for your project from the <strong class="userinput"><code>Project Settings</code></strong> window, as these settings determine how and where the <code class="literal">PlayerPrefs</code> data is stored on the user's computer. To access <strong class="userinput"><code>Project Settings</code></strong>, select <strong class="userinput"><code>Edit</code></strong> | <strong class="userinput"><code>Project Settings</code></strong> | <strong class="userinput"><code>Player</code></strong> from the application menu:</p><div class="mediaobject"><img src="/graphics/9781788479837/graphics/abaeed5b-43eb-44e1-a95c-dd18d41aaad6.png" /></div><p>Accessing Project Settings</p><p>Next, enter a <span>title</span> for the project, and a <strong class="userinput"><code>Company Name</code></strong>. Here, I've used <code class="literal">Dead Keys</code> as the <strong class="userinput"><code>Product Name</code></strong>, and <code class="literal">Packt Publishing</code> as the <strong class="userinput"><code>Company Name</code></strong>:</p><div class="mediaobject"><img src="/graphics/9781788479837/graphics/c675afde-8132-49d3-897b-67013b9356dc.png" /></div><p>Entering a Product Name and Company Name</p><p>The <code class="literal">PlayerPrefs</code> class can ultimately save three different kinds of data, namely, <span class="emphasis"><em>integers</em></span> (for example, high score), <span class="emphasis"><em>floating point</em></span> numbers (for example, volume and fastest time), and <span class="emphasis"><em>strings</em></span> (for example, player name); thereby, any data derived from these types (for example, a <span class="emphasis"><em>boolean</em></span> can be converted to a 1 and 0 integer). The class offers three static functions to save this data: <code class="literal">SetInt</code>, <code class="literal">SetFloat</code>, and <code class="literal">SetString</code> respectively. These can be called anywhere in your script files. Consider the following sample:</p><pre class="programlisting">PlayerPrefs.SetInt("PlayerScore", 999785); 
PlayerPrefs.SetFloat("RemainingTime", 5.5f); 
PlayerPrefs.SetString("PlayerName", "Jon Doe"); </pre><p>Each <code class="literal">Set</code> function accepts two <span>parameters,</span> forming a <span class="strong"><strong>key-value pair</strong></span>; the <span class="strong"><strong>user-defined name</strong></span> of the value to set (for example, <code class="literal">PlayerScore</code>, <code class="literal">RemainingTime</code>, and so on) and the <span>value</span> to save itself. The key should be unique for the application, and is used by the <code class="literal">Get</code><span>functions</span> to retrieve the specified value (discussed later).</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note50"></a>Note</h3><p>More information on the <code class="literal">PlayerPrefs</code> class can be found online at: <span><a class="ulink" href="https://docs.unity3d.com/ScriptReference/PlayerPrefs.html" target="_blank">https://docs.unity3d.com/ScriptReference/PlayerPrefs.html</a>.</span></p></div><p>One important <span>question</span> that arises regarding the <code class="literal">Set</code> functions for <code class="literal">PlayerPrefs</code> is about where on the user's computer the saved data is stored. This varies depending on the operating system. For Windows computers, all data is stored in the Windows Registry as separate keys. To access the Registry, access the Start menu, and run the <code class="literal">RegEdit</code> command. Next, the Windows <strong class="userinput"><code>Registry Editor</code></strong> appears, displaying all system keys and settings. Remember that editing or changing any keys in the registry can cause your computer and software to stop working properly, so be careful:</p><div class="mediaobject"><img src="/graphics/9781788479837/graphics/a9b2def3-30c5-4a15-8df2-b84ba2c176e1.png" /></div><p>Windows Registry Editor</p><p>You can find Unity application settings under the <code class="literal">HKCU</code><strong class="userinput"><code> </code></strong>| <code class="literal">Software</code><strong class="userinput"><code> </code></strong>| <code class="literal">[company name]</code> | <code class="literal">[product name]</code> key. The <strong class="userinput"><code>Company Name</code></strong> and <strong class="userinput"><code>Product Name</code></strong> fields should be substituted for the values specified in the <strong class="userinput"><code>Project Settings</code></strong>, as mentioned earlier. Here, all applications will save their values. These can be edited directly from the <strong class="userinput"><code>Registry Editor</code></strong>, but this is not recommended. Nevertheless, knowing how to find and access the settings can be useful for verifying and debugging your application, ensuring that the right values are being saved.</p><p>On a Mac computer, all settings can be accessed from <span>Mac</span> Finder by navigating to <code class="literal">Library/Preferences/ unity.[company name].[product name].plist</code>:</p><div class="mediaobject"><img src="/graphics/9781788479837/graphics/65d122fd-2af3-4ae8-a325-51c5e930d1df.png" /></div><p>Accessing plist files</p><p>The Unity setting files contain all preferences in a human-readable, text-based XML format. Like the registry settings, this file can be edited, but this is not recommended:</p><div class="mediaobject"><img src="/graphics/9781788479837/graphics/f33e45f3-a57f-4973-9244-18cbcdbd8743.png" /></div><p>Viewing plist files generated by PlayerPrefs</p><p>For other platforms, such as web and mobile, the storage location for <code class="literal">PlayerPrefs</code> varies widely. Further information on platform specifics can be <span>found</span> online at <a class="ulink" href="https://docs.unity3d.com/ScriptReference/PlayerPrefs.html" target="_blank"><span>https://docs.unity3d.com/ScriptReference/PlayerPrefs.html</span></a>.</p><p>The <code class="literal">PlayerPrefs</code> Set functions (<code class="literal">SetInt</code>, <code class="literal">SetFloat</code>, and <code class="literal">SetString</code>) are buffered, that is, the data is not actually committed to the computer until the application terminates. However, if you need the changes committed earlier than application exit, or to protect against a crash or failure, you should additionally call the <code class="literal">Save</code> function once after having called all the Set functions. The <code class="literal">Save</code> function requires no arguments and returns no value; it simply commits all the set changes. More information on save can be <span>found</span> online at: <a class="ulink" href="https://docs.unity3d.com/ScriptReference/PlayerPrefs.Save.html" target="_blank"><span>https://docs.unity3d.com/ScriptReference/PlayerPrefs.Save.html</span></a>.</p></div>