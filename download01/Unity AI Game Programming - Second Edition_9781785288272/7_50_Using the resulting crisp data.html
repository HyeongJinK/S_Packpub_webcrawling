<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch07lvl1sec50"></a>Using the resulting crisp data</h2></div></div><hr /></div><p>The data output from a <a id="id311" class="indexterm"></a>fuzzy controller can then be plugged into a behavior tree or a finite state machine. Of course, we can also combine multiple controllers' output to make decisions. In fact, we can take a whole bunch of them to achieve the most realistic or interesting result (as convincing as a magic-using wizard can be, anyway). The following figure illustrates a potential set of fuzzy logic controllers it can use to determine whether or not to cast the heal spell:</p><div class="mediaobject"><img src="/graphics/9781785288272/graphics/B04204_07_10.jpg" /></div><p>We've looked at the health question already, but what about the rest? We have another set of questions that really don't mean much to our agent on their own:</p><p>Do you have enough mana? Well, you can have a little bit of mana, some mana, or a lot of mana. It would not be uncommon for a human player to ask this question as they choose to cast a magic spell in a game or use an ability. "Enough" may literally be a binary amount, but more likely, it would be "enough to cast heal, and have some left for other spells". We start with a straightforward crisp value—the amount of mana the agent has available that we then stick to our fuzzy logic controller and get some crisp data at the other end.</p><p>What about the enemy's strength? He could be weak, average, strong, or unbeatable. You can get creative with the input for your fuzzy logic controllers. You could, for example, just take a raw "strength" value from your enemy, but you could also take the difference between your "defensive" stat and the enemy's "attack power", and plug that into your fuzzy logic controller. Remember, there is no restriction on how you process the data before it goes into the controller.</p><p>Are my allies close? As we saw in <a class="link" href="#" linkend="ch02">Chapter 2</a>, <span class="emphasis"><em>Finite State Machines and You</em></span>, a simple distance check can do wonders for a simple design, but at times, you may need more than just that. You may need to take into account obstacles along the way—is that an ally behind a locked gate, making him unable to reach the agent? These types of questions could even be a nested set of statements that we need to evaluate.</p><p>Now, if we were to <a id="id312" class="indexterm"></a>take that last question with the nested controllers, it might start to look a little familiar.</p><div class="mediaobject"><img src="/graphics/9781785288272/graphics/B04204_07_11.jpg" /></div><p>The preceding figure is quite tree-like, isn't it? Sure enough, there is no reason why you couldn't build a behavior tree using fuzzy logic to evaluate each node. We end up with a very flexible, powerful, and nuanced AI system by combining these two concepts.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec62"></a>Using a simpler approach</h3></div></div></div><p>If you choose to <a id="id313" class="indexterm"></a>stick with a simple evaluation of the crisp output, in other words, not specifically a tree or an FSM, you can use more Boolean operators to decide what your agent is going to do. The pseudo code would look like this:</p><div class="informalexample"><pre class="programlisting">IF health IS critical AND mana IS plenty THEN cast heal</pre></div><p>We can check for conditions that are not true:</p><div class="informalexample"><pre class="programlisting">IF health IS critical AND allies ARE NOT close THEN cast heal</pre></div><p>And we can also string multiple conditions together:</p><div class="informalexample"><pre class="programlisting">IF health IS critical AND mana IS NOT depleted AND enemy IS very strong THEN cast heal</pre></div><p>By looking at these simplified statements, you have noticed yet another "happy bonus" of using fuzzy logic—the crisp output abstracts much of the decision-making conditionals and combines them into simplified data.</p><p>Rather than having to <a id="id314" class="indexterm"></a>parse through all the possibilities in your <code class="literal">if/else</code> statements and ending up with a bazillion of them or a gazillion switch statements, you can neatly bundle pockets of logic into fewer, more meaningful chunks of data.</p><p>In other words, you don't have to nest all the statements in a procedural way that is hard to read and difficult to reuse. As a design pattern, abstracting data via a fuzzy logic controller ends up being much more object-oriented and friendlier.</p></div></div>