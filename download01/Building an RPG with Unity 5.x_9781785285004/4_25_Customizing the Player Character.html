<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch04lvl1sec27"></a>Customizing the Player Character</h2></div></div><hr /></div><p>One of the key features of an RPG is to be able to customize your character player. In this section we will take a look at how we can provide a means to achieve this.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note29"></a>Note</h3><p>Once again, the approach and concept are universal, but the actual implementation might be a little different based on your model structure.</p></div><p>Create a new scene and name it <code class="literal">CharacterCustomization</code>. Create a <code class="literal">Cube</code> prefab and set it to the origin. Change the <code class="literal">Scale</code> of the cube to <code class="literal">&lt;5, 0.1, 5&gt;</code>, you can also change the name of the GameObject to <code class="literal">Base</code>. This will be the platform that our character model stands on while the player customizes his/her character before game play.</p><p>Drag and drop the <code class="literal">fbx</code> file representing your character model into the <code class="literal">Scene View</code>. The next few steps will entirely depend on your model hierarchy and structure as designed by the modeler.</p><p>To illustrate the point, I have placed the same model in the scene twice. The one on the left is the model that has been configured to display only the basics, the model on the right is the model in its original state as shown in the following screenshot:</p><p>
</p><div class="mediaobject"><img src="/graphics/9781785285004/graphics/image_04_001.jpg" /></div><p>
</p><p>Notice that this particular model I am using has everything attached. These include the different types of weapons, shoes, helmets, and armour. The instantiated prefab on the left hand side has turned off all of the extras from the GameObject's hierarchy. Here is how the hierarchy looks in the <code class="literal">Hierarchy View</code>:</p><p>
</p><div class="mediaobject"><img src="/graphics/9781785285004/graphics/image_04_002.jpg" /></div><p>
</p><p>The model has a very extensive hierarchy in its structure, the preceding screenshot is a small snippet to demonstrate that you will need to navigate the structure and manually identify and enable or disable the mesh representing a particular part of the model.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec29"></a>Customizable parts</h3></div></div></div><p>Based on my model, I can customize a few things on my 3D model. I can customize the shoulder pads, I can customize the body type, I can customize the weapons and armor it has, I can customize the helmet and shoes, and finally I can also customize the skin texture to give it different looks.</p><p>Let's get a listing of all the different customizable items we have for our character:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>
<span class="strong"><strong>Shoulder Shields:</strong></span> there are four types</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Body Type:</strong></span> there are three body types; skinny, buff, and chubby</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Armor:</strong></span> knee pad, leg plate</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Shields:</strong></span> there are two types of shields</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Boots:</strong></span> there are two types of boots</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Helmet:</strong></span> there are four types of helmets</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Weapons:</strong></span> there are 13 different types of weapons</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Skins:</strong></span> there are 13 different types of skins</p></li></ul></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch04lvl3sec9"></a>User interface</h4></div></div></div><p>Now that we know what our options are for customizing our player character, we can start thinking about the User Interface (UI) that will be used to enable the customization of the character.</p><p>To design our UI, we will need to create a <code class="literal">Canvas</code> GameObject, this is done by right-clicking in the <span class="strong"><strong>Hierarchy View</strong></span> and selecting <span class="strong"><strong>Create|UI|Canvas</strong></span>. This will place a <code class="literal">Canvas</code> GameObject and an <code class="literal">EventSystem</code> GameObject in the <code class="literal">Hierarchy View</code>.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note30"></a>Note</h3><p>It is assumed that you already know how to create a UI in Unity. If you do not, please refer to <span class="emphasis"><em>Chapter 5, Introduction to Game Programming: Using C# and Unity 3D</em></span>.</p></div><p>I am going to use a Panel to group the customizable items. For the moment I will be using checkboxes for some items and scroll bars for the weapons and skin texture. The following screenshot will illustrate how my UI for customization looks:</p><p>
</p><div class="mediaobject"><img src="/graphics/9781785285004/graphics/image_04_003.jpg" /></div><p>
</p><p>These UI elements will need to be integrated with Event Handlers that will perform the necessary actions for enabling or disabling certain parts of the character model.</p><p>For instance, using the UI I can select Shoulder Pad 4, Buff Body Type, move the scroll bar until the Hammer weapon shows up, selecting the second Helmet checkbox, selecting Shield 1 and Boot 2, my character will look like the following screenshot:</p><p>We need a way to refer to each one of the meshes representing the different types of customizable objects on the model. This will be done through a C# script. The script will need to keep track of all the parts we are going to be managing for customization.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note31"></a>Note</h3><p>Some models will not have the extra meshes attached. You can always create empty GameObjects at a particular location on the model, and you can dynamically instantiate the prefab representing your custom object at the given point. This can also be done for our current model, for instance, if we have a special space weapon that somehow gets dropped by the aliens in the game world, we can attach the weapon to our model through C# code. The important thing is to understand the concept, and the rest is up to you!</p></div><p>
</p><div class="mediaobject"><img src="/graphics/9781785285004/graphics/image_04_004.jpg" /></div><p>
</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch04lvl3sec10"></a>The Code for character customization</h4></div></div></div><p>Things don't happen automatically. So we need to create some C# code that will handle the customization of our character model. The script we create here will handle the UI events that will drive the enabling and disabling of different parts of the model mesh.</p><p>Create a new C# script and call it <code class="literal">CharacterCustomization.cs</code>. This script will be attached to the <code class="literal">Base</code> GameObject in the scene. Here is a listing of the script:</p><pre class="programlisting">using UnityEngine; &#13;
using UnityEngine.UI; &#13;
using System.Collections; &#13;
using UnityEngine.SceneManagement; &#13;
 &#13;
public class CharacterCustomization : MonoBehaviour &#13;
{ &#13;
 &#13;
   public GameObject PLAYER_CHARACTER; &#13;
 &#13;
   public Material[] PLAYER_SKIN; &#13;
 &#13;
   public GameObject CLOTH_01LOD0; &#13;
   public GameObject CLOTH_01LOD0_SKIN; &#13;
   public GameObject CLOTH_02LOD0; &#13;
   public GameObject CLOTH_02LOD0_SKIN; &#13;
   public GameObject CLOTH_03LOD0; &#13;
   public GameObject CLOTH_03LOD0_SKIN; &#13;
   public GameObject CLOTH_03LOD0_FAT; &#13;
 &#13;
   public GameObject BELT_LOD0; &#13;
 &#13;
   public GameObject SKN_LOD0; &#13;
   public GameObject FAT_LOD0; &#13;
   public GameObject RGL_LOD0; &#13;
 &#13;
   public GameObject HAIR_LOD0; &#13;
 &#13;
   public GameObject BOW_LOD0; &#13;
 &#13;
   // Head Equipment &#13;
   public GameObject GLADIATOR_01LOD0; &#13;
   public GameObject HELMET_01LOD0; &#13;
   public GameObject HELMET_02LOD0; &#13;
   public GameObject HELMET_03LOD0; &#13;
   public GameObject HELMET_04LOD0; &#13;
 &#13;
   // Shoulder Pad - Right Arm / Left Arm &#13;
   public GameObject SHOULDER_PAD_R_01LOD0; &#13;
   public GameObject SHOULDER_PAD_R_02LOD0; &#13;
   public GameObject SHOULDER_PAD_R_03LOD0; &#13;
   public GameObject SHOULDER_PAD_R_04LOD0; &#13;
 &#13;
   public GameObject SHOULDER_PAD_L_01LOD0; &#13;
   public GameObject SHOULDER_PAD_L_02LOD0; &#13;
   public GameObject SHOULDER_PAD_L_03LOD0; &#13;
   public GameObject SHOULDER_PAD_L_04LOD0; &#13;
 &#13;
   // Fore Arm - Right / Left Plates &#13;
   public GameObject ARM_PLATE_R_1LOD0; &#13;
   public GameObject ARM_PLATE_R_2LOD0; &#13;
 &#13;
   public GameObject ARM_PLATE_L_1LOD0; &#13;
   public GameObject ARM_PLATE_L_2LOD0; &#13;
 &#13;
   // Player Character Weapons &#13;
   public GameObject AXE_01LOD0; &#13;
   public GameObject AXE_02LOD0; &#13;
   public GameObject CLUB_01LOD0; &#13;
   public GameObject CLUB_02LOD0; &#13;
   public GameObject FALCHION_LOD0; &#13;
   public GameObject GLADIUS_LOD0; &#13;
   public GameObject MACE_LOD0; &#13;
   public GameObject MAUL_LOD0; &#13;
   public GameObject SCIMITAR_LOD0; &#13;
   public GameObject SPEAR_LOD0; &#13;
   public GameObject SWORD_BASTARD_LOD0; &#13;
   public GameObject SWORD_BOARD_01LOD0; &#13;
   public GameObject SWORD_SHORT_LOD0; &#13;
 &#13;
   // Player Character Defense Weapons &#13;
   public GameObject SHIELD_01LOD0; &#13;
   public GameObject SHIELD_02LOD0; &#13;
 &#13;
   public GameObject QUIVER_LOD0; &#13;
   public GameObject BOW_01_LOD0; &#13;
 &#13;
   // Player Character Calf - Right / Left &#13;
   public GameObject KNEE_PAD_R_LOD0; &#13;
   public GameObject LEG_PLATE_R_LOD0; &#13;
 &#13;
   public GameObject KNEE_PAD_L_LOD0; &#13;
   public GameObject LEG_PLATE_L_LOD0; &#13;
 &#13;
   public GameObject BOOT_01LOD0; &#13;
   public GameObject BOOT_02LOD0; &#13;
 &#13;
   // Use this for initialization &#13;
   void Start() &#13;
   { &#13;
 &#13;
   } &#13;
 &#13;
   public bool ROTATE_MODEL = false; &#13;
   // Update is called once per frame &#13;
   void Update() &#13;
   { &#13;
      if (Input.GetKeyUp(KeyCode.R)) &#13;
      { &#13;
         this.ROTATE_MODEL = !this.ROTATE_MODEL; &#13;
      } &#13;
 &#13;
      if (this.ROTATE_MODEL) &#13;
      { &#13;
         this.PLAYER_CHARACTER.transform.Rotate(new Vector3(0, 1, 0), 33.0f * Time.deltaTime); &#13;
      } &#13;
 &#13;
      if (Input.GetKeyUp(KeyCode.L)) &#13;
      { &#13;
 &#13;
         Debug.Log(PlayerPrefs.GetString("NAME")); &#13;
      } &#13;
 &#13;
   } &#13;
 &#13;
 &#13;
   public void SetShoulderPad(Toggle id) &#13;
   { &#13;
      switch (id.name) &#13;
      { &#13;
         case "SP-01": &#13;
            { &#13;
               this.SHOULDER_PAD_R_01LOD0.SetActive(id.isOn); &#13;
               this.SHOULDER_PAD_R_02LOD0.SetActive(false); &#13;
               this.SHOULDER_PAD_R_03LOD0.SetActive(false); &#13;
               this.SHOULDER_PAD_R_04LOD0.SetActive(false); &#13;
 &#13;
               this.SHOULDER_PAD_L_01LOD0.SetActive(id.isOn); &#13;
               this.SHOULDER_PAD_L_02LOD0.SetActive(false); &#13;
               this.SHOULDER_PAD_L_03LOD0.SetActive(false); &#13;
               this.SHOULDER_PAD_L_04LOD0.SetActive(false); &#13;
 &#13;
               PlayerPrefs.SetInt("SP-01", 1); &#13;
               PlayerPrefs.SetInt("SP-02", 0); &#13;
               PlayerPrefs.SetInt("SP-03", 0); &#13;
               PlayerPrefs.SetInt("SP-04", 0); &#13;
               break; &#13;
            } &#13;
         case "SP-02": &#13;
            { &#13;
               this.SHOULDER_PAD_R_01LOD0.SetActive(false); &#13;
               this.SHOULDER_PAD_R_02LOD0.SetActive(id.isOn); &#13;
               this.SHOULDER_PAD_R_03LOD0.SetActive(false); &#13;
               this.SHOULDER_PAD_R_04LOD0.SetActive(false); &#13;
 &#13;
               this.SHOULDER_PAD_L_01LOD0.SetActive(false); &#13;
               this.SHOULDER_PAD_L_02LOD0.SetActive(id.isOn); &#13;
               this.SHOULDER_PAD_L_03LOD0.SetActive(false); &#13;
               this.SHOULDER_PAD_L_04LOD0.SetActive(false); &#13;
 &#13;
               PlayerPrefs.SetInt("SP-01", 0); &#13;
               PlayerPrefs.SetInt("SP-02", 1); &#13;
               PlayerPrefs.SetInt("SP-03", 0); &#13;
               PlayerPrefs.SetInt("SP-04", 0); &#13;
               break; &#13;
            } &#13;
         case "SP-03": &#13;
            { &#13;
               this.SHOULDER_PAD_R_01LOD0.SetActive(false); &#13;
               this.SHOULDER_PAD_R_02LOD0.SetActive(false); &#13;
               this.SHOULDER_PAD_R_03LOD0.SetActive(id.isOn); &#13;
               this.SHOULDER_PAD_R_04LOD0.SetActive(false); &#13;
 &#13;
               this.SHOULDER_PAD_L_01LOD0.SetActive(false); &#13;
               this.SHOULDER_PAD_L_02LOD0.SetActive(false); &#13;
               this.SHOULDER_PAD_L_03LOD0.SetActive(id.isOn); &#13;
               this.SHOULDER_PAD_L_04LOD0.SetActive(false); &#13;
 &#13;
               PlayerPrefs.SetInt("SP-01", 0); &#13;
               PlayerPrefs.SetInt("SP-02", 0); &#13;
               PlayerPrefs.SetInt("SP-03", 1); &#13;
               PlayerPrefs.SetInt("SP-04", 0); &#13;
               break; &#13;
            } &#13;
         case "SP-04": &#13;
            { &#13;
               this.SHOULDER_PAD_R_01LOD0.SetActive(false); &#13;
               this.SHOULDER_PAD_R_02LOD0.SetActive(false); &#13;
               this.SHOULDER_PAD_R_03LOD0.SetActive(false); &#13;
               this.SHOULDER_PAD_R_04LOD0.SetActive(id.isOn); &#13;
 &#13;
               this.SHOULDER_PAD_L_01LOD0.SetActive(false); &#13;
               this.SHOULDER_PAD_L_02LOD0.SetActive(false); &#13;
               this.SHOULDER_PAD_L_03LOD0.SetActive(false); &#13;
               this.SHOULDER_PAD_L_04LOD0.SetActive(id.isOn); &#13;
 &#13;
               PlayerPrefs.SetInt("SP-01", 0); &#13;
               PlayerPrefs.SetInt("SP-02", 0); &#13;
               PlayerPrefs.SetInt("SP-03", 0); &#13;
               PlayerPrefs.SetInt("SP-04", 1); &#13;
 &#13;
               break; &#13;
            } &#13;
      } &#13;
   } &#13;
 &#13;
   public void SetBodyType(Toggle id) &#13;
   { &#13;
      switch (id.name) &#13;
      { &#13;
         case "BT-01": &#13;
            { &#13;
               this.RGL_LOD0.SetActive(id.isOn); &#13;
               this.FAT_LOD0.SetActive(false); &#13;
               break; &#13;
            } &#13;
         case "BT-02": &#13;
            { &#13;
               this.RGL_LOD0.SetActive(false); &#13;
               this.FAT_LOD0.SetActive(id.isOn); &#13;
               break; &#13;
            } &#13;
      } &#13;
   } &#13;
 &#13;
   public void SetKneePad(Toggle id) &#13;
   { &#13;
      this.KNEE_PAD_R_LOD0.SetActive(id.isOn); &#13;
      this.KNEE_PAD_L_LOD0.SetActive(id.isOn); &#13;
   } &#13;
 &#13;
   public void SetLegPlate(Toggle id) &#13;
   { &#13;
      this.LEG_PLATE_R_LOD0.SetActive(id.isOn); &#13;
      this.LEG_PLATE_L_LOD0.SetActive(id.isOn); &#13;
   } &#13;
 &#13;
   public void SetWeaponType(Slider id) &#13;
   { &#13;
      switch (System.Convert.ToInt32(id.value)) &#13;
      { &#13;
         case 0: &#13;
            { &#13;
               this.AXE_01LOD0.SetActive(false); &#13;
               this.AXE_02LOD0.SetActive(false); &#13;
               this.CLUB_01LOD0.SetActive(false); &#13;
               this.CLUB_02LOD0.SetActive(false); &#13;
               this.FALCHION_LOD0.SetActive(false); &#13;
               this.GLADIUS_LOD0.SetActive(false); &#13;
               this.MACE_LOD0.SetActive(false); &#13;
               this.MAUL_LOD0.SetActive(false); &#13;
               this.SCIMITAR_LOD0.SetActive(false); &#13;
               this.SPEAR_LOD0.SetActive(false); &#13;
               this.SWORD_BASTARD_LOD0.SetActive(false); &#13;
               this.SWORD_BOARD_01LOD0.SetActive(false); &#13;
               this.SWORD_SHORT_LOD0.SetActive(false); &#13;
               break; &#13;
            } &#13;
         case 1: &#13;
            { &#13;
               this.AXE_01LOD0.SetActive(true); &#13;
               this.AXE_02LOD0.SetActive(false); &#13;
               this.CLUB_01LOD0.SetActive(false); &#13;
               this.CLUB_02LOD0.SetActive(false); &#13;
               this.FALCHION_LOD0.SetActive(false); &#13;
               this.GLADIUS_LOD0.SetActive(false); &#13;
               this.MACE_LOD0.SetActive(false); &#13;
               this.MAUL_LOD0.SetActive(false); &#13;
               this.SCIMITAR_LOD0.SetActive(false); &#13;
               this.SPEAR_LOD0.SetActive(false); &#13;
               this.SWORD_BASTARD_LOD0.SetActive(false); &#13;
               this.SWORD_BOARD_01LOD0.SetActive(false); &#13;
               this.SWORD_SHORT_LOD0.SetActive(false); &#13;
               break; &#13;
            } &#13;
         case 2: &#13;
            { &#13;
               this.AXE_01LOD0.SetActive(false); &#13;
               this.AXE_02LOD0.SetActive(true); &#13;
               this.CLUB_01LOD0.SetActive(false); &#13;
               this.CLUB_02LOD0.SetActive(false); &#13;
               this.FALCHION_LOD0.SetActive(false); &#13;
               this.GLADIUS_LOD0.SetActive(false); &#13;
               this.MACE_LOD0.SetActive(false); &#13;
               this.MAUL_LOD0.SetActive(false); &#13;
               this.SCIMITAR_LOD0.SetActive(false); &#13;
               this.SPEAR_LOD0.SetActive(false); &#13;
               this.SWORD_BASTARD_LOD0.SetActive(false); &#13;
               this.SWORD_BOARD_01LOD0.SetActive(false); &#13;
               this.SWORD_SHORT_LOD0.SetActive(false); &#13;
               break; &#13;
            } &#13;
         case 3: &#13;
            { &#13;
               this.AXE_01LOD0.SetActive(false); &#13;
               this.AXE_02LOD0.SetActive(false); &#13;
               this.CLUB_01LOD0.SetActive(true); &#13;
               this.CLUB_02LOD0.SetActive(false); &#13;
               this.FALCHION_LOD0.SetActive(false); &#13;
               this.GLADIUS_LOD0.SetActive(false); &#13;
               this.MACE_LOD0.SetActive(false); &#13;
               this.MAUL_LOD0.SetActive(false); &#13;
               this.SCIMITAR_LOD0.SetActive(false); &#13;
               this.SPEAR_LOD0.SetActive(false); &#13;
               this.SWORD_BASTARD_LOD0.SetActive(false); &#13;
               this.SWORD_BOARD_01LOD0.SetActive(false); &#13;
               this.SWORD_SHORT_LOD0.SetActive(false); &#13;
               break; &#13;
            } &#13;
         case 4: &#13;
            { &#13;
               this.AXE_01LOD0.SetActive(false); &#13;
               this.AXE_02LOD0.SetActive(false); &#13;
               this.CLUB_01LOD0.SetActive(false); &#13;
               this.CLUB_02LOD0.SetActive(true); &#13;
               this.FALCHION_LOD0.SetActive(false); &#13;
               this.GLADIUS_LOD0.SetActive(false); &#13;
               this.MACE_LOD0.SetActive(false); &#13;
               this.MAUL_LOD0.SetActive(false); &#13;
               this.SCIMITAR_LOD0.SetActive(false); &#13;
               this.SPEAR_LOD0.SetActive(false); &#13;
               this.SWORD_BASTARD_LOD0.SetActive(false); &#13;
               this.SWORD_BOARD_01LOD0.SetActive(false); &#13;
               this.SWORD_SHORT_LOD0.SetActive(false); &#13;
               break; &#13;
            } &#13;
         case 5: &#13;
            { &#13;
               this.AXE_01LOD0.SetActive(false); &#13;
               this.AXE_02LOD0.SetActive(false); &#13;
               this.CLUB_01LOD0.SetActive(false); &#13;
               this.CLUB_02LOD0.SetActive(false); &#13;
               this.FALCHION_LOD0.SetActive(true); &#13;
               this.GLADIUS_LOD0.SetActive(false); &#13;
               this.MACE_LOD0.SetActive(false); &#13;
               this.MAUL_LOD0.SetActive(false); &#13;
               this.SCIMITAR_LOD0.SetActive(false); &#13;
               this.SPEAR_LOD0.SetActive(false); &#13;
               this.SWORD_BASTARD_LOD0.SetActive(false); &#13;
               this.SWORD_BOARD_01LOD0.SetActive(false); &#13;
               this.SWORD_SHORT_LOD0.SetActive(false); &#13;
               break; &#13;
            } &#13;
         case 6: &#13;
            { &#13;
               this.AXE_01LOD0.SetActive(false); &#13;
               this.AXE_02LOD0.SetActive(false); &#13;
               this.CLUB_01LOD0.SetActive(false); &#13;
               this.CLUB_02LOD0.SetActive(false); &#13;
               this.FALCHION_LOD0.SetActive(false); &#13;
               this.GLADIUS_LOD0.SetActive(true); &#13;
               this.MACE_LOD0.SetActive(false); &#13;
               this.MAUL_LOD0.SetActive(false); &#13;
               this.SCIMITAR_LOD0.SetActive(false); &#13;
               this.SPEAR_LOD0.SetActive(false); &#13;
               this.SWORD_BASTARD_LOD0.SetActive(false); &#13;
               this.SWORD_BOARD_01LOD0.SetActive(false); &#13;
               this.SWORD_SHORT_LOD0.SetActive(false); &#13;
               break; &#13;
            } &#13;
         case 7: &#13;
            { &#13;
               this.AXE_01LOD0.SetActive(false); &#13;
               this.AXE_02LOD0.SetActive(false); &#13;
               this.CLUB_01LOD0.SetActive(false); &#13;
               this.CLUB_02LOD0.SetActive(false); &#13;
               this.FALCHION_LOD0.SetActive(false); &#13;
               this.GLADIUS_LOD0.SetActive(false); &#13;
               this.MACE_LOD0.SetActive(true); &#13;
               this.MAUL_LOD0.SetActive(false); &#13;
               this.SCIMITAR_LOD0.SetActive(false); &#13;
               this.SPEAR_LOD0.SetActive(false); &#13;
               this.SWORD_BASTARD_LOD0.SetActive(false); &#13;
               this.SWORD_BOARD_01LOD0.SetActive(false); &#13;
               this.SWORD_SHORT_LOD0.SetActive(false); &#13;
               break; &#13;
            } &#13;
         case 8: &#13;
            { &#13;
               this.AXE_01LOD0.SetActive(false); &#13;
               this.AXE_02LOD0.SetActive(false); &#13;
               this.CLUB_01LOD0.SetActive(false); &#13;
               this.CLUB_02LOD0.SetActive(false); &#13;
               this.FALCHION_LOD0.SetActive(false); &#13;
               this.GLADIUS_LOD0.SetActive(false); &#13;
               this.MACE_LOD0.SetActive(false); &#13;
               this.MAUL_LOD0.SetActive(true); &#13;
               this.SCIMITAR_LOD0.SetActive(false); &#13;
               this.SPEAR_LOD0.SetActive(false); &#13;
               this.SWORD_BASTARD_LOD0.SetActive(false); &#13;
               this.SWORD_BOARD_01LOD0.SetActive(false); &#13;
               this.SWORD_SHORT_LOD0.SetActive(false); &#13;
               break; &#13;
            } &#13;
         case 9: &#13;
            { &#13;
               this.AXE_01LOD0.SetActive(false); &#13;
               this.AXE_02LOD0.SetActive(false); &#13;
               this.CLUB_01LOD0.SetActive(false); &#13;
               this.CLUB_02LOD0.SetActive(false); &#13;
               this.FALCHION_LOD0.SetActive(false); &#13;
               this.GLADIUS_LOD0.SetActive(false); &#13;
               this.MACE_LOD0.SetActive(false); &#13;
               this.MAUL_LOD0.SetActive(false); &#13;
               this.SCIMITAR_LOD0.SetActive(true); &#13;
               this.SPEAR_LOD0.SetActive(false); &#13;
               this.SWORD_BASTARD_LOD0.SetActive(false); &#13;
               this.SWORD_BOARD_01LOD0.SetActive(false); &#13;
               this.SWORD_SHORT_LOD0.SetActive(false); &#13;
               break; &#13;
            } &#13;
         case 10: &#13;
            { &#13;
               this.AXE_01LOD0.SetActive(false); &#13;
               this.AXE_02LOD0.SetActive(false); &#13;
               this.CLUB_01LOD0.SetActive(false); &#13;
               this.CLUB_02LOD0.SetActive(false); &#13;
               this.FALCHION_LOD0.SetActive(false); &#13;
               this.GLADIUS_LOD0.SetActive(false); &#13;
               this.MACE_LOD0.SetActive(false); &#13;
               this.MAUL_LOD0.SetActive(false); &#13;
               this.SCIMITAR_LOD0.SetActive(false); &#13;
               this.SPEAR_LOD0.SetActive(true); &#13;
               this.SWORD_BASTARD_LOD0.SetActive(false); &#13;
               this.SWORD_BOARD_01LOD0.SetActive(false); &#13;
               this.SWORD_SHORT_LOD0.SetActive(false); &#13;
               break; &#13;
            } &#13;
         case 11: &#13;
            { &#13;
               this.AXE_01LOD0.SetActive(false); &#13;
               this.AXE_02LOD0.SetActive(false); &#13;
               this.CLUB_01LOD0.SetActive(false); &#13;
               this.CLUB_02LOD0.SetActive(false); &#13;
               this.FALCHION_LOD0.SetActive(false); &#13;
               this.GLADIUS_LOD0.SetActive(false); &#13;
               this.MACE_LOD0.SetActive(false); &#13;
               this.MAUL_LOD0.SetActive(false); &#13;
               this.SCIMITAR_LOD0.SetActive(false); &#13;
               this.SPEAR_LOD0.SetActive(false); &#13;
               this.SWORD_BASTARD_LOD0.SetActive(true); &#13;
               this.SWORD_BOARD_01LOD0.SetActive(false); &#13;
               this.SWORD_SHORT_LOD0.SetActive(false); &#13;
               break; &#13;
            } &#13;
         case 12: &#13;
            { &#13;
               this.AXE_01LOD0.SetActive(false); &#13;
               this.AXE_02LOD0.SetActive(false); &#13;
               this.CLUB_01LOD0.SetActive(false); &#13;
               this.CLUB_02LOD0.SetActive(false); &#13;
               this.FALCHION_LOD0.SetActive(false); &#13;
               this.GLADIUS_LOD0.SetActive(false); &#13;
               this.MACE_LOD0.SetActive(false); &#13;
               this.MAUL_LOD0.SetActive(false); &#13;
               this.SCIMITAR_LOD0.SetActive(false); &#13;
               this.SPEAR_LOD0.SetActive(false); &#13;
               this.SWORD_BASTARD_LOD0.SetActive(false); &#13;
               this.SWORD_BOARD_01LOD0.SetActive(true); &#13;
               this.SWORD_SHORT_LOD0.SetActive(false); &#13;
               break; &#13;
            } &#13;
         case 13: &#13;
            { &#13;
               this.AXE_01LOD0.SetActive(false); &#13;
               this.AXE_02LOD0.SetActive(false); &#13;
               this.CLUB_01LOD0.SetActive(false); &#13;
               this.CLUB_02LOD0.SetActive(false); &#13;
               this.FALCHION_LOD0.SetActive(false); &#13;
               this.GLADIUS_LOD0.SetActive(false); &#13;
               this.MACE_LOD0.SetActive(false); &#13;
               this.MAUL_LOD0.SetActive(false); &#13;
               this.SCIMITAR_LOD0.SetActive(false); &#13;
               this.SPEAR_LOD0.SetActive(false); &#13;
               this.SWORD_BASTARD_LOD0.SetActive(false); &#13;
               this.SWORD_BOARD_01LOD0.SetActive(false); &#13;
               this.SWORD_SHORT_LOD0.SetActive(true); &#13;
               break; &#13;
            } &#13;
 &#13;
      } &#13;
   } &#13;
 &#13;
   public void SetHelmetType(Toggle id) &#13;
   { &#13;
      switch (id.name) &#13;
      { &#13;
         case "HL-01": &#13;
            { &#13;
               this.HELMET_01LOD0.SetActive(id.isOn); &#13;
               this.HELMET_02LOD0.SetActive(false); &#13;
               this.HELMET_03LOD0.SetActive(false); &#13;
               this.HELMET_04LOD0.SetActive(false); &#13;
               break; &#13;
            } &#13;
         case "HL-02": &#13;
            { &#13;
               this.HELMET_01LOD0.SetActive(false); &#13;
               this.HELMET_02LOD0.SetActive(id.isOn); &#13;
               this.HELMET_03LOD0.SetActive(false); &#13;
               this.HELMET_04LOD0.SetActive(false); &#13;
               break; &#13;
            } &#13;
         case "HL-03": &#13;
            { &#13;
               this.HELMET_01LOD0.SetActive(false); &#13;
               this.HELMET_02LOD0.SetActive(false); &#13;
               this.HELMET_03LOD0.SetActive(id.isOn); &#13;
               this.HELMET_04LOD0.SetActive(false); &#13;
               break; &#13;
            } &#13;
         case "HL-04": &#13;
            { &#13;
               this.HELMET_01LOD0.SetActive(false); &#13;
               this.HELMET_02LOD0.SetActive(false); &#13;
               this.HELMET_03LOD0.SetActive(false); &#13;
               this.HELMET_04LOD0.SetActive(id.isOn); &#13;
               break; &#13;
            } &#13;
      } &#13;
   } &#13;
 &#13;
   public void SetShieldType(Toggle id) &#13;
   { &#13;
      switch (id.name) &#13;
      { &#13;
         case "SL-01": &#13;
            { &#13;
               this.SHIELD_01LOD0.SetActive(id.isOn); &#13;
               this.SHIELD_02LOD0.SetActive(false); &#13;
               break; &#13;
            } &#13;
         case "SL-02": &#13;
            { &#13;
               this.SHIELD_01LOD0.SetActive(false); &#13;
               this.SHIELD_02LOD0.SetActive(id.isOn); &#13;
               break; &#13;
            } &#13;
      } &#13;
   } &#13;
 &#13;
   public void SetSkinType(Slider id) &#13;
   { &#13;
      this.SKN_LOD0.GetComponent&lt;Renderer&gt;().material = this.PLAYER_SKIN[System.Convert.ToInt32(id.value)]; &#13;
      this.FAT_LOD0.GetComponent&lt;Renderer&gt;().material = this.PLAYER_SKIN[System.Convert.ToInt32(id.value)]; &#13;
      this.RGL_LOD0.GetComponent&lt;Renderer&gt;().material = this.PLAYER_SKIN[System.Convert.ToInt32(id.value)]; &#13;
   } &#13;
 &#13;
   public void SetBootType(Toggle id) &#13;
   { &#13;
      switch (id.name) &#13;
      { &#13;
         case "BT-01": &#13;
            { &#13;
               this.BOOT_01LOD0.SetActive(id.isOn); &#13;
               this.BOOT_02LOD0.SetActive(false); &#13;
               break; &#13;
            } &#13;
         case "BT-02": &#13;
            { &#13;
               this.BOOT_01LOD0.SetActive(false); &#13;
               this.BOOT_02LOD0.SetActive(id.isOn); &#13;
               break; &#13;
            } &#13;
      } &#13;
   } &#13;
} &#13;
</pre><p>This is a long script but it is straightforward. At the top of the script we have defined all of the variables that will be referencing the different meshes in our model character. All variables are of type GameObject with the exception of the <code class="literal">PLAYER_SKIN</code> variable which is an array of <code class="literal">Material </code>data type. The array is used to store the different types of texture created for the character model.</p><p>There are a few functions defined that are called by the UI event handler. These functions are: <code class="literal">SetShoulderPad(Toggle id); SetBodyType(Toggle id); SetKneePad(Toggle id); SetLegPlate(Toggle id); SetWeaponType(Slider id); SetHelmetType(Toggle id); SetShieldType(Toggle id); SetSkinType(Slider id)</code>
<span class="emphasis"><em>;</em></span>
</p><p>All of the functions take a parameter that identifies which specific type is should enable or disable.</p><p>A BIG NOTE HERE!</p><p>You can also use the system we just built to create all of the different variations of your Non-Character Player models and store them as prefabs! Wow! This will save you so much time and effort in creating your characters representing different barbarians!!!</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch04lvl3sec11"></a>Preserving our character state</h4></div></div></div><p>Now that we have spent the time to customize our character, we need to preserve our character and use it in our game. In Unity, there is a function called <code class="literal">DontDestroyOnLoad()</code>. This is a great function that can be utilized at this time. What does it do? It keeps the specified GameObject in memory going from one scene to the next. We can use these mechanisms for now, eventually though, you will want to create a system that can save and load your user data.</p><p>Go ahead and create a new C# script and call it <code class="literal">DoNotDestroy.cs</code>. This script is going to be very simple. Here is the listing:</p><pre class="programlisting">using UnityEngine; &#13;
using System.Collections; &#13;
 &#13;
public class DoNotDestroy : MonoBehaviour &#13;
{ &#13;
 &#13;
   // Use this for initialization &#13;
   void Start() &#13;
   { &#13;
      DontDestroyOnLoad(this); &#13;
   } &#13;
 &#13;
   // Update is called once per frame &#13;
   void Update() &#13;
   { &#13;
 &#13;
   } &#13;
} &#13;
</pre><p>After you create the script go ahead and attach it to your character model prefab in the scene. Not bad, let's do a quick recap of what we have done so far.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec30"></a>Recap</h3></div></div></div><p>By now you should have three scenes that are functional. We have our scene that represents the main menu, we have our scene that represents our initial level, and we just created a scene that is used for character customization. Here is the flow of our game thus far:</p><p>
</p><div class="mediaobject"><img src="/graphics/9781785285004/graphics/image_04_005.jpg" /></div><p>
</p><p>We start the game, see the main menu, select the <span class="strong"><strong>Start Game</strong></span> button to enter the character customization scene, do our customization, and when we click the <span class="strong"><strong>Save</strong></span> button we load <span class="strong"><strong>level 1</strong></span>.</p><p>For this to work, we have created the following C# scripts:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>
<span class="strong"><strong>GameMaster.cs:</strong></span> used as the main script to keep track of our game state</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>CharacterCustomization.cs:</strong></span> used exclusively for customizing our character</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>DoNotDestroy.cs:</strong></span> used to save the state of a given object</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>CharacterController.cs:</strong></span> used to control the motion of our character</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>IKHandle.cs:</strong></span> used to implement inverse kinematics for the foot</p></li></ul></div><p>When you combine all of this together you now have a good framework and flow that can be extended and improved as we go along.</p></div></div>