<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch07lvl1sec45"></a>Integrating the code</h2></div></div><hr /></div><p>Now that we have our HUD design up and running, we will need to integrate the UI elements with the actual code that will be deriving them. There are a few scripts that are going to be created to support the new UI features, and a few that will be updated to glue everything together.</p><p>The following scripts have been created: <span class="emphasis"><em>ActiveInventoryItemUI.cs</em></span>, <span class="emphasis"><em>ActiveSpecialItemUI.cs</em></span> and <span class="emphasis"><em>HUDElementsUI.cs</em></span>.</p><p>The listing of these scripts is as follows:</p><pre class="programlisting">using UnityEngine; &#13;
using UnityEngine.UI; &#13;
using System.Collections; &#13;
 &#13;
public class ActiveInventoryItemUI : MonoBehaviour &#13;
{ &#13;
  public InventoryItem item; &#13;
 &#13;
  public Image imgActiveItem; &#13;
  public Text txtActiveItem; &#13;
 &#13;
} &#13;
</pre><pre class="programlisting">using UnityEngine; &#13;
using UnityEngine.UI; &#13;
using System.Collections; &#13;
using UnityEngine.EventSystems; &#13;
 &#13;
public class ActiveSpecialItemUI : EventTrigger &#13;
{ &#13;
 &#13;
  public override void OnPointerClick(PointerEventData data) &#13;
  { &#13;
    InventoryItem iia = this.gameObject.GetComponent&lt;ActiveInventoryItemUI&gt;().item; &#13;
 &#13;
    switch(iia.CATEGORY) &#13;
    { &#13;
      case BaseItem.ItemCategory.HEALTH: &#13;
        { &#13;
          // add the item to the special items panel &#13;
        GameMaster.instance.UI.ApplySpecialInventoryItem(iia); &#13;
          Destroy(this.gameObject); &#13;
 &#13;
          break; &#13;
        } &#13;
      case BaseItem.ItemCategory.POTION: &#13;
        { &#13;
          break; &#13;
        } &#13;
    } &#13;
 &#13;
  } &#13;
 &#13;
} &#13;
using UnityEngine; &#13;
using UnityEngine.UI; &#13;
using System.Collections; &#13;
 &#13;
public class HUDElementsUI : MonoBehaviour &#13;
{ &#13;
  public Image imgHealthBar; &#13;
  public Image imgManaBar; &#13;
 &#13;
  public GameObject activeInventoryItem; &#13;
  public GameObject activeSpecialItem; &#13;
 &#13;
  public Transform panelActiveInventoryItems; &#13;
  public Transform panelActiveSpecialItems; &#13;
 &#13;
} &#13;
</pre><p>These scripts are going to be used in the HUD user interface to give us access to the elements. For instance, you will need to attach the HUDElementsUI.cs script to the CanvasHUD GameObject.</p><p>
</p><div class="mediaobject"><img src="/graphics/9781785285004/graphics/image_07_013.jpg" /></div><p>
</p><p>The preceding screenshotÂ illustrates how the HUD Canvas is configured with the <span class="emphasis"><em>HUDElementsUI.cs</em></span> script.</p><p>Now let's take a look at the prefabs we have created to represent the UI elements to be used for the panels. There are two; I have named them <span class="emphasis"><em>PanelActiveItem</em></span> and <span class="emphasis"><em>PanelSpecialItem</em></span>.</p><p>I will discuss <span class="emphasis"><em>PanelSpecialItem,</em></span> as it contains everything <span class="emphasis"><em>PanelActiveItem</em></span> contains plus an additional script that is attached to it for event handling.</p><p>
</p><div class="mediaobject"><img src="/graphics/9781785285004/graphics/image_07_014.jpg" /></div><p>
</p><p>What we have just covered was the implementation of the scripts that are used to get access to the proper UI elements within the HUD canvas.</p><p>You will notice that for the <span class="emphasis"><em>PanelSpecialItem</em></span> prefab there are two new and very important components that we have attached to it. One is the <span class="emphasis"><em>Event Trigger</em></span> within Unity, and the other is the <span class="emphasis"><em>ActiveSpecialItemUI.cs</em></span> script, which is used to handle the <span class="emphasis"><em>PointerClick</em></span> event for the special item.</p><p>What this means is that we are basically making the item clickable, and when the player clicks on the item, something happens. In this case, it applies the special item to the player character.</p><p>Now we are ready to update the other scripts we have already developed to incorporate the HUD functionality. The scripts that will need to be modified are <span class="emphasis"><em>InventorySystem.cs</em></span> and <span class="emphasis"><em>UIController.cs</em></span>.</p><p>Here is a listing of <span class="emphasis"><em>InventorySystem.cs</em></span>:</p><pre class="programlisting">using System; &#13;
using UnityEngine; &#13;
using System.Collections.Generic; &#13;
 &#13;
[Serializable] &#13;
public class InventorySystem &#13;
{ &#13;
  [SerializeField] &#13;
  private List&lt;InventoryItem&gt; weapons = new List&lt;InventoryItem&gt;(); &#13;
  [SerializeField] &#13;
  private List&lt;InventoryItem&gt; armour = new List&lt;InventoryItem&gt;(); &#13;
  [SerializeField] &#13;
  private List&lt;InventoryItem&gt; clothing = new List&lt;InventoryItem&gt;(); &#13;
  [SerializeField] &#13;
  private List&lt;InventoryItem&gt; health = new List&lt;InventoryItem&gt;(); &#13;
  [SerializeField] &#13;
  private List&lt;InventoryItem&gt; potion = new List&lt;InventoryItem&gt;(); &#13;
 &#13;
  public List&lt;InventoryItem&gt; WEAPONS &#13;
  { &#13;
    get { return this.weapons; } &#13;
  } &#13;
 &#13;
  public List&lt;InventoryItem&gt; ARMOUR &#13;
  { &#13;
    get { return this.armour; } &#13;
  } &#13;
 &#13;
  public List&lt;InventoryItem&gt; CLOTHING &#13;
  { &#13;
    get { return this.clothing; } &#13;
  } &#13;
 &#13;
  public List&lt;InventoryItem&gt; HEALTH &#13;
  { &#13;
    get { return this.health; } &#13;
  } &#13;
 &#13;
  public List&lt;InventoryItem&gt; POTIONS &#13;
  { &#13;
    get { return this.potion; } &#13;
  } &#13;
 &#13;
  private InventoryItem selectedWeapon; &#13;
  private InventoryItem selectedArmour; &#13;
 &#13;
  public InventoryItem SELECTED_WEAPON &#13;
  { &#13;
    get { return this.selectedWeapon; } &#13;
    set { this.selectedWeapon = value; } &#13;
  } &#13;
  public InventoryItem SELECTED_ARMOUR &#13;
  { &#13;
    get { return this.selectedArmour; } &#13;
    set { this.selectedArmour = value; } &#13;
  } &#13;
 &#13;
  public InventorySystem() &#13;
  { &#13;
    this.ClearInventory(); &#13;
  } &#13;
 &#13;
  public void ClearInventory() &#13;
  { &#13;
    this.weapons.Clear(); &#13;
    this.armour.Clear(); &#13;
    this.clothing.Clear(); &#13;
    this.health.Clear(); &#13;
    this.potion.Clear(); &#13;
  } &#13;
 &#13;
  // this function will add an inventory item &#13;
  public void AddItem(InventoryItem item) &#13;
  { &#13;
    switch(item.CATEGORY) &#13;
    { &#13;
      case BaseItem.ItemCategory.ARMOUR: &#13;
        { &#13;
          this.armour.Add(item); &#13;
          break; &#13;
        } &#13;
      case BaseItem.ItemCategory.CLOTHING: &#13;
        { &#13;
          this.clothing.Add(item); &#13;
          break; &#13;
        } &#13;
      case BaseItem.ItemCategory.HEALTH: &#13;
        { &#13;
          this.health.Add(item); &#13;
 &#13;
          // add the item to the special items panel &#13;
          GameMaster.instance.UI.AddSpecialInventoryItem(item); &#13;
 &#13;
          break; &#13;
        } &#13;
      case BaseItem.ItemCategory.POTION: &#13;
        { &#13;
          this.potion.Add(item); &#13;
          break; &#13;
        } &#13;
      case BaseItem.ItemCategory.WEAPON: &#13;
        { &#13;
          this.weapons.Add(item); &#13;
          break; &#13;
        } &#13;
    } &#13;
  } &#13;
 &#13;
  // this function will remove an inventory item &#13;
  public void DeleteItem(InventoryItem item) &#13;
  { &#13;
    switch (item.CATEGORY) &#13;
    { &#13;
      case BaseItem.ItemCategory.ARMOUR: &#13;
        { &#13;
          this.armour.Remove(item); &#13;
          break; &#13;
        } &#13;
      case BaseItem.ItemCategory.CLOTHING: &#13;
        { &#13;
          this.clothing.Remove(item); &#13;
          break; &#13;
        } &#13;
      case BaseItem.ItemCategory.HEALTH: &#13;
        { &#13;
          // let's find the item and mark it for removal &#13;
          InventoryItem tmp = null; &#13;
          foreach(InventoryItem i in this.health) &#13;
          { &#13;
            if(item.CATEGORY.Equals(i.CATEGORY)&amp;&amp;item.NAME.Equals(i.NAME)&amp;&amp;item.STRENGTH.Equals(i.STRENGTH)) &#13;
            { &#13;
              tmp = i;               &#13;
            } &#13;
          } &#13;
 &#13;
          this.health.Remove(tmp); &#13;
 &#13;
          break; &#13;
        } &#13;
      case BaseItem.ItemCategory.POTION: &#13;
        { &#13;
          // let's find the item and mark it for removal &#13;
          InventoryItem tmp = null; &#13;
          foreach (InventoryItem i in this.health) &#13;
          { &#13;
            if (item.CATEGORY.Equals(i.CATEGORY) &amp;&amp; item.NAME.Equals(i.NAME) &amp;&amp; item.STRENGTH.Equals(i.STRENGTH)) &#13;
            { &#13;
              tmp = i; &#13;
            } &#13;
          } &#13;
 &#13;
          this.potion.Remove(item); &#13;
          break; &#13;
        } &#13;
      case BaseItem.ItemCategory.WEAPON: &#13;
        { &#13;
          this.weapons.Remove(item); &#13;
          break; &#13;
        } &#13;
    } &#13;
  } &#13;
 &#13;
} &#13;
</pre><pre class="programlisting">using UnityEngine; &#13;
using UnityEngine.UI; &#13;
using System; &#13;
 &#13;
public class UIController : MonoBehaviour &#13;
{ &#13;
  public Canvas SettingsCanvas; &#13;
  public Slider ControlMainVolume; &#13;
 &#13;
  // the canvas object for inventory system &#13;
  public Canvas InventoryCanvas; &#13;
 &#13;
  public Transform PanelItem; &#13;
  public GameObject InventoryItemElement; &#13;
 &#13;
  public HUDElementsUI hudUI; &#13;
 &#13;
  public void Update() &#13;
  { &#13;
 &#13;
  } &#13;
 &#13;
  public void DisplaySettings() &#13;
  { &#13;
    GameMaster.instance.DISPLAY_SETTINGS = !GameMaster.instance.DISPLAY_SETTINGS; &#13;
    this.SettingsCanvas.gameObject.SetActive(GameMaster.instance.DISPLAY_SETTINGS); &#13;
  } &#13;
 &#13;
  public void MainVolume() &#13;
  { &#13;
    GameMaster.instance.MasterVolume(ControlMainVolume.value); &#13;
  } &#13;
 &#13;
  public void StartGame() &#13;
  { &#13;
    GameMaster.instance.StartGame(); &#13;
  } &#13;
 &#13;
  public void LoadLevel() &#13;
  { &#13;
    if (GameObject.FindGameObjectWithTag("BASE")) &#13;
    { &#13;
      GameMaster.instance.PC_CC = GameObject.FindGameObjectWithTag("BASE").GetComponent&lt;CharacterCustomization&gt;().PC_CC; &#13;
    } &#13;
    GameMaster.instance.LEVEL_CONTROLLER.LEVEL = 1; &#13;
    GameMaster.instance.LoadLevel(); &#13;
  } &#13;
 &#13;
  public void DisplayInventory() &#13;
  { &#13;
   this.InventoryCanvas.gameObject.SetActive(GameMaster.instance.DISPLAY_INVENTORY); &#13;
  } &#13;
 &#13;
  private void ClearInventoryItemsPanel() &#13;
  { &#13;
    while(this.PanelItem.childCount&gt;0) &#13;
    { &#13;
      Transform t = this.PanelItem.GetChild(0).transform; &#13;
      t.parent = null; &#13;
      Destroy(t.gameObject); &#13;
    } &#13;
  } &#13;
 &#13;
 &#13;
  public void DisplayWeaponsCategory() &#13;
  { &#13;
    if(GameMaster.instance.DISPLAY_INVENTORY) &#13;
    { &#13;
      this.ClearInventoryItemsPanel(); &#13;
 &#13;
      foreach (InventoryItem item in GameMaster.instance.INVENTORY.WEAPONS) &#13;
      { &#13;
        GameObject objItem = GameObject.Instantiate(this.InventoryItemElement) as GameObject; &#13;
        InventoryItemUI invItem = objItem.GetComponent&lt;InventoryItemUI&gt;(); &#13;
        invItem.txtItemElement.text = &#13;
          string.Format("Name: {0}, Description: {1}, Strength: {2}, Weight: {3}", &#13;
                                  item.NAME, &#13;
                                  item.DESCRIPTION, &#13;
                                  item.STRENGTH, &#13;
                                  item.WEIGHT); &#13;
 &#13;
 &#13;
        invItem.item = item; &#13;
 &#13;
        // add button triggers &#13;
        invItem.butAdd.GetComponent&lt;Button&gt;().onClick.AddListener(() =&gt; &#13;
        { &#13;
          Debug.Log(string.Format("You have clicked button add for {0}, {1}", invItem.txtItemElement.text, invItem.item.NAME)); &#13;
 &#13;
          // let's apply the selected item to the player character &#13;
          GameMaster.instance.PC_CC.SELECTED_WEAPON = (PC.WEAPON_TYPE)Enum.Parse(typeof(PC.WEAPON_TYPE), invItem.item.NAME); &#13;
          GameMaster.instance.PlayerWeaponChanged(invItem.item); &#13;
          this.AddActiveInventoryItem(invItem.item); &#13;
        }); &#13;
 &#13;
        // delete button triggers &#13;
        invItem.butDelete.GetComponent&lt;Button&gt;().onClick.AddListener(() =&gt; &#13;
        { &#13;
          Debug.Log(string.Format("You have clicked button delete for {0}", invItem.txtItemElement.text)); &#13;
          Destroy(objItem); &#13;
        }); &#13;
 &#13;
        objItem.transform.SetParent(this.PanelItem); &#13;
      } &#13;
 &#13;
    } &#13;
  } &#13;
 &#13;
  public void DisplayArmourCategory() &#13;
  { &#13;
    if (GameMaster.instance.DISPLAY_INVENTORY) &#13;
    { &#13;
      this.ClearInventoryItemsPanel(); &#13;
 &#13;
      foreach (InventoryItem item in GameMaster.instance.INVENTORY.ARMOUR) &#13;
      { &#13;
        GameObject objItem = GameObject.Instantiate(this.InventoryItemElement) as GameObject; &#13;
        InventoryItemUI invItem = objItem.GetComponent&lt;InventoryItemUI&gt;(); &#13;
        invItem.txtItemElement.text = &#13;
          string.Format("Name: {0}, Description: {1}, Strength: {2}, Weight: {3}", &#13;
                                  item.NAME, &#13;
                                  item.DESCRIPTION, &#13;
                                  item.STRENGTH, &#13;
                                  item.WEIGHT); &#13;
 &#13;
        invItem.item = item; &#13;
 &#13;
        // add button triggers &#13;
        invItem.butAdd.GetComponent&lt;Button&gt;().onClick.AddListener(() =&gt; &#13;
        { &#13;
          Debug.Log(string.Format("You have clicked button add for {0}, {1}", invItem.txtItemElement.text, invItem.item.NAME)); &#13;
 &#13;
          // let's apply the selected item to the player character &#13;
          GameMaster.instance.PC_CC.SELECTED_ARMOUR = invItem.item; &#13;
          GameMaster.instance.PlayerArmourChanged(invItem.item); &#13;
          this.AddActiveInventoryItem(invItem.item); &#13;
        }); &#13;
 &#13;
        // delete button triggers &#13;
        invItem.butDelete.GetComponent&lt;Button&gt;().onClick.AddListener(() =&gt; &#13;
        { &#13;
          Debug.Log(string.Format("You have clicked button delete for {0}", invItem.txtItemElement.text)); &#13;
          Destroy(objItem); &#13;
        }); &#13;
 &#13;
        objItem.transform.SetParent(this.PanelItem); &#13;
      } &#13;
    } &#13;
  } &#13;
 &#13;
  public void DisplayClothingCategory() &#13;
  { &#13;
    if (GameMaster.instance.DISPLAY_INVENTORY) &#13;
    { &#13;
      this.ClearInventoryItemsPanel(); &#13;
 &#13;
      foreach (InventoryItem item in GameMaster.instance.INVENTORY.CLOTHING) &#13;
      { &#13;
        GameObject objItem = GameObject.Instantiate(this.InventoryItemElement) as GameObject; &#13;
        InventoryItemUI invItem = objItem.GetComponent&lt;InventoryItemUI&gt;(); &#13;
        invItem.txtItemElement.text = &#13;
          string.Format("Name: {0}, Description: {1}, Strength: {2}, Weight: {3}", &#13;
                                  item.NAME, &#13;
                                  item.DESCRIPTION, &#13;
                                  item.STRENGTH, &#13;
                                  item.WEIGHT); &#13;
 &#13;
        invItem.item = item; &#13;
 &#13;
        // add button triggers &#13;
        invItem.butAdd.GetComponent&lt;Button&gt;().onClick.AddListener(() =&gt; &#13;
        { &#13;
          Debug.Log(string.Format("You have clicked button add for {0}", invItem.txtItemElement.text)); &#13;
 &#13;
           &#13;
        }); &#13;
 &#13;
        // delete button triggers &#13;
        invItem.butDelete.GetComponent&lt;Button&gt;().onClick.AddListener(() =&gt; &#13;
        { &#13;
          Debug.Log(string.Format("You have clicked button delete for {0}", invItem.txtItemElement.text)); &#13;
          Destroy(objItem); &#13;
        }); &#13;
 &#13;
        objItem.transform.SetParent(this.PanelItem); &#13;
      } &#13;
    } &#13;
  } &#13;
 &#13;
  public void DisplayHealthCategory() &#13;
  { &#13;
    if (GameMaster.instance.DISPLAY_INVENTORY) &#13;
    { &#13;
      this.ClearInventoryItemsPanel(); &#13;
 &#13;
      foreach (InventoryItem item in GameMaster.instance.INVENTORY.HEALTH) &#13;
      { &#13;
        GameObject objItem = GameObject.Instantiate(this.InventoryItemElement) as GameObject; &#13;
        InventoryItemUI invItem = objItem.GetComponent&lt;InventoryItemUI&gt;(); &#13;
        invItem.txtItemElement.text = &#13;
          string.Format("Name: {0}, Description: {1}, Strength: {2}, Weight: {3}", &#13;
                                  item.NAME, &#13;
                                  item.DESCRIPTION, &#13;
                                  item.STRENGTH, &#13;
                                  item.WEIGHT); &#13;
 &#13;
        invItem.item = item; &#13;
 &#13;
        // add button triggers &#13;
        invItem.butAdd.GetComponent&lt;Button&gt;().onClick.AddListener(() =&gt; &#13;
        { &#13;
          Debug.Log(string.Format("You have clicked button add for {0}", invItem.txtItemElement.text)); &#13;
 &#13;
          // let's apply the selected item to the player character &#13;
          GameMaster.instance.PC_CC.HEALTH += invItem.item.STRENGTH * 100; //(PC.WEAPON_TYPE)Enum.Parse(typeof(PC.WEAPON_TYPE), invItem.item.NAME); &#13;
          if(GameMaster.instance.PC_CC.HEALTH&gt;100f) &#13;
          { &#13;
            GameMaster.instance.PC_CC.HEALTH = 100f; &#13;
          } &#13;
 &#13;
          GameMaster.instance.INVENTORY.DeleteItem(invItem.item); &#13;
 &#13;
          Destroy(objItem); &#13;
           &#13;
          //GameMaster.instance.PlayerWeaponChanged(invItem.item); &#13;
          //this.AddActiveInventoryItem(invItem.item); &#13;
 &#13;
        }); &#13;
 &#13;
        // delete button triggers &#13;
        invItem.butDelete.GetComponent&lt;Button&gt;().onClick.AddListener(() =&gt; &#13;
        { &#13;
          Debug.Log(string.Format("You have clicked button delete for {0}", invItem.txtItemElement.text)); &#13;
          Destroy(objItem); &#13;
        }); &#13;
 &#13;
        objItem.transform.SetParent(this.PanelItem); &#13;
      } &#13;
 &#13;
    } &#13;
  } &#13;
 &#13;
  public void DisplayPotionsCategory() &#13;
  { &#13;
    if (GameMaster.instance.DISPLAY_INVENTORY) &#13;
    { &#13;
      this.ClearInventoryItemsPanel(); &#13;
 &#13;
      foreach (InventoryItem item in GameMaster.instance.INVENTORY.POTIONS) &#13;
      { &#13;
        GameObject objItem = GameObject.Instantiate(this.InventoryItemElement) as GameObject; &#13;
        InventoryItemUI invItem = objItem.GetComponent&lt;InventoryItemUI&gt;(); &#13;
        invItem.txtItemElement.text = &#13;
          string.Format("Name: {0}, Description: {1}, Strength: {2}, Weight: {3}", &#13;
                                  item.NAME, &#13;
                                  item.DESCRIPTION, &#13;
                                  item.STRENGTH, &#13;
                                  item.WEIGHT); &#13;
 &#13;
        invItem.item = item; &#13;
 &#13;
        // add button triggers &#13;
        invItem.butAdd.GetComponent&lt;Button&gt;().onClick.AddListener(() =&gt; &#13;
        { &#13;
          Debug.Log(string.Format("You have clicked button add for {0}", invItem.txtItemElement.text)); &#13;
        }); &#13;
 &#13;
        // delete button triggers &#13;
        invItem.butDelete.GetComponent&lt;Button&gt;().onClick.AddListener(() =&gt; &#13;
        { &#13;
          Debug.Log(string.Format("You have clicked button delete for {0}", invItem.txtItemElement.text)); &#13;
          Destroy(objItem); &#13;
        }); &#13;
 &#13;
        objItem.transform.SetParent(this.PanelItem); &#13;
      } &#13;
 &#13;
    } &#13;
  } &#13;
 &#13;
  #region Adding Active Inventory Item to the UI &#13;
  public void AddActiveInventoryItem(InventoryItem item) &#13;
  { &#13;
    // Make a copy of the Inventory Item Object &#13;
    InventoryItem myItem = new InventoryItem(); &#13;
    myItem.CopyInventoryItem(item); &#13;
 &#13;
    GameObject objItem = GameObject.Instantiate(this.hudUI.activeInventoryItem) as GameObject; &#13;
    ActiveInventoryItemUI aeUI = objItem.GetComponent&lt;ActiveInventoryItemUI&gt;(); &#13;
    aeUI.txtActiveItem.text = myItem.NAME.ToString(); &#13;
 &#13;
    aeUI.item = myItem; &#13;
 &#13;
    objItem.transform.SetParent(this.hudUI.panelActiveInventoryItems); &#13;
 &#13;
    LayoutRebuilder.MarkLayoutForRebuild(this.hudUI.panelActiveInventoryItems as RectTransform); &#13;
  } &#13;
 &#13;
  public void AddSpecialInventoryItem(InventoryItem item) &#13;
  { &#13;
    // Make a copy of the Inventory Item Object &#13;
    InventoryItem myItem = new InventoryItem(); &#13;
    myItem.CopyInventoryItem(item); &#13;
 &#13;
    GameObject objItem = GameObject.Instantiate(this.hudUI.activeSpecialItem) as GameObject; &#13;
    ActiveInventoryItemUI aeUI = objItem.GetComponent&lt;ActiveInventoryItemUI&gt;(); &#13;
    aeUI.txtActiveItem.text = myItem.NAME.ToString(); &#13;
    aeUI.item = myItem; &#13;
 &#13;
    objItem.transform.SetParent(this.hudUI.panelActiveSpecialItems); &#13;
 &#13;
    LayoutRebuilder.MarkLayoutForRebuild(this.hudUI.panelActiveSpecialItems as RectTransform); &#13;
  } &#13;
 &#13;
  public void ApplySpecialInventoryItem(InventoryItem item) &#13;
  { &#13;
    GameMaster.instance.PC_CC.HEALTH += item.STRENGTH * 100; //(PC.WEAPON_TYPE)Enum.Parse(typeof(PC.WEAPON_TYPE), invItem.item.NAME); &#13;
    if (GameMaster.instance.PC_CC.HEALTH &gt; 100f) &#13;
    { &#13;
      GameMaster.instance.PC_CC.HEALTH = 100f; &#13;
    } &#13;
 &#13;
    GameMaster.instance.INVENTORY.DeleteItem(item); &#13;
  } &#13;
  #endregion &#13;
 &#13;
} &#13;
</pre><p>Now that you have everything in place, you can go ahead and test run the game to make sure everything is working as expected. This is also a good time to test/debug your code and your project settings if you have not done so already.</p><p>I have to make the following point once again; the idea is to grasp the concept. We are looking at one way to implement what we want to achieve; you might come up with a better way along the way, or decide to do something totally different. I encourage that!</p><p>
</p><div class="mediaobject"><img src="/graphics/9781785285004/graphics/image_07_015.jpg" /></div><p>
</p><p>The preceding screenshotÂ illustrates the state of the player character and that of the inventory when the level initially loads. I have indicated the critical parts that we are testing and that we are going to track to make sure our code is working properly.</p><p>In the next screenshot, the player character has picked up a few of the inventory items we have placed in the level. When you bring up the inventory window and click on any one of the categories defined, i.e., weapons, you will get a listing of all the weapons that we have in our inventory and so forth.</p><p>We have collected one weapon type, one health packet, and a couple of defensive items. Notice that our special items panel is displaying an item. This is the health packet we have picked up.</p><p>
</p><div class="mediaobject"><img src="/graphics/9781785285004/graphics/image_07_016.jpg" /></div><p>
</p><p>The next screenshotÂ will illustrate how the HUD updates itself when the player starts consuming some of the inventory items by adding them using the inventory window during gameplay.</p><p>Notice that we have activated three inventory items: a weapon named <span class="emphasis"><em>axe2</em></span> and two armours of type helmet and shield named <span class="emphasis"><em>HL02</em></span> and <span class="emphasis"><em>SL01</em></span> respectively.</p><p>You can see them on the player character as well as in the panel holding the active inventory items. Pretty cool.</p><p>
</p><div class="mediaobject"><img src="/graphics/9781785285004/graphics/image_07_017.jpg" /></div><p>
</p><p>It's time to go and meet the enemy. We have not discussed the interaction between the player character and the non-player characters (NPCs) much. We will do this shortly.</p><p>We have applied some of the inventory items from our inventory to the player character, and now we can actually go and face the enemy. We are going to allow the enemy to attack us to see how our health reduces. Then we will use the health packet from our special items panel to increase our health once more.</p><p>The next two screenshotsÂ will illustrate this scenario:</p><p>
</p><div class="mediaobject"><img src="/graphics/9781785285004/graphics/image_07_018.jpg" /></div><p>
</p><p>We are going to run away and apply our health packet!</p><p>
</p><div class="mediaobject"><img src="/graphics/9781785285004/graphics/image_07_019.jpg" /></div><p>
</p><p>Notice how, when we apply the health packet, it removes itself from the inventory system as well as the special items panel. You might take note and say, but hold on, if we have applied the health packet, then how come our health bar is actually less then when we started? Well, unfortunately, when I resumed gameplay and started running away, the enemy got the opportunity to give my player character a few more hard blows! Therefore, by the time I had applied the health packet, and the initial screenshot, my health had dropped another 20 points!</p><p>How do I know this? Well, the health packet has a strength and weight of 0.2, translating to 20 points on a scale from 0 to 100, which is the representation of our health.</p></div>