<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch02lvl1sec14"></a>Loading up a CAD model</h2></div></div><hr /></div><p>Whatever the<a id="id86" class="indexterm"></a> program or workflow you use, you need to save a 3D model<a id="id87" class="indexterm"></a> in a format Unity recognizes. You either save the model directly inside the Assets folder from within your modeling software <span class="strong"><strong>Save As…</strong></span> or <span class="strong"><strong>Export…</strong></span> dialog, but you can also drag the file onto the Unity project window. The end result is the same.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec12"></a>Can you show me, please?</h3></div></div></div><p>We will illustrate this using Graphisoft ArchiCAD and Maxon CINEMA 4D. The workflow when <a id="id88" class="indexterm"></a>using Autodesk Revit or AutoCAD in <a id="id89" class="indexterm"></a>combination with 3ds Max is<a id="id90" class="indexterm"></a> similar.</p><p>Since you<a id="id91" class="indexterm"></a> cannot export from ArchiCAD to the recommended <code class="literal">FBX</code> or Collada formats directly, you need conversion software. While many modeling systems, including ArchiCAD, support exporting to <code class="literal">3DS</code> (old 3D Studio for DOS format, before 3ds Max was created) or <code class="literal">OBJ</code> (old Alias Wavefront format, before Maya was released), these formats present certain limitations and make the update process cumbersome.</p><p>In the particular combination of ArchiCAD and CINEMA 4D, it is advised to use the <span class="emphasis"><em>Exchange add-on</em></span>, which enables the <code class="literal">C4D</code> format export from ArchiCAD. The clever part is that changes in the ArchiCAD model can be exported again and be merged inside CINEMA 4D, which <a id="id92" class="indexterm"></a>effectively replaces the old geometry<a id="id93" class="indexterm"></a> with the new version, but <a id="id94" class="indexterm"></a>retaining assigned or altered materials and <a id="id95" class="indexterm"></a>all other settings, such as lights, cameras, additional models, animations, or rendering settings. When you export your ArchiCAD Model, you have two options in the <span class="strong"><strong>CINEMA 4D Settings</strong></span> dialog inside ArchiCAD by navigating to <span class="strong"><strong>Design</strong></span> | <span class="strong"><strong>Design Extras</strong></span> | <span class="strong"><strong>Cinema 4D Exchange</strong></span> | <span class="strong"><strong>CINEMA 4D Settings,</strong></span> to go <span class="strong"><strong>by Material</strong></span> or to go <span class="strong"><strong>by Class (Wall, Slab, etc.)</strong></span>. We keep the <span class="strong"><strong>Geometry scaling factor</strong></span> at <span class="strong"><strong>1,00</strong></span>. This is shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783559060/graphics/7500_02_04.jpg" /></div><p>The first option makes it easier inside CINEMA 4D to adjust materials, as the model is structured in groups, in which each group has one material <span class="strong"><strong>tag</strong></span> assigned, as shown in the following screenshot, displaying the <span class="strong"><strong>Objects</strong></span> browser. This works fine inside CINEMA 4D, as the material properties are passed to child objects, unless they contain their own material tag.</p><div class="mediaobject"><img src="/graphics/9781783559060/graphics/7500_02_05.jpg" /></div><p>As we have experienced, this presents a problem once inside Unity. The exact hierarchy of groups and objects is<a id="id96" class="indexterm"></a> recreated with GameObjects. The groups inside Unity will become empty GameObjects, which do not contain any material. The actual meshes are <a id="id97" class="indexterm"></a>placed as children underneath <a id="id98" class="indexterm"></a>the groups, using a default, grey <span class="strong"><strong>No Name</strong></span> material, thus <a id="id99" class="indexterm"></a>making the model unusable <a id="id100" class="indexterm"></a>inside Unity.</p><p>You can use a utility function inside newer versions of CINEMA 4D to re-organize the model structure to actually combine all meshes, and properly assign the material by navigating to <span class="strong"><strong>Tools</strong></span> | <span class="strong"><strong>Combine Project</strong></span>. The following screenshot shows the effect of the <span class="strong"><strong>By Material</strong></span> option:</p><div class="mediaobject"><img src="/graphics/9781783559060/graphics/7500_02_06.jpg" /></div><p>As a result, the model hierarchy is shifted around and is now suitable for export to Unity.</p><p>Beware that you can no longer use the <span class="emphasis"><em>Merge</em></span> function in CINEMA 4D when the original model is changed, as this depends on a pre-defined model structure, so if you plan on updating the original model, it is best to retain the original structure and stick to the <span class="strong"><strong>By Class</strong></span> option in the CINEMA 4D export dialog, as it works better inside Unity.</p><p>To go from CINEMA 4D to Unity can be done in two ways. When you export the <code class="literal">C4D</code> file directly inside the <a id="id101" class="indexterm"></a>Assets folder, Unity loads up <a id="id102" class="indexterm"></a>CINEMA 4D in the background <a id="id103" class="indexterm"></a>and automatically exports the project to an <code class="literal">FBX</code> file. This is the simplest workflow. You can even double-click the model in the <a id="id104" class="indexterm"></a>Unity Project Tab to open it up in the native software, make changes, save, and close, and the placed model is updated automatically. The second approach, as suggested by most experts, is doing it manually, by keeping the native model outside of the <code class="literal">Assets</code> folder and exporting to <code class="literal">FBX</code> when needed. This gives more control and flexibility.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec13"></a>Controlling the import settings</h3></div></div></div><p>When the model is<a id="id105" class="indexterm"></a> loaded inside Unity, it is displayed inside the <a id="id106" class="indexterm"></a>Project Tab. If you click on the model name or icon, you can adjust the import settings in the Inspector Tab, as shown in following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783559060/graphics/7500_02_07.jpg" /></div><p>The settings are explained in the following points:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>The first and foremost important setting is the <span class="strong"><strong>Scale Factor</strong></span>. While you can scale any imported and positioned object using the transform component of placed GameObjects, this sometimes has unexpected effects on, for example, child object transformations. You should try to adjust the scaling factor on the model importer to ensure that it can be instanced in the scene using a transform scale of X=1, Y=1, and Z=1. This is directly dependent on how the model was exported. We usually apply a scale of <code class="literal">1</code>, <code class="literal">0.1</code> or <code class="literal">0.01</code>, which is easy to find out using trial and error.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Mesh Compression</strong></span> is mostly meant for large organic meshes. We try to avoid any change that would alter the mesh structure, so we leave this unchecked. <span class="strong"><strong>Optimize Mesh</strong></span> does not change the look of the mesh, so it can be safely checked.</p></li><li style="list-style-type: disc"><p>If you need your character to be able to walk on top of geometry and climb staircases, you should enable <span class="strong"><strong>Generate Colliders</strong></span>. This uses the actual geometry to create a <span class="emphasis"><em>Mesh Collider</em></span> for each object.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip04"></a>Tip</h3><p>While not the most efficient approach, performance-wise, the only real alternative is to use a separate simplified model as a collision mesh. Replace the Mesh collider in complex objects, such as plants or furniture, with a simple box or cylinder, to increase collision efficiency. This is done in professional game authoring, to increase efficiency and performance, but is often unfeasible in our context of architectural building models.</p></div></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Generate Lightmap UVs</strong></span> is required if you want to use Unity's integrated <span class="emphasis"><em>Beast</em></span> <span class="emphasis"><em>Lightmapping</em></span>. We could ignore it for our quick test, as it makes the import <a id="id107" class="indexterm"></a>process longer, but we'll make use of it <a id="id108" class="indexterm"></a>in the next chapter.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Normals &amp; Tangents</strong></span> are left at their default settings.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Materials</strong></span> will be created, based on the model structure. If you have multiple models loaded in Unity, it makes sense to set the <span class="strong"><strong>Material Search</strong></span> to enforce the reuse of materials with identical names. Use this when you reload the model and you already have existing materials set up.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Animations</strong></span> can be ignored in most architectural models, unless you did record for example, door and window opening animations in your intermediate DCC software. They are normally not included in CAD or BIM models.</p></li></ul></div><p>When you make changes to any of the above settings, press <span class="strong"><strong>Apply</strong></span> to re-import the model with these settings. After that, you can drag the model icon from the Project Tab onto the Hierarchy Tab or directly in the Scene view. We usually set the transform of the model to be in the origin (<span class="emphasis"><em>X=0</em></span>, <span class="emphasis"><em>Y=0</em></span>, <span class="emphasis"><em>and</em></span> <span class="emphasis"><em>Z=0</em></span>) and work from there.</p><p>The first thing you need to do is compare your model scale with a reference object. Use the <span class="emphasis"><em>Cube</em></span> object we placed earlier and move it close to the model, so you can check if your scale looks fine.</p><p>Resist the urge to press <span class="strong"><strong>Play</strong></span> at this moment, since without any further action, you cannot interact with the scene right now. You can however inspect the model directly in the Scene view, by panning and orbiting around.</p><div class="mediaobject"><img src="/graphics/9781783559060/graphics/7500_02_08.jpg" /></div><p>Use the <a id="id109" class="indexterm"></a>Hand icon (see previous screenshot) by clicking on it with the <span class="emphasis"><em>Left Mouse Button</em></span> (<span class="emphasis"><em>LMB</em></span>) to pan around and press <span class="emphasis"><em>Alt</em></span> + <span class="emphasis"><em>LMB</em></span> to switch to orbit mode. The <span class="emphasis"><em>mouse wheel</em></span> zooms in and out. While similar to typical 3D or CAD software, beware that the <a id="id110" class="indexterm"></a>modifier keys are probably not exactly the same as what you are used to. After a while, it becomes second nature, luckily. As an alternative, the <span class="emphasis"><em>Q</em></span>, <span class="emphasis"><em>W</em></span>, <span class="emphasis"><em>E</em></span>, and <span class="emphasis"><em>R</em></span> keys are mapped to these four tools respectively.</p></div></div>