<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch04lvl1sec25"></a>First Person versus Third Person Controller</h2></div></div><hr /></div><p>In <a class="link" href="#" linkend="ch02">Chapter 2</a>, <span class="emphasis"><em>Quick Walk Around Your Design</em></span>, we explained how to load a default character controller, which is<a id="id192" class="indexterm"></a> included with Unity. The behavior of character <a id="id193" class="indexterm"></a>controllers is provided by script components. Normally, when you author a scene, you don't need to be concerned about the inner workings <a id="id194" class="indexterm"></a>of the actual script. You merely assign variables and <a id="id195" class="indexterm"></a>adjust parameters.</p><p>Many typical 3D <a id="id196" class="indexterm"></a>action games use a first person perspective, where the camera is positioned to mimic the view through the characters own eyes. Sometimes, you also see your virtual hands or some kind of weapon, for example, <span class="strong"><strong>Splinter Cell</strong></span>, <span class="strong"><strong>Far Cry</strong></span>, or <span class="strong"><strong>Half-Life</strong></span>. This is the recommended way to view an architectural model, as you can easily look around in all directions and it feels more immersive.</p><p>The alternative, which can be experienced in games such as <span class="strong"><strong>Tomb Raider</strong></span>, <span class="strong"><strong>Grand Theft Auto</strong></span>, or <span class="strong"><strong>Assassin's Creed</strong></span>, is a third person perspective, usually showing the main character from slightly above and behind. The camera follows the character and is usually equipped with a spring-like motion, which eases the character movements a bit. If done right, it is good for getting more involved with the character. We'll compare both setups more in <a id="id197" class="indexterm"></a>detail <a id="id198" class="indexterm"></a>later in this chapter.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec17"></a>Setting up the First Person Controller</h3></div></div></div><p>The <span class="strong"><strong>First Person Controller</strong></span> (<span class="strong"><strong>FPC</strong></span>) combines a <span class="strong"><strong>Graphics</strong></span> and a <span class="strong"><strong>Main Camera</strong></span> object. We already<a id="id199" class="indexterm"></a> described how you could use the default FPC prefab in <a class="link" href="#" linkend="ch02">Chapter 2</a>, <span class="emphasis"><em>Quick Walk Around Your Design</em></span>. We will briefly explain how this setup works and <a id="id200" class="indexterm"></a>how <a id="id201" class="indexterm"></a>you can refine it.</p><p>As illustrated in <a class="link" href="#" linkend="ch02">Chapter 2</a>, <span class="emphasis"><em>Quick Walk Around Your Design</em></span>, the FPC contains three <span class="strong"><strong>GameObjects</strong></span>. Firstly, the <span class="strong"><strong>First Person Controller</strong></span> is an <span class="strong"><strong>Empty</strong></span> <span class="strong"><strong>GameObject</strong></span>, which contains most of the scripts and components required as <a id="id202" class="indexterm"></a>follows:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>The <span class="strong"><strong>Character Controller</strong></span> component<a id="id203" class="indexterm"></a> is used to define the main parameters of the FPC and is used to refine movements. You can use the <span class="strong"><strong>Slope Limit</strong></span> and <span class="strong"><strong>Step Offset</strong></span> to set the steepest angle and highest step the controller can take. By default, this is <span class="strong"><strong>45</strong></span> degrees and <span class="strong"><strong>0.4</strong></span> units respectively.</p></li><li style="list-style-type: disc"><p>The <span class="strong"><strong>Mouse Look</strong></span> script<a id="id204" class="indexterm"></a> reacts to mouse movements left and right, defined by the <span class="strong"><strong>MouseX</strong></span> value for the <span class="strong"><strong>Axes</strong></span> parameter. This defines the direction in which the FPC will move.</p></li><li style="list-style-type: disc"><p>The <span class="strong"><strong>Character Motor</strong></span> script<a id="id205" class="indexterm"></a> steers the actual navigation movements. There are several parameters to refine, for example, the maximum movement speed, the availability of jumping, and how sliding and other movements are controlled.</p></li><li style="list-style-type: disc"><p>The <span class="strong"><strong>FPSInput</strong></span> Controller script<a id="id206" class="indexterm"></a> links keyboard presses and game controller movements (defined by the <span class="strong"><strong>Input</strong></span> <span class="strong"><strong>Axes</strong></span> in the script) with the <span class="strong"><strong>Character Motor</strong></span>. Two keyboard setups are activated by default. The <span class="emphasis"><em>W</em></span> - <span class="emphasis"><em>A</em></span> - <span class="emphasis"><em>S</em></span> - <span class="emphasis"><em>D</em></span> keys, which form almost an arrow on QWERTY keyboards are common in games and indicate the direction in which the controller will move. However, they are not practical with Azerty or other keyboard layouts. The arrow keys are set up as an alternative control configuration and they are more universal, especially as most clients for architectural visualization projects are only casual gamers, at best.</p></li></ul></div><p>Secondly, as a child of the <span class="strong"><strong>First Person Controller</strong></span>, a <span class="strong"><strong>Graphics</strong></span> <span class="strong"><strong>GameObject</strong></span> is attached, which contains a capsule-shaped <span class="strong"><strong>Mesh</strong></span> inside the <span class="strong"><strong>Mesh Filter</strong></span>, using a <span class="strong"><strong>Capsule Collider</strong></span> that prevents the player from walking through walls. The <span class="strong"><strong>Mesh Renderer</strong></span> component of the <span class="strong"><strong>Graphics</strong></span> object is actually irrelevant, as the player would normally not see itself. It has no scripts or additional functionality.</p><p>Finally, the <span class="strong"><strong>Main Camera</strong></span> object, as a sibling to the <span class="strong"><strong>Graphics</strong></span> objects, is used to look up or down, relative to the capsule, using the same <span class="strong"><strong>Mouse Look</strong></span> script as mentioned previously, but <a id="id207" class="indexterm"></a>configured for up-down mouse movements, set by the <span class="strong"><strong>MouseY</strong></span> value <a id="id208" class="indexterm"></a>of the <span class="strong"><strong>Axes</strong></span> parameter.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip07"></a>Tip</h3><p>Beware that exploring with the mouse is not at all intuitive for casual game users, so take care of finding out which setup is most appropriate for your project and provide a level of in-game documentation.</p></div><p>You can tweak several settings, such as <span class="strong"><strong>Max Forward Speed</strong></span>, or allowed <span class="strong"><strong>Slope Limit</strong></span>, but the defaults are usually good to get started.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip08"></a>Tip</h3><p>If there was already another <span class="strong"><strong>Main Camera</strong></span> in the scene, you can remove it, or at least disable its <span class="strong"><strong>Audio Listener</strong></span>, according to the warning on the status bar and <span class="strong"><strong>Console</strong></span> log. This can happen with multiple controllers or cameras.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec18"></a>Setting up the Third Person Controller</h3></div></div></div><p>As an alternative controller setup, we will now configure a <span class="strong"><strong>Third Person Controller</strong></span> (<span class="strong"><strong>3PC</strong></span>) that<a id="id209" class="indexterm"></a> looks<a id="id210" class="indexterm"></a> at our main character from behind:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Remove the FPC and drag the <span class="strong"><strong>3rd Person Controller</strong></span> prefab onto the scene. It has an almost similar setup as the FPC. There is a main object with several components and two child objects containing both a skeleton (<span class="strong"><strong>Bip001</strong></span> and all underlying skeleton positions) and the Mesh of the <span class="strong"><strong>construction_worker</strong></span> model as shown in the following screenshot. Ensure it is positioned above the floor (for example, set the <span class="strong"><strong>Transform</strong></span> component's <span class="strong"><strong>Position</strong></span> <span class="strong"><strong>Y</strong></span> value to <code class="literal">1.1</code>).</p><div class="mediaobject"><img src="/graphics/9781783559060/graphics/7500EN_04_01.jpg" /></div></li><li><p>We had a few <a id="id211" class="indexterm"></a>errors while running, so we fix them one by one:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>For some<a id="id212" class="indexterm"></a> reason, the animations of the 3PC were not completely configured from the package by default, as visible in the previous screenshot of the first step. If you click on play, the character starts to run in place and continues to run the whole time, even while walking, waiting, and jumping, as the <span class="strong"><strong>Animation Clip</strong></span>s were not assigned properly. You can see the problems indicated as messages on the status bar and in the <span class="strong"><strong>Console</strong></span> log. Messages are indicated by an exclamation mark and do not prevent the script from running, but are put there by the developer to log a certain message. Warnings and errors always indicate a problem that needs to be solved.</p><div class="mediaobject"><img src="/graphics/9781783559060/graphics/7500EN_04_02.jpg" /></div></li><li><p>So how do we fix this? In the <span class="strong"><strong>Animation</strong></span> component, the default animation refers to the <span class="strong"><strong>run</strong></span> clip instead of <span class="strong"><strong>idle</strong></span> clip, so the character will make the running movement the whole time. Moreover, the clips in the <span class="strong"><strong>Third Person Controller</strong></span> <span class="strong"><strong>(Script)</strong></span> are indicated as <span class="strong"><strong>Missing</strong></span> <span class="strong"><strong>(Animation Clip)</strong></span>. Click the small circle to select the correct ones. The following<a id="id213" class="indexterm"></a> screenshot gives the correct assignments, indicated <a id="id214" class="indexterm"></a>in bold:</p><div class="mediaobject"><img src="/graphics/9781783559060/graphics/7500EN_04_03.jpg" /></div><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip09"></a>Tip</h3><p>The bold text formatting means that these settings differ from the default settings in the loaded <span class="strong"><strong>Prefab</strong></span>. You can turn them into the new default values, by clicking on the <span class="strong"><strong>Apply</strong></span> button for the <span class="strong"><strong>Prefab</strong></span> in the <span class="strong"><strong>Inspector</strong></span>, as indicated in the previous screenshot. When you use the 3PC in other scenes, it will be set up from now on.</p></div></li><li><p>Additionally, you could have a problem with the camera setup. The <span class="strong"><strong>Third Person Camera (Script)</strong></span> (TPC) component, attached to the 3PC, moves a camera around that follows the character. If it can't find it, an error message is displayed on the <span class="strong"><strong>Console</strong></span> log. You can <a id="id215" class="indexterm"></a>either assign any chosen camera <a id="id216" class="indexterm"></a>yourself to the <span class="strong"><strong>Camera Transform</strong></span> member variable of the TPC or rely on the built-in automatic lookup from the script. However, this requires a camera tagged as <span class="strong"><strong>MainCamera</strong></span>, as shown in the following screenshot:</p></li></ol></div><div class="mediaobject"><img src="/graphics/9781783559060/graphics/7500EN_04_04.jpg" /></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note09"></a>Note</h3><p>Tags are strings of text that can be assigned to a <span class="strong"><strong>GameObject</strong></span>. They can be used for anything, but each object can only have one tag. In the example, a <span class="strong"><strong>MainCamera</strong></span> tag should be available and assigned to the camera. The actual name of the camera does not matter here.</p></div></li><li><p>If you click on play now, you can navigate the <span class="strong"><strong>Worker</strong></span> character around the scene. The character can be steered using the arrow keys. To have him jump up, use the space key.</p></li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec19"></a>Choosing between FPC and TPC?</h3></div></div></div><p>Depending on <a id="id217" class="indexterm"></a>your audience, one of the two navigation <a id="id218" class="indexterm"></a>schemes might seem more appropriate, but that is something you have to decide for yourself.</p><p>For an inexperienced game author, the worker model from the TPC looks more user friendly and even "spectacular" if you are not into gaming and character modeling, but it is sometimes hard to steer this model through a small corridor or up a staircase. Moreover, as it is a default model, to simply illustrate what Unity can do, the cartoon-style of the construction worker is not really appropriate in a professional architectural visualization and his navigation is quite rough. We will illustrate a more extensive solution in one of the next sections and advice you to do this additional effort for more professional results. The default control system and especially the camera control are also not really suitable to allow the user to properly see the environment, which is the primary focus in architectural visualization.</p><p>The FPC is easy <a id="id219" class="indexterm"></a>to set up, is less obtrusive, and provides a<a id="id220" class="indexterm"></a> complete, immersive look on the scene, which puts the user in a visitor's viewpoint. However, to navigate a character by turning the mouse around needs some getting used to, certainly for inexperienced users, as the whole viewpoint is shifted around continuously. Some people even become seasick from such movements. Ensure you inform your user how this works, to avoid any bad experiences.</p><p>The 3PC is our personal favorite, if you replace the character with a more suitable one. Advanced game authors could even write scripts that allow the user to switch between both schemes, if required.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec20"></a>Further tweaking and refining the character controllers</h3></div></div></div><p>Setting up a character controller, be it a FPC or 3PC, is often a matter of balance between semi-realistic and <a id="id221" class="indexterm"></a>idealized navigation. In most cases, the character controllers move faster than in reality and take steeper slopes and higher steps than a normal person would. This is acceptable if you want the visual impression and spatiality of the design to be explored and not get bored by long running and walking times. Most game characters never get tired and can run and jump at all times. They even resurrect after they fall to death.</p><p>
<span class="strong"><strong>Running speed</strong></span>, <span class="strong"><strong>Step size</strong></span>, and <span class="strong"><strong>Maximal Slope Angle</strong></span> are the most important parameters you need to consider. Also take care of setting an adequate <span class="strong"><strong>Collider</strong></span> size for the character controller. While game environments often feature big hallways, wide corridors, and vast terrains, architectural models are usually quite narrow. Doors might even be too small to navigate the character through. Some people re-scale the whole scene a bit, for better navigation. Consider expanding the viewing angle a bit, to show more of the interior.</p><p>A limitation of the default Worker model and the <span class="strong"><strong>Third Person Camera</strong></span>, which steers the camera, is how you look around. Unlike the FPC, you cannot use the mouse to look up or down. To compensate a bit, you could limit the <span class="strong"><strong>Height</strong></span> of the <span class="strong"><strong>Third Person Camera</strong></span> script, to not look down too much, as indicated in following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783559060/graphics/7500EN_04_11.jpg" /></div><p>If you want to provide additional control over the viewpoint using the mouse, you could alternatively use the <span class="strong"><strong>Mouse Orbit</strong></span> script from the <span class="strong"><strong>Scripts</strong></span> package (<span class="strong"><strong>Assets</strong></span> | <span class="strong"><strong>Import Package</strong></span> | <span class="strong"><strong>Scripts</strong></span>). This ensures that mouse movements are used to orbit around a particular target, so <a id="id222" class="indexterm"></a>you can look around freely.</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Create a new camera and attach the <span class="strong"><strong>Mouse Orbit</strong></span> script onto it. Ensure its <span class="strong"><strong>Depth</strong></span> is larger (For example, Depth = 1) than the <span class="strong"><strong>Depth</strong></span> of the <span class="strong"><strong>Main Camera</strong></span>, but don't remove this camera, as the 3PC script still needs it.</p></li><li><p>Set the <span class="strong"><strong>Target</strong></span> parameter by dragging the 3PC onto the parameter value in the <span class="strong"><strong>Inspector</strong></span> tab. This becomes the center for the camera to orbit around.</p></li><li><p>Adjust the <span class="strong"><strong>Distance</strong></span> parameter of the <span class="strong"><strong>Mouse Orbit</strong></span> script to <span class="strong"><strong>2</strong></span> units, so it stays fairly close to the 3PC.</p></li><li><p>Set the <span class="strong"><strong>YMin Limit</strong></span> and <span class="strong"><strong>YMax Limit</strong></span> to <span class="strong"><strong>-20</strong></span> and <span class="strong"><strong>80</strong></span> respectively, which define the range of up and down movements.</p></li></ol></div><p>A second alternative setup is re-using the <span class="strong"><strong>Mouse Look</strong></span> script, which was already loaded from the <span class="strong"><strong>Character Controller</strong></span> package:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Create a new camera and add it as a child of the <span class="strong"><strong>Main Camera</strong></span>, so it follows its movements. Again, ensure <span class="strong"><strong>Depth</strong></span> is set high enough.</p></li><li><p>Attach the <span class="strong"><strong>Mouse Look</strong></span> script to this new camera and set the <span class="strong"><strong>Axes</strong></span> to <span class="strong"><strong>MouseY</strong></span>, so only up-down movements are allowed.</p></li><li><p>You could lower the <span class="strong"><strong>Sensitivity Y</strong></span> to <span class="strong"><strong>5</strong></span>, for slower movements and adjust the <span class="strong"><strong>Minimum Y</strong></span> and <span class="strong"><strong>Maximum Y</strong></span> to, for example, <span class="strong"><strong>-20</strong></span> and <span class="strong"><strong>45</strong></span> respectively to define the range of the movement.</p></li></ol></div><p>Complete out-of-the-box solutions are available in the <span class="strong"><strong>Asset Store</strong></span>, for example, the <span class="strong"><strong>KGFCameraSystem</strong></span>, which presents several camera setups oriented towards architectural and product visualization (<a class="ulink" href="https://www.assetstore.unity3d.com/#/content/6867" target="_blank">https://www.assetstore.unity3d.com/#/content/6867</a>). There is an example, which temporarily orbits the camera around a 3PC while holding the right-mouse button. This is a valid way to combine an automatic camera with orbiting.</p><p>Getting camera behavior <a id="id223" class="indexterm"></a>correct is an important aspect of presenting your design. If not properly used, the 3PC can be an unsatisfying experience for the (casual) user.</p></div></div>