<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch04lvl1sec26"></a>Loading a custom third person character</h2></div></div><hr /></div><p>When you first start using Unity, you might be glad that there is a default character available. The <span class="strong"><strong>Construction Worker</strong></span> model however, is a bit too cartoon-like and probably not generic enough for serious architectural visualization.</p><p>While it is<a id="id224" class="indexterm"></a> possible to model a 3D character in software such as CINEMA 4D or 3ds Max, and animate using the character tools, this subject would easily take a whole book, yet still only touch on the most essential aspects. It is out of the scope of this book, so we will fall back on using stock models.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec21"></a>Using a custom static model</h3></div></div></div><p>If you don't really <a id="id225" class="indexterm"></a>need animations, your first option is to replace the worker model with a mesh of your own, which can be imported from any 3D modeling software.</p><p>Setting up realistic navigational constraints makes sense when you need to evaluate a design for people with limited navigation abilities. If you need to present an elderly care center, or a hospital, or any accessible building, it can be valuable to use a wheelchair simulation. This can be as simple as loading a custom character model, seated in a basic wheelchair and refining the controller movements and constraints. You need to limit the maximal slope angle, the step size height, the navigation speed, and the width of the <span class="strong"><strong>Capsule Collider</strong></span>.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec22"></a>Loading a new character from the Asset Store</h3></div></div></div><p>A good place to look for complete characters that work with Unity is the <span class="strong"><strong>Asset Store</strong></span>. We will load one of <a id="id226" class="indexterm"></a>the (few) free characters into our project and adjust it to<a id="id227" class="indexterm"></a> re-use the default 3PC scripts provided in Unity as follows:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Go to the <span class="strong"><strong>Asset Store</strong></span> and import the free <span class="strong"><strong>Max Adventure Model</strong></span> (<a class="ulink" href="https://www.assetstore.unity3d.com/#/content/3012" target="_blank">https://www.assetstore.unity3d.com/#/content/3012</a>). Max is meant for a game, so he does not wear a business suit, but a backpack and black gloves. When loading animated meshes in a project, they get set up with a <span class="strong"><strong>Skinned Mesh Renderer</strong></span> component, indicating that animations steer the character skeleton and deform the mesh (for example, legs that can bend). The <span class="strong"><strong>Animation</strong></span> component is already loaded with the included animations, such as <span class="strong"><strong>walk</strong></span>, <span class="strong"><strong>jump</strong></span>, and <span class="strong"><strong>idle</strong></span> (standing still, but with small, subtle movements). But apart from playing the default <span class="strong"><strong>Idle</strong></span> <span class="strong"><strong>Animation</strong></span> clip, Max will not walk around when you click on play.</p></li><li><p>Add the <span class="strong"><strong>Character Motor</strong></span> (<span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>Character</strong></span> | <span class="strong"><strong>Character Motor</strong></span>), which adds two components. The <span class="strong"><strong>Character Controller</strong></span> component reacts when <a id="id228" class="indexterm"></a>the arrow keys and space bar are pressed. It also <a id="id229" class="indexterm"></a>has a <span class="strong"><strong>Collider Capsule</strong></span>, which is not linked to a realistic physics simulation, but it calculates collisions to not walk through walls or fall through floors.</p></li><li><p>Adjust the <span class="strong"><strong>Capsule</strong></span> position with the <span class="strong"><strong>Y</strong></span>-value of the <span class="strong"><strong>Center</strong></span> attribute, or Max will probably fall through the floor. The <span class="strong"><strong>Character Motor (Script)</strong></span> is used to react on, for example, moving platforms. However, Max is still not set up yet to walk around.</p><div class="mediaobject"><img src="/graphics/9781783559060/graphics/7500EN_04_05.jpg" /></div></li><li><p>Add the <span class="strong"><strong>Third Person Controller</strong></span> (<span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>Scripts</strong></span> | <span class="strong"><strong>Third Person Controller</strong></span>) where we need to link the correct animations included with the Max model to the different animation clip parameters of the script: <span class="strong"><strong>idle</strong></span>, <span class="strong"><strong>walk</strong></span>, <span class="strong"><strong>run</strong></span>, and <span class="strong"><strong>jump</strong></span> as shown in the following screenshot. The other parameters are for fine-tuning the timing. At this point, you can walk around with Max and he'll move as well. But our camera is standing still.</p><div class="mediaobject"><img src="/graphics/9781783559060/graphics/7500EN_04_06.jpg" /></div></li><li><p>The final <a id="id230" class="indexterm"></a>step is adding the <span class="strong"><strong>Third Person Camera</strong></span> (<span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>Scripts</strong></span> | <span class="strong"><strong>Third Person Camera</strong></span>), so the existing camera (with <span class="strong"><strong>Tag</strong></span>: <span class="strong"><strong>MainCamera</strong></span>) will <a id="id231" class="indexterm"></a>follow him around.</p><div class="mediaobject"><img src="/graphics/9781783559060/graphics/7500EN_04_07.jpg" /></div></li></ol></div><p>There are other models available (free or to buy), but you have to be careful as many characters only work with their own animation files.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch04lvl3sec09"></a>Using Mixamo characters and animations</h4></div></div></div><p>Mixamo is a company, which specializes in animated characters for different software systems. They have a <a id="id232" class="indexterm"></a>complete library of characters and animations that is <a id="id233" class="indexterm"></a>fully integrated with Unity. It is actually a store inside the <span class="strong"><strong>Asset Store</strong></span>. You can browse models and animations and buy them directly from inside Unity. We will illustrate this with a package of free characters and one basic package of everyday movements, which could be all you need in an architectural visualization; that is, unless you want your own variant of Lara Croft who can climb, and jump, and rope swing, but there are packages for that too. The following steps explain how to retrieve a new Mixamo character with related movements from the Asset Store:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Download the freely available <span class="strong"><strong>Male Character Pack</strong></span> from the <span class="strong"><strong>Asset Store</strong></span> (<a class="ulink" href="https://www.assetstore.unity3d.com/#/content/124" target="_blank">https://www.assetstore.unity3d.com/#/content/124</a>), which contains three low-resolution meshes of male figures. There is a similar <code class="literal">Female Character Pack</code> and one with Zombies (!). They do not contain any animations, however.</p></li><li><p>Also download or import the free <span class="strong"><strong>Mixamo Animation Store</strong></span> package (<a class="ulink" href="https://www.assetstore.unity3d.com/#/content/362" target="_blank">https://www.assetstore.unity3d.com/#/content/362</a>). This is used to order new characters or animations. If you look for animations, you won't find a complete set of suitable ones for free, unless you like Zombie walks.</p></li><li><p>We opt for <span class="strong"><strong>$30</strong></span> <span class="strong"><strong>Men's Everyday Motions "Unity4 Ready"</strong></span>, which contains <span class="strong"><strong>Justin</strong></span> (from the free Male Character package), with ten basic animations (<a class="ulink" href="https://www.assetstore.unity3d.com/#/content/129" target="_blank">https://www.assetstore.unity3d.com/#/content/129</a>).</p></li><li><p>This package is compatible with all other Mixamo characters, which is a plus. Their system comes with its own character animation controller system (<span class="strong"><strong>RootMotionController</strong></span>), which works differently to the previous examples. They steer the actual movement based on the animations, which prevents feet from sliding. Especially for the non-professional end user, it becomes easier to mix animations and characters and they look realistic.</p></li><li><p>Load the demo scene, which is set up to have <span class="strong"><strong>Justin</strong></span> walk around using the <span class="emphasis"><em>W</em></span> - <span class="emphasis"><em>A</em></span> - <span class="emphasis"><em>D</em></span> keys and <span class="emphasis"><em>Shift</em></span> to start running. The <span class="emphasis"><em>S</em></span> key is not mapped, though. You can use this setup with the other characters too.</p><div class="mediaobject"><img src="/graphics/9781783559060/graphics/7500EN_04_08.jpg" /></div></li><li><p>Try pressing the different numeric keys (for example, <span class="emphasis"><em>1</em></span>, <span class="emphasis"><em>2</em></span>, <span class="emphasis"><em>3</em></span>, and so on) to see <span class="strong"><strong>Justin</strong></span> laughing, waving, and jogging. Use <span class="emphasis"><em>W</em></span> - <span class="emphasis"><em>A</em></span> - <span class="emphasis"><em>D</em></span> to switch back to regular movements.</p></li></ol></div><p>To recreate this<a id="id234" class="indexterm"></a> setup for your own scenes, carry out the following steps<a id="id235" class="indexterm"></a>:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Add the default <span class="strong"><strong>Character Controlle</strong></span>r component, the <span class="strong"><strong>Root Motion Computer</strong></span> script and the <span class="strong"><strong>Root Motion Character Control</strong></span> script to the top level <span class="strong"><strong>GameObject</strong></span>, called <span class="strong"><strong>Justin</strong></span>.</p></li><li><p>Add all provided animations that are included in the package to the <span class="strong"><strong>Animation</strong></span> component of <span class="strong"><strong>Justin</strong></span>, with the <span class="strong"><strong>Default</strong></span> set to one of the idle animations (for example, <span class="emphasis"><em>weight shift idle</em></span>).</p></li><li><p>Do not forget to add a <span class="strong"><strong>Third Person Camera</strong></span> as well, if you need the camera to follow your character around.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip10"></a>Tip</h3><p>As we preferred to steer this character using arrow keys as well, we altered a few lines inside the provided <code class="literal">RootMotionCharacterControlMENS</code> script. Inside the <code class="literal">Update</code> method, the different animations are prepared and linked to keyboard shortcuts. Unfortunately, as this script is part of the non-free Mixamo package, it cannot be shared, but the changes are minimal. Replace <code class="literal">Input.GetKey(KeyCode.A)</code> with <code class="literal">Input.GetAxis("Horizontal")&gt;0</code>, <code class="literal">Input.GetKey(KeyCode.D)</code> with <code class="literal">Input.GetAxis("Horizontal")&lt;0</code>, <code class="literal">Input.GetKey(KeyCode.W)</code> with <code class="literal">Input.GetAxis("Vertical")&gt;0</code> but skip <code class="literal">Input.GetKeyDown(â€¦)</code>. This way, not only the <span class="emphasis"><em>W</em></span> - <span class="emphasis"><em>A</em></span> - <span class="emphasis"><em>D</em></span> keys are supported, but also the arrows. More information on the <span class="strong"><strong>InputManager</strong></span> and the configuration of the <span class="strong"><strong>Axes</strong></span> can be found on <a class="ulink" href="http://docs.unity3d.com/Documentation/Components/class-InputManager.html" target="_blank">http://docs.unity3d.com/Documentation/Components/class-InputManager.html</a>, where we also learn that, at least for the Desktop applications, these keyboard shortcuts are configurable by the user.</p></div></li></ol></div><p>There are several other animation systems, which can be used to integrate moving characters<a id="id236" class="indexterm"></a> inside Unity, such as 3ds Max, Maya, CINEMA 4D, and Blender. There <a id="id237" class="indexterm"></a>are also some dedicated character animation systems, such as MotionBuilder, Poser, or Animeeple. But as previously mentioned, this is such a huge topic, that you could fill a whole new book with it.</p></div></div></div>