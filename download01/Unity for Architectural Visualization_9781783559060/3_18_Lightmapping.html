<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch03lvl1sec22"></a>Lightmapping</h2></div></div><hr /></div><p>Real-time lighting is <a id="id159" class="indexterm"></a>computationally very expensive. If you don't have the <a id="id160" class="indexterm"></a>latest hardware, it might not even be supported. Or you might avoid it for a mobile app, where hardware resources are limited. It is possible to pre-calculate the lighting of a scene and <span class="emphasis"><em>bake</em></span> it onto the geometry as textures. This process is called <span class="strong"><strong>Lightmapping</strong></span>, for more information on it visit: <a class="ulink" href="http://docs.unity3d.com/Documentation/Manual/Lightmapping.html" target="_blank">http://docs.unity3d.com/Documentation/Manual/Lightmapping.html</a>
</p><p>While actual calculations are rather complex, the process in Unity is made easy, thanks to the integrated <span class="emphasis"><em>Beast Lightmapping</em></span>. There are a few things you need to set up properly. These are given as follows:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>First, ensure that any object that needs to be baked is set to <span class="emphasis"><em>Static</em></span>. Each GameObject has a static-toggle, right next to the <code class="literal">Name</code> property. Activate this for all models and light objects that will not move in the Scene.</p></li><li><p>Secondly, ensure that all geometry has a second set of texture coordinates, called <code class="literal">UV2</code> coordinates in Unity. Default GameObjects have those set up, but for imported models, they usually need to be added. Luckily for us, this is automated when <span class="strong"><strong>Generate Lightmap UVs</strong></span> is activated on the model import settings given earlier in <a class="link" href="#" linkend="ch02">Chapter 2</a>, <span class="emphasis"><em>Quick Walk Around Your Design</em></span>, in the section entitled, <span class="emphasis"><em>Controlling the import settings</em></span>.</p></li><li><p>If all lights and meshes are static and UV2 coordinates are calculated, you are ready to go. Open the <span class="strong"><strong>Lightmapping</strong></span> dialog by navigating to <span class="strong"><strong>Window</strong></span> | <span class="strong"><strong>Lightmapping</strong></span> and dock it somewhere conveniently.</p></li></ol></div><p>There are several settings, but we start with a basic setup<a id="id161" class="indexterm"></a> that consists of the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Usually a <span class="strong"><strong>Single Lightmap</strong></span> suffices. <span class="strong"><strong>Dual Lightmaps</strong></span> can look better, but require the <span class="emphasis"><em>deferred rendering</em></span> method that is only supported in Unity Pro.</p></li><li><p>Choose the <span class="strong"><strong>Quality</strong></span> <span class="strong"><strong>High</strong></span> modus. <span class="strong"><strong>Quality</strong></span> <span class="strong"><strong>Low</strong></span> gives jagged edges and is only used for quick testing.</p></li><li><p>Activate<span class="strong"><strong> Ambient Occlusion</strong></span> as a quick additional rendering step that darkens corners and occluded areas, such as where objects touch. This adds a real sense of depth and is highly recommended. Set both sliders somewhere in the middle and leave the distance at <code class="literal">0.1</code>, to control how far the system will look to detect occlusions.</p></li><li><p>Start with a fairly low <span class="strong"><strong>Resolution</strong></span>, such as <code class="literal">5</code> or <code class="literal">10</code> <span class="strong"><strong>texels per world unit</strong></span>. This defines how detailed the calculated Lightmap texture is, when compared to the geometry. Look at the <span class="strong"><strong>Scene</strong></span> view, to get a checkered overlay visible, when adjusting Lightmapping settings. For final results, increase this to <code class="literal">40</code> or <code class="literal">50</code>, to give more detail to the shadows, at the cost of longer rendering times.</p></li></ol></div><div class="mediaobject"><img src="/graphics/9781783559060/graphics/7500_03_06.jpg" /></div><p>There are additional settings for which Unity Pro is required, such as <span class="strong"><strong>Sky Light</strong></span> and <span class="strong"><strong>Bounced Lighting</strong></span>. They both add to the realism of the lighting, so they are actually highly recommended <a id="id162" class="indexterm"></a>for architectural visualization, if you have the pro-version.</p><p>On the <span class="strong"><strong>Object</strong></span> sub-tab, you can also tweak the shadow calculation settings for individual lights. By increasing the radius, you get a smoother shadow edge, at the cost of longer rendering times. If you increase the <span class="emphasis"><em>radius</em></span>, you should also increase the amount of <span class="emphasis"><em>samples</em></span>, which helps reduce the noise that gets added with sampling. This is shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783559060/graphics/7500_03_07.jpg" /></div><p>Now you can go on and click <span class="strong"><strong>Bake</strong></span> Scene. It can take quite some time for large models and fine resolutions. Check the blue time indicator on the right side of the status bar (but you can continue <a id="id163" class="indexterm"></a>working in Unity). After the calculations are finished, the model is reloaded with the new texture and baked shadows are visible in Scene and Game views, as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783559060/graphics/7500_03_08.jpg" /></div><p>Beware that to bake a Scene, it needs to be saved and given a name, as Unity places the calculated Lightmap textures in a subfolder with the same name as the Scene.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec15"></a>Other lighting techniques</h3></div></div></div><p>You can get pretty far using the default lights and the Lightmapping technique. But there is more to get convincing or downright spectacular lighting in Unity. While many of these techniques rely on a Unity Pro license, sometimes you can fake these if you understand what <a id="id164" class="indexterm"></a>the effect is trying to achieve.</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>It is possible to have a material emit light, if you use a self-illuminated shader (<span class="strong"><strong>Self-Illumin/Diffuse</strong></span>). While the material in itself seems to glow and you could add a <span class="emphasis"><em>Halo</em></span> component to increase the effect, only Unity Pro will take their actual light into account when Lightmapping. To partially fake this effect in Unity Free, combine a self-illuminated material with one or more spotlights positioned in the same place and which emit a matching color.</p></li><li style="list-style-type: disc"><p>While Unity Pro has a <span class="strong"><strong>Skylight</strong></span> option in the <span class="strong"><strong>Lightmapping</strong></span> dialog, you can fake environmental lighting by adding some additional, bluish Directional lights in opposite directions around the model. Turn down their brightness and add soft shadows with a 15-degree shadow radius and about 12 samples. These lights brighten up dark shadows with a blueish-cool tint, mimicking the effect of the ambient light that gets scattered from the sky. Try to avoid dark-black shadows, unless you model a Moon scene.</p></li><li style="list-style-type: disc"><p>Using a <span class="emphasis"><em>Light projector</em></span>, like we did for the Blob Shadow, we can also project any image onto the scene. This can simulate the effect of light shining through tinted glass windows or piercing through a silk screen.</p></li></ul></div><p>If you have a pro-license, there is also a series of <span class="emphasis"><em>Fullscreen Image Effects</em></span> that you can add to the Camera. They help to give your scenes a more polished effect and since they run mostly on the GPU, they<a id="id165" class="indexterm"></a> don't slow down the scene too much. The following effects are recommended:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>
<span class="strong"><strong>Anti-aliasing</strong></span>: It<a id="id166" class="indexterm"></a> increases the apparent resolution by <a id="id167" class="indexterm"></a>smoothing edges.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Bloom</strong></span> and <span class="strong"><strong>Lens Flares</strong></span>: Bloom adds a white, dreamlike glow, whereas the lens flares present a dramatic accent to the main light source. These effects are automatically generated in a highly efficient way<a id="id168" class="indexterm"></a> <a id="id169" class="indexterm"></a>(if you promise not to overdo it!).</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Color Correction</strong></span> and <span class="strong"><strong>Tonemapping</strong></span>: It <a id="id170" class="indexterm"></a>is used<a id="id171" class="indexterm"></a> for<a id="id172" class="indexterm"></a> color <a id="id173" class="indexterm"></a>balancing, which is useful to avoid a cheap, artificial color palette.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Screen Space Ambient Occlusion</strong></span> (<span class="strong"><strong>SSAO</strong></span>): It is used to mimic the effect of small <a id="id174" class="indexterm"></a>occlusions an inter-object <a id="id175" class="indexterm"></a>shadows, which increases the realism of the scene and accentuates the volumetric properties of objects.</p></li></ul></div><p>More<a id="id176" class="indexterm"></a> info <a id="id177" class="indexterm"></a>is available at: <a class="ulink" href="http://docs.unity3d.com/Documentation/Components/comp-ImageEffects.html" target="_blank">http://docs.unity3d.com/Documentation/Components/comp-ImageEffects.html</a>
</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec16"></a>Browsing the Asset Store</h3></div></div></div><p>While Unity includes a few packages with additional assets (scripts, models, textures and so on), there is a fully<a id="id178" class="indexterm"></a> integrated store for assets, called the <span class="strong"><strong>Asset Store</strong></span>. It is a continuously growing store of Unity-specific content, ranging from single models or <a id="id179" class="indexterm"></a>textures, to complete projects, but also extensions of the Unity software itself. Prices vary, but considering the effort of creating good and re-usable assets, they are very reasonable (sometimes even free) and can be real timesavers.</p><p>You can browse the <span class="strong"><strong>Asset Store</strong></span> online (<a class="ulink" href="https://www.assetstore.unity3d.com" target="_blank">https://www.assetstore.unity3d.com</a>) or inside the <a id="id180" class="indexterm"></a>Unity GUI, through the <span class="strong"><strong>Asset Store</strong></span> tab by navigating to <span class="strong"><strong>Window</strong></span> | <span class="strong"><strong>Asset Store</strong></span>. You need to register with Unity to be able to download packages from the <span class="strong"><strong>Asset Store</strong></span>. Downloaded assets are stored locally on your machine and you can import them in other projects too. Be sure to read the documentation per package, as there may be some particular constraints or license limitations.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch03lvl3sec08"></a>Lightmapping packages in the Asset Store</h4></div></div></div><p>If you want to take the<a id="id181" class="indexterm"></a> Lightmapping process a bit further, the following are some additional tools in the <span class="strong"><strong>Asset Store</strong></span> you might wish to try out:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>
<span class="emphasis"><em>Lightmap Manager Lite</em></span> is a free extension which gives more control over the Lightmapping<a id="id182" class="indexterm"></a> process, including resizing and even<a id="id183" class="indexterm"></a> blending Lightmaps, available at <a class="ulink" href="https://www.assetstore.unity3d.com/#/content/342" target="_blank">https://www.assetstore.unity3d.com/#/content/342</a>.</p></li><li style="list-style-type: disc"><p>
<span class="emphasis"><em>Lightmapping Extended</em></span>
<a id="id184" class="indexterm"></a> is another free extension that enables all <span class="emphasis"><em>Beast</em></span> Lightmapping settings and provides advanced <a id="id185" class="indexterm"></a>configuration, available at <a class="ulink" href="https://www.assetstore.unity3d.com/#/content/6071" target="_blank">https://www.assetstore.unity3d.com/#/content/6071</a>.</p></li><li style="list-style-type: disc"><p>The <span class="emphasis"><em>LHGS Lighting System</em></span>
<a id="id186" class="indexterm"></a> is not free but it adds an<a id="id187" class="indexterm"></a> additional rendering calculation to Unity, which can improve lighting and especially the ambient occlusion quality. This also works in Unity Free, available at <a class="ulink" href="http://forum.unity3d.com/threads/182422-LHGS-Lighting-System-for-Unity-Indie?p=1246629" target="_blank">http://forum.unity3d.com/threads/182422-LHGS-Lighting-System-for-Unity-Indie?p=1246629</a> and can be purchased from: <a class="ulink" href="https://www.assetstore.unity3d.com/#/content/8683" target="_blank">https://www.assetstore.unity3d.com/#/content/8683</a>
</p></li></ul></div></div></div></div>