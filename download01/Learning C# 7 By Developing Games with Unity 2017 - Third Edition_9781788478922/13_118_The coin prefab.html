<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch13lvl1sec113"></a>The coin prefab</h2></div></div><hr /></div><p>To make things a little easier, we have already prepared the visual part of our coin. Download <code class="literal">Coin.unitypackage</code> and import it into your project.</p><p>Now we drag the <strong class="userinput"><code>Coin</code></strong> prefab into the <strong class="userinput"><code>Hierarchy</code></strong> view so that we can take a look at it:</p><div class="mediaobject"><img src="/graphics/9781788478922/graphics/513554c1-8d1f-4165-8e29-3e16ecb40216.png" /></div><p>To create this coin prefab, we have created an empty <code class="literal">GameObject</code> and added a <strong class="userinput"><code>Sprite</code></strong><code class="literal">Renderer</code> to it. In the <code class="literal">Sprite</code> option we have linked it with the coin sprite, as you can see here:</p><div class="mediaobject"><img src="/graphics/9781788478922/graphics/f0736e69-3934-41df-a962-f1bc4db7e96a.png" /></div><p>Then we have created a simple animation controlled by the <code class="literal">Animator</code> with the coin sequence, which gives the sensation that the coin is spinning. To do that, all we <span>need</span> is to open the <strong class="userinput"><code>Animation </code></strong>tab (pictured here) that is located under the <strong class="userinput"><code>Window</code></strong>:</p><div class="mediaobject"><img src="/graphics/9781788478922/graphics/42573824-8d8f-43db-9cc8-465a34698d20.png" /></div><p>Then we need to click <strong class="userinput"><code>Create;</code></strong> it will ask us what name we want to assign to that animation and where we want to save it. After that, we notice that the <strong class="userinput"><code>Animation</code></strong> panel now has changed a little bit, this means that we are ready to add some elements to animate:</p><div class="mediaobject"><img src="/graphics/9781788478922/graphics/42efab1f-760d-43f5-8ebc-db9639aec479.png" /></div><p>Now all we need to do is drag and drop the sprites that we want to animate one by one, making sure that we put them in order and ideally one sprite per frame, similar to what we have in the coin prefab:</p><div class="mediaobject"><img src="/graphics/9781788478922/graphics/c7948b78-daf8-4342-b83d-998e8f736d5d.png" /></div><p>Now that we know how to create a simple 2D animation inside Unity, let's continue with the coin prefab.</p><p>Most collectables react with the environment through the physics of the game. We can use the 2D trigger here to react with the <code class="literal">Player</code> Game Object's <code class="literal">Rigidbody2D</code> component. This is exactly the same way we inserted <code class="literal">LeaveTriggers</code> into the game previously.</p><p>Select the coin and add the <code class="literal">CircleCollider2D</code> component. A green circle will appear around the coin, representing the triggering area. Make sure you tweak the radius value to roughly match the size of the coin. In my case, a value of 0.35 works great.</p><p>Another requirement that we need to fulfill to make the trigger work is ticking the <code class="literal">IsTrigger</code> checkbox, and our coin is ready to process trigger events. All that we need to do now is write some code to manage its behavior.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch13lvl2sec69"></a>The Collectable class</h3></div></div></div><p>Let's plan what behavior we want from our collectable. We will need the following methods:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><code class="literal">Show()</code>: This will show the coin and activate its collider</li><li style="list-style-type: disc"><code class="literal">Hide()</code>: This will hide the coin and deactivate its collider</li><li style="list-style-type: disc"><code class="literal">Collect()</code>: This is called at the moment of collection of the coin</li><li style="list-style-type: disc"><code class="literal">OnTriggerEnter2D</code>(Collider2D other): This is called by Unity's physics system when the collider enters our coin's trigger</li></ul></div><p>Create a new C# script, call it <code class="literal">Collectable</code>, and write the following <span>code</span>:</p><div class="mediaobject"><img src="/graphics/9781788478922/graphics/c2d4f1a2-24be-4886-b490-f0fe183c636e.png" /></div><p>Add the <code class="literal">Collectable</code> script to your <code class="literal">coin</code> prefab. We are ready to test it now! Make the <code class="literal">coin</code> prefab a child of one of the level chunks. Create a few copies of the coin next to each other so that you can test them better.</p><p>Let's click <strong class="userinput"><code>Play</code></strong> in Unity and see what happens. You should notice that the coin disappears upon contact with the <code class="literal">Player</code> game object. That's exactly what we wanted.</p><p>The last thing to do now is count the collected coins. We will store the number of coins collected in the <code class="literal">GameManager</code> class and increment the <code class="literal">int</code> number every time a coin is collected. Let's add some functionality to the <code class="literal">GameManager</code> class:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Add the <code class="literal">collectedCoins</code> public member:</li></ol></div><pre class="programlisting">   public int collectedCoins = 0; </pre><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Add a <code class="literal">public</code> method that you can call when a coin is collected:</li></ol></div><pre class="programlisting">public void CollectedCoin() { 
  collectedCoins ++; 
} </pre><p>What this method does is increment the <code class="literal">collectedCoins</code> variable by <code class="literal">1</code> every time the <code class="literal">++</code> operator is used.</p><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>In the <code class="literal">Collectable</code> class, add a single line calling <code class="literal">CollectedCoin()</code> from the <code class="literal">Collect</code> method, as <span>follows</span>:</li></ol></div><div class="mediaobject"><img src="/graphics/9781788478922/graphics/1e8e7ecf-efc2-4d9e-a860-a9568bf79b55.png" /></div><p>Now click <strong class="userinput"><code>Play</code></strong> in Unity. Let's take a quick look to check whether it works. Select <strong class="userinput"><code>GameManager</code></strong> and press the <strong class="userinput"><code>Play</code></strong> button. You will notice that the number of collected coins in the Unity <strong class="userinput"><code>Inspector</code></strong> increases every time a new coin is collected. Great! We now know that our <code class="literal">collectedCoin</code> variable works. However, we still need to update the label value in the <code class="literal">gameView</code> so that our user can see exactly how many coins they have collected.</p><p>It's a good idea to keep UI–controlling code separate from the <code class="literal">GameManager</code>. Let's write a short script that controls the UI in the <span class="strong"><strong>Game View</strong></span>. Create and add this component to the <code class="literal">InGameCanvas</code> game <span>object</span>:</p><div class="mediaobject"><img src="/graphics/9781788478922/graphics/5a10fb53-30b7-43e8-9c5e-23315e41cb32.png" /></div><p>Once you have the <strong class="userinput"><code>View In Game</code></strong> component added, drag the <code class="literal">coinLabel</code> game object into the <strong class="userinput"><code>coinsLabel</code></strong><span>slot</span>:</p><div class="mediaobject"><img src="/graphics/9781788478922/graphics/6def3a14-ecd1-4df3-9adc-d3cf731ac76b.png" /></div><p>The <strong class="userinput"><code>View In Game </code></strong>component should look like <span>this</span>:</p><div class="mediaobject"><img src="/graphics/9781788478922/graphics/fd8e67a6-15ba-486a-bae9-f5b1a7c38645.png" /></div><p>What our code does is update the <code class="literal">.text</code> string value on the label. By doing this, the text on the UI changes and is always up-to-date with the <code class="literal">collectedCoins</code> value in <strong class="userinput"><code>Game Manager</code></strong>.</p></div></div>