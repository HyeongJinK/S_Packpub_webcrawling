<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch14lvl1sec120"></a>Movement</h2></div></div><hr /></div><p>The first thing on our list that we have chosen to work on is the movement. The lesson that we'll cover on this topic can be used both on enemies and on movable obstacles, so it's very useful.</p><p>There are a few ways to make enemies move and, probably like the rest of the lessons that we have learned so far, we'll eventually adapt and find our own way of creating things, so it adjusts perfectly with what we want. In this chapter, we'll take a look at three ways to make the enemies move.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch14lvl2sec70"></a>Movement by animation</h3></div></div></div><p>This is probably the simplest approach to make a character or obstacle move, although it's still very useful and practical if we don't need a complex movement system.</p><p>In the previous chapter, we created a sprite animation for the coin where we added a different sprite for each frame of the animation and, at the end, we saw the coin spinning. Well, here we'll be using the same animation tab, where it contains a timeline, but the way we create the animation will be completely different:</p><div class="mediaobject"><img src="/graphics/9781788478922/graphics/6ebc3bb2-a2f8-41e8-b456-cffa378b014d.png" /></div><p>Let's start by selecting the object that we want to animate. For this example, we have chosen a piece of the floor sprite, to create a moveable platform, but remember this can also be applied to an enemy character. To do this, let's create an empty <code class="literal">GameObject</code>, name it <strong class="userinput"><code>Platform</code></strong>, and then simply drag and drop the <strong class="userinput"><code>Floor</code></strong> prefab inside the <code class="literal">GameObject</code> that we just created. It should look like this:</p><div class="mediaobject"><img src="/graphics/9781788478922/graphics/81ab2abe-2442-4e91-90cd-504d0cf2fb41.png" /></div><p>If we want the platform to be bigger or smaller, this is the perfect time to change it. Then, select the <strong class="userinput"><code>Platform</code></strong><code class="literal">GameObject</code> (not the <strong class="userinput"><code>Floor</code></strong><code class="literal">prefab</code>), open the <span class="strong"><strong>Animation</strong></span> tab, and click the button that says <strong class="userinput"><code>Create</code></strong>:</p><div class="mediaobject"><img src="/graphics/9781788478922/graphics/b32e2cf2-6df9-49bc-8393-536cae75440a.png" /></div><p>It will ask you the name and where you want to save the animation. Place it inside the animations folder and name it <code class="literal">Platform</code>:</p><div class="mediaobject"><img src="/graphics/9781788478922/graphics/bcb78e5e-a9c3-45db-acf9-a59b34bb7684.png" /></div><p>Now we need to click the <strong class="userinput"><code>Add Property</code></strong> button &gt; <strong class="userinput"><code>Transform</code></strong> &gt; <strong class="userinput"><code>Position</code></strong>:</p><div class="mediaobject"><img src="/graphics/9781788478922/graphics/0ef89d01-c61d-4843-aeac-2fd4b8832b60.png" /></div><p>What does this do? It allows us to animate the <strong class="userinput"><code>Transform</code></strong> position of the <span class="strong"><strong>object</strong></span> or <span class="strong"><strong>character</strong></span> that we want to animate and that is exactly what we need to do in order to make our platform move from side to side.</p><p>Let's click the red circle that represents the record button:</p><div class="mediaobject"><img src="/graphics/9781788478922/graphics/eb71249d-7e91-413c-8d1a-b6415010c98f.png" /></div><p>We need to click this button before we start animating; doing this will start recording all the changes that we make on the object.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip37"></a>Note</h3><p>Put the <strong class="userinput"><code>Animation </code></strong>window in a different tab than the <strong class="userinput"><code>Scene</code></strong> window–that way we can animate directly on the <strong class="userinput"><code>Scene</code></strong> window and see the changes being made on the <strong class="userinput"><code>Animation</code></strong> timeline.</p></div><p>On the timeline, go to the 1:00 second, where we already have an automatic keyframe created:</p><div class="mediaobject"><img src="/graphics/9781788478922/graphics/9ed95a10-22c2-4fbf-b3d1-db5079eca817.png" /></div><p>Then click the <code class="literal">Platform</code> and move it a little bit to the right:</p><div class="mediaobject"><img src="/graphics/9781788478922/graphics/8db84c49-606a-48f1-9945-eb109e91f263.jpg" /></div><p>Now let's click the <strong class="userinput"><code>Record</code></strong> button again and test the animation that we have just created by clicking the <strong class="userinput"><code>Play</code></strong> button. As we can see, we already have an object that moves from left to right. Before using this platform, we need to make it loop so the animation looks seamless. To do this, we simply need to copy the first frame and paste on the 2:00 second, that way it will go from left to right and then from right to left again.</p><p>Select the first frame, copy it by using <span class="emphasis"><em>Ctrl </em></span>+ <span class="emphasis"><em>C</em></span> or <span class="emphasis"><em>Command </em></span>+ <span class="emphasis"><em>C</em></span> (we cannot do it with the right mouse click), move to the frame on the 2:00 second, and paste it with <span class="emphasis"><em>Ctrl </em></span>+ <span class="emphasis"><em>V</em></span> or <span class="emphasis"><em>Command </em></span>+ <span class="emphasis"><em>V</em></span>, it should look like this:</p><div class="mediaobject"><img src="/graphics/9781788478922/graphics/9ce13f59-80c7-41f7-9516-5cf6799289d8.png" /></div><p>That's it, we have a perfect animation loop created and our platform is ready to be used. Save it as a prefab by dragging and dropping <code class="literal">Platform GameObject</code> into the prefab folder.</p><p>Once that's done, we can create new <code class="literal">LevelPieces</code> and add the <code class="literal">Platform</code> prefab onto them.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch14lvl2sec71"></a>Trigger movement</h3></div></div></div><p>Another type of movement that we can implement on our enemies or platforms is the trigger movement. This is also a basic way to create movement, where the enemy or platform is moving in one direction until it collides against something and then returns back. We can see this on multiple games, especially 2D platforms.</p><div class="mediaobject"><img src="/graphics/9781788478922/graphics/86c9cc53-f5fd-489b-80ea-233fcf7096fa.jpg" /></div><p>As we can see in the preceding image, the green circle represents the enemy and the red arrow represents the trigger distance. When the trigger touches the wall, the enemy turns around and moves in the opposite direction.</p><p>When should we use this method instead of the animation one? Using the animation movement, we are setting the distance limit, the enemy or platform won't move differently no matter where it is placed. On the other hand, by using the trigger method, the distance traveled is dynamic.</p><p>This example doesn't necessarily fit into our game, as we don't have any walls yet, but it is still relevant to explain how to do it, so we have to know how to implement it in the future. The simple way to do this is by creating an empty object, name it <code class="literal">TriggerMovement</code>, for example, and drag and drop it inside the enemy/platform:</p><div class="mediaobject"><img src="/graphics/9781788478922/graphics/a0593f8f-90e9-4a59-b628-501f2a83a778.png" /></div><p>Then we make sure that the transform position of the <code class="literal">TriggerMovement</code> is set to zero:</p><p>&gt;</p><div class="mediaobject"><img src="/graphics/9781788478922/graphics/0a912274-afba-4c67-8e35-c64a99181a2b.png" /></div><p>Now we add a new Box Collider 2D component to the <code class="literal">TriggerMovement</code>. We have to place the <code class="literal">TriggerMovement</code> object in front of our enemy, we should place it within the distance that we want the enemy to turn around when the trigger touches something:</p><div class="mediaobject"><img src="/graphics/9781788478922/graphics/ae7518cf-55b8-498d-ba7d-2816f1d70ce3.png" /></div><p>For example, if this was the evil twin of our main character and we made it an enemy of the game, we would place the <code class="literal">TriggerMovement</code> object slightly in front of the character. This way, the character itself doesn't need to necessarily touch the wall before turning around.</p><p>Then we could simply add a script to our <code class="literal">TriggerMovement</code> object that informs the character that he is near a wall, so he can turn around and move in the opposite direction until he hits another wall again.</p><p>To create this enemy, we have used <code class="literal">PlayerController</code> as a template script, then we changed a few things so that the player can't control this character:</p><div class="mediaobject"><img src="/graphics/9781788478922/graphics/091bafe4-1747-40a0-aea4-dbdf56eb1022.png" /></div><p>So with this script, our character will simply run forward all the time. To make it turn around and run in the opposite direction, we need to link <code class="literal">TriggerMovement</code> with this character. We can see on line <strong class="userinput"><code>13</code></strong> that we have already created a public static bool with the name <code class="literal">turnAround</code>. This will allow scripts that are assigned to other objects to send information into this script.</p><p>Now let's create a new script that will be added to the <code class="literal">TriggerMovement</code> object. We can name it <code class="literal">triggerMovement</code>, that way we know that this script belongs to the <code class="literal">TriggerMovement</code> object:</p><div class="mediaobject"><img src="/graphics/9781788478922/graphics/18ac6967-4df9-4ea8-a1f5-51b6796e5002.png" /></div><p>And this is all we need to write inside the <code class="literal">triggerMovement</code> script. It checks whether the object has collided against anything and if it has, it gives the information to the enemy to turn around. If it is moving forward, it will turn around and move backward, if it is moving backward, it will turn around and move forward.</p><p>Now, all we need to do is to open the <code class="literal">Enemy</code> script and use this information to make the character change the move direction:</p><div class="mediaobject"><img src="/graphics/9781788478922/graphics/6a508644-1795-4066-9982-588e195d7488.png" /></div><p>As we can see on line <strong class="userinput"><code>19</code></strong>, we define that at the start of the game, the character, by default, should move forward, so the <code class="literal">turnAround</code> bool is set to false. This is necessary when dealing with <code class="literal">static variables</code> because even if we restart the game, the script will remember the last value and if we don't state the value that we want at the start of the script, the value assigned will be the last one.</p><p>Then starting on line <strong class="userinput"><code>30</code></strong> to line <strong class="userinput"><code>38</code></strong>, we explain what happens to the character when the <code class="literal">turnAround</code> variable is set to true or false. In this case, the character will flip to the other direction, soon the <code class="literal">triggerMovement</code> gives the information that it has touched something.</p><p>To achieve the flip effect, we have used the <code class="literal">transform.eulerAngles</code>. For example, when the <code class="literal">turnAround</code> variable is set to true, the character uses <code class="literal">transform.eulerAngles</code> to set the <span class="emphasis"><em>y</em></span> rotation axis to 180 degrees, which means that we'll be facing the opposite direction and when we set that value to 0 degrees, it will face forward.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch14lvl2sec72"></a>Making it an enemy</h3></div></div></div><p>Now that we have the enemy moving inside our game, we need to set it as an Enemy, so the player dies when touching him. This is fairly simple to do, all we need is to create a new tag for the <code class="literal">Enemy</code> prefab and call it <span class="strong"><strong>Enemy</strong></span> as well. To do this, click <strong class="userinput"><code>Tag</code></strong> and then click <strong class="userinput"><code>Add Tag</code></strong><span class="strong"><strong>:</strong></span></p><div class="mediaobject"><img src="/graphics/9781788478922/graphics/ca497720-67ed-4fe2-a636-31fc5341ce14.png" /></div><p>Then click the <strong class="userinput"><code>plus</code></strong> sign:</p><div class="mediaobject"><img src="/graphics/9781788478922/graphics/6fb7bef6-303d-4921-8846-50466b87c00a.png" /></div><p>Name the Tag as <code class="literal">Enemy</code>, save the prefab, and that's it. Now let's open the <code class="literal">PlayerController</code> script and add this line of code:</p><div class="mediaobject"><img src="/graphics/9781788478922/graphics/f7be43e4-6f19-4325-aa17-333cd8231a59.png" /></div><p>That's it; now if our character touches an enemy, it will die.</p></div></div>