<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch04lvl1sec49"></a>Random matchmaking</h2></div></div><hr /></div><p>It's also possible to employ a form of <a id="id208" class="indexterm"></a>random matchmaking.<a id="id209" class="indexterm"></a> That is, by supplying the special room ID "$service-room$" to <code class="literal">CreateJoinRoom</code>, you will connect the user to so called "Service Rooms". A service room<a id="id210" class="indexterm"></a> is a room with a randomly created ID, and a new room will only be created when the existing service rooms are all filled up to 75 percent (this gives some leeway to move users between rooms). By using <code class="literal">CreateJoinRoom</code>, the client will create a room if it doesn't exist, or join the existing one if it does.</p><div class="informalexample"><pre class="programlisting">void OnGUI()
{
  if( roomConnection != null )
    return;

<span class="strong"><strong>  if( GUILayout.Button( "Join Random", GUILayout.Width( 200f ) ) )</strong></span>
<span class="strong"><strong>  {</strong></span>
<span class="strong"><strong>    client.Multiplayer.CreateJoinRoom( "$service-room$", "MyCode", true, null, null,</strong></span>
<span class="strong"><strong>      delegate( Connection connection )</strong></span>
<span class="strong"><strong>      {</strong></span>
<span class="strong"><strong>        Debug.Log( "Joining room" );</strong></span>
<span class="strong"><strong>        roomConnection = connection;</strong></span>
<span class="strong"><strong>      },</strong></span>
<span class="strong"><strong>      delegate( PlayerIOError error )</strong></span>
<span class="strong"><strong>      {</strong></span>
<span class="strong"><strong>        Debug.Log( error.Message );</strong></span>
<span class="strong"><strong>      } );</strong></span>
<span class="strong"><strong>  }</strong></span>

  if( GUILayout.Button( "Create Room", GUILayout.Width( 200f ) ) )
  {
    client.Multiplayer.CreateRoom( null, "MyCode", true, null,
      delegate( string roomID )
      {
        Debug.Log( "Room created" );
        client.Multiplayer.JoinRoom( roomID, null,
          delegate( Connection connection )
          {
            Debug.Log( "Connected to room!" );
            roomConnection = connection;
          },
          delegate( PlayerIOError error )
          {
            Debug.Log( error.Message );
          } );
      },
      delegate( PlayerIOError error )
      {
        Debug.Log( error.Message );
      } );
  }

  if( rooms == null )
    return;

  foreach( RoomInfo room in rooms )
  {
    if( GUILayout.Button( room.Id, GUILayout.Width( 200f ) ) )
    {
      client.Multiplayer.JoinRoom( room.Id, null,
        delegate( Connection connection )
        {
          Debug.Log( "Connected to room!" );
          roomConnection = connection;
        },
        delegate( PlayerIOError error )
        {
          Debug.Log( error.Message );
        } );
    }
  }
}</pre></div></div>