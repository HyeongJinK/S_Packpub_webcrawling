<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch02lvl1sec17"></a>Scrolling textures by modifying UV values</h2></div></div><hr /></div><p>One of the most common <a id="id71" class="indexterm"></a>texture techniques used in today's <a id="id72" class="indexterm"></a>game industry is the process of allowing you to scroll their textures over the surface of an object. This allows you to create effects such as waterfalls, rivers, lava flows, and so on. It's also a technique that is the basis for creating animated sprite effects, but we will cover that in a subsequent recipe of this chapter. Let's first see how we will create a simple scrolling effect inside of a Surface Shader.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec30"></a>Getting ready</h3></div></div></div><p>To begin this recipe, you will need to create a new Shader file and a new Material. This will set us up with a nice clean Shader that we can use to study the scrolling effect by itself.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec31"></a>How to do it…</h3></div></div></div><p>To begin with, we will launch our new Shader file that we just created, and enter the code mentioned in the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>The Shader will need two new properties that will allow us to control the speed of the texture scrolling. So let's add a speed property for the <span class="emphasis"><em>X</em></span> direction and a speed property for the <span class="emphasis"><em>Y</em></span> direction, as shown in the following code:</p><div class="mediaobject"><img src="/graphics/9781849695084/graphics/5084_02_01.jpg" /></div></li><li><p>Modify <a id="id73" class="indexterm"></a>the Cg properties<a id="id74" class="indexterm"></a> in the <code class="literal">CGPROGRAM</code> section and create new variables so that we can access the values from our properties:</p><div class="mediaobject"><img src="/graphics/9781849695084/graphics/5084_02_02.jpg" /></div></li><li><p>Modify the surface function to change the UVs being given to the<a id="id75" class="indexterm"></a> <code class="literal">tex2D()</code>
<span class="strong"><strong> </strong></span>function. Then use the built-in <code class="literal">_Time</code> variable to animate the UVs over time when <span class="strong"><strong>Play</strong></span> is pressed in the editor:</p><div class="mediaobject"><img src="/graphics/9781849695084/graphics/5084_02_03.jpg" /></div></li></ol></div><p>The following<a id="id76" class="indexterm"></a> image demonstrates the result of <a id="id77" class="indexterm"></a>utilizing the scrolling UV system to create a simple river motion for your environments. It's hard to show something moving in a book, so you'll have to take my word for it.</p><div class="mediaobject"><img src="/graphics/9781849695084/graphics/5084_02_05.jpg" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec32"></a>How it works…</h3></div></div></div><p>The scrolling <a id="id78" class="indexterm"></a>system starts with the declaration<a id="id79" class="indexterm"></a> of a couple of properties, which will allow the user of this Shader to increase or decrease the speed of the scrolling effect itself. At their core they are float values being passed from the Material's <span class="strong"><strong>Inspector</strong></span> tab to the surface function of the Shader. For more information on Shader properties, see <a class="link" href="#" linkend="ch01">Chapter 1</a>, <span class="emphasis"><em>Diffuse Shading</em></span>.</p><p>Once we have those float values from the Material's <span class="strong"><strong>Inspector</strong></span> tab, we can use them to offset our UV values in the Shader.</p><p>To begin that process we first store the UVs in a separate variable called <code class="literal">scrolledUV</code>. This variable has to be a <code class="literal">float2 / fixed2</code> because the UV values are being passed to us from the <code class="literal">Input</code> structure:</p><div class="mediaobject"><img src="/graphics/9781849695084/graphics/5084_02_04.jpg" /></div><p>Once we have access to the mesh's UVs, we can offset them using our scroll speed variables and the built-in <code class="literal">_Time</code> variable. This built-in variable returns a variable of type <code class="literal">float4</code>, meaning that each component of that variable contains different values of time, as it pertains to game time. A complete description of these individual time values are described at the following link:</p><p>
<a class="ulink" href="http://docs.unity3d.com/Documentation/Components/SL-BuiltinValues.html" target="_blank">http://docs.unity3d.com/Documentation/Components/SL-BuiltinValues.html</a>
</p><p>This <code class="literal">_Time</code> variable will give us an incremented float value based on Unity's game time clock. So, we can use that value to move our UVs in a UV direction and scale that time with our scroll speed variables:</p><div class="mediaobject"><img src="/graphics/9781849695084/graphics/5084_02_06.jpg" /></div><p>With the <a id="id80" class="indexterm"></a>correct offset being calculated <a id="id81" class="indexterm"></a>by time, we can add the new offset value back to the original UV position. This is why we are using the <code class="literal">+=</code> operator in the next line. We want to take the original UV position, add on the new offset value, and then pass that to the <code class="literal">tex2D()</code> function<a id="id82" class="indexterm"></a> as the texture's new UVs. This creates the effect of the texture moving on the surface. We are really manipulating the UVs so we are faking the effect of the texture moving.</p><div class="mediaobject"><img src="/graphics/9781849695084/graphics/5084_02_07.jpg" /></div></div></div>