<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch01lvl1sec11"></a>Using properties in a Surface Shader</h2></div></div><hr /></div><p>Now that we <a id="id28" class="indexterm"></a>have created some properties, let's actually hook <a id="id29" class="indexterm"></a>them up to the Shader so we can use them as tweaks to our Shader and make the material process much more interactive.</p><p>We can use the properties' values from the Material's <span class="strong"><strong>Inspector</strong></span> tab because we have attached a variable name to the property itself, but in the Shader code you have to set a couple things up before you can start calling the value by its variable name.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec15"></a>How to do it…</h3></div></div></div><p>The following steps show you how to use the properties in a Surface Shader:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>To begin, let's remove the following lines of code, as we deleted the property called <span class="strong"><strong>MainTex</strong></span> in the <span class="emphasis"><em>Creating a basic Surface Shader</em></span> recipe of this chapter:</p><div class="informalexample"><pre class="programlisting">sampler2D _MainTex;
half4 c = tex2D (_MainTex, IN.uv_MainTex);</pre></div></li><li><p>Next, add the following lines of code to the Shader, below the <code class="literal">CGPROGRAM</code> line:</p><div class="informalexample"><pre class="programlisting">    float4 _EmissiveColor;
    float4 _AmbientColor;
    float _MySliderValue;</pre></div></li><li><p>With step 2 complete, we can now use the values from the properties in our Shader. Let's do this by adding the value from the <code class="literal">_EmissiveColor</code> property to the <code class="literal">_AmbientColor</code> property, and giving the result of that to the <code class="literal">o.Albedo</code> line of code. So, let's add the following code to the Shader inside the <code class="literal">surf</code> function:</p><div class="informalexample"><pre class="programlisting">  void surf (Input IN, inout SurfaceOutput o) 
  {
    float4 c;
    c =  pow((_EmissiveColor + _AmbientColor),  _MySliderValue);

    o.Albedo = c.rgb;
    o.Alpha = c.a;
  }</pre></div></li><li><p>Finally, your <a id="id30" class="indexterm"></a>Shader should look like the following <a id="id31" class="indexterm"></a>Shader code. If you save your Shader in MonoDevelop and re-enter Unity, your Shader will compile. If there were no errors, you will now have the ability to change the ambient and emissive colors of the Material, as well as increase the saturation of the final color by using the slider value. Pretty neat, huh!</p><div class="informalexample"><pre class="programlisting">Shader "CookbookShaders/BasicDiffuse" 
{
  //We define Properties in the properties block
  Properties 
  {
    _EmissiveColor ("Emissive Color", Color) = (1,1,1,1)
    _AmbientColor  ("Ambient Color", Color) = (1,1,1,1)
    _MySliderValue ("This is a Slider", Range(0,10)) = 2.5
  }

  SubShader 
  {
    Tags { "RenderType"="Opaque" }
    LOD 200

    CGPROGRAM
    #pragma surface surf Lambert


//We need to declare the properties variable type inside of the CGPROGRAM so we can access its value from the properties block.
    float4 _EmissiveColor;
    float4 _AmbientColor;
    float _MySliderValue;

    struct Input 
    {
      float2 uv_MainTex;
    };

    void surf (Input IN, inout SurfaceOutput o) 
    {
      //We can then use the properties values in our shader 
      float4 c;
      c =  pow((_EmissiveColor + _AmbientColor), _MySliderValue);

      o.Albedo = c.rgb;
      o.Alpha = c.a;
    }

    ENDCG
  } 

  FallBack "Diffuse"
}</pre></div></li></ol></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note05"></a>Note</h3><p>The <code class="literal">pow(arg1, arg2)</code> <a id="id32" class="indexterm"></a>is a built-in function that will perform the equivalent math function of power. So, argument 1 is the value we want to raise to a power, and argument 2 is the power we want to raise it to.</p><p>To find out more information about the<a id="id33" class="indexterm"></a> <code class="literal">pow()</code> function, look to the Cg tutorial. It is a great free resource that you can use for learning more about shading and to get a glossary of all the functions available to you in the Cg shading language:</p><p>
<a class="ulink" href="http://http.developer.nvidia.com/CgTutorial/cg_tutorial_appendix_e.html" target="_blank">http://http.developer.nvidia.com/CgTutorial/cg_tutorial_appendix_e.html</a>
</p></div><p>The <a id="id34" class="indexterm"></a>following screenshot demonstrates the result obtained by using our <a id="id35" class="indexterm"></a>properties to control our Material's colors and saturation, from within the Material's <span class="strong"><strong>Inspector</strong></span> tab:</p><div class="mediaobject"><img src="/graphics/9781849695084/graphics/5084_01_06.jpg" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec16"></a>How it works…</h3></div></div></div><p>When you <a id="id36" class="indexterm"></a>declare a new property in the property<a id="id37" class="indexterm"></a> block, you are providing a way for the Shader to retrieve the tweaked value from the Material's <span class="strong"><strong>Inspector</strong></span> tab. This value is stored in the variable name portion of the property. In this case, <code class="literal">_AmbientColor</code>, <code class="literal">_EmissiveColor</code>, and <code class="literal">_MySliderValue</code> are the variables in which we are storing the tweaked values. In order for you to be able to use the value in the <code class="literal">SubShader{}</code> block, you need to create three new variables with the same names as the property's variable name. This automatically sets up a link between these two so they know they have to work with the same data. Also, it declares the type of data we want to store in our subshader variables, which will come in handy when we look at optimizing Shaders in a later chapter.</p><p>Once you have created the subshader variables, you can then use the values in the<a id="id38" class="indexterm"></a> <code class="literal">surf()</code> function. In this case we want to add the <code class="literal">_EmissiveColor</code> and <code class="literal">_AmbientColor</code> variables together and take it to a power of whatever the <code class="literal">_MySliderValue</code> variable is equal to in the Material's <span class="strong"><strong>Inspector</strong></span> tab.</p><p>We have now created the foundation for any Shader you will create that requires a diffuse component.</p></div></div>