<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch01lvl1sec14"></a>Creating a ramp texture to control diffuse shading</h2></div></div><hr /></div><p>Another great <a id="id48" class="indexterm"></a>tool in your Shader writing toolbox is the use of a ramp texture to drive the color of the diffuse lighting. This allows you to accentuate the surface's colors to fake the effects of more bounce light or a more advanced lighting setup. You see this <a id="id49" class="indexterm"></a>technique used a lot more for cartoony games, where you need a more artist-driven look to your Shaders and not so much of a physically-accurate lighting model.</p><p>This technique became more popular with Team Fortress 2, where Valve came up with a unique approach to lighting their characters. They produced a very popular white paper on the subject, and you should definitely give it a read.</p><p>The Valve White Paper on Team Fortress 2 Lighting and shading available at <a class="ulink" href="http://www.valvesoftware.com/publications/2007/NPAR07_IllustrativeRenderingInTeamFortress2.pdf" target="_blank">http://www.valvesoftware.com/publications/2007/NPAR07_IllustrativeRenderingInTeamFortress2.pdf</a>.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec23"></a>Getting ready</h3></div></div></div><p>To get this started you will need to create a ramp texture in some image editing application. We used Photoshop for this particular demonstration, but any image editing application should be able to make a gradient:</p><div class="mediaobject"><img src="/graphics/9781849695084/graphics/5084_01_11.jpg" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec24"></a>How to do it…</h3></div></div></div><p>Let's begin our<a id="id50" class="indexterm"></a> Shader by entering the following code:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>Simply<a id="id51" class="indexterm"></a> modify the lighting function so that it includes this new code:</p><div class="mediaobject"><img src="/graphics/9781849695084/graphics/5084_01_12.jpg" /></div></li></ul></div><p>The following is the result you will see after running the code:</p><div class="mediaobject"><img src="/graphics/9781849695084/graphics/5084_01_13.jpg" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec25"></a>How it works…</h3></div></div></div><p>This line of code is returning a set of colors, or a float3, which is also the same as r, g, b. These colors are being produced by a Cg function called <code class="literal">tex2D</code>. The <code class="literal">tex2D()</code> function takes two arguments. The first is the texture property we use for this operation. The second includes the UVs from the model that we want to map to the texture.</p><p>In this case we do not want to use any UVs from a vertex, but instead we want to use the diffuse float range to map the UVs of the ramp texture. This ultimately wraps the ramp texture around the surface of the object, based on the direction to the light being calculated.</p><p>We take<a id="id52" class="indexterm"></a> the re-mapped diffuse values from the Half Lambert operation and pass them into <code class="literal">float2()</code> to create the lookup values for the texture. When a value of 0 is<a id="id53" class="indexterm"></a> set as the <code class="literal">hLambert</code> variable, the <code class="literal">tex2D</code> function looks up the pixel value at the UV value of (0,0). In this case it's the subtle peach color from the ramps gradient. When a value of 1 is set for the <code class="literal">hLambert</code> variable, the <code class="literal">tex2D</code> function looks up the pixel at the UV value of (1,1), or the white color.</p><p>Now it is possible for the artist to have some custom control over how the light looks on the surface of an object. This is why this technique is more commonly seen on a project where you need more of an illustrative look.</p></div></div>