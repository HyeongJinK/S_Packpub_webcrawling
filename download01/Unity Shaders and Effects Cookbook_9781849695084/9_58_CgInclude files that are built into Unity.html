<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch09lvl1sec56"></a>CgInclude files that are built into Unity</h2></div></div><hr /></div><p>Our first step into<a id="id508" class="indexterm"></a> writing our own CgInclude files is to understand what Unity<a id="id509" class="indexterm"></a> is already providing us for Shaders. By writing Surface Shaders there is a lot happening underneath the hood, which makes the process of writing Surface Shaders so efficient. We can see this code in the included CgInclude files found in your Unity install folder at <code class="literal">Editor</code> | <code class="literal">Data</code> | <code class="literal">CGIncludes</code>. All the files contained within that folder do their part to render our objects with our Shaders on to the screen. Some of these files take care of shadows and lighting, some take care of helper functions, and some manage platform dependencies. Without them, our Shader writing experience would be much more laborious.</p><p>You can find a list of information Unity has provided to us at the following link:</p><p>
<a class="ulink" href="http://docs.unity3d.com/Documentation/Components/SL-BuiltinIncludes.html" target="_blank">http://docs.unity3d.com/Documentation/Components/SL-BuiltinIncludes.html</a>
</p><p>Let's begin the process of understanding these built-in CgInclude files, using some of the built-in helper functions<a id="id510" class="indexterm"></a> from the <code class="literal">UnityCG.cginc</code> file.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl2sec147"></a>Getting ready</h3></div></div></div><p>Before we start diving into the meat of writing the Shader, we need to get a few items set up in our scene. Let's create the following and then open the Shader in MonoDevelop:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Create a new scene and fill it with a simple sphere model.</p></li><li><p>Create a new Shader and Material.</p></li><li><p>Attach the new Shader to the new Material and assign the Material to the sphere.</p></li><li><p>Then, let's create a directional light and position it above our sphere.</p></li><li><p>Finally, we are going to want to open the <code class="literal">UnityCG.cginc</code> file from Unity's <code class="literal">CgInclude</code> folder located in Unity's install directory. This will let us analyze some of the helper function's code so we can better understand what is happening when we use them.</p></li><li><p>You should have a simple scene set up for working on the Shader. Refer to the following screenshot as an example:</p></li></ol></div><div class="mediaobject"><img src="/graphics/9781849695084/graphics/5084OT_09_01.jpg" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl2sec148"></a>How to do it…</h3></div></div></div><p>With the<a id="id511" class="indexterm"></a> scene prepared, we can now begin the process of <a id="id512" class="indexterm"></a>experimenting with some of the built-in helper functions included with the <code class="literal">UnityCG.cginc</code> file. Double-click on the Shader that was created for this scene to open it in MonoDevelop and insert the code given in the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Add the following code to the <code class="literal">Properties</code> block of the new Shader file. We will need a single texture and a single slide for our example Shader:</p><div class="mediaobject"><img src="/graphics/9781849695084/graphics/5084OT_09_02.jpg" /></div></li><li><p>We then need to make sure we create the data connection between our <code class="literal">Properties</code> block and our <code class="literal">CGPROGRAM</code> block, with the following code placed after the <code class="literal">CGPROGRAM</code> declaration and <code class="literal">#pragma</code> directives:</p><div class="mediaobject"><img src="/graphics/9781849695084/graphics/5084OT_09_03.jpg" /></div></li><li><p>Finally, we just have to update our <code class="literal">surf()</code> function to include the following code. We introduce a new function that we haven't seen yet, which is built into Unity's <code class="literal">UnityCG.cginc</code> file:</p><div class="mediaobject"><img src="/graphics/9781849695084/graphics/5084OT_09_04.jpg" /></div></li></ol></div><p>With the Shader code modified you should see something similar to the following screenshot. We have simply used a helper function, built into Unity's CgInclude file, to give us an<a id="id513" class="indexterm"></a> effect <a id="id514" class="indexterm"></a>of desaturating the main texture of our Shader:</p><div class="mediaobject"><img src="/graphics/9781849695084/graphics/5084OT_09_05.jpg" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl2sec149"></a>How it works…</h3></div></div></div><p>Using the built-in helper <a id="id515" class="indexterm"></a>function named <code class="literal">Luminance()</code>, we are able to quickly get a desaturation or gray scale effect on our Shaders. This is all possible because the <code class="literal">UnityCG.cginc</code> file is automatically brought into our Shader since we are using a Surface Shader.</p><p>If you search through the <code class="literal">UnityCG.cginc</code> file, opened in MonoDevelop, you will find the implementation of this function at line 276. The following screenshot shows the code from the file:</p><div class="mediaobject"><img src="/graphics/9781849695084/graphics/5084OT_09_06.jpg" /></div><p>Since this function is included in this file and Unity automatically compiles with this file, we can use the function in our code as well, thereby reducing the amount of code we have to write over and over again.</p><p>If you <a id="id516" class="indexterm"></a>notice there is also a <code class="literal">Lighting.cginc</code> file<a id="id517" class="indexterm"></a> that Unity comes<a id="id518" class="indexterm"></a> with. This file houses all the lighting models that we use when we declare something like <code class="literal">#pragma Surface surf Lambert</code>. Sifting through this file reveals that all the built-in lighting models are defined here for re-use and modularity.</p></div></div>