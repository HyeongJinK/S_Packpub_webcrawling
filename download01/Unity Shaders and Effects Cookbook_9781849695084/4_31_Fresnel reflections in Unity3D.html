<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch04lvl1sec34"></a>Fresnel reflections in Unity3D</h2></div></div><hr /></div><p>One of the most used types of reflections is the <a id="id284" class="indexterm"></a>
<span class="strong"><strong>Fresnel</strong></span> reflection. This will basically increase the amount of reflection as your view of the surface of an object. You will see this in almost any type of surface, but one of the most used surfaces of this type of effect is the body of a car. We can see that the surface is reflective, but as the surface of the car body becomes more glancing to your view, you'll notice that the reflections and Specular become more intense and create a nice rim-light-type effect.</p><p>Not all surfaces <a id="id285" class="indexterm"></a>have the same amount of Fresnel reflection, though. Some<a id="id286" class="indexterm"></a> surfaces, like a car body's surface, have a high intensity of Fresnel reflection, whereas something like a piece of plastic has a more dull Fresnel intensity.</p><p>This recipe will give you the basic implementation of a Fresnel reflection, as in the real world a Fresnel reflection is the calculation of reflection and refraction as compared to the viewer's angle of view to the surface of an object. But since we haven't covered any sort of refraction techniques, let's take a look at what most game productions implement and how we can modify it to create a very visually appealing reflection effect.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec88"></a>Getting ready</h3></div></div></div><p>Again, let's create a new scene and fill it with some assets so that we can focus on the Shader we are coding.</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>We are going to need to have a Cubemap to produce our Fresnel effect. So you can either generate a new one, or use one from the previous recipes. The following screenshot shows the Cubemap we will be using for this recipe, which is included in the book's support page at <a class="ulink" href="http://www.packtpub.com/support" target="_blank">www.packtpub.com/support</a>.</p><div class="mediaobject"><img src="/graphics/9781849695084/graphics/5084OT_04_07.jpg" /></div></li><li><p>Create a new scene, an object, a ground plane, a new Shader, and a new Material.</p></li><li><p>Finally, create a directional light so that we have some light information as well.</p></li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec89"></a>How to do it…</h3></div></div></div><p>Now let's<a id="id287" class="indexterm"></a> code up our <a id="id288" class="indexterm"></a>Shader and get the Fresnel effect working.</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>First, we need to set up our properties in our <code class="literal">Properties</code> block. This time we are going to utilize the built-in BlinnPhong lighting model, so we will need to declare some properties to use the Specular component of the lighting model.</p><div class="mediaobject"><img src="/graphics/9781849695084/graphics/5084OT_04_32.jpg" /></div></li><li><p>For this Shader we will need to utilize Shader model 3.0, so that we have enough registers to bring all the data into the <code class="literal">surf()</code> function. So we need to add the <code class="literal">#pragma</code> statement to the definitions in the <code class="literal">SubShader</code> block.</p><div class="mediaobject"><img src="/graphics/9781849695084/graphics/5084OT_04_33.jpg" /></div></li><li><p>We then <a id="id289" class="indexterm"></a>need to make sure that we create connections between our new properties and the <code class="literal">SubShader</code> block, so we need to declare our <a id="id290" class="indexterm"></a>variables as follows:</p><div class="mediaobject"><img src="/graphics/9781849695084/graphics/5084OT_04_34.jpg" /></div></li><li><p>To get our reflection to work, we need to declare the <code class="literal">worldRefl</code> parameter in the <code class="literal">Input</code> struct as well as the <code class="literal">viewDir</code> parameter.</p><div class="mediaobject"><img src="/graphics/9781849695084/graphics/5084OT_04_35.jpg" /></div></li><li><p>Then, we need to calculate the rim effect in the <code class="literal">surf()</code> function to create our simple Fresnel reflection effect.</p><div class="mediaobject"><img src="/graphics/9781849695084/graphics/5084OT_04_36.jpg" /></div></li></ol></div><p>The following<a id="id291" class="indexterm"></a> screenshot demonstrates the final result of our simple<a id="id292" class="indexterm"></a> Frensel effect Shader. It could also be used as the basis for a simple car Shader:</p><div class="mediaobject"><img src="/graphics/9781849695084/graphics/5084OT_04_31.jpg" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec90"></a>How it works…</h3></div></div></div><p>In this<a id="id293" class="indexterm"></a> example we are simply creating a falloff value that we <a id="id294" class="indexterm"></a>can use to mask off where the surface is more reflective and less reflective. By using the view direction compared to the surface normal, we can compute a camera facing falloff value. We then invert that value to achieve a mask that is whiter at the edges of the surface, and blacker when the surface is facing more towards the viewer. Refer to the following screenshot for reference:</p><div class="mediaobject"><img src="/graphics/9781849695084/graphics/5084OT_04_37.jpg" /></div><p>We then complete the Shader by adding in our Specular value and our <code class="literal">Diffuse</code> values to achieve the final Fresnel reflection Shader.</p></div></div>