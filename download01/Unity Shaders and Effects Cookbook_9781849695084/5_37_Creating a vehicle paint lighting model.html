<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch05lvl1sec39"></a>Creating a vehicle paint lighting model</h2></div></div><hr /></div><p>One of the most used<a id="id344" class="indexterm"></a> Shader effects is the car shader or <a id="id345" class="indexterm"></a>vehicle shader. This includes many of the techniques we have covered so far in the previous chapters, but now we are going to put all our new-found knowledge to the test. We will create the foundation for a real production-ready Shader that can be used on any of your vehicle models. This will definitely be one of the more advanced Shaders we have written as well as one of the longest, but we will step through it and I'll explain each element.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec104"></a>Getting ready</h3></div></div></div><p>Let's get a new scene prepared with a few assets in it so that we can create our vehicle paint lighting model.</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>We will first need something to shade, so we need to create a new object in a new scene. It's nice to have a plane to act as a ground plane to catch shadows of our object we are shading. So we recommend placing one in the scene as well.</p></li><li><p>In order to write a Shader, we need to have a new Shader and a new Material. So, let's create those now and hook them up to our main object, in this case a sphere.</p></li><li><p>In order to achieve this particular vehicle shader, we will need to create a BRDF texture as well. If you remember from the BRDF section we just need to create a texture that has some variation in color, which represents the different viewing directions on the model. Simply put, we need a color for the diffuse light, and the view direction light. The following screenshot is an example of a texture used in this vehicle shader:</p><div class="mediaobject"><img src="/graphics/9781849695084/graphics/5084OT_05_12.jpg" /></div></li><li><p>Our final step in preparing for the Shader is the creation of a Cubemap. Remember from <a class="link" href="#" linkend="ch04">Chapter 4</a>, <span class="emphasis"><em>Reflecting Your World</em></span> that we can use the generate Cubemap script to produce a Cubemap from our scene in unity.  Let's do that now.</p></li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec105"></a>How to do it…</h3></div></div></div><p>With all <a id="id346" class="indexterm"></a>our assets ready we can start to construct our Shader. We will first run through the code in this Shader, and then break it out and describe each individual component. So let's create our Shader!</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Our first step is to create the properties we are going to need. There are quite a few in this Shader, but we will explain what each one is doing in the next section. Some are pretty familiar to us by now, but they will still be explained.</p><div class="mediaobject"><img src="/graphics/9781849695084/graphics/5084OT_05_13.jpg" /></div></li><li><p>For this Shader we will be creating our own lighting model called <code class="literal">CarPaint</code>, so we need to first declare that in our Shader's <code class="literal">#pragma</code> statement:</p><div class="mediaobject"><img src="/graphics/9781849695084/graphics/5084OT_05_14.jpg" /></div></li><li><p>In order for us to access all the data from our properties, we need to declare them inside of our <code class="literal">SubShader</code> block as well. See the following code snippet:</p><div class="mediaobject"><img src="/graphics/9781849695084/graphics/5084OT_05_15.jpg" /></div></li><li><p>At this point we can start to work on our lighting model. For this Shader we will need to create a lot of data, so read through the following code snippet a couple of <a id="id347" class="indexterm"></a>times, before actually inserting it into your Shader to absorb the information:</p><div class="mediaobject"><img src="/graphics/9781849695084/graphics/5084OT_05_16.jpg" /></div></li><li><p>Let's turn our attention to the <code class="literal">Input</code> struct in our Shader and add the following code. This will let us produce the Fresnel effect you saw in the previous chapter.</p><div class="mediaobject"><img src="/graphics/9781849695084/graphics/5084OT_05_17.jpg" /></div></li><li><p>Finally, we have our <code class="literal">surf()</code> function that does most of the per pixel calculations. Here we will create the final effects for our car paint shader:</p><div class="mediaobject"><img src="/graphics/9781849695084/graphics/5084OT_05_18.jpg" /></div></li></ol></div><p>The following <a id="id348" class="indexterm"></a>screenshot shows the result of our car paint shader on a sphere in Unity3D:</p><div class="mediaobject"><img src="/graphics/9781849695084/graphics/5084OT_05_19.jpg" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec106"></a>How it works…</h3></div></div></div><p>Our car paint shader is actually quite simple when you break it into its components, and we have actually already covered each of the components in <a class="link" href="#" linkend="ch01">Chapter 1</a>, <span class="emphasis"><em>Diffuse Shading</em></span> and <a class="link" href="#" linkend="ch03">Chapter 3</a>, <span class="emphasis"><em>Making Your Game Shine with Specular</em></span>. So hopefully, it should all be sinking in by now, but let's go over the broad concept.</p><p>We utilize the BRDF technique, seen in <a class="link" href="#" linkend="ch01">Chapter 1</a>, <span class="emphasis"><em>Diffuse Shading</em></span> to create the two-toned look of car paint. Now, not every vehicle will have this so it is up to you, the Shader programmer, to decide whether you are going to use a BRDF texture or some other form of diffuse component.</p><p>Finally, we simply calculate a Fresnel term and a fall-off component that drives the amount of reflectivity seen on the surface of the vehicle. All these lighting components are driven by the properties in the <code class="literal">Properties</code> block; so an artist can have ultimate control over the<a id="id349" class="indexterm"></a> final look of their Shader for their vehicle.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec107"></a>There's more…</h3></div></div></div><p>There are also car paint shaders for sale in the Unity Asset Store. Here is a link to one of them: <a class="ulink" href="http://u3d.as/content/ravel-tammeleht/mo-dy-en-car-paint-shader-pack/2Xe" target="_blank">http://u3d.as/content/ravel-tammeleht/mo-dy-en-car-paint-shader-pack/2Xe</a>.</p></div></div>