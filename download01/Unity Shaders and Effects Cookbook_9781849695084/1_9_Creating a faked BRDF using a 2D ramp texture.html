<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch01lvl1sec15"></a>Creating a faked BRDF using a 2D ramp texture</h2></div></div><hr /></div><p>We can take the <a id="id54" class="indexterm"></a>ramp diffuse recipe one step further by <a id="id55" class="indexterm"></a>using the view direction, provided by the lighting functions, to create a more advanced visual look to our lighting. By utilizing the view direction, we will be able to generate some faked rim lighting.</p><p>If we look at the ramp diffuse technique, we are only using one value to place into the UV lookup of the ramp texture. This means that we will get a very linear type of lighting effect. In this recipe we will change our lighting function to take advantage of an additional argument, the <a id="id56" class="indexterm"></a>
<span class="strong"><strong>view direction</strong></span>.</p><p>The view direction is the user's view of the object itself. It is a vector, pointing in a direction that we can use in conjunction with the normal and light direction. This view vector will provide us with the means to create a more advance texture lookup.</p><p>In the Cg industry this technique is often referred to as a <span class="strong"><strong>BRDF effect</strong></span>. BRDF<a id="id57" class="indexterm"></a> stands for <span class="strong"><strong>bidirectional reflectance distribution function</strong></span>. While that is a mouthful, it simply means the way in which light is reflected off an opaque surface from both the view direction and the light direction. To see the effects of this BRDF Shader, let's continue by setting up our scene and writing the Shader.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec26"></a>Getting ready</h3></div></div></div><p>Before starting, we will need a more embellished ramp texture this time. We need to include gradients for both dimensions of the texture.</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Create a new texture with a size of 512 x 512.</p></li><li><p>Create a gradient, diagonally starting from the bottom left of the image, going to the top-right of the image.</p></li><li><p>Create another gradient from the top-left side, going until just before the middle of the image.</p></li><li><p>Finally, create another ramp from the bottom-right side to just before the middle of the image. You should end up with a texture shown in the following image:</p><div class="mediaobject"><img src="/graphics/9781849695084/graphics/5084_01_14.jpg" /></div></li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec27"></a>How to do it…</h3></div></div></div><p>Let's go <a id="id58" class="indexterm"></a>through <a id="id59" class="indexterm"></a>this recipe by following the next few steps, using the basic diffuse Shader as our starting point:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>First we need to change our lighting function to include the <code class="literal">viewDir</code> variable that Unity provides us, to get the current view direction of the camera in the scene as it looks at our object. Modify your lighting function to look like the following code:</p><div class="mediaobject"><img src="/graphics/9781849695084/graphics/5084_01_15.jpg" /></div></li><li><p>We then need to calculate the dot product of the view direction and the surface normal (as shown in the following code). This will produce a falloff type effect that we can use to drive our BRDF texture.</p><div class="mediaobject"><img src="/graphics/9781849695084/graphics/5084_01_16.jpg" /></div></li><li><p>To complete <a id="id60" class="indexterm"></a>the operation, <a id="id61" class="indexterm"></a>we need to feed our dot product result into the <code class="literal">float2()</code> function<a id="id62" class="indexterm"></a> of the<a id="id63" class="indexterm"></a> <code class="literal">tex2D()</code> function. Modify your lighting function to the following code:</p><div class="mediaobject"><img src="/graphics/9781849695084/graphics/5084_01_17.jpg" /></div></li><li><p>Save your Shader and re-enter Unity. Make sure you are using your new BRDF texture as the ramp texture in Unity. You should notice that your lighting now includes two rim light type effects: one for the bottom of the model and one for the top.</p></li></ol></div><p>The following image demonstrates the results of using a BRDF ramp texture to drive the overall diffuse color. This technique is great for a production team as it makes it easy for an artist to update a texture, in Photoshop, rather than tweak lighting in the game:</p><div class="mediaobject"><img src="/graphics/9781849695084/graphics/5084_01_18.jpg" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec28"></a>How it works…</h3></div></div></div><p>When using <a id="id64" class="indexterm"></a>the view direction parameter, we<a id="id65" class="indexterm"></a> can create a very simple falloff type effect. You can use this parameter to create a lot of different types of effects: a bubble type transparency, the start of a rim light effect, shield effects, or even the start of a toon outline effect.</p><div class="mediaobject"><img src="/graphics/9781849695084/graphics/5084_01_19.jpg" /></div><p>The preceding image shows the dot product of the view direction and the surface normal. Consider if you were to look at the values being produce by taking the dot product of the view direction and the surface normal.</p><p>In this case we are using it as one of the components in the BRDF ramp texture lookup. Since the <code class="literal">diffLight</code> calculation and the <code class="literal">rimLight</code> calculation both produce a linear range of values from 0 to 1, we can use both the ranges to pick different areas of the ramp texture.</p><div class="mediaobject"><img src="/graphics/9781849695084/graphics/5084_01_20.jpg" /><div class="caption"><p>A visualization of what is happening inside the Shader code and how it is picking the color to put on the surface</p></div></div><p>So the<a id="id66" class="indexterm"></a> key here is to understand what <a id="id67" class="indexterm"></a>values we get from the dot product functions as well as how we can manipulate texture, inside of a lighting function, to wrap them around a surface in order to simulate a more complex lighting effect.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec29"></a>See also</h3></div></div></div><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>Refer to Polycount BRDF Map at <a class="ulink" href="http://wiki.polycount.com/BrdfMap" target="_blank">wiki.polycount.com/BrdfMap</a>
</p></li></ul></div></div></div>