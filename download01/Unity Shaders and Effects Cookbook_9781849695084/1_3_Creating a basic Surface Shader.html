<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch01lvl1sec09"></a>Creating a basic Surface Shader</h2></div></div><hr /></div><p>As we progress further into the recipes in this book, it is important that you know how to set up your workspace in Unity, so that you can work efficiently, and without any pain. If you are already quite familiar with creating Shaders and setting up Materials in Unity 4, you may skip this recipe. It is here to ensure that newcomers to surface shading in Unity 4 can work with the rest of the recipes.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec08"></a>Getting ready</h3></div></div></div><p>To get started with<a id="id5" class="indexterm"></a> this recipe, you will need to have Unity 4 running, and must have created a new project. There will also be a Unity project included with this cookbook, so you can use that one as well and simply add your own custom Shaders to it, as you step through each recipe. With that completed, you are now ready to step into the wonderful world of real-time shading!</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec09"></a>How to do it…</h3></div></div></div><p>Before getting into our first Shader, let's create a small scene for us to work with. This can be done by going to <span class="strong"><strong>GameObject</strong></span> | <span class="strong"><strong>Create Other</strong></span> in the Unity editor. From there you can create a plane, to act as a ground, a couple of spheres, to which we will apply our Shader, and a directional light to give the scene some light. With our scene generated, we can move onto the Shader writing steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>In the <span class="strong"><strong>Project</strong></span> tab in your Unity editor, right-click on the <span class="strong"><strong>Assets</strong></span> folder and select <span class="strong"><strong>Create</strong></span> | <span class="strong"><strong>Folder</strong></span>.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note02"></a>Note</h3><p>If you are using the Unity project that came with the cookbook, you can skip to step 4.</p></div><div class="mediaobject"><img src="/graphics/9781849695084/graphics/5084_01_01.jpg" /></div></li><li><p>Rename the <a id="id6" class="indexterm"></a>folder that you created to <code class="literal">Shaders</code> by right-clicking on it and selecting <span class="strong"><strong>Rename</strong></span> from the drop-down list, or by selecting the folder and hitting <span class="emphasis"><em>F2</em></span> on the keyboard.</p></li><li><p>Create another folder and rename it to <code class="literal">Materials</code>.</p></li><li><p>Right-click on the <code class="literal">Shaders</code> folder and select <span class="strong"><strong>Create</strong></span> | <span class="strong"><strong>Shader</strong></span>. Then right-click on the <code class="literal">Materials</code> folder and select <span class="strong"><strong>Create</strong></span> | <span class="strong"><strong>Material</strong></span>.</p></li><li><p>Rename both the Shader and the Material to <span class="strong"><strong>BasicDiffuse</strong></span>.</p></li><li><p>Launch the <span class="strong"><strong>BasicDiffuse</strong></span> Shader into<a id="id7" class="indexterm"></a> <span class="strong"><strong>MonoDevelop</strong></span> (the default script editor for Unity) by double-clicking on it. This will automatically launch the editor for you and display the Shader code.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note03"></a>Note</h3><p>You will see that Unity has already populated our Shader with some basic code. This, by default, will get you a basic diffuse Shader that accepts one texture. We will be modifying this base code so that we can learn how to quickly start developing our own custom Shaders.</p></div></li><li><p>Now let's give our Shader a custom folder from which it's selected. The very first line of code in the Shader is the custom description we have to give the Shader so that Unity can make it available in the Shader drop-down list when assigning to Materials. We have renamed our path to <code class="literal">Shader "CookbookShaders/BasicDiffuse"</code>, but you can name it to whatever you want and can rename it at any time. So don't worry about any dependencies at this point. Save the shader in MonoDevelop and return to the Unity editor. Unity will automatically compile the Shader when it recognizes that the file has been<a id="id8" class="indexterm"></a> updated. This is what your Shader should look like at this point:</p><div class="informalexample"><pre class="programlisting">Shader "CookbookShaders/BasicDiffuse" 
{
  Properties 
  {
    _MainTex ("Base (RGB)", 2D) = "white" {}
  }

  SubShader 
  {
    Tags { "RenderType"="Opaque" }
    LOD 200

    CGPROGRAM
    #pragma surface surf Lambert

    sampler2D _MainTex;

    struct Input 
    {
      float2 uv_MainTex;
    };

    void surf (Input IN, inout SurfaceOutput o) 
    {
      half4 c = tex2D (_MainTex, IN.uv_MainTex);
      o.Albedo = c.rgb;
      o.Alpha = c.a;
    }
    ENDCG
  }
  FallBack "Diffuse"
}</pre></div></li><li><p>Select the Material called <span class="strong"><strong>BasicDiffuse</strong></span> that we created in step 4 and look at the <span class="strong"><strong>Inspector</strong></span> tab. From the <span class="strong"><strong>Shader</strong></span> drop-down list, select <span class="strong"><strong>CookbookShaders</strong></span> | <span class="strong"><strong>BasicDiffuse</strong></span> (your Shader path might be different if you chose to use a different path name). This will assign your Shader to your material and now make it ready for<a id="id9" class="indexterm"></a> you to assign to an object.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note04"></a>Note</h3><p>To assign a material to an object, you can simply click-and-drag your Material from the <span class="strong"><strong>Project</strong></span> tab to the object in your scene. You can also drag a Material onto the <span class="strong"><strong>Inspector</strong></span> tab of an object, within the Unity editor, to assign a Material.</p></div></li></ol></div><div class="mediaobject"><img src="/graphics/9781849695084/graphics/5084_01_03.jpg" /></div><p>Not much to look at, at this point, but our Shader development environment is set up and we can now start to modify the Shader to suit our needs.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec10"></a>How it works…</h3></div></div></div><p>Unity has made the task of getting your Shader environment up and running, very easy for you. It is simply a matter of a few clicks and you are good to go. There are a lot of elements working in the background, with regard to the Surface Shader itself. Unity has taken the Cg Shader language and made it more efficient to write, by doing a lot of the heavy Cg code lifting for you. The Surface Shader language is a more component-based way of writing Shaders. Tasks such as processing your own texture coordinates and transformation matrices have already been done for you, so you don't have to start from scratch any more. In the past, we would have to start a new Shader and rewrite a lot of code over and<a id="id10" class="indexterm"></a> over again. As you gain more experience with Surface Shaders, you will naturally want to explore more of the underlying functions of the Cg language and how Unity is processing all of the low-level <span class="strong"><strong>graphics processing unit</strong></span> (<span class="strong"><strong>GPU</strong></span>)<a id="id11" class="indexterm"></a> tasks for you.</p><p>So, by simply changing the Shader's path name to a name of our choice, we have got our basic diffuse Shader working in the Unity environment, working with lights and shadows and all that, by just changing one line of code!</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec11"></a>See also</h3></div></div></div><p>For more information on where to find a large portion of the built-in Cg functions for Unity, go to your Unity install directory and navigate to <code class="literal">Unity4\Editor\Data\CGIncludes</code>. Within that folder there are three files that are of note at this point, the <code class="literal">UnityCG.cginc</code>, <code class="literal">Lighting.cginc</code>, and <code class="literal">UnityShaderVariables.cginc</code>. Our current Shader is making use of all these files at the moment.</p><p>We will go more in-depth with CgInclude files in <a class="link" href="#" linkend="ch09">Chapter 9</a>, <span class="emphasis"><em>Making Your Shader World Modular with CgIncludes</em></span>.</p></div></div>