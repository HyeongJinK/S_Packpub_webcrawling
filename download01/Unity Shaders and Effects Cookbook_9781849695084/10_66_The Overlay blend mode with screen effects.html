<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch10lvl1sec63"></a>The Overlay blend mode with screen effects</h2></div></div><hr /></div><p>For our final recipe <a id="id603" class="indexterm"></a>we are going to take a look at another type <a id="id604" class="indexterm"></a>of blend mode, the Overlay blend mode. This blending actually makes use of some conditional statements that determine the final color of each pixel in each channel. So, the process of using this type of blend mode needs a bit more coding to get working. Let's take a look at how this is done in the following few sections.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch10lvl2sec166"></a>Getting ready</h3></div></div></div><p>For this last screen effect we will need to set up our two scripts like the ones we have in the previous recipes in this chapter. For this recipe we will just be using the same scene we have been using, so that we don't have to create a new one.</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Create a new script file called <code class="literal">Overlay_ImageEffect</code>, and a Shader file called <code class="literal">Overlay_Effect</code>.</p></li><li><p>Copy the code from the previous C# script file into our new script file.</p></li><li><p>Copy the code from the previous Shader file into our new Shader file.</p></li><li><p>Assign the <code class="literal">Overlay_ImageEffect</code> script to the main camera and <code class="literal">Overlay_Effect</code> to the script component in the <span class="strong"><strong>Inspector</strong></span> tab.</p></li><li><p>Finally, double-click on the script and the Shader files to open them up in the MonoDevelop editor.</p></li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch10lvl2sec167"></a>How to do it…</h3></div></div></div><p>We begin our Overlay screen effect just as we have done for most of the recipes in this chapter; we get the code of our Shader up and running without errors. We can then modify our script file to feed the correct data into the Shader.</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>We first need to set up our properties in our <code class="literal">Properties</code> block. We will use the same properties from the last few recipes in this chapter:</p><div class="mediaobject"><img src="/graphics/9781849695084/graphics/5084_10_37.jpg" /></div></li><li><p>We then need to create the corresponding variables inside our <code class="literal">CGPROGRAM</code> statement:</p><div class="mediaobject"><img src="/graphics/9781849695084/graphics/5084_10_38.jpg" /></div></li><li><p>In order<a id="id605" class="indexterm"></a> for the Overlay blend effect<a id="id606" class="indexterm"></a> to work, we are going to have to process each pixel from each channel individually. To do that, in a Shader we have to write a custom function that will take in a single channel, such as the red channel for instance, and perform the Overlay operation. Enter the following code into the Shader just below the variable declarations:</p><div class="mediaobject"><img src="/graphics/9781849695084/graphics/5084_10_40.jpg" /></div></li><li><p>Finally, we need to update our <code class="literal">frag()</code> function to process each channel of our textures, to perform the blending:</p><div class="mediaobject"><img src="/graphics/9781849695084/graphics/5084_10_41.jpg" /></div></li><li><p>With the<a id="id607" class="indexterm"></a> code completed in the Shader, our <a id="id608" class="indexterm"></a>effect should be working. Save the Shader and return to the Unity editor to let the Shader compile. Our script is already set up, so we don't have to modify it any further. Once the Shader compiles, you should see a result similar to the following image:</p><div class="mediaobject"><img src="/graphics/9781849695084/graphics/5084_10_42.jpg" /></div></li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch10lvl2sec168"></a>How it works…</h3></div></div></div><p>Our Overlay blend mode is definitely a lot more involved, but if you break down the function, you will notice that it is simply a Multiply blend mode and a Screen blend mode. It's just that in this case we are doing a conditional check to apply one or the other blend mode to a pixel.</p><p>With this <a id="id609" class="indexterm"></a>particular screen effect, when the Overlay <a id="id610" class="indexterm"></a>function receives a pixel, it looks to see if it is less than 0.5. If it is, we apply a modified Multiply blend mode to that pixel; if it's not, we apply a modified screen blend mode to the pixel. We do this for each pixel for each channel, giving us the final RGB pixel values for our screen effect.</p><p>As you can see, there are many things that can be done with screen effects. It really just depends on the platform and the amount of memory you have allocated for screen effects. Usually this is determined throughout the course of a game project, so have fun and get creative with your screen effects.</p></div></div>