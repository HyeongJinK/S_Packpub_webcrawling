<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch04lvl1sec42"></a>Destroying the enemy</h2></div></div><hr /></div><p>We are now going to <a id="id325" class="indexterm"></a>destroy an enemy by spawning laser beams when we fire our spaceship. We will then use collision detection to detect when the laser beams hit the enemy ship. As soon as the enemy ship is hit, it will be destroyed.</p><p>We start a new project and add the spaceship image <code class="literal">Rocket.png</code> that we used previously; we will now add laser beams by using the following image:</p><div class="mediaobject"><img src="/graphics/9781783559046/graphics/9046_04_12.jpg" /></div><p>Let's destroy the enemy by executing the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Create a new GameObject and assign the <code class="literal">laserbeam</code> sprite to it.</p></li><li><p>Name this GameObject <code class="literal">Bullet</code>.</p></li><li><p>Place it behind the spaceship.</p></li><li><p>Select it, and within the Inspector, tag it by going to <span class="strong"><strong>Tag</strong></span> | <span class="strong"><strong>Untagged</strong></span> and then going to <span class="strong"><strong>Tag</strong></span> | <span class="strong"><strong>Add Tag…</strong></span>.</p></li><li><p>Name the tag <code class="literal">Bullet</code> within the <span class="strong"><strong>Element 0</strong></span> field.</p></li><li><p>We must make sure that we then select the <span class="strong"><strong>Bullet</strong></span> tag we just created from the <span class="strong"><strong>Tag</strong></span> drop-down box.</p></li><li><p>Now, go to <span class="strong"><strong>Add Component</strong></span> | <span class="strong"><strong>Physics 2D</strong></span> | <span class="strong"><strong>Box Collider 2D</strong></span>.</p></li><li><p>Go to <span class="strong"><strong>Add Component</strong></span> | <span class="strong"><strong>Physics 2D</strong></span> | <span class="strong"><strong>Rigidbody 2D</strong></span>.</p></li><li><p>Make sure the <span class="strong"><strong>Is Kinematic</strong></span> option is unchecked (and therefore false) and is thus set to dynamic.</p></li></ol></div><p>The following screenshot displays a table that explains which colliders work with each other:</p><div class="mediaobject"><img src="/graphics/9781783559046/graphics/9046_04_13.jpg" /><div class="caption"><p>Collision Detection Table, viewed February 20, 2014, <a class="ulink" href="http://docs.unity3d.com/Documentation/Components/class-BoxCollider.html" target="_blank">http://docs.unity3d.com/Documentation/Components/class-BoxCollider.html</a>
</p></div></div><p>Attach the <a id="id326" class="indexterm"></a>following script to <span class="strong"><strong>Ship</strong></span> by either dragging the script onto the <span class="strong"><strong>Ship</strong></span> GameObject or by selecting the <span class="strong"><strong>Ship</strong></span> GameObject from the scene and then, within the Inspector, going to <span class="strong"><strong>Add Component</strong></span> | <span class="strong"><strong>New Script</strong></span>.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note11"></a>Note</h3><p>Name the script <code class="literal">Spawn.js</code>. We declare our <code class="literal">bullet</code> variable of type <code class="literal">Rigidbody2D</code> in the next line of code.</p></div><div class="informalexample"><pre class="programlisting">var bullet:Rigidbody2D;</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note12"></a>Note</h3><p>The speed that the bullet will fire at is defined in the next code snippet.</p></div><div class="informalexample"><pre class="programlisting">var speed:float = 20f;

function Update ()
{
  var bulletInstance:Rigidbody2D;</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note13"></a>Note</h3><p>If the fire (<span class="emphasis"><em>Ctrl</em></span> or mouse click) button is pressed and there are no collisions…</p></div><div class="informalexample"><pre class="programlisting">    if(Input.GetButtonDown("Fire1")&amp;&amp; Hit.hit == false)
    {</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note14"></a>Note</h3><p>Let's instantiate the bullet facing right and set its velocity to the right. Name all the instances <code class="literal">Bullet</code>.</p></div><div class="informalexample"><pre class="programlisting">bulletInstance = Instantiate(bullet, transform.position, Quaternion.Euler(new Vector3(0,0,0)));
bulletInstance.velocity = new Vector2(speed, 0);
bulletInstance.name = "Bullet";
    }
}</pre></div><p>Assign the <a id="id327" class="indexterm"></a>bullet as the <code class="literal">Rigidbody2D</code> variable within the Spaceship's Inspector by clicking on the circular button shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783559046/graphics/9046_04_18.jpg" /></div><p>Now we add the enemy<a id="id328" class="indexterm"></a> spaceship. Go to <span class="strong"><strong>Add Component</strong></span> | <span class="strong"><strong>Physics 2D</strong></span> | <span class="strong"><strong>Box Collider 2D</strong></span>.</p><p>Add the following image:</p><div class="mediaobject"><img src="/graphics/9781783559046/graphics/9046_04_14.jpg" /></div><p>We attach the<a id="id329" class="indexterm"></a> following new script to the enemy ship:</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note15"></a>Note</h3><p>Name the script <code class="literal">Hit.js</code>.</p><p>Now, let's make a list of GameObjects.</p></div><div class="informalexample"><pre class="programlisting">var gameObjects : GameObject[];</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note16"></a>Note</h3><p>A Boolean variable to track when a collision has occurred is defined next.</p></div><div class="informalexample"><pre class="programlisting">static var hit:boolean = false;</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note17"></a>Note</h3><p>Next, we use a function to remove all objects after a collision.</p></div><div class="informalexample"><pre class="programlisting">function Removal()
{
//Find all bullet objects
    gameObjects =  GameObject.FindGameObjectsWithTag("Bullet");</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note18"></a>Note</h3><p>Next, we use a <a id="id330" class="indexterm"></a>loop to go through and destroy all bullet objects in the scene.</p></div><div class="informalexample"><pre class="programlisting">    for(var i = 0 ; i &lt; gameObjects.length ; i ++)
        Destroy(gameObjects[i]);
}</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note19"></a>Note</h3><p>A special Unity function to detect 2D collisions is used now.</p></div><div class="informalexample"><pre class="programlisting">function OnCollisionEnter2D(other:Collision2D){</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note20"></a>Note</h3><p>Check whether the bullet or bullet clones collide with the enemy.</p></div><div class="informalexample"><pre class="programlisting">if(other.gameObject.name=="Bullet")
{</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note21"></a>Note</h3><p>Destroy the enemy ship.</p></div><div class="informalexample"><pre class="programlisting">      Removal();
      Destroy(gameObject);
      hit = true;
  }
}</pre></div><p>We now build the<a id="id331" class="indexterm"></a> script that we created and then press play in Unity to test out our script. We either press the <span class="emphasis"><em>Ctrl</em></span> (fire) key or the right mouse button to shoot and destroy the enemy ship.</p></div>