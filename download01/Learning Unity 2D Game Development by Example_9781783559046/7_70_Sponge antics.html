<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch07lvl1sec70"></a>Sponge antics</h2></div></div><hr /></div><p>For our <a id="id464" class="indexterm"></a>second game, we will create a classic arcade game where the player will need to catch the falling <span class="emphasis"><em>grime</em></span> while avoiding the falling cleaning acid.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec62"></a>Our main character – Spongy</h3></div></div></div><p>Our main<a id="id465" class="indexterm"></a> character is called Spongy, and it likes to keep the bathroom all sparkling clean. In order to do so, it must catch all the falling grime. However, Spongy must watch out for the falling cleaning chemicals as they contain acid that will<a id="id466" class="indexterm"></a> harm it.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec63"></a>The bathroom</h3></div></div></div><p>We will <a id="id467" class="indexterm"></a>now create the environment of our game.</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>To begin with, we create our bathroom environment by adding the background to the scene from the following URL:</p><p>
<a class="ulink" href="http://freeartsprites.com/free-art/classic-arcade/" target="_blank">http://freeartsprites.com/free-art/classic-arcade/</a>
</p></li><li><p>Name the background GameObject <code class="literal">Bathroom</code>.</p><p>For this game, we will use the aspect ratio 5:4 (which is a screen resolution of 1280 x 1024 pixels) as the design of the game makes use of more height than width.</p><p>This is because the game makes use of objects falling vertically from the top of the screen downwards.</p></li><li><p>To change our aspect ratio, we click on the drop-down box within the Game View, as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783559046/graphics/9046OT_07_01.jpg" /></div></li><li><p>Move the<a id="id468" class="indexterm"></a> background so that it fits perfectly in the scene. The background should fit perfectly since it has the exact same dimensions as the screen resolution we are using for this game.</p></li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec64"></a>Adding Spongy</h3></div></div></div><p>We <a id="id469" class="indexterm"></a>will now add our main character.</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>We <a id="id470" class="indexterm"></a>now add Spongy using the <code class="literal">Sponge.png</code> file. To do this, we have to download <code class="literal">ClassicArcade.zip</code> from the following URL and unzip it:</p><p>
<a class="ulink" href="http://freeartsprites.com/free-art/classic-arcade/" target="_blank">http://freeartsprites.com/free-art/classic-arcade/</a>
</p></li><li><p>Import the sprite into Unity.</p></li><li><p>We then slice the sprite sheet and use only one of the sprites, in a manner similar to the following image, as a GameObject:</p><div class="mediaobject"><img src="/graphics/9781783559046/graphics/9046OT_07_02.jpg" /></div></li><li><p>Name<a id="id471" class="indexterm"></a> this GameObject <code class="literal">Spongy</code>, and add the <span class="strong"><strong>Box Collider 2D</strong></span> component by going to <span class="strong"><strong>Add Component</strong></span> | <span class="strong"><strong>Physics 2D</strong></span> | <span class="strong"><strong>Box Collider 2D</strong></span> within the Inspector.</p></li><li><p>Move Spongy in the Scene View so that it is positioned above the bottom background tiles, as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783559046/graphics/9046OT_07_03.jpg" /></div></li><li><p>Create <a id="id472" class="indexterm"></a>a script called <code class="literal">Spongy.js</code>, and assign it to the Spongy GameObject.</p></li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec65"></a>Moving left and right</h3></div></div></div><p>We <a id="id473" class="indexterm"></a>now need to add the game controls for our game. To move Spongy left and right, we add the following script to the <code class="literal">Spongy.js</code> script:</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note63"></a>Note</h3><p>First, add a comment with the script name as shown in the next line of code.</p></div><div class="informalexample"><pre class="programlisting">//Spongy.js</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note64"></a>Note</h3><p>The next line of code is used to ensure strict typing—if you use the same variable for different data types, then an error will be thrown when building the script. This prevents bugs from occurring. Have a look at the next line of code.</p></div><div class="informalexample"><pre class="programlisting">#pragma strict</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note65"></a>Note</h3><p>Declare <a id="id474" class="indexterm"></a>a decimal variable and assign the 3 seconds speed that Spongy will move at. Have a look at the next line of code.</p></div><div class="informalexample"><pre class="programlisting">var speed:float = 3.0;</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note66"></a>Note</h3><p>The next line of code can be removed as it is not being used. </p></div><div class="informalexample"><pre class="programlisting">function Start ()
{

}</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note67"></a>Note</h3><p>The function to move Spongy gets called every frame. Have a look at the next code snippet.</p></div><div class="informalexample"><pre class="programlisting">function Update ()
{
  MoveCharacter();
}</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note68"></a>Note</h3><p>The next code snippet is a function to move Spongy.</p></div><div class="informalexample"><pre class="programlisting">function MoveCharacter()
{</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note69"></a>Note</h3><p>Detect whether the input key from the keyboard is <span class="emphasis"><em>A</em></span>. This is shown in the next line of code.</p></div><div class="informalexample"><pre class="programlisting">if (Input.GetKey(KeyCode.A))
{</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note70"></a>Note</h3><p>We<a id="id475" class="indexterm"></a> then move Spongy using <code class="literal">transform.Translate</code>, which moves the transform in the direction and distance of the translation relative to something.</p><p>In this case, we translate Spongy's position using a 3D vector moving to the left direction multiplied by the distance of 3 units per second, which is speed multiplied by time moving relative to space since there is no third parameter.</p><p>We multiply against Delta Time to ensure that the animation is frame-rate independent; otherwise, should the frame rate drop at any time, the animation will slow down, and likewise, should it increase, the animation will speed up. Not only would this look wrong, but it would also not control correctly. The next line of code shows how this is done.</p></div><div class="informalexample"><pre class="programlisting">  transform.Translate(Vector3.left * speed * Time.deltaTime);
}</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note71"></a>Note</h3><p>Detect whether the input key from keyboard is <span class="emphasis"><em>D</em></span>. The next line of code shows how this is done.</p></div><div class="informalexample"><pre class="programlisting">if (Input.GetKey(KeyCode.D))
{</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note72"></a>Note</h3><p>We then move Spongy using <code class="literal">transform.Translate</code>, which moves the transform in the direction and distance of the translation relative to something.</p><p>In this case, we translate Spongy's position using a 3D vector moving to the right direction multiplied by the distance of 3 units per second, which is speed multiplied by time moving relative to space as there is no third parameter.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec66"></a>Spawning grime</h3></div></div></div><p>We<a id="id476" class="indexterm"></a> are now going to add the grime that will spawn from above and drop downwards towards Spongy. Let's execute the following steps to do this:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Add the<a id="id477" class="indexterm"></a> grime by downloading the sprites from <a class="ulink" href="http://freeartsprites.com/free-art/classic-arcade/" target="_blank">http://freeartsprites.com/free-art/classic-arcade/</a>. We then slice the sprite sheet and use only one of the sprites as a GameObject, as shown in the following image:</p><div class="mediaobject"><img src="/graphics/9781783559046/graphics/9046OT_07_04.jpg" /></div></li><li><p>We name this GameObject <code class="literal">Grime</code> and add the <span class="strong"><strong>Rigidbody 2D</strong></span> component as well as the <span class="strong"><strong>Box Collider 2D</strong></span> component.</p></li><li><p>We then create a script called <code class="literal">Grime.js</code> and assign it to the <code class="literal">Grime</code> GameObject.</p></li><li><p>To spawn the grime randomly, we add the following script to <code class="literal">Grime.js</code>:</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note73"></a>Note</h3><p>Add a comment with the script name. The next line of code shows how this is done.</p></div><div class="informalexample"><pre class="programlisting">//Grime.js</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note74"></a>Note</h3><p>The next line of code is used to ensure strict typing—if you use the same variable for different data types, then an error will be thrown when building the script. This prevents bugs from occurring. The next line of code shows how this is done.</p></div><div class="informalexample"><pre class="programlisting">#pragma strict</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note75"></a>Note</h3><p>Declare our <code class="literal">grime</code> variable and set its data type to <code class="literal">Rigidbody2D</code>. Have a look at the next line of code.</p></div><div class="informalexample"><pre class="programlisting">var grime:Rigidbody2D;</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note76"></a>Note</h3><p>Declare a <a id="id478" class="indexterm"></a>decimal variable and assign the 3 seconds speed that the grime will move at.</p><p>We set it to <code class="literal">-3</code> since we want it to move down. The next line of code shows how this is done.</p></div><div class="informalexample"><pre class="programlisting">var speed:float = -3.0;</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note77"></a>Note</h3><p>The next code can be removed as it is not being used by us.</p></div><div class="informalexample"><pre class="programlisting">function Start ()
{

}

function Update ()
{

}</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note78"></a>Note</h3><p>We use the <code class="literal">InvokeRepeating</code> function to spawn the grime by calling the <code class="literal">SpawnGrime</code> function with the first parameter.</p><p>The function is called starting at 3 seconds by the second parameter, and then it gets called repeatedly every 10 seconds specified by the third parameter. Have a look at the next line of code.</p></div><div class="informalexample"><pre class="programlisting">InvokeRepeating("SpawnGrime", 3, 10);</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note79"></a>Note</h3><p>The next function is used to spawn the grime.</p></div><div class="informalexample"><pre class="programlisting">function SpawnGrime()
{</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note80"></a>Note</h3><p>Declare <a id="id479" class="indexterm"></a>a variable of an instance of our <code class="literal">Rigidbody2D</code> GameObject. The next line of code shows how this is done.</p></div><div class="informalexample"><pre class="programlisting">  var grimeInstance:Rigidbody2D;</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note81"></a>Note</h3><p>Spawn an instance of the obstacle GameObject using the Unity function <code class="literal">Instantiate</code> and assign it to our variable.</p><p>The first parameter is the <code class="literal">gameobject</code>. We want to make an instance of the grime.</p><p>The second parameter is the position of the newly spawned grime whereby we use a vector with a random range of coordinates between <code class="literal">-8</code> and <code class="literal">8</code> along the <span class="emphasis"><em>x</em></span> axis, a <span class="emphasis"><em>y</em></span> coordinate of <code class="literal">7</code>, and a <span class="emphasis"><em>z</em></span> coordinate of <code class="literal">0</code> as this is a 2D game.</p><p>The final parameter is the rotation/orientation of the newly spawned grime, and thus we use a quaternion. Within it, we create a new 3D vector because the variable is uninitialized. Have a look at the next code snippet.</p></div><div class="informalexample"><pre class="programlisting">grimeInstance = Instantiate(grime, Vector3(Random.Range(-8, 8),7,0), Quaternion.Euler(new Vector3(0,0,0)));
grimeInstance.name = "Grime(Clone)";</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note82"></a>Note</h3><p>Using the <code class="literal">velocity</code> variable with a speed parameter along the <span class="emphasis"><em>y</em></span> axis of a 2D vector will make the object move by itself because the Unity physics engine will move it for us. This is fundamentally different from our manually moving an object using the <code class="literal">Translate()</code> method.</p></div><div class="informalexample"><pre class="programlisting">grimeInstance.velocity = new Vector2(0, speed);

}



function OnCollisionEnter2D(other:Collision2D)
{

    if(other.gameObject.name=="Spongy")
    {
        Destroy(gameObject);
   	}

}</pre></div></li></ol></div><p>Each<a id="id480" class="indexterm"></a> instance creates a new name for the respective occurrence, for example, <code class="literal">Grime(Clone)</code>, then <code class="literal">Grime(Clone)(Clone)</code>, <code class="literal">Grime(Clone)(Clone)(Clone)</code>, and so on. A way to check whether Spongy is colliding with any of them is to rename all of them to <code class="literal">Grime(Clone)</code>.</p><p>This is the reason we used the following line in the previous script right before the preceding code snippet:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>grimeInstance.name = "Grime(Clone)";</strong></span>
</pre></div><p>We will use it for the acid as well. Make sure to assign the <code class="literal">grime</code> GameObject to the <code class="literal">grime</code> variable within the Inspector in the Unity Editor.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec67"></a>Spawning acid</h3></div></div></div><p>Now, we <a id="id481" class="indexterm"></a>will add the acid that will also fall from above in the following manner:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Add the <a id="id482" class="indexterm"></a>acid sprite by downloading the given sprite from the following URL:</p><p>
<a class="ulink" href="http://freeartsprites.com/free-art/classic-arcade/" target="_blank">http://freeartsprites.com/free-art/classic-arcade/</a>
</p></li><li><p>We then slice the sprite sheet and use only one of the sprites in the following image as a GameObject:</p><div class="mediaobject"><img src="/graphics/9781783559046/graphics/9046OT_07_05.jpg" /></div></li><li><p>We name this GameObject <code class="literal">Acid</code> and add the <span class="strong"><strong>Rigidbody 2D</strong></span> component as well<a id="id483" class="indexterm"></a> as the <span class="strong"><strong>Box Collider 2D</strong></span> component.</p></li><li><p>We then create a script called <code class="literal">Acid.js</code> and assign it to the <code class="literal">Acid</code> GameObject.</p></li><li><p>The script we will create is exactly the same as the script we created for the grime, the only difference being the naming of the script, function, and variables.</p></li><li><p>Add the following script to <code class="literal">Acid.js</code>:</p><div class="informalexample"><pre class="programlisting">//Acid.js


#pragma strict


var acid:Rigidbody2D;


var speed:float = -3.0;


var SpongyObj:GameObject;

function Start ()
{

}

function Update ()
{

}

InvokeRepeating("SpawnAcid", 3, 5);

function SpawnAcid()
{
  var acidInstance:Rigidbody2D;

acidInstance = Instantiate(acid, Vector3(Random.Range(-8, 8),7,0), Quaternion.Euler(new Vector3(0,0,0)));
acidInstance.name = "Acid(Clone)";
acidInstance.velocity = new Vector2(0, speed);

}

function OnCollisionEnter2D(other:Collision2D)
{

    if(other.gameObject.name=="Spongy")
    {
        Destroy(gameObject);
    }

}</pre></div></li></ol></div><p>Make<a id="id484" class="indexterm"></a> sure to assign the <code class="literal">Acid</code> GameObject to the <code class="literal">Acid.js</code> script within the Inspector in the Unity Editor.</p></div></div>