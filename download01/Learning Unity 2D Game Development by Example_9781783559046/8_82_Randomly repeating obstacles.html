<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch08lvl1sec81"></a>Randomly repeating obstacles</h2></div></div><hr /></div><p>We are <a id="id535" class="indexterm"></a>going to create obstacles for the ninja to avoid. These obstacles need to repeat until the player dies, and they need to spawn randomly<a id="id536" class="indexterm"></a> to provide challenges, variety, and replay ability.</p><p>Since the player is static, the obstacles need to move towards the player. To create our obstacle, we can execute the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Add a folder to <code class="literal">Assets</code> within the Project Browser named <code class="literal">Obstacle</code>.</p></li><li><p>Download<a id="id537" class="indexterm"></a> and unzip the image <code class="literal">Boulder.png</code> from <a class="ulink" href="http://freeartsprites.com/free-art/endless-runner/" target="_blank">http://freeartsprites.com/free-art/endless-runner/</a>.</p></li><li><p>Create a sprite GameObject using the following image:</p><div class="mediaobject"><img src="/graphics/9781783559046/graphics/9046OT_08_08.jpg" /></div></li><li><p>Position<a id="id538" class="indexterm"></a> the boulder obstacle as in the following screenshot: </p><div class="mediaobject"><img src="/graphics/9781783559046/graphics/9046OT_08_09.jpg" /></div></li><li><p>Name <a id="id539" class="indexterm"></a>the GameObject <code class="literal">Obstacle</code>.</p></li><li><p>Go to <span class="strong"><strong>Add component</strong></span> | <span class="strong"><strong>Physics 2D</strong></span> | <span class="strong"><strong>Box2D Collider</strong></span>.</p></li><li><p>Go to <span class="strong"><strong>Add component</strong></span> | <span class="strong"><strong>Physics 2D</strong></span> | <span class="strong"><strong>Rigidbody 2D</strong></span>.</p></li><li><p>Set <span class="strong"><strong>Gravity</strong></span> to <code class="literal">0</code>.</p></li><li><p>Create a script called <code class="literal">Obstacle.js</code>, and assign it to the <code class="literal">Obstacle</code> GameObject.</p></li></ol></div><p>Add the following to the script:</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note98"></a>Note</h3><p>Declare our <code class="literal">obstacle</code> variable and set its data type to <code class="literal">Rigidbody2D</code>. This is shown in the next line of code.</p></div><div class="informalexample"><pre class="programlisting">var obstacle:Rigidbody2D;</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note99"></a>Note</h3><p>Declare a decimal variable and assign the 3 seconds speed that the ninja will move at. We set this to <code class="literal">-3</code> since we want it to move to the left-hand side. Have a look at the next line of code.</p></div><div class="informalexample"><pre class="programlisting">var speed:float = -3.0;</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note100"></a>Note</h3><p>Declare our <code class="literal">ninja</code> object of the type <code class="literal">GameObject</code>. You will see how this is done in the next line of code.</p></div><div class="informalexample"><pre class="programlisting">var ninjaObj:GameObject;</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note101"></a>Note</h3><p>We <a id="id540" class="indexterm"></a>spawn an obstacle every 3 seconds <a id="id541" class="indexterm"></a>using Unity's <code class="literal">Invoke</code> method. The first parameter we pass is the name of the function that spawns an obstacle and the second parameter is the delay in terms of seconds between each spawn. Have a look at the next line of code.</p></div><div class="informalexample"><pre class="programlisting">Invoke("SpawnObstacle", 3);</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note102"></a>Note</h3><p>The function to spawn an obstacle is given next.</p></div><div class="informalexample"><pre class="programlisting">function SpawnObstacle()
{</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note103"></a>Note</h3><p>Declare a variable of an instance of our <code class="literal">Rigidbody2D</code> GameObject.</p></div><div class="informalexample"><pre class="programlisting">var obstacleInstance:Rigidbody2D;</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note104"></a>Note</h3><p>Spawn an instance of the obstacle GameObject using Unity's <code class="literal">Instantiate</code> function and assign it to our variable. The first parameter is the GameObject we want to make an instance of, namely, the obstacle.</p><p>The second parameter is the position of the newly spawned obstacle, whereby we use a vector with three coordinates. The first coordinate <span class="emphasis"><em>x</em></span> is set to <code class="literal">10</code>; the second coordinate <span class="emphasis"><em>y</em></span> uses a random range function to provide random height; and the final <span class="emphasis"><em>z</em></span> position we leave at <code class="literal">0</code> as this is a 2D game.</p><p>The final parameter is the rotation/orientation of the newly spawned obstacle and thus we use a quaternion. Within it, we create a new 3D vector because the variable is uninitialized.</p></div><div class="informalexample"><pre class="programlisting">obstacleInstance = Instantiate(obstacle, Vector3(10,Random.Range(-4, 0),0), Quaternion.Euler(new Vector3(0,0,0)));</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note105"></a>Note</h3><p>We <a id="id542" class="indexterm"></a>give all new instances identical names<a id="id543" class="indexterm"></a> so that we can simply identify all of them; otherwise, we would have to check each individually. Have a look at the next line of code.</p></div><div class="informalexample"><pre class="programlisting">obstacleInstance.name = "Obstacle(Clone)";</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note106"></a>Note</h3><p>Set the obstacle instance's velocity in the <span class="emphasis"><em>x</em></span> axis to the speed variable of <code class="literal">-3.0</code> that we declared at the start of the script. We use a vector with two coordinates <span class="emphasis"><em>x</em></span> and <span class="emphasis"><em>y</em></span> for each position update. Have a look at the next line of code.</p></div><div class="informalexample"><pre class="programlisting">obstacleInstance.velocity = new Vector2(speed, 0);
}</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note107"></a>Note</h3><p>Make sure to assign the obstacle Rigidbody to the <code class="literal">obstacle</code> variable under the script component in the Inspector.</p></div></div>