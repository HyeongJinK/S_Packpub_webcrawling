<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch06lvl1sec60"></a>Movement controls</h2></div></div><hr /></div><p>Now <a id="id425" class="indexterm"></a>that we have our hero character's animations ready, we can detect input from the player in order to control the hero's movement.</p><p>We will play the animation that corresponds with the direction that the hero is moving. We will use the <span class="emphasis"><em>W</em></span>, <span class="emphasis"><em>A</em></span>, <span class="emphasis"><em>S</em></span>, and <span class="emphasis"><em>D</em></span> keys on our keyboard as our movement keys.</p><p>Before we can detect input in script and then output the corresponding animation, we first need to set the states and order the transitions between multiple animations using the Animator.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec60"></a>Movement Controls Animator</h3></div></div></div><p>We assign<a id="id426" class="indexterm"></a> the Animator<a id="id427" class="indexterm"></a> component to the hero GameObject within the Inspector by going to <span class="strong"><strong>Add Component</strong></span> | <span class="strong"><strong>Miscellaneous</strong></span> | <span class="strong"><strong>Animator</strong></span>. Then, within the Animator View (you can open this by going to <span class="strong"><strong>Window</strong></span> | <span class="strong"><strong>Animator</strong></span>), order the animation states we created by right-clicking and adding transitions with directions that match the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783559046/graphics/9046OT_06_09.jpg" /></div><p>We add the following Boolean parameters to the <span class="strong"><strong>Parameters</strong></span> box within the Animator View. To do this, we click on the plus sign, select <span class="strong"><strong>Bool</strong></span>, and then name the parameters as follows:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>
<code class="literal">right</code>
</p></li><li style="list-style-type: disc"><p>
<code class="literal">down</code>
</p></li><li style="list-style-type: disc"><p>
<code class="literal">up</code>
</p></li><li style="list-style-type: disc"><p>
<code class="literal">left</code>
</p><div class="mediaobject"><img src="/graphics/9781783559046/graphics/9046OT_06_10.jpg" /></div></li></ul></div><p>We <a id="id428" class="indexterm"></a>click on each <a id="id429" class="indexterm"></a>transition individually and check the Inspector. At the bottom of the Inspector, we set the condition to match the direction the transition arrow is pointing to, with the name of the corresponding parameter. For instance, if the arrow is going from <code class="literal">walkDown</code> and pointing towards <code class="literal">walkRight</code>, we select the right parameter. Similarly, if the transition is going from <code class="literal">walkLeft</code> to <code class="literal">walkRight</code>, we again select the right parameter. However, if the transition is going from <code class="literal">walkRight</code> to <code class="literal">walkLeft</code>, then we select the left parameter.</p><p>The following screenshot displays the location of the condition within the Inspector:</p><div class="mediaobject"><img src="/graphics/9781783559046/graphics/9046OT_06_11.jpg" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec61"></a>Movement controls script</h3></div></div></div><p>We move <a id="id430" class="indexterm"></a>the hero on the lines of the movement script we created in <a class="link" href="#" linkend="ch04">Chapter 4</a>, <span class="emphasis"><em>Code Control</em></span>. The main addition here is that we set the values of the parameters we have created within the Animator using the <code class="literal">animator.setBool</code> function in the following script, which we will name <code class="literal">Hero.js</code> and assign to the hero character:</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note32"></a>Note</h3><p>Declare the variable for the speed the hero will move at as shown in the next line of code.</p></div><div class="informalexample"><pre class="programlisting">var speed:float = 2.0;</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note33"></a>Note</h3><p>Declare the direction variables for the movement states that the hero will travel at on his own. This is shown in the next code snippet.</p></div><div class="informalexample"><pre class="programlisting">var right:boolean = false;
var left:boolean = false;
var up:boolean = false;
var down:boolean = false;</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note34"></a>Note</h3><p>Declare<a id="id431" class="indexterm"></a> the variable to store the Animator component attached to the ninja GameObject.</p></div><div class="informalexample"><pre class="programlisting">var animator: Animator;</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note35"></a>Note</h3><p>At the start of our game, we get the Animator component attached to our ninja GameObject and assign it to our Animator variable we declared so that we can access the parameters within the Animator.</p></div><div class="informalexample"><pre class="programlisting">function Start()
{
animator = GetComponent("Animator");
}</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note36"></a>Note</h3><p>We call our <code class="literal">MoveCharacter</code> function within <code class="literal">Fixed Update</code> instead of <code class="literal">Update</code> as we are using a Rigidbodyâ€”when using <span class="strong"><strong>Physics</strong></span>, we need to ensure that the updates occur in sync with the Physics engine as using <code class="literal">Update</code> could cause inconsistencies depending on the frame rate of the game.</p></div><div class="informalexample"><pre class="programlisting">function FixedUpdate()
{
MoveCharacter();
}</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note37"></a>Note</h3><p>There is a function to move the hero. This is shown in the next line of code.</p></div><div class="informalexample"><pre class="programlisting">function MoveCharacter()
{</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note38"></a>Note</h3><p>Detect if the input key from the keyboard is <span class="emphasis"><em>D</em></span>. This is shown in the next line of code.</p></div><div class="informalexample"><pre class="programlisting">if (Input.GetKey(KeyCode.D))
{</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note39"></a>Note</h3><p>If the <span class="emphasis"><em>D</em></span> key is pressed, then we call the Animator function and set the <code class="literal">right</code> parameter <a id="id432" class="indexterm"></a>of the Animator's <code class="literal">bool</code> function to <code class="literal">true</code> and the rest of the parameters to <code class="literal">false</code>. This is so that the other animations transition to the <code class="literal">walkRight</code> animation. This is shown in the next code snippet.</p></div><div class="informalexample"><pre class="programlisting">  animator.SetBool("left", false);
  animator.SetBool("up", false);
  animator.SetBool("down", false);
  animator.SetBool("right", true);</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note40"></a>Note</h3><p>We do the same with the movement states. This is shown in the next code snippet.</p></div><div class="informalexample"><pre class="programlisting">  down = false;
  left = false;
  right = true;
  up = false;</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note41"></a>Note</h3><p>Move the character to the right using <code class="literal">transform.Translate</code>, which is the function that moves a GameObject's position based on direction and distance. The first parameter passes the direction, and the next two parameters, being speed and time, pass the distance as distance is speed over time.</p><p>We use <code class="literal">vector3.right</code>, which is the shorthand for a predefined vector moving right which is (-1,0,0).</p><p>We then multiply by the speed that we want the character to move right at and then the amount of time we want the character to be moving right, which in this case is for as long as the player is pressing down the <span class="emphasis"><em>D</em></span> key.</p><p>We use <code class="literal">Time.deltaTime</code> for this as it makes the movement frame independent, allowing the character to move a certain distance per second instead of per frame because it calculates the seconds that have passed since the last frame. This is shown in the next code snippet.</p></div><div class="informalexample"><pre class="programlisting">  transform.Translate(Vector3.right * speed * Time.deltaTime);
}</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note43"></a>Note</h3><p>Once <a id="id433" class="indexterm"></a>we have moved the hero to the right and therefore set his movement state to the right, he will continue moving to the right on his own when we are no longer pressing the <span class="emphasis"><em>D</em></span> key. This is shown in the next code snippet.</p></div><div class="informalexample"><pre class="programlisting">if (right == true)
{
  transform.Translate(Vector3.right * speed * Time.deltaTime);
}</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note44"></a>Note</h3><p>Once we have moved the hero to the left and therefore set his movement state to the left, he will continue moving to the left on his own when we are no longer pressing the <span class="emphasis"><em>A</em></span> key. This is shown in the next code snippet.</p></div><div class="informalexample"><pre class="programlisting">if (left == true)
{
  transform.Translate(Vector3.left * speed * Time.deltaTime);
}</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note45"></a>Note</h3><p>Once we have moved the hero up and therefore set his movement state to up, he will continue moving up on his own when we are no longer pressing the <span class="emphasis"><em>W</em></span> key. This is shown in the next code snippet:</p></div><div class="informalexample"><pre class="programlisting">if (up == true)
{
  transform.Translate(Vector3.up * speed * Time.deltaTime);
}</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note46"></a>Note</h3><p>Once we have moved the hero down and therefore set his movement state to down, he will continue moving down on his own when we are no longer pressing the <span class="emphasis"><em>S</em></span> key. This is shown in the next code snippet.</p></div><div class="informalexample"><pre class="programlisting">if (down == true)
{
  transform.Translate(Vector3.down * speed * Time.deltaTime);
}</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note47"></a>Note</h3><p>Detect <a id="id434" class="indexterm"></a>if the input key from keyboard is <span class="emphasis"><em>S</em></span>. This is shown in the next line of code.</p></div><div class="informalexample"><pre class="programlisting">if (Input.GetKey(KeyCode.S))
{</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note48"></a>Note</h3><p>If the <span class="emphasis"><em>S</em></span> key is pressed, then we call the Animator function and set the the <code class="literal">down</code> parameter Animator's <code class="literal">bool</code> function to <code class="literal">true</code> and the rest of the parameters to <code class="literal">false</code>. This is so that the other animations transition to the <code class="literal">walkDown</code> animation.</p></div><div class="informalexample"><pre class="programlisting">  animator.SetBool("left", false);
  animator.SetBool("up", false);
  animator.SetBool("right", false);
  animator.SetBool("down", true);</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note49"></a>Note</h3><p>We do the same with the movement states. This is shown in the next code snippet.</p></div><div class="informalexample"><pre class="programlisting">  down = true;
  left = false;
  right = false;
  up = false;</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note50"></a>Note</h3><p>The hero moves down while we are pressing the <span class="emphasis"><em>S</em></span> key. This is shown in the next line of code.</p></div><div class="informalexample"><pre class="programlisting">  transform.Translate(Vector3.down * speed * Time.deltaTime);
}</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note51"></a>Note</h3><p>Detect if the input key from the keyboard is <span class="emphasis"><em>A</em></span>. This is shown in the next line of code.</p></div><div class="informalexample"><pre class="programlisting">if (Input.GetKey(KeyCode.A))
{</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note52"></a>Note</h3><p>If <a id="id435" class="indexterm"></a>the <span class="emphasis"><em>A</em></span> key is pressed, then we call the Animator function and set the <code class="literal">left</code> parameter of the Animator's <code class="literal">bool</code> function to <code class="literal">true</code> and the rest of the parameters to <code class="literal">false</code>. This is so that the other animations transition to the <code class="literal">walkLeft</code> animation. Have a look at the next lines of code.</p></div><div class="informalexample"><pre class="programlisting">animator.SetBool("down", false);
  animator.SetBool("right", false);
  animator.SetBool("up", false);
  animator.SetBool("left", true);</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note53"></a>Note</h3><p>We do the same with the movement states. Have a look at the next code snippet.</p></div><div class="informalexample"><pre class="programlisting">  down = false;
  left = true;
  right = false;
  up = false;</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note54"></a>Note</h3><p>The hero moves left while we are pressing the <span class="emphasis"><em>A</em></span> key. Have a look at the next line of code.</p></div><div class="informalexample"><pre class="programlisting">  transform.Translate(Vector3.left * speed * Time.deltaTime);
}</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note55"></a>Note</h3><p>Detect if the input key from the keyboard is <span class="emphasis"><em>W</em></span>. Have a look at the next line of code.</p></div><div class="informalexample"><pre class="programlisting">if (Input.GetKey(KeyCode.W))
{</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note56"></a>Note</h3><p>If the <span class="emphasis"><em>W</em></span> key is pressed, then we call the Animator function and set the <code class="literal">up</code> parameter Animator's <code class="literal">bool</code> function to <code class="literal">true</code> and the rest of the parameters to <code class="literal">false</code>. This is so that the other animations transition to the Walking Up animation. Have a look at the next code snippet.</p></div><div class="informalexample"><pre class="programlisting">  animator.SetBool("right", false);
  animator.SetBool("down", false);
  animator.SetBool("left", false);
  animator.SetBool("up", true);</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note57"></a>Note</h3><p>We <a id="id436" class="indexterm"></a>do the same with the movement states. Have a look at the next code snippet.</p></div><div class="informalexample"><pre class="programlisting">  down = false;
  left = false;
  right = false;
  up = true;</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note58"></a>Note</h3><p>The hero moves up while we press the <span class="emphasis"><em>W</em></span> key. Have a look at the next line of code.</p></div><div class="informalexample"><pre class="programlisting">  transform.Translate(Vector3.up * speed * Time.deltaTime);
}
}</pre></div></div></div>