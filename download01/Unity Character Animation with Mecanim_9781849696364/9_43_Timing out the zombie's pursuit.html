<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch09lvl1sec43"></a>Timing out the zombie's pursuit</h2></div></div><hr /></div><p>By adding the<a id="id603" class="indexterm"></a> time out, we allow the zombie to forget about the player after enough time has been spent out of range:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Add the following code to the list of variables at the top of the <code class="literal">zombie_nav_Start</code> script:</p><div class="informalexample"><pre class="programlisting">var alertTimeOut : float = 5.0;
var alertTimer : float;</pre></div><p>The variable <code class="literal">alertTimeOut</code> defines the time in seconds that it will take the zombie to forget about the player. Keeping this variable exposed, makes it easy to adjust in the <span class="strong"><strong>Inspector</strong></span> panel.</p><p>The next variable, <code class="literal">alertTimer</code>, keeps track of the time that has passed.</p></li><li><p>In the <code class="literal">Update</code> function, locate the following <code class="literal">if</code> statement:</p><div class="informalexample"><pre class="programlisting">if(playerDistance &lt;= attackRange &amp;&amp; !attacking)
{
 Attack();
}</pre></div></li><li><p>Add the following line of code after <code class="literal">Attack()</code>:</p><div class="informalexample"><pre class="programlisting">alertTimer = 0.0;</pre></div></li><li><p>After the closing curly bracket of the statement, add the following code: </p><div class="informalexample"><pre class="programlisting">else if(playerDistance &gt; alertDistance)
{
    alertTimer += Time.deltaTime;
    if(alertTimer &gt; alertTimeOut)
    {
        alerted = false;
    }
}</pre></div><p>The <code class="literal">else if</code> statement comes into play when <code class="literal">alerted</code> is <code class="literal">true</code> and the distance between the zombie and the player is greater than the <code class="literal">alertDistance</code> value.</p><p>When this is the case, we increase the <code class="literal">alertTimer</code> by time in seconds, and when this value reaches the <code class="literal">alertTimeOut</code> value, we set <code class="literal">alerted</code> to <code class="literal">false</code>, returning our zombie to her waypoint behavior.</p><p>For cleanliness, we zero out the <code class="literal">alertTimer</code> in the original <code class="literal">if</code> statement, so that the increase does not accumulate.</p></li><li><p>Save the script.</p></li><li><p>Test the game by pressing the <span class="strong"><strong>Play</strong></span> button.</p></li></ol></div><p>The zombie will move between the waypoints and then chase the player when he comes within range. If <a id="id604" class="indexterm"></a>we are able to get away far enough, the zombie will lose interest in the player and return to her patrol:</p><div class="mediaobject"><img src="/graphics/9781849696364/graphics/6364OT_09_11.jpg" /></div><p>There are lots more things we can do here with navMesh and Mecanim. For instance, we can set up a complex level in which multiple zombies have overlapping patrols. The player needs to negotiate to get through the game level.</p><p>In Unity, the navMesh toolset has many capabilities for triggering behavior and giving the appearance of intelligence. The pathfinding happens behind the scenes, allowing us to create more realistic and challenging enemy behaviors.</p></div>