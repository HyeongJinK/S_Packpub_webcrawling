<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch02lvl1sec17"></a>Rigging in Maya</h2></div></div><hr /></div><p>Like 3ds Max, Maya is a major software application used in game asset creation. One of its major advantages is that unlike 3ds Max, it is compatible with Mac operating systems. Its dependence<a id="id152" class="indexterm"></a> on key combinations rather than point and click icons arguably makes the modeling and rigging process faster.</p><p>Though Maya has fewer<a id="id153" class="indexterm"></a> options for rigging than 3ds Max, its rigging and <a id="id154" class="indexterm"></a>animation toolset is known for being easy to access and use.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec17"></a>Setting up Maya to rig our character model</h3></div></div></div><p>Before we import the model <a id="id155" class="indexterm"></a>and start adding the joints, we will spend a little time setting up Maya to ensure our rigged model is compatible with Unity.</p><p>These next steps are optional, but will make for a smoother workflow and more predictable result, particularly if you are working with a sourced model that you did not create yourself.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch02lvl3sec18"></a>Setting system units to meters</h4></div></div></div><p>Unity uses meters as<a id="id156" class="indexterm"></a> its default unit, so it makes sense to adopt this unit for our rigging work:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Start Maya.</p></li><li><p>Open the <span class="strong"><strong>Preferences</strong></span> tab by navigating to <span class="strong"><strong>Window</strong></span> | <span class="strong"><strong>Settings/Preferences</strong></span> | <span class="strong"><strong>Preferences</strong></span>.</p></li><li><p>When the window pops up, click on<span class="strong"><strong> Settings</strong></span> in the <span class="strong"><strong>Categories</strong></span> column on the left side of the window.</p></li><li><p>In the <span class="strong"><strong>Working Units</strong></span> group, change <span class="strong"><strong>Linear</strong></span> units to <span class="strong"><strong>Meters</strong></span>.</p></li><li><p>Click on the <span class="strong"><strong>Save</strong></span> button to store the settings.</p></li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch02lvl3sec19"></a>Changing the display grid size</h4></div></div></div><p>Typically, the<a id="id157" class="indexterm"></a> default grid display will not be a good size for work in meters, but this can be easily adjusted:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>In the main toolbar, click on the box next to <span class="strong"><strong>Display – Grid</strong></span> to open the <span class="strong"><strong>Grid Options</strong></span> window.</p></li><li><p>In the <span class="strong"><strong>Gridlines Every</strong></span> field, type <code class="literal">0.1</code>.</p></li></ol></div><p>This will divide every meter with 10 gridlines, spaced 10 centimeters apart.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch02lvl3sec20"></a>Importing the model</h4></div></div></div><p>Now that we have <a id="id158" class="indexterm"></a>got Maya set up, we can import out model, which is formatted as a <code class="literal">Wavefront OBJ</code> file. This is one of the more common 3D model formats:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Download and unzip the project files from the Packt website if you have not already done so.</p></li><li><p>Import the zombie character model into the new scene by navigating to <span class="strong"><strong>File</strong></span> | <span class="strong"><strong>Import...</strong></span>.</p></li><li><p>In the <span class="strong"><strong>Import</strong></span> window, navigate to the project files.</p></li><li><p>Double-click on the <code class="literal">Rigging Assets</code> folder and then the <code class="literal">Models</code> subfolder.</p></li><li><p>The female zombie model and texture are in the <code class="literal">zombie_f</code> folder.</p></li><li><p>Open the folder and select <code class="literal">zombie_f.obj</code>.</p></li><li><p>Click on the <span class="strong"><strong>Import</strong></span> button.</p><p>The character should appear in the main viewport. The model will appear face down, and by default, the <span class="strong"><strong>Wireframe</strong></span> viewport display is enabled.</p></li><li><p>Select the character mesh by clicking on it in the viewport.</p></li><li><p>In <span class="strong"><strong>Attribute Editor</strong></span> on the right side of the Maya interface, select the <code class="literal">zombie_f: zombie_f</code> node.</p></li><li><p>In the first <span class="strong"><strong>Rotate</strong></span> field, click on and drag to select the value.</p></li><li><p>Enter the value <code class="literal">90</code> and tap <span class="emphasis"><em>Enter</em></span>.</p><p>The character should now be rotated correctly in the viewport.</p></li><li><p>Activate<a id="id159" class="indexterm"></a> the <span class="strong"><strong>Smooth Shade All</strong></span> and <span class="strong"><strong>Textured</strong></span> viewport display buttons to make sure that the textures are visible on the character model.</p></li></ol></div><p>The character should now appear textured within the viewport:</p><div class="mediaobject"><img src="/graphics/9781849696364/graphics/6364OT_02_27.jpg" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch02lvl3sec21"></a>Adjusting the model scale</h4></div></div></div><p>In terms of real-world scale, we <a id="id160" class="indexterm"></a>can see that the zombie character model is not the right size for a typical human.</p><p>Maya imported the <code class="literal">obj</code> file at a half scale making the zombie character less than one meter tall! This is something that you need to watch out for when working with sourced models, as different 3D applications read model scale differently.</p><p>It is best to fix this issue now, before we start creating the joint hierarchy. We can also fix this issue within Unity, by adjusting the <span class="strong"><strong>Scale Factor</strong></span> option within the <span class="strong"><strong>Model Import</strong></span> settings as <a id="id161" class="indexterm"></a>demonstrated in <a class="link" href="#" linkend="ch01">Chapter 1</a>, <span class="emphasis"><em>The Zombie Attacks!</em></span>:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Click on the <span class="strong"><strong>Select Tool</strong></span> (or press the <span class="emphasis"><em>Q</em></span> key).</p></li><li><p>Select the zombie character's mesh in the viewport.</p></li><li><p>Switch to the <span class="strong"><strong>Scale Tool</strong></span> (or press the <span class="emphasis"><em>R</em></span> key).</p></li><li><p>In the <span class="strong"><strong>Channel Box</strong></span> list on the right side of the Maya interface, locate the <span class="strong"><strong>Scale</strong></span> fields.</p></li><li><p>Type <code class="literal">2.54</code> into the <span class="strong"><strong>Scale X</strong></span>, <span class="strong"><strong>Scale Y</strong></span>, and <span class="strong"><strong>Scale Z</strong></span> fields to scale the model uniformly.</p><p>The grid lines should show that the zombie character is now around <code class="literal">1.75</code> meters tall, which is a reasonable height for a human female.</p></li><li><p>Freeze the transform data to store the new scale by navigating to <span class="strong"><strong>Modify</strong></span> | <span class="strong"><strong>Freeze Transformations</strong></span>. </p></li></ol></div><p>In the next step, we will optimize the view to make the creation and adjustment of the rig easier.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch02lvl3sec22"></a>Adjusting the viewport display and toolset for joint creation</h4></div></div></div><p>We will switch to an<a id="id162" class="indexterm"></a> orthographic<a id="id163" class="indexterm"></a> view to make sure our joints are positioned accurately within the character model:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Tap space to activate the <span class="strong"><strong>Quad</strong></span> view.</p></li><li><p>Select the <span class="strong"><strong>Front</strong></span> viewport by right-clicking within it.</p></li><li><p>Tap space once more to maximize the front view.</p></li><li><p>Use the navigations hotkeys to zoom in on the upper half of the character's body. Use <span class="emphasis"><em>Alt</em></span> + right-click onto zoom, <span class="emphasis"><em>Alt</em></span> + middle-click to pan.</p></li><li><p>Switch back to the <span class="strong"><strong>Wireframe</strong></span> viewport display by clicking on the button at the top of the viewport or by tapping <span class="emphasis"><em>4</em></span> on the keyboard.</p></li><li><p>Choose the <span class="strong"><strong>Front</strong></span> viewport, and zoom out far enough that you can see the torso and head of the character. </p></li><li><p>If it is not already active, switch to the <span class="strong"><strong>Animation</strong></span> menu set, by clicking on the small arrow within the rectangular gray box in the top left of the interface: </p><div class="mediaobject"><img src="/graphics/9781849696364/graphics/6364OT_02_28.jpg" /></div></li></ol></div><p>Now, it is time<a id="id164" class="indexterm"></a> to start creating<a id="id165" class="indexterm"></a> the joint hierarchy.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch02lvl3sec23"></a>Creating joints for the back, neck, and head</h4></div></div></div><p>In Maya, the <a id="id166" class="indexterm"></a>vertices that make up a model are influenced by joints, rather than bones as in 3ds Max. Actually, this distinction doesn't make a lot of<a id="id167" class="indexterm"></a> difference in the rigging and animation of a character.</p><p>The zombie's skeleton will be<a id="id168" class="indexterm"></a> built using the joint tool:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Enable the <span class="strong"><strong>Animation</strong></span> toolset by clicking on the tab near the top middle of the interface.</p></li><li><p>Click on the <span class="strong"><strong>Joint Tool</strong></span> icon from the tool shelf near the top of the interface.</p></li><li><p>Click on the model at the pelvis to create the first joint.</p></li><li><p>Click it to add three more joints for the spine, one for the neck and the other one for the head.</p></li><li><p>When you are finished, exit the joint tool by clicking on the <span class="strong"><strong>Select</strong></span> tool from the main toolbar on the right of the interface.</p><p>By default, the joints are a little too small to be seen clearly in the viewport.</p></li><li><p>Navigate to <span class="strong"><strong>Display</strong></span> | <span class="strong"><strong>Animation</strong></span> | <span class="strong"><strong>Joint Size</strong></span>.</p></li><li><p>In the <span class="strong"><strong>Joint Display Scale</strong></span> window, change the scale from <code class="literal">1.00</code> to <code class="literal">2.00</code>. </p></li><li><p>Tap <span class="emphasis"><em>Enter</em></span> to save the change before closing the window.</p></li></ol></div><p>You will get the following output:</p><div class="mediaobject"><img src="/graphics/9781849696364/graphics/6364OT_02_29.jpg" /></div><p>Next, we<a id="id169" class="indexterm"></a> will implement <a id="id170" class="indexterm"></a>our joint naming <a id="id171" class="indexterm"></a>conventions.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch02lvl3sec24"></a>Renaming and repositioning the joints</h4></div></div></div><p>By default, Maya <a id="id172" class="indexterm"></a>names each joint with a number according to the order in<a id="id173" class="indexterm"></a> which it was created. Giving them more specific names will make the resulting skeleton much more user friendly:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Click on each joint in turn, using <span class="strong"><strong>Channel Box</strong></span> or <span class="strong"><strong>Attribute Editor</strong></span> to rename it:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>
<span class="strong"><strong>Joint1</strong></span>: <code class="literal">zombie_f_root</code>
</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Joint2</strong></span>: <code class="literal">zombie_f_spine</code>
</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Joint3</strong></span>: <code class="literal">zombie_f_spine1</code>
</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Joint4</strong></span>: <code class="literal">zombie_f_spine2</code>
</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Joint5</strong></span>: <code class="literal">zombie_f_neck</code>
</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Joint6</strong></span>: <code class="literal">zombie_f_head</code>
</p></li></ul></div></li><li><p>Switch to the <span class="strong"><strong>Right</strong></span> viewport.</p></li><li><p>Activate the <span class="strong"><strong>Move</strong></span> tool.</p></li><li><p>Drag each of the joints into position to follow the curve of the character's spine, starting with <code class="literal">zombie_f_root</code>.</p></li><li><p>You can cycle<a id="id174" class="indexterm"></a> down through the hierarchy using<a id="id175" class="indexterm"></a> the down cursor key: </p><div class="mediaobject"><img src="/graphics/9781849696364/graphics/6364OT_02_30.jpg" /></div></li></ol></div></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec18"></a>Creating the leg joints</h3></div></div></div><p>Usually while rigging a <a id="id176" class="indexterm"></a>symmetrical character like this, we can use the symmetry tools to copy joint chains from one side of the character to the other.</p><p>It makes sense to finish naming and positioning each joint before you copy the chain:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>In the <span class="strong"><strong>Right</strong></span> viewport, activate the <span class="strong"><strong>Joint Tool</strong></span> and create a joint for the upper leg.</p></li><li><p>Create further joints at the knee, ankle, ball of foot, and toe.</p></li><li><p>Rename the joints:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>
<span class="strong"><strong>Joint1</strong></span>: <code class="literal">zombie_f_thigh_L</code>
</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Joint2</strong></span>: <code class="literal">zombie_f_calf_L</code>
</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Joint3</strong></span>: <code class="literal">zombie_f_foot_L</code>
</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Joint4</strong></span>: <code class="literal">zombie_f_toe_L</code>
</p></li></ul></div></li><li><p>In the <span class="strong"><strong>Front</strong></span> viewport, move<a id="id177" class="indexterm"></a> the joints to fit within the character mesh: </p><div class="mediaobject"><img src="/graphics/9781849696364/graphics/6364OT_02_31.jpg" /></div></li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec19"></a>Creating the arm joints</h3></div></div></div><p>We will start the arm the same <a id="id178" class="indexterm"></a>way that we created the joint chains<a id="id179" class="indexterm"></a> for the leg. Because there are so many more joints in the hand, we will switch to using some different techniques to speed up the process:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Switch to the <span class="strong"><strong>Top</strong></span> view.</p></li><li><p>Reactivate the <span class="strong"><strong>Joint</strong></span> tool.</p></li><li><p>Create a single joint chain from the shoulder to the end of the index finger, clicking on to create a joint at each juncture.</p></li><li><p>Rename the joints:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>
<span class="strong"><strong>Joint1</strong></span>: <code class="literal">zombie_f_arm_L</code>
</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Joint2</strong></span>: <code class="literal">zombie_f_foreArm_L</code>
</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Joint3</strong></span>: <code class="literal">zombie_f_hand_L</code>
</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Joint4</strong></span>: <code class="literal">zombie_f_index_L</code>
</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Joint5</strong></span>: <code class="literal">zombie_f_index1_L</code>
</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Joint6</strong></span>: <code class="literal">zombie_f_index2_L</code>
</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Joint7</strong></span>: <code class="literal">zombie_f_index_NUB</code>
</p></li></ul></div></li><li><p>Center the <span class="strong"><strong>Arm</strong></span> joint within the shoulder.</p></li><li><p>Position the <span class="strong"><strong>foreArm</strong></span> joint a little further back to make sure the elbow bends correctly. </p></li><li><p>Switch between the <span class="strong"><strong>Front</strong></span>, <span class="strong"><strong>Top</strong></span>, <span class="strong"><strong>Right</strong></span>, and <span class="strong"><strong>Perspective</strong></span> viewports to arrange the remaining joints to fit the character mesh: </p><div class="mediaobject"><img src="/graphics/9781849696364/graphics/6364OT_02_32.jpg" /></div></li></ol></div><p>Getting the finger joints to line up correctly can be a little tricky. It helps to orbit around the hand in the <a id="id180" class="indexterm"></a>perspective view.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch02lvl3sec25"></a>Cloning the finger joints</h4></div></div></div><p>For the remaining<a id="id181" class="indexterm"></a> thumb and finger joints, you can clone those that you initially created for the index finger:</p><p>To do this:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Switch to and maximize the <span class="strong"><strong>Perspective</strong></span> viewport.</p></li><li><p>Use the keyboard combination <span class="emphasis"><em>Alt</em></span> + click to navigate the view until you are looking down at the hand.</p></li><li><p>Activate the <span class="strong"><strong>Smooth shade all</strong></span>, <span class="strong"><strong>Textured</strong></span>, and <span class="strong"><strong>XRay joints</strong></span> viewport displays by clicking on the small buttons at the top of the viewport.</p><p>This should make it easier to see the joints within the mesh.</p></li><li><p>Select the joint at the root of the index finger: <code class="literal">zombie_f_index</code>.</p></li><li><p>Use the keyboard combination <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>D</em></span> to duplicate the joints.</p><p>The whole chain will be duplicated and become selected.</p></li><li><p>Use the <span class="strong"><strong>Move</strong></span> tool to drag the root of the new finger chain so that it fits within the middle finger.</p></li><li><p>Rename the new joints and fine tune their positions before you do the same for the ring finger, little finger, and the thumb.</p></li></ol></div><p>Positioning these bones one at a time will make this process easier. The result should look like this:</p><div class="mediaobject"><img src="/graphics/9781849696364/graphics/6364OT_02_33.jpg" /></div></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec20"></a>Mirroring joints for the leg and arm chains</h3></div></div></div><p>The left side <a id="id182" class="indexterm"></a>of the zombie character's<a id="id183" class="indexterm"></a> skeleton has been completed—it is a simple task to duplicate the limb joints <a id="id184" class="indexterm"></a>for the right side:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Switch to the <span class="strong"><strong>Front</strong></span> viewport and select <code class="literal">zombie_f_thigh_L</code>.</p><p>This will select the whole chain of joints for the left leg.</p></li><li><p>From the menu at the top of the interface, click on the <span class="strong"><strong>Skeleton</strong></span> tab and then the options box next to <span class="strong"><strong>Mirror Joint</strong></span>. </p></li><li><p>In the <span class="strong"><strong>Mirror Joint Options</strong></span> window that appears, set the <span class="strong"><strong>Mirror across</strong></span> axis to <span class="strong"><strong>YZ</strong></span>. </p></li><li><p>In the <span class="strong"><strong>Replacement names for duplicated joints</strong></span> group, enter <code class="literal">L</code> in the <span class="strong"><strong>Search for:</strong></span> field and enter <code class="literal">R</code> in the <span class="strong"><strong>Replace with:</strong></span> field: </p><div class="mediaobject"><img src="/graphics/9781849696364/graphics/6364OT_02_34.jpg" /></div></li><li><p>Click <span class="strong"><strong>Apply</strong></span>.</p><p>This will recreate the joint chain on the right side of the character.</p><p>Maya will<a id="id185" class="indexterm"></a> replace the <span class="strong"><strong>L</strong></span> (for left) markers with <span class="strong"><strong>R</strong></span> (for right) in the joint names. However, it is always a good idea to go through and check each joint to make sure that the names are correct.</p></li><li><p>Use the same process to mirror the joints of the left arm.</p></li></ol></div><p>Next, we will attach the limb joint chains to the spine chain.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch02lvl3sec26"></a>Connecting the arm and leg chains</h4></div></div></div><p>Keeping the limb<a id="id186" class="indexterm"></a> chains separate from the main body joints is a good idea, while you are tweaking the positions within the character mesh.</p><p>Now, it is time to connect them:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Activate the <span class="strong"><strong>Select Tool</strong></span> by pressing the <span class="emphasis"><em>Q</em></span> key.</p></li><li><p>Click on<code class="literal"> zombie_f_thigh_L</code>.</p></li><li><p>
<span class="emphasis"><em>Shift</em></span> + click on <code class="literal">zombie_f_root</code> to add it to the selection.</p></li><li><p>From the main toolbar, click on<span class="strong"><strong> Skeleton</strong></span> and then select the options box next to <span class="strong"><strong>Connect Joints</strong></span>. </p></li><li><p>In the <span class="strong"><strong>Connect Joint Options</strong></span> window that pops up, click on the <span class="strong"><strong>Parent Joint</strong></span> radio button. </p><p>The joints will be connected.</p></li><li><p>Repeat this<a id="id187" class="indexterm"></a> operation for the right leg chain and both arm chains.</p></li></ol></div><p>It is usually a good idea to wait until the end to add any unique joints. In this case, the character has a ponytail which will be animated. We still need to add a joint for the lower jaw.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch02lvl3sec27"></a>Creating the ponytail and jaw joints</h4></div></div></div><p>These additional<a id="id188" class="indexterm"></a> joints will be used to add a little character to the animation sequences later in the book. They will be set up quite <a id="id189" class="indexterm"></a>simply:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Switch to the <span class="strong"><strong>Right</strong></span> viewport.</p></li><li><p>Activate the <span class="strong"><strong>Joint Tool</strong></span> and click on<code class="literal"> zombie_f_head</code> (making it the parent).</p></li><li><p>Add a joint at the portion of the mesh where the ponytail is connected to the back of the head.</p></li><li><p>Click within the geometry of the ponytail to create three additional joints. Try to position a joint where the hair starts to turn down, another in the widest part of the tail and the last where it terminates.</p></li><li><p>Click on the <span class="strong"><strong>Select Tool</strong></span> to exit <span class="strong"><strong>Joint Tool</strong></span>.</p></li><li><p>To create the jaw, activate <span class="strong"><strong>Joint Tool</strong></span>.</p></li><li><p>Click on <code class="literal">zombie_f_head</code>.</p></li><li><p>Create a joint, just beneath the character's ear.</p></li><li><p>Click on near the character's chin to create the second and last jaw joint. </p></li><li><p>Rename the additional joints using <span class="strong"><strong>Channel Box</strong></span> or <span class="strong"><strong>Attribute Editor</strong></span>, being careful to follow the character's naming conventions. </p></li></ol></div><p>This will result in a skeleton comprised of 69 joints, quite a few more than the minimum required by Mecanim:</p><div class="mediaobject"><img src="/graphics/9781849696364/graphics/6364OT_02_35.jpg" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch02lvl3sec28"></a>Aligning joint transforms</h4></div></div></div><p>You may note that<a id="id190" class="indexterm"></a> when you activate <span class="strong"><strong>Rotate Tool</strong></span>, the rotation axis for some of the joints is pointing in the wrong direction—this will cause a few problems when animating, or even testing the skin binding within Maya:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select <code class="literal">zombie_f_root</code>.</p></li><li><p>From the menu bar, click on<span class="strong"><strong> Skeleton</strong></span> and then the options box next to <span class="strong"><strong>Orient Joint</strong></span>. </p><p>The <span class="strong"><strong>Orient Joint Options</strong></span> window should appear.</p></li><li><p>Check the boxes for <span class="strong"><strong>Orient Joint to World</strong></span> and <span class="strong"><strong>Orient children of selected joints</strong></span>.</p></li><li><p>Click on <span class="strong"><strong>Apply</strong></span>:</p><div class="mediaobject"><img src="/graphics/9781849696364/graphics/6364OT_02_36.jpg" /></div></li></ol></div><p>All joints should <a id="id191" class="indexterm"></a>now face forward. The actual position of the joint chains should remain the same.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch02lvl3sec29"></a>Creating a test pose</h4></div></div></div><p>Now that we have a <a id="id192" class="indexterm"></a>symmetrical skeleton, we will go through the binding process and test this with a simple pose:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Hide the character mesh by selecting it in the viewport and navigating to <span class="strong"><strong>Display</strong></span> | <span class="strong"><strong>Hide</strong></span> | <span class="strong"><strong>Hide Selection</strong></span> from the menu bar.</p></li><li><p>Activate the <span class="strong"><strong>Auto Keyframe</strong></span> toggle, by clicking on the key button in the lower-right corner of the Maya interface. It will turn red when enabled.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note21"></a>Note</h3><p>If the <span class="strong"><strong>Auto Keyframe</strong></span> toggle is not visible in the Maya interface, it can be made visible in the menu bar. Navigate to <span class="strong"><strong>Display</strong></span> | <span class="strong"><strong>UI Elements</strong></span> and check the box next to <span class="strong"><strong>Range Slider</strong></span>.</p></div></li><li><p>Make sure <span class="strong"><strong>Time Slider</strong></span> is located at frame <code class="literal">1</code>.</p></li><li><p>Select <code class="literal">zombie_f_root</code> in the viewport.</p></li><li><p>Tap <span class="emphasis"><em>S</em></span> on the keyboard to create the first keyframe.</p></li><li><p>Drag the <span class="strong"><strong>Time Slider</strong></span> to frame <code class="literal">10</code>.</p></li><li><p>Rotate <code class="literal">zombie_f_root</code> a few degrees to the right or left.</p><p>When you return the Time Slider to its default position at frame <code class="literal">1</code>, the joint should return to its original rotation. </p></li><li><p>Continue this <a id="id193" class="indexterm"></a>process with the rest of the joints to create a simple test pose: </p><div class="mediaobject"><img src="/graphics/9781849696364/graphics/6364OT_02_37.jpg" /></div></li></ol></div><p>You can use the down cursor key to navigate down through the hierarchy of joints. This comes in particularly useful when there is a high density of joints like the fingers where selecting individual bones one at a time can be problematic.</p><p>Try not to make the pose too extreme. The binding only needs to be good enough to support the typical poses that your character will be in. If you set the bar too high by creating poses which are too gymnastic, you will have a hard time adjusting the skin weights to deform the character's topology in a realistic way.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec21"></a>Binding the character mesh to the skeleton</h3></div></div></div><p>The binding process<a id="id194" class="indexterm"></a> involves associating the character mesh with the hierarchy of joints, which make up the skeleton.</p><p>For organic-type characters, the smooth bind method is usually the best choice. Using a smooth bind each vertex in the character mesh can receive influence from more than one joint.</p><p>Typically, vertices near a joint will receive influence from this joint and the joint's parent in the hierarchy, creating the appearance of smooth bending in an elbow, shoulder, or knee:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Unhide the character mesh by navigating to <span class="strong"><strong>Display</strong></span> | <span class="strong"><strong>Show</strong></span> | <span class="strong"><strong>All</strong></span> in the menu bar.</p></li><li><p>Make sure <span class="strong"><strong>Time Slider</strong></span> is located at frame <code class="literal">1</code>.</p></li><li><p>Open the <span class="strong"><strong>Outliner</strong></span> tab and click on<code class="literal"> zombie_f_root</code> to select it.</p></li><li><p>Hold <span class="emphasis"><em>Shift</em></span> and click on the character mesh to add it to the selection.</p></li><li><p>From the menu bar click on <span class="strong"><strong>Skin</strong></span>.</p></li><li><p>Select <span class="strong"><strong>Bind Skin</strong></span> and then click on the options box next to <span class="strong"><strong>Smooth Bind</strong></span>. </p></li><li><p>In the <span class="strong"><strong>Smooth Bind Options</strong></span> window which pops up, change the <span class="strong"><strong>Max Influences</strong></span> to <code class="literal">4</code> (the maximum allowed by Unity). </p></li><li><p>Click on <span class="strong"><strong>Apply</strong></span>.</p></li></ol></div><p>Now, when you drag the <span class="strong"><strong>Time Slider</strong></span> to the test pose on frame <code class="literal">10</code>, the character mesh will deform to follow the joints:</p><div class="mediaobject"><img src="/graphics/9781849696364/graphics/6364OT_02_38.jpg" /></div><p>The default<a id="id195" class="indexterm"></a> settings are a good start, but you will usually need to fine tune these to get a smooth and lifelike result.</p><p>Maya will try to blend between the different joint influences, sometimes it will get it wrong. Quite often if the arms are close to the torso, the arm joints may influence the vertices in the torso or vice versa, as is the case here.</p><p>With the head of the character, sometimes too much influence is drawn from the neck bone, causing the lower part of the head to become distorted. This can be corrected by painting the skin weights to reduce the influence from the neck joint.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec22"></a>Painting skin weights</h3></div></div></div><p>To adjust the <a id="id196" class="indexterm"></a>skin weights:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select the character mesh.</p></li><li><p>Choose the <span class="strong"><strong>Wireframe On Shaded</strong></span> and <span class="strong"><strong>Smooth Shade All</strong></span> viewport display icons from the top of the viewport.</p></li><li><p>From the menu bar, click on<span class="strong"><strong> Skin</strong></span> and then select <span class="strong"><strong>Edit Smooth Skin</strong></span>. Click on the options box next to <span class="strong"><strong>Paint Skin Weights Tool</strong></span>. </p></li><li><p>From the <span class="strong"><strong>Tool Settings</strong></span> dialog that appears, select the joint whose influence you want to edit with the paintbrush cursor that appears in the viewport. </p></li><li><p>Begin painting the mesh to increase the joint's influence.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip06"></a>Tip</h3><p>You can change the size and softness of the brush and adjust the value as necessary in the <span class="strong"><strong>Tool Settings</strong></span> window.</p></div><p>As you<a id="id197" class="indexterm"></a> paint the weight for each joint, the mesh will appear white where there is the most influence and black where there is no influence:</p><div class="mediaobject"><img src="/graphics/9781849696364/graphics/6364OT_02_39.jpg" /></div><p>In this case, too much of the character's mesh is being influenced by the arm.</p></li><li><p>We can fix this by lowering the brush <span class="strong"><strong>Value</strong></span> field in the <span class="strong"><strong>Skin Weights</strong></span> window to <code class="literal">0</code>, by dragging it to the left, and then painting over the affected area.</p></li><li><p>We will<a id="id198" class="indexterm"></a> also need to repaint the weights for the spine joints so that they exert more influence over this area. Set the <span class="strong"><strong>Value</strong></span> field to <code class="literal">1.0</code>, and repaint the areas of the torso for each spine joint: </p><div class="mediaobject"><img src="/graphics/9781849696364/graphics/6364OT_02_40.jpg" /></div></li><li><p>Repeat this process for the rest of the character, working from the root joint down through the hierarchy and defining the influence from the parent joints before the child joints. </p></li><li><p>Terminal joints such as the end ponytail and jaw joints, and the last finger joints should not have any influence on the mesh, so assign all of the weight for these areas to the preceding joint. </p></li></ol></div><p>You may find it necessary to adjust the test pose in order to test the mesh deformation at all of the joints.</p><p>When the skin weight adjustments are complete, the last step is to export the skinned character in FBX format.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec23"></a>Exporting for unity</h3></div></div></div><p>Once we made <a id="id199" class="indexterm"></a>sure to save our progress, we will clean up the scene a little before exporting for Unity:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>First, we will delete the history by navigating to <span class="strong"><strong>Edit</strong></span> | <span class="strong"><strong>Delete By Type</strong></span> | <span class="strong"><strong>History</strong></span>.</p><p>This will make sure that no unwanted data is exported that may bloat our FBX file and cause problems in Unity.</p></li><li><p>Next, we will show everything within the viewport by navigating to <span class="strong"><strong>Display</strong></span> | <span class="strong"><strong>Show</strong></span> | <span class="strong"><strong>All</strong></span>. </p></li><li><p>Select the root joint <code class="literal">zombie_f_root</code>.</p></li><li><p>Activate <span class="strong"><strong>Outliner</strong></span> by navigating to <span class="strong"><strong>Window</strong></span> | <span class="strong"><strong>Outliner</strong></span>.</p></li><li><p>When the <span class="strong"><strong>Outliner</strong></span> window opens, <span class="emphasis"><em>Shift</em></span> + click on the <span class="strong"><strong>+</strong></span> symbol next to <code class="literal">zombie_f_root</code> in the list. </p><p>This will expand the joint hierarchy, allowing you to see all of the joints.</p></li><li><p>Add to the selection by holding <span class="emphasis"><em>Ctrl</em></span> (<span class="emphasis"><em>Cmd</em></span> on a Mac) and clicking on each of the joints in the <span class="strong"><strong>Outliner</strong></span> window. Ignore all terminal joints such as the last numbered joint from each finger, the ponytail, jaw, and the toe joints.</p><p>These joints have no actual influence on the character mesh, so they are redundant and are not needed in Unity.</p></li><li><p>When the remaining joints have been selected, add the character mesh to the selection before closing the <span class="strong"><strong>Outliner</strong></span>.</p></li><li><p>Export the selection by navigating to <span class="strong"><strong>File</strong></span> | <span class="strong"><strong>Export Selection</strong></span>.</p></li><li><p>When the <span class="strong"><strong>Export Selection</strong></span> window opens, make sure that FBX export is defined in the <span class="strong"><strong>Files of type</strong></span> drop-down list at the bottom of the window. </p></li><li><p>In the <span class="strong"><strong>Options</strong></span> panel on the right of the window, expand the <span class="strong"><strong>File Type Specific Options</strong></span> list. </p></li><li><p>In the <span class="strong"><strong>Units</strong></span> rollout, make sure that <span class="strong"><strong>File units converted to</strong></span> is set to <span class="strong"><strong>Centimeters</strong></span> and the <span class="strong"><strong>Automatic</strong></span> checkbox is unchecked: </p><div class="mediaobject"><img src="/graphics/9781849696364/graphics/6364OT_02_41.jpg" /></div></li><li><p>Leave the<a id="id200" class="indexterm"></a> remaining parameters at their default settings.</p></li><li><p>Designate a save location by navigating to an appropriate folder in the main area of the window.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note22"></a>Note</h3><p>It is not recommended to save FBX files directly to your Unity project. It is usually safer to create a folder somewhere on your hard drive, where you can output your FBX files before dragging them into Unity to import them.</p></div></li><li><p>Type <code class="literal">zombie_f</code> into the <span class="strong"><strong>File name</strong></span> field near the bottom of the interface.</p></li><li><p>Click on the <span class="strong"><strong>Export Selection</strong></span> button.</p></li></ol></div><p>The skinned <code class="literal">zombie_f</code> character has been exported, and it can be brought into Unity as demonstrated in <a class="link" href="#" linkend="ch01">Chapter 1</a>, <span class="emphasis"><em>The Zombie Attacks!</em></span>.</p></div></div>