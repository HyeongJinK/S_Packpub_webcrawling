<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch08lvl1sec60"></a>Atmospheric sounds</h2></div></div><hr /></div><p>Now, we <a id="id501" class="indexterm"></a>will create a system to handle atmospheric sounds. Atmospheric sounds are sound effects played in a game to give your scene more immersion. Some good examples are wind blowing in a field, the sounds of drowned out chatter in a pub, your character breathing hard after running for a while, and so on.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch08lvl2sec115"></a>Creating the script and variables</h3></div></div></div><p>To <a id="id502" class="indexterm"></a>start off, we will need to create a new script and<a id="id503" class="indexterm"></a> name it <code class="literal">ATM_Manager</code>. Next, we will <a id="id504" class="indexterm"></a>create <a id="id505" class="indexterm"></a>a few variables needed to play our sounds:</p><div class="informalexample"><pre class="programlisting">public List&lt;AudioClip&gt; tmpList = new List&lt;AudioClip&gt;();
public List&lt;string&gt; keys = new List&lt;string&gt;();
public List&lt;KeyValuePair&lt;string, AudioClip&gt;&gt; atmList = new List&lt;KeyValuePair&lt;string, AudioClip&gt;&gt;();
public float atmVolume = 1.00f;</pre></div><p>The first three variables that we create are lists. The first of our lists is an <code class="literal">AudioClip</code> list, which will hold the sound files that we will use. Next, we create a string list, which we will fill with the name of the sound file that we want to call within our code. The last list is a <code class="literal">KeyValuePair</code> list, which will put together the strings and <code class="literal">AudioClip</code> variables we just created, and put them in a list that we will call within our code. The last variable we create will be for the volume of the sounds.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch08lvl2sec116"></a>Initializing the variables</h3></div></div></div><p>To give <a id="id506" class="indexterm"></a>a value to our list that we will use within<a id="id507" class="indexterm"></a> the code, we will create a <code class="literal">Start</code> function that initializes the list. Add this to your <code class="literal">Start</code> function:</p><div class="informalexample"><pre class="programlisting">void Start()
{
  audio.volume = atmVolume;
  int i = 0;
  atmList.Capacity = keys.Capacity;
  foreach(AudioClip ac in tmpList)
  {
    atmList.Add(new KeyValuePair&lt;string, AudioClip&gt;(keys[i], ac));
    i++;
  }
}</pre></div><p>First, we<a id="id508" class="indexterm"></a> assign the volume of <code class="literal">AudioSource</code> to <a id="id509" class="indexterm"></a>our volume variable. Next, we create an iterator for what we will do next. To assign our internal list, we set its capacity equal to the capacity of the string list. Next, we run a <code class="literal">foreach</code> loop to check for every <code class="literal">AudioClip</code> within the temporary list that we created earlier. Finally, for each of the audio clips, we add a new <code class="literal">KeyValuPair</code> item, which includes the name that we want to call within the code, and the associating <code class="literal">AudioClip</code> to it.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch08lvl2sec117"></a>Playing the atmospheric sounds</h3></div></div></div><p>We will <a id="id510" class="indexterm"></a>create two possible ways to play our atmospheric sounds. First, we will allow the sound to play and have it loop, which would be helpful for a rain sound effect or wind sound effect. Add this function to your script:</p><div class="informalexample"><pre class="programlisting">void PlayRepeat(string atmSong)
{
  for(int i = 0; i &lt; atmList.Count; i++)
  {
    if(atmList[i].Key == atmSong)
    {
      audio.clip = atmList[i].Value;
      break;
    }
  }

  audio.loop = true;
  audio.Play();
}</pre></div><p>This function takes a string. This string will be used to select the sound to be played. A good example for this would be if you wanted to play a rain atmospheric sound, you would have a key that is assigned as <code class="literal">Rain</code> in your <code class="literal">KeyValuePair</code> list and its <code class="literal">AudioClip</code> value would be a rain sound file.</p><p>Within the <code class="literal">PlayRepeat</code> function, we use a <code class="literal">for</code> loop to iterate through the <code class="literal">KeyValuePair</code> list. If one of the keys in the <code class="literal">KeyValuePair</code> list matches the string passed <a id="id511" class="indexterm"></a>to the <code class="literal">PlayRepeat</code> function, we assign the clip of the <code class="literal">AudioSource</code> to that key's value, which would be an <code class="literal">AudioClip</code>. Lastly, we break the <code class="literal">for</code> loop, set the <code class="literal">AudioSource</code> loop property to <code class="literal">true</code>, and play the sound.</p><p>Next, we will add a function that will allow us to play a sound that doesn't loop. Add this function to the script:</p><div class="informalexample"><pre class="programlisting">void Play(string atmSong)
{
  for(int i = 0; i &lt; atmList.Count; i++)
  {
    if(atmList[i].Key == atmSong)
    {
      audio.clip = atmList[i].Value;
      break;
    }
  }

  audio.loop = false;
  audio.Play();
}</pre></div><p>This function will run in the same way as the <code class="literal">PlayRepeat</code> function, except we aren't setting the loop property of the <code class="literal">AudioSource</code> list. Since the loop property isn't being set to <code class="literal">true</code>, the sound will only play once.</p></div></div>