<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch07lvl1sec56"></a>Creating the SaveHandler script</h2></div></div><hr /></div><p>Now, we <a id="id471" class="indexterm"></a>create a script that allows us to call the functions that we just created from the preceding two scripts. First, we create a checkpoint system that saves game data at specific points within the game. Then, we create a way to allow the player to save their data whenever they want to. To get started, create a new script, and name it <code class="literal">SaveHandler</code>.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec110"></a>The checkpoint system</h3></div></div></div><p>The first <a id="id472" class="indexterm"></a>way in which we create to save and load data<a id="id473" class="indexterm"></a> is a checkpoint system. Checkpoints are typically areas in the game world on reaching which the game will save the player's data. Add this function to allow the checkpoint to save:</p><div class="informalexample"><pre class="programlisting">void OnTriggerEnter(Collider other)
{
  if(other.tag == "SavePoint")
  {
    Camera.main.SendMessage("WriteToFile");
    Destroy(other.gameObject);
  }
}</pre></div><p>This is a trigger-based method to save. When the player enters the triggered area, the game will save the player's data. Within the <code class="literal">if</code> statement, you can call any of the save functions we created. You should take note that this function also destroys the trigger object so that the player can't reactivate the checkpoint.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec111"></a>The save anywhere-anytime system</h3></div></div></div><p>To allow<a id="id474" class="indexterm"></a> the player to save their data <a id="id475" class="indexterm"></a>anywhere they want and anytime they want, we add some kind of option for them to call it freely. This can be done by adding to the menu a key or a button, or both, that the player presses. For this example, we will let the player press keys on the keyboard to save and load. Add the following function to create this functionality;</p><div class="informalexample"><pre class="programlisting">void Update()
{
  if(Input.GetKeyUp(KeyCode.F1))
  {
    Camera.main.SendMessage("SaveEnemies");
  }
  if(Input.GetKeyUp(KeyCode.F2))
  {
    Camera.main.SendMessage("LoadEnemies");
  }
}</pre></div><p>When the <a id="id476" class="indexterm"></a>player presses the <span class="emphasis"><em>F1</em></span> key, we call the <code class="literal">SaveEnemies</code> function from the XML save system. If the player presses the <span class="emphasis"><em>F2</em></span> key, we call the <code class="literal">LoadEnemies</code> function<a id="id477" class="indexterm"></a> from the XML save system. With this functionality, the players can save their progress at any time.</p></div></div>