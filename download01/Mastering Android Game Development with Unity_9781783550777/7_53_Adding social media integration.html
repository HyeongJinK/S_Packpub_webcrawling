<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch07lvl1sec52"></a>Adding social media integration</h2></div></div><hr /></div><p>First, let us setup a Facebook share integration. Go to <a class="ulink" href="https://developers.facebook.com/" target="_blank">https://developers.facebook.com/</a> that will open the Facebook developer site. Log in with your Facebook login and password:</p><div class="mediaobject"><img src="/graphics/9781783550777/graphics/image_07_053.png" /></div><p>Click on <strong class="userinput"><code>My Apps</code></strong> box on the top and select the <strong class="userinput"><code>Add a New App</code></strong> option:</p><div class="mediaobject"><img src="/graphics/9781783550777/graphics/image_07_054.png" /></div><p>Type in the name of the game in the <strong class="userinput"><code>Display Name</code></strong> field. Add your contact e-mail address and select <strong class="userinput"><code>Apps for Pages</code></strong> option in the <strong class="userinput"><code>Category</code></strong> list. Then click on the <strong class="userinput"><code>Create App ID</code></strong> button.</p><p>In settings click on <strong class="userinput"><code>+ Add Platform</code></strong> button at the bottom and choose Android. Add the package name for the app and add in the <strong class="userinput"><code>Class Name</code></strong> field, which will also be in the reverse website name with the class name at the end. When we create a manager in Unity, we have to make sure that the class name matches this:</p><div class="mediaobject"><img src="/graphics/9781783550777/graphics/image_07_055.png" /></div><p>You will also get an App ID, copy this information as this will be required. Next on the top-right corner, there is a button called <strong class="userinput"><code>DOCs</code></strong>, click it as we will need to download the Facebook SDK for Unity. Click on Unity SDK from the list and the SDK will start downloading:</p><div class="mediaobject"><img src="/graphics/9781783550777/graphics/image_07_056.png" /></div><p>Once the SDK is downloaded, make sure your current unity project is open and import the package:</p><div class="mediaobject"><img src="/graphics/9781783550777/graphics/image_07_057.png" /></div><p>Check all the boxes and click on the <strong class="userinput"><code>Import</code></strong> button:</p><div class="mediaobject"><img src="/graphics/9781783550777/graphics/image_07_058.png" /></div><p>You will see that there is a new <strong class="userinput"><code>Facebook</code></strong> tab on your project, click on it and select <strong class="userinput"><code>Edit Settings</code></strong> options:</p><div class="mediaobject"><img src="/graphics/9781783550777/graphics/image_07_059.png" /></div><p>In the <strong class="userinput"><code>Inspector</code></strong> type, the <strong class="userinput"><code>App Name (Optional</code></strong>) and <strong class="userinput"><code>App ID [?]</code></strong> fields are as it appears on the Facebook Developer Console:</p><div class="mediaobject"><img src="/graphics/9781783550777/graphics/image_07_060.png" /></div><p>Next, create a new class called <code class="literal">fbManager</code>. In the class, add the following code:</p><pre class="programlisting">    using System.Collections; 
    using System.Collections.Generic; 
    using UnityEngine; 

    using Facebook.Unity; 
    using System.Linq; 

    public class fbManager : MonoBehaviour 
    { 
        void Awake() { 
            if (!FB.IsInitialized) { 
                FB.Init(); 
            } else { 
                FB.ActivateApp(); 
            } 
        } 

        public void Share() { 
            if (FB.IsLoggedIn) 
            { 
                FB.ShareLink(contentTitle: "Growl Games Studio", 
                    contentURL: new System.Uri  
                    ("http://www.growlgamesstudio.com"), 
                    contentDescription: "Like and Share my page", 
                    callback: onShare);  
            } else { 
                // Debug.Log("User Cancelled Login"); 
                FB.LogInWithReadPermissions(null, callback: onLogin); 
            }         
        } 

        private void onLogin(ILoginResult result) { 
            if (result.Cancelled) 
            { 
                Debug.Log(" user cancelled login"); 
            } 
            else { 
                Share(); 
            } 
        } 

        private void onShare(IShareResult result) { 
            if (result.Cancelled || !string.IsNullOrEmpty 
               (result.Error)) 
            { 
                Debug.Log("sharelink error: " + result.Error); 
            } else if(!string.IsNullOrEmpty(result.PostId)) { 
                ... 
            } 
        } 
    } // class </pre><p>In the <code class="literal">Awake</code> function, first we check whether Facebook SDK is initialized. If not then we initialize it and we activate the app.</p><p>The <code class="literal">Share</code> function is the function that we will call when the Facebook button is pressed from the main menu.</p><p>Once the button is pressed, the function will check whether the user is logged in. If they are logged in then the post is made using the <code class="literal">sharelink</code> function. We pass in the content title, a link to the website, and a description. We also provide a call back function that will check if the post was made or not.</p><p>If the user is not logged in then, we log in using the <code class="literal">loginWithPermissions</code> function. We also pass in a call back function that will check if the user has logged in. Once the user is logged in the function will call the share function.</p><p>While sharing if it was cancelled the <code class="literal">onShare</code> call back function will specify if there is an error, otherwise it will post a message. Now create a new button in the MainMenu for Facebook sharing and call the <code class="literal">Share</code> function once the button is pressed.</p><p>You also need to install <span class="strong"><strong>openSSL</strong></span> as it is a requirement for Facebook. Download and install OpenSSL from <a class="ulink" href="https://code.google.com/archive/p/openssl-for-windows/downloads" target="_blank">https://code.google.com/archive/p/openssl-for-windows/downloads</a>. Download, unzip, and install it. Next, go to Start and search for <code class="literal">Environment Variables</code>. Open it.</p><p>Under the <strong class="userinput"><code>System Variables</code></strong> section, look for the path and press <strong class="userinput"><code>Edit</code></strong>.</p><p>Under <strong class="userinput"><code>Edit Environment Variables</code></strong>, click New and type in the OpenSSL binary location. Click OK. Next click New again and add the JDK binary location. Click <strong class="userinput"><code>OK</code></strong> and exit:</p><div class="mediaobject"><img src="/graphics/9781783550777/graphics/image_07_061.png" /></div><p>You might get build errors as when you installed Facebook SDK there might be older versions of <code class="literal">support-annotations-23.4.0.jar</code> and <code class="literal">support-v4-23.4.0.aar</code> library present. You will have to manually go into the Facebook Android library folder and delete these files. So go to the location and delete the files:</p><div class="mediaobject"><img src="/graphics/9781783550777/graphics/image_07_062.png" /></div><p>Now build and run the application and click on the Facebook button on the main menu that you created. Once logged in you are ready to post on Facebook:</p><div class="mediaobject"><img src="/graphics/9781783550777/graphics/image_07_063.png" /></div><p>Next we will look at Twitter sharing. Twitter sharing is really easy. Create one more button on the MainMenu for calling Twitter share and attach a function that will get called once the button is pressed. I created a function called <code class="literal">openTwitter</code> in the <code class="literal">buttonClick</code> class as follows:</p><pre class="programlisting">    public void openTwitter() {
        string appStoreLink = 
        "https://play.google.com/store/apps/details? 
        id=com.growlgamesstudio.pizZapMania"; 

        string twitterAddress = "http://twitter.com/intent/tweet"; 
        string descriptionParameter = "Punchy Punch"; 
        string message = "GET THIS AWERSOME GAME";//text string 

        Application.OpenURL(twitterAddress + "?text=" + 
            WWW.EscapeURL(message + "n" + descriptionParameter + "n" 
            + appStoreLink)); 
    }  </pre><p>You will create strings that will store values for app store links, the twitter tweet intent address link, a description, and a message. Then you will call <code class="literal">Application.OpenURL</code> and pass the information as a string.</p><p>Now, when you build the application and press the Twitter button, you will be able to share a tweet:</p><div class="mediaobject"><img src="/graphics/9781783550777/graphics/image_07_064.png" /></div></div>