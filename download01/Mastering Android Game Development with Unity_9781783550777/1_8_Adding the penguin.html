<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch01lvl1sec13"></a>Adding the penguin</h2></div></div><hr /></div><p>In this section, we will learn how to add our penguin player to the game and how we can make her alive by writing scripts, applying physics, and adding colliders in it.</p><p> </p><p> </p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec14"></a>Importing the penguin Sprite</h3></div></div></div><p>Before we do anything, we need a player Sprite or image. For our Perky Penguin game, we have designed a penguin sprite. The following figure shows the penguin that is included as the player sprite of the game:</p><div class="mediaobject"><img src="/graphics/9781783550777/graphics/image_01_035.png" /></div><p>Figure 1.35 Penguin Sprite</p><p>To import an image in to Unity, right-click on the <strong class="userinput"><code>Graphics</code></strong> folder in the <strong class="userinput"><code>Project Browser</code></strong> panel and click on <strong class="userinput"><code>Import New Asset...</code></strong>, as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783550777/graphics/image_01_036.png" /></div><p>Figure 1.36 Import New Asset in Unity</p><p>These assets can be anything that is supported by Unity, such as images, audio files, 3D models, textures, materials, and scripts.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note11"></a>Note</h3><p>Assets can also be imported by dragging image files from Explorer to Unity's project browser panel.</p></div><p>Unity shows all the images with nice previews. It must be noted here that if Unity is in 2D mode, then unity will show images as sprites and if mode is set to 3D mode it shows the images as textures. <span class="emphasis"><em>Figure 1.36</em></span> shows both scenarios. The following screenshot shows the image imported as sprite and the screenshot besides it shows image imported as texture:</p><div class="mediaobject"><img src="/graphics/9781783550777/graphics/image_01_037.png" /></div><p>Figure 1.37 Images as Sprites (left) and Images as Textures (right)</p><p>If the penguin image is imported as texture, then there is nothing to worry about. Select the image from <strong class="userinput"><code>Project Browser</code></strong> panel, and in the inspector change the<strong class="userinput"><code> Texture Type</code></strong> to <strong class="userinput"><code>Sprite</code></strong> and click Apply. It is shown in the following figure:</p><div class="mediaobject"><img src="/graphics/9781783550777/graphics/image_01_038.png" /></div><p>Figure 1.38 Change Texture Type of Image in Inspector Panel</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec15"></a>Creating penguin game object</h3></div></div></div><p>After the assets are imported, which in our case is a single penguin image, we have to create a game object of player. Usually game objects are created by right-clicking in <strong class="userinput"><code>Hierarchy </code></strong>and selecting <strong class="userinput"><code>Create Empty</code></strong> as shows in the following figure:</p><div class="mediaobject"><img src="/graphics/9781783550777/graphics/image_01_039.png" /></div><p>Figure 1.39 Creating Empty Game Object</p><p>But, in order to create sprites as game objects, simply drag sprites from the <strong class="userinput"><code>Project Browser</code></strong> panel to <strong class="userinput"><code>Hierarchy</code></strong> or <strong class="userinput"><code>Scene View</code></strong> panels and a game object will be created with the name of image file which is <code class="literal">penguin_fly.png</code> here. This is shown in the following figure:</p><div class="mediaobject"><img src="/graphics/9781783550777/graphics/image_01_040.png" /></div><p>Figure 1.40 Creating Sprite Game Object</p><p>Now it's time to configure the <strong class="userinput"><code>penguin_fly</code></strong> game object of <strong class="userinput"><code>Hierarchy</code></strong> to get used in the game. Now select the <strong class="userinput"><code>penguin_fly</code></strong> object and make following changes in the <strong class="userinput"><code>Inspector</code></strong> panel.</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Change the game object's name to <code class="literal">penguin</code>.</li><li>Set the position values to (0, 0, 0).</li></ol></div><div class="mediaobject"><img src="/graphics/9781783550777/graphics/image_01_041.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>To add a collider in the penguin, click <strong class="userinput"><code>Add Component</code></strong> in the inspector and select <strong class="userinput"><code>Circle Collider 2D</code></strong> from <strong class="userinput"><code>Physics2D</code></strong> menu as shown in the following figure. More about Colliders can be read here <a class="ulink" href="https://docs.unity3d.com/ScriptReference/Collider.html" target="_blank">https://docs.unity3d.com/ScriptReference/Collider.html</a>:</li></ol></div><div class="mediaobject"><img src="/graphics/9781783550777/graphics/image_01_042.png" /></div><p>Figure 1.41 Adding Circle Collider 2D</p><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>Set the value of <strong class="userinput"><code>Radius</code></strong> of <strong class="userinput"><code>Circle Collider 2D</code></strong> to 0.6.</li><li>To make the penguin behave as a physical object, we have to add <strong class="userinput"><code>Rigid Body</code></strong> component. To add it, click <strong class="userinput"><code>Add Component</code></strong> in the Inspector panel and select <strong class="userinput"><code>Rigid Body 2D</code></strong> from <strong class="userinput"><code>Physics2D</code></strong> as shown in the following figure:</li></ol></div><div class="mediaobject"><img src="/graphics/9781783550777/graphics/image_01_043.png" /></div><p>Figure 1.42 Adding Rigid Body 2D</p><div class="orderedlist"><ol class="orderedlist arabic" start="6" type="1"><li>Set <strong class="userinput"><code>Fixed Angle</code></strong> checkbox state as checked on to avoid penguin to be rotated while falling or jumping due to physics dynamics.</li></ol></div><p>The following figure below shows all the steps performed on the penguin game object:</p><div class="mediaobject"><img src="/graphics/9781783550777/graphics/image_01_044.png" /></div><p>Figure 1.43 Penguin Inspector Settings</p><p>Starting from position, we have set the position to zero just for testing purposes. We will change it later when we put penguin at its initial position. The <strong class="userinput"><code>Sprite Renderer</code></strong> component is already added in the penguin game object because penguin game object was created from sprite by dragging it from <strong class="userinput"><code>Project Browser</code></strong> panel. The <strong class="userinput"><code>Sprite Renderer</code></strong> allows any game object to show an image on the screen from any sprite. In order to make any game object to react to physics collisions and get collided with each other, game object requires collider component in it. We have added <strong class="userinput"><code>Circle Collider 2D</code></strong> on the penguin object. You can choose any type of collider from the list. But it is recommended to choose the collider which is very light and fills the whole colliding area. The following figure shows the penguin with different colliders applied to it:</p><div class="mediaobject"><img src="/graphics/9781783550777/graphics/image_01_045.png" /></div><p>Figure 1.44 Penguins with Different Colliders</p><p>Using complex colliders like <strong class="userinput"><code>Polygon Collider 2D</code></strong> makes it harder to detect collision for the physics engine to detect collision, which in turn, creates a performance penalty. Finally, in order to apply gravity on the penguin, we have added <strong class="userinput"><code>Rigid Body 2D</code></strong> component. <strong class="userinput"><code>Rigid Body 2D</code></strong> allows any game objects to behave to the gravity, friction, physics kinematics and so on. We have check <strong class="userinput"><code>Fixed Angle</code></strong> to on state of the <strong class="userinput"><code>Rigid Body 2D</code></strong>. If this is set to off, then penguin will also rotate due to wind, friction, gravity, or any other force applied on it. So in order to avoid her to rotate while jumping, we have set <strong class="userinput"><code>Fixed Angle</code></strong> as checked.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note12"></a>Note</h3><p>There are <strong class="userinput"><code>Physics</code></strong> components and <strong class="userinput"><code>Physics2D</code></strong> components. These both are very different in functionality and are used for very different purposes. You must be very careful when apply physics components on the game objects.</p></div><p>When you run the project, you will notice that penguin will fall down on the screen. It is because of the gravity is pulling penguin downwards and it goes off the screen. The <strong class="userinput"><code>Gravity Scale</code></strong> value, which is 1 by default, decides the gravity of the penguin. If we remove or disable <strong class="userinput"><code>Rigid Body 2D</code></strong> component, then penguin will never move. So, it must be noted that without rigid body no force and collision will be applied on the game object.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec16"></a>Adding script behavior on penguin object</h3></div></div></div><p>After setting physics components and position on penguin object, it's time to define some logic behavior of the penguin. The game's requirements are to let penguin fly through its jetpack when screen is touched by player and penguin will fall when touch is stopped. These kinds of logic are defined in Unity through scripts. Unity supports 2 kinds of scripts; C# and JavaScript. You can use any of these scripts. Even you can also use few files in C# and few other files in JavaScript in the same project. Throughout this book, we will do all the scripting through C#.</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>We will start by creating a C# script file in Scripts folder in Assets by right-clicking on <strong class="userinput"><code>Scripts</code></strong> folder and choose <strong class="userinput"><code>C# Script</code></strong> from <strong class="userinput"><code>Create</code></strong> menu as shown in the following figure:</li></ol></div><div class="mediaobject"><img src="/graphics/9781783550777/graphics/image_01_046.png" /></div><p>Figure 1.45 Adding a C# Script</p><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Let's call this script as <code class="literal">PenguinController.cs</code> and when you open it, the Unity's default Code Editor <span class="strong"><strong> Visual Studio</strong></span> will start and open the newly created script file it as shown in the following figure.</li></ol></div><div class="mediaobject"><img src="/graphics/9781783550777/graphics/image_01_047.png" /></div><p>Figure 1.46 A C# Script File in MonoDevelop</p><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>You might notice some code already written in this file. We will discuss about it in a while. Now a script has been created, but this script is not linked or connected to our penguin object or even the game. In order to apply it on the penguin object, select <strong class="userinput"><code>penguin</code></strong> game object, click on <strong class="userinput"><code>Add Component</code></strong> in the <strong class="userinput"><code>Inspector</code></strong> panel, and choose <strong class="userinput"><code>PenguinController.cs</code></strong> from Scripts menu as shown in the following figure:</li></ol></div><div class="mediaobject"><img src="/graphics/9781783550777/graphics/image_01_048.png" /></div><p>Figure 1.47 Adding C# Script on Penguin GameObject</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note13"></a>Note</h3><p>You can also apply script on the game object by directly dragging script file on the game object in hierarchy view.</p></div><p>Now, as the script is applied on the penguin game object, let's write some logic and code to make the penguin fly. Open <code class="literal">PenguinController.cs</code> file from project browser panel by double-clicking it in MonoDevelop. The code which is already written looks like the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783550777/graphics/image_01_049.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>The <code class="literal">PenguinController</code> class is inherited from <code class="literal">MonoBehaviour</code> class. Any script to be applied on any game object placed in the scene should be a <code class="literal">MonoBehaviour</code> class and this is done by inheriting the class from it. <code class="literal">MonoBehaviour</code> class provides some basic functionality for game objects such as its life cycle like when object is created, when it is active, when it is destroyed etc. Also it provides some functionality like interactions such as mouse down or mouse up etc. For now, we have only two methods <code class="literal">Start()</code> and <code class="literal">Update()</code>. The <code class="literal">Start()</code> method is called when the game object becomes first time active on the scene at runtime and <code class="literal">Update()</code> method is called on each frame if the game object is enabled or active.</li></ol></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note14"></a>Note</h3><p>You can also use Visual Studio 2012 with Unity for C# scripts by installing Visual Studio Unity Tools and importing UnityVS packaging in the project.</p></div><div class="orderedlist"><ol class="orderedlist arabic" start="5" type="1"><li>Now, let's start our logic for penguin. We will start from creating a variable <code class="literal">jetpackForce</code> in the class like this:</li></ol></div><pre class="programlisting">        public float jetpackForce = 75.0f;</pre><p> </p><div class="orderedlist"><ol class="orderedlist arabic" start="6" type="1"><li>We have set its initial float value to 75 and f letter is to make it float literal. There is an interesting thing about Unity that all the public fields in any class will be shown in game object's inspector component and can be altered or modified directly from the editor without opening the code file. The following shows the <code class="literal">jetpackForce</code> variable's field in the inspector panel:</li></ol></div><div class="mediaobject"><img src="/graphics/9781783550777/graphics/image_01_051.png" /></div><p>Figure 1.48 The jetpackForce Field in the Inspector Panel</p><div class="orderedlist"><ol class="orderedlist arabic" start="7" type="1"><li>Next is to use this <code class="literal">jetpackForce</code>'s value as the force to apply on penguin when touch is pressed. In order to detect touches, we have to use <code class="literal">Input.GetButton()</code> method. But this method is better used in either <code class="literal">Update()</code> or <code class="literal">FixedUpdate()</code> methods of <code class="literal">MonoBehaviour</code> class. The <code class="literal">FixedUpdate()</code> method is called every fixed frame instead of every frame. Meaning that in FixedUpdate() if the FPS of the game is 60 then the FixedUpdate function will be called 60 times in a second. Irrespective if there are any changes to the scene. In comparison the <code class="literal">Regular Update ()</code> function gets doesn't stick to the 60 fps rule and will update when there is a change in the scene. This should be used when dealing with <strong class="userinput"><code>RigidBody</code></strong>. As our penguin is a <strong class="userinput"><code>RigidBody2D</code></strong>, so it's better to use <code class="literal">FixedUpdate()</code> method than <code class="literal">Update().</code> The <code class="literal">PenguinController.cs</code> script doesn't contain <code class="literal">FixedUpdate()</code> method, so let's add the following code in the class now:</li></ol></div><pre class="programlisting">        void FixedUpdate()
        {
            bool jetpackkActive = Input.GetButton ("Fire1);
            if (jetpackActive = true) {
                this.GetComponent&lt;Rigidbody&gt;().AddForce(new Vector2(0, 
                jetpackForce));
            }
        }</pre><p> </p><div class="orderedlist"><ol class="orderedlist arabic" start="8" type="1"><li>There is nothing difficult here. We are polling for the input of Fire1 button which is a left-click in case of any PC, Linux, or MAC build and it changes to touch on Android, iPhone or other touch device. If the screen is touched, then <code class="literal">GetButton()</code> will return true value, which in turn lets script add force by calling <code class="literal">AddForce()</code> method of the <strong class="userinput"><code>RigidBody2D</code></strong> component and passing the <code class="literal">jetpackForce</code> value in the y-direction.</li></ol></div><p>Following is the whole <code class="literal">PenguinController.cs</code> file's code: </p><div class="mediaobject"><img src="/graphics/9781783550777/graphics/image_01_053.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="9" type="1"><li>Now, when you run the game the penguin will start falling. On clicking on screen, the penguin will rise up a little and will start falling again. The more frequently clicks are performed, the higher penguin will go up and it will easily be out of the screen within 2 or 3 clicks. Also it is falling very fast. In order to adjust its speed, either we decrease <strong class="userinput"><code>Gravity Scale</code></strong> from <strong class="userinput"><code>RigidBody2D</code></strong> of the penguin object as shown in the following figure on left side or we decrease the <strong class="userinput"><code>Gravity</code></strong> in the <strong class="userinput"><code>Physics2D</code></strong> settings shown in the figure on right side.</li></ol></div><div class="mediaobject"><img src="/graphics/9781783550777/graphics/image_01_054.png" /></div><p>Figure 1.49 Gravity Scale of Penguin (left) and Gravity of Physics2D (right)</p><p>We will change the <strong class="userinput"><code>Gravity</code></strong> value of <strong class="userinput"><code>Physics2D</code></strong> settings to -15. You can open <strong class="userinput"><code>Physics2D</code></strong> settings from <strong class="userinput"><code>Edit - Project Settings - Physics2D</code></strong> menu.</p><p>Now run the game, and you will notice the penguin will fall slower than before. On clicking many times, you might notice that penguin gets out of the screen. This kind of behavior in the games should be avoided. So, in order to limit the penguin within the screen bounds, we will add floor and ceiling in the game. Let's see how it's done in the next section.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec17"></a>Limiting the penguin between screen bounds</h3></div></div></div><p>Adding floor and ceiling is quite simpler job. We will create an empty object first. It should be noted that we are not importing any images or sprite assets in the scene, because we only need boundaries not the visuals of those about how these will look. Here is how we create our floor object.</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">Create empty game object by choosing <strong class="userinput"><code>GameObject - Create Empty</code></strong> menu.</li><li style="list-style-type: disc">Select newly created empty game object in the <strong class="userinput"><code>Hierarchy</code></strong> panel.</li><li style="list-style-type: disc">Rename it to <code class="literal">floor</code>.</li><li style="list-style-type: disc">Set its <strong class="userinput"><code>Position</code></strong> to (0, -3.25, 0).</li><li style="list-style-type: disc">Set its <strong class="userinput"><code>Scale</code></strong> to (14.4, 1, 1).</li><li style="list-style-type: disc">Add <strong class="userinput"><code>Box Collider 2D</code></strong> component by clicking on <strong class="userinput"><code>Add Component</code></strong>, and selecting <strong class="userinput"><code>Physics2D - Box Collider 2D</code></strong> option.</li></ul></div><p>Now you should be seeing a green rectangle on bottom of screen. This is the box collider of the floor and when you run the game, the penguin will never fall off the screen and it will stop when collided with the floor.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note15"></a>Note</h3><p>We haven't added <strong class="userinput"><code>Rigid Body 2D</code></strong> on floor object because we don't want to apply gravity on the floor object due to its static nature.</p></div><p>Similarly, now add ceiling game object with the name <code class="literal">ceiling</code> and its position of (0, 3.25, 0) and its scale of (14.4, 1, 1). Apply <strong class="userinput"><code>Rigid Body 2D</code></strong> component on the ceiling object, and now run the project. You will observe that penguin now never leaves the screen and it is limited between the upper and lower parts of the screen.</p></div></div>