<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch04lvl1sec43"></a>Setting the Character Controller</h2></div></div><hr /></div><p>The Character Controller<a id="id254" class="indexterm"></a> is designed for the first- and third-person control systems. It comes with movement control in all four directions, jump controls, and independent control of the camera, so the player can run in one direction and shoot in another.</p><p>A pretty clear way to describe the Character Controller is by saying that it is very precise with regard to movement, though it lacks fluidity: the character accelerates to maximum speed in the blink of an eye, turns on a dime, and stops the very moment you release the button. In other words, the feeling you get using a Character Controller is not very realistic, and to make it more fluid so it looks realistic, you need to turn to coding.</p><p>The Character Controller also doesn't implement physics by itself. It detects collisions but doesn't push or apply forces to the other GameObjects in the scene unless you program it to do so. As a matter of fact, it wouldn't even be affected by gravity if the scripts attached to it didn't make it!</p><p>As for collisions, the Character Controller only works with static Capsule Colliders. This means that it is specifically designed for things that resemble humanoid characters and that the Capsule Collider attached to the controller cannot be rotated when the mesh does.</p><p>On the other hand, the Character Controller has a pretty useful parameter called <code class="literal">isGrounded</code><a id="id255" class="indexterm"></a> that states whether a character has its feet on the ground. The variable is linked to another parameter called <span class="strong"><strong>Slope Limit</strong></span><a id="id256" class="indexterm"></a> to set the maximum verticality of the surfaces we want the character to be able to climb on. Basically, it is a system that automatically prevents the character from walking on walls. Such a useful feature is not available with a Rigidbody.</p><p><span class="strong"><strong>Step Offset</strong></span> is<a id="id257" class="indexterm"></a> another very useful parameter provided with Character Controllers that takes care of stating whether the character can step over an object or not. Thanks to this, we can allow the character to step over things such as steps or crates. With a Rigidbody, such elementary behavior must be specifically coded!</p><p>Many other properties are available to set up the Character Controller. With the next recipe, we show the most important ones, as we attach and set up a platforming-style Character Controller to our game character. Our plan is to prototype a side-scroller, and Unity offers exactly what we need. If you inspect the folder where we imported the <span class="strong"><strong>Character Controller</strong></span> package, you should see a <code class="literal">JS</code> script named <span class="strong"><strong>PlatformInputController</strong></span> in the <span class="strong"><strong>Scripts</strong></span> folder. That's the script we are going to attach to the game character.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec103"></a>Getting ready</h3></div></div></div><p>By dragging <span class="strong"><strong>PlatformInputController</strong></span> onto the game character in the scene, four new elements appear in the <span class="strong"><strong>Inspector</strong></span> panel: a component, the <span class="strong"><strong>Character Controller</strong></span> itself, and two scripts—<span class="strong"><strong>CharacterMotor</strong></span> and <span class="strong"><strong>PlatformInputController</strong></span>. They are responsible for providing the character with the standard capabilities required by side-scrolling platform games, and by setting their properties, we define the behavior of our game character.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec104"></a>How to do it...</h3></div></div></div><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Access the Scripts folder in the <span class="strong"><strong>Project</strong></span> panel. Select <a id="id258" class="indexterm"></a>
<span class="strong"><strong>PlatformInputController</strong></span> in the <code class="literal">Scripts</code> folder of the <span class="strong"><strong>Character Controller</strong></span> and drag it onto the game character in the scene.</p><div class="mediaobject"><img src="/graphics/9781783553594/graphics/3594OT_04_05.jpg" /></div></li><li><p>The <span class="strong"><strong>Character Controller</strong></span>, the <span class="strong"><strong>Character Motor</strong></span>, and the <span class="strong"><strong>Platform Input Controller</strong></span> components are added to our character. Now we can tweak their properties one by one to get the controls we like.</p><div class="mediaobject"><img src="/graphics/9781783553594/graphics/3594OT_04_06.jpg" /></div></li><li><p>Let's begin by <a id="id259" class="indexterm"></a>inspecting the <span class="strong"><strong>Character Controller</strong></span> component. The <span class="strong"><strong>Slope Limit</strong></span> parameter defines how steep the ground is so that the character is able to walk on it. Surfaces steeper than this value in degrees are considered walls and block the character. Very useful!</p></li><li><p>The <span class="strong"><strong>Step Offset</strong></span> field defines the maximum height of objects that the character can step over. Unity manually suggests to keep this value between <code class="literal">0.1</code> and <code class="literal">0.4</code>, assuming a standard character with a height of <code class="literal">2.0</code> in Unity units. And so we do!</p></li><li><p>The <span class="strong"><strong>Skin Width</strong></span> field is a crucial parameter to prevent the character from getting stuck on walls and other obstacles should their respective colliders compenetrate each other. Very large values my cause the character to pierce into obstacles, while very small values may lead to no collision detection at all, so tweaking may become necessary with this parameter.</p></li><li><p><span class="strong"><strong>Center</strong></span>, <span class="strong"><strong>Radius</strong></span>, and <span class="strong"><strong>Height</strong></span> are pretty self-explanatory. <span class="strong"><strong>Center</strong></span> defines the origin of the capsule collider that surrounds the mesh. <span class="strong"><strong>Radius</strong></span> and <span class="strong"><strong>Height</strong></span> are used to tweak the dimensions of the capsule to adapt it to the character model.</p><p>Take a look at the following<a id="id260" class="indexterm"></a> screenshot to check the configuration of the <span class="strong"><strong>Character Controller</strong></span> component:</p><div class="mediaobject"><img src="/graphics/9781783553594/graphics/3594OT_04_07.jpg" /></div></li><li><p>The <span class="strong"><strong>Character Motor</strong></span> and <span class="strong"><strong>Platform Input Controller</strong></span> scripts are predefined scripts that have been added with the package to the project. <span class="strong"><strong>Character Motor</strong></span> defines the actual behavior of the character by controlling parameters such as its horizontal speed and acceleration, as well as jump height. <span class="strong"><strong>Platform Input Controller</strong></span>, on the other hand, takes care of taking the input from the player and turning it into actual character actions on screen. We suggest you check out the forums to know more about these two important scripts. The following links are good ones to <a id="id261" class="indexterm"></a>start <a id="id262" class="indexterm"></a>with:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p><a class="ulink" href="http://forum.unity3d.com/threads/unity-3-character-motor-documentation.63917/" target="_blank">http://forum.unity3d.com/threads/unity-3-character-motor-documentation.63917/</a></p></li><li style="list-style-type: disc"><p><a class="ulink" href="http://answers.unity3d.com/questions/747207/side-scroller-controller-advice.html" target="_blank">http://answers.unity3d.com/questions/747207/side-scroller-controller-advice.html</a></p></li></ul></div></li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec105"></a>How it works...</h3></div></div></div><p>Adding <span class="strong"><strong>Character Controller</strong></span> to a <a id="id263" class="indexterm"></a>character basically means equipping the character with means to interact with the game world by defining its collider and how it walks on surfaces. Then, two scripts take care of the rest: <span class="strong"><strong>Character Motor</strong></span> defines the behavior of the character, how fast it walks, accelerates, runs, or jumps, while <span class="strong"><strong>Platform Input Controller</strong></span> takes care of turning the input from the player into character controls, specifically designed for platform games.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec106"></a>There is more...</h3></div></div></div><p>By inspecting the properties of the <span class="strong"><strong>Character Motor</strong></span> script, you may have noticed that a parameter called Gravity<a id="id264" class="indexterm"></a> is available. You tweak this value to increase or decrease how strong the ground attracts the character when it falls.</p><p>We stated previously that the Character Controller doesn't implement gravity by itself, and that is still the case—while the Character Controller simulates physics through custom coding instructions of a script attached to the GameObject itself, gravity with the Rigidbody is based on the Unity physics engine, the renewed NVIDIA PhysX.</p></div></div>