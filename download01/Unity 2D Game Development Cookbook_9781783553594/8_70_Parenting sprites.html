<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch08lvl1sec77"></a>Parenting sprites</h2></div></div><hr /></div><p>Inverse kinematics<a id="id497" class="indexterm"></a> is a technique consisting of placing joints between elements that move together so that the movement of one element influences the other elements it is attached to. Our body, for example, is a collection of parts connected with joints that move according to rules of inverse kinematics. When we raise an arm, the arm, forearm and the hand, as well as the individual fingers, all follow according to their joints.</p><p>By setting the pivot points on the sprite chunks at the end of the previous recipe, we actually defined the joints to build the inverse kinematics for the character. Now we will parent the pieces together by their pivot points so that we can finally animate the character.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch08lvl2sec203"></a>Getting ready</h3></div></div></div><p>We keep up from where we left, so have your project open and be ready to follow our instructions.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch08lvl2sec204"></a>How to do it...</h3></div></div></div><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Let's start by creating<a id="id498" class="indexterm"></a> new <span class="strong"><strong>Empty</strong></span> <span class="strong"><strong>GameObject</strong></span> in the scene and naming it <code class="literal">Character</code>.</p></li><li><p>Select all pieces of the knight (six in total) and drag them onto <span class="strong"><strong>Character</strong></span> in the scene.</p></li><li><p>Unity opens a window asking us to save the animation clip we are about to create. Go to <span class="strong"><strong>Assets</strong></span> | <span class="strong"><strong>Sprites</strong></span> | <span class="strong"><strong>Anims</strong></span> and name the clip <code class="literal">attack</code>, as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783553594/graphics/3594OT_08_36.jpg" /></div></li><li><p>Uncheck <span class="strong"><strong>Root Motion</strong></span> and check <span class="strong"><strong>Animate Physics</strong></span> in the <span class="strong"><strong>Animator</strong></span> panel in the <span class="strong"><strong>Inspector</strong></span> window, (just as we did before) as shown in this screenshot (if you don't remember what root motion is, you can check it out in <a class="link" href="#" linkend="ch01">Chapter 1</a>, <span class="emphasis"><em>Importing 3D Models and Animations</em></span>):</p><div class="mediaobject"><img src="/graphics/9781783553594/graphics/3594OT_08_37.jpg" /></div></li><li><p>Now we can actually parent the pieces belonging to the knight. All the chunks should be in the scene by now. If they are not, drag them one at a time into the scene.</p></li><li><p>Let's start by <a id="id499" class="indexterm"></a>parenting <span class="strong"><strong>Body</strong></span> to <span class="strong"><strong>Character</strong></span>. Select <span class="strong"><strong>Body</strong></span> in the <span class="strong"><strong>Hierarchy</strong></span> window and drag it onto <span class="strong"><strong>Character</strong></span>.</p></li><li><p><span class="strong"><strong>Body</strong></span> will be our reference for all other pieces. Now drag <span class="strong"><strong>Head</strong></span> onto <span class="strong"><strong>Body</strong></span>.</p></li><li><p>Then drag <span class="strong"><strong>Arm_L</strong></span> and <span class="strong"><strong>Arm_R</strong></span> onto <span class="strong"><strong>body</strong></span>.</p></li><li><p>Finally, drag <span class="strong"><strong>Foot_L</strong></span> and <span class="strong"><strong>Foot_R</strong></span> similarly. The following screenshot shows <span class="strong"><strong>Hierarchy</strong></span> you should see in your own editor:</p><div class="mediaobject"><img src="/graphics/9781783553594/graphics/3594OT_08_38.jpg" /></div></li><li><p>If you check out your character in the editor scene or the game scene, you may notice that the body parts of the knight actually overlap and produce a few perspective glitches. As we learned in the recipe titled <span class="emphasis"><em>Setting Up Sprites</em></span> of this chapter, when a sprite is instantiated in the game scene, Unity automatically provides it with a <span class="strong"><strong>Sprite Renderer</strong></span> component. By inspecting the <span class="strong"><strong>Sprite Render</strong></span> panel in the <span class="strong"><strong>Inspector</strong></span> window, you should see two properties we didn't mention so far: <span class="strong"><strong>Sorting Layer</strong></span> and <span class="strong"><strong>Order in Layer</strong></span>.</p></li><li><p><span class="strong"><strong>Sorting Layer</strong></span> defines the order in which the sprites are rendered on screen on a macro scale, so to say. You can use layers to send all background elements of a scene to the back so that animated sprites can be drawn above them. To create a new sorting layer, click on the drop-down menu in the panel (which should be on default right now) and select <span class="strong"><strong>Add Sorting Layer...</strong></span>, as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783553594/graphics/3594OT_08_39.jpg" /></div></li><li><p><span class="strong"><strong>Order in Layer</strong></span> <a id="id500" class="indexterm"></a>defines the order inside a layer created by the user: the higher the number, the closer the sprite to the eyes of the player.</p></li><li><p>In our case, we could assign indexes as follows: <code class="literal">0</code> to <span class="strong"><strong>Body</strong></span>, <code class="literal">1</code> to <span class="strong"><strong>Head</strong></span> and <span class="strong"><strong>Foot_R</strong></span>, <code class="literal">2</code> to <span class="strong"><strong>Arm_R</strong></span>, and <code class="literal">-1</code> to <span class="strong"><strong>Arm_L</strong></span> and <span class="strong"><strong>Foot_L</strong></span>. Here is a screenshot that shows the result we should get:</p><div class="mediaobject"><img src="/graphics/9781783553594/graphics/3594OT_08_60.jpg" /></div></li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch08lvl2sec205"></a>How it works...</h3></div></div></div><p>Parenting game o<a id="id501" class="indexterm"></a>bjects in Unity is really easy; all it takes is to drag one object onto another in the <span class="strong"><strong>Hierarchy</strong></span> panel. Once two or more objects are parented together, you can move, rotate, or scale the entire group by manipulating the highest element in the hierarchy, but you can also manipulate the individual child objects by selecting them. The <span class="strong"><strong>Sprite Renderer</strong></span> component also allows you to set single sprites from the same image in the correct rendering order by defining positive or negative indexes.</p><p>With the pivot points set and the parts correctly parented together, we are ready to finally animate the knight, which we will cover in our next recipe.</p></div></div>