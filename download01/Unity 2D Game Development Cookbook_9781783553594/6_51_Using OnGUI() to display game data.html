<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch06lvl1sec60"></a>Using OnGUI() to display game data</h2></div></div><hr /></div><p>As we are <a id="id381" class="indexterm"></a>gathering game data about the player's performance, we <a id="id382" class="indexterm"></a>can display that information on screen to the player's advantage.</p><p>Unity offers a collection of functions and constructs to display game data on the screen and create the <span class="strong"><strong>Graphic User Interface</strong></span> (<span class="strong"><strong>GUI</strong></span>)<a id="id383" class="indexterm"></a> of your game. <code class="literal">OnGUI()</code> is an important method available in Unity and used to create and control GUI elements to be displayed on the screen. Inside the function, it is possible to put lines of code that create interface controls such as text fields, buttons, and sliders at runtime. We advise you to check out the following <a id="id384" class="indexterm"></a>link:</p><p><a class="ulink" href="http://docs.unity3d.com/Manual/gui-Basics.html" target="_blank">http://docs.unity3d.com/Manual/gui-Basics.html</a></p><p>In this recipe, we will use the <code class="literal">OnGUI()</code> function to display game data. We will create a script to access the number of lives and the items collected, and display them on the screen.</p><p>We need a couple of screenshots to be used as icons too, so get ready to follow our instructions.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec154"></a>Getting ready</h3></div></div></div><p>The first step is to import the images to be used to display the information on the screen. The plan is to have a small character icon in the bottom-left corner for every available life, and an icon and a number in the top-right corner to display the number of collected items.</p><p>To display both of these pieces of information on screen we make use of a method called <code class="literal">Graphics.DrawTexture()</code>. It creates a rectangular area on the screen and draws a texture inside it. The texture to be displayed can be passed as a global <span class="strong"><strong>Texture</strong></span> type variable. Several extra parameters can be set for the rectangle area, and their details have been explained in the <a id="id385" class="indexterm"></a>manual available at <a class="ulink" href="http://docs.unity3d.com/ScriptReference/Graphics.DrawTexture.html" target="_blank">http://docs.unity3d.com/ScriptReference/Graphics.DrawTexture.html</a>.</p><p>Let's do it!</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec155"></a>How to do it…</h3></div></div></div><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Access <a id="id386" class="indexterm"></a>the <code class="literal">Texture</code> folder<a id="id387" class="indexterm"></a> in your project and right-click anywhere inside the window to open the menu. Select <span class="strong"><strong>Import New Asset</strong></span>, as shown in this screenshot:</p><div class="mediaobject"><img src="/graphics/9781783553594/graphics/3594OT_06_10.jpg" /></div></li><li><p>Select the images named <span class="strong"><strong>lifeIcon</strong></span> and <span class="strong"><strong>collIcon</strong></span> from the package provided with this book. Alternatively, you can create your own images to use. In that case, remember to save them in PNG format.</p></li><li><p>Select <span class="strong"><strong>lifeIcon</strong></span> from the folder and check its <span class="strong"><strong>Alpha is Transparency</strong></span> property, as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783553594/graphics/3594OT_06_11.jpg" /></div></li><li><p>Repeat the<a id="id388" class="indexterm"></a> operation to <a id="id389" class="indexterm"></a>import and set up the <span class="strong"><strong>collIcon</strong></span> PNG image.</p></li><li><p>Next, we create a new script in the <code class="literal">Scripts</code> folder and name it <span class="strong"><strong>GUI</strong></span> as well. Then we open it in <span class="strong"><strong>Monodevelop</strong></span>.</p></li><li><p>We begin by declaring two public variables of the <span class="strong"><strong>Texture</strong></span> type to store the references to these pics, and two private variables to store the references to the scripts where we take the data to be displayed on screen. Add the following lines to the script:</p><div class="informalexample"><pre class="programlisting">  public Texture lifeIcon;
  public Texture collIcon;
  private PlatManager platScript;
  private Runner runScript;</pre></div><p>In the <code class="literal">Start()</code> function, as usual, we initialize the variables by getting the <code class="literal">plat_manager</code> and <code class="literal">runner</code> references. The following instructions must be added to the script:</p><div class="informalexample"><pre class="programlisting">  // Use this for initialization
  void Start () {
  platScript = GameObject.Find("plat_manager").GetComponent&lt;PlatManager&gt;();
    runScript = GameObject.Find ("runner").GetComponent&lt;Runner&gt;();
  }</pre></div></li><li><p>The next step is to use the <code class="literal">OnGUI()</code> function to draw the icons on the screen. We use a <code class="literal">for</code> loop to draw a life icon for each available life. Add the following lines to the script:</p><div class="informalexample"><pre class="programlisting">  void OnGUI(){
    for(int i=0; i&lt;platScript.lives; i++){
      Graphics.DrawTexture(new Rect(10 + (60*i), 600, 50, 50), lifeIcon);
    }
  }</pre></div></li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec156"></a>How it works…</h3></div></div></div><p>The logic<a id="id390" class="indexterm"></a> to display a number of icons based <a id="id391" class="indexterm"></a>on a numeric parameter is pretty straightforward; we loop between the number of lives in the <code class="literal">OnGUI()</code> function itself. As <code class="literal">OnGUI()</code> is called at least once per frame (actually, it can be called more than once per cycle), the number of icons displayed on screen is always updated with the actual number of lives.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec157"></a>There's more...</h3></div></div></div><p>The <code class="literal">OnGUI()</code> function is called before the GUI elements on the screen are rendered, and after events such as an input from the player (mouse, buttons, and so on). As a consequence, <code class="literal">OnGUI()</code> may be called several times during an update cycle. For that reason, it is not advisable to put game controls in the <code class="literal">OnGUI()</code> function. There is an interesting <a id="id392" class="indexterm"></a>article about this available at <a class="ulink" href="http://answers.unity3d.com/questions/197798/clarification-on-updates-physics-events-order-and.html" target="_blank">http://answers.unity3d.com/questions/197798/clarification-on-updates-physics-events-order-and.html</a>.</p></div></div>