<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch04lvl1sec29"></a>Adding a pause menu</h2></div></div><hr /></div><p>Now that we have the main menu, we will move on next to building something else that most games will need, a pause menu. In PC games, this will likely be triggered by the <span class="emphasis"><em>Esc</em></span> key, whereas in a mobile game, it typically needs its very own button. We will make it so that this project supports both.</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>To start off, let's open up the <strong class="userinput"><code>Gameplay</code></strong> scene by going to the Project window and then opening the <code class="literal">Assets/Scenes</code> folder and double-clicking on <strong class="userinput"><code>Gameplay</code></strong>, thus saving the <strong class="userinput"><code>MainMenu</code></strong> level if you didn't do so already:</li></ol></div><div class="mediaobject"><img src="/graphics/9781787288713/graphics/f1b3370a-626f-4fce-b4b4-aefbdee69f8d.png" /></div><p>Before we create a button to open our pause menu, let's go ahead and create the pause menu first that we'll be opening.</p><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>The first thing we'll do is dim our screen when we enter the pause menu. An easy way to do that is having an image scale to cover our entire screen, which is what the <code class="literal">Panel</code> object does by default. We can create it by selecting <strong class="userinput"><code>Game Object</code></strong> | <strong class="userinput"><code>UI</code></strong> | <strong class="userinput"><code>Panel</code></strong>. Note that this creates a Canvas and an <strong class="userinput"><code>EventSystem</code></strong> object in addition to the <strong class="userinput"><code>Panel</code></strong> because one doesn't exist already.</li></ol></div><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>Rename Panel to Pause Menu. Then, we'll change the <strong class="userinput"><code>Color</code></strong> property of the object's <code class="literal">Image</code> component to black with a higher transparency by increasing the alpha channel (A) to <code class="literal">175</code>:</li></ol></div><div class="mediaobject"><img src="/graphics/9781787288713/graphics/222bb224-289f-453c-9f39-d5c885c6913c.png" /></div><p>The Image component works in a similar manner to the <strong class="userinput"><code>Sprite Renderer</code></strong> for 2D games with information on an image to draw and the color to use for it.</p><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>The current image has a thin border, which I'm not a fan of, in this case. You may keep it if you'd like, but I'm going to remove it and change the <strong class="userinput"><code>Source Image</code></strong> to <strong class="userinput"><code>None (Sprite)</code></strong> by selecting the current one and pressing the <span class="emphasis"><em>Delete</em></span> key:</li></ol></div><div class="mediaobject"><img src="/graphics/9781787288713/graphics/cd9f82ef-fa27-4932-b1a6-c3f425d9567b.png" /></div><p>Now that we have this, we will need to populate the menu with content. In this case, we will have a text object saying that the game is paused and some buttons allowing the player to resume, restart, or return to the main menu.</p><div class="orderedlist"><ol class="orderedlist arabic" start="5" type="1"><li>Let's create another panel to hold our pause menu contents. We want this panel to be a child of our Pause Menu object, so we can do this easily by going to the Hierarchy window, right-clicking on the <code class="literal">Pause Menu</code>, and selecting <strong class="userinput"><code>UI</code></strong> | <strong class="userinput"><code>Panel</code></strong>.</li></ol></div><p>Now, for this panel, I don't want it to take up the entire screen, so I will use another component to modify its size based on the resolution we receive. In this case, I will use an Aspect Ratio Fitter component.</p><div class="orderedlist"><ol class="orderedlist arabic" start="6" type="1"><li>From the <strong class="userinput"><code>Inspector</code></strong> window, scroll all the way down and then select <strong class="userinput"><code>Add Component</code></strong> and start typing in <code class="literal">Aspect</code>. From there, select <strong class="userinput"><code>Aspect Ratio Fitter</code></strong> and then press the <span class="emphasis"><em>Enter</em></span> key.</li></ol></div><div class="orderedlist"><ol class="orderedlist arabic" start="7" type="1"><li>Afterward, go to our newly added component and change the <strong class="userinput"><code>Aspect Mode</code></strong> to <code class="literal">Fit in Parent</code> to ensure that the panel will always fit within our screen and set the Aspect Ratio to <code class="literal">0.5</code>. This means that it will be twice as high as it is wide (width over height, which means ½—<code class="literal">0.5</code>).</li></ol></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note46"></a>Note</h3><p>If you go to the <strong class="userinput"><code>Game</code></strong> window and switch aspect ratios, you'll note that the menu will stay in a similar shape.
For more information on the Aspect Ratio Fitter component check out:<a class="ulink" href="https://docs.unity3d.com/Manual/script-AspectRatioFitter.html" target="_blank">https://docs.unity3d.com/Manual/script-AspectRatioFitter.html</a>.</p></div><div class="orderedlist"><ol class="orderedlist arabic" start="8" type="1"><li>This is good, but I don't want to have the panel stuck directly to the edge of our screen, so we will make this object invisible by clicking on the checkmark by the <strong class="userinput"><code>Image</code></strong> component.</li><li>Then, right-click on the Panel object and create another panel by going to <strong class="userinput"><code>UI</code></strong> | <strong class="userinput"><code>Panel</code></strong>. Rename this new object as Pause Menu Contents and then change the <strong class="userinput"><code>Rect Transform</code></strong> component's left, right, top, and bottom values to 10 to give us a border around the screen.</li><li>We will use physical buttons like last time, so let's move to the <strong class="userinput"><code>Canvas</code></strong> object, and under the <strong class="userinput"><code>Canvas Scaler</code></strong> component, change the <strong class="userinput"><code>UI Scale Mode</code></strong> to <strong class="userinput"><code>Constant Physical Size</code></strong>:</li></ol></div><div class="mediaobject"><img src="/graphics/9781787288713/graphics/8ebd4616-6326-4f0d-aeeb-61383b055fa3.png" /></div><p>We could place everything manually like we did previously by hand, but in this case, we may want to use another feature that Unity's UI System has: Layout Groups.</p><p><span class="strong"><strong>Layout Groups</strong></span> will make resize children of an object with that component automatically to fit the area of the parent. There are several different layout groups, including grid-based, horizontal, and vertical. In our case, the menu will probably be vertical.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note47"></a>Note</h3><p>For more information on Unity's way of automatically creating layouts, check out: <a class="ulink" href="https://docs.unity3d.com/Manual/UIAutoLayout.html" target="_blank"><span>https://docs.unity3d.com/Manual/UIAutoLayout.html</span></a>.</p></div><div class="orderedlist"><ol class="orderedlist arabic" start="11" type="1"><li>Select the <strong class="userinput"><code>Pause Menu Contents</code></strong> object in the <strong class="userinput"><code>Hierarchy</code></strong> window and then switch to the <strong class="userinput"><code>Inspector</code></strong> window. From there, scroll all the way down to the <strong class="userinput"><code>Add Component</code></strong> option and select it. Type in <strong class="userinput"><code>Vertical Layout Group</code></strong> and select it.</li><li>Let's create some children to fit in our menu. From the <strong class="userinput"><code>Hierarchy</code></strong> window, right-click on the <strong class="userinput"><code>Pause Menu Contents</code></strong> object and select <strong class="userinput"><code>UI</code></strong> | <strong class="userinput"><code>Button</code></strong>.</li><li>This creates a button, but you'll note that it looks pretty much like a normal button. Let's open up its child <strong class="userinput"><code>Text</code></strong> object and change the text to <strong class="userinput"><code>Resume</code></strong>.</li><li>Afterward, select the <strong class="userinput"><code>Pause Menu Contents</code></strong> object and under the Inspector window go to the <strong class="userinput"><code>Vertical Layout Group (Script)</code></strong> component and change the <strong class="userinput"><code>Child Alignment</code></strong> to <strong class="userinput"><code>Middle Center</code></strong>. Then, change the <strong class="userinput"><code>Child Control Size</code></strong> to have <strong class="userinput"><code>Width</code></strong> toggled.</li><li>Then, in the <strong class="userinput"><code>Vertical Layout Group</code></strong> component, click on the arrow to the left of the <strong class="userinput"><code>Padding</code></strong> property to open it up and then set all of the sides to <code class="literal">5</code>:</li></ol></div><div class="mediaobject"><img src="/graphics/9781787288713/graphics/5c0c4135-4d10-4a06-8d8d-0f768edd7133.png" /></div><p>This will add 5 pixels of padding in each direction within all of the children of the layout group.</p><div class="orderedlist"><ol class="orderedlist arabic" start="16" type="1"><li>Now, duplicate this button twice and change the text to <strong class="userinput"><code>Restart</code></strong> and <strong class="userinput"><code>Main Menu</code></strong>.</li></ol></div><div class="orderedlist"><ol class="orderedlist arabic" start="17" type="1"><li>Next, right-click on the <strong class="userinput"><code>Panel</code></strong> object and select <strong class="userinput"><code>UI</code></strong> | <strong class="userinput"><code>Text</code></strong>. Change the object's text to <strong class="userinput"><code>Paused</code></strong> and change its alignment to be centered and increase the size until it's somewhere you like. Note how the order in which the child is changes the order it is displayed. With that in mind, drag the <strong class="userinput"><code>Text</code></strong> object to the top:</li></ol></div><div class="mediaobject"><img src="/graphics/9781787288713/graphics/2876462b-e92c-4032-ad6b-8eee7177a7f6.png" /></div><p>This looks nice, but there's also a lot of spacing here, and we can't see the entirety of the <strong class="userinput"><code>Main Menu</code></strong> on this button. So, if we'd like, we can instead condense the contents of our menu to just fit what we have there.</p><div class="orderedlist"><ol class="orderedlist arabic" start="18" type="1"><li>To do this, we can go to <strong class="userinput"><code>Hierarchy</code></strong> and select the <strong class="userinput"><code>Pause Menu Contents</code></strong> object and then add a <strong class="userinput"><code>Content Size Fitter</code></strong> component. Once it is added, we will change the <strong class="userinput"><code>Horizontal Fit</code></strong> and <strong class="userinput"><code>Vertical Fit</code></strong> to <strong class="userinput"><code>Preferred Size</code></strong>.</li></ol></div><div class="orderedlist"><ol class="orderedlist arabic" start="19" type="1"><li>This will scrunch all the buttons together, so we can change the <strong class="userinput"><code>Vertical Layout Group</code></strong>'s <strong class="userinput"><code>Spacing</code></strong> property to <code class="literal">5</code> and add some space between the buttons.</li><li>Now, to make sure that the buttons fit no matter what size we have, select each Button and add a <strong class="userinput"><code>Horizontal Layout Group (Script)</code></strong> to them. From there, check the <strong class="userinput"><code>Child <strong class="userinput"><code>Co</code></strong></code></strong><strong class="userinput"><code>ntrols Size</code></strong> for <strong class="userinput"><code>Width</code></strong> and <strong class="userinput"><code>Height</code></strong> and add a padding of <code class="literal">5</code>. Once you create the first <strong class="userinput"><code>Horizontal Layout Group (Script)</code></strong>, you can right-click on it and select Copy Component, then go to the other two buttons, right-click on the <strong class="userinput"><code>Inspector</code></strong> tab at the <strong class="userinput"><code>Rect Transform</code></strong> component and then select the <strong class="userinput"><code>Paste</code></strong> component:</li></ol></div><div class="mediaobject"><img src="/graphics/9781787288713/graphics/70c9b443-f725-4a4f-8b60-b0a381cd7774.png" /></div><p>In this case, the <strong class="userinput"><code>Child Controls Size</code></strong> property will make it so that the button will increase its size to ensure that it fits the size of the text provided.</p><div class="orderedlist"><ol class="orderedlist arabic" start="21" type="1"><li>We will also go to the paused <strong class="userinput"><code>Text</code></strong> object and increase the <strong class="userinput"><code>Text</code></strong> component's Font Size to <code class="literal">25</code> to fill out the area and emphasize that we are in the pause menu:</li></ol></div><div class="mediaobject"><img src="/graphics/9781787288713/graphics/fe6e69ef-de9d-49e3-ae23-136eefd0f3fa.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="22" type="1"><li>Now that we have the buttons themselves, let's not actually make them do something. In the <strong class="userinput"><code>Project</code></strong> window, open up the <code class="literal">Scripts</code> folder and create a new C# Script called <code class="literal">PauseScreenBehaviour</code> and double-click on it to open up the IDE of your choice.</li><li>Once it's opened, use the following code:</li></ol></div><pre class="programlisting">using UnityEngine; 
using UnityEngine.SceneManagement; // SceneManager 
 
public class PauseScreenBehaviour : MainMenuBehaviour 
{ 
 
    private static bool paused; 
 
    [Tooltip("Reference to the pause menu object to turn on/off")] 
    public GameObject pauseMenu; 
 
    /// &lt;summary&gt; 
    /// Reloads our current level, effectively "restarting" the     
    /// game 
    /// &lt;/summary&gt; 
    public void Restart()
    {
        SceneManager.LoadScene(SceneManager.GetActiveScene().name);
    }
 
    /// &lt;summary&gt; 
    /// Will turn our pause menu on or off 
    /// &lt;/summary&gt; 
    /// &lt;param name="isPaused"&gt;&lt;/param&gt; 
    public void SetPauseMenu(bool isPaused) 
    { 
        paused = isPaused; 
 
        // If the game is paused, timeScale is 0, otherwise 1 
        Time.timeScale = (paused) ? 0 : 1; 
        pauseMenu.SetActive(paused); 
    } 
 
    void Start() 
    { 
        paused = false; 
    } 
    
} </pre><p>In this script, we will first use a <code class="literal">static</code> variable, which is called <code class="literal">paused</code>. When we declare a variable <code class="literal">static</code>, we ensure that there will only ever be one of those variables inside of this class, which all instances will share. One of the advantages of this is that we can access the property in other scripts using the class name followed by a period and then the attribute's name (in this case, <code class="literal">PauseScreenBehaviour.paused</code>). We will use this concept later on when we want to open the menu through code.</p><p>We then have two public functions, which we will call via the UI elements. First, we have a <code class="literal">Restart</code> function, which will use Unity's Scene Manager to return us to the current level loaded, effectively restarting the game. It is important to note that <code class="literal">static</code> variables do not reset when restarting in Unity, so that's why I set paused to false in the <code class="literal">Start</code> function to ensure that when we come to the level, it is unpaused.</p><p>Finally, I have a <code class="literal">SetPauseMenu</code> function, which will turn the pause menu on or off based on the value of <code class="literal">isPaused</code>. It also sets the <code class="literal">Time.timeScale</code> property, where <code class="literal">0</code> means that nothing will happen and <code class="literal">1</code> means normal time. This property will modify the <code class="literal">Time.deltaTime</code> variable, effectively canceling out movement that we have as long as we use it.</p><div class="orderedlist"><ol class="orderedlist arabic" start="24" type="1"><li>Save your script and dive back into Unity.</li><li>Now, let's dive into the three <code class="literal">Button</code> objects and rename them to <strong class="userinput"><code>Resume</code></strong> button, <strong class="userinput"><code>Restart</code></strong> button, and <strong class="userinput"><code>Main Menu</code></strong> button for clarity's sake.</li><li>Then, we'll create a new empty game object by going to <strong class="userinput"><code>GameObject</code></strong> | <strong class="userinput"><code>Create Empty</code></strong>. We'll name it to <strong class="userinput"><code>Pause Screen Behaviour (Script)</code></strong> and then attach the <strong class="userinput"><code>Pause Screen Behaviour</code></strong> component to it. Next, assign the <strong class="userinput"><code>Pause Menu</code></strong> variable to the <strong class="userinput"><code>Pause Menu</code></strong> game object in the <strong class="userinput"><code>Hierarchy</code></strong> tab:</li></ol></div><div class="mediaobject"><img src="/graphics/9781787288713/graphics/832e374b-7a12-4cf3-8a97-e13ca83cf82b.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="27" type="1"><li>Now that we have the script, we can now change the buttons to actually do something. Go to the Inspector window with <span>it</span> selected and go to the <strong class="userinput"><code>Button</code></strong> component's <strong class="userinput"><code>On Click ()</code></strong> section and click on the + button to add an action to occur.</li></ol></div><div class="orderedlist"><ol class="orderedlist arabic" start="28" type="1"><li>Drag and drop the <strong class="userinput"><code>Pause Menu Behaviour (Script)</code></strong> object from the <strong class="userinput"><code>Hierarchy</code></strong> window into the box on the bottom-left side of the <strong class="userinput"><code>On Click ()</code></strong> action in the Inspector window. Next, go to the dropdown and select <strong class="userinput"><code>Pause Menu Behaviour</code></strong> | <strong class="userinput"><code>SetPauseMenu</code></strong>. By default, it's on false due to not being checked, so this should work for us:</li></ol></div><div class="mediaobject"><img src="/graphics/9781787288713/graphics/45620060-d967-4379-804e-c0b4314f2f6a.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="29" type="1"><li>Likewise, do the same for the <strong class="userinput"><code>Restart</code></strong> button object, this time calling the <code class="literal">Restart</code> function.</li></ol></div><div class="orderedlist"><ol class="orderedlist arabic" start="30" type="1"><li>Next, do the same for the <code class="literal">Menu Button</code> object, except call <code class="literal">LoadLevel</code>, and put the name of our main menu level in the string place (<code class="literal">MainMenu</code>, in my case).</li><li>Save our game and go ahead and run the game:</li></ol></div><div class="mediaobject"><img src="/graphics/9781787288713/graphics/5090cdc9-41a0-4d81-a644-f325368b6d57.png" /></div><p>As you can see in the preceding screenshot, if we restart the game, it works correctly--we can go to the main menu and Resume continues the game.</p></div>