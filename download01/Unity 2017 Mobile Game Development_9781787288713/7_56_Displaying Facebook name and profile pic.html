<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch07lvl1sec50"></a>Displaying Facebook name and profile pic</h2></div></div><hr /></div><p>A good thing to do is to personalize our game to fit our player. So, with that, once the player logs in, we will welcome them and display their image on the screen by following these steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Go to the <code class="literal">MainMenuBehaviour</code> script once again. <span>From there,</span> we'll need to add a new using statement as to display an image and change text we need to use Unity's UI system:</li></ol></div><pre class="programlisting">using UnityEngine.UI; // Text / Image </pre><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Afterward, we will update the <code class="literal">ShowMainMenu</code> function and add some new functions to use:</li></ol></div><pre class="programlisting">    public void ShowMainMenu() 
    { 
        if (facebookLogin != null &amp;&amp; mainMenu != null) 
        { 
            facebookLogin.SetActive(false); 
            mainMenu.SetActive(true); 
 
<span class="strong"><strong>            if (FB.IsLoggedIn)</strong></span>
<span class="strong"><strong>            {</strong></span>
<span class="strong"><strong>                // Get information from Facebook profile </strong></span>
<span class="strong"><strong>                FB.API("/me?fields=name", HttpMethod.GET, SetName);</strong></span>
<span class="strong"><strong>                FB.API("/me/picture?width=256&amp;height=256", 
                HttpMethod.GET, SetProfilePic);</strong></span>
<span class="strong"><strong>            }</strong></span>
        } 
         
    } 
 <span class="strong"><strong>
    public Text greeting; 
 
    void SetName(IResult result) 
    { 
        if (result.Error != null) 
        { 
            print(result.Error); 
            return; 
        } 
 
        string playerName = result.ResultDictionary["name"].ToString(); 
        greeting.text = "Hello, " + playerName + "!"; 
 
        greeting.gameObject.SetActive(true); 
    } 
 
    public Image profilePic; 
 
    void SetProfilePic(IGraphResult result) 
    { 
        if (result.Error != null) 
        { 
            print(result.Error); 
            return; 
        } 
 
        Sprite fbImage = Sprite.Create(result.Texture, 
                                       new Rect(0,0, 256, 256), 
                                       Vector2.zero ); 
        profilePic.sprite = fbImage; 
 
        profilePic.gameObject.SetActive(true); 
    }</strong></span></pre><p>The <code class="literal">FB.API</code> function makes a call to Facebook's Graph API to get data or take an action on the user's behalf and allows us to get the information that we have permission to as defined earlier.</p><p>In our case, we are looking for the name and the profile picture of the user and calling the <code class="literal">SetName</code> and <code class="literal">SetProfilePic</code> functions, respectively, once we have obtained that data.</p><p>After getting the data, we will modify the image or string to display this new data that we retrieved.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note73"></a>Note</h3><p>For more information on the <code class="literal">FB.API</code> function, check out <a class="ulink" href="https://developers.facebook.com/docs/unity/reference/current/FB.API" target="_blank"><span>https://developers.facebook.com/docs/unity/reference/current/FB.API</span></a>.</p></div><p></p><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>Now, we will need to actually create the text and image we want to display. Open up the <strong class="userinput"><code>Canvas - Scale Screen</code></strong> object in the <strong class="userinput"><code>Hierarchy</code></strong> tab and right-click on it and select <strong class="userinput"><code>UI</code></strong> | <strong class="userinput"><code>Panel</code></strong>.</li><li>This will act as a container for all of our information for the player. Add a <strong class="userinput"><code>Horizontal Layout Group</code></strong> with the <strong class="userinput"><code>Padding</code></strong> and <strong class="userinput"><code>Spacing</code></strong> both set to <code class="literal">10</code>. From there, change the <strong class="userinput"><code>Child Alignment</code></strong> to <strong class="userinput"><code>Lower Center</code></strong> and then check <strong class="userinput"><code>Width</code></strong> and <strong class="userinput"><code>Height</code></strong> under the <strong class="userinput"><code>Child Control Size</code></strong> property. Then, add a <strong class="userinput"><code>Content Size Fitter</code></strong> component and change the sizes to <strong class="userinput"><code>Preferred Size</code></strong>. Finally, in the <strong class="userinput"><code>Anchor Presets</code></strong> menu, hold down Alt+Shift and select <strong class="userinput"><code>bottom-center</code></strong>.</li><li>Now, select the <strong class="userinput"><code>Canvas - Scale Screen</code></strong> object in the <strong class="userinput"><code>Hierarchy</code></strong> tab and right-click on it and select <strong class="userinput"><code>UI</code></strong> | <strong class="userinput"><code>Text</code></strong>.</li><li>Rename the next <strong class="userinput"><code>Text</code></strong> object <code class="literal">Greeting</code>. From the <strong class="userinput"><code>Anchors Preset</code></strong> menu that we learned about earlier, change the setting to bottom-stretch, holding the <span class="emphasis"><em>Shift</em></span> + <span class="emphasis"><em>Alt</em></span> to adjust the anchors and presets accordingly. Then, change the <strong class="userinput"><code>Height</code></strong> to <code class="literal">75</code> so that it's large enough to increase our size.</li><li>Then, adjust the <strong class="userinput"><code>Text</code></strong> to <code class="literal">Welcome</code> and the size to something larger like <code class="literal">50</code>, and then adjust the <strong class="userinput"><code>Alignment</code></strong> to be centered vertically and horizontally.</li><li>Likewise, let's next right-click on <strong class="userinput"><code>Canvas - Scale Size</code></strong> again, and this time select <strong class="userinput"><code>Image</code></strong>. From there, change the <strong class="userinput"><code>Width</code></strong> and <strong class="userinput"><code>Height</code></strong> to a larger value, such as <code class="literal">256</code>. </li></ol></div><p>You may have noted that when the image was at the center, the image was drawn on top of our menu. This is possible due to both Canvas' being told that they have the same priority in being drawn, similar to how z-fighting works for 2D games. To fix potential problems in the future, we will instead put the scaling canvas as the background element.</p><div class="orderedlist"><ol class="orderedlist arabic" start="9" type="1"><li>To do this, we will select the <strong class="userinput"><code>Canvas - Scale Physical</code></strong>, and under the <strong class="userinput"><code>Canvas</code></strong> component, change the <strong class="userinput"><code>Sort Order</code></strong> to <code class="literal">1</code>.</li></ol></div><div class="orderedlist"><ol class="orderedlist arabic" start="10" type="1"><li>Now, let's go ahead and drag and drop the <strong class="userinput"><code>Greeting</code></strong> and <strong class="userinput"><code>Image</code></strong> objects into the Panel. You'll note that the image has reverted back to becoming super small. To fix this, select the <strong class="userinput"><code>Image</code></strong> object and add a <strong class="userinput"><code>Layout Element</code></strong> component to it. From there, set the <strong class="userinput"><code>Min Width</code></strong> and <strong class="userinput"><code>Min Height</code></strong> to <code class="literal">256</code>:</li></ol></div><div class="mediaobject"><img src="/graphics/9781787288713/graphics/93b8b4a4-c0da-4700-8fb3-ceb052222b30.png" /></div><p>The <strong class="userinput"><code>Layout Element (Script)</code></strong> component is great for allowing you to override things that Layout Groups will do by default and can be useful if you're not getting exactly what you want with the default behavior.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note74"></a>Note</h3><p>For more information on the <strong class="userinput"><code>Layout Element (Script)</code></strong> component, check out <a class="ulink" href="https://docs.unity3d.com/Manual/script-LayoutElement.html" target="_blank">https://docs.unity3d.com/Manual/script-LayoutElement.html</a>.</p></div><div class="orderedlist"><ol class="orderedlist arabic" start="11" type="1"><li>Now, dive back into the <strong class="userinput"><code>Main Menu</code></strong> object and set the <strong class="userinput"><code>Greeting</code></strong> and <strong class="userinput"><code>Image</code></strong> properties in the <strong class="userinput"><code>MainMenuBehaviour</code></strong> component.</li><li>Finally, since we don't want them visible when the game starts, let's turn off <strong class="userinput"><code>Greeting</code></strong> and our <strong class="userinput"><code>Image</code></strong> as well.
</li></ol></div><p> </p><div class="orderedlist"><ol class="orderedlist arabic" start="13" type="1"><li>Save our game, and start it up again going through the appropriate login information:</li></ol></div><div class="mediaobject"><img src="/graphics/9781787288713/graphics/b9c05057-5a73-4ced-937e-31fa60c5f2e5.png" /></div><p>As you can see in the preceding screenshot, I retrieve my actual Facebook info once I've logged in.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note75"></a>Note</h3><p>For more information on the Facebook SDK for Unity and additional examples on what you can do with it, check out ;<a class="ulink" href="https://developers.facebook.com/docs/unity" target="_blank"><span>https://developers.facebook.com/docs/unity</span></a>.</p></div></div>