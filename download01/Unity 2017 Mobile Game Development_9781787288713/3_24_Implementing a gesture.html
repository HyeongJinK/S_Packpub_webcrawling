<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch03lvl1sec22"></a>Implementing a gesture</h2></div></div><hr /></div><p>Another type of input that you'll find in mobile games is that of a swipe. This will allow us to use the general movement of the touch to dictate a direction for us to move in. This is usually used to have our players <span class="emphasis"><em>jump</em></span> from one position to another or move quickly in a certain direction, so we'll go ahead and put that in, instead of our previous movement system:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>First, in the <code class="literal">PlayerBehaviour</code> script, go ahead and add some new variables for us to work with:</li></ol></div><pre class="programlisting">    [Header("Swipe Properties")]
    [Tooltip("How far will the player move upon swiping")]
    public float swipeMove = 2f;


    [Tooltip("How far must the player swipe before we will execute the action (in pixel space)")]
    public float minSwipeDistance = 2f;

    /// &lt;summary&gt; 
    /// Stores the starting position of mobile touch events 
    /// &lt;/summary&gt; 
    private Vector2 touchStart;</pre><p>In order to determine whether we are swiping, we will need to first check the start and the end of our movement. We will store the starting position in the <code class="literal">touchStart</code> property. We will also have the <code class="literal">swipeMove</code> property to set how far we will "jump" when the swipe happens. Lastly, we have the  <code class="literal">minSwipeDistance</code> variable which will make sure that the player has moved on the x-axis a little before actually making the jump.</p><p>You'll also note that the <code class="literal">Header</code> attribute has been added to the top of the first variable. This will add a header to the <strong class="userinput"><code>Inspector</code></strong> tab, making it easier to break apart different sections of your script. If you were to save the script and dive into Unity, you should note that it has been added when you select the player:</p><div class="mediaobject"><img src="/graphics/9781787288713/graphics/6493346c-314c-4f38-85c6-94edfefbc6ce.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Now, back in the <code class="literal">PlayerBehaviour</code> script, update the <code class="literal">Update</code> function to add the following highlighted code:</li></ol></div><pre class="programlisting">/// &lt;summary&gt; 
/// Update is called once per frame 
/// &lt;/summary&gt; 

void Update () 
{ 
    // Movement in the x axis 
    float horizontalSpeed = 0; 

    // Check if we are running either in the Unity editor  
    // or in a standalone build. 
    #if UNITY_STANDALONE || UNITY_WEBPLAYER || UNITY_EDITOR

    // Check if we're moving to the side 
    horizontalSpeed = Input.GetAxis("Horizontal") *  
                            dodgeSpeed; 

   // If the mouse is held down (or the screen is tapped  
   // on Mobile) 
    if (Input.GetMouseButton(0)) 
    { 
        horizontalSpeed = CalculateMovement(Input.mousePosition); 
    } 

    // Check if we are running on a mobile device 
    #elif UNITY_IOS || UNITY_ANDROID 

<span class="strong"><strong>    // Check if Input has registered more than zero touches 
    if (Input.touchCount &gt; 0)
    {
        // Store the first touch detected. 
        Touch touch = Input.touches[0];

        // Uncomment to use left and right movement
        //horizontalSpeed = CalculateMovement(touch.position); 

        SwipeTeleport(touch); 
    }</strong></span>

    #endif 

    // Apply our auto-moving and movement forces 
    rb.AddForce(horizontalSpeed, 0, rollSpeed); 
} </pre><p>In the preceding code, we commented out the <code class="literal">CalculateMovement</code> function and instead added a new behavior called <code class="literal">SwipeTeleport</code>. It hasn't been created yet, but this will take in the <code class="literal">Touch</code> event and use its properties to move the player if a swipe happens.</p><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>We will then create a function to handle this new swiping behavior, as follows:</li></ol></div><pre class="programlisting">    /// &lt;summary&gt; 
    /// Will teleport the player if swiped to the left or right 
    /// &lt;/summary&gt; 
    /// &lt;param name="touch"&gt;Current touch event&lt;/param&gt; 

    private void SwipeTeleport(Touch touch)
    {
        // Check if the touch just started 
        if (touch.phase == TouchPhase.Began)
        {
            // If so, set touchStart 
            touchStart = touch.position;
        }

        // If the touch has ended 
        else if (touch.phase == TouchPhase.Ended)
        {
            // Get the position the touch ended at 
            Vector2 touchEnd = touch.position;

            // Calculate the difference between the beginning and 
            // end of the touch on the x axis. 
            float x = touchEnd.x - touchStart.x;

            // If we are not moving far enough, don't do the teleport
            if (Mathf.Abs(x) &lt; minSwipeDistance)
            {
                return;
            }

            Vector3 moveDirection;

            // If moved negatively in the x axis, move left 
            if (x &lt; 0)
            {
                moveDirection = Vector3.left;
            }
            else
            {
                // Otherwise we're on the right 
                moveDirection = Vector3.right;
            }

            RaycastHit hit;

            // Only move if we wouldn't hit something 
            if (!rb.SweepTest(moveDirection, out hit, swipeMove))
            {
                // Move the player 
                rb.MovePosition(rb.position + (moveDirection *
                                swipeMove));
            }
        }
    }</pre><p>In this function, instead of just using the current touch position, we instead store the starting position when the touch begins. When the player lifts their finger, we get the position as well. We then get the direction of that movement and then apply that movement to the ball, checking whether we'll collide with something before actually causing the movement.</p><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>Save your script and dive back into Unity, exporting your project onto your mobile device.</li></ol></div><p>Now, whenever we swipe to the left or right, the player will move accordingly.</p></div>