<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch05lvl1sec36"></a>Opt-in advertisements with rewards</h2></div></div><hr /></div><p>According to AdColony, the most recommended form of mobile game ads from 58% of mobile developers is the rewarded video ad. By that, we're referring to making ads an opt-in experience where players choose to see an ad and they receive some kind of bonus in return. That way, users feel it's a choice for them to see the ad and they feel compelled to see it because they will get something out of it.</p><p>Rewarded ad placements typically yield higher <span class="strong"><strong>effective Cost Per 1000 Impressions</strong></span> (<span class="strong"><strong>eCPMs</strong></span>) since they offer more engagement from users by allowing them to opt-in before watching an ad in exchange for some in-game reward. In our game, we could add the choice of restarting the game or seeing an ad to continue the game.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note54"></a>Note</h3><p>If you're interested in learning more about why reward ads are recommended, check out <span><a class="ulink" href="https://www.adcolony.com/blog/2016/04/26/the-top-ads-recommended-by-mobile-game-developers/" target="_blank">https://www.adcolony.com/blog/2016/04/26/the-top-ads-recommended-by-mobile-game-developers/</a>.</span></p></div><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>So, let's create a <strong class="userinput"><code>Game Over</code></strong> menu by first going to the <strong class="userinput"><code>Hierarchy</code></strong>tab and expending the Canvas if not done so already. Then, select the Pause Menu object and duplicate it by pressing <span class="emphasis"><em>Ctrl </em></span>+ <span class="emphasis"><em>D</em></span>. Rename this new object <strong class="userinput"><code>Game Over</code></strong> and then toggle it on so that we can see it. To make it easier to see, feel free to toggle the 2D mode we used previously when creating the UI elements of our game.</li><li>Next, expand the <code class="literal">Game Over</code> object and the Panel child, then change the Pause Menu Contents object's name to <code class="literal">Game Over Contents</code> and change the child <strong class="userinput"><code>Text</code></strong> object's <strong class="userinput"><code>Text</code></strong> component to say <code class="literal">Game Over</code> instead.</li><li>Now, change the Resume button to say <code class="literal">Continue (Play Ad)</code> and change the button object's name to <code class="literal">Continue Button</code>:</li></ol></div><div class="mediaobject"><img src="/graphics/9781787288713/graphics/d3f3e065-290f-4524-9e1f-b10c3ce3b873.png" /></div><p></p><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>We'll first need to update the <code class="literal">ObstacleBehaviour</code> script to handle it; add the following highlighted code:</li></ol></div><pre class="programlisting">using UnityEngine;
using UnityEngine.SceneManagement; // LoadScene 
<span class="strong"><strong>using UnityEngine.UI; // Button</strong></span>

public class ObstacleBehaviour : MonoBehaviour
{

    [Tooltip("How long to wait before restarting the game")]
    public float waitTime = 2.0f;

    void OnCollisionEnter(Collision collision)
    {
        // First check if we collided with the player 
        if (collision.gameObject.GetComponent&lt;PlayerBehaviour&gt;())
        {
<span class="strong"><strong>            // Destroy (Hide) the player</strong></span>
<span class="strong"><strong>            collision.gameObject.SetActive(false);</strong></span>

<span class="strong"><strong>            player = collision.gameObject;</strong></span>

            // Call the function ResetGame after waitTime
            // has passed
            Invoke("ResetGame", waitTime); 
        }
    }

    /// &lt;summary&gt; 
    /// Will restart the currently loaded level 
    /// &lt;/summary&gt; 

    void ResetGame()
    {
<span class="strong"><strong>        //Bring up restart menu</strong></span>
<span class="strong"><strong>        var go = GetGameOverMenu();</strong></span>
<span class="strong"><strong>        go.SetActive(true);</strong></span>

<span class="strong"><strong>        // Get our continue button</strong></span>
<span class="strong"><strong>        var buttons = go.transform.GetComponentsInChildren&lt;Button&gt;();</strong></span>
<span class="strong"><strong>        UnityEngine.UI.Button continueButton = null;</strong></span>

<span class="strong"><strong>        foreach (var button in buttons)</strong></span>
<span class="strong"><strong>        {</strong></span>
<span class="strong"><strong>            if (button.gameObject.name == "Continue Button")</strong></span>
<span class="strong"><strong>            {</strong></span>
<span class="strong"><strong>                continueButton = button;</strong></span>
<span class="strong"><strong>                break;</strong></span>
<span class="strong"><strong>            }</strong></span>
<span class="strong"><strong>        }</strong></span>
<span class="strong"><strong>        if (continueButton)</strong></span>
<span class="strong"><strong>        {</strong></span>
<span class="strong"><strong>            #if UNITY_ADS</strong></span>
<span class="strong"><strong>            // If player clicks on button we want to play ad and</strong></span>
<span class="strong"><strong>            // then continue</strong></span>
<span class="strong"><strong>
    continueButton.onClick.AddListener(UnityAdController.ShowRewardAd);</strong></span>
<span class="strong"><strong>            UnityAdController.obstacle = this;</strong></span>
<span class="strong"><strong>            #else</strong></span>
<span class="strong"><strong>            // If can't play an ad, no need for continue button</strong></span>
<span class="strong"><strong>            continueButton.gameObject.SetActive(false);</strong></span>
<span class="strong"><strong>            #endif</strong></span>
<span class="strong"><strong>        }</strong></span>
    }

<span class="strong"><strong> private GameObject player;</strong></span>

<span class="strong"><strong>    /// &lt;summary&gt;</strong></span>
<span class="strong"><strong>    /// Handles resetting the game if needed</strong></span>
<span class="strong"><strong>    /// &lt;/summary&gt;</strong></span>
<span class="strong"><strong>    public void Continue()</strong></span>
<span class="strong"><strong>    {</strong></span>
<span class="strong"><strong>        var go = GetGameOverMenu();</strong></span>
<span class="strong"><strong>        go.SetActive(false);</strong></span>
<span class="strong"><strong>        player.SetActive(true);</strong></span>

<span class="strong"><strong>        // Explode this as well (So if we respawn player can continue)</strong></span>
<span class="strong"><strong>        PlayerTouch(); </strong></span>
<span class="strong"><strong>    }</strong></span>

<span class="strong"><strong>    /// &lt;summary&gt;</strong></span>
<span class="strong"><strong>    /// Retrieves the Game Over menu game object</strong></span>
<span class="strong"><strong>    /// &lt;/summary&gt;</strong></span>
<span class="strong"><strong>    /// &lt;returns&gt;The Game Over menu object&lt;/returns&gt;</strong></span>
<span class="strong"><strong>    GameObject GetGameOverMenu()</strong></span>
<span class="strong"><strong>    {</strong></span>
<span class="strong"><strong>        return GameObject.Find("Canvas").transform.Find("Game   
        Over").gameObject;</strong></span>
<span class="strong"><strong>    }</strong></span>


    public GameObject explosion;

    /// &lt;summary&gt; 
    /// If the object is tapped, we spawn an explosion and 
    /// destroy this object 
    /// &lt;/summary&gt; 
    void PlayerTouch()
    {
        if (explosion != null)
        {
            var particles = Instantiate(explosion, transform.position,
            Quaternion.identity);
            Destroy(particles, 1.0f);
        }

        Destroy(this.gameObject);
    }
}</pre><p>In this instance, we are removing the destruction of our player and are instead hiding them so that we can re-enable it later if we would like to. We also destroy what the player hit. So, if we do restart the game, then the player will be able to start off from right where he initially began. With that in mind, we also created a <code class="literal">Continue</code> function that will set up the game to be continued if we need to do so.</p><div class="orderedlist"><ol class="orderedlist arabic" start="5" type="1"><li>Open up the <code class="literal">UnityAdController</code> script and update it by adding the following functions:</li></ol></div><pre class="programlisting">     public static void ShowRewardAd()
    {
        #if UNITY_ADS

        if (Advertisement.IsReady())
        {
            // Pause game while ad is shown 
            PauseScreenBehaviour.paused = true;
            Time.timeScale = 0f;

            var options = new ShowOptions { resultCallback =  
            HandleShowResult };
            Advertisement.Show(options);
        }

        #endif
    }

    // For holding the obstacle for continuing the game 
    public static ObstacleBehaviour obstacle;

    private static void HandleShowResult(ShowResult result)
    {
        #if UNITY_ADS

        switch (result)
        {
            case ShowResult.Finished:
                // Successfully shown, can continue game 
                obstacle.Continue();
                break;
            case ShowResult.Skipped:
                Debug.Log("Ad skipped, do nothing");
                break;
            case ShowResult.Failed:
                Debug.LogError("Ad failed to show, do nothing");
                break;
        }

        #endif
        // Unpause when ad is over or when called
        PauseScreenBehaviour.paused = false;
        Time.timeScale = 1f;

    }</pre><div class="orderedlist"><ol class="orderedlist arabic" start="6" type="1"><li>Save your scripts.</li><li>Click on the <code class="literal">Game Over</code> object and disable it, save our scene, and then dive into the game.</li></ol></div><p>At this point, when we die in the game, we'll be given a <strong class="userinput"><code>Game Over</code></strong> screen:</p><div class="mediaobject"><img src="/graphics/9781787288713/graphics/9d0473e3-f8d8-400a-af9f-156562f5fcee.png" /></div><p>If we click on <strong class="userinput"><code>Continue (Play Ad)</code></strong>, we will have an ad play. If the player skips it, nothing will happen, but if they watch all the way through it should bring us back into the game as if nothing happened:</p><div class="mediaobject"><img src="/graphics/9781787288713/graphics/b12d84ea-3a09-4a31-95b5-07779650e579.png" /></div><p>With that, our ad system is working correctly.</p></div>