<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch08lvl1sec54"></a>Using the Overlay Blend mode with screen effects</h2></div></div><hr /></div><p>For our <a id="id438" class="indexterm"></a>final recipe, we are going to take a look at another <a id="id439" class="indexterm"></a>type of blend mode, the Overlay Blend mode. This blending actually makes use of some conditional statements that determine the final color of each pixel in each channel. So, the process of using this type of blend mode needs a bit more coding to work. Let's take a look at how this is done in the next few recipes.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch08lvl2sec148"></a>Getting ready</h3></div></div></div><p>For this last Screen Effect, we will need to set up our two scripts as we have in the previous recipes in this chapter. For this recipe, we will be using the same scene we have been using, so we don't have to create a new one:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Create a new script file called <code class="literal">Overlay_ImageEffect</code> and shader file called <code class="literal">Overlay_Effect</code>.</p></li><li><p>Copy the code from the previous C# script file to our new script file.</p></li><li><p>Copy the code from the previous shader file to our new shader file.</p></li><li><p>Assign the <code class="literal">Overlay_ImageEffect</code> script to the main camera and <code class="literal">Overlay_Effect</code> to the script component in the <span class="strong"><strong>Inspector</strong></span>.</p></li><li><p>Finally, double-click on the script and shader files to open them in the MonoDevelop editor.</p></li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch08lvl2sec149"></a>How to do it…</h3></div></div></div><p>To begin our Overlay Screen Effect, we will need to get the code of our shader up and running without errors. We can then modify our script file to feed the correct data to the shader.</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>We first <a id="id440" class="indexterm"></a>need to set up our properties in our <a id="id441" class="indexterm"></a>
<code class="literal">Properties</code> block. We will use the same properties from the previous few recipes in this chapter:</p><div class="mediaobject"><img src="/graphics/9781785285240/graphics/5084_10_37.jpg" /></div></li><li><p>We then need to create the corresponding variables in our <code class="literal">CGPROGRAM</code>:</p><div class="mediaobject"><img src="/graphics/9781785285240/graphics/5084_10_38.jpg" /></div></li><li><p>In order for the Overlay Blend effect to work, we will have to process each pixel from each channel individually. To do this in a shader, we have to write a custom function that will take in a single channel, for instance, the red channel, and perform the Overlay operation. Enter the following code in the shader just below the variable declarations:</p><div class="mediaobject"><img src="/graphics/9781785285240/graphics/5084_10_40.jpg" /></div></li><li><p>Finally, we need to update our <code class="literal">frag() </code>function to process each channel of our textures to <a id="id442" class="indexterm"></a>perform the blending:</p><div class="mediaobject"><img src="/graphics/9781785285240/graphics/5084_10_41.jpg" /></div></li><li><p>With the <a id="id443" class="indexterm"></a>code completed in the shader, our effect should be working. Save the shader and return to the Unity editor to let the shader compile. Our script is already set up, so we don't have to modify it any further. Once the shader compiles, you should see a result similar to the following image:</p><div class="mediaobject"><img src="/graphics/9781785285240/graphics/5084_10_42.jpg" /></div></li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch08lvl2sec150"></a>How it works…</h3></div></div></div><p>Our Overlay blend mode is definitely a lot more involved, but if you really break down the function, you will notice that it is simply a multiply blend mode and screen blend mode. It's just that, in this case, we are doing a conditional check to apply one or the other blend <a id="id444" class="indexterm"></a>mode to a pixel.</p><p>With this particular <a id="id445" class="indexterm"></a>Screen Effect, when the Overlay function receives a pixel, it checks to see whether it is less than 0.5. If it is, then we apply a modified multiply blend mode to that pixel; if it's not, then we apply a modified screen blend mode to the pixel. We do this for each pixel for each channel, giving us the final RGB pixel values for our Screen effect.</p><p>As you can see, there are many things that can be done with screen effects. It really just depends on the platform and amount of memory you have allocated for screen effects. Usually, this is determined throughout the course of a game project, so have fun and get creative with your screen effects.</p></div></div>