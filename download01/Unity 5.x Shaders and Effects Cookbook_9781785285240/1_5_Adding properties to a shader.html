<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch01lvl1sec12"></a>Adding properties to a shader</h2></div></div><hr /></div><p>Properties of a <a id="id33" class="indexterm"></a>shader are very important for the shader pipeline as they are the method that you use to let the artist or user of the shader assign textures and <a id="id34" class="indexterm"></a>tweak your shader values. Properties allow you to expose GUI elements in a material's <span class="strong"><strong>Inspector</strong></span> tab without you having to use a separate editor, which provides visual ways to tweak a shader.</p><p>With your shader opened in MonoDevelop, look at the block of lines 2 through 7. This is called the <code class="literal">Properties</code> block. Currently, it will have one property in it called <code class="literal">_MainTex</code>. If you look at your material that has this shader applied to it, you will notice that there is one <span class="strong"><strong>texture</strong></span> GUI <a id="id35" class="indexterm"></a>element in the <span class="strong"><strong>Inspector</strong></span> tab. These lines of code in our shader are creating this GUI element for us.</p><p>Again, Unity <a id="id36" class="indexterm"></a>has made this process very efficient in terms of coding and the amount of time it takes to iterate through changing your properties.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec20"></a>Getting ready</h3></div></div></div><p>Let's see how this works in our current shader called <code class="literal">StandardDiffuse</code>, by creating our own properties and learning more about the syntax involved. For this example, we will refit the shader previously created. Instead of using a texture, it will only use its color and some other properties that we will be able to change directly from the <span class="strong"><strong>Inspector</strong></span> tab. Start by duplicating the <code class="literal">StandardDiffuse</code> shader. You can do this by selecting it in the <span class="strong"><strong>Inspector</strong></span> tab and pressing <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>D</em></span>. This will create a copy called <code class="literal">StandardDiffuse2</code>.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note08"></a>Note</h3><p>You can give a friendlier name to your shader in its first line. For instance, <code class="literal">Shader "CookbookShaders/StandardDiffuse"</code> tells Unity to call this <code class="literal">StandardDiffuse</code> shader and move it to a group called <code class="literal">CookbookShaders</code>. If you duplicate a shader using <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>D</em></span>, your new file will share the same name. To avoid confusion, make sure to change the first line of each new shader so that it uses a unique alias.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec21"></a>How to do it…</h3></div></div></div><p>Once the <code class="literal">StandardDiffuse2</code> shader is ready, we can start changing its properties:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>In our <code class="literal">Properties</code> block of our shader, remove the current property by deleting the following code from our current shader:</p><div class="informalexample"><pre class="programlisting">_MainTex ("Albedo (RGB)", 2D) = "white" {}</pre></div></li><li><p>As we have removed an essential property, this shader will not compile until the other references to <code class="literal">_MainTex</code> are removed. Let's remove this other line:</p><div class="informalexample"><pre class="programlisting">sampler2D _MainTex;</pre></div></li><li><p>The original shader used <code class="literal">_MainTex</code> to color the model. Let's change this by replacing the first line of code of the <code class="literal">surf()</code> function with this:</p><div class="informalexample"><pre class="programlisting">fixed4 c = _Color;</pre></div></li><li><p>When you save and return to Unity, the shader will compile, and you will see that now our material's <span class="strong"><strong>Inspector</strong></span> tab doesn't have a texture swatch anymore. To complete the refit of this shader, let's add one more property and see what happens. Enter the following code:</p><div class="informalexample"><pre class="programlisting">_AmbientColor ("Ambient Color", Color) = (1,1,1,1)</pre></div></li><li><p>We have added another color swatch to the material's <span class="strong"><strong>Inspector</strong></span> tab. Now let's add one more to get a feel for other kinds of properties that we can create. Add the following code to the <code class="literal">Properties</code> block:</p><div class="informalexample"><pre class="programlisting">_MySliderValue ("This is a Slider", Range(0,10)) = 2.5</pre></div></li><li><p>We have now <a id="id37" class="indexterm"></a>created another GUI element that <a id="id38" class="indexterm"></a>allows us to visually interact with our shader. This time, we created a slider with the name <span class="strong"><strong>This is a Slider</strong></span>, as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781785285240/graphics/Image_4850_01_05.jpg" /></div></li></ol></div><p>Properties allow you to create a visual way to tweak shaders without having to change values in the shader code itself. The next recipe will show you how these properties can actually be used to create a more interesting shader.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note09"></a>Note</h3><p>While properties belong to shaders, the values associated with them are stored in materials. The same shader can be safely shared between many different materials. On the other hand, changing the property of a material will affect the look of all the objects that are currently using it.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec22"></a>How it works…</h3></div></div></div><p>Every Unity shader has a built-in structure that it is looking for in its code. The <code class="literal">Properties</code> block is one of those functions that are expected by Unity. The reason behind this is to give you, the shader programmer, a means of quickly creating GUI elements that tie directly into your shader code. These properties that you declare in the <code class="literal">Properties</code> block can then be used in your shader code to change values, colors, and textures. The syntax to <a id="id39" class="indexterm"></a>define a property is as follows:</p><div class="mediaobject"><img src="/graphics/9781785285240/graphics/Image_4850_01_06.jpg" /></div><p>Let's take a <a id="id40" class="indexterm"></a>look at what is going on under the hood here. When you first start writing a new property, you will need to give it a <span class="strong"><strong>Variable Name</strong></span>. The variable name is <a id="id41" class="indexterm"></a>going to be the name that your shader code is going to use in order to get the value from the GUI element. This saves us a lot of time because we don't have to set up this system ourselves.</p><p>The next elements of a <a id="id42" class="indexterm"></a>property are the <span class="strong"><strong>Inspector GUI Name</strong></span> and <span class="strong"><strong>Type</strong></span> of the <a id="id43" class="indexterm"></a>property, which is contained within parentheses. The <span class="strong"><strong>Inspector GUI Name</strong></span> is the name that is going to appear in the material's <span class="strong"><strong>Inspector</strong></span> tab when the user is interacting with and tweaking the shader. The <span class="strong"><strong>Type</strong></span> is the type of data that this property is going to control. There are many types that we can define for properties inside of Unity shaders. The following table describes the types of variables that we can have in our shaders:</p><div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; "><colgroup><col align="left" /><col align="left" /></colgroup><thead><tr><th style="border-bottom: 0.5pt solid ; " colspan="2" align="left" valign="bottom">
<p>Surface Shader property types</p>
</th></tr></thead><tbody><tr><td style="" align="left" valign="top">
<p>
<code class="literal">Range (min, max)</code>
</p>
</td><td style="" align="left" valign="top">
<p>This creates a float property as a slider from the minimum value to the maximum value</p>
</td></tr><tr><td style="" align="left" valign="top">
<p>
<code class="literal">Color</code>
</p>
</td><td style="" align="left" valign="top">
<p>This creates a color swatch in the <span class="strong"><strong>Inspector</strong></span> tab that opens up a <code class="literal">color picker = (float,float,float,float)</code>
</p>
</td></tr><tr><td style="" align="left" valign="top">
<p>
<code class="literal">2D</code>
</p>
</td><td style="" align="left" valign="top">
<p>This creates a texture swatch that allows a user to drag a texture in the shader</p>
</td></tr><tr><td style="" align="left" valign="top">
<p>
<code class="literal">Rect</code>
</p>
</td><td style="" align="left" valign="top">
<p>This creates a non-power-of-2 texture swatch and functions the same as the 2D GUI element</p>
</td></tr><tr><td style="" align="left" valign="top">
<p>
<code class="literal">Cube</code>
</p>
</td><td style="" align="left" valign="top">
<p>This creates a cube map swatch in the <span class="strong"><strong>Inspector</strong></span> tab and allows a user to drag and drop a cube map in the shader</p>
</td></tr><tr><td style="" align="left" valign="top">
<p>
<code class="literal">Float</code>
</p>
</td><td style="" align="left" valign="top">
<p>This creates a float value in the <span class="strong"><strong>Inspector</strong></span> tab but without a slider</p>
</td></tr><tr><td style="" align="left" valign="top">
<p>
<code class="literal">Vector</code>
</p>
</td><td style="" align="left" valign="top">
<p>This creates a four-float property that allows you to create directions or colors</p>
</td></tr></tbody></table></div><p>Finally, there is the <span class="strong"><strong>Default Value</strong></span>. This simply sets the value of this property to the value that you place <a id="id44" class="indexterm"></a>in the code. So, in the previous example image, the <a id="id45" class="indexterm"></a>default value for the property named <code class="literal">_AmbientColor</code>, which <a id="id46" class="indexterm"></a>is of the <code class="literal">Color</code> type, is set to a value of <code class="literal">1,1,1,1</code>. As this is a color property expecting a color that is <code class="literal">RGBA</code> or <code class="literal">float4</code> or <code class="literal">r, g, b, a = x, y, z, w</code>, this color property, when first created, is set to white.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec23"></a>See also</h3></div></div></div><p>The properties are <a id="id47" class="indexterm"></a>documented in the Unity manual at <a class="ulink" href="http://docs.unity3d.com/Documentation/Components/SL-Properties.html" target="_blank">http://docs.unity3d.com/Documentation/Components/SL-Properties.html</a>.</p></div></div>