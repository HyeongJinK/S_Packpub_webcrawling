<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch01lvl1sec11"></a>Migrating Legacy Shaders from Unity 4 to Unity 5</h2></div></div><hr /></div><p>It is <a id="id18" class="indexterm"></a>undeniable that graphics in <a id="id19" class="indexterm"></a>videogames have changed massively over the last 10 years. Every new game comes with cutting-edge techniques that are getting us closer to achieving real-time photorealism. We should not be surprised by the fact that shaders themselves have changed massively throughout the lifetime of Unity. This is one of the major sources of confusion when approaching shaders for the first time. Prior to Unity 5, mainly two different shaders were adopted: <span class="strong"><strong>Diffuse</strong></span> <a id="id20" class="indexterm"></a>and <span class="strong"><strong>Specular</strong></span>. As the names suggest, they were used for matte and <a id="id21" class="indexterm"></a>shiny materials, respectively. If you are already using Unity 5, you can skip this recipe. This recipe will explain how to replicate these effects using Unity 5.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec16"></a>Getting ready</h3></div></div></div><p>The starting point of this recipe is having a workspace made in Unity 4, which uses some of the built-in shaders that were originally provided. If you are to start a new game, there is no doubt that you should use the latest version of Unity. However, if your project is already in the later stages of development with an older version, you should be very careful before migrating. Many things have changed behind the curtains of the engine, and even if your built-in shaders will most likely work without any problem, your scripts might not. If you are to migrate your entire workspace, the first thing that you should do is take backup. It is important to remember that saving assets and scenes is not enough as most of the configuration in Unity is stored in its metadata files. The safest option to survive a migration is to duplicate the entire folder that contains your project. The best way of doing this is by physically copying the folder from File Explorer (Windows) or Finder (Mac).</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec17"></a>How to do it...</h3></div></div></div><p>There are two main options if you want to migrate your built-in shaders: upgrading your project automatically or switching to Standard Shaders instead.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch01lvl3sec01"></a>Upgrading automatically</h4></div></div></div><p>This option is the <a id="id22" class="indexterm"></a>easiest one. Unity 5 can import a project made with an earlier version and upgrade it. You should notice that once the conversion is done, you will not be able to use Unity 4; even if none of your assets may have changed directly, Unity metadata has been converted. To proceed with this, open Unity 5 and click on <span class="strong"><strong>OPEN OTHER</strong></span> to select the folder of your old project. You will be asked if you want to convert it; click on <span class="strong"><strong>Upgrade</strong></span> to proceed. Unity will reimport all of your assets and recompile all of your scripts. The process might last for several hours if your project is big. Once the conversion is done, your built-in shaders from Unity 4 should have been replaced with their legacy equivalent. You can check this from the inspector of your materials that should have changed (for instance) from <span class="strong"><strong>Bumped Diffuse</strong></span> to <span class="strong"><strong>Legacy Shader/Bumped Diffuse</strong></span>.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note06"></a>Note</h3><p>Even if Diffuse, Specular, and the other built-in shaders from Unity 4 are now deprecated, Unity 5 keeps them for backward compatibility. They can be found in the <a id="id23" class="indexterm"></a>drop-down menu of a material under the <span class="strong"><strong>Legacy Shaders</strong></span> folder.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch01lvl3sec02"></a>Using Standard Shaders</h4></div></div></div><p>Instead of using the <a id="id24" class="indexterm"></a>Legacy Shaders, you might decide to replace them with the new Standard Shaders from Unity 5. Before doing this, you should keep in mind that as they are based on a different lighting model, your materials will most <a id="id25" class="indexterm"></a>likely look different. Unity 4 came with more than eighty different built-in shaders divided in six different families (Normal, Transparent, Transparent Cutout, Self-Illuminated, and Reflective). In Unity 5, they are all replaced by the Standard Shader introduced in the previous recipe. Unfortunately, there is no magic recipe to convert your shaders directly. However, you can use the following table as a starting point to understand how the Standard Shader can be configured to simulate Unity 4 Legacy Shaders:</p><div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; "><colgroup><col align="left" /><col align="left" /><col align="left" /><col align="left" /></colgroup><thead><tr><th style="border-bottom: 0.5pt solid ; " align="left" valign="bottom">
<p>Shader</p>
</th><th style="border-bottom: 0.5pt solid ; " align="left" valign="bottom">
<p>Unity 4</p>
</th><th style="border-bottom: 0.5pt solid ; " align="left" valign="bottom">
<p>Unity 4 (Legacy)</p>
</th><th style="border-bottom: 0.5pt solid ; " align="left" valign="bottom">
<p>Unity 5</p>
</th></tr></thead><tbody><tr><td style="" align="left" valign="top">
<p>Diffuse</p>
</td><td style="" align="left" valign="top">
<p>Diffuse</p>
<p>Lambert</p>
</td><td style="" align="left" valign="top">
<p>Legacy Shader/Diffuse</p>
<p>Lambert</p>
</td><td style="" align="left" valign="top">
<p>Standard</p>
<p>Physically-based rendering: Metallic Workflow</p>
</td></tr><tr><td style="" align="left" valign="top">
<p>Specular</p>
</td><td style="" align="left" valign="top">
<p>Specular</p>
<p>Blinn-Phong</p>
</td><td style="" align="left" valign="top">
<p>Legacy Shader/Specular</p>
<p>Blinn-Phong</p>
</td><td style="" align="left" valign="top">
<p>Standard (Specular setup)</p>
<p>Physically-based rendering: Specular Workflow</p>
</td></tr><tr><td style="" rowspan="2" align="left" valign="top">
<p>Transparent</p>
</td><td style="" align="left" valign="top">
<p>Transparent Vertex-Lit</p>
</td><td style="" align="left" valign="top">
<p>Legacy Shader/Transparent Vertex-Lit</p>
</td><td style="" align="left" valign="top">
<p>Standard</p>
<p>Rendering Mode: Transparent</p>
</td></tr><tr><td style="" align="left" valign="top">
<p>Transparent Cutout Vertex-Lit</p>
</td><td style="" align="left" valign="top">
<p>Legacy Shader/Transparent Cutout Vertex-Lit</p>
</td><td style="" align="left" valign="top">
<p>Standard</p>
<p>Rendering Mode: Cutout</p>
</td></tr></tbody></table></div><p>You can change the shader used by your old material using the <span class="strong"><strong>Shader</strong></span> drop-down menu in <span class="strong"><strong>Inspector</strong></span>. All you need to do is simply select the appropriate Standard Shader. If your old shader used textures, colours, and normal maps, they will be automatically used in the new Standard Shader. You might still have to configure the parameters of the Standard Shader to get as close <a id="id26" class="indexterm"></a>to your original lighting model as possible. The following picture shows the ubiquitous <span class="emphasis"><em>Stanford bunny</em></span> rendered with a Legacy <a id="id27" class="indexterm"></a>Diffuse Shader (right), converted Standard Shader (left), and Standard Shader with <span class="strong"><strong>Smoothness</strong></span> set to zero (middle):</p><div class="mediaobject"><img src="/graphics/9781785285240/graphics/Image_4850_01_04.jpg" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch01lvl3sec03"></a>Migrating custom shaders</h4></div></div></div><p>If you have written <a id="id28" class="indexterm"></a>custom shaders in Unity 4, chances are that <a id="id29" class="indexterm"></a>this will work straightaway in Unity 5. Despite this, Unity has made some minor changes in the way shaders work, which can cause both errors and inconsistencies. The most relevant and important one is the intensity of the light. Lights in Unity 5 are twice as bright. All the Legacy Shaders have been rewritten to take this into account; if you have upgraded your shaders or switched to Standard Shaders, you will not notice any difference. If you have written your own lighting model, you will have to be sure that the intensity of the light is not multiplied by two any more. The following code is used to ensure this:</p><div class="informalexample"><pre class="programlisting">// Unity 4
c.rgb = s.Albedo * _LightColor0.rgb * (diff * atten * 2);
// Unity 5
c.rgb = s.Albedo * _LightColor0.rgb * (diff * atten);</pre></div><p>If you haven't <a id="id30" class="indexterm"></a>written a shader yet, don't panic: lighting models <a id="id31" class="indexterm"></a>will be extensively explained in <a class="link" href="#" linkend="ch03">Chapter 3</a>, <span class="emphasis"><em>Understanding Lighting Models</em></span>.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note07"></a>Note</h3><p>There are several other <a id="id32" class="indexterm"></a>changes in the way Unity 5 handles shaders compared to Unity 4. You can see all of them in <span class="strong"><strong>Shaders in Unity 5.0</strong></span> at <a class="ulink" href="http://docs.unity3d.com/Manual/UpgradeGuide5-Shaders.html" target="_blank">http://docs.unity3d.com/Manual/UpgradeGuide5-Shaders.html</a>.</p></div></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec18"></a>How it works...</h3></div></div></div><p>Writing shaders is always a trade-off between realism and efficiency; realistic shaders require intensive computation, potentially introducing a significant lag. It's important to use only those effects that are strictly required: if a material does not need specular reflections, then there is no need to use a shader that calculates them. This has been the main reason why Unity 4 has been shipped with so many different shaders. The new Standard Shader of Unity 5 can potentially replace all of the previous shaders as it incorporates normal mapping, transparency, and reflection. However, it has been cleverly optimized so that only the effects that are really necessary are calculated. If your standard material does not have reflections, they will not be calculated.</p><p>Despite this, the Standard Shader is mainly designed for realistic materials. The Legacy Diffuse and Specular shaders, in comparison, were not really designed for realistic materials. This is the reason switching from Legacy to Standard Shaders will mostly introduce slight changes in the way your objects are rendered.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec19"></a>See also</h3></div></div></div><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>
<a class="link" href="#" linkend="ch03">Chapter 3</a>, <span class="emphasis"><em>Understanding Lighting Models</em></span>, explores in-depth how the Diffuse and Specular shaders work. Even if deprecated in Unity 5, understanding them is essential if you want to design new lighting models.</p></li><li style="list-style-type: disc"><p>
<a class="link" href="#" linkend="ch04">Chapter 4</a>, <span class="emphasis"><em>Physically Based Rendering in Unity 5</em></span>, will show you how to unlock the potential of the Standard Shader in Unity 5.</p></li></ul></div></div></div>