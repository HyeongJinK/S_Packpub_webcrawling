<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch04lvl1sec33"></a>Creating mirrors and reflective surfaces</h2></div></div><hr /></div><p>Specular <a id="id229" class="indexterm"></a>materials reflect lights when objects are viewed from certain <a id="id230" class="indexterm"></a>angles. Unfortunately, even the Fresnel reflection, which is one of the most accurate models, does not correctly reflect lights from nearby objects. The lighting models examined in the previous chapters took into account only light sources, but ignored light that is reflected from other surfaces. With what you've learned about shaders so far, making a mirror is simply not possible. Global illumination makes this possible by providing PBR shaders with information about their surroundings. This allows objects to have not just specular highlights, but also real reflections, which depend on the other objects around them. Real-time reflections are very costly and require manual setting up and tweaking in order to work. When done properly, they can be used to create mirror-like surfaces, as seen in the following picture:</p><div class="mediaobject"><img src="/graphics/9781785285240/graphics/Image_4850_04_05.jpg" /></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec83"></a>Getting ready</h3></div></div></div><p>This recipe will <a id="id231" class="indexterm"></a>not feature any new shader. Quite the opposite; most of the work <a id="id232" class="indexterm"></a>is done directly in the editor. Perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Create a new scene.</p></li><li><p>Create a quad, which will serve as a mirror.</p></li><li><p>Create a new material and attach it to the mirror.</p></li><li><p>Place the quad in a scene with other objects.</p></li><li><p>Create a new <a id="id233" class="indexterm"></a>
<span class="strong"><strong>reflection probe</strong></span> from <span class="strong"><strong>GameObject</strong></span> | <span class="strong"><strong>Light</strong></span> | <span class="strong"><strong>Reflection Probe</strong></span> and place it in front of the quad.</p></li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec84"></a>How to do it…</h3></div></div></div><p>If the preceding steps have been followed correctly, you should have a quad in the middle of your scene, close to a reflection probe. In order to make it in a mirror, some changes need to be made:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Change the shader of the material to <span class="strong"><strong>Standard</strong></span> and its <span class="strong"><strong>Rendering Mode</strong></span> to <span class="strong"><strong>Opaque</strong></span>.</p></li><li><p>Change its <span class="strong"><strong>Metallic</strong></span> and <span class="strong"><strong>Smoothness</strong></span> properties to one. You should see the material reflecting the sky more clearly.</p></li><li><p>Select the reflection probe and change its <span class="strong"><strong>Size</strong></span> and <span class="strong"><strong>Probe Origin</strong></span> until it is in front of the quad and it encloses all the objects that you want to reflect.</p></li><li><p>Finally, change its <span class="strong"><strong>Type</strong></span> to <span class="strong"><strong>Realtime</strong></span>. Make sure that <span class="strong"><strong>Culling Mask</strong></span> is set to <span class="strong"><strong>Everything</strong></span>.</p></li></ol></div><p>Your reflection probe should be configured, as shown in the following image:</p><div class="mediaobject"><img src="/graphics/9781785285240/graphics/Image_4850_04_06.jpg" /></div><p>If your probe is used for a real mirror, you should check the <span class="strong"><strong>Box Projection</strong></span> flag. If it is used for other reflective surfaces, such as shiny pieces of metal or glass tables, you can uncheck it.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec85"></a>How it works…</h3></div></div></div><p>When a shader wants information about its surroundings, it is usually provided in a structure called <span class="strong"><strong>cube </strong></span>
<a id="id234" class="indexterm"></a>
<span class="strong"><strong>maps</strong></span>. They have been briefly mentioned in <a class="link" href="#" linkend="ch01">Chapter 1</a>, <span class="emphasis"><em>Creating Your First Shader</em></span>, as one of the shader property types, among <code class="literal">Color</code>, <code class="literal">2D</code>, <code class="literal">Float</code>, and <code class="literal">Vector</code>. Loosely speaking, cube maps are the 3D equivalent of 2D textures; they represent a 360-degree view of the world, as seen from a center point. Unity 5 previews cube maps with a spherical projection, as seen in the following picture:</p><div class="mediaobject"><img src="/graphics/9781785285240/graphics/Image_4850_04_07.jpg" /></div><p>When cube maps are attached with <a id="id235" class="indexterm"></a>a camera, they are referred to as <span class="strong"><strong>skyboxes</strong></span> as they are used to provide a way to reflect the sky. They can be used to reflect geometries that are not in the actual scene, such as nebulae, clouds, stars, and so on.</p><p>The reason why they are called cube maps is because of the way they are created: a cube map is made up of six different textures, each one attached to the face of a cube. You can create a cube map manually or <a id="id236" class="indexterm"></a>delegate it to a <span class="strong"><strong>reflection probe</strong></span>. You can imagine a reflection probe as a collection of six cameras, creating a 360 mapping of the surrounding area. This also gives you an idea why probes are so expensive. By creating one in our scene, we allow Unity to know which objects are around the mirror. If you need more reflective surfaces, you can add multiple probes. You need no further action for the reflection probes to work. The Standard Shaders will use them automatically.</p><p>You should notice that when they are set to <span class="strong"><strong>Realtime</strong></span>, they render their cube map at the beginning of every frame. There is a trick to make this faster; if you know that part of the geometry that you want to reflect does not move, you can bake the reflection. This means that Unity can calculate the reflection before starting the game, allowing more precise (and computationally expensive) calculations. In order to do this, your reflection probe must be set to <span class="strong"><strong>Baked</strong></span> and will work only for objects that are flagged as <span class="strong"><strong>Static</strong></span>. Static objects cannot move or change, which makes them perfect for terrains, buildings, and props. Every time a static object is moved, Unity will regenerate the cube maps for its baked reflection probes. This might take a few minutes to several hours.</p><p>You can mix <span class="strong"><strong>Realtime</strong></span> and <span class="strong"><strong>Baked</strong></span> probes to increase the realism of your game. Baked probes will provide very high-quality reflections environmental reflections, while the real-time ones can be used to move objects such as cars or mirrors. The next <span class="emphasis"><em>Baking lights in your scene</em></span> recipe will explain in detail how light baking works.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec86"></a>See also</h3></div></div></div><p>If you are interested in learning more about reflection probes, you should check these links:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>Unity 5 manual <a id="id237" class="indexterm"></a>about Reflection Probe: <a class="ulink" href="http://docs.unity3d.com/Manual/class-ReflectionProbe.html" target="_blank">http://docs.unity3d.com/Manual/class-ReflectionProbe.html</a>
</p></li></ul></div></div></div>