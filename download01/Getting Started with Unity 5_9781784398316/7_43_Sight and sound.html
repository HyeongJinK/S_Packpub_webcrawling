<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch07lvl1sec43"></a>Sight and sound</h2></div></div><hr /></div><p>Let's try a <a id="id283" class="indexterm"></a>quick experiment. Sit down at your computer, console, or mobile device and get set to play your favorite game. First, mute the sound. Now, adjust the video settings so the screen is dim and, if possible, black and white. Okay, now play your game. I'll bet the game is not as fun as you remember. Go ahead and reset any settings you changed. Now, play the game again. What a difference!</p><p>Even if you did not go along with my experiment, I'll bet you understand the impact those changes would have on your ability to enjoy the gaming experience. This underlines just how important audio and visual effects are for gamers. Imagine an explosion without a sound. You get the <a id="id284" class="indexterm"></a>point, audio and visual effects are important. So, why talk about them at all? Adding appropriate audio to games is considered a best practice. We'll consider best practices in implementing audio and video in Unity.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec50"></a>Unity's sound capabilities</h3></div></div></div><p>Unity has <a id="id285" class="indexterm"></a>great support for playing audio in games. There are a few basics that must be understood before we can start playing audio in our games. First, sounds originate from a source file. Unity supports several audio file formats to include AIFF, MPEG1, MPEG2, MPEG3, OGG, and WAV. One format is not necessarily better than the others. What does matter is if the file is native or compressed.</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>Native files are ones that are stored in your game project without compression coding</p></li><li style="list-style-type: disc"><p>Compressed files will take up less disk space but require decompression at runtime, which, depending on the hardware can be enough processing overhead to make your game experience lag</p></li></ul></div><p>If audio is important to the games you will create in the future, then I recommend exploring Unity's documentation and experimenting with different formats.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch07lvl3sec24"></a>Audio listener</h4></div></div></div><p>Unity <a id="id286" class="indexterm"></a>creates an <span class="strong"><strong>Audio Listener</strong></span> as a component of a project's main camera. When you select the main camera in the <span class="strong"><strong>Hierarchy</strong></span> view, you can see <span class="strong"><strong>Audio Listener</strong></span> listed in the <span class="strong"><strong>Inspector</strong></span> view.</p><div class="mediaobject"><img src="/graphics/9781784398316/graphics/3852_07_01.jpg" /></div><p>Audio listeners are simple components without any properties. Ideally, you'll only have one audio listener at a time. For our game, we want the audio listener to be attached to the main camera, which, as you'll remember, we attached to our third person controller game object. This is how the user will be able to hear audio from their audio output device such as computer speakers.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch07lvl3sec25"></a>Audio clips</h4></div></div></div><p>In Unity, we<a id="id287" class="indexterm"></a> reference an audio source file as an instance of an audio clip. Audio clips are variable types. They are flexible so that we can use essentially any audio type.</p><p>The final version of our <span class="emphasis"><em>Little Farmer Colt</em></span> game has a <span class="strong"><strong>Pigs Crying</strong></span> audio asset. The source file is a WAV. When <a id="id288" class="indexterm"></a>viewed in the <span class="strong"><strong>Inspector</strong></span> view, you can see there are a few settings that we can change:</p><div class="mediaobject"><img src="/graphics/9781784398316/graphics/3852_07_02.jpg" /></div><p>We can, for <a id="id289" class="indexterm"></a>example, select <span class="strong"><strong>Force To Mono</strong></span>, which will reduce the audio file in the compiled game.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note13"></a>Note</h3><p>Unity supports mono and stereo. Mono audio is when a single channel of audio is used, while stereo has two channels. With mono audio, the same sound is sent to both left and right speakers. Stereo audio can be used to send different channels to each speaker simultaneously.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch07lvl3sec26"></a>Audio source</h4></div></div></div><p>One of the things we need to <a id="id290" class="indexterm"></a>do is to add an audio source to our main camera. We accomplish this with the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select <span class="strong"><strong>Main Camera</strong></span> in the <span class="strong"><strong>Hierarchy</strong></span> view.</p></li><li><p>In the <span class="strong"><strong>Inspector</strong></span> view, click on the <span class="strong"><strong>Add Component</strong></span> button.</p></li><li><p>Navigate and select <span class="strong"><strong>Audio</strong></span> | <span class="strong"><strong>Audio Source</strong></span>. This will add an <span class="strong"><strong>Audio Source</strong></span> component to the main camera, as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781784398316/graphics/3852_07_03.jpg" /></div></li><li><p>Next, we'll drag the <code class="literal">Pigs Crying</code> audio file to the <span class="strong"><strong>AudioClip</strong></span> field of <span class="strong"><strong>Audio Source</strong></span> in the <span class="strong"><strong>Inspector</strong></span> view.</p></li><li><p>Select the <span class="strong"><strong>Play on Awake</strong></span> checkbox. This will start playing the audio clip as soon as the main camera is instantiated.</p></li><li><p>Select the <span class="strong"><strong>Loop</strong></span> checkbox. This will endlessly play the audio clip.</p></li></ol></div><p>You can play the game now and see that the piglet's sound is constant.</p><p>One of the important settings in the <span class="strong"><strong>Inspector</strong></span> view is an audio source's priority. By default, it is set at <span class="strong"><strong>128</strong></span>, which is right in the middle of the high and low ends of the spectrum. When there are multiple sounds for Unity to play, it uses the priority of each to determine which sounds get played. The lower the number is, the higher the priority will be. The following screenshot shows the Audio Source's <span class="strong"><strong>Priority</strong></span> option:</p><div class="mediaobject"><img src="/graphics/9781784398316/graphics/3852_07_04.jpg" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch07lvl3sec27"></a>Implementing sound effects</h4></div></div></div><p>In <a id="id291" class="indexterm"></a>addition to attaching sounds to an audio source and selecting <span class="strong"><strong>Play on Awake</strong></span> and <span class="strong"><strong>Loop</strong></span>, we can implement sounds via a script. To demonstrate this, deselect the <span class="strong"><strong>Play on Awake</strong></span> and <span class="strong"><strong>Loop</strong></span> checkboxes. Then, perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Update the <code class="literal">Take.cs</code> script to match the following. There are four new lines of code to add, each with a <code class="literal">// new line</code> comment following the line of code:</p><div class="informalexample"><pre class="programlisting">using UnityEngine;
using System.Collections;

public class Take : MonoBehaviour {

    Animator anim;
    int takeHash = Animator.StringToHash ("Take");
    
    public AudioClip points;       // new line  
    private AudioSource source;    // new line  


    void Start () {
        anim = GetComponent&lt;Animator&gt; ();

        source = GetComponent&lt;AudioSource&gt; ();  // new line 
    }

    void Update () {
        if (Input.GetKeyDown (KeyCode.T)) {
            anim.Play (takeHash);

            GameData.water = GameData.water +1;

            source.PlayOneShot (points);        // new line
        }
    }
}</pre></div><p>The new lines of code add a sound effect each time the player presses the <span class="emphasis"><em>T</em></span> key.</p></li><li><p>Next, select <span class="strong"><strong>ThirdPersonController</strong></span> in the <span class="strong"><strong>Hierarchy</strong></span> view.</p></li><li><p>In the <span class="strong"><strong>Inspector</strong></span> view, drag the <span class="strong"><strong>Points</strong></span> audio file from the <span class="strong"><strong>Project</strong></span> view to the <span class="strong"><strong>Points</strong></span> field in the <span class="strong"><strong>Take (Script)</strong></span> area of the <span class="strong"><strong>Inspector</strong></span> view:</p><div class="mediaobject"><img src="/graphics/9781784398316/graphics/3852_07_05.jpg" /></div></li><li><p>With <span class="strong"><strong>ThirdPersonController</strong></span> still selected in the <span class="strong"><strong>Hierarchy</strong></span> view, click on the <span class="strong"><strong>Add Component</strong></span> button in the <span class="strong"><strong>Inspector</strong></span> view.</p></li><li><p>Select <span class="strong"><strong>Audio</strong></span> | <span class="strong"><strong>Audio Source</strong></span>.</p></li><li><p>Uncheck <a id="id292" class="indexterm"></a>the audio source's <span class="strong"><strong>Play on Awake</strong></span> checkbox. This will stop the clip from automatically playing when the game loads.</p></li></ol></div><p>Now, every time Colt's <code class="literal">take</code> animation is played, the "points" audio clip is also played.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec51"></a>Visual effects</h3></div></div></div><p>There are several ways to <a id="id293" class="indexterm"></a>bring attention to objects in a game including visual effects. This section will take you through the following examples:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>Spotlight orb with halo effect</p></li><li style="list-style-type: disc"><p>Casting shadows</p></li><li style="list-style-type: disc"><p>Trail rendering</p></li></ul></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch07lvl3sec28"></a>Spotlight orb with halo effect</h4></div></div></div><p>When you <a id="id294" class="indexterm"></a>take a closer look at the sign on Colt's barn, you see that it is nondescript:</p><div class="mediaobject"><img src="/graphics/9781784398316/graphics/3852_07_06.jpg" /></div><p>Let's add a spotlight orb and add a halo effect to it:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select <span class="strong"><strong>Materials</strong></span> in the <span class="strong"><strong>Project</strong></span> View.</p></li><li><p>From the top menu, navigate and select <span class="strong"><strong>Assets</strong></span> | <span class="strong"><strong>Create</strong></span> | <span class="strong"><strong>Material</strong></span>.</p></li><li><p>Rename the new material <code class="literal">Mat_Yellow</code>.</p></li><li><p>With the <code class="literal">Mat_Yellow</code> asset selected in the <span class="strong"><strong>Project</strong></span> view, change the color from the default white to a bright yellow.</p></li><li><p>From the <a id="id295" class="indexterm"></a>top menu, navigate and select <span class="strong"><strong>GameObject</strong></span> | <span class="strong"><strong>3D Object</strong></span> | <span class="strong"><strong>Sphere</strong></span>.</p></li><li><p>Rename the sphere as <code class="literal">SignLight</code>.</p></li><li><p>Move the <code class="literal">SignLight</code> sphere above Colt's barn sign and flush with the door.</p></li><li><p>Resize the sphere so that it looks appropriate on the door.</p></li><li><p>With the <code class="literal">SignLight</code> sphere selected in the <span class="strong"><strong>Hierarchy</strong></span> view, drag the <code class="literal">Mat_Yellow</code> asset to the <span class="strong"><strong>Mesh Renderer</strong></span> | <span class="strong"><strong>Materials</strong></span> | <span class="strong"><strong>Element 0</strong></span> field in the <span class="strong"><strong>Inspector</strong></span> view.</p><div class="mediaobject"><img src="/graphics/9781784398316/graphics/3852_07_07.jpg" /></div><p>Now that the orb is created, we are ready to create the spotlight.</p></li><li><p>Navigate and select <span class="strong"><strong>GameObject</strong></span> | <span class="strong"><strong>Light</strong></span> | <span class="strong"><strong>Spotlight</strong></span> from the top menu.</p></li><li><p>In the <span class="strong"><strong>Hierarchy</strong></span> view, drag the <span class="strong"><strong>Spotlight</strong></span> section to make it a child of the <span class="strong"><strong>SignLight</strong></span> <a id="id296" class="indexterm"></a>section, as shown in the following screenshot. While this is not necessary, it provides an extra layer of organization to our project:</p><div class="mediaobject"><img src="/graphics/9781784398316/graphics/3852_07_08.jpg" /></div></li><li><p>Move the <span class="strong"><strong>Spotlight</strong></span> section in the <span class="strong"><strong>Scene</strong></span> view so that the spotlight appears to be inside the sphere.</p></li><li><p>Rotate the <span class="strong"><strong>Spotlight</strong></span> section so the light shines appropriately on the sign.</p></li><li><p>With the <span class="strong"><strong>Spotlight</strong></span> section selected, change <span class="strong"><strong>Range</strong></span> to <code class="literal">3</code> in the <span class="strong"><strong>Inspector</strong></span> view.</p></li><li><p>Also in <span class="strong"><strong>Inspector</strong></span> view, change the color to the same bright yellow that you used for the <span class="strong"><strong>Mat_Yellow</strong></span> asset.</p></li><li><p>Select the <span class="strong"><strong>Draw Halo</strong></span> checkbox.</p></li><li><p>Save the scene and the project.</p></li><li><p>Test the <a id="id297" class="indexterm"></a>new visual effect in play mode.</p><div class="mediaobject"><img src="/graphics/9781784398316/graphics/3852_07_09.jpg" /></div></li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch07lvl3sec29"></a>Casting shadows</h4></div></div></div><p>You might have <a id="id298" class="indexterm"></a>noticed that all of our trees cast shadows, but our animals, player, and barns do not. The <span class="strong"><strong>Terrain</strong></span>, by default has the <span class="strong"><strong>Cast Shadows</strong></span> setting enabled. This accounts for the larger mountains that are casting shadows in our scene:</p><div class="mediaobject"><img src="/graphics/9781784398316/graphics/3852_07_10.jpg" /></div><p>The trees are also casting a shadow. This originates from the directional light we have in the scene. You can <a id="id299" class="indexterm"></a>simply disable the directional light by deselecting it in the <span class="strong"><strong>Inspector</strong></span> view:</p><div class="mediaobject"><img src="/graphics/9781784398316/graphics/3852_07_11.jpg" /></div><p>What if we want our two farmers and farm animals to cast shadows? We can add shadows to each game object with two steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Navigate and select <span class="strong"><strong>Farmer</strong></span> | <span class="strong"><strong>Character1_Reference</strong></span> | <span class="strong"><strong>Farmer</strong></span> in the <span class="strong"><strong>Hierarchy</strong></span> view, as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781784398316/graphics/3852_07_12.jpg" /></div></li><li><p>Navigate and select the <span class="strong"><strong>Shader</strong></span> | <span class="strong"><strong>Legacy Shaders</strong></span> | <span class="strong"><strong>Diffuse</strong></span> option in the <span class="strong"><strong>Farmer-texture</strong></span> section of the <span class="strong"><strong>Inspector</strong></span> view, as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781784398316/graphics/3852_07_13.jpg" /></div></li></ol></div><p>Now, you can see that <a id="id300" class="indexterm"></a>Pa Poo, our old farmer, casts a shadow. Watch his animations and you'll see that the shadow is dynamic.</p><div class="mediaobject"><img src="/graphics/9781784398316/graphics/3852_07_14.jpg" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch07lvl3sec30"></a>Trail rendering</h4></div></div></div><p>We can create a <a id="id301" class="indexterm"></a>visual effect in Unity that shows a trail behind an object as it moves. Like a ship leaving a wake, a trail shows where an object has been, in what direction it is heading, and an indication of speed. This is not a feature that we need in our game, but you could easily use this in other games you create. So, we'll demonstrate it with our Colt character. To do so, perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select <span class="strong"><strong>ThirdPersonController</strong></span> in the <span class="strong"><strong>Hierarchy</strong></span> view.</p></li><li><p>In the <span class="strong"><strong>Inspector</strong></span> view, click on the <span class="strong"><strong>Add Component</strong></span> button.</p></li><li><p>Next, navigate and select the <span class="strong"><strong>Effects</strong></span> | <span class="strong"><strong>Trail Renderer</strong></span> pop-up menu option, as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781784398316/graphics/3852_07_15.jpg" /></div></li><li><p>In the <span class="strong"><strong>Inspector</strong></span> view, set <span class="strong"><strong>Cast Shadows</strong></span> to <span class="strong"><strong>on</strong></span>. This will allow the rendered trail to cast shadows. The actual shadows will depend on the size of the trail, as well as its locational relation to light sources.</p></li><li><p>Ensure the <span class="strong"><strong>Receive Shadows</strong></span> checkbox is checked. With this setting, you can determine <a id="id302" class="indexterm"></a>whether or not the rendered trail can receive shadows. This can add a level of realism to your game.</p></li><li><p>Drag the <code class="literal">Mat_Yellow</code> asset to the <span class="strong"><strong>Materials</strong></span> | <span class="strong"><strong>Element 0</strong></span> field to apply the bright yellow material to the trail:</p><div class="mediaobject"><img src="/graphics/9781784398316/graphics/3852_07_16.jpg" /></div></li><li><p>You can now test the visual effect by putting the game in play mode.</p></li></ol></div><p>You'll see that Colt is leaving a yellow trail behind him. The arc in the screenshot shows where Colt jumped:</p><div class="mediaobject"><img src="/graphics/9781784398316/graphics/3852_07_17.jpg" /></div><p>There are a few other <a id="id303" class="indexterm"></a>
<span class="strong"><strong>Trail Renderer</strong></span> settings<a id="id304" class="indexterm"></a> to consider:</p><div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; "><colgroup><col align="left" /><col align="left" /></colgroup><thead><tr><th style="border-bottom: 0.5pt solid ; " align="left" valign="bottom">
<p>Setting</p>
</th><th style="border-bottom: 0.5pt solid ; " align="left" valign="bottom">
<p>Description</p>
</th></tr></thead><tbody><tr><td style="" align="left" valign="top">
<p><span class="strong"><strong>Time</strong></span></p>
</td><td style="" align="left" valign="top">
<p>Here, you set the length of the trail. The value refers to seconds.</p>
</td></tr><tr><td style="" align="left" valign="top">
<p><span class="strong"><strong>Start width</strong></span></p>
</td><td style="" align="left" valign="top">
<p>The width size of the trail at the start position. This would be at Colt's feet.</p>
</td></tr><tr><td style="" align="left" valign="top">
<p><span class="strong"><strong>End width</strong></span></p>
</td><td style="" align="left" valign="top">
<p>The width size of the trail at the end position. This would be the bitter end of the trail.</p>
</td></tr><tr><td style="" align="left" valign="top">
<p><span class="strong"><strong>Autodestruct</strong></span></p>
</td><td style="" align="left" valign="top">
<p>You can set your object to autodestruct after it has been idle for the number of seconds you have in the <span class="strong"><strong>Time</strong></span> setting.</p>
</td></tr></tbody></table></div><p>To become completely familiar with this visual effect, I recommend saving your scene, saving your project, and experimenting.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip11"></a>Tip</h3><p>If you employ the <span class="strong"><strong>Autodestruct</strong></span> function of the <span class="strong"><strong>Trail Renderer</strong></span>, your object will be destroyed after the number of seconds you specify in the <span class="strong"><strong>Time</strong></span> setting. If your <span class="strong"><strong>Trail Renderer</strong></span> is attached to Colt, you'll see him autodestruct after he is idle. So, this feature is great for things like sparks and fireballs, but not for our main character.</p></div><p>To disable this effect, simply uncheck the <span class="strong"><strong>Trail Renderer</strong></span> component in the <span class="strong"><strong>Inspector</strong></span> view.</p><div class="mediaobject"><img src="/graphics/9781784398316/graphics/3852_07_18.jpg" /></div></div></div></div>