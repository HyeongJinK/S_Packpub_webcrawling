<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch04lvl1sec31"></a>The texture toolset</h2></div></div><hr /></div><p>The fourth tab on the tools panel brings up the texturing features. <a id="id201" class="indexterm"></a>The drop-down control allows us to select between the brush, procedural, and decal tools.</p><div class="mediaobject"><img src="/graphics/9781849699396/graphics/9182_04_06.jpg" /></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec29"></a>ColorGen tool</h3></div></div></div><p>This tool requires an active color texture and paints areas <a id="id202" class="indexterm"></a>that match specified terrain parameters (altitude range, slope, orientation) with a color.</p><p>It does this using a component you'll see in several of the texture tools, called a <span class="strong"><strong>Distribution Mask</strong></span> (<span class="strong"><strong>DM</strong></span>), <a id="id203" class="indexterm"></a>
<a id="id204" class="indexterm"></a>these are found in the rollup of the ColorGen and MaskGen tools. They tell the editor how we want to apply a color or texture to a terrain based on a set of parameters. The tools can use one or more DMs and process them in a single operation although they can be fiddly to work with and often it's easier to use one at a time on different layers. Let's look at a single Distribution Mask component, refer back to this section if you need a reminder.</p><div class="mediaobject"><img src="/graphics/9781849699396/graphics/9182_04_07.jpg" /></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch04lvl3sec19"></a>Distribution Mask component</h4></div></div></div><p>The plus and minus icons at the top will add and remove <a id="id205" class="indexterm"></a>
<a id="id206" class="indexterm"></a>Distribution Masks. The default name will have the count in square brackets (for example, <span class="strong"><strong>Distribution Mask [0]</strong></span>).</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip10"></a>Tip</h3><p>It's possible to right-click on the Distribution Mask name to enter a more user friendly one.</p></div><p>Importantly, clicking on the name area of the Distribution Mask toggles its use. This is the mechanism by which the Distribution Masks are added to the <span class="strong"><strong>Layers in use</strong></span> list, at the very bottom of the rollup.</p><p>The <span class="strong"><strong>Active</strong></span> checkbox is a <a id="id207" class="indexterm"></a>quick means of toggling the Distribution Mask, we might have several in a preset but only want to use one.</p><p>The color picker box chooses how the material will be painted. If we want a texture instead, uncheck the <a id="id208" class="indexterm"></a>
<span class="strong"><strong>Color</strong></span> box and click on the "X" box to pick a texture from the package browser dialog.</p><p>Height values should be populated with the altitude range we only want to paint. <span class="strong"><strong>Att</strong></span> is the attenuation (fade) value (inversely proportional to the distance between <span class="strong"><strong>Min</strong></span>/<span class="strong"><strong>Max</strong></span>). A bigger value will blend the boundary over a larger area.</p><p>Slope allows you to specify the min and max angle to <a id="id209" class="indexterm"></a>
<a id="id210" class="indexterm"></a>paint, a max value of 45 will only paint on surfaces with an angle of up to 45 degrees.</p><p>
<span class="strong"><strong>Orientation</strong></span> <a id="id211" class="indexterm"></a>sets the direction we want to paint and <span class="strong"><strong>Spread</strong></span> is the angle offset left and right, so 180 degrees both left and right would be the full coverage.</p><p>The <span class="strong"><strong>Flowmap</strong></span> <a id="id212" class="indexterm"></a>checkbox will calculate water channels from the terrain surface and write only to these areas, the scale determines how broad the channels are.</p><p>To use a shape to define the drawing area you need to have a georeferenced ESRI shape file. Professional mapping tools can import and export these for bodies of water, roads, or anything that you might need in a real map. If we had real-world road data in such a format we could write solid colors or an asphalt texture directly onto the layer.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch04lvl3sec20"></a>Layers and Layers in use</h4></div></div></div><p>Before we can click on the <a id="id213" class="indexterm"></a>
<span class="strong"><strong>Apply</strong></span> button we must add at least one Distribution Mask to the <a id="id214" class="indexterm"></a>
<span class="strong"><strong>Layers in use</strong></span> parameter (this area of the rollup is shown next). </p><div class="mediaobject"><img src="/graphics/9781849699396/graphics/9182_04_08.jpg" /></div><p>To add a Distribution Mask to the operation we must ensure the following:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>We have a Color layer armed and selected (workspace panel)</p></li><li style="list-style-type: disc"><p>The name of the Distribution Mask is highlighted</p></li><li style="list-style-type: disc"><p>The name of the armed layer is highlighted in the <span class="strong"><strong>Layers in use</strong></span> panel</p></li><li style="list-style-type: disc"><p>We click the "+" icon to add the Distribution Masks</p></li></ul></div><p>Phew! Seems like a lot of steps. However, once you've had to do it a few times it becomes second nature.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip11"></a>Tip</h3><p>
<span class="strong"><strong>Adding Distribution Masks</strong></span>
</p><p>When you need to add more than one Distribution Mask, <a id="id215" class="indexterm"></a>you can hold down the <span class="emphasis"><em>Ctrl</em></span> key to highlight them and click on the "add" icon. Otherwise, you have to add them one at a time. </p><p>One thing we must consider, however, is that if we change the topography later then we may need to rebuild the texture layer. Watch out for shadows and cliff faces in particular as these will change if you go back to edit the heightmap.</p></div></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec30"></a>Shadowmap tool</h3></div></div></div><p>These bake shadows onto a material layer which is perhaps not desirable if you're designing for a game engine with real-time lighting and shadows (Unity Pro, UDK). Even so, if your game has fixed shadows then baking shadows onto the terrain is a good idea for performance.</p><p>Not only does this give you distant shadows, it also adds some depth to a scene. This tool will also generate shadows for 3D objects placed into the scene by GROME using the instance and vegetation tools which we'll cover later.</p><p>To create a shadow map we need to use the procedural shadowmap tool on a prepared material layer. For the material layer we need to use a masked texture.</p><p>Steps to create a shadowmap layer <a id="id216" class="indexterm"></a>are given as follows:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>Create a new layer</p></li><li style="list-style-type: disc"><p>Assign zones to the layer</p></li><li style="list-style-type: disc"><p>Select "New" mask; color should be black, set size to desired resolution</p></li><li style="list-style-type: disc"><p>For texture, click on the "X" box to bring up the package browser, navigate to <code class="literal">misc/shadow.tga</code> and select the black image</p></li><li style="list-style-type: disc"><p>Change the Layer Shadowing Configuration to "Masked Detail"</p></li></ul></div><p>Once your layer is ready and armed for use, from the procedural shadowmap tool, set the light direction as required (a button labeled <span class="strong"><strong>Get Camera Direction</strong></span> will rotate the light source to match camera rotation).</p><p>Click on <span class="strong"><strong>Apply</strong></span> and wait for the operation to complete. <a id="id217" class="indexterm"></a>This can take a long time if you have many zones or a high resolution shadow map.</p><p>The layer should be placed at the top of the layer stack so the terrain shadows are rendered on top of everything else.</p><p>If the shadow map reduces the brightness of the scene too much you can tweak the map using the <span class="strong"><strong>MaskFilter</strong></span> <a id="id218" class="indexterm"></a>tool next to it on the panel. This is shown in the following screenshot. On the left-hand side, the new shadowmap, on the right-hand side, the shadowmap adjusted using the MaskFilter.</p><div class="mediaobject"><img src="/graphics/9781849699396/graphics/9182_04_09.jpg" /></div><p>Reducing the brightness slightly and increasing the contrast on the mask will lighten the scene and deepen the shadows like bright sunlight. If the map suffers from leopard spots as a result of terrain noise you could try applying a Blur MaskFilter.</p><p>If you need to retouch the shadowmap using a brush for whatever reason, set the texture tool mode to <span class="strong"><strong>Brushes</strong></span> and use the <a id="id219" class="indexterm"></a>
<span class="strong"><strong>MaskBrush</strong></span> tool which will allow you to paint shadows directly.</p><p>You shouldn't ever need to do this; it's easier to simply rebuild the whole shadowmap.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec31"></a>MaskFilter tool</h3></div></div></div><p>This has exactly the same controls as the <a id="id220" class="indexterm"></a>
<span class="strong"><strong>SelectionFilter</strong></span> tool. <a id="id221" class="indexterm"></a>The difference of course is that this tool works on the texture mask. We can <span class="strong"><strong>Invert</strong></span>, <span class="strong"><strong>Blur</strong></span>, <span class="strong"><strong>Shrink</strong></span>, <span class="strong"><strong>Expand</strong></span>, and adjust <span class="strong"><strong>Brightness</strong></span>/<span class="strong"><strong>Contrast</strong></span>. <span class="strong"><strong>Brightness</strong></span> effectively adjusts mask opacity; a darker mask is more opaque.</p><div class="mediaobject"><img src="/graphics/9781849699396/graphics/9182_04_10.jpg" /></div><p>The final operation <a id="id222" class="indexterm"></a>
<span class="strong"><strong>Hidden pixel optimization</strong></span> removes areas of the mask that are hidden by layers above. This is important when exporting masks to other engines where they are combined into a single image and ideally you need a normalized mask.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec32"></a>MaskGen tool</h3></div></div></div><p>At the heart of this tool and perhaps the most important for dynamically texturing terrain is the Distribution Mask component (see the ColorGen tool for a <a id="id223" class="indexterm"></a>breakdown if you skipped it). The MaskGen tool operates on masked texture layers and procedurally generates the mask for the layer based on terrain topography as described by a series of Distribution Masks.</p><p>The tool comes with a number of useful presets for painting some kinds of terrain and vertical surfaces for mountainous terrain. Let's look at one of those and get an idea of what it does by example.</p><p>Bring up the MaskGen tool and from the presets select <span class="strong"><strong>AridVegetation</strong></span>. This has four Distribution Masks which we'll apply to separate material layers. Clear the material stack and we'll create four materials. We'll name them after the Distribution Masks as, <code class="literal">Base</code>, <code class="literal">01</code>, <code class="literal">02</code>, and <code class="literal">Detail</code>.</p><p>For each of these layers we need to assign our four island <a id="id224" class="indexterm"></a>zones to them and create a new mask. For texture choice we'll pick random ones for now. But the important thing is that we create a mask of at least 1,024 resolution with some texture attached.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch04lvl3sec21"></a>The Base layer</h4></div></div></div><p>Starting with the Base texture layer, <a id="id225" class="indexterm"></a>arm it and select the Base DM in the MaskGen rollup, add it to <span class="strong"><strong>Layers in use</strong></span>, and apply. The whole of the map should take on that texture's appearance as the Base DM covers pretty much everything.</p><p>In the workspace panel, expand the Base material and set the Base texture to use <code class="literal">arid/stone/rock06.dds</code>. Set the tiling UV to <code class="literal">20</code>.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch04lvl3sec22"></a>The 01 layer</h4></div></div></div><p>Disarm all layers and arm layer 01. <a id="id226" class="indexterm"></a>From the MaskGen tool, select the DM also named "01", add it to the <span class="strong"><strong>Layers in use</strong></span> and click on the <span class="strong"><strong>Apply</strong></span> button. This preset is assigned to generate a wide flowmap effect.</p><p>To get good contrast from it we should pick a light color texture. Assign the texture to something like <code class="literal">Romanian_sand05.dds</code> and the tiling UVs to <code class="literal">100</code> again. You should see dry riverbed effects on the terrain surface. If not, go back and check everything was selected correctly. It's easy to miss a step but practice makes perfect.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch04lvl3sec23"></a>Arm 02 Texture layer</h4></div></div></div><p>This layer will be used to cover flat plain areas. <a id="id227" class="indexterm"></a>So we'll pick a suitable desert plains texture from the provided library, <code class="literal">satellite/mexico03_tile.tga</code>. As before, disarm all layers then arm layer 02. We're now ready to apply Distribution Mask 02 from the MaskGen rollup.</p><p>Assign the layer in use and click on the <a id="id228" class="indexterm"></a>
<span class="strong"><strong>Apply</strong></span> button. Adjust the UVs to <code class="literal">30</code> (or whatever looks reasonable for the scale of the terrain). </p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch04lvl3sec24"></a>Final Detail layer</h4></div></div></div><p>The detail layer is a bit different. We'll assign the texture <code class="literal">dry_mud01</code> and set the UV tiling to <code class="literal">500</code> each. From the material stack we should <a id="id229" class="indexterm"></a>change the "Shader Configuration" <a id="id230" class="indexterm"></a>to "<a id="id231" class="indexterm"></a>Masked Bright Detail". What this does is, it adds an offset to the color blending so the layer appears brighter.</p><p>Select the Detail Distribution Mask, add it to the layer in use (which should be the Detail texture layer) and apply it.</p><p>A detail texture appears when viewing the terrain close to <a id="id232" class="indexterm"></a>ground level, it helps sell the scale of the scene at low level.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch04lvl3sec25"></a>All done</h4></div></div></div><p>By applying variations and experimenting with textures, scales, and blending, it's possible to create seasonal variations from the same scene. <a id="id233" class="indexterm"></a>You might want to try using the MaskFilters to blur or expand some of the layer coverage, just to get a feel for the different effects.</p><p>Ideally you need about eight or nine layers on a map to achieve really good results. Improvements we could make include more rocky details, flowmap enhancements and water features. Our final mask example will cover the creation of cliff faces using vertical mapping.</p></div></div></div>