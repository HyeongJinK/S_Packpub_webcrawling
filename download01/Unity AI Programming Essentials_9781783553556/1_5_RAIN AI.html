<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch01lvl1sec11"></a>RAIN AI</h2></div></div><hr /></div><p>
<span class="strong"><strong>Rival Theory's RAIN AI</strong></span> is a very full-featured AI to use and it is free. It includes a behavior tree <a id="id21" class="indexterm"></a>with similar functionality to React, but has more features built in. In fact, this one won't require any additional scripting to go from point A to point B.</p><p>To get this going, we'll need the following bases:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>A map to move around on</p></li><li style="list-style-type: disc"><p>A character to move around in the map</p></li><li style="list-style-type: disc"><p>A route (series of waypoints) for the character to follow</p></li><li style="list-style-type: disc"><p>A navigation mesh that knows what to avoid</p></li><li style="list-style-type: disc"><p>An AI to control the character</p></li><li style="list-style-type: disc"><p>A behavior tree to tell the AI what to do</p></li></ul></div><p>To start <a id="id22" class="indexterm"></a>with, you'll need to start a new Unity project, import Unity's Character Controller, and import the RAIN AI package.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note04"></a>Note</h3><p>Don't get the <a id="id23" class="indexterm"></a>RAIN AI package that is found in the Asset store. The current release (at the time of writing this book) can be found at the Rival Theory site, <a class="ulink" href="http://rivaltheory.com/rain/" target="_blank">rivaltheory.com/rain/</a>.</p></div><p>Perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>To create our map, add a plane. Then, add a couple of objects to act as obstacles. It is best if they create a <span class="emphasis"><em>U</em></span> or <span class="emphasis"><em>V</em></span> shape to potentially trap the player:</p><div class="mediaobject"><img src="/graphics/9781783553556/graphics/3556OT_01_07.jpg" /></div></li><li><p>Next, drag the predefined character found in <span class="strong"><strong>Project</strong></span> | <span class="strong"><strong>Standard</strong></span> <span class="strong"><strong>Assets</strong></span> | <span class="strong"><strong>Character</strong></span> <span class="strong"><strong>Controllers</strong></span> | <span class="strong"><strong>Sources</strong></span> | <span class="strong"><strong>Prototype</strong></span> <span class="strong"><strong>Character</strong></span> | "<span class="strong"><strong>constructor</strong></span>" into the scene. From the scene depicted in the preceding screenshot, I recommend placing him (the character) on the back left-hand side of the plane.</p></li><li><p>Next, we need a route. Although there is more than one waypoint system in RAIN, I found that the route will be the fastest for this demo. In the <span class="strong"><strong>RAIN</strong></span> menu, click on <span class="strong"><strong>Create Waypoint Route</strong></span>. Name it's game object <code class="literal">GreenPath</code>. We will need to call this later, so we want simple, easy names to remember.</p></li><li><p>In the <span class="strong"><strong>Inspector</strong></span> panel for <code class="literal">GreenPath</code>, click on the <span class="strong"><strong>Add (Ctrl W)</strong></span> button. This adds a waypoint. In fact, we need to add three. Place the first one on the inside of the V, the second on the tip of the V, and the last on the far edge of the plane, as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783553556/graphics/3556OT_01_08.jpg" /></div></li><li><p>Just as in<a id="id24" class="indexterm"></a> React AI and Unity NavMesh, we need a navigation mesh for this as well. We clearly defined the route, but as you can see, the path is blocked. In the RAIN menu, click on <span class="strong"><strong>Create</strong></span> <span class="strong"><strong>Navigation</strong></span> <span class="strong"><strong>Mesh</strong></span>. Align and stretch it so that it surrounds the area where you want the paths to be determined.</p><p>The Inspector panel for the NavMesh has a property called <span class="strong"><strong>Ignored Tags</strong></span>. Add <span class="strong"><strong>Player</strong></span> to this list. (You might need to make sure that the player object actually has that tag selected as well.) Otherwise, the NavMesh will not generate where the player stands, and will prevent its ability to find a path. Then click on <span class="strong"><strong>Generate</strong></span> <span class="strong"><strong>Navigation</strong></span> <span class="strong"><strong>Mesh</strong></span> at the bottom of the <span class="strong"><strong>Inspector</strong></span> panel. The result should look like this:</p><div class="mediaobject"><img src="/graphics/9781783553556/graphics/3556OT_01_12.jpg" /></div></li><li><p>Next, we <a id="id25" class="indexterm"></a>need to add an AI to control the character. Select the player object in the <span class="strong"><strong>Hierarchy</strong></span> panel, and from the <span class="strong"><strong>RAIN</strong></span> menu, click on <span class="strong"><strong>Create</strong></span> <span class="strong"><strong>AI</strong></span>.</p></li><li><p>Next, select the middle button of the character running in the AI <span class="strong"><strong>Inspector</strong></span> panel, then click on the <span class="strong"><strong>Add Existing Animations</strong></span> button at the bottom. This will add all the player's animations: idle, walk, jump, pose, and run. You can refer to the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783553556/graphics/3556OT_01_09.jpg" /></div></li><li><p>Next, we need to add a behavior tree. Behavior trees are a way to define decisions and actions for AI characters. We will discuss them in more detail in <a class="link" href="#" linkend="ch03">Chapter 3</a>, <span class="emphasis"><em>Behavior Trees</em></span>. For now, add one by clicking on the head/brain icon in the <span class="strong"><strong>Inspector</strong></span> panel and then click on the <span class="strong"><strong>Open Behaviour Editor button</strong></span>. On the right-hand side is a behavior tree drop-down selector, so click on it and choose <span class="strong"><strong>Create New Behaviour Tree</strong></span>.</p></li><li><p> Name it <span class="strong"><strong>FollowGreenRoad</strong></span>. It will already have one element, <span class="strong"><strong>SEQ</strong></span> (<span class="strong"><strong>Sequence</strong></span>), under<a id="id26" class="indexterm"></a> the root <span class="strong"><strong>BT</strong></span> (<span class="strong"><strong>behavior tree</strong></span>) node. Sequence it means that it will run any child nodes in order. Right-click on the <span class="strong"><strong>SEQ</strong></span> node and navigate to <span class="strong"><strong>Switch</strong></span> <span class="strong"><strong>To</strong></span> | <span class="strong"><strong>Parallel</strong></span>, which means that it will run all its child nodes simultaneously.</p></li><li><p>Let's add the child nodes and then set them up. Right-click on the <span class="strong"><strong>PAR</strong></span> node, then navigate to <span class="strong"><strong>Create</strong></span> | <span class="strong"><strong>Actions</strong></span> | <span class="strong"><strong>Animations</strong></span>. Right-click on <span class="strong"><strong>PAR</strong></span> again and navigate to <span class="strong"><strong>Create</strong></span> | <span class="strong"><strong>Actions</strong></span> | <span class="strong"><strong>Choose</strong></span> <span class="strong"><strong>Patrol</strong></span> <span class="strong"><strong>Waypoints</strong></span>. Then right-click on the new <span class="strong"><strong>WAY</strong></span> node and navigate to <span class="strong"><strong>Create</strong></span> | <span class="strong"><strong>Actions</strong></span> | <span class="strong"><strong>Move</strong></span>.</p><div class="mediaobject"><img src="/graphics/9781783553556/graphics/3556OT_01_10.jpg" /></div><p>Because the decision is to run things in parallel, it will animate the character and follow the waypoints at the same time.</p></li><li><p>Click on the green <span class="strong"><strong>animate</strong></span> node, and set its animation state to <span class="strong"><strong>walk</strong></span>. It is case sensitive, but you can select which animation the character should use.</p></li><li><p>Next, select the <span class="strong"><strong>WAY</strong></span> node. Here, you need to set <span class="strong"><strong>Waypoint Route</strong></span> to use. This was the navigation route we created earlier with the three waypoints. We called it <code class="literal">GreenPath</code>.</p></li><li><p>For the loop type, we'll make it <span class="strong"><strong>One</strong></span> <span class="strong"><strong>Way</strong></span> so that the character only travels to the end and stops there. Also, change the name of the loop to <span class="strong"><strong>Follow</strong></span> <span class="strong"><strong>Green</strong></span> <span class="strong"><strong>Path</strong></span>. This shows up next to the <span class="strong"><strong>WAY</strong></span> node, and helps explain what is happening.</p></li><li><p>Finally, set the Move Target Variable to <span class="strong"><strong>NextWayPoint</strong></span>. This is a variable that we are setting with the next waypoint in the path. When it is reached, the patrol route will set the variable to the next location in the path. We use this in the Move node.</p><div class="mediaobject"><img src="/graphics/9781783553556/graphics/3556OT_01_11.jpg" /></div></li><li><p>Select <a id="id27" class="indexterm"></a>the <span class="strong"><strong>move</strong></span> node, and in the properties, set the <span class="strong"><strong>Move</strong></span> <span class="strong"><strong>Target</strong></span> to <span class="strong"><strong>NextWayPoint</strong></span>, the variable that is being set by the patrol route we just configured. And set the <span class="strong"><strong>Move</strong></span> <span class="strong"><strong>Speed</strong></span> to a number, such as 3. This is how fast the character will move.</p></li><li><p>Now that we have created the behavior tree, we need to set the Character AI to use it. Select the AI object under the player object in the Hierarchy panel. On the Mind icon, for the <span class="strong"><strong>Behavior</strong></span> <span class="strong"><strong>Tree</strong></span> <span class="strong"><strong>Asset</strong></span>, set it to <span class="strong"><strong>FollowGreenRoad</strong></span>. This can be found by navigating to <span class="strong"><strong>Project</strong></span> | <span class="strong"><strong>AI</strong></span> | <span class="strong"><strong>Behavior Trees</strong></span>, or from the selector in the <span class="strong"><strong>Inspector</strong></span> panel, choose the <span class="strong"><strong>Assets</strong></span> tab, and it should be right on top.</p></li></ol></div><p>The demo should be able to run now. The character will move around the block and walk to the last waypoint in the path.</p></div>