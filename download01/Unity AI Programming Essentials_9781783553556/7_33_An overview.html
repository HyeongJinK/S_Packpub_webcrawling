<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch07lvl1sec33"></a>An overview</h2></div></div><hr /></div><p>In previous <a id="id199" class="indexterm"></a>chapters, we looked at how to do different specific AI tasks. We learned how to make characters patrol a path, have them wander an environment, change state with behavior trees, and sense objects in the game environment. These are all important, but it's more important to understand how we can combine these different elements to make AI that works well in a large game environment. We will need characters that can navigate an environment to perform tasks but then change based on game events that occur. To do this, the game needs to be designed at a high level, defining what the different AI character's main goals and actions are. These high-level goals are things such as wanting an enemy to patrol an area until it sees the player and then start to chase and attack him. From there, the different aspects of sensing need to be designed for the level, deciding what objects need to be tagged, so they can be used by the AI system. The characters then need sensors defined for the AI characters and high-level goals can be created using existing nodes and custom actions.</p><p>One of the ways we can define our character's adaptive behavior with RAIN is using RAIN's motor system. We <a id="id200" class="indexterm"></a>have been using the motor system with the move node but not directly. The motor system controls moving the character, and it is available through the motion panel in RAIN, the icon with two feet. This is how the motion panel in RAIN looks:</p><div class="mediaobject"><img src="/graphics/9781783553556/graphics/3556OT_07_01.jpg" /></div><p>RAIN supports three<a id="id201" class="indexterm"></a> different <a id="id202" class="indexterm"></a>kinds of motors:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>A basic motor, which <a id="id203" class="indexterm"></a>we will use for most cases</p></li><li style="list-style-type: disc"><p>A character controller<a id="id204" class="indexterm"></a> that uses the standard Unity character controller for movement</p></li><li style="list-style-type: disc"><p>A <a id="id205" class="indexterm"></a>Mecanim controller (we will discuss Mecanim with RAIN in <a class="link" href="#" linkend="ch10">Chapter 10</a>, <span class="emphasis"><em>Animation and AI</em></span>)</p></li></ul></div><p>The movement is target based: you give the motor a target position to go to and use the motor to get there.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note11"></a>Note</h3><p>Unity's character controller is very popular, but if you want to use it with RAIN, stick with RAIN's character controller. There are some known issues mixing Unity's basic character controller and RAIN 2.1.4. These should be fixed in a future version.</p></div><p>The fields for <a id="id206" class="indexterm"></a>motors are pretty straightforward:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>
<span class="strong"><strong>Speed</strong></span> / <span class="strong"><strong>Rotation Speed</strong></span>: This specifies how fast the character should move and rotate.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Close Enough Distance</strong></span> / <span class="strong"><strong>Close Enough Angle</strong></span>: This specifies how close the character needs to move to a target.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Face Before Move Angle</strong></span>: This specifies how much of an angle the character needs to be facing its target before moving. This prevents weird movements with very close targets.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Step Up Height</strong></span>: This specifies how much the character can step up; this is used to customize behavior for things such as steep terrain and staircases. We will discuss step up heights more in <a class="link" href="#" linkend="ch11">Chapter 11</a>, <span class="emphasis"><em>Advanced NavMesh Generation</em></span>.</p></li></ul></div><p>We use the motor system from a <span class="strong"><strong>Custom Action</strong></span> option in our demo, but you can use motors to move the character from any component.</p><p>Here's a little snippet that shows how to move from a standard Unity character script:</p><div class="informalexample"><pre class="programlisting">AIRigaiRig = GetComponentInChildren&lt;AIRig&gt;();
â€¦
aiRig.AI.Motor.UpdateMotionTransforms();

aiRig.AI.Motor.MoveTarget.VectorTarget = targetPositon;
aiRig.AI.Motor.Move();
aiRig.AI.Motor.ApplyMotionTransforms();</pre></div><p>First, we get <code class="literal">AIRig</code> attached to the character. Then, we call <code class="literal">UpdateMotionTransforms()</code> to make sure that the AI system has the latest transforms (position and rotation) from the character before updating. Next, we set <code class="literal">VectorTarget</code> to a <code class="literal">Vector3</code> variable as <code class="literal">targetPosition</code>, so the AI system knows where we want to go. Then, we call <code class="literal">Move()</code> to update the character's transforms in the AI system, and finally, we call <code class="literal">ApplyMotionTransforms()</code> to update our game to show the new transforms from the AI system. Using these methods, we can update game characters at any time.</p><p>With customized movements, we can have our characters adapt in any way we want. The best way to see how this works is to look at a demo. The demo that we will look at in this chapter is an extension of the ship demo from <a class="link" href="#" linkend="ch06">Chapter 6</a>, <span class="emphasis"><em>Sensors and Activities</em></span>. We will have a ship in a level searching for gold pieces, but we'll extend it to make the gold pieces appear more random and dynamic in the level over time. Then, we will have a bomb with a timer and when it goes off all of ships will be destroyed and stop updating their AI. This will illustrate how we can have AI characters react to game events.</p></div>