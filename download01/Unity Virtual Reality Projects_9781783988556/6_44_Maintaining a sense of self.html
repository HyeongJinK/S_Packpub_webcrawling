<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch06lvl1sec45"></a>Maintaining a sense of self</h2></div></div><hr /></div><p>In VR, you<a id="id357" class="indexterm"></a> could just be a floating one-dimensional eyeball in virtual space (like our initial <code class="literal">Diorama</code> camera), a normal human being, or maybe some full-bodied space creature. We have focused on walking around the scene and discussed how to set the camera height to the eye level. The implication was that someone experiencing VR has a sense of their own body. However, the camera height actually only makes sense when there's also a ground plane or some other stable reference point in your vicinity. When you're flying around like a bird, plane, or Superman, then the body height may not matter much.</p><p>Yet in the physical world, we all <span class="emphasis"><em>really do</em></span> have bodies, and our brains kind of expect that. Issues surrounding the sense of self can get very psychological, philosophical, and even religious. Also, it's mind-bending what VR might eventually be able to do in this regard. For now, we should focus on what we need in order to help make our VR experiences comfortable for our visitors.</p><div class="blockquote"><table border="0" width="100%" cellspacing="0" cellpadding="0" class="blockquote" summary="Block quote"><tr><td width="10%" valign="top"> </td><td width="80%" valign="top"><p><span class="emphasis"><em>He who experiences the unity of life sees his own Self in all beings, and all beings in his own Self, and looks on everything with an impartial eye.</em></span></p></td><td width="10%" valign="top"> </td></tr><tr><td width="10%" valign="top"> </td><td colspan="2" align="right" valign="top">--<span class="attribution"><span class="emphasis"><em>Buddha</em></span>
</span></td></tr></table></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec75"></a>Head-body disconnect</h3></div></div></div><p>When <a id="id358" class="indexterm"></a>reading up on virtual reality headsets, much is said about positional tracking and head pose. This is very important for the provision of immersive VR experiences. Unfortunately, you're probably just a nobody.</p><p>Most of us don't have body-tracking features in our VR setup and have only the head-tracking features (unless you're reading this book well after its been written, you're a very special, early adopter of body-tracking equipment, or you've been tinkering with <span class="strong"><strong>Microsoft Kinect</strong></span>). This means that when you look around (for example, from left to right), your software cannot know whether you moved just your head (from the neck up) or kept your head still but moved your whole body (for example, you just swiveled in your chair). Of <a id="id359" class="indexterm"></a>course, real life bodies, like rigged <a id="id360" class="indexterm"></a>avatars, can also twist the shoulders, hips, legs, and so on. Furthermore, eye tracking is another matter altogether—looking around without moving either your head or your body.</p><p>
<span class="emphasis"><em>What does this mean?</em></span> While wearing a VR headset, let's suppose that your first-person character has an avatar body. Suppose you're in a multiuser virtual world where other players can see you. If you turn your head, shouldn't only your avatar's head move? This makes sense. Until you start walking forward, your whole body probably should turn to face the direction in which you're going.</p><p>Consider another scenario. Suppose you're seated in the cockpit of a spaceship. You can move your head to look around where you're seated. However, your input controls direct where your ship is going.</p><p>You're getting the picture. Head-motion controls are not necessarily connected to your body (or spaceship) controls. However, I don't have body tracking. Also, while the Rift (and similar devices) has positional tracking, mobile VR headsets, such as GearVR and Google Cardboard, don't even have that.</p><p>Let's see what we can do about this.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec76"></a>Head and body...</h3></div></div></div><p>
<span class="strong"><strong>Feature</strong></span>: <span class="emphasis"><em>As a first-person character, when I am walking, then I can look down and see my feet facing the direction I'm going; When I'm not walking but looking around, my feet do not rotate.</em></span>
</p><p>To<a id="id361" class="indexterm"></a> build this, we're going to divide <code class="literal">MeMyselfEye</code> into separate head and body objects that can rotate independently and give the body some feet that point in the direction we're walking, as follows:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>With <code class="literal">MeMyselfEye</code> selected in the <span class="strong"><strong>Hierarchy</strong></span> panel, create an empty object by right-clicking and choosing <span class="strong"><strong>Create Empty</strong></span>. Rename it to <code class="literal">MeBody</code>.</p></li><li><p>Find your <span class="strong"><strong>Main Camera</strong></span> under <code class="literal">MeMyselfEye</code>, create an empty object by right-clicking and choosing <span class="strong"><strong>Create Empty</strong></span>, and rename it to <code class="literal">MeHead</code>.</p></li></ol></div><p>Now, our script can know the rotational look direction of the head, which is different from the facing direction of the body.</p><p>Whereas Unity wants you to think in terms of a <span class="emphasis"><em>camera</em></span> in the scene, I prefer to think in terms of the <span class="emphasis"><em>player</em></span>. Remember that the player is wearing an HMD. <span class="emphasis"><em>Her head is inside the HMD</em></span>. The HMD, also known as the camera object, has positional tracking. You don't need to rename the camera, but if you did, the hierarchy will look like this:</p><div class="mediaobject"><img src="/graphics/9781783988556/graphics/B04781_06_16.jpg" /></div><p>Although we<a id="id362" class="indexterm"></a> named the container of our body parts as <code class="literal">MeBody</code>, it can be more than virtual flesh and blood. If you're driving a car, it can include the car body. It can include anything that's attached to you or anything that you might be carrying, such as a weapon. If your app will support hand-held motion controllers and other tracking devices, these body parts and scripts will also be parented by <code class="literal">MeBody</code>.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec77"></a>...And feet</h3></div></div></div><p>Let's add feet to<a id="id363" class="indexterm"></a> the body. I have included an image file, <code class="literal">flip-flops.png</code>, with this book. (Otherwise, use anything that indicates a forward direction). Perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Import the <code class="literal">flip-flops.png</code> texture by navigating to <span class="strong"><strong>Import New Asset...</strong></span> under <span class="strong"><strong>Assets</strong></span>.</p></li><li><p>Create a new material in the <span class="strong"><strong>Project</strong></span> panel and name it <code class="literal">FlipFlops</code>.</p></li><li><p>Drag the flip-flops texture onto the <code class="literal">FlipFlops</code> material's <span class="strong"><strong>Albedo</strong></span> map and choose <span class="strong"><strong>Rendering Mode</strong></span> as <span class="strong"><strong>Cutout</strong></span>.</p></li><li><p>Create a <span class="strong"><strong>Quad</strong></span> object (by navigating to <span class="strong"><strong>GameObject</strong></span> | <span class="strong"><strong>3D Object</strong></span> | <span class="strong"><strong>Quad</strong></span>) as a child of <code class="literal">MeMyselfEye/MeBody</code>, name it <code class="literal">Feet</code>, and set its <span class="strong"><strong>Transform</strong></span> component's <span class="strong"><strong>Position</strong></span> to (<code class="literal">0</code>, <code class="literal">-1</code>, <code class="literal">0</code>) and it's <span class="strong"><strong>Rotation</strong></span> to (<code class="literal">90</code>, <code class="literal">0</code>, <code class="literal">0</code>) so that it lies flat on the ground plane.</p></li><li><p>With <code class="literal">Feet</code> selected in <span class="strong"><strong>Hierarchy</strong></span>, drag the <code class="literal">FlipFlops</code> material onto the <span class="strong"><strong>Inspector</strong></span> panel.</p></li></ol></div><p>If you try it now in VR, the feet are there, but they are not pointing in the direction in which we are walking. We need another script. For that, perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select the <code class="literal">MeMyselfEye</code> object in the <span class="strong"><strong>Hierarchy</strong></span> panel.</p></li><li><p>In the <span class="strong"><strong>Inspector</strong></span> panel, select <span class="strong"><strong>Add Component</strong></span> | <span class="strong"><strong>New Script</strong></span> and name it <code class="literal">BodyWalk</code>.</p></li></ol></div><p>Then, open the script and code it, as follows:</p><div class="informalexample"><pre class="programlisting">using UnityEngine;
using System.Collections;

public class BodyWalk : MonoBehaviour {
  private HeadLookWalk lookWalk;
  private Transform head;
  private Transform body;

  void Start () {
    lookWalk = GetComponent&lt;HeadLookWalk&gt; ();
    head = Camera.main.transform;
    body = transform.Find ("MeBody");
  }

  void Update () {
    if (lookWalk.isWalking) {
      body.transform.rotation = Quaternion.Euler (new Vector3 (0.0f, head.transform.eulerAngles.y, 0.0f));
    }
  }
}</pre></div><p>In the<a id="id364" class="indexterm"></a> script, we are assuming a specific hierarchy—the script is a component of <code class="literal">MeMyselfEye</code> and it has a direct child named <code class="literal">MeBody</code>.</p><p>Now, when walking, we not only move <code class="literal">MeMyselfEye</code> in the direction we're looking, we rotate its body in the same direction. Since we're standing vertically, the body rotates about the <span class="emphasis"><em>y</em></span>-axis only and the <span class="strong"><strong>X</strong></span> and <span class="strong"><strong>Z</strong></span> rotations are zeroed.</p><p>Save the script and try it in VR.</p><p>
<span class="emphasis"><em>What big feet you have, my dear!</em></span> OK, it's not a body and the feet are too big. Also, they aren't animated as you walk, but we have something to build on. Just showing flipflops attached to the first-person character goes a long way in giving you a sense of being grounded. It could be a skateboard or Segway instead. You're not just a floating one-dimensional point anymore.</p><p>If you still have the dashboard from <a class="link" href="#" linkend="ch05">Chapter 5</a>, <span class="emphasis"><em>World Space UI</em></span>, in your scene, you should now also move it as a <code class="literal">MeBody</code> child so that it follows the direction in which you're walking too.</p><p>The following screenshot shows the flipflops from the first-person character view:</p><div class="mediaobject"><img src="/graphics/9781783988556/graphics/B04781_06_17.jpg" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec78"></a>The body avatar</h3></div></div></div><p>Let's try<a id="id365" class="indexterm"></a> a full-body avatar. Unless you have a different humanoid that you prefer, we can use a clone of Ethan for our body, as follows:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>In the <span class="strong"><strong>Project</strong></span> panel, locate the <code class="literal">Ethan</code> prefab at <code class="literal">Standard Assets/ThirdPersonCharacter/Models/Ethan</code> and drag it into the <span class="strong"><strong>Hierarchy</strong></span> panel under <code class="literal">MeMyselfEye/MeBody</code>.</p></li><li><p>Set its <span class="strong"><strong>Transform</strong></span> component's <span class="strong"><strong>Position</strong></span> to (<code class="literal">0</code>, <code class="literal">-1</code>, <code class="literal">-0.2</code>).</p></li></ol></div><p>The <span class="strong"><strong>Y</strong></span> position = <code class="literal">-1</code>. So, his feet are on the ground. The camera is at <span class="strong"><strong>Z</strong></span> = <code class="literal">0</code>. So, <span class="strong"><strong>Z</strong></span> = <code class="literal">-0.2</code> puts the front of Ethan's face behind the camera.</p><p>Try it in VR.</p><p>It's a good start. We can walk around with a body. However, it has issues, and that's what we're here to discuss, but not necessarily fix today:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>
<span class="strong"><strong>No animations</strong></span>: Ethan is frozen in <span class="emphasis"><em>T-pose</em></span>. You know that Ethan is a rigged humanoid who can do all sorts of walking and running. Setting this up in <code class="literal">MeMyselfEye</code> will take some work.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Positional tracking</strong></span>: Unlike Cardboard, the awesome positional tracking features of Oculus Rift, and similar devices means that the given head pose not only changes the rotation, but also its position in world space. Our scripts don't account for this. If you keep your head in the same position and just look around, it seems OK. However, if you start leaning over, back, or any which way, you'll find yourself having a true out-of-body experience. (For example, lean back a distance and you'll see the back of Ethan's head in view.)</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>No head constraint</strong></span>: Unless your character is Linda Blair (<span class="emphasis"><em>The Exorcist</em></span>) or an <a id="id366" class="indexterm"></a>owl, it might be weird to be able to turn your head all the way around. When you're not in the <span class="emphasis"><em>walk</em></span> mode and just looking around, if you turn your gaze past your shoulder, the script should rotate the body accordingly to save your neck.</p></li></ul></div><p>Another big issue—these flipflops are way too big for my feet! This can be seen in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783988556/graphics/B04781_06_18.jpg" /></div><p>There are other considerations when planning a first-person avatar with respect to the actual player, such as gender and skin color.</p><p>The default Oculus Rift demo in <span class="strong"><strong>Configuration Utility</strong></span> has the player sitting in a desk chair, but <a id="id367" class="indexterm"></a>has no body. When you look down, all you see is a chair. Other games might provide a body without a head, which limits the need to sync the avatar with the VR head pose.</p><p>If you decide not to pursue this fullbody avatar idea for now, just delete it.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec79"></a>Virtual David le nose</h3></div></div></div><p>One <a id="id368" class="indexterm"></a>reason to have an avatar body is to help reduce motion sickness by giving the user a spatial context and a sense of being grounded. Virtual reality is very young, and people are exploring new, innovative ways. Maybe you don't need a whole body. Maybe you only need a nose!</p><p>According to David Whittinghill, a researcher at Purdue University, (<a class="ulink" href="http://www.purdue.edu/newsroom/releases/2015/Q1/virtual-nose-may-reduce-simulator-sickness-in-video-games.html" target="_blank">http://www.purdue.edu/newsroom/releases/2015/Q1/virtual-nose-may-reduce-simulator-sickness-in-video-games.html</a>), adding a virtual nose in your field of view<a id="id369" class="indexterm"></a> may help reduce motion sickness. Since we're in a mood to experiment, let's try it.</p><p>Back in the <span class="emphasis"><em>The visor HUD</em></span> section, and the <span class="emphasis"><em>The reticle cursor</em></span> section, in <a class="link" href="#" linkend="ch05">Chapter 5</a>, <span class="emphasis"><em>World Space UI</em></span>, we parented objects under the VR camera object so that it appears to be <span class="emphasis"><em>stuck to your face</em></span>. This sounds appropriate for a nose! Perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Import the <code class="literal">david-le-nose.png</code> texture that is provided with this book.</p></li><li><p>Create a new material, name it <code class="literal">Nose</code>, and drag the <code class="literal">.png</code> texture onto the material.</p></li><li><p>In the <code class="literal">Nose</code> material, set its <span class="strong"><strong>Shader</strong></span> as <span class="strong"><strong>Unlit | Transparent Cutout</strong></span>.</p></li><li><p>Also, adjust its <span class="strong"><strong>Mesh Renderer</strong></span> to no shadows (unchecking the <span class="strong"><strong>Cast Shadows</strong></span>, <span class="strong"><strong>Receive Shadows</strong></span>, and <span class="strong"><strong>Use light Probes</strong></span> options).</p></li><li><p>Locate the <span class="strong"><strong>Main Camera</strong></span> object and create a new quad so that it becomes a child of the camera. Name it <code class="literal">Nose</code>.</p></li><li><p>Set the <span class="strong"><strong>Nose</strong></span> quad's <span class="strong"><strong>Transform</strong></span> component's <span class="strong"><strong>Position</strong></span> to (<code class="literal">0</code>, <code class="literal">0</code>, <code class="literal">0.3</code>) so that it's in front of your face.</p></li><li><p>Drag the <code class="literal">Nose</code> material onto the <code class="literal">Nose</code> quad.</p></li></ol></div><p>Try it out in VR. Keep it if you like. A first-person character wearing a nose is shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783988556/graphics/B04781_06_19.jpg" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec80"></a>Audio cues</h3></div></div></div><p>Lest we<a id="id370" class="indexterm"></a> forget, audio is an important dimension of virtual reality. As another quick demo, let's add audible footsteps to our first-person character, as follows:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>With <code class="literal">MeMyselfEye</code> selected, navigate to <span class="strong"><strong>Add Component</strong></span> | <span class="strong"><strong>Audio</strong></span> | <span class="strong"><strong>Audio Source</strong></span>.</p></li><li><p>In the <span class="strong"><strong>Audio Source</strong></span> component, in the <span class="strong"><strong>Audio Clip</strong></span> field, click on the <span class="emphasis"><em>circle</em></span> icon (far right) to open the <span class="strong"><strong>Select AudioClip</strong></span> dialog box and choose <code class="literal">Footstep01</code>.</p></li><li><p>Uncheck the <span class="strong"><strong>Play On Awake</strong></span> checkbox.</p></li><li><p>Check off the <span class="strong"><strong>Loop</strong></span> checkbox.</p></li></ol></div><p>Now, we can modify the <code class="literal">BodyWalk</code> script, as follows:</p><div class="informalexample"><pre class="programlisting">using UnityEngine;
using System.Collections;

public class BodyWalk : MonoBehaviour {
  private HeadLookWalk lookWalk;
<span class="strong"><strong>  private AudioSource footsteps;</strong></span>
  private Transform head;
  private Transform body;

  void Start () {
    lookWalk = GetComponent&lt;HeadLookWalk&gt; ();
<span class="strong"><strong>    footsteps = GetComponent&lt;AudioSource&gt; ();</strong></span>
    head = Camera.main.transform;
    body = transform.Find ("MeBody");
  }

  void Update () {
    if (lookWalk.isWalking) {
      body.transform.rotation = Quaternion.Euler (new Vector3 (0.0f, head.transform.eulerAngles.y, 0.0f));
<span class="strong"><strong>      if (!footsteps.isPlaying) {</strong></span>
<span class="strong"><strong>        footsteps.Play ();</strong></span>
<span class="strong"><strong>      }</strong></span>
<span class="strong"><strong>    } else { // not walking</strong></span>
<span class="strong"><strong>      footsteps.Stop ();</strong></span>
    }
  }
}</pre></div><p>Now, whenever<a id="id371" class="indexterm"></a> you're walking, you'll hear footsteps.</p></div></div>