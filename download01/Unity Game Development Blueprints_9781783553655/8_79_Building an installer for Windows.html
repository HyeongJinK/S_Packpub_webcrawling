<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch08lvl1sec78"></a>Building an installer for Windows</h2></div></div><hr /></div><p>Just as I mentioned<a id="id652" class="indexterm"></a> previously, having a separate <code class="literal">Data</code> folder with our <code class="literal">.exe</code> file is<a id="id653" class="indexterm"></a> somewhat of a pain. Rather than give people a <code class="literal">.zip</code> file and hope they extract it all and then keep everything in the same folder, I will have the process be automatic and give the person an opportunity to have it installed just like a professional game. With that in mind, I'm going to go over a free way to create a Windows installer, as follows:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>The first thing we need to do is get our setup program. For our demonstration, I will be using Jordan Russell's Inno Setup software. Go to <a class="ulink" href="http://jrsoftware.org/isinfo.php" target="_blank">http://jrsoftware.org/isinfo.php</a>, and<a id="id654" class="indexterm"></a> click on the <span class="strong"><strong>Download Inno Setup</strong></span> link. Have a look at the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783553655/graphics/3655OT_08_11.jpg" /></div></li><li><p>From there, click<a id="id655" class="indexterm"></a> on the <span class="strong"><strong>Stable Release</strong></span> button, and <a id="id656" class="indexterm"></a>select the <span class="strong"><strong>isetup-5.5.5.exe</strong></span> file. Once it's finished, double-click on the executable to open it, clicking on the <span class="strong"><strong>Run</strong></span> button. If it shows a security warning message, click on <span class="strong"><strong>Yes</strong></span> to allow the changes to take place. Have a look at the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783553655/graphics/3655OT_08_12.jpg" /></div></li><li><p>From there, run <a id="id657" class="indexterm"></a>through the installation, making <a id="id658" class="indexterm"></a>sure to uncheck the <span class="strong"><strong>Install Inno Setup Preprocessor</strong></span> option since we won't be using it. Upon finishing this task, make sure that <span class="strong"><strong>Launch Inno Setup</strong></span> is checked, and then click on the <span class="strong"><strong>Finish</strong></span> button.</p></li><li><p>When you open the program, it will look somewhat like the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783553655/graphics/3655OT_08_13.jpg" /></div></li><li><p>From there, choose<a id="id659" class="indexterm"></a> <span class="strong"><strong>Create a new script file using the Script Wizard</strong></span> and then click on <span class="strong"><strong>OK</strong></span>.</p></li><li><p>From there, click <a id="id660" class="indexterm"></a>on the <span class="strong"><strong>Next</strong></span> button, and you'll come to the <span class="strong"><strong>Application Information</strong></span> section. Fill in your information, and then click on <span class="strong"><strong>Next</strong></span>. Have a look at the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783553655/graphics/3655OT_08_14.jpg" /></div></li><li><p>Next, you'll <a id="id661" class="indexterm"></a>come to some information about<a id="id662" class="indexterm"></a> the application folder. In general, you will not want to change this information, so I will click on <span class="strong"><strong>Next</strong></span>.</p></li><li><p>From here, we'll be brought to the <span class="strong"><strong>Application Files</strong></span> section where we need to specify the files we want to install. Under the <span class="strong"><strong>Application main executable file:</strong></span> section, click on <span class="strong"><strong>Browse</strong></span> to go to the location of your <code class="literal">Export</code> folder, where the <code class="literal">.exe</code> file is present, select it, and click on <span class="strong"><strong>Open</strong></span>. Have a look at the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783553655/graphics/3655OT_08_15.jpg" /></div></li><li><p>Now, we need to <a id="id663" class="indexterm"></a>add in the data folder. Click on the <span class="strong"><strong>Add Folderâ€¦</strong></span> button, select the<a id="id664" class="indexterm"></a> data folder, and then click on <span class="strong"><strong>OK</strong></span>. Have a look at the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783553655/graphics/3655OT_08_16.jpg" /></div></li><li><p>It will then ask <a id="id665" class="indexterm"></a>if files in subfolders should be included <a id="id666" class="indexterm"></a>as well. Select <span class="strong"><strong>Yes</strong></span>. Then, select the folder in the <span class="strong"><strong>Other Applications file</strong></span> section, and click on the <span class="strong"><strong>Edit</strong></span> button. From there, set the <span class="strong"><strong>Destination subfolder</strong></span> property to the same name as your data folder, click on <span class="strong"><strong>OK</strong></span>, and then click on <span class="strong"><strong>Next</strong></span>. Have a look at the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783553655/graphics/3655OT_08_17.jpg" /></div></li><li><p>In the next menu, check <a id="id667" class="indexterm"></a>whichever options you want, and<a id="id668" class="indexterm"></a> then click on <span class="strong"><strong>Next</strong></span>. Have a look at the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783553655/graphics/3655OT_08_18.jpg" /></div></li><li><p>Now, you'll have an<a id="id669" class="indexterm"></a> option to include a license file, such as<a id="id670" class="indexterm"></a> EULA or whatever your publisher may require, and any personal stuff you want to tell your users before or after installation. The program accepts <code class="literal">.txt</code> and <code class="literal">.rtf</code> files. Once you're ready, click on the <span class="strong"><strong>Next</strong></span> button. Have a look at the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783553655/graphics/3655OT_08_19.jpg" /></div></li><li><p>Next, they'll allow <a id="id671" class="indexterm"></a>you to specify what languages you want <a id="id672" class="indexterm"></a>the installation to work for. I'll just go for English, but you can add more. Afterward, click on <span class="strong"><strong>Next</strong></span>.</p></li><li><p>Finally, we need to set where we want the setup to be placed as well as the icon for it or a password. I created a new folder on my desktop called <code class="literal">TwinstickSetup</code> and used it. Then, click on <span class="strong"><strong>Next</strong></span>, as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783553655/graphics/3655OT_08_20.jpg" /></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note91"></a>Note</h3><p>If you want to include a custom icon but don't have a <code class="literal">.ico</code> file, you can use the <a class="ulink" href="http://www.icoconverter.com/" target="_blank">http://www.icoconverter.com/</a> link.</p></div></li><li><p>Next, you'll be <a id="id673" class="indexterm"></a>brought to the successfully<a id="id674" class="indexterm"></a> completed script wizard screen. After this, click on <span class="strong"><strong>Finish</strong></span>. Have a look at the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783553655/graphics/3655OT_08_21.jpg" /></div></li><li><p>Now, it will <a id="id675" class="indexterm"></a>ask you if you want to compile the script. Select <span class="strong"><strong>Yes</strong></span>. It'll also ask you if you want to save your script. You'll also<a id="id676" class="indexterm"></a> want to say <span class="strong"><strong>Yes</strong></span>, and I saved it to the same folder as my exporting folder. It'll take a minute or two, but as soon as you see <span class="strong"><strong>Finished</strong></span> in the console window, it should be ready. Have a look at the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783553655/graphics/3655OT_08_22.jpg" /></div></li><li><p>If you go to the same place as your <code class="literal">Export</code> folder, you should see your installer, as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783553655/graphics/3655OT_08_23.jpg" /></div></li><li><p>If you run it, it'll<a id="id677" class="indexterm"></a> look somewhat like the following <a id="id678" class="indexterm"></a>screenshot:</p><div class="mediaobject"><img src="/graphics/9781783553655/graphics/3655OT_08_24.jpg" /></div></li></ol></div><p>And with that, we<a id="id679" class="indexterm"></a> now have a working installer for <a id="id680" class="indexterm"></a>our game!</p></div>