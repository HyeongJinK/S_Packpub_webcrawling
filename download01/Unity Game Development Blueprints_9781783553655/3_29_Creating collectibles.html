<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch03lvl1sec33"></a>Creating collectibles</h2></div></div><hr /></div><p>At this point, we have the <a id="id213" class="indexterm"></a>basis of our game, but now, we need to <a id="id214" class="indexterm"></a>add some gameplay to our world. Perhaps we will have it so that we need to collect all of the coins in the level, and then the goal will open:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Create a new particle system by going to <span class="strong"><strong>GameObject</strong></span> | <span class="strong"><strong>Create Other</strong></span> | <span class="strong"><strong>Particle System</strong></span> (in case of Unity 4.6, go to <span class="strong"><strong>GameObject</strong></span> | <span class="strong"><strong>Particle System</strong></span>). Change the name of the object to <code class="literal">Collectible</code>. Next, we need to assign the object's tag to <code class="literal">Orb</code>. To do so, select <span class="strong"><strong>Tag</strong></span> | <span class="strong"><strong>Add Tag</strong></span>. Once in the <span class="strong"><strong>Tag</strong></span> menu, assign <span class="strong"><strong>Element 0</strong></span> as <code class="literal">Orb</code>, and press <span class="emphasis"><em>Enter</em></span>. Select the <span class="strong"><strong>Collectible</strong></span> game object in <span class="strong"><strong>Hierarchy</strong></span> again, and then select <span class="strong"><strong>Tag</strong></span> as <code class="literal">Orb</code>.</p></li><li><p>Under the <span class="strong"><strong>Shape</strong></span> section, change the <span class="strong"><strong>Shape </strong></span>variable to <code class="literal">Sphere</code> and the <span class="strong"><strong>Radius</strong></span> to <code class="literal">0.01</code>.</p></li><li><p>Click on the downward-facing arrow on the right-hand side of <span class="strong"><strong>Start Lifetime</strong></span>, and change the values to <span class="strong"><strong>Random Between Two Constants</strong></span>. Change those values to <code class="literal">0</code> and <code class="literal">.2</code>. Do the same with <span class="strong"><strong>Start Speed</strong></span> between <code class="literal">0</code> and <code class="literal">1</code>. Make <span class="strong"><strong>Start Size</strong></span> use random values between <code class="literal">0</code> and <code class="literal">1.5</code>.</p></li><li><p>Under <span class="strong"><strong>Start Color</strong></span>, change <a id="id215" class="indexterm"></a>the value to <a id="id216" class="indexterm"></a>yellow by clicking on the color to bring up the color select dialogue. Once there, set alpha (<span class="strong"><strong>A</strong></span>) to <code class="literal">39</code>. Have a look at the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783553655/graphics/3655OT_03_11.jpg" /></div></li><li><p>Next, under <span class="strong"><strong>Emission</strong></span>, set <span class="strong"><strong>Rate</strong></span> to <code class="literal">100</code>.</p></li><li><p>Now, add a sphere collider by selecting <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>Physics</strong></span> | <span class="strong"><strong>Sphere Collider</strong></span>. Inside <span class="strong"><strong>Inspector</strong></span>, trigger the <span class="strong"><strong>Is Trigger</strong></span> Boolean to <code class="literal">true</code>, set <span class="strong"><strong>Center</strong></span> to (<code class="literal">0</code>, <code class="literal">0</code>, <code class="literal">0</code>), and then set <span class="strong"><strong>Radius</strong></span> to <code class="literal">0.4</code>. Have a look at the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783553655/graphics/3655OT_03_12.jpg" /></div></li><li><p>Finally, drag-and-drop <a id="id217" class="indexterm"></a>the <code class="literal">Orb</code> object into <a id="id218" class="indexterm"></a>the <code class="literal">Prefabs</code> section of the <code class="literal">Project</code> folder, and delete the object in <span class="strong"><strong>Hierarchy</strong></span>.</p></li><li><p>Now, we need to modify our original build-level function to have support to add these collectibles as well to our level. While we're at it, let's make it so the level can spawn the player as well. Rename our player object to <code class="literal">Player</code>, and drag-and-drop it to the <code class="literal">Prefabs</code> folder as well, and delete it from the <span class="strong"><strong>Hierarchy</strong></span> section as we will now learn how to spawn it via code.</p></li><li><p>Because we're writing a new function, we have some new variables to introduce in the <code class="literal">GameController</code> class:</p><div class="informalexample"><pre class="programlisting">public Transform player;
public Transform orb;</pre></div></li><li><p>Then, change the build-level function, replacing what was inside of our for loops to:</p><div class="informalexample"><pre class="programlisting">void BuildLevel ()
{
  // Get the DynamicObjects object so we can make it our newly
  // created objects' parent
  GameObject dynamicParent = GameObject.Find ("DynamicObjects");

  // Go through each element inside our level variable
  for (int yPos = 0; yPos &lt; level.Length; yPos++) 
  {
    for (int xPos = 0; xPos &lt; (level[yPos]).Length; xPos++) 
    {
<span class="strong"><strong>      Transform toCreate = null;</strong></span>
<span class="strong"><strong>      switch(level[yPos][xPos])</strong></span>
<span class="strong"><strong>      {</strong></span>
<span class="strong"><strong>        case 0:</strong></span>
<span class="strong"><strong>          //Do nothing because we don't want anything there.</strong></span>
<span class="strong"><strong>          break;</strong></span>

<span class="strong"><strong>        case 1:</strong></span>
<span class="strong"><strong>          toCreate = wall;</strong></span>
<span class="strong"><strong>          break;</strong></span>

<span class="strong"><strong>        case 2:</strong></span>
<span class="strong"><strong>          toCreate = player;</strong></span>
<span class="strong"><strong>          break;</strong></span>

<span class="strong"><strong>        case 3:</strong></span>
<span class="strong"><strong>          toCreate = orb;</strong></span>
<span class="strong"><strong>          break;</strong></span>

<span class="strong"><strong>        default:</strong></span>
<span class="strong"><strong>       </strong></span>
<span class="strong"><strong>   print("Invalid number: "+(level[yPos][xPos]).ToString());</strong></span>
<span class="strong"><strong>          break;</strong></span>
<span class="strong"><strong>      }</strong></span>

<span class="strong"><strong>      if(toCreate != null)</strong></span>
<span class="strong"><strong>      {</strong></span>
<span class="strong"><strong>        Transform newObject = Instantiate(toCreate, new Vector3(xPos, (level.Length - yPos), 0), Quaternion.identity) as Transform;</strong></span>

<span class="strong"><strong>        // Set the object's parent to the DynamicObjects</strong></span>
<span class="strong"><strong>        // variable so it doesn't clutter our Hierachy</strong></span>
<span class="strong"><strong>        newObject.parent = dynamicParent.transform;</strong></span>
<span class="strong"><strong>      }</strong></span>
      
    }
  }
}</pre></div><p>This is the first time you may have seen a switch statement. A <span class="strong"><strong>switch statement</strong></span> can be thought of as a nice way to compare a single variable with<a id="id219" class="indexterm"></a> a number of <a id="id220" class="indexterm"></a>different values. In this case, the switch statement that we wrote in the preceding example could be rewritten as follows:</p><div class="informalexample"><pre class="programlisting">if(level[yPos][xPos] == 0)
{

}
else if(level[yPos][xPos] == 1)
{
  toCreate = wall;
}
else if(level[yPos][xPos] == 2)
{
  toCreate = player;
}
else if(level[yPos][xPos] == 3)
{
  toCreate = orb;
}
else
{
  print("Invalid number: "+ (level[yPos][xPos]).ToString());
}</pre></div><p>But I'm sure you can tell, writing it as a switch statement is much nicer to look at and requires less code duplication, which is something we want to reduce as much as possible.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note41"></a>Note</h3><p>For those of you with a programming background, you are required to put a <code class="literal">break</code> at the end of each case so that fall-throughs are not possible in C#.</p></div></li><li><p>After this, we need to modify our level array to actually have the collectibles and player in it. Replace one of the <code class="literal">0</code>s in your level to a <code class="literal">2</code> to put the player there and add in some <code class="literal">3</code>s for the player to collect. Mine looks like the following:</p><div class="informalexample"><pre class="programlisting">private int[][] level = new int[][]
{
  new int[]{1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1},
  new int[]{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
  new int[]{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
  new int[]{1, 3, 0, 0, 0, 0, 0, 0, 0, 0, 3, 3, 3, 0, 0, 0, 0, 0, 1},
  new int[]{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1},
  new int[]{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1},
  new int[]{1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1},
  new int[]{1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
  new int[]{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
  new int[]{1, 0, 0, 0, 0, 0, 3, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
  new int[]{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
  new int[]{1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
  new int[]{1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1},
  new int[]{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 3, 1},
  new int[]{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
  new int[]{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1},
  new int[]{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1},
  new int[]{1, 0, 0, 0, 0, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1},
  new int[]{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1},
  new int[]{1, 0, 0, 0, 3, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1},
  new int[]{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1},
  new int[]{1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1},
  new int[]{1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1},
  new int[]{1, 0, 2, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1},
  new int[]{1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1}
  };</pre></div></li><li><p>Save your script, and exit back into the editor. Once there, select your <code class="literal">GameController</code> class, and then assign the <code class="literal">Player</code> and <code class="literal">Orb</code> variables with the appropriate prefabs. Finally, save your scene, and run the game. Have a look at the <a id="id221" class="indexterm"></a>following <a id="id222" class="indexterm"></a>screenshot:</p><div class="mediaobject"><img src="/graphics/9781783553655/graphics/3655OT_03_13.jpg" /></div><p>And there we go! Our player as well as collectibles are now spawning via our <code class="literal">BuildLevel</code> function. Lastly, let's make it so that we can actually collect them.</p></li><li><p>After we have the physical representation of the object done, let's now implement its functionality. Create a new script in our <span class="strong"><strong>Scripts</strong></span> folder, which we will name <code class="literal">OrbBehaviour</code>. Open it up in <code class="literal">MonoDevelop</code> and fill it in with the following:</p><div class="informalexample"><pre class="programlisting">using UnityEngine;

public class OrbBehaviour : MonoBehaviour 
{
  void OnTriggerEnter(Collider other) 
  {
    Destroy(this.gameObject);
  }
}</pre></div></li><li><p>Assign the <code class="literal">OrbBehavior</code> component to the <code class="literal">Orb</code> prefab. Save the scene, and then play the <a id="id223" class="indexterm"></a>game. Have a look at<a id="id224" class="indexterm"></a> the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783553655/graphics/3655OT_03_14.jpg" /></div></li></ol></div><p>And with that we can now collect orbs, and they disappear when we touch them!</p></div>