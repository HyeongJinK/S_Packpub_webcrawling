<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch02lvl1sec24"></a>Pausing the game</h2></div></div><hr /></div><p>Now that we have started on our<a id="id122" class="indexterm"></a> main menu, let's add some additional GUI functionality <a id="id123" class="indexterm"></a>to our game, adding in the ability to pause our game and restart it. However, before we do that, let's take a look at some stuff we can do to make our lives easier when it comes to customization:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>We also want to make these buttons have the same appearance as the stuff we've done previously. However, instead of having to set these properties every single time, we can use something called a <span class="strong"><strong>GUISkin</strong></span> to change what the default controls will appear like by setting the <code class="literal">GUI.skin</code> property to a new one.</p></li><li><p>Create a GUISkin by navigating to <span class="strong"><strong>Project</strong></span> | <span class="strong"><strong>Create</strong></span> | <span class="strong"><strong>GUI Skin</strong></span>, and rename the skin to <code class="literal">GUISkin</code>. Open up the <span class="strong"><strong>Button</strong></span> tab, and you should notice it looks exactly the same as the previous section. Do those same changes that we did previously here, but change the <span class="strong"><strong>Text Color</strong></span> property to black by clicking on the current color and then selecting black from the color cube that pops up. Alternatively, you can set the <code class="literal">R</code> (red), <code class="literal">G</code> (green), and <code class="literal">B</code> (blue) values to <code class="literal">0</code> and the <code class="literal">A</code> (alpha, which is the transparency) to <code class="literal">255</code> in the slider section.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note27"></a>Note</h3><p>RGBA colors<a id="id124" class="indexterm"></a> use values between 0 and 255, with 0 being no color and 255 being full color. Unlike in painting where if you keep adding colors, it'll get darker on the computer, the colors will get brighter and the screen lighter. All the colors on your computer monitor can be represented in this way.</p></div></li><li><p>Also, change the <span class="strong"><strong>Font</strong></span> property to <span class="strong"><strong>OSP-DIN</strong></span> so that our fonts will not change anywhere. Finally, for the <span class="strong"><strong>Label</strong></span> section, change <span class="strong"><strong>Alignment</strong></span> option to <span class="strong"><strong>Upper Center</strong></span>.</p></li><li><p>Now that we have a basic<a id="id125" class="indexterm"></a> knowledge of GUISkins, let's actually<a id="id126" class="indexterm"></a> implement the pause menu. Right-click on the <code class="literal">Scripts</code> folder you created earlier and then click on <span class="strong"><strong>Create</strong></span> and then select the <span class="strong"><strong>C# Script</strong></span> label. Call this new script <code class="literal">PauseMenu</code>. Open the MonoDevelop IDE and use the following code:</p><div class="informalexample"><pre class="programlisting">using UnityEngine;
using System.Collections;

public class PauseMenu : MonoBehaviour 
{
  public static bool isPaused;
  public float windowWidth = 256;
  public float windowHeight = 100;

  public GUISkin newSkin;

  void Start()
  {
    //We don't want the game paused when it starts and/or resets
    isPaused = false;
  }

  void OnGUI() 
  {
    // Set the GUI's default skin to the one we set here
    GUI.skin = newSkin;
    if(isPaused) 
    {
      // First, we pause the game
      Time.timeScale = 0.0f;

      // Then we need to display the pause menu
      ShowPauseMenu();

    }
    else
    {
      // Make the game run like normal
      Time.timeScale = 1.0f;
    }
  }

  void ShowPauseMenu()
  {
    // Then we need to display the pause menu
    float windowX = ( Screen.width - windowWidth ) / 2;
    float windowY = ( Screen.height - windowHeight ) / 2;

    GUILayout.BeginArea(new Rect( windowX, windowY, 
                                  windowWidth, windowHeight ));

    if (GUILayout.Button ("Resume")) 
    {
      //resume the game
      isPaused = false;
    }
    if (GUILayout.Button ("Main Menu")) 
    {
      Application.LoadLevel("Main_Menu");
    }
    if (GUILayout.Button ("Exit Game")) 
    {
      // Only works when published
      Application.Quit();
    }

    GUILayout.EndArea();
  }
}</pre></div><p>This script uses a Boolean (<code class="literal">true</code>/<code class="literal">false</code>) value to determine if the game is paused or not. If the game is paused, we set the <code class="literal">Time.timeScale</code> property to <code class="literal">0</code>, which means that nothing can move because time has <a id="id127" class="indexterm"></a>frozen. The <code class="literal">Time.timeScale</code> property<a id="id128" class="indexterm"></a> changes the scale time. For example, if we set it to <code class="literal">0.5f</code>, then time will run two times slower than normal (<code class="literal">1.0f</code>). This will freeze the normal objects, but GUI buttons will still work. In addition, I also called the <code class="literal">ShowPauseMenu</code> function, which will display a series of buttons that will let the player resume, go to the main menu, or quit the game.</p></li></ol></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec16"></a>GUILayout</h3></div></div></div><p>Another thing you <a id="id129" class="indexterm"></a>may have noticed is the fact that I am using the <code class="literal">GUILayout</code> class instead of the <code class="literal">GUI</code> class that we used in the <span class="emphasis"><em>Adding in points, score, and wave numbers</em></span> section in <a class="link" href="#" linkend="ch01">Chapter 1</a>, <span class="emphasis"><em>2D Twin-stick Shooter</em></span> without writing code. Using the <code class="literal">GUI</code> class is great if you want to have precise control on where and how things are drawn. However, if you do not want to manually specify a position and are okay with Unity automatically modifying the size and position of controls, you can use the <code class="literal">GUILayout</code> class.</p><p>By default, the <code class="literal">GUILayout</code> class will just put the buttons up at the top-left side, but I want our pause menu to be on the center of the screen. So, I specify an area that I want the menu to be in using the <code class="literal">BeginArea</code> function. Anything I place before I call the <code class="literal">EndArea</code> function will be inside that area, and <code class="literal">GUILayout</code> will attempt to place it in a pleasing way for me. You need to perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>With the script written, add the behavior to the <span class="strong"><strong>Main Camera</strong></span> object by dragging and dropping. Set the <span class="strong"><strong>New Skin</strong></span> property to the GUISkin we created previously.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note28"></a>Note</h3><p>When working on larger projects, it may be a good idea to use a GUISkin<a id="id130" class="indexterm"></a> instead of GUIStyles<a id="id131" class="indexterm"></a> to skin everything, by default, to something else. For more information on GUISkins, check<a id="id132" class="indexterm"></a> out <a class="ulink" href="https://docs.unity3d.com/Documentation/Components/class-GUISkin.html" target="_blank">https://docs.unity3d.com/Documentation/Components/class-GUISkin.html</a>.</p></div></li><li><p>Now, we need to configure the game such that the player can pause the game when he/she presses the <span class="emphasis"><em>Esc</em></span> key. Also, if the game is paused, no one can move but the player can still rotate and shoot, which we don't want. To fix this, we will need to modify the player behavior script; specifically, we need to modify the <code class="literal">Update</code> function to support pausing:</p><div class="informalexample"><pre class="programlisting">  void Update () 
  {      
<span class="strong"><strong>    if(Input.GetKeyUp("escape")) </strong></span>
<span class="strong"><strong>    {</strong></span>

<span class="strong"><strong>      // If false becomes true and vice versa</strong></span>
<span class="strong"><strong>      PauseMenu.isPaused = !PauseMenu.isPaused;</strong></span>
<span class="strong"><strong>    }</strong></span>

<span class="strong"><strong>    if(!PauseMenu.isPaused)</strong></span>
<span class="strong"><strong>    {</strong></span>
      // Rotate player to face mouse
      Rotation();
      // Move the player's body
      Movement();

      foreach (KeyCode element in shootButton)
      {
        if(Input.GetKey(element) &amp;&amp; timeTilNextFire &lt; 0)
        {
          timeTilNextFire = timeBetweenFires;
          ShootLaser();
          break;
        }
      }
      
      timeTilNextFire -= Time.deltaTime;
    }
  }</pre></div><p>Normally, we'd <a id="id133" class="indexterm"></a>need a component to be attached to an object to use it. However, since the <code class="literal">PauseMenu.isPaused</code> variable is both public and static, anyone can modify it.</p></li><li><p>Now, navigate to <span class="strong"><strong>File</strong></span> | <span class="strong"><strong>Build Settings</strong></span> and add both the <span class="strong"><strong>Main Menu</strong></span> and <span class="strong"><strong>Game</strong></span> (<span class="strong"><strong>Chapter_1</strong></span>) scenes to your <span class="strong"><strong>Scenes In Build</strong></span> property if you haven't already. Afterward, make sure that the <span class="strong"><strong>Main Menu</strong></span> scene is in the <code class="literal">0</code> place. If it is not, feel free to drag it up there via the mouse.</p></li><li><p>Save your files and <a id="id134" class="indexterm"></a>start up the game once again, as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783553655/graphics/3655OT_02_7.jpg" /></div></li></ol></div><p>Now, we have a fully functional pause menu that will allow us to press the <span class="emphasis"><em>Esc</em></span> key and leave what we're doing in the project. We've also made it incredibly easy for us to draw buttons in the style that we created for other sections.</p></div></div>