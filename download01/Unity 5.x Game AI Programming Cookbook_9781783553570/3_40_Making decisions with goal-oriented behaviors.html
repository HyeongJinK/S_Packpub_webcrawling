<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch03lvl1sec45"></a>Making decisions with goal-oriented behaviors</h2></div></div><hr /></div><p>Goal-oriented <a id="id176" class="indexterm"></a>behaviors are a set of techniques <a id="id177" class="indexterm"></a>aimed at giving agents not only a sense of intelligence, but also a sense of free will, once a goal is defined, and given a set of rules to choose from.</p><p>Imagine that we're developing a trooper agent that needs to only reach the endpoint of capturing the flag (the main goal), while taking care of its life and ammo (the inner goals for reaching the first). One way of implementing it is by using a general-purpose algorithm for handling goals, so the agent develops something similar to free will.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec152"></a>Getting ready</h3></div></div></div><p>We will learn how to create a goal-based action selector that chooses an action considering the main goal, avoids unintentional actions with disrupting effects, and takes an action's duration into account. Just like the previous recipe, this requires the modeling of goals in terms of numerical values.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec153"></a>How to do it...</h3></div></div></div><p>Along with the action chooser, we will create base classes for actions and goals:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Create the base class for modeling actions:</p><div class="informalexample"><pre class="programlisting">using UnityEngine;
using System.Collections;

public class ActionGOB : MonoBehaviour
{
    public virtual float GetGoalChange(GoalGOB goal)
    {
        return 0f;
    }

    public virtual float GetDuration()
    {
        return 0f;
    }
}</pre></div></li><li><p>Create <a id="id178" class="indexterm"></a>the <code class="literal">GoalGOB</code> parent <a id="id179" class="indexterm"></a>class with member functions:</p><div class="informalexample"><pre class="programlisting">using UnityEngine;
using System.Collections;

public class GoalGOB
{
    public string name;
    public float value;
    public float change;
}</pre></div></li><li><p>Define the proper functions to handle discontentment and change over time:</p><div class="informalexample"><pre class="programlisting">public virtual float GetDiscontentment(float newValue)
{
    return newValue * newValue;
}

public virtual float GetChange()
{
    return 0f;
}</pre></div></li><li><p>Define the <code class="literal">ActionChooser</code> class:</p><div class="informalexample"><pre class="programlisting">using UnityEngine;
using System.Collections;

public class ActionChooser : MonoBehaviour
{
}</pre></div></li><li><p>Implement <a id="id180" class="indexterm"></a>the function for handling unintentional actions:</p><div class="informalexample"><pre class="programlisting">public float CalculateDiscontentment(ActionGOB action, GoalGOB[] goals)
{
    float discontentment = 0;
    foreach (GoalGOB goal in goals)
    {
        float newValue = goal.value + action.GetGoalChange(goal);
        newValue += action.GetDuration() * goal.GetChange();
        discontentment += goal.GetDiscontentment(newValue);
    }
    return discontentment;
}</pre></div></li><li><p>Implement <a id="id181" class="indexterm"></a>the function for choosing an action:</p><div class="informalexample"><pre class="programlisting">public ActionGOB Choose(ActionGOB[] actions, GoalGOB[] goals)
{
    ActionGOB bestAction;
    bestAction = actions[0];
    float bestValue = CalculateDiscontentment(actions[0], goals);
    float value;
    // next steps
}</pre></div></li><li><p>Pick the best action based on which one is least compromising:</p><div class="informalexample"><pre class="programlisting">foreach (ActionGOB action in actions)
{
    value = CalculateDiscontentment(action, goals);
    if (value &lt; bestValue)
    {
        bestValue = value;
        bestAction = action;
    }
}</pre></div></li><li><p>Return the best action:</p><div class="informalexample"><pre class="programlisting">return bestAction;</pre></div></li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec154"></a>How it works...</h3></div></div></div><p>The <a id="id182" class="indexterm"></a>discontentment functions help avoid <a id="id183" class="indexterm"></a>unintended actions, depending on how much a goal's value changes, in terms of an action and the time it takes to be executed. Then, the function for choosing an action is taken care of by computing the most promising one in terms of the minimum impact (discontentment).</p></div></div>