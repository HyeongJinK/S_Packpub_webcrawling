<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch04lvl1sec19"></a>Creating a dynamic warning light effect</h2></div></div><hr /></div><p>The scene is currently lit by the directional light and emissive materials in the display and <code class="literal">planetscan</code> objects. Next, we will add a point light to the scene:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Create a new light using the <span class="strong"><strong>GameObject</strong></span> dropdown in the menu bar by navigating to <span class="strong"><strong>GameObject</strong></span> | <span class="strong"><strong>Light</strong></span> | <span class="strong"><strong>Point Light</strong></span>.</p><p>The new light's components will become visible in the <span class="strong"><strong>Inspector</strong></span>.</p></li><li><p>Rename the light <code class="literal">warning_light</code>.</p></li><li><p>Change the light's position by adjusting the values in the <span class="strong"><strong>Transform</strong></span> parameters near the top of the <span class="strong"><strong>Inspector</strong></span>. Set the <span class="strong"><strong>Position X</strong></span> value to <code class="literal">0.5</code>, the <span class="strong"><strong>Position Y</strong></span> value to <code class="literal">2.5</code>, and the <span class="strong"><strong>Position Z</strong></span> value to 0.</p><p>This will move the light to the top of the center of the spacecraft bridge scene, so it will illuminate the astronaut and her immediate environment.</p></li><li><p>In the <span class="strong"><strong>Light</strong></span> component parameters, set the <span class="strong"><strong>Intensity</strong></span> to <code class="literal">2.0</code>.</p></li><li><p>Set the <span class="strong"><strong>Range</strong></span> to <code class="literal">15</code>.</p></li><li><p>Click the <span class="strong"><strong>Color</strong></span> swatch and choose a bright red color using the color picker. The hex code <code class="literal">FF0000FF</code> will give you a full red value.</p></li><li><p>We will leave the <span class="strong"><strong>Baking</strong></span> set to <code class="literal">Realtime</code> and the <span class="strong"><strong>Shadow Type</strong></span> set to <code class="literal">No Shadows</code>.</p></li></ol></div><p>At the time of writing, Unity does not support real-time shadow casting for point lights, and we will be updating the light at runtime, so we cannot bake the light with the others:</p><p>
</p><div class="mediaobject"><img src="/graphics/9781783553679/graphics/image_04_002.jpg" /></div><p>
</p><p>As you add the light and update its parameters, you should see the Enlighten progress bar in the lower-right corner of the Unity interface as the light maps are rebaked.</p><p>Next, we will animate the light.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec24"></a>Animating the light</h3></div></div></div><p>In the spacecraft bridge scene, the warning light flashes to indicate danger during the spacecraft's entry of the planet's atmosphere. Unity's native animation workflow is ideal for simple effects like these:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Using the menu bar, open the <span class="strong"><strong>Animation</strong></span> panel by clicking on <span class="strong"><strong>Window </strong></span>and then selecting<span class="strong"><strong> Animation</strong></span>.</p><p>The <span class="strong"><strong>Animation</strong></span> panel is used to create and edit animation clips in Unity.</p><p>At the center of the panel, there is a message prompting us to create an animation clip and controller for the selected object.</p></li><li><p>Click on the <span class="strong"><strong>Create</strong></span> button.</p><p>A dialog will appear, allowing us to specify a location and name for the new animation.</p></li><li><p>Select the <code class="literal">PACKT_Animation</code> folder as the location.</p></li><li><p>Type <code class="literal">warning</code> as the animation name and click <span class="strong"><strong>Save</strong></span>.</p><p>Next, we need to select the properties of the light that we want to animate.</p></li><li><p>Click on the <span class="strong"><strong>Add Property</strong></span> button.</p></li><li><p>In the properties list that appears, click on the small arrow next to <span class="strong"><strong>Light</strong></span>.</p></li><li><p>Click on the <span class="strong"><strong>+</strong></span> sign next to <span class="strong"><strong>Intensity</strong></span> to add this property to the animation.</p><p>Start and end keyframes are added to the animation timeline. Both are set to the current intensity value. We need to set an intermediate key to see some variation in the <span class="strong"><strong>Scene</strong></span> view.</p></li><li><p>Drag the red line to the middle of the animation track to move the playhead.</p></li><li><p>Click on the diamond-shaped button near the left-hand top of the panel to add a keyframe at this point in the animation.</p></li><li><p>With the new keyframe still selected, locate the <span class="strong"><strong>Intensity</strong></span> value next to the property name.</p></li><li><p>Set the value to 0:</p><p>
</p><div class="mediaobject"><img src="/graphics/9781783553679/graphics/image_04_003.jpg" /></div><p>
</p><p>Now that we have created the animation, we can preview it in the <span class="strong"><strong>Scene</strong></span> by pressing the play button within the <span class="strong"><strong>Animation</strong></span> panel.</p></li><li><p>Click on the play button.</p><p>In the <span class="strong"><strong>Scene</strong></span> view, the light should flash on and off.</p></li><li><p>Click the play button again to exit the play mode.</p></li><li><p>Close the <span class="strong"><strong>Animation</strong></span> panel.</p><p>When we created the animation, a simple state machine was set up and added to the game object as an <span class="strong"><strong>Animator Controller</strong></span>.</p></li><li><p>Open the <span class="strong"><strong>Animator</strong></span> panel using the menu bar by clicking on <span class="strong"><strong>Window </strong></span>and then selecting<span class="strong"><strong> Animator</strong></span>.</p></li><li><p>In the <span class="strong"><strong>Hierarchy</strong></span> panel, click on the <code class="literal">warning_light</code> game object again if it has been deselected.</p></li><li><p>The object's state machine will become visible in the <span class="strong"><strong>Animator</strong></span> panel:</p><p>
</p><div class="mediaobject"><img src="/graphics/9781783553679/graphics/image_04_004.jpg" /></div><p>
</p></li></ol></div><p>The warning state, containing the animation that we created, becomes active when the scene starts.</p><p>We can add more states to the controller and more complexity to the animation later in the chapter.</p><p>In the next section, we will use an external <span class="strong"><strong>C#</strong></span> script to change shader properties within a material at runtime.</p></div></div>