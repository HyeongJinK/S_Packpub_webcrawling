<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch08lvl1sec37"></a>Adding a particle system</h2></div></div><hr /></div><p>We will start by creating a new particle system in the scene:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>In the menu bar, navigate to <span class="strong"><strong>Game Object</strong></span> | <span class="strong"><strong>Particle System</strong></span> to add this to the scene.</p></li><li><p>Rename the particle system <code class="literal">flameShoot</code>.</p></li><li><p>In the <span class="strong"><strong>Hierarchy</strong></span> panel, expand the <code class="literal">flamethrower</code> game object by clicking on the small arrow next to its name so its child, <code class="literal">muzzle</code>, becomes visible in the list.</p></li><li><p>Drag the new particle system onto the <code class="literal">muzzle</code> game object to parent it.</p></li><li><p>Click on <code class="literal">flameShoot</code> to view its components in the <span class="strong"><strong>Inspector</strong></span>.</p></li><li><p>Zero out the <span class="strong"><strong>Transform Position</strong></span> and <span class="strong"><strong>Rotation</strong></span> values to center the particle system to <code class="literal">muzzle</code>.</p></li><li><p>Reset all three <span class="strong"><strong>Transform Scale</strong></span> values to <code class="literal">1</code> so that the particle system does not inherit the parent's scale:</p><p>
</p><div class="mediaobject"><img src="/graphics/9781783553679/graphics/image_08_002.jpg" /><div class="caption">The default particle system scaled to the muzzle game object in the scene</div></div><p>
</p></li></ol></div><p>Currently, the particle system does not look much like a stream of fire. We will make some adjustments to the system next.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch08lvl2sec40"></a>Adjust the particle system parameters</h3></div></div></div><p>The default particle system is quite different from the stream of fire that we need for the flamethrower effect. In this section, we will go through the list of parameters and make changes to the particle system's behavior:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>In <span class="strong"><strong>Inspector</strong></span>, scroll down slightly until the parameters of the <span class="strong"><strong>Particle System</strong></span> component are visible.</p></li><li><p>Set the <span class="strong"><strong>Duration</strong></span> value to <code class="literal">2.5</code>.</p><p>This will make a shorter, more continuous particle loop.</p></li><li><p>Leave the <span class="strong"><strong>Looping</strong></span> checkbox checked and the <span class="strong"><strong>Prewarm</strong></span> checkbox unchecked.</p><p>Without <span class="strong"><strong>Looping</strong></span>, our particle effect will just play once; and with <span class="strong"><strong>Prewarm</strong></span>, it will be playing from the start without any input.</p></li><li><p>Leave <span class="strong"><strong>Start Delay</strong></span> set to 0 as we want this effect to be immediate.</p></li><li><p>Click on the small arrow to the right of <span class="strong"><strong>Start Lifetime</strong></span> and choose <span class="strong"><strong>Random Between Two Constants</strong></span> from the drop-down list.</p></li><li><p>Enter the number <code class="literal">4</code> in the first field and <code class="literal">5</code> in the second field to define the amount of variation.</p><p>This will create a little randomness in the duration of each particle.</p></li><li><p>Click on the small arrow to the right of <span class="strong"><strong>Start Speed</strong></span> and again choose <span class="strong"><strong>Random Between Two Constants</strong></span> from the drop-down list.</p></li><li><p>Enter the values <code class="literal">0.7</code> and <code class="literal">1.2</code> in the two fields respectively.</p></li><li><p>Set the <span class="strong"><strong>Start Size</strong></span> value down to <code class="literal">0.4</code>.</p><p>At this point, it should be much easier to see the particles in the scene.</p></li><li><p>Leave <span class="strong"><strong>3D Particle Rotation</strong></span> unchecked.</p><p>This checkbox will allow particles to rotate fully in three axes. Usually, we do not want to do this as their billboard geometry becomes quite apparent.</p><p>Instead, we will modify <span class="strong"><strong>Start Rotation</strong></span>.</p></li><li><p>Click on the small arrow to the right of <span class="strong"><strong>Start Rotation</strong></span> and choose <span class="strong"><strong>Random Between Two Constants</strong></span>.</p></li><li><p>Enter the values 0 and <code class="literal">360</code> in the two fields.</p><p>We will leave the remaining parameters in this group at their default values and skip to the <span class="strong"><strong>Emission</strong></span> group.</p></li><li><p>Set the <span class="strong"><strong>Rate</strong></span> value to <code class="literal">12</code>.</p></li><li><p>In the <span class="strong"><strong>Shape</strong></span> group, set <span class="strong"><strong>Angle</strong></span> to 0 and <span class="strong"><strong>Radius</strong></span> to <code class="literal">0.01</code>.</p><p>The <span class="strong"><strong>Cone</strong></span> emitter shape of the default particle system works well for the flamethrower effect, but here we will reduce the size of the emission area so that it is small enough to fit the nozzle of the flamethrower.</p></li><li><p>Click on the <span class="strong"><strong>Color over Lifetime</strong></span> checkbox, clicking the parameter's name will expand its settings again.</p></li><li><p>Click on the gradient bar to edit the gradient.</p></li><li><p>In the <span class="strong"><strong>Gradient Editor</strong></span>, create a new point about three-quarters of the way along the top of the gradient bar.</p></li><li><p>Click the marker and set <span class="strong"><strong>Location</strong></span> to <code class="literal">75%</code>.</p><p>By default, this point will have full opacity.</p></li><li><p>Click on the gradient bar, again three-quarters of the way along the bottom edge to create another marker.</p><p>By default, the point should be set to whiteâ€”RGB values all set to <code class="literal">255</code>.</p></li><li><p>Set <span class="strong"><strong>Location</strong></span> to <code class="literal">75%</code>.</p></li><li><p>Click on the end marker along the top edge of the gradient bar and set its <span class="strong"><strong>Alpha</strong></span> to zero by dragging the slider to the left:</p><p>
</p><div class="mediaobject"><img src="/graphics/9781783553679/graphics/image_08_003.jpg" /><div class="caption">The adjusted Color over Lifetime gradient</div></div><p>
</p><p>Each particle will now fade out near the end of its life to create a more convincing jet of flame.</p></li><li><p>Click on the <span class="strong"><strong>Size over Lifetime</strong></span> checkbox and then click on the collapsed bar to expand the additional parameters.</p></li><li><p>Click on the small arrow next to the value fields and choose <span class="strong"><strong>Curve</strong></span> from the drop-down list.</p></li><li><p>A colored line now becomes visible in the field.</p><p>We want our stream of flame particles to gradually increase in size after they are emitted. The line also becomes visible in the curve editor at the bottom of the <span class="strong"><strong>Inspector</strong></span>.</p></li><li><p>Move the first key slightly down to around <code class="literal">0.2</code>.</p></li><li><p>Adjust the tangents of both of the keys so that the resulting curve approximates the curve in the following image:</p><p>
</p><div class="mediaobject"><img src="/graphics/9781783553679/graphics/image_08_004.jpg" /><div class="caption">The completed Size over Lifetime curve</div></div><p>
</p><p>Previewing the particle system in the <span class="strong"><strong>Scene</strong></span> view should show the particles gradually becoming larger.</p></li><li><p>Check the <span class="strong"><strong>Rotation over Lifetime</strong></span> checkbox.</p></li><li><p>Click on the parameter to expand its settings.</p></li><li><p>Leave <span class="strong"><strong>Angular Velocity</strong></span> set to its default value of <code class="literal">45</code>.</p><p>This will allow the particles to rotate as they move.</p></li></ol></div><p>Currently, the particle system uses Unity's default particle material.</p><p>We can set up a unique material next.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch08lvl2sec41"></a>Setting up a new material for the particle system</h3></div></div></div><p>Setting up a new particle material will allow us to make a more convincing flamethrower effect:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>In the <span class="strong"><strong>Project</strong></span> panel, click on the <code class="literal">PACKT_Materials</code> folder to view its contents in the <span class="strong"><strong>Assets</strong></span> panel.</p></li><li><p>In an empty area of the <span class="strong"><strong>Assets</strong></span> panel, create a new material. Right-click and choose <span class="strong"><strong>Create</strong></span> | <span class="strong"><strong>Material</strong></span>.</p></li><li><p>Rename the new material <code class="literal">Flames</code>.</p></li><li><p>Click on the <code class="literal">Flames</code> material to view its properties in the <span class="strong"><strong>Inspector</strong></span>.</p></li><li><p>In the <span class="strong"><strong>Shader</strong></span> selection at the top of the <span class="strong"><strong>Inspector</strong></span>, navigate to <span class="strong"><strong>Particles</strong></span> | <span class="strong"><strong>Additive</strong></span> from the drop-down list.</p><p>The particle additive shader allows us to use a grayscale image to define the particle's shape and blend it with a tint color.</p></li><li><p>Drag the <code class="literal">Flames</code> material from the <span class="strong"><strong>Assets</strong></span> panel onto the <code class="literal">Particle System</code> in the <span class="strong"><strong>Inspector</strong></span> to use it.</p><p>We will finish <span class="emphasis"><em>adjust the material</em></span> properties now so that we can see the particle system in action.</p></li><li><p>Make sure that the <code class="literal">Flames</code> material is selected and click on the lock icon at the top of the <span class="strong"><strong>Inspector</strong></span> to keep the <span class="strong"><strong>Inspector</strong></span> focused on this item.</p></li><li><p>In the <span class="strong"><strong>Project</strong></span> panel, click on the <code class="literal">PACKT_Textures</code> folder to view its contents in the <span class="strong"><strong>Assets</strong></span> panel.</p></li><li><p>In the <span class="strong"><strong>Assets</strong></span> panel, click on the <code class="literal">Particles</code> subfolder.</p></li><li><p>Locate the <code class="literal">pFlame</code> asset and drag it to the <span class="strong"><strong>Particle Texture</strong></span> slot in the <span class="strong"><strong>Inspector</strong></span>.</p></li><li><p>Click on the <span class="strong"><strong>Tint Color</strong></span> swatch and choose a bright orange color.</p><p>You can use the <code class="literal">FF800040</code> hex code to define a full orange with a lower alpha channel to see slightly more transparency in the flame particles, as shown in the following image:</p><p>
</p><div class="mediaobject"><img src="/graphics/9781783553679/graphics/image_08_005.jpg" /><div class="caption">The modified flamethrower particle effect</div></div><p>
</p></li></ol></div></div></div>