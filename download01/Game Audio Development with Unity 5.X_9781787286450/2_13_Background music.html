<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="02lvl1sec18"></a>Background music</h2></div></div><hr /></div><p>In the last section of this chapter, we will <span>introduce</span> another layer of audio with background or theme music. This is an often overlooked layer that can really set the mood of the game or during the progression of a game. In later chapters of this book where we cover adaptive music we will get into detailed examples of altering music during gameplay. For now though, we are going to look at a simple use of scripting to set the looping behavior of some background music we want to use for our scene. Follow the instructions here to add background music to the scene:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Open up Unity to the <code class="literal">Viking Village</code> scene as we last left it. Create an empty <code class="literal">GameObject</code> in the scene and rename it <code class="literal">BackgroundMusic</code>.</li><li>Locate the <code class="literal">viking_music</code> audio clip in the <strong class="userinput"><code>Project</code></strong> window. Drag the clip onto the new <code class="literal">BackgroundMusic</code> object in the <strong class="userinput"><code>Hierarchy</code></strong> window. This will automatically add an audio source component with the audio clip set.</li><li>Locate the <code class="literal">MusicLooper</code> script in the <strong class="userinput"><code>Project</code></strong> window. Drag the script onto the <code class="literal">BackgroundMusic</code> object in the <strong class="userinput"><code>Hierarchy</code></strong> window. Set the properties of the <strong class="userinput"><code>Music Looper</code></strong> component to match those shown in the screenshot here:</li></ol></div><div class="mediaobject"><img src="/graphics/9781787286450/graphics/34f96fdf-c58e-44a5-97e6-5d940ef16cd1.png" /></div><p>Music Looper component settings
</p><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>Press play to start the scene. Let the scene run for at least a minute. Notice how the background music loops at roughly a minute. The <code class="literal">MusicLooper</code> script is used to extract sections from an audio file and play those over and over again. Press play again to stop the scene.</li><li>Open up the <code class="literal">MusicLooper</code> script in your script editor. As you can see the script is quite simple and the interesting section of code is shown here:</li></ol></div><pre class="programlisting">if (audioSource != null &amp;&amp; 
    audioSource.isPlaying &amp;&amp;  
    audioSource.time &gt; loopEndTime) 
{ 
    audioSource.time = loopStartTime; 
} </pre><div class="orderedlist"><ol class="orderedlist arabic" start="6" type="1"><li>This section of code, which is <span>run</span> in the <code class="literal">Update</code> method, checks every frame if the clip has played past the <code class="literal">loopEndTime</code>. If it has, the clip is reset back to the <code class="literal">loopStartTime</code>, which allows us to only play part of an audio clip.</li></ol></div><p>The last example was short but surely showed you an effective way of playing only a part of audio clip with scripting. In later chapters, we will use other tools that provide far more control over a how a clip is played.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip33"></a>Note</h3><p><strong class="userinput"><code>Quiz answers</code></strong></p><p><span class="strong"><strong>ax throwing sound</strong></span>: diegetic, as you would expect to hear the axe as at is thrown</p><p><span class="strong"><strong>Character grunt</strong></span>: non-diegetic, this is an off screen sound that adds tone or mood to the scene</p><p><span class="strong"><strong>ax colliding</strong></span>: diegetic, you would expect the axe to make noise when it hits objects in the scene</p><p>Remember the importance of using non-diegetic sounds or music in a scene.</p></div><p>That completes this chapter on scripting. If you did not complete all the examples in the chapter the completed <code class="literal">Viking Village</code> scene is provided in the book's downloaded source code.</p></div>