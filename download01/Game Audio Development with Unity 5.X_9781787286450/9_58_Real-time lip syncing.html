<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="09lvl1sec56"></a>Real-time lip syncing</h2></div></div><hr /></div><p>Before we get <span>into</span> the details of speech, phonemes, and animation, we will construct a simple example of how our previous work with developing audio visualizations can be easily applied to character lip syncing. Follow the instructions here to create a new project and set up the scene:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Open Unity and create a new project called <code class="literal">GameAudio_Vocals</code>. After the empty project initializes, select <code class="literal">Assets - Import Package - Custom Package</code> from the menu and use the file dialog to find the <code class="literal">Chapter_9_Assets</code> folder in the book's downloaded source code. Select the  in the folder and click on <strong class="userinput"><code>Open</code></strong> to import the assets.</li><li>Locate the  in the <strong class="userinput"><code>Project</code></strong> folder and double-click to open it. Connect a microphone if you need to and press play to run the scene. After the scene starts running, talk or make some noise and just confirm the colored cubes are moving as you expect. Your <strong class="userinput"><code>Game</code></strong> view should look similar to the following screenshot:
</li></ol></div><div class="mediaobject"><img src="/graphics/9781787286450/graphics/a4f808f9-9e92-48f1-bcdd-cd5f72f7dc19.png" /></div><p>Update audio visualization scene with microphone listener</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note148"></a>Note</h3><p>What you are looking at is the microphone listener example we looked at in the end of the last chapter. The difference is that the spectrum visualization cubes have been scaled down and moved to the side. This will allow us to see the audio spectrum as we expect, while we wire up our lip synced character. Again, if you have not read or reviewed, <a class="link" href="#" linkend="ch08">Chapter 8</a>, <span class="emphasis"><em>Visualizing Audio in Games</em></span>, be sure to do so before continuing this chapter.</p></div><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>When you are done testing the scene, stop the scene.
</li></ol></div><p> </p><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>From the menu, select <strong class="userinput"><code>Window</code></strong> | <strong class="userinput"><code>Asset Store</code></strong>. After the <strong class="userinput"><code>Asset Store</code></strong> window page loads, type <code class="literal">reallusion iclone</code> into the search bar and hit <span class="emphasis"><em>Enter.</em></span> This will yield you a search <span>with</span> a choice of three iClone characters plus some other assets as shown in the following screenshot:</li></ol></div><div class="mediaobject"><img src="/graphics/9781787286450/graphics/50cdc690-fb18-4ce3-8f8d-75e87f89efb8.png" /></div><p>Asset Store search for iClone characters</p><div class="orderedlist"><ol class="orderedlist arabic" start="5" type="1"><li>Select one of the iClone characters (<span class="emphasis"><em><span class="underline">Izzy</span></em></span>, <span class="emphasis"><em>Max</em></span>, or <span class="emphasis"><em>Winston</em></span>), and then download and import the asset into the project. Any of the characters will work, but the examples we will use in the book will be based on the <span class="emphasis"><em>Izzy</em></span> character. Note that unlike other 3D character assets, the iClone characters are not shown fully nude. However, some readers may still find the <span class="emphasis"><em>Izzy</em></span> or <span class="emphasis"><em>Max</em></span> character offensive. For those readers, it is strongly suggested they use the Winston character instead.
The iClone characters from Reallusion are for demonstration purposes but also are an excellent asset source for prototyping. Unlike many other free character assets on the store, they are lightweight and work well on any platform. If you want to create your own iClone characters, you will need to use the <span>Reallusion</span> character creator platform. There is a free trial available at <a class="ulink" href="https://www.reallusion.com/iclone/game/" target="_blank">https://www.reallusion.com/iclone/game/</a> if you want to test the product.
</li></ol></div><p> </p><div class="orderedlist"><ol class="orderedlist arabic" start="6" type="1"><li>After the iClone character is imported, open the assets <code class="literal">{name]/prefab</code> folder in the <strong class="userinput"><code>Project</code></strong> window, where the name is saved as the name of the character you downloaded. Inside the folder, you will see a prefab with the same name. Drag this prefab into the scene as shown in the screenshot here:</li></ol></div><div class="mediaobject"><img src="/graphics/9781787286450/graphics/cf8eb9b7-6a4b-4117-bb02-5621483be151.png" /></div><p>Dragging and placing iClone character prefab into scene</p><div class="orderedlist"><ol class="orderedlist arabic" start="7" type="1"><li>After you drag the prefab in, you will also <span>need</span> to reset the <strong class="userinput"><code>Transform</code></strong><strong class="userinput"><code>Position</code></strong> to <code class="literal">0</code>, <code class="literal">0</code>, <code class="literal">0</code> as shown in the preceding screenshot.
</li></ol></div><p> </p><div class="orderedlist"><ol class="orderedlist arabic" start="8" type="1"><li>Expand the character's object hierarchy in the <strong class="userinput"><code>Hierarchy</code></strong> window until you can select the <strong class="userinput"><code>RL-G6_JawRoot</code></strong> object as shown in the screenshot here:</li></ol></div><div class="mediaobject"><img src="/graphics/9781787286450/graphics/a826b026-5208-49c2-9eb6-285b329e2882.png" /></div><p>Expanding the characters transform bone hierarchy
</p><p>You could also search for the <span>object</span> in the <strong class="userinput"><code>Hierarchy</code></strong> window but be sure to clear the search after the object is done, so you can see the expansion as shown in the screenshot.</p><div class="orderedlist"><ol class="orderedlist arabic" start="9" type="1"><li>Then in the <strong class="userinput"><code>Inspector</code></strong> window, use the <strong class="userinput"><code>Add Component</code></strong> to add a <strong class="userinput"><code>Visual Transformer</code></strong> component and set the parameters to the values shown in the following screenshot:</li></ol></div><div class="mediaobject"><img src="/graphics/9781787286450/graphics/83f79c6f-92ed-4fbb-a914-a9d9ea2a59fd.png" /></div><p>Setting the RL_G6_JawRoot parameters of the Visual Transformer
</p><p>The <code class="literal">VisualTransformer</code> is a more generic and extended version of the <code class="literal">VisualScaler</code> script that was developed in the last chapter.</p><div class="orderedlist"><ol class="orderedlist arabic" start="10" type="1"><li>Save the scene as <code class="literal">Chapter_9_LipSync</code> and then press play. Make a noise and talk; notice now that along with the cubes, the character's mouth now moves with the sound. Here is a screenshot showing an example of this:</li></ol></div><div class="mediaobject"><img src="/graphics/9781787286450/graphics/c506d554-c79d-4e97-ba46-cd2f1ae2d796.png" /></div><p>Real-time very simplified character lip syncing in action</p><div class="orderedlist"><ol class="orderedlist arabic" start="11" type="1"><li>When you are done testing, stop the scene and save the project.</li></ol></div><p>What we just quickly developed here is an example of a very simple character lip sync in real time. While this may seem simple, considering what you have learned, this is just a demonstration of some powerful possibilities. Of course, our character's current lip syncing is nothing more than a ventriloquist dummy. However, as we will start to see in the next section, we really aren't that far away from producing some realistic results.</p></div>