<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="04lvl1sec30"></a>Dynamic music mixing</h2></div></div><hr /></div><p>One of the truly <span>powerful</span> features of having your own DAW (digital audio workstation) right in Unity is the ability it provides for dynamic content mixing. Of course, we have already looked at some interesting ways to dynamically mix audio through environmental zones at runtime, but how about being able to create your own music mix within Unity? Being able to create your own music mix could certainly play into a number of interesting features, including adaptive music. We will forgo the discussion of adaptive audio until the next chapter; for now, let's dive in and create our music mix by following the instructions here:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Open up the Unity editor and, from the menu, select <strong class="userinput"><code>File</code></strong> | <strong class="userinput"><code>New Scene</code></strong>. Save your current scene if you are asked to do so.</li></ol></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note71"></a>Note</h3><p>As always, the exercises in the last section of each chapter will work very quickly and assume you have been following the exercises in the chapter. If you have trouble following the exercise, work hands-on through some of the earlier exercises.</p></div><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>From the menu, select <strong class="userinput"><code>GameObject</code></strong> | <strong class="userinput"><code>Create Empty</code></strong>. Rename the new object <code class="literal">Instruments</code> and reset the <strong class="userinput"><code>Transform</code></strong><strong class="userinput"><code>position</code></strong> to <strong class="userinput"><code>0</code></strong>.</li><li>Right-click (<span class="emphasis"><em>Ctrl</em></span> + click on Mac) on the new game object in the <strong class="userinput"><code>Hierarchy</code></strong> window, and from the context menu, select <strong class="userinput"><code>Create Empty</code></strong>. Rename the new object <code class="literal">Fiddle</code>. Add an Audio Source component to the object and set its <strong class="userinput"><code>AudioClip</code></strong> to <code class="literal">fiddle</code> and check the <strong class="userinput"><code>Play on Awake</code></strong> and <strong class="userinput"><code>Loop</code></strong> settings as shown in the screenshot:</li></ol></div><div class="mediaobject"><img src="/graphics/9781787286450/graphics/4eff6c3b-7685-40aa-b10c-fcc801be1b37.png" /></div><p>Fiddle Audio Source component settings
</p><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>Select the <code class="literal">Fiddle</code> game object in the <strong class="userinput"><code>Hierarchy</code></strong> window and press <span class="strong"><strong>Ctrl+D</strong></span> to duplicate the object. Rename the object <code class="literal">Tribe_Drum</code>. In the <strong class="userinput"><code>Inspector</code></strong> window, set the <strong class="userinput"><code>AudioClip</code></strong> for the new object to <code class="literal">tribe_drum</code>.</li><li>Repeat step 4 for two new objects called Celtic_Flute and Beat. Set the <strong class="userinput"><code>Audio Source</code></strong><strong class="userinput"><code>AudioClip</code></strong> slots on each of those components to match their respective names: <code class="literal">celtic_flute</code> and <code class="literal">beat</code>.</li><li>Press play to run the scene. Obviously, the sound is far less than harmonious, and if anything, it verges on the horrendous. Stop the scene and save your changes.</li></ol></div><p>Well obviously throwing a bunch of <span>clips</span> together certainly isn't going to create any music mastery. How about we see what the Audio Mixer can make of this? Follow the instructions here to create a new <code class="literal">MusicMix</code> mixer:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Open up the editor to the <strong class="userinput"><code>Audio Mixer</code></strong> window and click on the <strong class="userinput"><code>+</code></strong> icon beside the <strong class="userinput"><code>Mixers</code></strong> to create a new mixer. Rename this mixer <code class="literal">MusicMix</code>. Select the new <code class="literal">MusicMix</code> mixer.</li><li>Click on the <strong class="userinput"><code>+</code></strong> icon beside the <strong class="userinput"><code>Groups</code></strong> list to create a new mixing group. Rename this new group <code class="literal">fiddle</code>.</li><li>Repeat step 2 for the other instruments: <strong class="userinput"><code>tribe_drum</code></strong>, <strong class="userinput"><code>celtic_flute</code></strong><span class="strong"><strong>,</strong></span> and <strong class="userinput"><code>beat</code></strong>. Your mixer window should match the screenshot here:</li></ol></div><div class="mediaobject"><img src="/graphics/9781787286450/graphics/c3a5f8c0-aaa7-455d-9f9f-9a052769943d.png" /></div><p>MusicMix groups</p><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>In the <strong class="userinput"><code>Hierarchy</code></strong> window, select the <code class="literal">Fiddle</code> object, and then in the <strong class="userinput"><code>Inspector</code></strong> window, set the <strong class="userinput"><code>Output</code></strong> slot of the <strong class="userinput"><code>Audio Source</code></strong> component to the <strong class="userinput"><code>MusicMix</code></strong> | <strong class="userinput"><code>fiddle</code></strong> mixer group as shown in the screenshot here:</li></ol></div><div class="mediaobject"><img src="/graphics/9781787286450/graphics/eacaebcd-aa09-44dc-b3ce-62f33e98e54f.png" /></div><p>Setting the Output setting on the Fiddle Audio Source</p><div class="orderedlist"><ol class="orderedlist arabic" start="5" type="1"><li>Again, repeat the process for the other instrumentals: <strong class="userinput"><code>tribe_drum</code></strong>, <strong class="userinput"><code>celtic_flute</code></strong>, and <strong class="userinput"><code>beat</code></strong>. Match up the <strong class="userinput"><code>Output</code></strong> setting to their respective Audio Mixer group.</li><li>Next, one of the fundamental problems our various instrumental clips have is they are all playing at different beats per minute (or BPM). What we need to do, therefore, is align all our tracks to play at the same BPM. We can do that by simply adjusting the pitch of the audio in that mixer group. The following is a table of the pitch adjustments we need to make to each of our groups in order to bring all the audio to 100 BPM:</li></ol></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note72"></a>Note</h3><p>The BPM of each clip was determined by using BPM Counter from <a class="ulink" href="http://www.abyssmedia.com" target="_blank">http://www.abyssmedia.com,</a> and then the pitch adjustment was calculated by using the following formula:</p><p>pitch% = desired BPM / actual BPM * 100</p><p>Example for fiddle adjusted to 100 PBM:
pitch% = 100 / 140 * 100 = .714 * 100 = 71%</p></div><div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; "><colgroup><col /><col /><col /></colgroup><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>Instrument</strong></span></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>Current BPM</strong></span></p></td><td style="border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>Pitch Adjustment</strong></span></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>fiddle</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>140</p></td><td style="border-bottom: 0.5pt solid ; "><p>71%</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>tribe_drum</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>120</p></td><td style="border-bottom: 0.5pt solid ; "><p>83%</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>celtic_flute</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>137</p></td><td style="border-bottom: 0.5pt solid ; "><p>73%</p></td></tr><tr><td style="border-right: 0.5pt solid ; "><p>beat</p></td><td style="border-right: 0.5pt solid ; "><p>120</p></td><td style=""><p>83</p></td></tr></tbody></table></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip73"></a>Note</h3><p>Adjusting the pitch of an audio clip is the equivalent of slowing it down or lowering the pitch, to speeding it up and increasing the pitch. There are a number of free tools available to help you determine the BPM of an audio clip. Just do a search for <code class="literal">bpm counter</code> in your favorite search engine.</p></div><div class="orderedlist"><ol class="orderedlist arabic" start="7" type="1"><li>Select the mixer group you want to adjust the pitch on, and then at the top of the <strong class="userinput"><code>Inspector</code></strong> window, you will see a setting. Enter the pitch <span>setting</span> that matches the table for each of the mixer groups.</li><li>When you are done setting the pitch, run the scene again. This time notice how the instruments are harmonious now and the music is starting to sound like something. After you are done listening, stop the scene and save your changes.</li></ol></div><p>Well those slight changes made a huge impact, but obviously there is more to do. At this point, most of the editing is really up to you on how to blend the instrumentals together into a sound you like. However, also keep in mind that now you could create any number of dynamic music blends controlled by snapshots or other exposed parameters.</p><p>Follow the suggestions here to add some useful effects and controls in order to balance your music mix better:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>For each of the music groups, go ahead and add a <strong class="userinput"><code>ParamEQ</code></strong> effect. Do this by clicking on the <strong class="userinput"><code>Add</code></strong> button at the bottom of the group and then selecting <strong class="userinput"><code>ParamEQ</code></strong> from the context menu.</li><li>Press the play button to run the scene and then click on the <strong class="userinput"><code>Edit in Play Mode</code></strong> button. After the scene starts running, try adjusting the mix to match the settings shown in the combined screenshot here:</li></ol></div><div class="mediaobject"><img src="/graphics/9781787286450/graphics/4d41f7e3-b017-4333-bf6c-0dcdab3ee36a.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>Again, that mix is just one way of combining those instruments. You could also add other effects to the various mixer groups. Try creating two-three different mixes you are happy with and save them as snapshots.</li><li>When you are done editing and mixing, stop the scene and save your scene and project.</li></ol></div><p>Being able to mix your <span>own</span> music like this right within Unity provides for several possibilities. In the next chapter, we are going to put this concept into practice and even extend it further.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip74"></a>Note</h3><p><strong class="userinput"><code>QUIZ TIME ANSWERS</code></strong><span>Here are the answers for the short quiz we asked at the end of the last section. See how well you did.</span><span class="strong"><strong>Wind</strong></span>: If you can see it blowing objects, it is diegetic; otherwise, it is non-diegetic<span class="emphasis"><em></em></span><span class="strong"><strong>Lake shore waves</strong></span>: If you can see the waves, it is diegetic; otherwise, it is non-diegetic<span class="emphasis"><em></em></span><span class="strong"><strong>Music</strong></span>: If you can see musicians playing, it is diegetic; otherwise, it is non-diegetic.
All these sounds could be either diegetic or non-diegetic, so it was a bit of a trick question. Remember, if the sound matches some onscreen or in-game activity, it is classified as diegetic. Sounds made off-screen or to enhance mood, atmosphere, or theme are non-diegetic.</p></div></div>