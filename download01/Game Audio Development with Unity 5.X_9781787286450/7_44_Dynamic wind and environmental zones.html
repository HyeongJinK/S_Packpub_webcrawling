<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="07lvl1sec44"></a>Dynamic wind and environmental zones</h2></div></div><hr /></div><p>In the previous chapter, we quickly touched on how to implement a simple audio zone with <span>FMOD</span> and no scripting. For completeness and practicality, we are going to revise the Environmental Zones example we created in <a class="link" href="#" linkend="ch04">Chapter 4</a>, <span class="emphasis"><em>Advanced Audio Mixing</em></span>, using FMOD, but this time <span>without</span> any scripting. This example will demonstrate the full capabilities of snapshots within FMOD.</p><p>In this chapter, we will <span>start</span> fresh with just the basic Viking Village and add the other project assets as needed. If you have not already done so, be sure to download the required assets <span>from</span> the Unity Asset Store and the book's source code from here. Be sure to refer back to <a class="link" href="#" linkend="ch06">Chapter 6</a>, <span class="emphasis"><em>Introduction to FMOD</em></span>, for instructions on how to install the village project and FMOD if you need to.</p><p>Open up Unity and follow the instructions, to get started:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>If you are continuing from the previous chapter, open up the <strong class="userinput"><code>GameAudio</code></strong> project we created. For those of you just getting here, create a new Unity project called <code class="literal">GameAudio</code> and then import the Unity Viking Village project from the Asset Store.</li><li>From the menu, select <strong class="userinput"><code>Assets</code></strong> | <strong class="userinput"><code>Import Package</code></strong> | <strong class="userinput"><code>Custom Package</code></strong> and use the Import package dialog to locate and open the <code class="literal">Chapter_7_Assets</code> folder located in the book's downloaded source code. Import the <strong class="userinput"><code>Chapter_7_Start.unitypackage</code></strong> by selecting the file and clicking on the <strong class="userinput"><code>Open</code></strong> button. Follow the instructions to import the asset as you normally would.</li><li>Locate the <code class="literal">Chapter_7_Start.scene</code> file in the <code class="literal">Assets/GameAudio/Scenes</code> folder of the <strong class="userinput"><code>Project</code></strong> window and double-click to open it.</li><li>For the next step, you will need to manually copy the FMOD project folder from the book's downloaded source code into the Unity project folder. Before proceeding, make sure that FMOD Studio is closed. Use your computer's file explorer to locate and open the <code class="literal">Chapter_7_FMOD</code> folder found in the book's source code folder. Copy the FMOD project folder called <code class="literal">GameAudio_FMOD</code> by any means you prefer.
</li></ol></div><p>Â </p><div class="orderedlist"><ol class="orderedlist arabic" start="5" type="1"><li>Again, use your computer's file explorer to locate and open the <code class="literal">GameAudio</code> Unity project folder. Paste the <code class="literal">GameAudio_FMOD</code> folder into the <code class="literal">GameAudio</code> folder so it looks similar to the following screenshot:</li></ol></div><div class="mediaobject"><img src="/graphics/9781787286450/graphics/6155c844-5dd2-4704-aa12-467463a7ab11.png" /></div><p>Copying the GameAudio_FMOD project folder to the Unity project folder</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip111"></a>Note</h3><p>You may be prompted to confirm overwriting existing files. Be sure to accept and overwrite the files from last chapter. If you are blocked from copying over FMOD files, be sure that all instances of FMOD Studio are closed.</p></div><div class="orderedlist"><ol class="orderedlist arabic" start="6" type="1"><li>Open the Unity editor and from the menu, select <strong class="userinput"><code>FMOD</code></strong> | <strong class="userinput"><code>Edit Settings</code></strong>. Go to the <strong class="userinput"><code>Inspector</code></strong> window and confirm that the <strong class="userinput"><code>Studio Project Path</code></strong> is still set <span>correctly</span> from the last <span>chapter</span> or set it using the <strong class="userinput"><code>Browse</code></strong> button as shown in the screenshot here:</li></ol></div><div class="mediaobject"><img src="/graphics/9781787286450/graphics/e82aa573-560c-4082-8944-fe86f6799aef.png" /></div><p>Confirming the Studio Project Path is set correctly</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note112"></a>Note</h3><p>If you don't see the FMOD menu option, you will need to return to <a class="link" href="#" linkend="ch06">Chapter 6</a>, <span class="emphasis"><em>Introduction to FMOD</em></span>, to download and install the FMOD Unity integration package.</p></div><div class="orderedlist"><ol class="orderedlist arabic" start="7" type="1"><li>Launch FMOD Studio and <span>from</span> the menu select <strong class="userinput"><code>File</code></strong> | <strong class="userinput"><code>Open Recent</code></strong> | <strong class="userinput"><code>GameAudio_FMOD.fspro</code></strong> | <strong class="userinput"><code>GameAudio</code></strong> to open the project. If you have never launched Studio <span>before</span> or have it installed, return to the previous chapter and follow the instructions to download, install, and setup FMOD Studio.</li><li>From the menu, select <strong class="userinput"><code>File</code></strong> | <strong class="userinput"><code>Build</code></strong>. This will make sure the streaming assets folder is updated within the Unity project.</li><li>Return to the Unity editor and press play to run the scene. Move around the scene and you should hear the torches flickering and the sound of the lake waves. After you confirm things are working correctly, stop the scene.</li><li>Locate the <strong class="userinput"><code>EnvironmentalZones</code></strong> prefab in the <strong class="userinput"><code>Project</code></strong> window and drag and drop it into the scene. This will add the <strong class="userinput"><code>EnvironmentalZones</code></strong> locations we used previously but the scripts have been removed. Expand the object and just review the zones as shown in the screenshot here:</li></ol></div><div class="mediaobject"><img src="/graphics/9781787286450/graphics/bbc53a9c-c29e-47cf-bcab-77db412712af.png" /></div><p>EnvironmentalZones object expanded showing the various zones around the scene</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note113"></a>Note</h3><p>If you recall from the previous example, each of the zones was classified by type as summarized here:<span class="strong"><strong>Exposed</strong></span>: The areas that are exposed to the wind and out in the open, minimal reflections, and additional wind.<span class="strong"><strong>Crossroads</strong></span>: The junctions of the pathways; these areas are not as windy and provide almost no reflections.<span class="strong"><strong>Sheltered</strong></span>: The areas covered from the wind and close to buildings, maximum reflections and minimal wind.<span class="strong"><strong>Fringe</strong></span>: Just on the wall side of the village, partially covered, still some wind and audio reflections.</p></div><p>Now that we have a fresh scene in Unity and the base FMOD project open, we can continue by creating blending snapshots that our environmental zones will use to mix audio across the scene.</p><p>Remember, this is the exact same concept we worked with previously using snapshots and mixer transitions with the Unity Audio Mixer. With FMOD though, we will be able to generate the same effect but without scripting. Open up the FMOD Studio and follow the instructions:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>From the menu, select <strong class="userinput"><code>Window</code></strong> | <strong class="userinput"><code>Mixer</code></strong> to open the <strong class="userinput"><code>Mixer</code></strong> window. Click on the <strong class="userinput"><code>Snapshots</code></strong> tab in the window to open the tab.</li><li>Right-click [<span class="emphasis"><em>Ctrl</em></span> + click on Mac] on the <strong class="userinput"><code>Snapshots</code></strong> tab, and from the menu, select <strong class="userinput"><code>New Blending Snapshot</code></strong>. Rename the new snapshot <code class="literal">crossroads</code> and then select it. Since the <code class="literal">crossroads</code> represents an area of high wind but low reverb, adjust the mix to what is shown in the screenshot here:</li></ol></div><div class="mediaobject"><img src="/graphics/9781787286450/graphics/a8a5fd25-5c43-4417-bdaa-d5540aa87c8b.png" /></div><p>Setting the crossroads blending snapshot</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip114"></a>Note</h3><p>The settings don't have to be exact, after all you are ultimately in control and can decide what works best for you.</p></div><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>Repeat step 2 for <span>the</span> sheltered, fringe, and <span>exposed</span> snapshots. The <span>mixer</span> settings are shown in the <span>screenshots</span> here:</li></ol></div><div class="mediaobject"><img src="/graphics/9781787286450/graphics/e0f5804b-9d20-4f9e-8f64-bd81fdcd8f47.png" /></div><p>Adjusting the mixer settings for each of the snapshot zones</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note115"></a>Note</h3><p>After you have the four blending snapshots created, we then need to configure how the snapshots will be blended. If you recall from our previous example, we controlled the blending using a simple linear distance function written in a script. We are going to do something similar with FMOD, but without the need for scripting.</p></div><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>Select the <strong class="userinput"><code>crossroads</code></strong> snapshot and then click on the tracks button at the top of editing window to expose the tracks, as shown in the screenshot here:</li></ol></div><div class="mediaobject"><img src="/graphics/9781787286450/graphics/38399536-8b53-438b-963b-b22bfbbb1b34.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="5" type="1"><li>Click on the <strong class="userinput"><code>+</code></strong> button beside the <strong class="userinput"><code>Timeline</code></strong> at the tracks view, and from the menu, select <strong class="userinput"><code>Add Built-In Parameter</code></strong> | <strong class="userinput"><code>Distance</code></strong>. When prompted by the Parameter dialog, enter a range of 0 to 20.</li><li>Select the <strong class="userinput"><code>Master</code></strong> track and <span>then</span> go to the bottom right <span>corner</span> of the mixer <span>window</span> in the deck area. Right-click [<span class="emphasis"><em>Ctrl</em></span> + click on Mac] on the <strong class="userinput"><code>Intensity</code></strong> dial, and <span>from</span> the menu, select <strong class="userinput"><code>Add Automation</code></strong>, as shown in the screenshot:</li></ol></div><div class="mediaobject"><img src="/graphics/9781787286450/graphics/ec306c87-60a5-41ef-9de2-1e34df6cb305.png" /></div><p>Adding Intensity automation to the snapshot</p><div class="orderedlist"><ol class="orderedlist arabic" start="7" type="1"><li>This will add an <code class="literal">Intensity</code> track to the <strong class="userinput"><code>Tracks</code></strong> view. Use your mouse to adjust the line so that it starts at 100 at 0 distance and goes to 0 at 20 distance. This is shown in the screenshot here:</li></ol></div><div class="mediaobject"><img src="/graphics/9781787286450/graphics/6e44c6ed-fa6a-4475-b63a-0069aeb7121d.png" /></div><p>Adjusting the Intensity over distance</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note116"></a>Note</h3><p>Adjusting the Intensity in this manner allows you to set how snapshot will be blended. For this example, we are using a simple linear slope, but you could adjust the line into a curve, based on your needs. Just click anywhere along to add new control points to the line and move those as desired. We have chosen a maximum range of <span class="strong"><strong>20</strong></span> for this example but that could also be changed as well.</p></div><div class="orderedlist"><ol class="orderedlist arabic" start="8" type="1"><li>Repeat steps 4-7 for the remaining 3 snapshots (sheltered, fringe, and exposed). Be sure to keep the same distance range and linear control curves, at least for now. When you are done, build and save the project.</li></ol></div><p>Now that we have all the <span>mixer</span> snapshots configured and the <span>blending</span> parameters set, its time to integrate this into Unity. Open up the Unity editor to the scene as we last left it and follow the directions here:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Select the <strong class="userinput"><code>EnvironmentalZones</code></strong> object in the <strong class="userinput"><code>Hierarchy</code></strong> window, and then in the <strong class="userinput"><code>Inspector</code></strong> window, click on the <strong class="userinput"><code>Add Component</code></strong> button. Locate the <strong class="userinput"><code>FMOD Studio Event Emitter</code></strong> component and add it to the object. Set the component properties to match those in the following screenshot:</li></ol></div><div class="mediaobject"><img src="/graphics/9781787286450/graphics/906b95d2-420a-443b-8cd4-947c30dfd914.png" /></div><p>Adding the wind event to the EnvironmentalZones object</p><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Next, select (<span class="emphasis"><em>shif</em></span>t or C<span class="emphasis"><em>trl</em></span> select) all the object zones beneath the <strong class="userinput"><code>EnvironmentalZones</code></strong> object in the <strong class="userinput"><code>Hierarchy</code></strong> window. With all the objects selected, add an <strong class="userinput"><code>FMOD Studio Event Emitter</code></strong> component just as you did in step 1.</li><li>Group select just the <strong class="userinput"><code>Zone_Exposed</code></strong> objects (2 objects) and set the <strong class="userinput"><code>Studio Event Emitter</code></strong> component parameters to match the screenshot here:</li></ol></div><div class="mediaobject"><img src="/graphics/9781787286450/graphics/897870d1-0bb0-4d34-8a48-d95e059ec8b8.png" /></div><p>Setting the Zone_Exposed object to use the exposed snapshot</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note117"></a>Note</h3><p>Notice that we are setting the Event to a snapshot called exposed. Make sure that you open the snapshot group and not the event group when locating the event using the search tool.</p></div><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>Repeat step 3 for each of the other zone groups (sheltered, crossroads, and fringe). Making sure to set the zone groups Event to the respective snapshot that we previously configured in the Mixer.
</li><li>After you are done setting the snapshots for each of the respective zones, press play to start the scene. Move around the scene, as you have done plenty of times previously. Notice how well the zones blend together as you move through the areas. When you are done testing, stop the scene and save your Unity and FMOD projects.</li></ol></div><p>As we have seen, we are able to duplicate the same effect as one of our more complex examples without writing a single line of script. What's more impressive is the number of additional options we have available now to change the way the blending occurs. Even being able to go so far as to change the way the distance or other parameters control the blending intensity. Now, having said all that, there still will be times when you still need to control a parameter directly through scripting, and that is what we will cover in the next section.</p></div>