<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="07lvl1sec48"></a>Transition timelines and stingers</h2></div></div><hr /></div><p>Thus far, our adaptive music works well for a simple <span>horizontal</span> re-sequenced linear progression of music. Of course, we would never expect our players to progress through a level like that unless our game mechanics required that, which they don't. Fortunately, FMOD is able to <span>support</span> several adaptive music techniques from horizontal re-sequencing to vertical remixing and will even allow the combination of techniques as well. As we progress through this section, we will try to identify each of the techniques in use and some alternative options as well.</p><p>Right now our music is an example of the <span class="strong"><strong>horizontal re-sequencing</strong></span> technique called <span class="strong"><strong>phrase branching,</strong></span> but unfortunately the transitions are only one way. Let's fix that by <span>adding</span> reverse transitions to our music <span>event</span> by following the directions given here:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Open the <strong class="userinput"><code>Event Editor</code></strong> and make sure the music event is up and ready. Right-click [<span class="emphasis"><em>Ctrl</em></span> + click on Mac] on the region marker area and from the menu select <strong class="userinput"><code>Add Marker</code></strong>. Rename the marker <code class="literal">Level 1</code> and then drag it onto the start of the first loop region. Do this for all the other music level loop regions, as shown in the screenshot:</li></ol></div><div class="mediaobject"><img src="/graphics/9781787286450/graphics/0ba6e892-e932-4414-9258-72b8f1596e66.png" /></div><p>Adding and positioning the level markers</p><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Right-click [<span class="emphasis"><em>Ctrl</em></span> + click on Mac] beside the level looping region, and from the menu, select <strong class="userinput"><code>Add Transition To</code></strong> | <strong class="userinput"><code>Level 1</code></strong>. This will add a bright green transition marker with an arrow. Move the marker to the end of the <code class="literal">Level 2</code> looping area but at the same level as the <code class="literal">Level 1</code> looping region, as shown in the following screenshot:</li></ol></div><div class="mediaobject"><img src="/graphics/9781787286450/graphics/cbaf3c7b-c764-4268-8e3e-e8afa3b03859.png" /></div><p>Setting the Transition marker to the end of Level 2 loop region
</p><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>Select the marker and click on the <strong class="userinput"><code>Add Condition</code></strong> button in the <strong class="userinput"><code>Conditions</code></strong> area at the bottom of the window. From the menu, select <strong class="userinput"><code><strong class="userinput"><code>Add Parameter Condition</code></strong></code></strong> | <strong class="userinput"><code>Adaptive Level</code></strong>. Then, set the range to be from 1 - 1.5, just as you did for the looping condition.</li><li>Right-click [<span class="emphasis"><em>Ctrl</em></span> + click on Mac] on the transition, and from the menu, select <strong class="userinput"><code>Copy</code></strong>. Right-click [<span class="emphasis"><em>Ctrl</em></span> + Click on Mac] above the <code class="literal">Level 3</code> loop and select <strong class="userinput"><code>Paste</code></strong>. This will add another transition marker at the end of the loop. Paste two more times so that there are transitions above the <code class="literal">Level 4</code> and <code class="literal">Level 5</code> loops as well.</li><li>Repeat steps 2-5 for each of the other music levels making sure to set the transition condition to the correct range. At the end of all of this work, your screen should resemble the following screenshot:</li></ol></div><div class="mediaobject"><img src="/graphics/9781787286450/graphics/761fb0fb-3108-42ad-888c-5860bf13a815.png" /></div><p>The completed view of the transition markers set for each music level</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note130"></a>Note</h3><p>Just use copy/paste to speed up the task. The critical part is to just be sure that the conditions for each of the markers is appropriate to its level.</p></div><div class="orderedlist"><ol class="orderedlist arabic" start="6" type="1"><li>After you are done, <span>save</span> and build the project. Return to Unity and run the scene by pressing play. Move around the scene and you will notice the music transition back and forth better now. Of course it is not perfect and that is what we will work on next. Stop the scene when you are done testing.</li></ol></div><p>Moving through the level now should give you some appreciation of the <span>amount</span> of time it takes to move between areas. This was one of the defining characteristics in determining how long to make the looped sections, at least when using the <span class="strong"><strong>phrase branching</strong></span> technique. A better technique for us would be to use what's called <span class="strong"><strong>musical demarcation branching</strong></span>. This type of <span>adaptive</span> music technique allows us to transition at the next bar or measure and is <span>really</span> powerful. Let's see how this works by converting our current setup to use musical demarcation branching by following the exercise given here:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Open the <strong class="userinput"><code>Event Editor</code></strong> and select the <strong class="userinput"><code>wind</code></strong> event. Select the first transition marker we put down in the last exercise and delete it; do this for all the other music level transition markers as well. Right-click [<span class="emphasis"><em>Ctrl</em></span> + click on Mac] on the marker region, and from the menu, select <strong class="userinput"><code>Add Transition Region To</code></strong> | <strong class="userinput"><code>Level 1</code></strong>. Then, select the new region and refer to the <strong class="userinput"><code>Conditions</code></strong> area at the bottom of the window. Add a new <code class="literal">Adaptive_Level</code> condition and set the <strong class="userinput"><code>Quantization</code></strong> settings to match those shown in the following screenshot:</li></ol></div><div class="mediaobject"><img src="/graphics/9781787286450/graphics/b8ce7d56-ebd8-49b8-b4d8-cbfc919c63af.png" /></div><p>Setting the condition and quantization settings for the new transition region</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note131"></a>Note</h3><p>In this case we are using a musical bar to denote the transition timing, which is fine for our needs. If you are unsure about musical notation of notes and measures not to worry, we will cover some of that theory in <a class="link" href="#" linkend="ch10">Chapter 10</a>, <span class="emphasis"><em>Composing Music</em></span>.</p></div><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>After you are done setting the conditions, drag the region so it covers the entire top area except for the looping section. Continue the procedure for the remaining levels. The following screenshot will show you how the finished view will look:</li></ol></div><div class="mediaobject"><img src="/graphics/9781787286450/graphics/f4f9fb92-b12a-4407-bfe9-065dcfa205ab.png" /></div><p>Transition markers converted to transition regions</p><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>Again, this may seem like a bit of work but using copy/paste you can probably complete this step quicker than the last. After you are done setting up all the transition regions with the correct conditions and quantization, save and build the project.</li><li>Open up Unity and run the scene by pressing play. Notice how the transition is far quicker now between clips this is the clear advantage of the <span class="strong"><strong>music demarcation branching</strong></span> technique. When you are done testing, stop the scene.</li></ol></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip132"></a>Note</h3><p>If you feel the changes are too quick or rushed, you can quickly adjust the quantization value you are using for the transition. You could even set different quantizations for different transition regions, the possibilities are endless here.</p></div><p>For the most part, <span>everything</span> sounds good, but there are a couple of problem spots we want to improve on. The transition between levels 1-3 to level 4 and 5 is abrupt because they were extracted from a different source. They also have a different tempo and instrument variation. To account for that we are going to introduce transition timelines, which will <span>allow</span> us to ease those differences with other horizontal re-sequencing <span>techniques</span> such as <span class="strong"><strong>cross fading and stingers</strong></span>.</p><p>First, let's take a look at how we can perform cross fading in a transition timeline from the 1-3 levels to level 4 transition region by following the directions given here:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Go to the <strong class="userinput"><code>Event Editor</code></strong> and select the <strong class="userinput"><code>music</code></strong> event. Double-click on the <strong class="userinput"><code>Level 4</code></strong> transition region above levels 1-3. This will open up the timeline window and add a small circle icon to the end of the transition region marker. Adjust the timeline window by hovering the mouse over the time bar and when it turns to an arrow, drag the window so that only covers around 2 seconds.</li><li>Next, use the mouse to drag the <strong class="userinput"><code>Level 4</code></strong> drag <span>halfway</span> left into the timeline. Do the same thing on the other side so that they meet in the middle. Then, use the mouse to hover over the corner of each track until it turns to a fader cursor. After the cursor changes, drag it across the track to create a fade level over the portion of the track. This is shown in the following screenshot:</li></ol></div><div class="mediaobject"><img src="/graphics/9781787286450/graphics/3d612b2c-1743-4fd6-afa7-b91d7f81201d.png" /></div><p>Setting up the transition timeline
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip133"></a>Note</h3><p>You can also fade between different clips by just dragging the end of one clip over the top off another. You will see a cross fade region generated for you automatically.</p></div><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>Save and build the project and then jump to the Unity editor. Press play to run the scene and see if you can pick out how smooth the transition is now between areas 1-3 to 4.</li></ol></div><p>That corrects our problem for music level 4 transitions now we will cover a more advanced technique in order to resolve the level 5 transition. Follow the instructions given here to build on the previous example:</p><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>Start by building another transition <span>timeline,</span> this time using the <code class="literal">Level 5</code> transition region. Set the timeline range to around 4 seconds and cross fade just as you did before. After you are done with that, you should be at the point shown in the following screenshot:</li></ol></div><div class="mediaobject"><img src="/graphics/9781787286450/graphics/900bf4c8-817c-4f94-b722-19b294f7d83c.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="5" type="1"><li>Now, we want to punch up the transition between the other levels and <code class="literal">Level 5</code> by adding a short violin stinger into another track. Right-click [<span class="emphasis"><em>Ctrl</em></span> + click on Mac] on the <strong class="userinput"><code>Audio 1</code></strong> track and select Add Audio Track from the menu. Drag the <code class="literal">stinger-violin.wav</code> file from the <code class="literal">Chapter_7_Music</code> folder and drop it onto the <strong class="userinput"><code>Audio 2</code></strong> track just after the <code class="literal">Level 5</code> transition timeline. This is shown in the following screenshot:</li></ol></div><div class="mediaobject"><img src="/graphics/9781787286450/graphics/80f2dd39-d587-4470-b547-c063431b3795.png" /></div><p>Level 5 transition timeline and stinger added on separate audio track</p><div class="orderedlist"><ol class="orderedlist arabic" start="6" type="1"><li>After you are done making the changes save and build the project. Return to Unity and run the scene. Test the scene and observe the changes. Of course feel free to make any other additional changes you want at this point.</li></ol></div><p>The addition of the stinger in this example was derived and just as an example. In fact, our entire example is actually a use of stinger-based sequencing, because we are using a collection of clips as our music base. Keep in mind though that you could use any length of music clip and use the advanced techniques we worked through here.</p><div class="blockquote"><blockquote class="blockquote"><p><span class="emphasis"><em>A sting is a short musical phrase, primarily used in broadcasting and films as a form of punctuation. For example, a sting might be used to introduce a regular section of a show, indicate the end of a scene, or indicate that a dramatic climax is imminent. - Wikipedia</em></span></p></blockquote></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note134"></a>Note</h3><p>QUIZ TIME ANSWERS</p><p>Which of the following adaptive music techniques can FMOD support:
a) <span class="strong"><strong>Vertical remixing</strong></span>
b) <span class="strong"><strong>C</strong></span><span class="strong"><strong>ross fading</strong></span>
c) <span class="strong"><strong>Phrase branching</strong></span>
d) <span class="strong"><strong>Musical demarcation branching</strong></span>
e) <span class="strong"><strong>Bridge transitions</strong></span>
f) <span class="strong"><strong>Singer-based sequencing</strong></span></p><p>FMOD could support any of the techniques listed precedingly.</p></div></div>