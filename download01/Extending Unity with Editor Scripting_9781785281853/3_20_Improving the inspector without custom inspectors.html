<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch03lvl1sec23"></a>Improving the inspector without custom inspectors</h2></div></div><hr /></div><p>In this section, we <a id="id119" class="indexterm"></a>will explore a way to create custom GUI for our properties using Property Drawers.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec27"></a>What is a Property Drawer?</h3></div></div></div><p>A <span class="strong"><strong>Property </strong></span>
<a id="id120" class="indexterm"></a>
<span class="strong"><strong>Drawer</strong></span> allows you to control how the GUI of a <code class="literal">Serializable</code> class or property is displayed in the <span class="strong"><strong>Inspector</strong></span> window. This approach significantly reduces the amount of work you have to do for the GUI customization because you don't need to write an entire custom inspector. Instead, you can just apply appropriate attributes to variables in your scripts to tell the editor how you want those properties to be drawn.</p><p>Unity has several built-in Property Drawers. In the following example, we will use the <code class="literal">Range</code> attribute:</p><div class="informalexample"><pre class="programlisting">using UnityEngine;

public class DrawerExample : MonoBehaviour {
  [Range (0, 100)]
  public int intValue = 50;
}</pre></div><p>This is the result of the preceding code:</p><div class="mediaobject"><img src="/graphics/9781785281853/graphics/B04640_03_16.jpg" /></div><p>Using the <code class="literal">Range</code> attribute, we rendered a slider that moves between 0 and 100 instead of the common int field without creating a custom inspector.</p><p>In the next section, we will check the rest of the available Property Drawers in Unity.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec28"></a>Built-in Property Drawers</h3></div></div></div><p>The Unity <a id="id121" class="indexterm"></a>documentation has information about the <a id="id122" class="indexterm"></a>built-in Property Drawers, but there is no place where you can check all the available ones listed. In this section, we want to resolve this.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch03lvl3sec10"></a>Range</h4></div></div></div><p>The range attribute is <a id="id123" class="indexterm"></a>used to constrain a float or int variable in a script to a specific range. When this attribute is used, the float or int will be shown as a slider in the inspector instead of the default int or float field:</p><div class="informalexample"><pre class="programlisting">// Method signatures
// public RangeAttribute(float min, float max);
// public RangeAttribute(int min, int max);
[Range (0, 1)]
public float floatRange = 0.5f;
[Range (0, 100)]
public int intRange = 50;</pre></div><p>You will get the following output:</p><div class="mediaobject"><img src="/graphics/9781785281853/graphics/B04640_03_17.jpg" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch03lvl3sec11"></a>Multiline</h4></div></div></div><p>The multiline <a id="id124" class="indexterm"></a>attribute is used to make a string value to be shown in a <code class="literal">Multiline</code> text area. You can set up how many lines of text to make room for. The default is three and the text doesn't wrap on this GUI component:</p><div class="informalexample"><pre class="programlisting">// Method signatures
// public MultilineAttribute();
// public MultilineAttribute(int lines);
[Multiline (2)]
public string stringMultiline = "This text is using a multiline property drawer";</pre></div><p>You will get the <a id="id125" class="indexterm"></a>following output:</p><div class="mediaobject"><img src="/graphics/9781785281853/graphics/B04640_03_18.jpg" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch03lvl3sec12"></a>TextArea</h4></div></div></div><p>The <code class="literal">TextArea</code> <a id="id126" class="indexterm"></a>attribute makes a string editable within a height-flexible and scrollable text area. You can specify the minimum and maximum values and a scrollbar will appear if the text is bigger than the area available:</p><div class="informalexample"><pre class="programlisting">// Method signatures
// public TextAreaAttribute();
// public TextAreaAttribute(int minLines, int maxLines);
[TextArea (2, 4)]
public string stringTextArea = "This text \nis using \na text area \nproperty \ndrawer";</pre></div><p>You will get the following output:</p><div class="mediaobject"><img src="/graphics/9781785281853/graphics/B04640_03_19.jpg" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch03lvl3sec13"></a>ContextMenu</h4></div></div></div><p>This Attribute makes a <a id="id127" class="indexterm"></a>method accessible in the context menu of a component or script. When the user selects this context menu item, the method will be executed. In this example, we will expose the method <code class="literal">DoSomething</code>:</p><div class="informalexample"><pre class="programlisting">// Method signature
// public ContextMenuAttribute(string name);
    [ContextMenu ("Do Something")]
  public void DoSomething() {
    Debug.Log ("DoSomething was called...");
  } </pre></div><p>You will get the following output:</p><div class="mediaobject"><img src="/graphics/9781785281853/graphics/B04640_03_20.jpg" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch03lvl3sec14"></a>ContextMenuItem</h4></div></div></div><p>This Attribute makes a <a id="id128" class="indexterm"></a>method accessible as a context menu item of a property (the method must be nonstatic). In this example, we call a method to reset the value of the <code class="literal">IntReset</code> variable to <code class="literal">0</code>:</p><div class="informalexample"><pre class="programlisting">// Method signature
// public ContextMenuItemAttribute(string name, string function);
[ContextMenuItem("Reset this value", "Reset")]
public int intReset = 100;

public void Reset() {
  intReset = 0;
}</pre></div><div class="mediaobject"><img src="/graphics/9781785281853/graphics/B04640_03_21.jpg" /></div></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec29"></a>Built-in Decorator Drawers</h3></div></div></div><p>There are another <a id="id129" class="indexterm"></a>kind of drawers called <span class="strong"><strong>Decorator Drawers</strong></span>. They are similar in composition to the Property Drawers, but the main difference is that Decorator Drawers are designed to draw decoration in the inspector and are unassociated with a specific field.</p><p>While you can only declare one property drawer per variable, you can stack multiple decorator drawers.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch03lvl3sec15"></a>Header</h4></div></div></div><p>This is the <a id="id130" class="indexterm"></a>attribute that adds a header to some fields in the inspector:</p><div class="informalexample"><pre class="programlisting">// Method signature
// public HeaderAttribute(string header);
[Header("This is a group of variables")]
public int varA = 10;
public int varB = 20;</pre></div><div class="mediaobject"><img src="/graphics/9781785281853/graphics/B04640_03_22.jpg" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch03lvl3sec16"></a>Space</h4></div></div></div><p>This attribute <a id="id131" class="indexterm"></a>adds some spacing in the inspector:</p><div class="informalexample"><pre class="programlisting">// Method signature
// public SpaceAttribute(float height);
public int varC = 10;
[Space(40)]
public int varD = 20;</pre></div><div class="mediaobject"><img src="/graphics/9781785281853/graphics/B04640_03_23.jpg" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch03lvl3sec17"></a>Tooltip</h4></div></div></div><p>The attribute <a id="id132" class="indexterm"></a>adds a tooltip to a property on the inspector:</p><div class="informalexample"><pre class="programlisting">// Method signature
// public TooltipAttribute(string tooltip);
[Tooltip("This is a tooltip")]
public int varE = 30;</pre></div><p> </p><div class="mediaobject"><img src="/graphics/9781785281853/graphics/B04640_03_24.jpg" /></div><p>
</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec30"></a>Creating you own Property Drawers</h3></div></div></div><p>If you have a <a id="id133" class="indexterm"></a>serializable parameter or structure that repeats constantly in your video game and you would like to improve how this renders in the inspector, you can try to write your own property drawers.</p><p>We are going to create a property drawer for an integer meant to be a variable to save time in seconds. This Property Drawer will draw a normal int field but also a label with the number of seconds converted to the <span class="emphasis"><em>m:s</em></span> or <span class="emphasis"><em>h:m:s</em></span> time format.</p><p>This is going to convert something like this:</p><div class="mediaobject"><img src="/graphics/9781785281853/graphics/B04640_03_25.jpg" /></div><p>To this following output:</p><div class="mediaobject"><img src="/graphics/9781785281853/graphics/B04640_03_26.jpg" /></div><p>For sure, this is much easier to read compared to the previous version.</p><p>To implement a Property Drawer you must create two scripts:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>The attribute, the one you will be using over the properties in your <code class="literal">MonoBehaviour</code> scripts.</p></li><li style="list-style-type: disc"><p>The drawer, responsible for rendering the GUI and handling the input of the user. This last one is an editor script.</p></li></ul></div><p>Let's start with the <a id="id134" class="indexterm"></a>first one. Inside the folder <code class="literal">Tools\LevelCreator\Scripts</code>, create a script called <code class="literal">TimeAttribute.cs</code> with the following code:</p><div class="informalexample"><pre class="programlisting">using UnityEngine;

namespace RunAndJump.LevelCreator {
  public class TimeAttribute : PropertyAttribute {
    public readonly bool DisplayHours;

    public TimeAttribute (bool displayHours = false) { 
      DisplayHours = displayHours;
    }
  }
}</pre></div><p>Here, we defined the name of the attribute and its parameters. You must create your attribute class extending from the <code class="literal">PropertyAttribute</code> class, and if you want to start creating your own, you must have these kind of scripts outside any <code class="literal">Editor</code> folder. This is very important to make them work!</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip09"></a>Tip</h3><p>By convention, the name of the attribute class ends with the word attribute. While not required, this is recommended for readability. When the attribute is used, the word attribute is optional.</p></div><p>The <code class="literal">TimeAttribute</code> has an optional parameter called <code class="literal">DisplayHours</code>. By default, the <code class="literal">Time</code> attribute will display a label under the int field with the time in <span class="emphasis"><em>m:s</em></span> format; if <code class="literal">DisplayHours</code> is true, this will be displayed in the <span class="emphasis"><em>h:m:s</em></span> format.</p><p>Now, we want to implement the drawer. This script must be in an <code class="literal">Editor</code> folder. So, inside <code class="literal">Tools\LevelCreator\Editor</code>, create a new script called <code class="literal">TimeDrawer.cs</code> with the following code:</p><div class="informalexample"><pre class="programlisting">using UnityEngine;
using UnityEditor;

namespace RunAndJump.LevelCreator {
  [CustomPropertyDrawer (typeof(TimeAttribute))]
  public class TimeDrawer : PropertyDrawer {
    public override float GetPropertyHeight (SerializedProperty property, GUIContent label) {
      return EditorGUI.GetPropertyHeight (property) * 2;
    }
    
    public override void OnGUI (Rect position, SerializedProperty property, GUIContent label) {
      if (property.propertyType == SerializedPropertyType.Integer) {
        property.intValue = EditorGUI.IntField (new Rect (position.x, position.y, position.width, position.height / 2), label, Mathf.Max (0, property.intValue));
        EditorGUI.LabelField (new Rect (position.x, position.y + position.height / 2, position.width, position.height / 2), " ", TimeFormat (property.intValue));
        
      } else {
        EditorGUI.HelpBox (position, "To use the Time attribute \"" + label.text + "\" must be an int!", MessageType.Error);
      }
    }
    
    private string TimeFormat (int totalSeconds) {
      TimeAttribute time = attribute as TimeAttribute;
      // Here we are using string.Format to add the variables in the string.
      if (time.DisplayHours) {
        int hours = totalSeconds / (60 * 60);
        int minutes = ((totalSeconds % (60 * 60)) / 60);
        int seconds = (totalSeconds % 60);
        return string.Format ("{0}:{1}:{2} (h:m:s)", hours, minutes.ToString ().PadLeft (2, '0'), seconds.ToString ().PadLeft (2, '0'));
      } else {
        int minutes = (totalSeconds / 60);
        int seconds = (totalSeconds % 60);
        return string.Format ("{0}:{1} (m:s)", minutes.ToString (), seconds.ToString ().PadLeft (2, '0'));
      }
    }
  }
}</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note17"></a>Note</h3><p>A property drawer doesn't support layouts to create a GUI. For this reason, the only classes usable here are <code class="literal">EditorGUI</code> and <code class="literal">GUI</code> (instead of <code class="literal">EditorGUILayout</code> and <code class="literal">GUILayout</code>). This class requires a little extra effort to be used; you must define a <code class="literal">Rect</code> that will contain the GUI element each time you want to use one.</p></div><p>The <code class="literal">CustomPropertyDrawer</code> attribute is part of the <code class="literal">UnityEditor</code> namespace and is the way Unity has to bind a drawer with a <code class="literal">Property</code> attribute. In this case, we passed the type <code class="literal">TimeAttribute</code>.</p><p>You must extend from the <code class="literal">PropertyDrawer</code> class, and in this way, you will have access to the core methods to create property drawers:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>
<code class="literal">GetPropertyHeight</code>: The responsibility of this method is to handle the height of the drawer. You <a id="id135" class="indexterm"></a>need to overwrite this method in order to use it.</p></li><li style="list-style-type: disc"><p>
<code class="literal">OnGUI</code>: This is where you place all the code related to render the GUI in a similar way that we did for the inspectors. The only difference here is that you must use the class <code class="literal">EditorGUI</code> because layouts are not allowed.</p></li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note18"></a>Note</h3><p>You can create Decorator Drawers too by following the steps we did to create a Property Drawer, but instead of extending your drawer from <code class="literal">PropertyDrawer</code>, you will need to extend it from <code class="literal">DecoratorDrawer</code>.</p></div><p>To test our code, create a new script called <code class="literal">TimeDrawerDemo.cs</code> and add the following (you can discard this script later):</p><div class="informalexample"><pre class="programlisting">using UnityEngine;
using RunAndJump.LevelCreator;

public class TimeExample : MonoBehaviour {

    [Time]
    public int TimeMinutes = 3600;
    [Time(true)]
    public int TimeHours = 3600;
    [Time]
    public float TimeError = 3600;
}</pre></div><p>We added the line using the <code class="literal">RunAndJump.LevelCreator</code> namespace because the time attribute is part of that namespace. After compiling, if you attach this script to a game object, you will see something like this on the inspector:</p><div class="mediaobject"><img src="/graphics/9781785281853/graphics/B04640_03_27.jpg" /></div><p>Now with our own <a id="id136" class="indexterm"></a>custom property drawer working, you will learn how to combine this with the custom inspector we created.</p></div></div>