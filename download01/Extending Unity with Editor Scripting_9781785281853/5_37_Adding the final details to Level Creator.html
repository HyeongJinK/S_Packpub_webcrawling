<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch05lvl1sec38"></a>Adding the final details to Level Creator</h2></div></div><hr /></div><p>The Level Creator is almost ready, but before finishing this chapter, let's make a few improvements<a id="id246" class="indexterm"></a> to make this tool better.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec52"></a>Using hiding flags</h3></div></div></div><p>Currently, each time we paint pieces on the level, they are created and nested in the level game object. We <a id="id247" class="indexterm"></a>are still able to access the objects directly; this means it is possible to move a piece by error outside the grid. Let's take a look at the<a id="id248" class="indexterm"></a> following screenshot:</p><div class="mediaobject"><img src="/graphics/9781785281853/graphics/B04640_05_23.jpg" /></div><p>To control the <a id="id249" class="indexterm"></a>visibility of the level pieces in the hierarchy, we <a id="id250" class="indexterm"></a>are going to use <code class="literal">HidingFlags</code>, bit masks that control object destruction, saving, and visibility in inspectors. Here is a list of available flags that could be applied to Unity objects:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>
<code class="literal">None</code>: A normal and visible object. This is the default.</p></li><li style="list-style-type: disc"><p>
<code class="literal">HideInHierarchy</code>: It does not appear in the hierarchy.</p></li><li style="list-style-type: disc"><p>
<code class="literal">HideInInspector</code>: It is not visible in the inspector.</p></li><li style="list-style-type: disc"><p>
<code class="literal">DontSaveInEditor</code>: It is not saved to the scene in the editor.</p></li><li style="list-style-type: disc"><p>
<code class="literal">NotEditable</code>: It is not editable in the inspector.</p></li><li style="list-style-type: disc"><p>
<code class="literal">DontUnloadUnusedAsset</code>: It is not unloaded by <code class="literal">Resources.UnloadUnusedAssets</code>.</p></li><li style="list-style-type: disc"><p>
<code class="literal">DontSaveInBuild</code>: It is not saved when a player is built.</p></li><li style="list-style-type: disc"><p>
<code class="literal">DontSave</code>: It is not saved to the scene. It will not be destroyed when a new scene is loaded. It is a shortcut for <span class="strong"><strong>HideFlags.DontSaveInBuild</strong></span> | <span class="strong"><strong>HideFlags.DontSaveInEditor</strong></span> | <span class="strong"><strong>HideFlags.DontUnloadUnusedAsset</strong></span>.</p></li><li style="list-style-type: disc"><p>
<code class="literal">HideAndDontSave</code>: It is a combination of not shown in the hierarchy, not saved to scenes, and not unloaded by the object; it will not be unloaded by <code class="literal">Resources.UnloadUnusedAssets</code>.</p></li></ul></div><p>In our case, the flag we want to use is <code class="literal">HideInHierarchy</code>. To use it, we will update the <code class="literal">Paint</code> method as follows:</p><div class="informalexample"><pre class="programlisting">private void Paint(int col, int row) {
  // Check out of bounds and if we have a piece selected
  if(!_myTarget.IsInsideGridBounds(col,row) ||  _pieceSelected == null) {
    return;
  }
  // Check if I need to destroy a previous piece
  if(_myTarget.Pieces[col + row * _myTarget.TotalColumns] != null) {
    DestroyImmediate(_myTarget.Pieces[col + row * _myTarget.TotalColumns].gameObject);
  }
  // Do paint !
  GameObject obj = PrefabUtility.InstantiatePrefab( _pieceSelected.gameObject) as GameObject;
  obj.transform.parent = _myTarget.transform;
  obj.name = string.Format("[{0},{1}][{2}]", col, row, obj.name);
  obj.transform.position = _myTarget.GridToWorldCoordinates(col, row);
<span class="strong"><strong>  obj.hideFlags = HideFlags.HideInHierarchy;</strong></span>
  _myTarget.Pieces[col + row * _myTarget.TotalColumns] =  obj.GetComponent&lt;LevelPiece&gt;();
}</pre></div><p>Each time we<a id="id251" class="indexterm"></a> generate a new prefab instance of a level <a id="id252" class="indexterm"></a>piece, we will set up the <code class="literal">HidingFlags</code> to <code class="literal">HideInHierarchy</code>.</p><p>Save the changes and wait for Unity to compile; then, create a new level and start painting pieces on the grid. Take a look at the hierarchy; it doesn't matter how many pieces we added to the level. These are not accessible unless we use the Level Creator modes to interact with them. Take a look at the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781785281853/graphics/B04640_05_24.jpg" /></div><p>With this improvement, we are making users follow the workflow of the Level Creator tool and avoiding<a id="id253" class="indexterm"></a> possible corruption of the level.</p><p>Finally, one <a id="id254" class="indexterm"></a>of the important restrictions to make Level Creator work is to avoid making changes in its transform property.</p><p>It's hard to assume the users of the Level Creator tool are going to keep this without making changes. So, instead of giving them this responsibility, we are going to implement this restriction through code using a hiding Flag.</p><p>Add the following line of code inside the <code class="literal">InitLevel</code> method:</p><div class="informalexample"><pre class="programlisting">_myTarget.transform.hideFlags = HideFlags.NotEditable;</pre></div><p>Save and check the inspector of the <span class="strong"><strong>Level</strong></span>:</p><div class="mediaobject"><img src="/graphics/9781785281853/graphics/B04640_05_25.jpg" /></div></div></div>