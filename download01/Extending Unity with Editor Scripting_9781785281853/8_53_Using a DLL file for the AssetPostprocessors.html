<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch08lvl1sec51"></a>Using a DLL file for the AssetPostprocessors</h2></div></div><hr /></div><p>If you<a id="id326" class="indexterm"></a> have your video game in a production pipeline, you must consider placing all your <code class="literal">AssetPostprocessors</code> in a prebuilt DLL file in the project instead of in scripts. This is because when you have a compile error in one of the project scripts, it will lead to assets being imported differently.</p><p>The DLL approach helps us to ensure that they can always be executed even if the scripts of our project have compile errors.</p><p>In this section, you will learn how to create a DLL file in MonoDevelop using the scripts we created in the previous sections.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch08lvl2sec68"></a>Creating and setting up a DLL project</h3></div></div></div><p>
<span class="strong"><strong>DLLs</strong></span> are <span class="strong"><strong>Dynamic Link Libraries</strong></span>; this means that they're linked to your program at runtime instead of compile time.</p><p>Usually we<a id="id327" class="indexterm"></a> create new scripts from Unity, but in this case we will interact directly with MonoDevelop. Run the application, and create a new solution by navigating to <span class="strong"><strong>File</strong></span> |<span class="strong"><strong> New</strong></span> |<span class="strong"><strong> Solution</strong></span> from the menu bar. This opens the following window:</p><div class="mediaobject"><img src="/graphics/9781785281853/graphics/B04640_08_05.jpg" /></div><p>Here, select <span class="strong"><strong>C#</strong></span> in the <a id="id328" class="indexterm"></a>left column and then the <span class="strong"><strong>Library</strong></span> option from the center column. Name this project <code class="literal">ImportPipeline</code> and then click on the <span class="strong"><strong>OK</strong></span> button. A new script called <code class="literal">MyClass.cs</code> is created. For our purposes just remove that file.</p><p>To access the Unity API from the DLL, we must import the <span class="strong"><strong>UnityEngine</strong></span>
<a id="id329" class="indexterm"></a> and <a id="id330" class="indexterm"></a>
<span class="strong"><strong>UnityEditor</strong></span> assemblies into the project references. These assemblies, or DLLs, are inside the Unity application folder.</p><p>In MonoDevelop, go to the menu bar and navigate to <span class="strong"><strong>Project</strong></span> | <span class="strong"><strong>Edit References</strong></span>. This will open a new window with several tabs. Select <span class="strong"><strong>.Net Assembly</strong></span> to access a file explorer interface.</p><p>Depending on the operating system you are using, the DLLs we are looking for will be located in <code class="literal">Applications/Unity/Unity.app/Content/Framework/Managed</code>, if you are using OSX or in <code class="literal">Program Files\Unity\Editor\Data\Managed</code> if you are using Windows.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note34"></a>Note</h3><p>Take into consideration that your project will use specific DLLs based on the version of Unity you have. This is important if you want to reuse your DLLs in other video game projects.</p></div><p>Let's take a look at the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781785281853/graphics/B04640_08_06.jpg" /></div><p>Click on<a id="id331" class="indexterm"></a> the <span class="strong"><strong>UnityEditor.dll</strong></span> and <span class="strong"><strong>UnityEngine.dll</strong></span> assemblies to add the references, and then click on the <span class="strong"><strong>OK</strong></span> button.</p><p>You are almost ready. The last thing to do is to verify the current Target Framework of this solution. Go to the menu bar and navigate to <span class="strong"><strong>Project</strong></span> | <span class="strong"><strong>ImportPipeline options</strong></span> (this changes depending on the name of the project):</p><div class="mediaobject"><img src="/graphics/9781785281853/graphics/B04640_08_07.jpg" /></div><p>In the <span class="strong"><strong>Project Options</strong></span> window, on the right-hand side, navigate to <span class="strong"><strong>Build</strong></span> | <span class="strong"><strong>General</strong></span> and then check <a id="id332" class="indexterm"></a>whether <span class="strong"><strong>Target Framework</strong></span> is set to <span class="strong"><strong>Mono / .NET 4.0</strong></span>.</p><div class="mediaobject"><img src="/graphics/9781785281853/graphics/B04640_08_08.jpg" /></div><p>Finally, click on the <span class="strong"><strong>OK</strong></span> button.</p><p>From the MonoDevelop menu bar, navigate to <span class="strong"><strong>View</strong></span> | <span class="strong"><strong>Visual Design</strong></span>. This will open a side bar with the solution structure in the main window. Now, a right-click on the <span class="strong"><strong>ImportPipeline</strong></span> project and navigate to <span class="strong"><strong>Add</strong></span> | <span class="strong"><strong>Add Filesâ€¦</strong></span>, as follows:</p><div class="mediaobject"><img src="/graphics/9781785281853/graphics/B04640_08_09.jpg" /></div><p>Look for the<a id="id333" class="indexterm"></a> script <code class="literal">TexturePipeline.cs</code>, the one we created in Run &amp; Jump. You will now see the following dialog:</p><div class="mediaobject"><img src="/graphics/9781785281853/graphics/B04640_08_10.jpg" /></div><p>Select <span class="strong"><strong>Move the file to the directory</strong></span> and then click on <span class="strong"><strong>OK</strong></span>. The script will appear in your DLL project now:</p><div class="mediaobject"><img src="/graphics/9781785281853/graphics/B04640_08_11.jpg" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch08lvl2sec69"></a>Integrating the DLL file to the main project</h3></div></div></div><p>Now, to<a id="id334" class="indexterm"></a> build the DLL file, check whether the <span class="strong"><strong>Release</strong></span> option is selected in the top-left corner of MonoDevelop.</p><p> </p><div class="mediaobject"><img src="/graphics/9781785281853/graphics/B04640_08_12.jpg" /></div><p>
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note35"></a>Note</h3><p>By default, there are two types of configurations: <span class="strong"><strong>Debug</strong></span>
<a id="id335" class="indexterm"></a> and <a id="id336" class="indexterm"></a>
<span class="strong"><strong>Release</strong></span>. The first type includes debug information in the compiled files (allowing easy debugging) while the second type usually has optimizations enabled.</p></div><p>Then, go to the MonoDevelop menu bar and navigate to <span class="strong"><strong>Build</strong></span> | <span class="strong"><strong>Build ImportPipeline</strong></span> (this changes depending on the name of the project).</p><p>Once the solution is built, navigate to <code class="literal">ImportPipeline/bin/Release</code>, where the<code class="literal"> ImportPipeline.dll</code> file was created:</p><div class="mediaobject"><img src="/graphics/9781785281853/graphics/B04640_08_13.jpg" /></div><p>This DLL is <a id="id337" class="indexterm"></a>the file that we need to add to our Unity video game project. Open the <code class="literal">Run &amp; Jump</code> project and copy and paste the <code class="literal">ImportPipeline.dll</code> file inside the <code class="literal">Tools/ImportPipeline/Editor</code>.</p><div class="mediaobject"><img src="/graphics/9781785281853/graphics/B04640_08_14.jpg" /></div><p>Adding the DLL file<a id="id338" class="indexterm"></a> inside the <code class="literal">Editor</code> folder will make it available only for the editor context. You can check this by looking at the <span class="strong"><strong>Inspector</strong></span> window when you select the DLL file, as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781785281853/graphics/B04640_08_15.jpg" /></div><p>Now our import pipeline is ready!</p></div></div>