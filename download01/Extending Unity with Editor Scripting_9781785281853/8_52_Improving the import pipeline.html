<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch08lvl1sec50"></a>Improving the import pipeline</h2></div></div><hr /></div><p>It is possible to <a id="id320" class="indexterm"></a>change the default settings Unity applies for all the assets added to the project and also, depending on your creativity and the pipeline you want to build, you can use different import settings for the asset based on filename, location, and so on.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch08lvl2sec67"></a>Overwriting the background and level piece assets settings</h3></div></div></div><p>Do you<a id="id321" class="indexterm"></a> remember the asset we dropped into the project to test the script we created in the last section? Let's check its properties in the inspector:</p><div class="mediaobject"><img src="/graphics/9781785281853/graphics/B04640_08_03.jpg" /></div><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip12"></a>Tip</h3><p>When you create a new project and select the option <span class="strong"><strong>2D</strong></span> or <span class="strong"><strong>3D</strong></span>, it tells Unity how to deal with the assets imported, in this case, for example, the project uses <span class="strong"><strong>2D</strong></span> so all the images are imported as Sprites instead of textures.</p></div><p>One thing <a id="id322" class="indexterm"></a>that all projects should have is a file naming and folder structure convention; it makes things more organized and is really important if you have other people working with you. If a texture is dropped in Assets/Art/Bg, we are going to assume the texture is a background for the video game.</p><p>To satisfy our requirements, we will set up three things:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>
<span class="strong"><strong>Texture Type:</strong></span> This must be a Sprite, and should be independent if the project is configured as a 2D or 3D project.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Generate Mip Maps</strong></span>: These are not necessary. Disabling them will reduce the file size of the texture or sprite.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Pivot</strong></span>: This is required to have the pivot on the bottom-left corner.</p></li></ul></div><p>Open the <code class="literal">TexturePipeline</code> class and create a new method called <code class="literal">PreprocessBg</code> with the following code:</p><div class="informalexample"><pre class="programlisting">private void PreprocessBg () {
  TextureImporter importer = assetImporter as TextureImporter;
  importer.textureType = TextureImporterType.Sprite;
  TextureImporterSettings texSettings = new TextureImporterSettings();
  importer.ReadTextureSettings(texSettings);
  texSettings.spriteAlignment = (int) SpriteAlignment.BottomLeft;
  texSettings.mipmapEnabled = false;
  importer.SetTextureSettings(texSettings);
}</pre></div><p>The <a id="id323" class="indexterm"></a>
<code class="literal">assetImporter</code> variable is part of the <code class="literal">AssetPostprocessor</code> class and gives us access to the properties of the asset we are importing. As we are dealing with textures, we must cast the <code class="literal">assetImporter</code> variable to a <code class="literal">TextureImporter</code> (in other scenarios, you may like to use the <code class="literal">AudioImporter</code> or <code class="literal">ModelImporter</code> parameter for audio or 3D models respectively).</p><p>Using an instance of the <code class="literal">TextureImporterSettings</code> class, we can access the settings of this asset and make the modifications we want.</p><p>The most important thing to always keep in mind is to start with the method <code class="literal">ReadTextureSettings</code> and finish with the method <code class="literal">SetTextureSettings</code> in order to avoid unexpected results. Basically, with this we take the current configuration of the asset and make the changes over it.</p><p>Now, let's call this method inside the <code class="literal">OnPreprocessTexture</code> method by adding a rule based on the path of the asset:</p><div class="informalexample"><pre class="programlisting">private void OnPreprocessTexture () {
Debug.LogFormat("OnPreprocessTexture, The path is {0}", assetPath);
    if (assetPath.StartsWith ("Assets/Art/Bg")) {
    PreprocessBg ();
  }
}</pre></div><p>Remove the <span class="strong"><strong>Bg_OrangeSky.png</strong></span> asset we originally added and add it again to the project, but this time, ensure that you drop the asset inside the <code class="literal">Assets/Art/Bg</code> folder and check the properties.</p><div class="mediaobject"><img src="/graphics/9781785281853/graphics/B04640_08_04.jpg" /></div><p>We<a id="id324" class="indexterm"></a> changed the default settings based on our video game project requirements. Now, we will repeat the same procedure, but for the art used by the level piece prefabs:</p><div class="informalexample"><pre class="programlisting">private void PreprocessLevelPieces() {
  TextureImporter importer = assetImporter as TextureImporter;
  importer.textureType = TextureImporterType.Sprite;
  TextureImporterSettings texSettings = new TextureImporterSettings();
  importer.ReadTextureSettings(texSettings);
  texSettings.spriteAlignment = (int) SpriteAlignment.Center;
  texSettings.mipmapEnabled = false;
   importer.SetTextureSettings(texSettings);
}</pre></div><p>This is pretty similar to the settings we used for the backgrounds. The only difference is that we keep the pivot of the image in the center.</p><p>Now, add the <code class="literal">PreprocessLevelPieces</code> method inside the <code class="literal">OnPreprocessTexture</code> method as follows:</p><div class="informalexample"><pre class="programlisting">private void OnPreprocessTexture () {
Debug.LogFormat("OnPreprocessTexture, The path is {0}", assetPath);
if( assetPath.StartsWith( "Assets/Art/Bg" ) ) {
  PreprocessBg();
  } else if(
    assetPath.StartsWith( "Assets/Art/Platformer" ) ) {
    PreprocessLevelPieces();
  }
}</pre></div><p>With this <a id="id325" class="indexterm"></a>approach, we don't need to worry about the settings of the art assets anymore.</p></div></div>