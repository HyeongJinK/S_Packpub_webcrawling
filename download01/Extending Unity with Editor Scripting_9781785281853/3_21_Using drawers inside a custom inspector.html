<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch03lvl1sec24"></a>Using drawers inside a custom inspector</h2></div></div><hr /></div><p>We use the <a id="id137" class="indexterm"></a>variable <code class="literal">target</code> to access the public methods, properties, and variables of the <code class="literal">Level</code> class. This is not the only way to do this, and in <a id="id138" class="indexterm"></a>fact, the alternative way will give us more information related to the properties of the object inspected.</p><p>To do this, we will use the classes <code class="literal">SerializedObject</code> and <code class="literal">SerializedProperty</code>.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec31"></a>Using SerializedObject and SerializedProperty</h3></div></div></div><p>Let's <a id="id139" class="indexterm"></a>declare a few variables in the <code class="literal">LevelInspector</code> <a id="id140" class="indexterm"></a>class:</p><div class="informalexample"><pre class="programlisting">private SerializedObject _mySerializedObject;
private SerializedProperty _serializedTotalTime;</pre></div><p>Now, let's declare the initialization of these variables in the <code class="literal">InitLevel</code> method:</p><div class="informalexample"><pre class="programlisting">private void InitLevel () {
  _mySerializedObject = new SerializedObject (_myTarget);
  _serializedTotalTime = _mySerializedObject.FindProperty ("_totalTime");
  if (_myTarget.Pieces == null || _myTarget.Pieces.Length == 0) {
    Debug.Log("Initializing the Pieces array...");
    _myTarget.Pieces = new LevelPiece[ _myTarget.TotalColumns * _myTarget.TotalRows];
  }
}</pre></div><p>The <code class="literal">SerializedObject</code> and <code class="literal">SerializedProperty</code> are classes for editing properties of objects in a completely generic way. <code class="literal">SerializedObject</code> requires a reference of the variable target to work; and, to get access to each property, we need to write the name in an explicit way using the <code class="literal">FindProperty</code> method from the <code class="literal">SerializedObject</code> class.</p><p>It's true that this <a id="id141" class="indexterm"></a>approach requires extra effort to access each property, but in this way, we get a few benefits, such as handling the undo of the properties by default and accessing information about the property that can be used, for example, to render the property using <code class="literal">PropertyAttibutes</code>.</p><p>To see this last <a id="id142" class="indexterm"></a>thing in action, in the <code class="literal">Level</code> class, add the <code class="literal">Time</code> attribute to the variable <code class="literal">TotalTime</code>, as follows:</p><div class="informalexample"><pre class="programlisting">[LevelCreator.Time]
public int TotalTime = 60;</pre></div><p>Then, we will update the <code class="literal">DrawLevelDataGUI</code> method from the same class by replacing the <code class="literal">IntField</code> for the <code class="literal">PropertyField</code> method from the <code class="literal">EditorGUILayout</code> class. This method takes a <code class="literal">SerializedProperty</code> reference to render the default GUI from that kind of property.</p><div class="informalexample"><pre class="programlisting">private void DrawLevelDataGUI () {
  EditorGUILayout.LabelField ("Data", EditorStyles.boldLabel);
  EditorGUILayout.BeginVertical ("box");
  //_myTarget.TotalTime = EditorGUILayout.IntField ("Total Time", Mathf.Max (0, _myTarget.TotalTime));
<span class="strong"><strong>  EditorGUILayout.PropertyField (_serializedTotalTime);</strong></span>
  _myTarget.Gravity = EditorGUILayout.FloatField ("Gravity", _myTarget.Gravity);
  _myTarget.Bgm = (AudioClip)EditorGUILayout.ObjectField ("Bgm", _myTarget.Bgm, typeof(AudioClip), false);
  _myTarget.Background = (Sprite)EditorGUILayout.ObjectField ("Background", _myTarget.Background, typeof(Sprite), false);
  EditorGUILayout.EndVertical ();
}</pre></div><p>Save the changes. Now, the <code class="literal">Level</code> class has a custom inspector and one of its properties is using a property drawer to render the GUI. With this, we are done for this chapter:</p><div class="mediaobject"><img src="/graphics/9781785281853/graphics/B04640_03_28.jpg" /></div></div></div>