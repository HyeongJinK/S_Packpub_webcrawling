<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch03lvl1sec27"></a>Localization system</h2></div></div><hr /></div><p>Now<a id="id159" class="indexterm"></a> that we have a complete UI, let's configure the <span class="strong"><strong>localization</strong></span> <span class="strong"><strong>system</strong></span> and<a id="id160" class="indexterm"></a> add a pop-up list to change our UI's language.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec44"></a>Localization files</h3></div></div></div><p>All our localized text strings must be contained in a <code class="literal">.txt</code> file for each language. For the purpose of this book, we will have English and French, and we will need the <code class="literal">English.txt</code> file and the <code class="literal">French.txt</code> file.</p><p>Let's create<a id="id161" class="indexterm"></a> them right now in the following manner:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Access your project's Assets folder with your file explorer and create a new folder named <code class="literal">Localization</code>.</p></li><li><p>Inside this new folder, create a new text document named <code class="literal">English.txt</code>.</p></li><li><p>Duplicate this new <code class="literal">English.txt</code> file and rename it as <code class="literal">French.txt</code>.</p></li><li><p>Open them both in your favorite IDE or text editor.</p></li></ol></div><p>Ok, now our localization files are ready to be used with the localization system.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec45"></a>Localization component</h3></div></div></div><p>We can <a id="id162" class="indexterm"></a>now configure the localization system to work with our UI. We need to have the localization component attached to a GameObject in the scene:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select our <span class="strong"><strong>GameManager</strong></span> GameObject and attach a <span class="strong"><strong>Localization</strong></span> component to it by navigating to <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>Internal</strong></span>.</p></li><li><p>In the <span class="strong"><strong>Project</strong></span> view, navigate to Assets | Localization and drag our <code class="literal">English.txt</code> and <code class="literal">French.txt</code> files in the languages array.</p></li></ol></div><p>The <span class="strong"><strong>Starting Language</strong></span> is set to <span class="strong"><strong>English</strong></span>, and we also have <span class="strong"><strong>French</strong></span> available in the array.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec46"></a>Language selection box</h3></div></div></div><p>The next step<a id="id163" class="indexterm"></a> is to create a <span class="strong"><strong>language selection box</strong></span> as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783558667/graphics/8667OT_03_08.jpg" /></div><p>If we want to see what we're doing, we should first disable the Clipping of our <span class="strong"><strong>Container</strong></span> by setting the <span class="strong"><strong>Clipping</strong></span>
<code class="literal"> </code>parameter in its <span class="strong"><strong>UIPanel</strong></span> to <span class="strong"><strong>None</strong></span>.</p><p>Once the Clipping is disabled, follow these steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select the <span class="strong"><strong>Popup</strong></span> GameObject from <span class="strong"><strong>Difficulty</strong></span>:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Check its <span class="strong"><strong>Localized</strong></span> Boolean in <span class="strong"><strong>UIPopup List</strong></span>.</p></li><li><p>Rename its child <span class="strong"><strong>Label</strong></span> GameObject as <code class="literal">CurrentDifficulty</code>.</p></li></ol></div></li><li><p>Select and duplicate our <span class="strong"><strong>Difficulty</strong></span> GameObject in <span class="strong"><strong>Container</strong></span>.</p></li><li><p>Rename the new duplicate as <code class="literal">Language</code>.</p></li><li><p>Select our new <span class="strong"><strong>Background</strong></span> GameObject in <span class="strong"><strong>Language</strong></span> and set its <span class="strong"><strong>Pixel Offset</strong></span> in <span class="strong"><strong>UIAnchor</strong></span> to {<code class="literal">420</code>, -<code class="literal">90</code>}.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note11"></a>Note</h3><p>Sometimes, anchors don't update themselves. You may need to deactivate and then activate the <span class="strong"><strong>Language</strong></span> GameObject for the Label's <span class="strong"><strong>UIAnchor</strong></span> to update.</p></div></li><li><p>Select <a id="id164" class="indexterm"></a>our <span class="strong"><strong>Label</strong></span> GameObject from <span class="strong"><strong>Language</strong></span> and change its text to <code class="literal">[AAFFFF]Language</code>.</p></li><li><p>Select our <span class="strong"><strong>Popup</strong></span> GameObject from <code class="literal">Language</code> and perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Change the <span class="strong"><strong>Options</strong></span> text value to have the following two options:</p><div class="informalexample"><pre class="programlisting">English
French</pre></div></li><li><p>Set its <span class="strong"><strong>Position</strong></span> to <span class="strong"><strong>Below</strong></span>.</p></li><li><p>Check the <span class="strong"><strong>Localized</strong></span> Boolean.</p></li></ol></div></li><li><p>Attach a <span class="strong"><strong>Language Selection</strong></span> component by navigating to <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>Interaction</strong></span>.</p></li><li><p>Rename the <span class="strong"><strong>Label</strong></span>, which is a child of <span class="strong"><strong>Popup</strong></span>, as <code class="literal">CurrentLanguage</code>.</p></li></ol></div><p>We can now reactivate <span class="strong"><strong>Clipping</strong></span> in <span class="strong"><strong>Container</strong></span> by setting the <span class="strong"><strong>Clipping</strong></span> parameter in its <span class="strong"><strong>UIPanel</strong></span> to <span class="strong"><strong>Alpha Clip</strong></span>. The clipping <span class="strong"><strong>Size</strong></span> has been saved.</p><p>That's it, our localization system is in place, and when the pop-up list changes value, the <code class="literal">Language Selection.cs</code> script automatically changes the localization's <span class="strong"><strong>Current Language</strong></span> value.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec47"></a>Localizing a Label</h3></div></div></div><p>We are now<a id="id165" class="indexterm"></a> ready to localize our first Label using the <span class="strong"><strong>UILocalize</strong></span> component and a <code class="literal">Key</code> that will define which string to use from our <code class="literal">.txt</code> files. Perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select our <span class="strong"><strong>Label</strong></span> GameObject from <span class="strong"><strong>Title</strong></span>.</p></li><li><p>Attach a <span class="strong"><strong>Localize</strong></span> component to it by navigating to <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>UI</strong></span>.</p></li><li><p>Set its <code class="literal">Key</code> parameter by typing <code class="literal">MainMenu</code>.</p></li><li><p>Switch to our <code class="literal">English.txt</code> localization file and add the following line:</p><div class="informalexample"><pre class="programlisting">MainMenu = [AAFFFF]Main Menu</pre></div></li><li><p>Switch to our <code class="literal">French.txt</code> localization file and add the following line:</p><div class="informalexample"><pre class="programlisting">MainMenu = [AAFFFF]Menu Principal</pre></div></li></ol></div><p>Save both the <code class="literal">.txt</code> files and click on the play button. If you access options and change the language to <span class="strong"><strong>French</strong></span>, our window's title changes from <span class="strong"><strong>Main Menu</strong></span> to <span class="strong"><strong>Menu Principal</strong></span>. <a id="id166" class="indexterm"></a>That's because the <span class="strong"><strong>UILocalize</strong></span> component updates the <span class="strong"><strong>UILabel</strong></span> component it's attached to using the string present after the <code class="literal">=</code> in our <code class="literal">.txt</code> localization file. If you exit the play mode, the language will be saved and the UI will be initialized with the last selected language.</p><p>Now, we must add a <span class="strong"><strong>UILocalize</strong></span> component with its specific <code class="literal">Key</code> to every <span class="strong"><strong>Label</strong></span> in the scene, then add a localization string for each of them in both of our <code class="literal">.txt</code> files.</p><p>Don't be afraid; it isn't that long, and it will train you to use the Localization System:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>In the <span class="strong"><strong>Hierarchy</strong></span> view, type <code class="literal">Label</code> inside the search box.</p></li><li><p>Select all the <span class="strong"><strong>Label</strong></span> GameObjects matching the search by pressing <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>A</em></span> and attach a <span class="strong"><strong>Localize</strong></span> component to the selection by navigating to <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>UI</strong></span>.</p></li><li><p>Select our <span class="strong"><strong>Label</strong></span> GameObject from <span class="strong"><strong>Title</strong></span> and remove its second <span class="strong"><strong>UILocalize</strong></span> component as it already had one!</p></li></ol></div><p>Now, all of our <span class="strong"><strong>Label</strong></span> GameObjects have a <span class="strong"><strong>UILocalize</strong></span> component attached to them. One by one, select them and set their <code class="literal">Key</code> parameter based on their text set in the <span class="strong"><strong>UILabel</strong></span> component.</p><p>You must ignore the Labels of <span class="strong"><strong>Popup List</strong></span>; they don't need a <span class="strong"><strong>UILocalize</strong></span> component since we checked their <span class="strong"><strong>Localized</strong></span> Booleans. Simply add localization strings for their <span class="strong"><strong>Options</strong></span> with the same names: <span class="strong"><strong>Normal</strong></span>, <span class="strong"><strong>Hard</strong></span>, <span class="strong"><strong>English</strong></span>, and <span class="strong"><strong>French</strong></span>.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note12"></a>Note</h3><p>Don't forget to apply the same operations to labels included in our four different powers prefabs: <span class="strong"><strong>Time</strong></span>, <span class="strong"><strong>Bomb</strong></span>, <span class="strong"><strong>SelectedTime</strong></span>, and <span class="strong"><strong>SelectedBomb</strong></span>. New lines (return) are replaced by <code class="literal">\n</code> in the localization files. Colors work identically.</p></div><p>When you're done with setting their <code class="literal">Key</code> parameters, switch to our <code class="literal">English.txt</code> file and add every key you need, plus <code class="literal">=</code> followed by the corresponding localized text.</p><p>Now, copy all of these keys declarations and paste them in our <code class="literal">French.txt</code> file and then replace the English words with French words or any other language you choose.</p><p>By the time you're finished, our entire UI will be localized!</p></div></div>