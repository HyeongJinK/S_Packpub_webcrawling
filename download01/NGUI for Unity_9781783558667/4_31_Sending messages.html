<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch04lvl1sec34"></a>Sending messages</h2></div></div><hr /></div><p>The <code class="literal">Notify</code> parameter in the <span class="strong"><strong>Inspector</strong></span> window we used in previous chapters to call methods on a precise event is usually enough for sending messages. However, you may need to send a message to another GameObject and maybe to its children too.</p><p>That's where the <span class="strong"><strong>UIButton Message</strong></span> component<a id="id224" class="indexterm"></a> comes in handy. We will use this to make our <span class="strong"><strong>MainMenu</strong></span> GameObject scale down before the game actually quits:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select our <span class="strong"><strong>Exit</strong></span> GameObject and perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Attach a <span class="strong"><strong>Button Message</strong></span> component to it by navigating to <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>Interaction</strong></span>.</p></li><li><p>Drag our <span class="strong"><strong>Container</strong></span> GameObject from <code class="literal">MainMenu</code> into its <span class="strong"><strong>Target</strong></span> field.</p></li><li><p>Type in <code class="literal">CloseMenu</code> in the <span class="strong"><strong>Function Name</strong></span> parameter.</p></li></ol></div></li><li><p>Select our <span class="strong"><strong>Container</strong></span> GameObject in <span class="strong"><strong>MainMenu</strong></span> and open its attached <code class="literal">AppearFromAbove.cs</code> script.</p></li></ol></div><p>In this script,<a id="id225" class="indexterm"></a> add a simple <code class="literal">CloseMenu()</code> method containing the following lines:</p><div class="informalexample"><pre class="programlisting">void CloseMenu()
{
  //Tween the menu's scale to zero
  TweenScale.Begin(this.gameObject, 0.5f, Vector3.zero);
}</pre></div><p>Now we need to delay the execution of the <code class="literal">Application.Quit()</code> method<a id="id226" class="indexterm"></a>, otherwise we won't see our <span class="strong"><strong>Tween</strong></span>. We do this using the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select our <span class="strong"><strong>GameManager</strong></span> GameObject and perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Open its attached <code class="literal">GameManager.cs</code> script.</p></li><li><p>Replace the line in the <code class="literal">ExitPressed()</code> method<a id="id227" class="indexterm"></a> with the following line:</p><div class="informalexample"><pre class="programlisting">//Call the exit function in 0.5s
Invoke("QuitNow", 0.5f);</pre></div></li></ol></div></li><li><p>Add a new <code class="literal">QuitNow()</code> method to actually exit the application as follows:</p><div class="informalexample"><pre class="programlisting">void QuitNow()
{
  Application.Quit();
}</pre></div><p>Save the script and click on the play button. When you exit the application, our <span class="strong"><strong>Menu</strong></span> will automatically disappear. That's because the <code class="literal">Invoke()</code> method enables us to call a function with <code class="literal">delay</code> as the second parameter.</p></li></ol></div><p>Let's add this nice scaling effect also when the player launches the game by performing the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select our <span class="strong"><strong>Play</strong></span> button GameObject and open its attached <code class="literal">LaunchValidator.cs</code> script.</p></li><li><p>We will need our <span class="strong"><strong>Container</strong></span> GameObject from <span class="strong"><strong>MainMenu</strong></span>. Declare it as follows:</p><div class="informalexample"><pre class="programlisting">public GameObject menuContainer;</pre></div></li><li><p>Go back to Unity and assign this new <span class="strong"><strong>menuContainer</strong></span> variable as follows:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select our <span class="strong"><strong>Play</strong></span> button GameObject and drag our <span class="strong"><strong>Container</strong></span> GameObject from <span class="strong"><strong>MainMenu</strong></span> to its <span class="strong"><strong>MenuContainer</strong></span> field.</p></li><li><p>Go back to our <code class="literal">LaunchValidator.cs</code> script. We simply have to replace the <code class="literal">Application.LoadLevel("Game")</code> line with the following lines:</p><div class="informalexample"><pre class="programlisting">menuContainer.SendMessage("CloseMenu");
Invoke("LaunchNow", 0.5f);</pre></div></li></ol></div></li><li><p>Ok, <a id="id228" class="indexterm"></a>now we can add a new <code class="literal">LaunchNow()</code> method to actually launch the game scene as follows:</p><div class="informalexample"><pre class="programlisting">void LaunchNow()
{
  Application.LoadLevel(levelName);
}</pre></div></li></ol></div><p>Great, on exit or game launch, the menu scales out, which makes a nicer transition. We have also learned how to use a <span class="strong"><strong>UIButton Message</strong></span> component.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note17"></a>Note</h3><p>We didn't need the <span class="strong"><strong>Include Children</strong></span> Boolean checked. But it's interesting to note that you can send a message to the target and all its children at once.</p></div></div>