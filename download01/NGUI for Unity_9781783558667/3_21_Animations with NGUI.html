<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch03lvl1sec25"></a>Animations with NGUI</h2></div></div><hr /></div><p>One great<a id="id146" class="indexterm"></a> aspect of NGUI is that you can use Unity's animation system <a id="id147" class="indexterm"></a>on any kind of widget. There also are some Tween components that let you modify most values over time, such as dimensions, color, and scale. For example, you can change an object's color from color A to color B in 5 seconds.</p><p>We have a nice main menu. But we actually have our options that are constantly displayed. That is not very user friendly.</p><p>We will use animations and tweens to hide our options and show them only when the user clicks on the <span class="strong"><strong>Options</strong></span> button. With options hidden, our menu will look as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783558667/graphics/8667OT_03_05.jpg" /></div><p>But first, let's make our powers' apparition smoother.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec42"></a>Smooth powers apparition</h3></div></div></div><p>Let's <a id="id148" class="indexterm"></a>add <span class="strong"><strong>Scale Tweens</strong></span>
<a id="id149" class="indexterm"></a> on our prefabs to make them appear smoothly by performing the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>In the Project view, select our <span class="strong"><strong>SelectedBomb</strong></span> prefab.</p></li><li><p>Attach a <span class="strong"><strong>Scale Tween</strong></span> component by navigating to <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>Tween</strong></span> and perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Set its <span class="strong"><strong>From</strong></span> parameter to {<code class="literal">0</code>, <code class="literal">0</code>, <code class="literal">0</code>,}.</p></li><li><p>Set its <span class="strong"><strong>Duration</strong></span> to <code class="literal">0.2</code>.</p></li></ol></div></li><li><p>Right-click on the <span class="strong"><strong>Tween Scale</strong></span> component and then click on <span class="strong"><strong>Copy Component</strong></span>.</p></li><li><p>Select our <span class="strong"><strong>SelectedTime</strong></span>, <span class="strong"><strong>Bomb</strong></span>, and <span class="strong"><strong>Time</strong></span> prefabs.</p></li><li><p>In the <span class="strong"><strong>Inspector</strong></span> view, right-click on any existing component name and click on <span class="strong"><strong>Paste Component As New</strong></span>.</p></li></ol></div><p>Now, as soon as these widgets are created, they scale from 0 to 1 in 0.2 seconds, which makes them appear smoothly.</p><p>We can now see how we'll hide and show options using a button.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec43"></a>Clipping to hide options</h3></div></div></div><p>First, <a id="id150" class="indexterm"></a>we have to hide our option boxes. To do that, we will use <span class="strong"><strong>Panel</strong></span> <span class="strong"><strong>Clipping</strong></span>
<a id="id151" class="indexterm"></a> and increase their width when we need to show them. Let's set up the Clipping option:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select our <span class="strong"><strong>Window</strong></span> GameObject from <span class="strong"><strong>MainMenu</strong></span> and set its <span class="strong"><strong>Dimensions</strong></span> to <code class="literal">515</code> x <code class="literal">850</code>.</p></li><li><p>Select the <span class="strong"><strong>MainMenu</strong></span> GameObject and perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Set its <span class="strong"><strong>Depth</strong></span> in <span class="strong"><strong>UIPanel</strong></span> to <code class="literal">-1</code>.</p></li><li><p>Create a new child for <span class="strong"><strong>MainMenu</strong></span> with <span class="emphasis"><em>Alt</em></span> + <span class="emphasis"><em>Shift</em></span> + <span class="emphasis"><em>N</em></span>.</p></li><li><p>Rename this new child as <code class="literal">Container</code>.</p></li></ol></div></li><li><p>Select our new <span class="strong"><strong>Container</strong></span> GameObject.</p></li><li><p>Attach a <span class="strong"><strong>Panel</strong></span> component to it by navigating to <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>UI</strong></span>. Then perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Set its <span class="strong"><strong>Depth</strong></span> to <code class="literal">0</code>.</p></li><li><p>Set its <span class="strong"><strong>Clipping</strong></span> parameter to <span class="strong"><strong>Alpha Clip</strong></span>.</p></li><li><p>Set its <span class="strong"><strong>Size</strong></span> to <code class="literal">515</code> x <code class="literal">1080</code>.</p></li></ol></div></li><li><p>Fold all the children of <span class="strong"><strong>MainMenu</strong></span> using the arrow next to each of them.</p></li><li><p>Select every child of <span class="strong"><strong>MainMenu</strong></span>, except the new <span class="strong"><strong>Container</strong></span> child, and drag them all inside our new <span class="strong"><strong>Container</strong></span> GameObject.</p></li></ol></div><p>Good, our options are now hidden. Your <span class="strong"><strong>Hierarchy</strong></span> should look as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783558667/graphics/8667OT_03_06.jpg" /></div><p>Let's add<a id="id152" class="indexterm"></a> an <span class="strong"><strong>Options</strong></span> button that will show or hide these options:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select and duplicate our <span class="strong"><strong>Play</strong></span>
<code class="literal"> </code>GameObject from <span class="strong"><strong>Buttons</strong></span> and rename this new duplicate as <code class="literal">Options</code>.</p></li><li><p>Select our new <span class="strong"><strong>Options</strong></span> GameObject from <span class="strong"><strong>Buttons</strong></span> and perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Set its <span class="strong"><strong>Side</strong></span> parameter in <span class="strong"><strong>UIAnchor</strong></span> to <span class="strong"><strong>Bottom</strong></span>.</p></li><li><p>Reset its <span class="strong"><strong>Pixel Offset</strong></span> in <span class="strong"><strong>UIAnchor</strong></span> to {<code class="literal">0</code>, <code class="literal">0</code>}.</p></li><li><p>Set its <span class="strong"><strong>Size</strong></span> in <span class="strong"><strong>Box Collider</strong></span> to {<code class="literal">140</code>, <code class="literal">40</code>, <code class="literal">0</code>}.</p></li><li><p>Remove its <span class="strong"><strong>Load Level On Click</strong></span> component.</p></li></ol></div></li><li><p>Select our <span class="strong"><strong>Background</strong></span> GameObject from <span class="strong"><strong>Options</strong></span> and set its <span class="strong"><strong>Dimensions</strong></span> to <code class="literal">140</code> x <code class="literal">40</code>.</p></li><li><p>Select our <span class="strong"><strong>Label</strong></span> GameObject from <span class="strong"><strong>Options</strong></span>:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Change its text to <code class="literal">Options</code>.</p></li><li><p>Set its <span class="strong"><strong>Overflow</strong></span> parameter to <span class="strong"><strong>Shrink Content</strong></span>.</p></li><li><p>Set its <span class="strong"><strong>Dimensions</strong></span> to <code class="literal">90</code> x <code class="literal">25</code>.</p></li></ol></div></li></ol></div><p>Ok, so now we have an <span class="strong"><strong>Options</strong></span> button. Next, we want it to enlarge our <span class="strong"><strong>Window</strong></span> and the Panel Clipping <code class="literal">width</code> of <span class="strong"><strong>Container</strong></span> when clicked. We can do this using code, but we will use tweens and animations in the following manner to see how they work:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select our <span class="strong"><strong>Window</strong></span> GameObject in <span class="strong"><strong>Container</strong></span>.</p></li><li><p>Attach a <span class="strong"><strong>Tween Width</strong></span> component to it by navigating to <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>Tween</strong></span>. Then perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Set its <span class="strong"><strong>From</strong></span> parameter to <code class="literal">515</code>.</p></li><li><p>Set its <span class="strong"><strong>To</strong></span> parameter to <code class="literal">1300</code>.</p></li><li><p>Set <span class="strong"><strong>Duration</strong></span> to <code class="literal">0.5</code>.</p></li><li><p>Reset <span class="strong"><strong>Dimensions</strong></span> to <code class="literal">515</code> x <code class="literal">850</code>.</p></li><li><p>Disable the <span class="strong"><strong>Tween Width</strong></span> component to prevent it from tweening at start.</p></li></ol></div></li></ol></div><p>We have <a id="id153" class="indexterm"></a>a <span class="strong"><strong>Tween</strong></span> component that will resize the <code class="literal">width</code> of <span class="strong"><strong>Window</strong></span> when activated. Let's use the <span class="strong"><strong>UIPlay Tween</strong></span> component to start it when the <span class="strong"><strong>Options</strong></span> button is clicked on:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select our <span class="strong"><strong>Options</strong></span> button GameObject.</p></li><li><p>Attach a <span class="strong"><strong>Play Tween</strong></span> component by navigating to <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>Interaction</strong></span>. Then perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Drag our <span class="strong"><strong>Window</strong></span> GameObject from <span class="strong"><strong>Container</strong></span> in the <span class="strong"><strong>Tween Target</strong></span> field.</p></li><li><p>Set the <span class="strong"><strong>Play</strong></span> direction to <span class="strong"><strong>Toggle</strong></span>.</p></li></ol></div></li></ol></div><p>Click on play. You will see that the window resizes as needed when <span class="strong"><strong>Options</strong></span> is clicked. However, the <span class="strong"><strong>Clipping</strong></span> parameter doesn't. Let's correct this using a Unity animation:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select our <span class="strong"><strong>Container</strong></span> GameObject from <span class="strong"><strong>MainMenu</strong></span>.</p></li><li><p>Open the <span class="strong"><strong>Animation</strong></span> window by navigating to <span class="strong"><strong>Window</strong></span> | <span class="strong"><strong>Animation</strong></span>.</p></li><li><p>Click the red record button.</p></li><li><p>Save the animation as <code class="literal">ShowOptions.anim</code> and perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Re-enter <code class="literal">515</code> for the clipping <span class="strong"><strong>X Size</strong></span> from <span class="strong"><strong>UIPanel</strong></span> to add a key.</p></li><li><p>Move the time cursor in the <span class="strong"><strong>Animation</strong></span> window to <code class="literal">0:30</code>.</p></li><li><p>Enter <code class="literal">1300</code> for the clipping <span class="strong"><strong>X Size</strong></span> from <span class="strong"><strong>UIPanel</strong></span> to add a key.</p></li><li><p>Click on the red record button again to finish.</p></li></ol></div></li><li><p>Uncheck its <span class="strong"><strong>Play Automatically</strong></span> Boolean in the <span class="strong"><strong>Animation</strong></span> component.</p></li></ol></div><p>We have our animation ready. Now, let's link the button to the animation in the following manner:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select our <span class="strong"><strong>Options</strong></span> GameObject from <span class="strong"><strong>Buttons</strong></span>.</p></li><li><p>Attach a Play Animation component to it by navigating to <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>Interaction</strong></span>. Then perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Drag our <span class="strong"><strong>Container</strong></span> GameObject from <span class="strong"><strong>MainMenu</strong></span> in the <span class="strong"><strong>Target</strong></span> field.</p></li><li><p>For the <span class="strong"><strong>Clip Name</strong></span> parameter, type in <code class="literal">ShowOptions</code>.</p></li><li><p>Set the <span class="strong"><strong>Play</strong></span> direction to <span class="strong"><strong>Toggle</strong></span>.</p></li></ol></div></li></ol></div><p>Click on play. Our window and clipping both resize perfectly in both directions when the <span class="strong"><strong>Options</strong></span> button is clicked.</p><p>But you can see that our <span class="strong"><strong>Options</strong></span> widgets aren't visible until you actually drag the main menu around;<a id="id154" class="indexterm"></a> that's because the clipping is not refreshed after the animation.</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>To solve this, we can simply force a <span class="strong"><strong>Drag at the end of the Animation</strong></span> option.</p></li><li><p>Select our <span class="strong"><strong>MainMenu</strong></span> GameObject and perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Create and add a new <code class="literal">UpdatePanel.cs</code> script to it.</p></li><li><p>Open our new <code class="literal">UpdatePanel.cs</code> script.</p></li></ol></div></li><li><p>Now, add this new <code class="literal">UpdateNow()</code> method to the script that will force a drag of (0, 0, 0) value on our <span class="strong"><strong>MainMenu</strong></span>:</p><div class="informalexample"><pre class="programlisting">public void UpdateNow()
{
  //Force a drag of {0, 0, 0} to update Panel
  GetComponent&lt;UIDraggablePanel&gt;().MoveRelative(Vector3.zero);
}</pre></div></li><li><p>Save the script and then perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select our <span class="strong"><strong>Options</strong></span> GameObject in <span class="strong"><strong>Buttons</strong></span>.</p></li><li><p>Drag our <span class="strong"><strong>MainMenu</strong></span> GameObject in the <span class="strong"><strong>Notify</strong></span> field of the <span class="strong"><strong>UIPlay Animation</strong></span> component.</p></li><li><p>Choose our new <code class="literal">UpdatePanel.UpdateNow</code> method for the <span class="strong"><strong>Method</strong></span> field.</p></li></ol></div></li><li><p>Click on the play button. The <span class="strong"><strong>Options</strong></span> boxes now appear after the animation!</p></li></ol></div><p>Great! We have used NGUI's <span class="strong"><strong>Tween</strong></span> and <span class="strong"><strong>Play Animations</strong></span> components to enhance our UI and make it nicer and more user friendly.</p></div></div>