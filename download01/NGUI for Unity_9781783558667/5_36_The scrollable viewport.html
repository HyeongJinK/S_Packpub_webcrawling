<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch05lvl1sec38"></a>The scrollable viewport</h2></div></div><hr /></div><p>We will<a id="id234" class="indexterm"></a> start by creating a clipped, draggable background, and then add linked scroll bars as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783558667/graphics/8667OT_05_02.jpg" /></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec50"></a>Draggable background</h3></div></div></div><p>We <a id="id235" class="indexterm"></a>want the player to be able to scroll on both axes. That means we need a background both larger and taller than the screen size. For this game, we will need quite a large environment to force him or her to scroll regularly. Let's create one that is twice the screen's size.</p><p>Perform the following steps to create the environment:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select our <span class="strong"><strong>Panel</strong></span> GameObject and perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Rename it as <code class="literal">Viewport</code>.</p></li><li><p>Set its <span class="strong"><strong>Clipping</strong></span> parameter to <span class="strong"><strong>Alpha Clip</strong></span>.</p></li><li><p>Set its <span class="strong"><strong>Clipping</strong></span> <span class="strong"><strong>Size</strong></span> to <code class="literal">1920</code> x <code class="literal">1080</code>.</p></li></ol></div></li><li><p>Add a <span class="strong"><strong>Draggable Panel</strong></span> component to it by navigating to <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>Interaction</strong></span> and perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Set its <span class="strong"><strong>Drag Effect</strong></span> parameter to <span class="strong"><strong>Momentum</strong></span>. We don't want the player to scroll out of bounds with the spring effect.</p></li><li><p>Set its <span class="strong"><strong>Momentum Amount</strong></span> value to <code class="literal">10</code>. Over 10, the background will continue scrolling too much on release.</p></li><li><p>Set its <span class="strong"><strong>Scale</strong></span> parameter to {<code class="literal">1</code>, <code class="literal">1</code>, <code class="literal">0</code>} to enable X and Y scrolling.</p></li></ol></div></li><li><p>Attach a <span class="strong"><strong>Drag Panel Contents</strong></span> component to it by navigating to <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>Interaction</strong></span>.</p></li><li><p>Attach a collider to it by navigating to <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>Attach a Collider</strong></span>, and set its <span class="strong"><strong>Size</strong></span> to {<code class="literal">3840</code>, <code class="literal">2160</code>, <code class="literal">1</code>}.</p></li></ol></div><p>Now that <a id="id236" class="indexterm"></a>our <span class="strong"><strong>Draggable Panel</strong></span> is set up, let's add a tiling background as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783558667/graphics/8667OT_05_03.jpg" /></div><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Open the <span class="strong"><strong>Widget Tool</strong></span> wizard by navigating to <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>Create a Widget</strong></span>. Then perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>If the <span class="strong"><strong>Atlas</strong></span> field is set to <span class="strong"><strong>None</strong></span>, drag the <span class="strong"><strong>SciFi Atlas</strong></span> prefab in it by navigating to <span class="strong"><strong>Assets</strong></span> | <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>Examples</strong></span> | <span class="strong"><strong>Atlases</strong></span>.</p></li><li><p>Select the <span class="strong"><strong>Sprite</strong></span> template.</p></li><li><p>Select the <span class="strong"><strong>Honeycomb</strong></span> sprite.</p></li><li><p>With our <span class="strong"><strong>Viewport</strong></span> selected; click on the <span class="strong"><strong>Add To</strong></span> button.</p></li></ol></div></li><li><p>Select the new <span class="strong"><strong>Sprite (Honeycomb)</strong></span> GameObject and then perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Rename it as <code class="literal">Background</code>.</p></li><li><p>Set its <span class="strong"><strong>Sprite Type</strong></span> to <span class="strong"><strong>Tiled</strong></span>.</p></li><li><p>Set its <span class="strong"><strong>Color Tint</strong></span> value to {<code class="literal">0</code>, <code class="literal">40</code>, <code class="literal">40</code>, <code class="literal">255</code>}.</p></li><li><p>Set its <span class="strong"><strong>Depth</strong></span> value to <code class="literal">0</code>.</p></li><li><p>Set its <span class="strong"><strong>Dimensions</strong></span> to <code class="literal">3840</code> x <code class="literal">2160</code>.</p></li></ol></div></li></ol></div><p>Click on the play button. That's it, we now have a scrollable viewport. You can drag the background by dragging your mouse while clicking.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec51"></a>Linking scroll bars</h3></div></div></div><p>Let's <a id="id237" class="indexterm"></a>add scroll bars to know where we are on the viewport. They must be on a separate panel rendered over our viewport, so that they won't move with the draggable background. Perform the following steps to add the scroll bars:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select our <span class="strong"><strong>Anchor</strong></span> GameObject.</p></li><li><p>Create a new child with <span class="emphasis"><em>Alt</em></span> + <span class="emphasis"><em>Shift</em></span> + <span class="emphasis"><em>N</em></span> and rename it as <code class="literal">UI</code>.</p></li><li><p>Add a <span class="strong"><strong>Panel</strong></span> component to it by navigating to <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>UI</strong></span>, and set its <span class="strong"><strong>Depth</strong></span> to <code class="literal">1</code> so that it can be displayed over the viewport.</p></li><li><p>Open the <span class="strong"><strong>Widget tool</strong></span> wizard by navigating to <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>Create a Widget</strong></span>. Then perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select <span class="strong"><strong>Scrollbar</strong></span> for the <span class="strong"><strong>Template</strong></span> field.</p></li><li><p>Select <span class="strong"><strong>Dark</strong></span> sprite as <span class="strong"><strong>Background</strong></span>.</p></li><li><p>Select <span class="strong"><strong>Highlight</strong></span> sprite as <span class="strong"><strong>Foreground</strong></span>.</p></li><li><p>Select <span class="strong"><strong>Horizontal</strong></span> for <span class="strong"><strong>Direction</strong></span>.</p></li><li><p>With our <span class="strong"><strong>UI</strong></span> GameObject selected, click on the <span class="strong"><strong>Add To</strong></span> button.</p></li></ol></div></li><li><p>On our <span class="strong"><strong>Widget Tool</strong></span> wizard window, select <span class="strong"><strong>Vertical</strong></span> for <span class="strong"><strong>Direction</strong></span>. With our <span class="strong"><strong>UI</strong></span> GameObject selected, click on the <span class="strong"><strong>Add To</strong></span> button.</p><p>We have created both our horizontal and vertical scroll bars at the center of the scene as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783558667/graphics/8667OT_05_04.jpg" /></div><p>Now, we need to place them correctly and adjust their size to fit the entire screen.</p></li><li><p>Select<a id="id238" class="indexterm"></a> the vertical <span class="strong"><strong>Scroll Bar</strong></span> GameObject and rename it as <code class="literal">VerticalScrollbar</code>.</p></li><li><p>Attach an <span class="strong"><strong>Anchor</strong></span> component to it by navigating to <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>Attach</strong></span> and perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Drag our <span class="strong"><strong>Viewport</strong></span> GameObject in the <span class="strong"><strong>Container</strong></span> field.</p></li><li><p>Set its <span class="strong"><strong>Side</strong></span> parameter to <span class="strong"><strong>TopRight</strong></span>.</p></li><li><p>Set its <span class="strong"><strong>Pixel Offset</strong></span> to {<code class="literal">-11</code>, <code class="literal">0</code>}.</p></li></ol></div></li><li><p>Select our <span class="strong"><strong>Background</strong></span> GameObject from <span class="strong"><strong>VerticalScrollbar</strong></span>. Then perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Set its <span class="strong"><strong>Color Tint</strong></span> to {<code class="literal">130</code>, <code class="literal">255</code>, <code class="literal">245</code>, <code class="literal">110</code>}.</p></li><li><p>Set the <span class="strong"><strong>Center</strong></span> coordinates of <span class="strong"><strong>Box Collider</strong></span> to {<code class="literal">0</code>, <code class="literal">-540</code>, <code class="literal">0</code>}.</p></li><li><p>Set the <span class="strong"><strong>Size</strong></span> of <span class="strong"><strong>Box Collider</strong></span> to {<code class="literal">22</code>, <code class="literal">1080</code>, <code class="literal">0</code>}.</p></li></ol></div></li><li><p>Attach a <span class="strong"><strong>Stretch</strong></span> component to it by navigating to <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>UI</strong></span>.</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Set its <span class="strong"><strong>Style</strong></span> parameter to <span class="strong"><strong>Vertical</strong></span>.</p></li><li><p>Set its <span class="strong"><strong>Relative Size</strong></span> values to {<code class="literal">1</code>, <code class="literal">0.983</code>} in order to leave space for our horizontal scroll bar at the bottom of the screen.</p></li></ol></div></li><li><p>Select the <span class="strong"><strong>Foreground</strong></span> GameObject from <span class="strong"><strong>VerticalScrollbar</strong></span>, and set its <span class="strong"><strong>Color Tint</strong></span> to {<code class="literal">0</code>, <code class="literal">255</code>, <code class="literal">128</code>, <code class="literal">255</code>}.</p><p>Our vertical scroll bar is configured. Let's do the same for the horizontal scroll bar.</p></li><li><p>Select the horizontal <span class="strong"><strong>Scroll Bar</strong></span> GameObject, and rename it as <code class="literal">HorizontalScrollbar</code>.</p></li><li><p>Attach an <span class="strong"><strong>Anchor</strong></span> component to it by navigating to <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>Attach</strong></span>. Then perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Drag our <span class="strong"><strong>Viewport</strong></span> GameObject into the <span class="strong"><strong>Container</strong></span> field.</p></li><li><p>Set its <span class="strong"><strong>Side</strong></span> parameter to <span class="strong"><strong>BottomLeft</strong></span>.</p></li><li><p>Set its <span class="strong"><strong>Pixel Offset</strong></span> to {<code class="literal">0</code>, <code class="literal">11</code>}.</p></li></ol></div></li><li><p>Select our <span class="strong"><strong>Background</strong></span> GameObject from <span class="strong"><strong>HorizontalScrollbar</strong></span> and perform these steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Set its <span class="strong"><strong>Color Tint</strong></span> to {<code class="literal">130</code>, <code class="literal">255</code>, <code class="literal">245</code>, <code class="literal">110</code>}.</p></li><li><p>Set the <span class="strong"><strong>Center</strong></span> coordinates of <span class="strong"><strong>Box Collider</strong></span> to {<code class="literal">960</code>, <code class="literal">0</code>, <code class="literal">0</code>}.</p></li><li><p>Set the <span class="strong"><strong>Size</strong></span> of <span class="strong"><strong>Box Collider</strong></span> to {<code class="literal">1920</code>, <code class="literal">22</code>, <code class="literal">0</code>}.</p></li></ol></div></li><li><p>Attach a <span class="strong"><strong>Stretch</strong></span> component to it by navigating to <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>UI</strong></span>, and set its <span class="strong"><strong>Style</strong></span> parameter to <span class="strong"><strong>Horizontal</strong></span>.</p></li><li><p>Select the <span class="strong"><strong>Foreground</strong></span> GameObject from <span class="strong"><strong>HorizontalScrollbar</strong></span>, and set its <span class="strong"><strong>Color Tint</strong></span> to {<code class="literal">0</code>, <code class="literal">255</code>, <code class="literal">128</code>, <code class="literal">255</code>}.</p></li></ol></div><p>Good. Both<a id="id239" class="indexterm"></a> our horizontal and vertical scroll bars are set up. Now, we need to assign them to our scrollable viewport by performing the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select our <span class="strong"><strong>Viewport</strong></span> GameObject.</p></li><li><p>Drag our <span class="strong"><strong>HorizontalScrollbar</strong></span> GameObject from <span class="strong"><strong>UI</strong></span> to the <span class="strong"><strong>Horizontal Scroll Bar</strong></span> field in <span class="strong"><strong>UIDraggable Panel</strong></span>.</p></li><li><p>Drag our <span class="strong"><strong>VerticalScrollbar</strong></span> GameObject from <span class="strong"><strong>UI</strong></span> to the <span class="strong"><strong>Vertical Scroll Bar</strong></span> field in <span class="strong"><strong>UIDraggable Panel</strong></span>.</p></li><li><p>Change the <span class="strong"><strong>Show Scroll Bars</strong></span> parameter to <span class="strong"><strong>Always</strong></span>.</p></li></ol></div><p>Click on the play button. That's it. Our scroll bars can be used to scroll, and they indicate where we are on the viewport as we scroll. Your hierarchy should be as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783558667/graphics/8667OT_05_05.jpg" /></div><p>Now, let's add keyboard scrolling.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec52"></a>Keyboard scrolling</h3></div></div></div><p>For this<a id="id240" class="indexterm"></a> game, scrolling with the keyboard is important. In order to do so, we will create a custom script that will force our scroll bars to move depending on the pressed key. Select our <span class="strong"><strong>Viewport</strong></span> GameObject, and attach a new <code class="literal">KeyboardScroll.cs</code> script to it. Open this new script, and declare the required variables and the <code class="literal">Awake()</code> method:</p><div class="informalexample"><pre class="programlisting">//We need the Scrollbars for keyboard scroll
UIScrollBar hScrollbar;
UIScrollBar vScrollbar;
public float keyboardSensitivity = 1;

void Awake()
{
  //Assign both scrollbars on Awake
  hScrollbar = GetComponent&lt;UIDraggablePanel&gt;().horizontalScrollBar;
  vScrollbar = GetComponent&lt;UIDraggablePanel&gt;().verticalScrollBar;
}</pre></div><p>Okay, we <a id="id241" class="indexterm"></a>have both of our scroll bars on <code class="literal">Awake()</code>, and a float value for sensitivity.</p><p>Now, let's check the horizontal and vertical input axes at each frame, and change our scroll bars' values consequently:</p><div class="informalexample"><pre class="programlisting">void Update()
{
  //Get keyboard input axes values
  Vector2 keyDelta = Vector2.zero;
  keyDelta.Set(Input.GetAxis("Horizontal"), Input.GetAxis("Vertical"));
  //If no keyboard arrow is pressed, leave
  if(keyDelta == Vector2.zero) return;
  //Make it framerate independent and multiply by sensitivity
  keyDelta *= Time.deltaTime * keyboardSensitivity;
  //Scroll by adjusting scrollbars' values
  hScrollbar.value += keyDelta.x;
  vScrollbar.value -= keyDelta.y;
}</pre></div><p>Save the script and click on the play button. You can now scroll using the keyboard arrows. You may also adjust the <span class="strong"><strong>Sensitivity</strong></span> parameter in the <span class="strong"><strong>Inspector</strong></span> window as you see fit.</p><p>Now, it's time to create draggable barriers that we can drop inside our <span class="strong"><strong>Viewport</strong></span> GameObject.</p></div></div>