<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch02lvl1sec19"></a>Toggle</h2></div></div><hr /></div><p>Now that<a id="id103" class="indexterm"></a> we<a id="id104" class="indexterm"></a> have a <a id="id105" class="indexterm"></a>volume slider, let's add an enable/disable sound checkbox, which will turn down the volume to 0 and hide our volume slider.</p><p>First, create a toggle widget as follows:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select the <span class="strong"><strong>Panel</strong></span> GameObject and create a new child with <span class="emphasis"><em>Alt</em></span> + <span class="emphasis"><em>Shift</em></span> + <span class="emphasis"><em>N</em></span>.</p></li><li><p>Rename that new child as <code class="literal">Sound</code>. It will be our sound toggle container.</p></li><li><p>Navigate to <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>Open</strong></span> | <span class="strong"><strong>Widget Wizard</strong></span> and <a id="id106" class="indexterm"></a>perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select <span class="strong"><strong>Toggle</strong></span> as <span class="strong"><strong>Template</strong></span>.</p></li><li><p>Select the <span class="strong"><strong>Dark</strong></span> Sprite as <span class="strong"><strong>Background</strong></span>.</p></li><li><p>Select the <span class="strong"><strong>X</strong></span> Sprite as <span class="strong"><strong>Checkmark</strong></span>.</p></li><li><p>With the <span class="strong"><strong>Sound</strong></span> container selected, click on the <span class="strong"><strong>Add To</strong></span> button.</p></li></ol></div></li></ol></div><p>A checkbox with a label has just been created as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783558667/graphics/8667OT_02_16.jpg" /></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec35"></a>Parameters</h3></div></div></div><p>Select our new <span class="strong"><strong>Toggle</strong></span> GameObject. Let's <a id="id107" class="indexterm"></a>look at the UIToggle's <span class="strong"><strong>Inspector</strong></span> parameters:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>
<span class="strong"><strong>Group</strong></span>: This is the toggle's group. Toggles of the same group will act as radio buttons; only one of them can be checked at once.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Start State</strong></span>: This defines in which state the toggle will be at the start.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Animation</strong></span>: This is the animation that will play when the checkbox changes state.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Sprite</strong></span>: This lets us choose the widget to be used as a checkmark; we should use our <span class="strong"><strong>X</strong></span> sprite here.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Transition</strong></span>: This is either <span class="strong"><strong>Smooth</strong></span> or <span class="strong"><strong>Instant</strong></span>; uses alpha fade in / fade out.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Notify</strong></span>: This is the GameObject to notify on when toggled. When a GameObject is assigned, you may choose a public method to call on a toggle event.</p></li></ul></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec36"></a>Creating a sound toggle</h3></div></div></div><p>We have seen the<a id="id108" class="indexterm"></a> UIToggle's parameters. Now we will create this sound toggle as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783558667/graphics/8667OT_02_17.jpg" /></div><p>Let's use our <a id="id109" class="indexterm"></a>recently added <span class="strong"><strong>Toggle</strong></span> GameObject to create the window shown here. Follow these steps to do so:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select both the <span class="strong"><strong>Background</strong></span> and <span class="strong"><strong>Label</strong></span> GameObjects from <span class="strong"><strong>Volume</strong></span> and perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Duplicate them.</p></li><li><p>Drag-and-drop those new duplicates inside our <span class="strong"><strong>Sound</strong></span> container.</p></li></ol></div></li><li><p>Select the <span class="strong"><strong>Background</strong></span> GameObject from <span class="strong"><strong>Sound</strong></span> and enter its UIAnchor's <span class="strong"><strong>Pixel Offset</strong></span> parameter as {<code class="literal">-420</code>,<code class="literal"> 43</code>}.</p></li><li><p>Select the <span class="strong"><strong>Label</strong></span> GameObject from <span class="strong"><strong>Sound</strong></span> and change its text to <code class="literal">[AAFFFF]Sound</code>.</p></li><li><p>Select the <span class="strong"><strong>Toggle</strong></span> GameObject and check the <span class="strong"><strong>Start State</strong></span> Boolean in <span class="strong"><strong>UIToggle</strong></span>.</p></li><li><p>Attach a component to it by navigating to <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>Attach</strong></span> | <span class="strong"><strong>Anchor</strong></span> and perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Drag the <span class="strong"><strong>Background</strong></span> GameObject from <span class="strong"><strong>Sound</strong></span> inside the <span class="strong"><strong>Container</strong></span> field.</p></li><li><p>Enter its <span class="strong"><strong>Pixel Offset</strong></span> parameter as {<code class="literal">-38</code>, <code class="literal">-20</code>}.</p></li></ol></div></li><li><p>Add a component to it by navigating to <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>Interaction</strong></span> | <span class="strong"><strong>Toggled Objects</strong></span>, and drag our <span class="strong"><strong>Volume</strong></span> container GameObject into the <span class="strong"><strong>Activate</strong></span> array.</p></li><li><p>Select the <span class="strong"><strong>Background</strong></span> sprite GameObject from <span class="strong"><strong>Toggle</strong></span> and perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Enter <span class="strong"><strong>Depth</strong></span> as <code class="literal">3</code>.</p></li><li><p>In the <span class="strong"><strong>Color Tint</strong></span> parameter, change <span class="strong"><strong>R</strong></span> to <code class="literal">130</code>, <span class="strong"><strong>G</strong></span> to <code class="literal">255</code>, <span class="strong"><strong>B</strong></span> to <code class="literal">130</code>, and <span class="strong"><strong>A</strong></span> to <code class="literal">255</code>.</p></li></ol></div></li><li><p>Select the <span class="strong"><strong>Checkmark</strong></span> sprite GameObject from <span class="strong"><strong>Toggle</strong></span> and perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Enter <span class="strong"><strong>Depth</strong></span> as <code class="literal">4</code>.</p></li><li><p>In the <span class="strong"><strong>Color Tint</strong></span> parameter, change <span class="strong"><strong>R</strong></span> to <code class="literal">50</code>, <span class="strong"><strong>G</strong></span> to <code class="literal">255</code>, <span class="strong"><strong>B</strong></span> to <code class="literal">70</code>, and <span class="strong"><strong>A</strong></span> to <code class="literal">255</code>.</p></li></ol></div></li><li><p>Select the <span class="strong"><strong>Label</strong></span> GameObject from <span class="strong"><strong>Toggle</strong></span> and perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Enter <span class="strong"><strong>Depth</strong></span> as <code class="literal">3</code>.</p></li><li><p>Change its text to <code class="literal">[AAFFFF]Enabled</code>.</p></li><li><p>In the <span class="strong"><strong>Color Tint</strong></span> parameter, change <span class="strong"><strong>R</strong></span> to <code class="literal">200</code>, <span class="strong"><strong>G</strong></span> to <code class="literal">255</code>, <span class="strong"><strong>B</strong></span> to <code class="literal">250</code>, and <span class="strong"><strong>A</strong></span> to <code class="literal">255</code>.</p></li></ol></div></li></ol></div><p>Hit the Play button. We have a nice <a id="id110" class="indexterm"></a>sound box with a sound toggle checkbox that hides/shows the <span class="strong"><strong>Volume</strong></span> box when needed. But it does not turn off the sound yet.</p><p>We need to make some changes to our <code class="literal">VolumeManager.cs</code> script to correct this.</p><p>First, open our <code class="literal">VolumeManager.cs</code> script. We will add a new <code class="literal">OnSoundToggle()</code> method that will be called when the toggle changes state. It will set the volume directly to 0, or to the slider's value. Add this new method to <code class="literal">VolumeManager.cs</code> as shown in the following code lines:</p><div class="informalexample"><pre class="programlisting">public void OnSoundToggle()
{
  float newVolume = 0;
  //If sound toggled ON, set new volume to slider value
  if(UIToggle.current.value)
  newVolume = slider.value;
  //Apply newVolume to volumes
  AudioListener.volume = newVolume;
  NGUITools.soundVolume = newVolume;
}</pre></div><p>Ok, the previous method will set both our volumes to <code class="literal">0</code> or the slider's value, depending on the toggle's state. Let's link it to our sound's toggle by selecting our <span class="strong"><strong>Toggle</strong></span> GameObject and dragging the <span class="strong"><strong>Slider</strong></span> GameObject from <span class="strong"><strong>Volume</strong></span> inside the <span class="strong"><strong>Notify</strong></span> field in <span class="strong"><strong>UIToggle</strong></span>, below the <span class="strong"><strong>On Value Change</strong></span> section. Then, for the <span class="strong"><strong>Method</strong></span> field, select <code class="literal">VolumeManager.OnSoundToggle</code>.</p><p>Hit the Play button. That's it. When we click on the <span class="strong"><strong>Toggle</strong></span> checkbox from <span class="strong"><strong>Volume</strong></span>, the volume reacts accordingly.</p><p>But if we turn the sound off using the toggle and stop running, when we hit Play again, the checkbox is still checked and the volume slider is displayed, but the volume is at <code class="literal">0</code>.</p><p>That's because our volume is set to 0, but the checkbox is still checked at start. Let's add a simple line of code that will set the start state to <code class="literal">false</code> if the volume is at <code class="literal">0</code>:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Open our <code class="literal">VolumeManager.cs</code> script.</p></li><li><p>Declare a new global variable named <code class="literal">public UIToggle soundToggle</code>.</p></li><li><p>At the end of the <code class="literal">Awake()</code> method, add the following lines of code:</p><div class="informalexample"><pre class="programlisting">//If volume is at 0, uncheck the Sound Checkbox
if(NGUITools.soundVolume == 0) soundToggle.value = false;</pre></div></li><li><p>Save the script and return to Unity.</p></li><li><p>Select the <span class="strong"><strong>Slider</strong></span> GameObject from <span class="strong"><strong>Volume</strong></span>.</p></li></ol></div><p>Drag the<span class="strong"><strong>Toggle</strong></span> GameObject from <span class="strong"><strong>Volume</strong></span> in the volume manager's <span class="strong"><strong>Sound Toggle</strong></span> field.</p><p>Hit the Play button. That's it.<a id="id111" class="indexterm"></a> If you disable sound using the toggle and exit the Play mode and then launch it again, the checkbox stays unchecked and the volume slider is not displayed. Perfect!</p></div></div>