<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch04lvl1sec45"></a>Building UIs in Angel Cakes</h2></div></div><hr /></div><p>Everything that we have read until now has brought us down to this moment. Now, we're ready to start building our first game. So let's get started!</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec60"></a>Scripting a UI and integrating with the collection systems</h3></div></div></div><p>It's finally time to add some UIs to our game. We will keep it simple because we talked a lot about design in the previous sections. Here, we will focus on the functionalities. After that you will have learned how to design, and how the UI system works in Unity, then you will be free to go on your own and improve the UI created in this section.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec61"></a>
Importing a new font</h3></div></div></div><p>Since we are going to display the score to the player, it's important to plan which font we will be using for it. For <span class="emphasis"><em>Angel Cakes</em></span>, to keep the style consistent, the font I chose is <strong class="userinput"><code>Century Gothic Regular</code></strong>. You can grab a free copy of it from <a class="ulink" href="http://www.911fonts.com/font/download_CenturyGothicRegular_4365.htm" target="_blank">http://www.911fonts.com/font/download_CenturyGothicRegular_4365.html</a>.</p><p>Once we have the file, it's likely to have a strange name, so my suggestion is to rename it simply <code class="literal">Century Gothic Regular</code> (of course, keeping the same file extension). Then, inside Unity, we can create a specific folder, named <code class="literal">Fonts</code>, and drag and drop our new font. From now on, we can use the font within our project.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec62"></a>Setting up the UI</h3></div></div></div><p>First of all, we need to create a canvas by right-clicking in the <strong class="userinput"><code>Hierarchy</code></strong> panel, then <strong class="userinput"><code>UI</code></strong> | <strong class="userinput"><code>Canvas</code></strong>, and naming it <code class="literal">HUD</code>. Unity should automatically create an <strong class="userinput"><code>EventSystem</code></strong>. In case it doesn't, you can manually add it by again right-clicking and then clicking <strong class="userinput"><code>UI</code></strong> | <strong class="userinput"><code>EventSystem</code></strong>. Then, we need to create a <strong class="userinput"><code>Panel</code></strong> within the <strong class="userinput"><code>Canvas</code></strong>, and we can do it similarly to how we created the <strong class="userinput"><code>Canvas</code></strong>. Among the different anchor presets, we can select the one on top, as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781786460271/graphics/e2a83472-8bb8-448d-83c1-9511628590c5.png" /></div><p>Next, resize the panel so that it occupies the upper part of the screen. In the end, you should end up with something similar to the following:</p><div class="mediaobject"><img src="/graphics/9781786460271/graphics/055306df-6f27-4527-a4e6-8479acbf9b85.png" /></div><p>If you want to be sure how the panel will appear in-game, you can switch to the game mode view. This is how the panel should appear according to our design:</p><div class="mediaobject"><img src="/graphics/9781786460271/graphics/0685fae4-3ad2-4068-a3bb-194a6c471d3a.png" /></div><p>We need to create one more thing: a label where we'll display the score to the player. So let's create a <strong class="userinput"><code>Text</code></strong>, and rename it <code class="literal">ScoreLabel</code>. Now, in the <strong class="userinput"><code>Inspector</code></strong>, we need to tweak some values of the Text Component. In particular, we want to change the font, to the one we imported before, and the font size to better fit the panel. It's important to adjust the dimensions of the box containing the text, and the anchors (in my case, I used that they stretch), and the alignment. Also, as a text we can insert the string <code class="literal">Score: 0</code>, so we can have a better idea of how it will look once the score starts to increase; don't worry much about it though because this text will be replaced by our script. Of course, feel free to change any other settings you'd like to fit your personal style and mood. These are the settings I used:</p><div class="mediaobject"><img src="/graphics/9781786460271/graphics/e32e71cd-f5ee-4422-bd9b-e6284dc4211a.png" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec63"></a>Programming the scoring system</h3></div></div></div><p>Finally, we get to get our hands dirty with a bit of code. Don't worry, it will be simple.
As usual, let's start by creating a new C# script, name it <code class="literal">UI_Score</code>, and open it up in your editor of choice.
First of all, if we want to use the UI system within a script, we need to import it in the context of our script. We can achieve that with a <code class="literal">using</code> statement at the beginning of our script, as highlighted here:</p><pre class="programlisting">
using System.Collections;
using System.Collections.Generic;
using UnityEngine;
<span class="strong"><strong>using UnityEngine.UI;</strong></span>
public class UI_Score : MonoBehaviour {
    //[…]
}</pre><p>Once we have done this, we are ready to use all the Unity UI components in our script. In fact, the first variable we need is a reference to the Text Component we created in the previous section:</p><pre class="programlisting">//Reference to the Text component, set in the Start() function
private Text uiText;</pre><p>Then, we need a variable to store the actual value of the score, and another one that stores the number of points required to pass to the next level. Please note that in this case, we used the <code class="literal">[SerializeField]</code> attribute before the private variable to still make it editable from the <strong class="userinput"><code>Inspector</code></strong>:</p><pre class="programlisting">//Current score of the player
private int score;
//Points required to the next level (set in the Inspector)
[SerializeField]
private int pointsToNextLevel;</pre><p>In a similar fashion, we need to get the reference to the <strong class="userinput"><code>Game Over Screen</code></strong>, which we will create later. Thus, we can write:</p><pre class="programlisting">//Reference to the game over screen GameObject (set in the Inspector)
[SerializeField]
private GameObject gameOverScreen;</pre><p>Then, we need to get the reference to the Text Component in the <code class="literal">Start()</code> functions, therefore it becomes:</p><pre class="programlisting">// Use this for initialization
void Start () {
<span class="strong"><strong>    //Get a reference to the Text component</strong></span>
<span class="strong"><strong>    uiText = GetComponent&lt;Text&gt;();</strong></span>
}</pre><p>Finally, we need to create a function that takes, in an input, the number of points to add to the player's score and visualize it in the UI. The function should also check whether the new score is equal to or greater than the points needed for the next level, and if so, it shows our <strong class="userinput"><code>Game Over</code></strong><strong class="userinput"><code> Screen</code></strong> and disables the player input. As a result, this is the function we need:</p><pre class="programlisting">public void IncreaseScore(int points) {
    //Increase the points
    score += points;
    //Check if the player has collected all the points to the next level
    if(score &gt;= pointsToNextLevel) {
        //If so, show the game over screen
        gameOverScreen.SetActive(true);
        //Disable the player controller, so the player cannot move while the Gameover screen is on
        FindObjectOfType&lt;PlayerController&gt;().enabled = false;
    }
    //Update the Score count
    uiText.text = "Score: " + score.ToString();
}</pre><p>And with this, we can save the script, since we have finished with this script. However, we still need to call this last function every time the player collects a cake. But before we do that, don't forget to attach this script to the <strong class="userinput"><code>ScoreLabel</code></strong>!</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec64"></a>Increasing the score when the player collects a cake</h3></div></div></div><p>Now that our UI system is set up, we need to actually call the function of the last section when the player collects a cake. To achieve this, we need to open the <code class="literal">CollectableCake</code> script from  <a class="link" href="#" linkend="ch03">Chapter 3</a>, <span class="emphasis"><em>Let's Make Some Prefabs</em></span>. If you recall, we left a To-Do which was to link the moment the player collects a cake with the UI.</p><p>In fact, we start by creating another variable (settable in the Inspector), and this time public, to store the value of the single cake. As a result, you will be able to change the value of every single cake. This is useful in case we want to add other collectable cakes, maybe that are more rare, which scores more for the player. Here is the variable declaration:</p><pre class="programlisting">//Stores the value of the cake in terms of Player's score
public int cakeValue = 1;</pre><p>Then, we need to substitute the TODO line of code with the following, so we actually call the UI script we wrote before:</p><pre class="programlisting">if (other.tag == "Player") {
<span class="strong"><strong>    //If so, increase the number of cakes the player has collected</strong></span>
<span class="strong"><strong>    FindObjectOfType&lt;UI_Score&gt;().IncreaseScore(cakeValue);</strong></span>
    //[…]
}</pre><p>And that's it. Now, let's create a <strong class="userinput"><code>Game Over</code></strong><strong class="userinput"><code> Screen</code></strong> before we tweak the last settings in the <strong class="userinput"><code>Inspector</code></strong> and finally get our first game finished!</p></div></div>