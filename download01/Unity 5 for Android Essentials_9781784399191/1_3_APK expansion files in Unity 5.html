<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch01lvl1sec09"></a>APK expansion files in Unity 5</h2></div></div><hr /></div><p>Google Play<a id="id7" class="indexterm"></a> requires that the size of your games and applications <a id="id8" class="indexterm"></a>does not exceed 50 MB. For most applications and games, this size is enough. Alternatively, you may want to have fantastic graphics for your projects and other huge media files that can take up a lot of space. Google Play makes a developer's life simpler and easier by expanding an APK file by large expansion files. Extension files are kept in a shared folder storage of the device where your game has enough access rights.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec07"></a>Overview</h3></div></div></div><p>Each file cannot be larger <a id="id9" class="indexterm"></a>than 2 GB, and you can choose any format for it. Of course, the best way is to use only compressed files in order to conserve bandwidth while the downloading process is active. You can add only one or two expansion files to your APK. Behind each expansion file lies its meaning:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>The first expansion<a id="id10" class="indexterm"></a> file is known as the <a id="id11" class="indexterm"></a>
<span class="strong"><strong>main</strong></span> and should be used for extra resources needed in your game. That's why this expansion file is primary.</p></li><li style="list-style-type: disc"><p>The second expansion file is known as <a id="id12" class="indexterm"></a>
<span class="strong"><strong>patch</strong></span>, and is required to update the <a id="id13" class="indexterm"></a>main file. That's why it is optional.</p></li></ul></div><p>You should know that the Developer Console does not allow you to update your existing APK file by uploading only a new expansion file.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec08"></a>Formats</h3></div></div></div><p>For your expansion files, you can <a id="id14" class="indexterm"></a>use any desired format, such as MP3, MP4, AVI, RAR, ZIP, DOC, and PDF. The JOBB tool can help you encapsulate and encrypt your resources and patches for them.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec09"></a>The updating process</h3></div></div></div><p>In most cases, Google Play <a id="id15" class="indexterm"></a>will do all jobs automatically for you. So, very often, you don't need to do anything while users will download or upload your expansion files on their devices. However, sometimes your game has to download these files itself by receiving a URL from Google Play's application licensing service.</p><p>The basic steps<a id="id16" class="indexterm"></a> to download expansion files for your game are listed as follows:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>On the game start event, you should look for the expansion files in the <code class="literal">Android/obb/&lt;package-name&gt;/ directory</code>.</p></li><li><p>In the first step, if you will find that your expansion files are already in that directory, then you can continue playing your game further.</p></li><li><p>In the event that the expansion files are not in that directory, you should perform the next two steps.</p></li><li><p>You have to receive URLs, names, and sizes for your game's expansion files. Before downloading anything, you should know where and what to download.</p></li><li><p>After having all the required information to download the expansion files, you can get your files and put them into the <code class="literal">Android/obb/&lt;package-name&gt;/</code> directory with the same name as Google Play told you.</p></li></ol></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note02"></a>Note</h3><p>The following notes that are listed are taken from the official Android Developers Documentation page<a id="id17" class="indexterm"></a> at <a class="ulink" href="http://developer.android.com/google/play/expansion-files.html" target="_blank">http://developer.android.com/google/play/expansion-files.html</a>:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>The URL that Google Play provides for your expansion files is unique for every download, and each one expires shortly after it is given to your application.</p></li><li style="list-style-type: disc"><p>Whether your application is free or not, Google Play returns the expansion file URLs only if the user acquired your application from Google Play.</p></li><li style="list-style-type: disc"><p>A variety of errors may occur during the request and download that you must gracefully handle.</p></li><li style="list-style-type: disc"><p>Network connectivity can change during the download, so you should handle such changes. If interrupted, resume the download when possible.</p></li><li style="list-style-type: disc"><p>While the download occurs in the background, you should provide a notification that indicates the download progress, notifies the user when it's done, and takes the user back to your application when selected.</p></li></ul></div></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec10"></a>Setting up expansion files in Unity 5</h3></div></div></div><p>Navigate to the<a id="id18" class="indexterm"></a> <span class="strong"><strong>Player Settings</strong></span> | <span class="strong"><strong>Publishing Settings</strong></span> menu, and at the bottom you will see an option called <span class="strong"><strong>Split Application Binary</strong></span>. When this option is enabled, your project will be divided into the <code class="literal">.apk </code>file for code, and for all other assets and data, it will be the <code class="literal">.obb</code> file.</p><p>Let's look at a list of key aspects related to the loading of the expansion files (<code class="literal">.obb</code>):</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>The expansion files do not need to be uploaded to the server Google Play.</p></li><li style="list-style-type: disc"><p>If you have decided to publish <code class="literal">.apk</code> and <code class="literal">.obb</code> files on Google Play, then you need to include the code to download the expansion files.</p></li><li style="list-style-type: disc"><p>In the Unity<a id="id19" class="indexterm"></a> Asset Store, you can find a great plugin for downloading and extracting your expansion files in the right location. The <a id="id20" class="indexterm"></a>URL of this plugin is <a class="ulink" href="http://u3d.as/content/unity-technologies/google-play-obb-downloader/2Qq" target="_blank">http://u3d.as/content/unity-technologies/google-play-obb-downloader/2Qq</a>.</p></li><li style="list-style-type: disc"><p>Before testing the .<code class="literal">obb</code> files, you need to be logged in your Google account.</p></li></ul></div></div></div>