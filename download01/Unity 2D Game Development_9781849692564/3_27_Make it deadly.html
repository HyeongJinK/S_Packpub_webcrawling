<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch03lvl1sec31"></a>Make it deadly</h2></div></div><hr /></div><p>As you may have noticed, walking into the enemy currently just messes with the player's collision system. In fact, that's a little ugly; so, let's clean it up. All that we need to do here is create a <a id="id119" class="indexterm"></a>
<span class="strong"><strong>collision mask</strong></span>. Start by going to the <span class="strong"><strong>Tags &amp; Layers</strong></span> panel of Unity, just like you did before, and add a layer for both player and enemy. Set the layer on the player to be <code class="literal">Player</code> and the layer on the enemy to be... you guessed it, <code class="literal">Enemy</code>. When you apply the layer to either object, it will ask if you want to apply to the child objects—go ahead and say <span class="strong"><strong>Yes</strong></span>.</p><p>With the proper layers specified on the objects, we need to set the Layer Masking. Go to <span class="strong"><strong>Edit</strong></span> | <span class="strong"><strong>Project Settings</strong></span> | <span class="strong"><strong>Physics 2D</strong></span> and set the checkboxes so that <span class="strong"><strong>Player</strong></span> and <span class="strong"><strong>Enemy</strong></span> do not collide with each other, as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781849692564/graphics/2564OT_03_02.jpg" /></div><p>Now when the <a id="id120" class="indexterm"></a>player runs over the enemy, there will no longer be any weird hiccups in the<a id="id121" class="indexterm"></a> player's or enemy's movements. With that cleaned up, let's now make the player die when it comes in contact with an enemy. For this, we are going to create another empty GameObject with a Box Collider 2D component attached. We will use another collider here so that each collider has a very specific job with very specific collision requirements. It's actually somewhat rare that the same collider can be used for multiple things simply because their positioning and sizing needs to be different. I can say from the experience of working on two entirely separate "Beat 'em up" games that each enemy usually has between three to five unique collision areas such as feet rectangle, defense rectangle, and attack rectangle..</p><p>Thankfully, Unity makes all this collision madness very simple. Name that empty GameObject <code class="literal">Defense Collider</code> and make it a child of the <span class="strong"><strong>Enemy</strong></span> object at position <code class="literal">X: 0</code>, <code class="literal">Y: 0.29</code>. Resize the Box Collider 2D component so that it is about a quarter of the size of the whole <span class="strong"><strong>Enemy</strong></span> object, with a <span class="strong"><strong>Size</strong></span> of <code class="literal">X:0.58</code>, <code class="literal">Y: 0.55</code>. The idea here is that the player should be able to collide with the enemy, but if it's too precise, the game becomes far too difficult. So, give a proper defensive collision range on the enemy to allow the player some leeway to escape; refer to the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781849692564/graphics/2564OT_03_05.jpg" /></div><p>Let's add a <a id="id122" class="indexterm"></a>new script that tells the enemy's <span class="strong"><strong>Defense Collider</strong></span> GameObject to<a id="id123" class="indexterm"></a> kill the player on touching. Wait, we already have one of those! The beauty of Unity is that it allows us to reuse scripts in surprising places. Make sure that the box collider on the <span class="strong"><strong>Defense Collider</strong></span> object has its <span class="strong"><strong>Is Trigger</strong></span> checkbox ticked, and then add the existing <code class="literal">DeathTriggerScript</code> to the <span class="strong"><strong>Defense Collider</strong></span> object. Set the <span class="strong"><strong>Script</strong></span> field in the <span class="strong"><strong>Inspector</strong></span> panel of <span class="strong"><strong>Defense Collider</strong></span> to <code class="literal">DeathTriggerScript</code>, and make sure that the <span class="strong"><strong>Layer</strong></span> drop-down menu is set to <span class="strong"><strong>Default</strong></span>.</p><p>You may remember that we just set up the enemy and player's physics layering to mask out these collisions. Just make sure that the <span class="strong"><strong>Defense Collider</strong></span> object has a <span class="strong"><strong>Default</strong></span> layer and it will accept collisions with the player, while the rest of the enemies continue to ignore one another—which is exactly what you want.</p><p>Now, play the game and run head-first into the enemy. What happened? The player just died and respawned at the spawn point! Yup, it really is that easy to make 2D games work in Unity.</p><p>You may notice that the message <span class="strong"><strong>hitDeathTrigger has no receiver!</strong></span> is showing up in the console. If you do, very good, you've got your console open! The console keeps you up to date about errors, warnings, and messages—you should be watching it all the time. If you aren't watching it, now would be a great time to open it up. But how do we fix this issue? Easy; the message is showing up because now there are colliders on the player that are hitting the death trigger. Let's just tell the death trigger that we don't care if a receiver is there or not. Open up <code class="literal">DeathTriggerScript</code> and replace the <code class="literal">SendMessage</code> line with the following line of code:</p><div class="informalexample"><pre class="programlisting">collidedObject.SendMessage("hitDeathTrigger",SendMessageOptions.DontRequireReceiver);</pre></div><p>Play again and everything works without errors!</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip11"></a>Tip</h3><p>
<span class="strong"><strong>Pro tip</strong></span>
</p><p>Learn your event listeners and delegates! It would be quite easy to make all the enemies laugh at the player whenever the player gets killed. In fact, give it a shot! Add an event and event delegate object to the player, and then add an event listener to the enemy that listens for when the player gets killed. Make the enemies laugh like the bad guys they are!</p></div></div>