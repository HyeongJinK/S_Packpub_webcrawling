<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch05lvl1sec43"></a>Crushing defeat</h2></div></div><hr /></div><p>We're almost done! The boss <a id="id158" class="indexterm"></a>needs to be able to actually kill the player, rather than the current action where it just makes the player jiggle around a bit. In fact, when the boss drops on enemies, even they jiggle around a bit. Let's make it such that the boss crushes anything that he lands on.</p><p>The boss should only be able to kill the player and enemies by squishing them when he falls. To support this, create a new empty GameObject, call it <code class="literal">Boss Crush Zone</code>, and make it a child of the <span class="strong"><strong>Boss</strong></span> object. Give it a <span class="strong"><strong>Box Collider 2D</strong></span> component, and make it such that its size covers the bottom portion of the boss by setting its <span class="strong"><strong>Transform</strong></span> position as <code class="literal">X: 0</code>, <code class="literal">Y: -0.175</code>, the <span class="strong"><strong>Size</strong></span> fields to <code class="literal">X: 3.74</code>, <code class="literal">Y: 0.2</code>, and set the <span class="strong"><strong>Center</strong></span> to <code class="literal">X: 0</code>, <code class="literal">Y: 0.09</code>. It should now be aligned at the bottom-center, as shown in the following image:</p><div class="mediaobject"><img src="/graphics/9781849692564/graphics/2564_05_05.jpg" /></div><p>Create a new script <a id="id159" class="indexterm"></a>called <code class="literal">BossCrushTrigger</code>, attach it to the <code class="literal">Boss Crush Zone</code> object, and code it up as shown in the following code:</p><div class="informalexample"><pre class="programlisting">using UnityEngine;
using System.Collections;

public class BossCrushTrigger : MonoBehaviour
{
  public BossEventController bossController;

  void OnTriggerEnter2D( Collider2D collidedObject )
  {
    if(bossController.currentEvent !=BossEventController.bossEvents.fallingToNode)
      return;

    if(collidedObject.tag == "Player")
      collidedObject.SendMessage("hitByCrusher");
  }
}</pre></div><p>Note that we <a id="id160" class="indexterm"></a>checked the object's tag to see whether it's the player or not. Since we now have different types of objects colliding with one another, we need a way to test these collisions. Sure, we can keep setting up collision layers, but tags can be handy too. Perhaps, you have a field of flowers, which are all the same object, but you want only one of them to be pickable. You could give that one flower a <code class="literal">Pickable</code> tag. Pretty handy, eh? So, make sure that the tag of the <code class="literal">Player</code> object is set to <code class="literal">Player</code>. The <code class="literal">Player</code> tag is added by default to a new project, so you don't have to worry about adding it.</p><p>Oh, and don't forget to populate the <span class="strong"><strong>Boss Controller</strong></span> field on the <span class="strong"><strong>Boss Crush Zone</strong></span> object. Next, modify <code class="literal">PlayerStateListener</code> to listen for the <code class="literal">hitByCrusher</code> message. Add the following function anywhere you want in <code class="literal">PlayerStateListener</code>:</p><div class="informalexample"><pre class="programlisting">public void hitByCrusher()
{
  onStateChange(PlayerStateController.playerStates.kill);
}</pre></div><p>Now, whenever the boss lands on the player, the player will get killed; however, not when the boss collides with the player in other ways! As always, feel free to change and improve on the code as you desire. Note that enemies give the player points when they are defeated, but you won't want the boss crushing the enemy to earn the player points. Take a stab at working through the code to make that happen on your own. If you get stuck, take a look at what we did in the example project.</p></div>