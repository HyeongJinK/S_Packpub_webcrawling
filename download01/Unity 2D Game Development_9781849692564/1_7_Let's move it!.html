<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch01lvl1sec13"></a>Let's move it!</h2></div></div><hr /></div><p>With the player sprite in the world, let's set up some animations<a id="id42" class="indexterm"></a> for it. From the sprite sheet, you can probably gather that our player has two animations: idle and walking. If you are at all familiar with Unity's <a id="id43" class="indexterm"></a>Mecanim system, then this setup will seem familiar to you. If not, no problem—read along and we shall explain in the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Create a new folder in the <span class="strong"><strong>Project</strong></span> tab called <code class="literal">Animations</code>.</p></li><li><p>Inside this folder, create another folder called <code class="literal">Player</code>. </p></li><li><p>At the top of the screen, navigate to <span class="strong"><strong>Window</strong></span> | <span class="strong"><strong>Animation</strong></span> to open the <span class="strong"><strong>Animation</strong></span> tab. This is where we will actually build the sprite animations.</p></li><li><p>Select the player object in the <span class="strong"><strong>Hierarchy</strong></span> tab then click on the little red circle (the record button) in the top-left corner of the <span class="strong"><strong>Animation</strong></span> tab. A <span class="strong"><strong>Create New Animation</strong></span> window will pop up.</p></li><li><p>Select the newly created <code class="literal">Animations/Player</code> folder, name the animation <code class="literal">PlayerIdleAnimation</code>, and click on <span class="strong"><strong>Save</strong></span>.</p></li></ol></div><p>You now have a <a id="id44" class="indexterm"></a>blank animation, and you'll notice that a few other changes occurred as well. First off, in the <code class="literal">Animations</code>/<code class="literal">Player</code> folder, there is now a <code class="literal">Player</code> object along with <code class="literal">PlayerIdleAnimation</code>. This player object is actually an Animator Controller object, which Mecanim uses to know how to animate something; sort of like a description of dance steps. It is essentially a tree of animations, with certain requirements that are met to switch between different animations. We'll discuss that further in a little bit, but to keep things organized, rename the player animator object to <code class="literal">PlayerAnimatorController</code>. Now it's clear what it is.</p><p>When you click on the player object in the scene <span class="strong"><strong>Hierarchy</strong></span> tab, you'll see that an <code class="literal">Animator</code> component has already been attached and the <span class="strong"><strong>Controller</strong></span> field uses <code class="literal">PlayerAnimatorController</code>. This <code class="literal">Animator</code> component<a id="id45" class="indexterm"></a> does all the actual animation-changing work for the sprite's animations and uses the Animator Controller fed to it as the guidelines on how to animate.</p><p>In the <span class="strong"><strong>Animation</strong></span> tab, you'll now see that <code class="literal">PlayerIdleAnimation</code> is open. If it's not, click on the player object in the <span class="strong"><strong>Hierarchy</strong></span> tab and <code class="literal">PlayerIdleAnimation</code> should automatically open.</p><p>Make sure the <span class="strong"><strong>Dope Sheet</strong></span> button, which you can see circled in the following screenshot, is clicked on at the bottom of the <span class="strong"><strong>Animation</strong></span> tab:</p><div class="mediaobject"><img src="/graphics/9781849692564/graphics/2564OT_01_16.jpg" /></div><p>The next part is <a id="id46" class="indexterm"></a>really easy—to build the animation. All you have to do is drag and drop each sprite into it. Start by dropping the <code class="literal">playerSprite_idle_1</code> sprite. You'll see that the sprite image appears in the dope sheet, along with a diamond above it. This diamond represents the position on the timeline that the sprite is displayed. Now add <code class="literal">playerSprite_idle_2</code> and align its diamond to be two hash lines after the first. Keep doing this until all four sprites have been added. Your <code class="literal">PlayerIdleAnimation</code> should now look like the following screenshot. If you have a lot of frames, you can also just drag them all at once by selecting them all in the <span class="strong"><strong>Project</strong></span> tab and then dragging them over.</p><div class="mediaobject"><img src="/graphics/9781849692564/graphics/2564OT_01_08.jpg" /></div><p>Clicking on the <span class="strong"><strong>Play</strong></span> <a id="id47" class="indexterm"></a>button in the <span class="strong"><strong>Animation</strong></span> tab will now play the sprite animation on the player object; it looks pretty good, except that it snaps back to the beginning. To fix this, simply add three additional sprites to the animation after the first sprites—add <code class="literal">playerSprite_idle_3</code>, <code class="literal">playerSprite_idle_2</code>, and <code class="literal">playerSprite_idle_1</code> sequentially at the end.</p><p>What this does is it now allows the animation to play so that the robot hovers up and back down, and then the animation loops back to the beginning. Play the animation again now and it should animate just fine.</p><p>We can adjust one more item here—the <span class="strong"><strong>Samples</strong></span> setting. This is essentially how many times the animation is sampled per second, which affects the frame rate and smoothness of the animation. Since we have already built the animation at the default value of 60 samples, we don't really have to go back and move things around; Unity will do that for us. Go ahead and set <span class="strong"><strong>Samples</strong></span> to <code class="literal">125</code> to speed up the animation and then click on <span class="strong"><strong>Play</strong></span>. Much smoother!</p><p>With the idle animation completed, go ahead and create the walking animation. To do this, make sure you have the player object selected in the <span class="strong"><strong>Hierarchy</strong></span> tab, and in the <span class="strong"><strong>Animation</strong></span> tab, click on <span class="strong"><strong>PlayerIdleAnimation</strong></span>. As displayed in the following screenshot, this is actually a dropdown that contains the <span class="strong"><strong>Create New Clip</strong></span> option— select that and create a new clip in <code class="literal">Animations/Player</code> called <code class="literal">PlayerWalkingAnimation</code>.</p><div class="mediaobject"><img src="/graphics/9781849692564/graphics/2564OT_01_09.jpg" /></div><p>Just like before, <a id="id48" class="indexterm"></a>place the sprites in the dope sheet so that the walking animation looks and plays properly. We'll let you do this one on your own for practice; however, you can use the following screenshot as a reference if you get stuck. Note that we set this animation to <code class="literal">80</code>. That's because visually it animates better than 125 and is a great example of how every animation can have its own sampling rate!</p><div class="mediaobject"><img src="/graphics/9781849692564/graphics/2564OT_01_10.jpg" /></div><p>Excellent! We now have a pair of animations for our player object to use. Now, we need to set up that animator object so that Mecanim knows how to actually make use of the animations. Start by selecting the <code class="literal">PlayerAnimatorController</code> object in the <code class="literal">Animations/Player</code> folder. If you take a look at the inspector, it looks completely empty, except in the top-right corner. There's a small <span class="strong"><strong>Open</strong></span> button. Click on it to open the <a id="id49" class="indexterm"></a>
<span class="strong"><strong>Animator Editor</strong></span> tab. You should now be looking at a window that looks like the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781849692564/graphics/2564OT_01_11.jpg" /></div><p>As we previously <a id="id50" class="indexterm"></a>mentioned, Mecanim reads the animator trees to know how to play the animations. What we need to do here is build an animation tree. Unity was nice enough to already add both our animations to the animator for us—we just need to tell them when to play. To handle this, we will use a simple Boolean check.</p><p>At the bottom left, look for the <span class="strong"><strong>Parameters</strong></span> window. Click on the small <span class="strong"><strong>+</strong></span> button on that window and you will see a list of variable types. Choose <span class="strong"><strong>Bool</strong></span> and a <code class="literal">New Bool</code> variable will be created. Name this <code class="literal">Walking</code>. To determine if Mecanim should play the idle or walking animation, we will use the <code class="literal">Walking</code> Boolean.</p><p>The orange-colored <a id="id51" class="indexterm"></a>state is the default animation and the default state in the animator tree. Right-click on the orange-colored <code class="literal">PlayerIdleAnimation</code> node in the <span class="strong"><strong>Animator</strong></span> tab and select <span class="strong"><strong>Make Transition</strong></span>. This will attach the translation line to the cursor. Move your cursor over <span class="strong"><strong>PlayerWalkingAnimation</strong></span> and click on it to drop it there. Now do the same thing, only in reverse—create a transition from <code class="literal">PlayerWalkingAnimation</code> to <code class="literal">PlayerIdleAnimation</code>. Your animator node tree should now look something like the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781849692564/graphics/2564OT_01_12.jpg" /></div><p>If you were to click on <span class="strong"><strong>Play</strong></span> on the game now, you'll see that the animations play on the <code class="literal">Player</code> object; however, it plays the idle animation, then immediately plays the walk animation, then loops back to idle, and repeats ad nauseam. Almost there!</p><p>Let's now give those<a id="id52" class="indexterm"></a> transition connects some information on how to act so that rather than playing in a loop, they actually play when we want them to. Click on <span class="strong"><strong>PlayerIdleAnimation</strong></span>, then click on the transition, and then look over in the inspector. The transition has some simple data that it uses to know when to go to the connected animation. In this case, the animation simply waits until the time has reached 1 second, then goes to the next animation––which is why this condition is specified as <span class="strong"><strong>Exit Time</strong></span> with the property of <span class="strong"><strong>1.00</strong></span>. Let's change this to use our <span class="strong"><strong>Boolean Walking</strong></span> state instead. The <span class="strong"><strong>Exit Time</strong></span> condition is good when you wish to blend two animations; however, for the sake of this animation, it will simply play or not play; therefore, Boolean. Click on <span class="strong"><strong>Exit Time</strong></span> to reveal it as a pop up. The <span class="strong"><strong>Walking</strong></span> Boolean has already been listed for us; click on that. All you need to do now is make sure that the transition going into <code class="literal">PlayerWalkingAnimation</code> has <code class="literal">True</code> as the <span class="strong"><strong>Walking</strong></span> condition, and the transition going into <code class="literal">PlayerIdleAnimation</code> has <code class="literal">False</code> as the <span class="strong"><strong>Walking</strong></span> condition. The following screenshot shows what the animation should now look like:</p><div class="mediaobject"><img src="/graphics/9781849692564/graphics/2564OT_01_17.jpg" /></div><p>With that completed, we can go ahead and test! Perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Hit <span class="strong"><strong>Play</strong></span> in the game.</p></li><li><p>With the game running, select the <code class="literal">Player</code> object. </p></li><li><p>In the <span class="strong"><strong>Animator</strong></span> tab, select the checkbox next to <span class="strong"><strong>Walking</strong></span> under <span class="strong"><strong>Parameters</strong></span>.</p></li></ol></div><p>When the checkbox is active, the walking animation will play, whereas when the checkbox is inactive, the <a id="id53" class="indexterm"></a>idle animation will play. It really is as simple as that.</p></div>