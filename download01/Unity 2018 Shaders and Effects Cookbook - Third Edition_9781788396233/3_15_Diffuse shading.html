<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch03lvl1sec22"></a>Diffuse shading</h2></div></div><hr /></div><p>Before starting our journey <span>into</span><a id="id325209443" class="indexterm"></a> texture mapping, it is important to understand how diffuse materials work. Certain objects might have a uniform color and smooth surface, but are not smooth enough to shine in reflected light. These matte materials are best represented with a Diffuse Shader. While, in the real world pure diffuse materials do not exist, Diffuse Shaders are relatively cheap to implement and are largely applied in games with low-poly aesthetics, so they're worth learning about.</p><p>There are several ways in which you can <span>create</span><a id="id325209453" class="indexterm"></a> your own Diffuse Shader. A quick way is to start with Unity's Standard Surface Shader and edit it to remove any additional texture information.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec34"></a>Getting ready</h3></div></div></div><p>Before starting this recipe, you should have created a Standard Surface Shader with the name <code class="literal">SimpleDiffuse</code>. For instructions on creating a Standard Surface Shader, look at the <span class="emphasis"><em>Creating a basic Standard Surface Shader</em></span> recipe located in  <a class="link" href="#" linkend="ch02"><span>Chapter 2</span></a>, <span class="emphasis"><em>Creating Your First Shader, </em></span>if you haven't done so already.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec35"></a>How to do it...</h3></div></div></div><p>Open up the <code class="literal">SimpleDiffuse</code> shader you've created and make the following changes: </p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>In the <code class="literal">Properties</code> section, remove all of the variables except for  <code class="literal">_Color</code>:</li></ol></div><pre class="programlisting">  Properties 
  {
    _Color ("Color", Color) = (1,1,1,1)
  }</pre><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>From the <code class="literal">SubShader{}</code> section, remove the <code class="literal">_MainTex</code>, <code class="literal">_Glossiness</code>, and <code class="literal">_Metallic</code> variables. You should not remove the reference to <code class="literal">uv_MainTex</code> as Cg does not allow the <code class="literal">Input</code> struct to be empty. The value will simply be ignored.</li><li>Also, remove the <code class="literal">UNITY_INSTANCING_BUFFER_START/END</code> macros and the comments used with them.</li></ol></div><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>Remove the content of the <code class="literal">surf()</code> function and replace it with the following:</li></ol></div><pre class="programlisting">void surf (Input IN, inout SurfaceOutputStandard o) 
{
  o.Albedo = _Color.rgb; 
}</pre><div class="orderedlist"><ol class="orderedlist arabic" start="5" type="1"><li>Your shader <span>should</span><a id="id325209597" class="indexterm"></a> look as follows:</li></ol></div><pre class="programlisting">Shader "CookbookShaders/Chapter03/SimpleDiffuse" {
  Properties 
  {
    _Color ("Color", Color) = (1,1,1,1)
  }
  SubShader 
  {
    Tags { "RenderType"="Opaque" }
    LOD 200

    CGPROGRAM
    // Physically based Standard lighting model, and enable shadows on all light types
    #pragma surface surf Standard fullforwardshadows

    // Use shader model 3.0 target, to get nicer looking lighting
    #pragma target 3.0


    struct Input 
    {
      float2 uv_MainTex;
    };

    fixed4 _Color;

    void surf (Input IN, inout SurfaceOutputStandard o) 
    {
      o.Albedo = _Color.rgb; 
    }

    ENDCG
  }
  FallBack "Diffuse"
}</pre><p></p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip25"></a>Note</h3><p>The two lines below <code class="literal">CGPROGRAM</code> is actually one line and is cut off due to the size of the book.</p></div><div class="orderedlist"><ol class="orderedlist arabic" start="6" type="1"><li>As this shader has been refitted with a Standard Shader, it will use physically-based rendering to simulate how light behaves on your models.</li></ol></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip26"></a>Note</h3><p><span>If</span> you are trying to achieve a non-photorealistic look, you can change the first <code class="literal">#pragma</code> directive so that it uses <code class="literal">Lambert</code> rather than <code class="literal">Standard</code>. If you do so, you should also replace the  <code class="literal">SurfaceOutputStandard</code> parameter of the <code class="literal">surf</code> function with <code class="literal">SurfaceOutput</code>. For more information on this and the other lighting models that Unity supports, Jordan Stevens put together a very nice article about it, which you can see here: <a class="ulink" href="http://www.jordanstevenstechart.com/lighting-models" target="_blank">http://www.jordanstevenstechart.com/lighting-models</a></p></div><div class="orderedlist"><ol class="orderedlist arabic" start="7" type="1"><li>Save the shader and dive back into Unity. Using the <span>same</span><a id="id325453450" class="indexterm"></a> instructions <span>as</span><a id="id325453459" class="indexterm"></a> in the <span class="emphasis"><em>Creating a basic Standard Surface Shader</em></span> recipe located in  <a class="link" href="#" linkend="ch02"><span>Chapter 2</span></a>, <span class="emphasis"><em>Creating Your First Shader,</em></span> create a new material called <code class="literal">SimpleDiffuseMat</code> and apply our newly created shader to it. Change the color to something different, such as red, by clicking on the window next to the <strong class="userinput"><code>Color</code></strong> property in the <strong class="userinput"><code>Inspector</code></strong> window while selected.</li><li>Then, go into the <code class="literal">Models</code> folder of this book's example code and bring the bunny object into our scene by dragging and dropping it from the <strong class="userinput"><code>Project</code></strong> window into the <strong class="userinput"><code>Hierarchy</code></strong> window. From there, assign the <code class="literal">SimpleDiffuseMat</code> material to the object:</li></ol></div><div class="mediaobject"><img src="/graphics/9781788396233/graphics/e6927ef0-a13b-41ff-b06d-3d1cd67cfd8d.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="9" type="1"><li>You can double-click on an object in the <strong class="userinput"><code>Hierarchy</code></strong> tab in order to center the camera on the object that's been selected.</li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec36"></a>How it works...</h3></div></div></div><p>The way shaders allow you to communicate the <span>rendering</span><a id="id325453532" class="indexterm"></a> properties of your material to their lighting model is via their <code class="literal">SurfaceOutput</code>. It is basically a wrapper around all the parameters that the current lighting model needs. It should not surprise you that different lighting models have different <code class="literal">SurfaceOutput</code> structs. The following table shows the three main output structs used in Unity and how they can be used:</p><div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; "><colgroup><col /><col /><col /></colgroup><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>Type of shaders</strong></span></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong><span>Standard</span></strong></span></p></td><td style="border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>Physically-Based Lighting Models</strong></span></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Diffuse</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Any Surface Shader</p><p><code class="literal">SurfaceOutput</code></p></td><td style="border-bottom: 0.5pt solid ; "><p><strong class="userinput"><code>Standard</code></strong></p><p><code class="literal">SurfaceOutputStandard</code></p></td></tr><tr><td style="border-right: 0.5pt solid ; "><p>Specular</p></td><td style="border-right: 0.5pt solid ; "><p>Any Surface Shader</p><p><code class="literal">SurfaceOutput</code></p></td><td style=""><p><strong class="userinput"><code>Standard (Specular setup)</code></strong></p><p><code class="literal">SurfaceOutputStandardSpecular</code></p></td></tr></tbody></table></div><p> </p><p>The <code class="literal">SurfaceOutput</code> struct has the following properties:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><code class="literal">fixed3 Albedo;</code>: This is the diffuse color of the material</li><li style="list-style-type: disc"><code class="literal">fixed3 Normal;</code>: This is the tangent space, normal, if written</li><li style="list-style-type: disc"><code class="literal">fixed3 Emission;</code>: This is the color of the light emitted by the material (this property is declared as <code class="literal">half3</code> in the Standard Shaders)</li><li style="list-style-type: disc"><code class="literal">fixed Alpha;</code>: This is the transparency of the material</li><li style="list-style-type: disc"><code class="literal">half Specular;</code>: This is the specular power from <code class="literal">0</code> to <code class="literal">1</code></li><li style="list-style-type: disc"><code class="literal">fixed Gloss;</code>: This is the specular intensity</li></ul></div><p>The <code class="literal">SurfaceOutputStandard</code> struct has the following <span>properties:</span></p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><code class="literal">fixed3 Albedo;</code>: This is the base color of the material (whether it's diffuse or specular)</li><li style="list-style-type: disc"><code class="literal">fixed3 Normal;</code></li><li style="list-style-type: disc"><code class="literal">half3 Emission;</code>: This property is declared as <code class="literal">half3</code>, while it was defined as <code class="literal">fixed3</code> in <code class="literal">SurfaceOutput</code></li><li style="list-style-type: disc"><code class="literal">fixed Alpha;</code></li><li style="list-style-type: disc"><code class="literal">half Occlusion;</code>: This is the occlusion (default <code class="literal">1</code>)</li><li style="list-style-type: disc"><code class="literal">half Smoothness;</code>: This is the smoothness (<code class="literal">0</code> = rough, <code class="literal">1</code> = smooth)</li><li style="list-style-type: disc"><code class="literal">half Metallic;</code>: <code class="literal">0</code> = non-metal, <code class="literal">1</code>= metal</li></ul></div><p>The <code class="literal">SurfaceOutputStandardSpecular</code> struct has the following <span>properties:</span></p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><code class="literal">fixed3 Albedo;</code></li><li style="list-style-type: disc"><code class="literal">fixed3 Normal;</code></li><li style="list-style-type: disc"><code class="literal">half3 Emission;</code></li><li style="list-style-type: disc"><code class="literal">fixed Alpha;</code></li><li style="list-style-type: disc"><code class="literal">half Occlusion;</code></li><li style="list-style-type: disc"><code class="literal">half Smoothness;</code></li><li style="list-style-type: disc"><code class="literal">fixed3 Specular;</code>: This is the specular color. This is very different from the <code class="literal">Specular</code> property in <code class="literal">SurfaceOutput</code> as it allows you to specify a color rather than a single value.</li></ul></div><p>Using a Surface Shader correctly is a <span>matter</span><a id="id325453827" class="indexterm"></a> of <span>initializing</span><a id="id325453835" class="indexterm"></a> the <code class="literal">SurfaceOutput</code> with the correct values.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note27"></a>Note</h3><p>For more information on creating Surface Shaders, check out the following link: <a class="ulink" href="https://docs.unity3d.com/Manual/SL-SurfaceShaders.html" target="_blank">https://docs.unity3d.com/Manual/SL-SurfaceShaders.html</a></p></div></div></div>