<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch02lvl1sec19"></a>Adding properties to a shader</h2></div></div><hr /></div><p>Properties of a shader are very <span>important</span><a id="id325209440" class="indexterm"></a> for the shader <span>pipeline</span><a id="id325219406" class="indexterm"></a> as they are the method that you use to let the artist or user of the shader assign textures and tweak your shader values. Properties allow you to expose GUI elements in a material's <strong class="userinput"><code>Inspector</code></strong> tab without you having to use a separate editor, which provides visual ways to tweak a shader. With your shader opened in your IDE of choice, look at the block of lines two through seven. This is called the <code class="literal">Properties</code> block of the script. Currently, it will have one texture property in it called <code class="literal">_MainTex</code>.</p><p>If you look at your material that has this shader applied to it, you will notice that <span>there</span><a id="id325442711" class="indexterm"></a> is one <span class="strong"><strong>texture</strong></span> GUI element in the <strong class="userinput"><code>Inspector</code></strong> tab. These lines of code in our shader are creating this GUI element for us. Again, Unity has made this process very efficient in terms of coding and the amount of time it takes to iterate through changing your properties.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec26"></a>Getting ready</h3></div></div></div><p>Let's see how this works in our current shader called <code class="literal">StandardDiffuse</code> by creating our own properties and learning more about the syntax involved. For this example, we will refit the shader previously created. Instead of using a texture, it will only use its color and some other properties that we will be able to change directly from the <strong class="userinput"><code>Inspector</code></strong> tab. Start by duplicating the <code class="literal">StandardDiffuse</code> shader. You can do this by selecting it in the <strong class="userinput"><code>Inspector</code></strong> tab and pressing <span class="emphasis"><em><span class="strong"><strong>Ctrl </strong></span></em></span>+ <span class="emphasis"><em><span class="strong"><strong>D</strong></span></em></span>. This will create a copy called <code class="literal">StandardDiffuse 1</code>. Go ahead and rename it as <code class="literal">StandardColor</code>.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note19"></a>Note</h3><p>You can give a friendlier name to your shader in its first line. For instance, <code class="literal">Shader "CookbookShaders/StandardDiffuse"</code> tells Unity to call this shader<code class="literal">StandardDiffuse</code> and move it to a group called <code class="literal">CookbookShaders</code>. If you duplicate a shader using <span class="emphasis"><em><span class="strong"><strong>Ctrl </strong></span></em></span>+ <span class="emphasis"><em><span class="strong"><strong>D</strong></span></em></span>, your new file will share the same name. To avoid confusion, make sure to change the first line of each new shader so that it uses a unique alias in this and future recipes.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec27"></a>How to do it...</h3></div></div></div><p>Once the <code class="literal">StandardColor</code> shader is ready, we can start changing its properties:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>In the first <span>line</span><a id="id325445206" class="indexterm"></a> of the script, update the <span>name</span><a id="id325445214" class="indexterm"></a> to the following:</li></ol></div><pre class="programlisting">Shader "CookbookShaders/Chapter 02/StandardColor" {</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip20"></a>Note</h3><p><strong class="userinput"><code>Downloading the example code</code></strong><span>You can download</span> the example code files for all Packt books you have purchased from your account at <span><a class="ulink" href="http://www.packtpub.com/" target="_blank">http://www.packtpub.com</a></span>. If you purchased this book elsewhere, you can visit <span><a class="ulink" href="http://www.packtpub.com/support" target="_blank">http://www.packtpub.com/support</a></span> and register to have the files emailed directly to you.</p></div><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>In the <code class="literal">Properties</code> block of our shader, remove the current property by deleting the following code from our current shader:</li></ol></div><pre class="programlisting">_MainTex ("Albedo (RGB)", 2D) = "white" {} </pre><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>As we have removed an essential property, this shader will not compile until the other references to <code class="literal">_MainTex</code> are removed. Let's remove this other line inside of the <code class="literal">SubShader</code> section:</li></ol></div><pre class="programlisting">sampler2D _MainTex; </pre><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>The original shader used <code class="literal">_MainTex</code> to color the model. Let's change this by replacing the first line of code of the <code class="literal">surf()</code> function with this:</li></ol></div><pre class="programlisting">fixed4 c = _Color; </pre><p>Just as you may be used to the <code class="literal">float</code> type being used for floating point values when writing code in C# and other programming languages, <code class="literal">fixed</code> is used for fixed-point values and is the type used when writing shaders. You may also see the <code class="literal">half</code> type used as well, which is like the <code class="literal">float</code> type but takes up half the space. This is useful for saving memory but is less precise in how it is presented. We will be discussing this in much greater detail i<span>n the <span class="emphasis"><em>Techniques to make shaders more efficient</em></span> recipe in <a class="link" href="#" linkend="ch08">Chapter 8</a>, <span class="emphasis"><em>Mobile Shader Adjustment</em></span></span>.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note21"></a>Note</h3><p>For more <span>information</span><a id="id325453980" class="indexterm"></a> on fixed-point values, check out <a class="ulink" href="https://en.wikipedia.org/wiki/Fixed-point_arithmetic" target="_blank">https://en.wikipedia.org/wiki/Fixed-point_arithmetic</a>.</p></div><p>The <code class="literal">4</code>  in <code class="literal">fixed4</code> stands for the fact that the color is a single variable that contains four <code class="literal">fixed</code> values: red, green, blue, and alpha. You will learn more about how this works and how to modify these values in more detail in <span>the next chapter, <a class="link" href="#" linkend="ch03">Chapter 3</a>, <span class="emphasis"><em>Surface Shaders and Texture Mapping</em></span></span>.</p><div class="orderedlist"><ol class="orderedlist arabic" start="5" type="1"><li>When you save and return to Unity, the shader will compile, and you will see that now our material's <strong class="userinput"><code>Inspector</code></strong> tab doesn't have a texture swatch any more. To complete the refit of this shader, let's add one more property to the <code class="literal">Properties</code> block and see <span>what</span><a id="id325454749" class="indexterm"></a> happens. Enter <span>the</span><a id="id325454758" class="indexterm"></a> following code:</li></ol></div><pre class="programlisting">_AmbientColor ("Ambient Color", Color) = (1,1,1,1) </pre><div class="orderedlist"><ol class="orderedlist arabic" start="6" type="1"><li>We have added another color swatch to the material's <strong class="userinput"><code>Inspector</code></strong> tab. Now let's add one more in order to get a feel for other kinds of properties that we can create. Add the following code to the <code class="literal">Properties</code> block:</li></ol></div><pre class="programlisting">_MySliderValue ("This is a Slider", Range(0,10)) = 2.5 </pre><div class="orderedlist"><ol class="orderedlist arabic" start="7" type="1"><li>We have now created another GUI element that allows us to visually interact with our shader. This time, we created a slider with the name <strong class="userinput"><code>This is a Slider</code></strong>, as shown in the following screenshot:</li></ol></div><div class="mediaobject"><img src="/graphics/9781788396233/graphics/8fdf2d42-d10a-4f74-8acf-9504d8ead7c5.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="8" type="1"><li>Properties allow you to create a visual way to tweak shaders without having to change values in the shader code itself. The next recipe will show you how these properties can actually be used to create a more interesting shader.</li></ol></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note22"></a>Note</h3><p>While properties belong to shaders, the values associated with them are stored in materials. The same shader can be safely shared between many different materials. On the other hand, changing the property of a material will affect the look of all the objects that are currently using it.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec28"></a>How it works...</h3></div></div></div><p>Every Unity shader has a built-in structure that it is looking for in its code. The <strong class="userinput"><code>Properties</code></strong> block is one of those functions that are expected by Unity. The reason behind this is to give you, the shader programmer, a means of quickly creating GUI elements that tie directly into your shader code. These <span>properties</span><a id="id325454861" class="indexterm"></a> (variables) that you declare in the <strong class="userinput"><code>Properties</code></strong> block can then be used in your shader code to change values, colors, and textures. The syntax to define a <span>property</span><a id="id325454873" class="indexterm"></a> is as follows:</p><div class="mediaobject"><img src="/graphics/9781788396233/graphics/acf040c2-dfb1-482a-9b0c-8b5ca616e4d8.png" /></div><p>Let's take a look at what is going on under the hood here. When you first start writing a new property, you will need to give it a <span class="strong"><strong>Variable Name</strong></span>. The <span class="strong"><strong>Variable Name</strong></span> is going to be the name that your shader code is going to use in order to get the value from the GUI element. This saves us a lot of time because we don't have to set up this system ourselves. The next elements of a property are the <span class="strong"><strong>Inspector GUI Name</strong></span> and <span class="strong"><strong>Type</strong></span> of the property, which is contained within parentheses. The <span class="strong"><strong>Inspector GUI Name</strong></span> is the name that is going to appear in the material's <strong class="userinput"><code>Inspector</code></strong> tab when the user is interacting with and tweaking the shader. The <span class="strong"><strong>Type</strong></span> is the type of data that this property is going to control. There are many types that we can define for properties inside of Unity shaders. The following table describes the types of variables that we can have in our shaders:</p><div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; "><colgroup><col /><col /></colgroup><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong><span>Surface Shader property types</span></strong></span></p></td><td style="border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>Description</strong></span></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">Range</code> (min, max)</p></td><td style="border-bottom: 0.5pt solid ; "><p><span>This create</span>s a <code class="literal">float</code> property as a slider from the minimum value to the maximum value</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">Color</code></p></td><td style="border-bottom: 0.5pt solid ; "><p>This creates a color swatch in the <strong class="userinput"><code>Inspector</code></strong> tab that opens up a <code class="literal">color picker = (float,float,float,float)</code></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">2D</code></p></td><td style="border-bottom: 0.5pt solid ; "><p>This creates a texture swatch that allows a user to drag a texture <span>into the shader</span></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">Rect</code></p></td><td style="border-bottom: 0.5pt solid ; "><p>This creates a non-power of two texture swatch and functions the same as the <code class="literal">2D</code> GUI element</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Cube</p></td><td style="border-bottom: 0.5pt solid ; "><p>This creates a cube map swatch in the <strong class="userinput"><code>Inspector</code></strong> tab and allows a user to drag and drop a cube map <span>into the shader</span></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><code class="literal">float</code></p></td><td style="border-bottom: 0.5pt solid ; "><p>This creates a float value in the <strong class="userinput"><code>Inspector</code></strong> tab but without a slider</p></td></tr><tr><td style="border-right: 0.5pt solid ; "><p>Vector</p></td><td style=""><p>This creates a four-float property that allows you to create directions or colors</p></td></tr></tbody></table></div><p> </p><p>Finally, there is the <span class="strong"><strong>Default Value</strong></span>. This simply sets the value of this property to the value that you place in the code. So, in the previous example diagram, the default value for the property named <code class="literal">_AmbientColor</code>, which is of the <code class="literal">Color</code> type, is set to a value of <code class="literal">1, 1, 1, 1</code>. As this is a <code class="literal">Color</code> property <span>expecting</span><a id="id325209398" class="indexterm"></a> a <span>color</span><a id="id325209406" class="indexterm"></a> that is <code class="literal">RGBA</code> or <code class="literal">float4</code> or <code class="literal">r, g, b, a = x, y, z, w</code>, this <code class="literal">Color</code> property, when first created, is set to white.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec29"></a>See also</h3></div></div></div><p>The <span>properties</span><a id="id325453831" class="indexterm"></a> are documented in the Unity manual at <span><a class="ulink" href="http://docs.unity3d.com/Documentation/Components/SL-Properties.html" target="_blank">http://docs.unity3d.com/Documentation/Components/SL-Properties.html</a></span>.</p></div></div>