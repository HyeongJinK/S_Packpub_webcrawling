<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch03lvl1sec21"></a>Someone call a doctor!</h2></div></div><hr /></div><p>When you're fighting against an enemy, it is imperative that you know how much life you have left, especially if you have the ability to heal yourself during a high-intensity shoot-out, or when you're the last man standing defending your team's title! In gamified applications, health can also be a way to provide players with a limited number of opportunities to fail, before having a <span class="emphasis"><em>cool down</em></span> period and resuming the experience or prompting them to start again. In either case, health can be displayed in many different ways. You can have a series of hearts, a green bar, or you might have something such as a percentage next to an icon. For the purpose of this chapter, we will create a health counter like the one in the following screenshot. You will also learn the basic skills that you will need to know in order to transform it into any of the types mentioned previously. All these icons can be found at <a class="ulink" href="http://www.player26.com" target="_blank">www.player26.com</a>:</p><p>
</p><div class="mediaobject"><img src="/graphics/9781786463487/graphics/image_03_004.jpg" /></div><p>
</p><p>Different health bars in games</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec26"></a>Circular health bar</h3></div></div></div><p>To create a circular health bar, we need a circular picture such as <code class="literal">health_ring</code>, which you can find in the package:</p><p>
</p><div class="mediaobject"><img src="/graphics/9781786463487/graphics/image_03_005.jpg" /></div><p>
</p><p>The health ring that we will learn how to implement in Unity</p><p>For this section, let's create a circular health bar as a UI image and rename the game object <code class="literal">Circular Health Bar</code>. Then, we need to change the <span class="strong"><strong>Image Type</strong></span> to <span class="strong"><strong>Filled</strong></span>.</p><p>To properly create the filling of the health bar, we need to set the <span class="strong"><strong>Fill Method</strong></span> to <span class="strong"><strong>Radial 360</strong></span>. As a result, it will be filled in a circular way. Then select <span class="strong"><strong>Fill Origin</strong></span> to <span class="strong"><strong>Top</strong></span>, since we want the health bar to start from the top. Finally, uncheck <span class="strong"><strong>Clockwise</strong></span>, since we want it anti-clockwise. At the end, the component should look like the following:</p><p>
</p><div class="mediaobject"><img src="/graphics/9781786463487/graphics/image_03_006.jpg" /></div><p>
</p><p>The Image component after the changes</p><p>Next, we need to add a script, as always, in the usual way: <span class="strong"><strong>Add Component</strong></span> | <span class="strong"><strong>New Script</strong></span>. We can name it <code class="literal">CircularHealthBar</code>.</p><p>Again, we need to use the UI library, so let's add this line at the beginning of the code:</p><pre class="programlisting">using UnityEngine.UI; &#13;
</pre><p>Then we need a variable to take the reference to the image component, and two additional variables for the actual health value and its maximum:</p><pre class="programlisting">    private Image healthbarFilling; &#13;
    public int maxHealth = 100; &#13;
    private int health; &#13;
</pre><p>In the <code class="literal">Start()</code> function, we need to get the reference to the image component, and set the health to its maximum:</p><pre class="programlisting">    void Start() { &#13;
        healthbarFilling = GetComponent&lt;Image&gt;(); &#13;
        health = maxHealth; &#13;
    } &#13;
</pre><p>Now, we also need a custom update function for the graphics. Here, in order to compute the percentage, we can divide the health by its maximum. Then, assign the value to the <code class="literal">fillAmount</code> variable:</p><pre class="programlisting">    private void updateHealth() { &#13;
        healthbarFilling.fillAmount = health / maxHealth; &#13;
    } &#13;
</pre><p>The next step is to create a function to add health to the user. If it reaches the maximum, the health is capped; otherwise, it will just increase. Finally, the graphic is then updated by calling the function we created before:</p><pre class="programlisting">    public void addHealth(int value) { &#13;
        health += value; &#13;
        if (health &gt; maxHealth) &#13;
            health = maxHealth; &#13;
        updateHealth(); &#13;
    } &#13;
</pre><p>The trivial part is a function that subtracts health from the user, because it may reach zero. So, we need to have a Boolean to return a value that indicates if this event happens. In fact, when we call this function, through the return value we can understand if the user has finished his or her health and perform a consequent action. Therefore, we need subtract the value from the health, and then we check if the total health is zero. Before returning the value, we update the graphic as well:</p><pre class="programlisting">    //Returns true if the user dies &#13;
    public bool removeHealth(int value) { &#13;
        health -= value; &#13;
        if (health &lt;= 0) { &#13;
            health = 0; &#13;
            updateHealth(); &#13;
            return true; &#13;
        } &#13;
        updateHealth(); &#13;
        return false; &#13;
    } &#13;
</pre><p>Save the script, and we have implemented a circular health bar!</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec27"></a>Lives counter</h3></div></div></div><p>While we are playing, and especially if we are encountering enemies that affect us, we need a lives counter to keep track of how long we are able to survive within the game and whether or not we need to get med packs. Just like the health ring, we can also display lives with a counter graphic, such as in the following screenshot:</p><p>
</p><div class="mediaobject"><img src="/graphics/9781786463487/graphics/image_03_007.jpg" /></div><p>
</p><p>Health bar counter with hearts</p><p>We are going to create this type of counter, but you are welcome to use another image instead of hearts.</p><p>To begin, we need to have a background box where to place our hearts. The <code class="literal">health_background</code>Â  file in our package will serve to the scope. So, let's create a new image, set it as a Sprite, and name it <span class="strong"><strong>Lives Counter</strong></span>. Furthermore, remember to use <span class="strong"><strong>Set Native Size</strong></span> before scaling if you want to keep the proportions. At the end, we should have something like the following:</p><p>
</p><div class="mediaobject"><img src="/graphics/9781786463487/graphics/image_03_008.jpg" /></div><p>
</p><p>Creating the heart bar</p><p>Then, we need to have a heart; in this case we can use the <code class="literal">heart</code> from the package mentioned earlier. We need to create five images with the <code class="literal">heart</code> as a Sprite, and then place them like in the following screenshot:</p><p>
</p><div class="mediaobject"><img src="/graphics/9781786463487/graphics/image_03_009.jpg" /></div><p>
</p><p>The completed graphics of the heart bar</p><p>It's important to name them in the correct order to avoid headaches later on. The heart on the left will be <code class="literal">Heart_01</code> and they'll be numbered consecutively towards the right, until <code class="literal">Heart_05</code>. In addition, we need to parent them to <span class="strong"><strong>Lives Counter</strong></span>, as shown in the following screenshot:</p><p>
</p><div class="mediaobject"><img src="/graphics/9781786463487/graphics/image_03_010.jpg" /></div><p>
</p><p>The game object parenting of the Lives Counter in the Hierarchy panel</p><p>Now, let's add a script to <span class="strong"><strong>Lives Counter</strong></span> and name it <code class="literal">LivesCounterScript</code>.</p><p>First, we need to add a couple of variables, one to store the reference to all the hearts (an array will be fine) and another one for the actual number of lives:</p><pre class="programlisting">    public GameObject[] hearts; &#13;
    private int lives; &#13;
</pre><p>Then, in the <code class="literal">Start()</code> function, we need to assign the number of lives according to the number of hearts we have:</p><pre class="programlisting">    void Start() { &#13;
        lives = hearts.Length; &#13;
    } &#13;
</pre><p>As usual, we need a custom <code class="literal">update</code> function. We need to disable only the hearts that have a number, or index, greater than the actual number of lives. A <code class="literal">for</code> cycle will work:</p><pre class="programlisting">    private void updateLivesCounter() { &#13;
        for (int i = 0; i &lt; hearts.Length; i++) { &#13;
            if (i &lt; lives) { &#13;
                hearts[i].SetActive(true); &#13;
            } &#13;
            else { &#13;
                hearts[i].SetActive(false); &#13;
            } &#13;
        } &#13;
    } &#13;
</pre><p>In the function to add a life, we only need to check if the user already has the maximum number of lives, and then update the graphics with the function we wrote before:</p><pre class="programlisting">    public void addLife() { &#13;
        if (lives &lt; hearts.Length) { &#13;
            lives++; &#13;
            updateLivesCounter(); &#13;
        } &#13;
    } &#13;
</pre><p>As we have done before with the health bar, we also need a function to remove a life and check if the user has lost all of his or her lives. Therefore, we again need a Boolean return value: if its is <code class="literal">true</code>, then the user has finished their lives. As a result, when you call this function from your scripts, you will be able to perform an action accordingly. So, let's write the following:</p><pre class="programlisting">    public bool loseLife() { &#13;
        lives--; &#13;
        if (lives &gt; 0) { &#13;
            updateLivesCounter(); &#13;
            return false; &#13;
        } &#13;
        }  &#13;
</pre><p>Save the script, but we aren't done yet. In fact, in the <span class="strong"><strong>Inspector</strong></span>, we need to assign our hearts like in the following screenshot:</p><p>
</p><div class="mediaobject"><img src="/graphics/9781786463487/graphics/image_03_011.jpg" /></div><p>
</p><p>The Lives Counter with the array of Hearts filled</p><p>Now, we have finished, and your <span class="strong"><strong>Lives Counter</strong></span> is ready.</p></div></div>