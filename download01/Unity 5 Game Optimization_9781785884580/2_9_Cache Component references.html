<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch02lvl1sec14"></a>Cache Component references</h2></div></div><hr /></div><p>A common mistake<a id="id94" class="indexterm"></a> when scripting in Unity is to overuse the <code class="literal">GetComponent()</code> method. For example, the following script code is trying to check a creature's <code class="literal">health</code> value, and if its health goes below <code class="literal">0</code>, disable a series of Components to prepare it for a death animation:</p><div class="informalexample"><pre class="programlisting">void TakeDamage() {
  if (GetComponent&lt;HealthComponent&gt;().health &lt; 0) {
    GetComponent&lt;Rigidbody&gt;().enabled = false;
    GetComponent&lt;Collider&gt;().enabled = false;
    GetComponent&lt;AIControllerComponent&gt;().enabled = false;
    GetComponent&lt;Animator&gt;().SetTrigger("death");
  }
}</pre></div><p>Each time this method executes, it will reacquire five different <code class="literal">Component</code> references. This is good in terms of heap memory consumption (in that it doesn't cost any), but it is not very friendly on CPU usage. This is particularly problematic if the main method were called during <code class="literal">Update()</code>. Even if it is not, it still might coincide with other important events, such as creating particle effects, replacing an object with a ragdoll (thus invoking various activity in the physics engine), and so on. This coding style can seem harmless, but it can cause a lot of long-term problems and runtime work for very little benefit.</p><p>It costs us very little<a id="id95" class="indexterm"></a> memory space (only 32 or 64 bits each time; Unity version, platform, and fragmentation permitting) to cache these references for future use. So, unless you're extremely bottlenecked on memory, a better approach would be to acquire the references during initialization and keep them until they are needed:</p><div class="informalexample"><pre class="programlisting">private HealthComponent _healthComponent;
private Rigidbody _rigidbody;
private Collider _collider;
private AIControllerComponent _aiController;
private Animator _animator;

void Awake() {
  _healthComponent = GetComponent&lt;HealthComponent&gt;();
  _rigidbody = GetComponent&lt;Rigidbody&gt;();
  _collider = GetComponent&lt;Collider&gt;();
  _aiController = GetComponent&lt;AIControllerComponent&gt;();
  _animator = GetComponent&lt;Animator&gt;();
}

void TakeDamage() {
  if (_healthComponent.health &lt; 0) {
    _rigidbody.detectCollisions = false;
    _collider.enabled = false;
    _aiController.enabled = false;
    _animator.SetTrigger("death");
  }
}</pre></div><p>Caching the Component references in this way spares us from reacquiring them each time they're needed, saving us some CPU overhead each time, at the expense of some additional memory consumption.</p></div>