<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch06lvl1sec47"></a>Animating the door that leads to the water section</h2></div></div><hr /></div><p>Finally, we<a id="id616" class="indexterm"></a> need to ensure that the door that leads to the section with the water is closed, and opens when the player collides with it. The door will close after 3 seconds. Perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Locate the object <code class="literal">door1</code> in the <span class="strong"><strong>Hierarchy</strong></span> window; select it and change its position to (x=0, y = 1, z= 24).</p></li><li><p>Create a tag, <code class="literal">room2_door</code>, and apply it to this door.</p></li><li><p>Locate the animations <code class="literal">open_door1</code> and <code class="literal">close_door1</code> in the folder <span class="strong"><strong>Assets</strong></span> | <span class="strong"><strong>chapter6</strong></span> | <span class="strong"><strong>chapter6_pack</strong></span> and drag-and-drop these animations on the object labeled <code class="literal">door1</code>.</p></li><li><p>Select the object <code class="literal">door1</code> and check that the two animations appear as components in the <span class="strong"><strong>Inspector</strong></span> window.</p></li><li><p>In the component called <span class="strong"><strong>Animation</strong></span>, uncheck the box to the right of the parameter <span class="strong"><strong>Play Automatically</strong></span>, so that the animation does not play at startup, as illustrated in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781849695848/graphics/5848_06_9.jpg" /></div></li></ol></div><p>Open the script <code class="literal">collisionDetection</code> and <a id="id617" class="indexterm"></a>add the following lines at the start of the script:</p><div class="informalexample"><pre class="programlisting">private var startDoor1Timer:boolean = false;
private var timer:float;</pre></div><p>Add the<a id="id618" class="indexterm"></a> following code at the end of the function <code class="literal">OnControllerColliderHit</code>:</p><div class="informalexample"><pre class="programlisting">if (c.gameObject.tag == "room2_door")
{
  c.gameObject.animation.Play("open_door1");
  startDoor1Timer = true;
}</pre></div><p>In the previous code, the door is open when the player collides with it. The variable <code class="literal">startDoor2Timer</code> is <a id="id619" class="indexterm"></a>set to <code class="literal">true</code>; this will, as we will see in the following code, start the timer, triggering the closure of the door after <code class="literal">3</code> seconds.</p><p>Add the following<a id="id620" class="indexterm"></a> code to the function <code class="literal">Update</code>:</p><div class="informalexample"><pre class="programlisting">if (startDoor1Timer)
{
  timer+=Time.deltaTime;
  if (timer&gt;3)
  {
    startDoor1Timer = false;
    GameObject.Find("door1").animation.Play("close_door1");
  }
}</pre></div><p>In the <a id="id621" class="indexterm"></a>previous code, we check whether the timer is active; the timer is updated every second and when it reaches 3 seconds, it is deactivated and the door is closed. Play the scene and check that the door opens and closes automatically after 3 seconds.</p></div>