<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch05lvl1sec37"></a>Animating the character for the game</h2></div></div><hr /></div><p>Once we<a id="id370" class="indexterm"></a> have applied these settings to the character, <a id="id371" class="indexterm"></a>we will now use it for our scene.</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Drag-and-drop the prefab labeled <code class="literal">zombie_hires</code> by navigating to <span class="strong"><strong>Assets</strong></span> | <span class="strong"><strong>ZombieCharacterPack</strong></span> to the scene, change its position to (x=0, y =0, z=0), and add a collider to the character.</p></li><li><p>Select: <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>Physics</strong></span> | <span class="strong"><strong>Capsule Collider</strong></span>.</p></li><li><p>Set the center position of this collider to (x=0, y=0.7, z=0), the radius to <code class="literal">0.5</code>, the height to <code class="literal">2</code>, and leave the other options as default, as illustrated in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781849695848/graphics/5848_05_04.jpg" /></div></li><li><p>Select: <span class="strong"><strong>Assets</strong></span> | <span class="strong"><strong>chapter5</strong></span> | <span class="strong"><strong>chapter5_pack</strong></span>; you will see that it includes several animations, including <code class="literal">Zombie@idle</code>, <code class="literal">Zombie@walkForward</code>, <code class="literal">Zombie@attack</code>, <code class="literal">Zombie@hit</code>, and <code class="literal">Zombie@dead</code>.</p></li></ol></div><p>We will now create the necessary animation for our character.</p><p>Click <a id="id372" class="indexterm"></a>once on the object <code class="literal">zombie_hires</code> in the <span class="strong"><strong>Hierarchy</strong></span> window<a id="id373" class="indexterm"></a>. We should see that it includes a componen<a id="id374" class="indexterm"></a>t called <span class="strong"><strong>Animator</strong></span>. This component is related to the animation of the character <a id="id375" class="indexterm"></a>through Mecanim. You will also notice an empty slot for an Animator Controller. This controller will be created in the next section so that we can animate the character and control its different states, using a state machine.</p><p>Let's create an <span class="strong"><strong>Animator Controller</strong></span><a id="id376" class="indexterm"></a> that will be used for this character:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>From the <code class="literal">project</code> folder, select the <code class="literal">chapter5</code> folder, then select <span class="strong"><strong>Create</strong></span> | <span class="strong"><strong>Animator Controller</strong></span> in the <span class="strong"><strong>Project</strong></span> window. This should create a new <a id="id377" class="indexterm"></a>Animator Controller labeled <span class="strong"><strong>New Animator Controller</strong></span> in the folder <code class="literal">chapter5</code>.</p></li><li><p>Rename this controller <code class="literal">zombieController</code>.</p></li><li><p>Select the object labeled <code class="literal">zombie_hires</code> in the <span class="strong"><strong>Hierarchy</strong></span> window.</p></li><li><p>Locate the <span class="strong"><strong>Animator Controller</strong></span> that we have just created by navigating to <span class="strong"><strong>Assets</strong></span> | <span class="strong"><strong>chapter5</strong></span> (<code class="literal">zombieController</code>), drag-and-drop it to the empty slot to the right of the attribute controller in the Animator component of the zombie character, and check that the options <span class="strong"><strong>Apply Root Motion</strong></span> and <span class="strong"><strong>Animate Physics</strong></span> are selected. Our character is now ready to receive the animations.</p></li><li><p>Open the <span class="strong"><strong>Animator</strong></span> window<a id="id378" class="indexterm"></a> (<span class="strong"><strong>Window</strong></span> | <span class="strong"><strong>Animator</strong></span>). This window is employed to display and manage the different states of our character. Since no animation is linked to the character, the default state is <span class="strong"><strong>Any State</strong></span>.</p></li><li><p>Select the object labeled <code class="literal">zombie_hires</code> in the <span class="strong"><strong>Hierarchy</strong></span> window.</p></li><li><p>Rearrange the windows in our project so that we can see both the state machine window and the character in the <span class="strong"><strong>Scene</strong></span> view: we can drag the tab labeled<a id="id379" class="indexterm"></a> <span class="strong"><strong>Scene</strong></span> for the <span class="strong"><strong>Scene</strong></span> view at the bottom of the <span class="strong"><strong>Animator</strong></span> window, so that both windows can be seen simultaneously.</p></li></ol></div><p>We will now apply our first animation to the character:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Locate the prefab <code class="literal">Zombie@idle</code> by navigating to <span class="strong"><strong>Assets</strong></span> | <span class="strong"><strong>chapter5</strong></span>| <span class="strong"><strong>chapter5_pack</strong></span>.</p></li><li><p>Click once on this prefab, and in the <span class="strong"><strong>Inspector</strong></span> window, click the <span class="strong"><strong>Rig</strong></span> tab.</p></li><li><p>In<a id="id380" class="indexterm"></a> the new window, select the option<a id="id381" class="indexterm"></a> <span class="strong"><strong>Humanoid</strong></span> for the attribute <span class="strong"><strong>Animation Type</strong></span> and click on <span class="strong"><strong>Apply</strong></span>.</p></li><li><p>Click on the <span class="strong"><strong>Animations</strong></span> tab<a id="id382" class="indexterm"></a>, and then click on the label <span class="strong"><strong>idle</strong></span>, this will provide information on the <span class="strong"><strong>idle</strong></span> clip.</p></li><li><p>Scroll down the window, check the box for the attribute <span class="strong"><strong>Loop Pose</strong></span>, and click on <span class="strong"><strong>Apply</strong></span> to apply this change (you will need to scroll down to locate this button).</p></li><li><p>In the <span class="strong"><strong>Project</strong></span> view<a id="id383" class="indexterm"></a>, click on the arrow located to the left (or right, depending on how much we have zoomed-in within this window) of the prefab <code class="literal">Zombie@idle</code>; it will reveal items included in this prefab, including an animation called <span class="strong"><strong>idle</strong></span>, symbolized by a gray box with a white triangle.</p></li><li><p>Make sure that the <span class="strong"><strong>Animator</strong></span> window<a id="id384" class="indexterm"></a> is active and drag this animation (<span class="strong"><strong>idle</strong></span>) to the <span class="strong"><strong>Animator</strong></span> window.</p></li><li><p>This will create an idle state, and this state will be colored in orange, which means that it is the default state for our character. Rename this state <code class="literal">Idle</code> (upper case I) using the Inspector.</p></li><li><p>Play the scene and check that the character is in an idle state.</p></li><li><p>Repeat steps 1-9 for the prefab <code class="literal">Zombie@walkForward</code><a id="id385" class="indexterm"></a> and<a id="id386" class="indexterm"></a> create a state called <code class="literal">WalkForward</code>. To test the second animation, we can temporarily set the state <code class="literal">walkForward</code> to be the default state by right-clicking on the <code class="literal">walkForward</code> state in the <span class="strong"><strong>Animator</strong></span> window, and selecting <span class="strong"><strong>Set As Default</strong></span>. Once we have tested this animation, set the state <code class="literal">Idle</code> as the default state.</p></li></ol></div><p>While the zombie is animated properly, you may notice that the camera on the <span class="strong"><strong>First Person Controller</strong></span> might be too high. You will address this by changing the height of the camera so that it is at eye-level. In the <span class="strong"><strong>Hierarchy</strong></span> view, select the object <span class="strong"><strong>Main Camera</strong></span> that is <a id="id387" class="indexterm"></a>located with the object <span class="strong"><strong>First Person Controller</strong></span> and change its position to (x=0, y=0.5, z=0).</p><p>We now have two animations. At present, the character is in the <code class="literal">Idle</code> state, and we need to define <a id="id388" class="indexterm"></a>triggers or conditions for the character to start or stop walking toward the player.<a id="id389" class="indexterm"></a> In this game, we will have enemies with <a id="id390" class="indexterm"></a>different degrees of intelligence. This first type will follow the user when it sees the user, is close to the user, or is being attacked by the user.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note25"></a>Note</h3><p>The <span class="strong"><strong>Animator</strong></span> window<a id="id391" class="indexterm"></a> will help to create animations and to apply transition conditions and blending between them so that transitions between each animation are smoother. To move around this window, we can hold the <span class="emphasis"><em>Alt</em></span> key while simultaneously dragging-and-dropping the mouse. We can also select states by clicking on them or defining a selection area (drag-and-drop the mouse to define the area). If needed, it is also possible to maximize this window using the icon located at its top-right corner.</p></div></div>