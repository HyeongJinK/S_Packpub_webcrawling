<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch04lvl1sec34"></a>Allowing for repeated shots</h2></div></div><hr /></div><p>Now that <a id="id351" class="indexterm"></a>we have managed to create a gun that shoots a bullet every time the player presses the left mouse button, it would be great to add an automatic feature to this gun, so that the player can fire the gun repeatedly by just holding the left mouse button down. This feature would be useful when many enemies surround the player, although it will also mean that the ammunitions will diminish faster. Let's implement this feature:</p><p>Add the following two lines to the start of the script <code class="literal">shootBullet</code>:</p><div class="informalexample"><pre class="programlisting">public var timeToReload:float = 0.2f;
public var timeForNextShot:float = 0.0;</pre></div><p>In the previous code, we defined and initialized two variables. The first variable <code class="literal">timeToReload</code><a id="id352" class="indexterm"></a> is the time it takes to load the next bullet. Effectively, it will be the time between two consecutive shots. The second variable <code class="literal">timeForNextShot</code><a id="id353" class="indexterm"></a> is the time when the player will be able to fire the gun again (effectively, it will be the current time added to the time it takes to reload the gun).</p><p>Next, we will change the way the input is handled by replacing the line that starts with <code class="literal">if (Input.GetButtonDown("Fire1")</code> with the following code:</p><div class="informalexample"><pre class="programlisting">if (Input.GetButton("Fire1") &amp;&amp; Time.time &gt;= timeForNextShot)</pre></div><p>In the previous code, we checked if the <code class="literal">Fire1</code> button<a id="id354" class="indexterm"></a> is held down, and if the next bullet has been loaded. Note that while the previous code <code class="literal">Input.GetButtonDown</code> is checking<a id="id355" class="indexterm"></a> whether the <code class="literal">Fire1</code> button has been pressed, the code <code class="literal">Input.GetButton</code> checks whether the <code class="literal">Fire1</code> button is held down. Finally, we need to update the variable <code class="literal">timeForNextShot</code> accordingly, as highlighted in the following code:</p><div class="informalexample"><pre class="programlisting">function Update () 
{
<span class="strong"><strong>  if (Input.GetButton("Fire1") &amp;&amp; Time.time &gt;= timeForNextShot)</strong></span>
  {
    if (nbBullets &gt;= 1)
    {
      audio.clip = fireSound;
      audio.Play();
      var hit : RaycastHit;
      var ray = Camera.main.ScreenPointToRay(Vector3 (Screen.width/2, Screen.height/2));
      if (Physics.Raycast(ray, hit, 100))
      {
        print ("You fired at the "+hit.collider.gameObject.tag);
        var spark : GameObject = Instantiate (sparks, hit.point, Quaternion.identity);  
        
      }  
      nbBullets --;
      print("nbBullets"+nbBullets);
    }
<span class="strong"><strong>    timeForNextShot = Time.time + timeToReload;</strong></span>
    
  }
}</pre></div></div>