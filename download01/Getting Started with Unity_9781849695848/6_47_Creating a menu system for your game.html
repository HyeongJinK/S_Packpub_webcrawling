<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch06lvl1sec48"></a>Creating a menu system for your game</h2></div></div><hr /></div><p>We have almost finished our game and level. For our game to be complete, we will need to <a id="id622" class="indexterm"></a>create a splash screen and instructions, as well as screens to be displayed when the player has lost or succeeded. These screens will be created <a id="id623" class="indexterm"></a>using scenes, and navigation between them will be implemented using buttons. To open a particular menu (for example, splash screen, instructions, or game over), we will load the corresponding scene. The background of the splash screen will include the maze created earlier and some animated zombies (<code class="literal">idle</code>). First let's create a prefab for the maze so that it can be reused.</p><p>Open the last scene, select the folder <span class="strong"><strong>Assets</strong></span> | <span class="strong"><strong>chapter6</strong></span>, create a new prefab (that is, select: <span class="strong"><strong>Create</strong></span> | <span class="strong"><strong>Prefab</strong></span> from the <span class="strong"><strong>Project</strong></span> window), and rename it <code class="literal">maze</code>. Locate the object labeled <code class="literal">maze</code> in the <span class="strong"><strong>Hierarchy</strong></span> window and drag-and-drop it on the prefab we have just created. This prefab will be accessible from any scene within our project, including the splash screen scene.</p><p>Next, let's create<a id="id624" class="indexterm"></a> the splash screen scene:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Create a new scene (<span class="strong"><strong>File</strong></span> | <span class="strong"><strong>New Scene</strong></span>) and save it as <code class="literal">splashScreen</code> (<span class="strong"><strong>File</strong></span> | <span class="strong"><strong>Save Scene As</strong></span>).</p></li><li><p>Rename the default camera present in the scene (<span class="strong"><strong>Main Camera</strong></span>) <code class="literal">camera1</code> and change its position to (x=0, y=1, z=0).</p></li><li><p>Drag-and-drop the <code class="literal">maze</code> prefab we created earlier on the scene and change its position to (x=0, y=0, z=0).</p></li><li><p>Within the <code class="literal">maze</code> object in the <span class="strong"><strong>Hierarchy</strong></span> window, deactivate the objects <span class="strong"><strong>First Person Controller</strong></span> and <span class="strong"><strong>Main Camera</strong></span> located in the folder <code class="literal">maze</code>.</p></li><li><p>Drag-and-drop the prefab labeled <code class="literal">staticEnemy</code> (<span class="strong"><strong>Assets</strong></span> | <span class="strong"><strong>chapter5</strong></span>) on the scene; change its position to (x=0, y=-0.5, z=3) and its rotational component to (x=0, y=180, z=0), and deactivate the script <code class="literal">controlZombie</code> that is attached <a id="id625" class="indexterm"></a>to it (we will not need to manage different states for this character in the splash screen); we will also deactivate the object labeled <code class="literal">dot_enemy</code> that is within the zombie (<code class="literal">staticEnemy</code>) object, as the top view will not be used in the splash screen.</p></li><li><p>Duplicate this <a id="id626" class="indexterm"></a>object (that is, <code class="literal">staticEnemy</code>) 14 times, and change the properties of the duplicates as follows (x=0, y=-0.5, z=3), (x=0.5, y=-0.5, z=4), (x=-0.5, y=-0.5, z=4), (x=-2, y=-0.5, z=5), (x=-1, y=-0.5, z=5), (x=0, y=-0.5, z=5), (x=1, y=-0.5, z=5), (x=2, y=-0.5, z=5), (x=-3, y=-0.5, z=6), (x=-1.5, y=-0.5, z=6), (x=0, y=-0.4, z=6), (x=1.5, y=-0.5, z=6), (x=3, y=-0.5, z=6), (x=-7, y=-0.4, z=10), and (x=7, y=-0.4, z=10).</p></li><li><p>Create <a id="id627" class="indexterm"></a>three <code class="literal">GUItext</code> objects (<span class="strong"><strong>GameObject</strong></span> | <span class="strong"><strong>Create Other</strong></span> | <span class="strong"><strong>GUI Text</strong></span>), rename them <code class="literal">GUIText_outbreak</code>, <code class="literal">GUIText_subtitle</code>, and <code class="literal">GUIText_clickToContinue</code>, and change their position to (x=0.5, y=0.97, z=0), (x=0.5, y=0.8, z=0), and (x=0.5, y=0.3, z=0), respectively.</p></li><li><p>For the<a id="id628" class="indexterm"></a> object <code class="literal">GUIText_outbreak</code>: set the <code class="literal">text</code> attribute to <code class="literal">Zombie Outbreak!</code>, <code class="literal">Text Anchor</code> to <code class="literal">middle-center</code>, <code class="literal">Font</code> to <code class="literal">OhTheHorror</code>, and the <code class="literal">Font Size</code> to <code class="literal">60</code>.</p></li><li><p>For <a id="id629" class="indexterm"></a>the object <code class="literal">GUIText_subtitle</code>: use the same values, and set the <code class="literal">Text</code> attribute<a id="id630" class="indexterm"></a> to <code class="literal">They are ready for you but are you...?</code>, and <code class="literal">Font Size</code> to <code class="literal">20</code>.</p></li><li><p>For the object <code class="literal">GUIText_clickToContinue</code>: use the same values, and set the <code class="literal">Text</code> attribute to <code class="literal">Click to Continue</code> and the <code class="literal">Font Size</code> to <code class="literal">20</code>.</p></li><li><p>Create a new script (JavaScript) within the folder <span class="strong"><strong>Assets</strong></span> | <span class="strong"><strong>chapter6</strong></span> | <span class="strong"><strong>Scripts</strong></span>, rename it <code class="literal">continueButton</code>, attach it to the object labeled <code class="literal">GUIText_clickToContinue</code>, and open it so that we can edit it. Once open, add the <a id="id631" class="indexterm"></a>following script within the function <code class="literal">Update</code>:</p><div class="informalexample"><pre class="programlisting">if (Input.GetMouseButtonDown(0))
{
  if (Application.loadedLevelName == "splashScreen") Application.LoadLevel("instructions");
  else if (Application.loadedLevelName == "instructions") Application.LoadLevel("chapter6");
  else Application.LoadLevel("splashScreen");
}</pre></div></li></ol></div><p>In the previous code, if the player clicks on the <code class="literal">GUIText</code> attached to the script, we check the name of the current scene. If we are in the <code class="literal">splashScreen</code> scene, then the <code class="literal">instruction</code> scene will be loaded; if the current scene is the <code class="literal">instruction</code> scene, then the <code class="literal">game</code> scene will be loaded. Test the <code class="literal">splashScreen</code> scene.</p><p>To add <a id="id632" class="indexterm"></a>some atmosphere to our game, we will include <a id="id633" class="indexterm"></a>a sound track in all scenes. The background sounds will be issued from the site <code class="literal">incompetech</code>, which features sounds created by<a id="id634" class="indexterm"></a> Kevin MacLeod. Create a new folder labeled <code class="literal">Sounds</code> within the folder <span class="strong"><strong>Assets</strong></span> | <span class="strong"><strong>chapter6</strong></span>. This folder will be used to store the sounds we have imported. Open the URL <a class="ulink" href="http://incompetech.com/music/royalty-free/" target="_blank">http://incompetech.com/music/royalty-free/</a>, read the terms and conditions that apply to the sounds provided by this site, select the option <span class="strong"><strong>Action</strong></span>, and click on the button labeled <span class="strong"><strong>Search by Feel</strong></span>. This should return a list of short loops that we can use outside the game for the different screens.</p><p>Download four sounds of your choice, rename them <code class="literal">sound_splashScreen</code>, <code class="literal">sound_gameOver</code>, <code class="literal">sound_success</code>, and <code class="literal">sound_inGame</code>, and import them inside your project in the folder <span class="strong"><strong>Assets</strong></span> | <span class="strong"><strong>chapter6</strong></span> | <span class="strong"><strong>Sounds</strong></span>. While you may use the sound of our choice, I have chosen <code class="literal">GustavSing</code> (for the <code class="literal">splashScreen</code> scene), <code class="literal">Take a Chance</code> (for the <code class="literal">gameSuccess</code> scene), <code class="literal">Feral Chase</code> (during the game), and <code class="literal">Exciting Trailer</code> (for the <code class="literal">gameOver</code> scene). Create an empty object, rename it <code class="literal">bgSound</code>, and drag-and-drop the sound <code class="literal">sound_splashScreen</code> on this object. This will be used as a new background sound for our scene. Select the object <code class="literal">bgSound</code>, and in the <span class="strong"><strong>Inspector</strong></span> window, look at the <span class="strong"><strong>Audio Source</strong></span> component, and check that the options <span class="strong"><strong>Play on Awake</strong></span> and <span class="strong"><strong>Loop</strong></span> are selected for this sound, so that it loops indefinitely.</p><p>Let's create a script<a id="id635" class="indexterm"></a> that will make it possible to mute the background sound. Select the folder <span class="strong"><strong>Assets</strong></span> | <span class="strong"><strong>chapter6</strong></span>, create a new script, rename it <code class="literal">muteAudio</code>, and attach it to the object labeled <code class="literal">bgSound</code>. Once this is done, open the script <code class="literal">muteAudio</code> and add the following code within the function <code class="literal">Update</code>:</p><div class="informalexample"><pre class="programlisting">if (Input.GetKeyUp(KeyCode.M))
{
  audio.mute = !audio.mute;
}</pre></div><p>In the previous code, we toggle the mute attribute of the background sound when the player presses the key <span class="emphasis"><em>M</em></span>. Finally, we will drag-and-drop the object <code class="literal">bgSound</code> on the object <code class="literal">camera1</code>, and change the position of the object labeled <code class="literal">bgSound</code> to (x=0, y=0, z=0). This will make the object a child of <code class="literal">camera1</code> so that the sound is played exactly where the camera is. Now that you have created the <code class="literal">splashscreen</code> scene, we will create the screen for the game instructions as shown in the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Save the current scene (<span class="strong"><strong>File</strong></span> | <span class="strong"><strong>Save Scene</strong></span>). The scene should be present in the folder <code class="literal">Assets</code> and we will duplicate it to create the <code class="literal">instructions</code> scene. For this, we can select this scene (<code class="literal">splashScreen</code>), and press the keys <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>D</em></span>. This will create a new scene that we can rename <code class="literal">instructions</code>.</p></li><li><p>Double-click on the scene labeled <code class="literal">instructions</code> from the <code class="literal">Assets</code> folder to edit it. In the new scene (<code class="literal">instructions</code>), change the position of the object <code class="literal">camera1</code> to (x=0, y=1.24, z=9), add a new <code class="literal">GUIText</code> object to the scene, and rename it <code class="literal">GUIText_instructions</code>. Change the position of this object to (x=0.5, y=0.6, z=0) and locate its <code class="literal">GUIText</code> component in the <span class="strong"><strong>Inspector</strong></span> window. Within this component (<code class="literal">GUIText</code>), change the <code class="literal">text</code> property to <code class="literal">"Collect the gun and the ammunitions, find the key to the exit door, and escape in one piece. Use the arrow keys and the mouse to navigate through the maze. Click on the mouse left button to shoot</code>." So that this text is displayed over several lines, place your cursor just before the word <span class="strong"><strong>Use</strong></span> and simultaneously press the keys <span class="emphasis"><em>Alt</em></span> + Return. Repeat this step to add a line break just before the sentence that starts with the text <span class="strong"><strong>Click on the mouse</strong></span>.</p></li><li><p>For this <code class="literal">GUItext</code> object<a id="id636" class="indexterm"></a>, change the <code class="literal">Anchor</code> property to <code class="literal">middle center</code>, the <code class="literal">Alignment</code> property to <code class="literal">center</code>, the <code class="literal">Font</code> property <a id="id637" class="indexterm"></a>to <code class="literal">Arial</code>, and the <code class="literal">Font size</code> to <code class="literal">25</code>.</p></li><li><p>Save <a id="id638" class="indexterm"></a>the scene (<span class="strong"><strong>File</strong></span> | <span class="strong"><strong>Save Scene as</strong></span>) and<a id="id639" class="indexterm"></a> duplicate this scene twice. Rename the duplicates <code class="literal">gameOver</code> and <code class="literal">gameSuccess</code>.</p></li><li><p>Open the <code class="literal">gameOver</code> scene, and <a id="id640" class="indexterm"></a>change the text for the <code class="literal">GUIText</code> object <code class="literal">GUIText_instructions</code> to "<code class="literal">Well, looks like you were not ready yet...try again</code>." Also, change the text of the object labeled <code class="literal">GUIText_clickToContinue</code> to <code class="literal">"Click for a New Game</code>."</p></li><li><p>Save this scene (<span class="strong"><strong>Files</strong></span> | <span class="strong"><strong>Save Scene</strong></span>).</p></li><li><p>Open the <code class="literal">gameSuccess</code> scene, and change the text for the object labeled <code class="literal">GUIText_instructions</code> to "<code class="literal">Well done, you've made it.</code>" Also, change the text of the object labeled <code class="literal">GUIText_clickToContinue</code> to <code class="literal">"Click for a New Game</code>."</p></li><li><p>Open the project settings (<span class="strong"><strong>File</strong></span> | <span class="strong"><strong>Build Settings</strong></span>) and drag-and-drop all the scenes we have created so far (for example, <code class="literal">chapter6</code>, <code class="literal">gameOver</code>, <code class="literal">instructions</code>, <code class="literal">splashScreen</code>, and <code class="literal">gameSuccess</code>) from the <code class="literal">Assets</code> folder to the window labeled <span class="strong"><strong>Build Settings</strong></span>. This will ensure that we can load scenes after clicking on the corresponding buttons. We can now close the window <span class="strong"><strong>Build Settings</strong></span>.</p></li></ol></div><p>Open the script <code class="literal">collisionDetection</code> and<a id="id641" class="indexterm"></a> modify it as highlighted in the following code:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>if (hasKey)</strong></span>
<span class="strong"><strong>{</strong></span>
<span class="strong"><strong>  c.gameObject.animation.Play ("open_door");</strong></span>
  yield WaitForSeconds (1);
<span class="strong"><strong>  Application.LoadLevel("gameSuccess");</strong></span>
<span class="strong"><strong>}</strong></span>
</pre></div><p>In the previous code, we wait for one second, so that the animation for the door is completed. We then open the scene <code class="literal">gameSuccess</code>.</p><p>We can add a background sound to the scenes <code class="literal">gameOver</code>, <code class="literal">gameSuccess</code>, and <code class="literal">instructions</code>: open each scene, select the object <code class="literal">bgSound</code> from the <span class="strong"><strong>Hierarchy</strong></span> window, and drag-and-drop the sound of your choice from the folder <span class="strong"><strong>Assets</strong></span> | <span class="strong"><strong>chapter6</strong></span> | <span class="strong"><strong>Sounds</strong></span> to the <code class="literal">AudioSource</code> attribute<a id="id642" class="indexterm"></a> of the component <code class="literal">Audio Source</code> for the object <code class="literal">bgSound</code>. Note that the sound used for the splash screen can also be used for the instruction<a id="id643" class="indexterm"></a> screen. We can also add a background <a id="id644" class="indexterm"></a>sound for the scene <code class="literal">chapter6</code> by adding both the sound <code class="literal">sound_inGame</code> and the script <code class="literal">muteAudio</code> to the camera within the <span class="strong"><strong>First Person Controller</strong></span> (<span class="strong"><strong>camera1</strong></span>) and ensuring that the options <span class="strong"><strong>Play On Awake</strong></span> and <span class="strong"><strong>Loop</strong></span> are selected for this sound (that is, <code class="literal">Audio Component</code> for the object <span class="strong"><strong>First Person Shooter</strong></span>).</p></div>