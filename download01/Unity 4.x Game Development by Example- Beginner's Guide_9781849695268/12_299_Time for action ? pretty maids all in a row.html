<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch12lvl1sec296"></a>Time for action – pretty maids all in a row</h2></div></div><hr /></div><p>We're going to <a id="id929" class="indexterm"></a>create a 2D array referencing our squares in an interesting way. Follow along.</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Create a standard one-dimensional array to hold the squares by adding this declaration to the <code class="literal">GameLogic</code> script:</p><div class="informalexample"><pre class="programlisting">var XPiece:GameObject;
var OPiece:GameObject;
var currentPlayer:int = 1;
var prompt:GUIText;
<span class="strong"><strong>var aSquares:GameObject[];</strong></span>
</pre></div></li><li><p>Select the <code class="literal">GameLogic</code> GameObject. Set the Size of the <code class="literal">aSquares</code> array to <code class="literal">9</code> in the <span class="strong"><strong>Inspector</strong></span> panel.</p><div class="mediaobject"><img src="/graphics/9781849695268/graphics/5268OT_12_22.jpg" /></div></li><li><p>One by one, making<a id="id930" class="indexterm"></a> sure you get all 9 unique squares with no repeats, click and drag the 9 <code class="literal">Square</code> GameObjects from the <span class="strong"><strong>Hierarchy</strong></span> panel into the array slots in the <span class="strong"><strong>Inspector</strong></span> panel. Another way to accomplish this in a single shot is to leave the array size at <code class="literal">0</code>, and then select the <code class="literal">GameLogic</code> GameObject and lock the Inspector (click the little lock icon at the top right of the panel). With the <code class="literal">GameLogic</code> Inspector locked, you can select all the Squares and drag them en masse onto the array in the <span class="strong"><strong>Inspector</strong></span> panel.</p><div class="mediaobject"><img src="/graphics/9781849695268/graphics/5268OT_12_23.jpg" /></div></li><li><p>We're part of the way there. The <code class="literal">aSquares</code> array gives us references in code to the Squares, but it<a id="id931" class="indexterm"></a> would be difficult to access the squares by their coordinate values with this flat, 1-dimensional array.</p></li><li><p>Off the top of the game, we can pick through the list of Squares and place them in a second two-dimensional array, based on their X and Y values.</p></li><li><p>Modify the <code class="literal">GameLogic</code> scrip:</p><div class="informalexample"><pre class="programlisting">var aSquares:GameObject[];
<span class="strong"><strong>var aGrid:GameObject[,];</strong></span>
function Start () 
{
<span class="strong"><strong>  currentPlayer = 1;</strong></span>
  ShowPlayerPrompt();

<span class="strong"><strong>  aGrid = new GameObject[3,3];</strong></span>

<span class="strong"><strong>  var theSquare:GameObject;</strong></span>
<span class="strong"><strong>  var theScript:Square;</strong></span>

<span class="strong"><strong>  for(var i:int =0; i &lt; aSquares.Length; i++)</strong></span>
  <span class="strong"><strong>{</strong></span>
<span class="strong"><strong>    theSquare = aSquares[i];</strong></span>
<span class="strong"><strong>    theScript = theSquare.GetComponent.&lt;Square&gt;();</strong></span>
<span class="strong"><strong>    aGrid[theScript.x,theScript.y] = theSquare;</strong></span>
<span class="strong"><strong>  }</strong></span>
}</pre></div></li></ol></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch12lvl2sec117"></a>
<span class="emphasis"><em>What just happened – order!</em></span>
</h3></div></div></div><p>The new code parcels the Squares into an<a id="id932" class="indexterm"></a> easily-accessible 2D array, much like the one we used in Robot Repair to store our <code class="literal">Card</code> instances.</p><div class="informalexample"><pre class="programlisting">var aGrid:GameObject[,];</pre></div><p>This following line of code defines a 2D array:</p><div class="informalexample"><pre class="programlisting">aGrid = new GameObject[3,3];</pre></div><p>This line in the <code class="literal">Start</code> function<a id="id933" class="indexterm"></a> defines that 2D array as having 3 elements, each of which contain 3 elements. The net result is, essentially, a matrix of columns and rows.</p><div class="informalexample"><pre class="programlisting">var theSquare:GameObject;
var theScript:Square;</pre></div><p>We declare these two variables above the <code class="literal">for</code> loop instead of inside the <code class="literal">for</code> loop, so that Unity doesn't have to recreate them on every iteration. This will really only matter with a very performance-intensive loop (which this isn't) and Unity's compiler takes care of any inefficiencies from declaring the variables inside the loop anyway, but it helps to know these tips in case you need them down the road in other languages. Declaring the variables outside the loop in Unity can be argued as a stylistic decision.</p><p>
<code class="literal">theSquare</code> will hold a reference to the <code class="literal">Square</code> GameObject that we pull out of the <code class="literal">aSquares</code> array, while <code class="literal">theScript</code> is a reference to the <code class="literal">Square</code> script attached to that <code class="literal">Square</code> GameObject.</p><div class="informalexample"><pre class="programlisting">for(var i:int =0; i &lt; aSquares.Length; i++)
{
  theSquare = aSquares[i];
  theScript = theSquare.GetComponent.&lt;Square&gt;();
  aGrid[theScript.x,theScript.y] = theSquare;
}</pre></div><p>This <code class="literal">for</code> loop has us iterating through all 9 elements of the <code class="literal">aSquares</code> array, which contains references to each Square in the grid. For each Square, we store a reference to its attached <code class="literal">Square</code> script. Then we insert a reference to the Square into the 2D array, using the <code class="literal">x</code> and <code class="literal">y</code> values found in the <code class="literal">Square</code> script attached to it.</p><p>Regardless of the order in which the Squares appear in the <code class="literal">aSquares</code> array, we wind up with a 2D array <a id="id934" class="indexterm"></a>with all the squares sorted by their <code class="literal">x</code> and <code class="literal">y</code> values for easy reference:</p><div class="informalexample"><pre class="programlisting">aGrid[x,y]</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note25"></a>Note</h3><p>There actually is a formula for treating a 1-dimensional array like a 2-dimensional array:</p><p>
<span class="emphasis"><em>x + width * y</em></span>
</p><p>Picture a Tic Tac Toe grid laid out like this:</p><div class="informalexample"><pre class="programlisting">A B C
D E F
G H I</pre></div><p>The 1D array would look like this:</p><div class="informalexample"><pre class="programlisting">[A, B, C, D, E, F, G, H, I]</pre></div><p>The coordinate address of square H is <code class="literal">x:1 y:2</code>. The width of the grid is 3 cells.  So the equation becomes:</p><p>
<span class="emphasis"><em>1 + 3 * 2</em></span>
</p><p>The result is 7.  If we count along the 1D array, starting at the 0th element with <code class="literal">A</code>, the seventh element is <code class="literal">H</code>. It works!</p></div></div></div>