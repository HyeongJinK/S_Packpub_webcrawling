<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch11lvl1sec267"></a>Time for action – give up the func</h2></div></div><hr /></div><p>Let's get that <a id="id854" class="indexterm"></a>function set up in the <span class="strong"><strong>EnemyShip</strong></span> Script first. Double-click to open the <span class="strong"><strong>EnemyShip</strong></span> Script, and get typing.</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Write this new function outside of and apart from the other functions in the script:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>function ResetPosition(){</strong></span>
<span class="strong"><strong>  transform.position.y = 71;</strong></span>
<span class="strong"><strong>  transform.position.x = Random.Range(-11, 68);</strong></span>
<span class="strong"><strong>  transform.position.z = 0;</strong></span>
<span class="strong"><strong>  rigidbody.velocity = Vector3.zero;</strong></span>
<span class="strong"><strong>}</strong></span>
</pre></div><p>These are the very same repositioning lines we already have. You can even just type the shell of the function, and copy/paste those lines right in there. Either way, you need to go back and eradicate those lines from the <code class="literal">Update</code> function <a id="id855" class="indexterm"></a>and replace them with a <code class="literal">ResetPosition()</code> function call.</p></li><li><p>Erase these bolded lines:</p><div class="informalexample"><pre class="programlisting">  if(transform.position.y &lt; -4) {
<span class="strong"><strong>    transform.position.z = 0;</strong></span>
<span class="strong"><strong>    transform.position.y = 71;</strong></span>
<span class="strong"><strong>    transform.position.x = Random.Range(-11, 68);</strong></span>
<span class="strong"><strong>    rigidbody.velocity = Vector3.zero;</strong></span>
  }</pre></div><p>And replace them with the <code class="literal">ResetPosition()</code> function call:</p><div class="informalexample"><pre class="programlisting">  if(transform.position.y &lt; -4) {
<span class="strong"><strong>    ResetPosition();</strong></span>
  }</pre></div><p>When the interpreter hits that <code class="literal">ResetPosition()</code> function call, it'll jump into the <code class="literal">ResetPosition</code> function and run those repositioning lines.</p><p>Save the <span class="strong"><strong>EnemyShip</strong></span> Script. Next, hop over to the <span class="strong"><strong>HeroShip</strong></span> Script to make some changes.</p></li><li><p>Get rid <a id="id856" class="indexterm"></a>of those old repositioning lines from the <span class="strong"><strong>HeroShip</strong></span> Script. Delete the lines in bold:</p><div class="informalexample"><pre class="programlisting">function OnCollisionEnter(col : Collision) {
    // (a few lines omitted here for clarity)
<span class="strong"><strong>    col.gameObject.transform.position.y = 50;</strong></span>
<span class="strong"><strong>    col.gameObject.transform.position.z = -16;</strong></span>
<span class="strong"><strong>    col.gameObject.transform.position.x = Random.Range(-11,68);</strong></span>
</pre></div></li><li><p>Replace <a id="id857" class="indexterm"></a>those lines with these ones:</p><div class="informalexample"><pre class="programlisting">function OnCollisionEnter(col : Collision) {
   // (a few lines omitted here for brevity)
<span class="strong"><strong>   if(col.gameObject.GetComponent(EnemyShip))</strong></span>
<span class="strong"><strong>   {</strong></span>
<span class="strong"><strong>      col.gameObject.GetComponent(EnemyShip).ResetPosition();</strong></span>
<span class="strong"><strong>   }</strong></span>
}</pre></div><p>Here's how the<a id="id858" class="indexterm"></a> whole <code class="literal">OnCollisionEnter</code> function should look:</p><div class="informalexample"><pre class="programlisting">  function OnCollisionEnter(col : Collision) {
    if(col.gameObject.tag == "bomb")
    {
    // I got hit by a bomb!
      Instantiate(explosion, col.gameObject.transform.position,
      Quaternion.identity);
    }

    if(col.gameObject.GetComponent(EnemyShip))
    {
       col.gameObject.GetComponent(EnemyShip).ResetPosition();
    }
  }</pre></div></li></ol></div><p>Let's break those new lines down.</p><div class="informalexample"><pre class="programlisting">if(col.gameObject.GetComponent(EnemyShip)){</pre></div><p>The value of <code class="literal">col</code> is something of type <code class="literal">Collision</code>. The <code class="literal">Collision</code> class has a variable called <code class="literal">gameObject</code>, which refers to the GameObject involved in the collision. The <code class="literal">Game Object</code> class has a function called <code class="literal">GetComponent</code>. You can pass the name of the script you want to access as an argument.</p><p>In this case, we're referring to the <span class="strong"><strong>EnemyShip</strong></span> Script attached to whatever hit the <span class="strong"><strong>HeroShip</strong></span>. By wrapping it in an <code class="literal">if</code> statement, we're effectively saying "if whatever just hit the <span class="strong"><strong>HeroShip</strong></span> has a component called <span class="strong"><strong>EnemyShip</strong></span> attached to it..."</p><div class="informalexample"><pre class="programlisting">col.gameObject.GetComponent(EnemyShip).ResetPosition();</pre></div><p>… then call the <code class="literal">ResetPosition()</code> function on that script.</p><p>Our conditional check confirms that such a script even exists on the colliding object, by returning (answering) <code class="literal">true</code> or <code class="literal">false</code>. (Recall that conditional <code class="literal">if</code> statements always have to boil down to one of these two boolean states: <code class="literal">true</code> or <code class="literal">false</code>.)</p><p>Later, if a hypothetical <span class="strong"><strong>FallingStar</strong></span> GameObject hits the ship, and it doesn't have a script called <span class="strong"><strong>EnemyShip</strong></span> attached to it, we would get an error when trying to refer to the <span class="strong"><strong>EnemyShip</strong></span> script. The conditional statement protects us from<a id="id859" class="indexterm"></a> getting that <a id="id860" class="indexterm"></a>error. We check to see if that script exists on the colliding object before we go calling any functions on it.</p><p>The end result of all this is that when the <span class="strong"><strong>EnemyShip</strong></span> hits the bottom of the screen, it calls the <code class="literal">ResetPosition()</code> function and pops back up to the top. When the <span class="strong"><strong>EnemyShip</strong></span> (or any <span class="strong"><strong>GameObject</strong></span> with the <span class="strong"><strong>EnemyShip</strong></span> Script component attached) hits the <span class="strong"><strong>HeroShip</strong></span>, the <span class="strong"><strong>HeroShip</strong></span> Script calls the <span class="strong"><strong>EnemyShip</strong></span> Script's <code class="literal">ResetPosition()</code> function, and the <span class="strong"><strong>EnemyShip</strong></span> pops back to the top of the screen.</p><p>Save the script and give your game a try! The enemy ship resets its position in both of these cases. Success!</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip54"></a>Tip</h3><p>
<span class="strong"><strong>Optimization</strong></span>
</p><p>Here's one example of how we could optimize our code to make it more efficient. The <code class="literal">GetComponent</code> function is an "expensive" operation, which means that it takes longer for the computer to execute than other built-in functions. You'll notice that we're calling the function here twice. We could store the <a id="id861" class="indexterm"></a>results of the <code class="literal">GetComponent</code> function in a variable. Then we'd have to call that function only once. Look<a id="id862" class="indexterm"></a> here:</p><div class="informalexample"><pre class="programlisting">var other = col.gameObject.GetComponent(EnemyShip);
if (other) {
   other.ResetPosition();
}</pre></div><p>As with refactoring (making the code pretty), we should focus on getting our code to work first. Then we can go back to make it faster and cleaner.</p></div></div>