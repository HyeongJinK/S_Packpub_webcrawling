<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch06lvl1sec172"></a>Time for action – building the card-flipping function</h2></div></div><hr /></div><p>The game will let the <a id="id482" class="indexterm"></a>player flip over two cards. Then, it will<a id="id483" class="indexterm"></a> pause for a brief moment and flip the cards back over. We'll worry about detecting matches for our grand finale in just a moment.</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Add the following code to your <code class="literal">FlipCardFaceUp</code> function:</p><div class="informalexample"><pre class="programlisting">   function FlipCardFaceUp(card:Card)
   {
     card.isFaceUp = true;
   <span class="strong"><strong>  aCardsFlipped.Add(card);</strong></span>
   
   <span class="strong"><strong>  if(aCardsFlipped.Count == 2)</strong></span>
   <span class="strong"><strong>  {</strong></span>
   <span class="strong"><strong>    playerCanClick = false;</strong></span>
   <span class="strong"><strong>         </strong></span>
   <span class="strong"><strong>    yield WaitForSeconds(1);</strong></span>
   <span class="strong"><strong>         </strong></span>
   <span class="strong"><strong>    aCardsFlipped[0].isFaceUp = false;</strong></span>
   <span class="strong"><strong>    aCardsFlipped[1].isFaceUp = false;</strong></span>
   
   <span class="strong"><strong>    aCardsFlipped = new List.&lt;Card&gt;();</strong></span>
   <span class="strong"><strong>      </strong></span>
   <span class="strong"><strong>    playerCanClick = true;</strong></span>
   <span class="strong"><strong>   }</strong></span>
   }</pre></div></li><li><p>Then, make a small change to one line in the <code class="literal">BuildGrid</code> function:</p><div class="informalexample"><pre class="programlisting">   if(GUILayout.Button(Resources.Load(img),
     GUILayout.Width(cardW)))
   {
<span class="strong"><strong>     if(playerCanClick)</strong></span>
<span class="strong"><strong>     {</strong></span>
       FlipCardFaceUp(card);
<span class="strong"><strong>     }</strong></span>
    Debug.Log(card.img);
   }</pre></div></li><li><p>Save and test. You should be able to flip over two cards before your incessant clicking falls on deaf ears. After a one-second pause, the cards flip back over.</p></li></ol></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec69"></a>
<span class="emphasis"><em>What just happened – dissecting the flip</em></span>
</h3></div></div></div><p>Let's take a look at<a id="id484" class="indexterm"></a> what we've just done:</p><div class="informalexample"><pre class="programlisting">aCardsFlipped.Add(card);</pre></div><p>In this line, we're adding the card to our <code class="literal">aCardsFlipped</code> generic list.</p><div class="informalexample"><pre class="programlisting">if(aCardsFlipped.Count == 2)</pre></div><p>Next, our conditional checks to see if the player has flipped over two cards—in that case, the <code class="literal">Count</code> property should be <code class="literal">2</code>. Remember that <code class="literal">aCardsFlipped</code> is from the <code class="literal">Generic List</code> class, not the <code class="literal">Array</code> class, and the two are different beasts. To check the length of an <code class="literal">Array</code>, we use <code class="literal">Length</code>. To check the length of  Generic List, we use <code class="literal">Count</code>. The <code class="literal">Count</code> of our List goes up when we use the <code class="literal">Add()</code> method, which throws additional items into the list.</p><div class="informalexample"><pre class="programlisting">playerCanClick = false;</pre></div><p>Our <code class="literal">playerCanClick</code> flag comes in handy here—by setting it to <code class="literal">false</code>, we prevent the fiendish player from flipping over more cards than he ought to.</p><div class="informalexample"><pre class="programlisting">yield WaitForSeconds(1);</pre></div><p>This straightforward piece of code waits for one second before allowing the next lines of code to execute.</p><div class="informalexample"><pre class="programlisting">aCardsFlipped[0].isFaceUp = false;
aCardsFlipped[1].isFaceUp = false;</pre></div><p>These lines flag the two flipped-over cards back to their unflipped states. The next time the <code class="literal">OnGUI</code> function runs, which will be very soon, the cards will be drawn wrench side up. The first flipped card is at index 0 of the <code class="literal">aCardsFlipped</code> list, and the second flipped card is at index 1.</p><div class="informalexample"><pre class="programlisting">aCardsFlipped = new List.&lt;Card&gt;();</pre></div><p>By reinitializing the <code class="literal">aCardsFlipped</code> Generic List, we're emptying it out to hold two brand new flipped-over cards later on.</p><div class="informalexample"><pre class="programlisting">playerCanClick = true;</pre></div><p>Now that it's safe to start flipping cards again, we'll flag the <code class="literal">playerCanClick</code> variable back to <code class="literal">true</code>.</p><div class="informalexample"><pre class="programlisting">if(playerCanClick)
{
  FlipCardFaceUp(card);
}</pre></div><p>By adding this simple<a id="id485" class="indexterm"></a> condition at the beginning of the <code class="literal">FlipCardFaceUp()</code> function call, we can control whether or not the player is allowed to flip over the card. If <code class="literal">playerCanClick</code> resolves to <code class="literal">false</code>, NO FLIPPY.</p></div></div>