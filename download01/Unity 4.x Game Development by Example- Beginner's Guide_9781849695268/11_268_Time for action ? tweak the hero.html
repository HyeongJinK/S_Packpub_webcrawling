<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch11lvl1sec266"></a>Time for action – tweak the hero</h2></div></div><hr /></div><p>There are a <a id="id850" class="indexterm"></a>few changes we should make to the <span class="strong"><strong>HeroShip</strong></span> Script (formerly the <span class="strong"><strong>Character</strong></span> Script) to suit our new game. Let's do it:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Open the <span class="strong"><strong>HeroShip</strong></span> Script.</p></li><li><p>Delete the <code class="literal">else if</code> condition handling the steins. Get rid of everything in this snippet in bold:</p><div class="informalexample"><pre class="programlisting">if(col.gameObject.tag == "bomb")
{
    audio.PlayOneShot(explosionSound);
    Instantiate(explosion, col.gameObject.transform.position,
        Quaternion.identity);
} <span class="strong"><strong>else if (col.gameObject.tag == "stein") {</strong></span>
<span class="strong"><strong>    animation.Play("catch"); // Ima catch that stein!</strong></span>
<span class="strong"><strong>}</strong></span>
</pre></div><p>
<span class="strong"><strong>Shoot the Moon</strong></span> doesn't have beer steins, so we can safely kill this chunk.</p></li><li><p>Delete all of the code controlling the character model animation. Get rid of this whole section in bold:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>if(lastX != transform.position.x) {</strong></span>
<span class="strong"><strong>    // x values between this Update cycle and the last one</strong></span>
<span class="strong"><strong>    // aren't the same! That means the player is moving the // mouse.</strong></span>
<span class="strong"><strong>    if(!isMoving) {</strong></span>
<span class="strong"><strong>      // the player was standing still.</strong></span>
<span class="strong"><strong>      // Let's flag him to "isMoving"</strong></span>
<span class="strong"><strong>      isMoving = true;</strong></span>
<span class="strong"><strong>      if(!animation.IsPlaying("catch")){</strong></span>
<span class="strong"><strong>      animation.Play("step");</strong></span>
<span class="strong"><strong>        }</strong></span>
<span class="strong"><strong>    }</strong></span>
<span class="strong"><strong>    } else {</strong></span>
<span class="strong"><strong>      // The player's x position is the same this Update cycle</strong></span>
<span class="strong"><strong>      // as it was the last! The player has stopped moving the// mouse.</strong></span>
<span class="strong"><strong>      if(isMoving) {</strong></span>
<span class="strong"><strong>        // The player has stopped moving, so let's update the flag.</strong></span>
<span class="strong"><strong>        isMoving = false;</strong></span>
<span class="strong"><strong>        if(!animation.IsPlaying("catch")){</strong></span>
<span class="strong"><strong>        animation.Play("idle");</strong></span>
<span class="strong"><strong>        }</strong></span>
<span class="strong"><strong>      }</strong></span>
<span class="strong"><strong>  }</strong></span>
<span class="strong"><strong>  lastX = transform.position.x;</strong></span>
</pre></div></li><li><p>Delete<a id="id851" class="indexterm"></a> the <code class="literal">isMoving</code> variable from the top of the script:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>    var isMoving:boolean = false; // flags whether or not the player is in motion</strong></span>
</pre></div></li><li><p>Delete the <code class="literal">lastX</code> variable definition from the top of the script:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>    var lastX:float; // this will store the last position of thecharacter</strong></span>
</pre></div></li><li><p>Delete the entire <code class="literal">Start</code> function:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>    function Start() {</strong></span>
<span class="strong"><strong>        animation.Stop();  // this stops Unity from playing thecharacter's default animation.</strong></span>
<span class="strong"><strong>    }</strong></span>
</pre></div></li></ol></div><p>The hero ship doesn't have any default animation, so this code is unnecessary.</p><p>Here's how the complete, freshly preened script should look:</p><div class="informalexample"><pre class="programlisting">var explosion:GameObject;

function Update() {
   transform.position.x = (Input.mousePosition.x)/20;
}

function OnCollisionEnter(col : Collision) {
   if(col.gameObject.tag == "bomb")
   {
      // I got hit by a bomb!
      Instantiate(explosion, col.gameObject.transform.position,
        Quaternion.identity);
   }
   col.gameObject.transform.position.y = 50;
   col.gameObject.transform.position.x = Random.Range(-11,68);
   col.gameObject.transform.z = -16;
}</pre></div><p>Our human <a id="id852" class="indexterm"></a>character in The Break-Up had animation cycles that we tapped into, but the <span class="strong"><strong>HeroShip</strong></span> model doesn't. Unity will keep throwing complaints that it can't find these animations unless we tidy up the code as described above.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch11lvl2sec106"></a>
<span class="emphasis"><em>What just happened – hooray for lazy!</em></span>
</h3></div></div></div><p>Take a look at these three lines in our <span class="strong"><strong>HeroShip</strong></span> Script:</p><div class="informalexample"><pre class="programlisting">col.gameObject.transform.position.y = 50;
col.gameObject.transform.position.x = Random.Range(-11,68);
col.gameObject.transform.z = -16;</pre></div><p>Those are the lines we used to reposition the falling object when it hit the player. We have similar lines in our <span class="strong"><strong>EnemyShip</strong></span> Script that we just updated with new values. Should we do the <a id="id853" class="indexterm"></a>same thing here? What if the values have to change again later? Then we'll have to update the code in two different scripts. And that, in professional parlance, is irritating.</p><p>It makes sense to fold this code into some kind of <code class="literal">ResetPosition</code> function that both scripts can call, yes? Then we'll only ever have to update the values in one place. BUT can you really call a function on one script from a completely different script? Yes, Virginia, there is a Santa Claus.</p></div></div>