<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch09lvl1sec68"></a>Examples</h2></div></div><hr /></div><p>Working with World Space Canvases isn't significantly different than working with Canvases in Screen and Camera Space. World Space Canvases offer many benefits. If you have an object that exists within your scene that has UI specifically <span>tied</span><a id="id325334225" class="indexterm"></a> to its location, it is helpful to use a World Space Canvas so that the UI "follows" it wherever it is. This removes the necessity of trying to convert the object's World Space Coordinates to Screen Coordinates to ensure that the UI always lines up with the object. It also guarantees that the UI object will always display correctly with respect to the object's location, even when the screen's resolution changes. In this chapter, I will cover two common uses of World Space Canvases: one in 2D space and another in 3D space.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl2sec92"></a>2D World Space status indicators</h3></div></div></div><p>For this example, we will start a new scene. For you to <span>not</span><a id="id325369906" class="indexterm"></a> have to build out the scene, we will start with an <strong class="userinput"><code>Asset</code></strong> package that includes all the required items.</p><p>We'll create UI that allows a character to have a status indicator pop up above his head. After the scene has played for 3 seconds, a status-indicating button will appear over his head. Once the player clicks on the status indicator, a dialog will appear. After 5 seconds, the dialog will disappear. The status indicator will re-appear 10 seconds later.</p><div class="mediaobject"><img src="/graphics/9781787125520/graphics/9691f881-38ad-4282-a996-df9c3992f77d.png" /></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note96"></a>Note</h3><p>The art used in this example was accessed from <a class="ulink" href="https://opengameart.org/content/medieval-rts-120" target="_blank">https://opengameart.org/content/medieval-rts-120</a>.</p></div><p>To create the status-indicating UI demonstrated <span>by</span><a id="id325630976" class="indexterm"></a> the previous example, complete the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Import the <code class="literal">Chapter 9 Example 1-Starting.unitypackage</code> package. This package contains a scene with a background image and a 2D sprite named <code class="literal">Mage</code>. The <code class="literal">Assets/Scripts/MageInteractions.cs</code>script included with the package controls the timers on the appearance of the status indicator and is included in the package. This script requires two Canvas Group items—<code class="literal">theExclaimationPoint</code> and <code class="literal">theDialogBox</code>—and contains a function, <code class="literal">ShowTheDialogBox()</code>, that can be called via a button's <code class="literal">On Click ()</code> event.</li><li>We want the status indicator and the dialog to be tied to the position of the <code class="literal">Mage</code> within the scene. Therefore, we will create a Canvas that is a child of the <code class="literal">Mage</code> in <strong class="userinput"><code>World Space</code></strong>.
Right-click on the <code class="literal">Mage</code> in the Hierarchy and add a UI Canvas as a child of the <code class="literal">Mage</code>.</li><li>Select the newly created <code class="literal">Canvas</code>. Change the <strong class="userinput"><code>Render Mode</code></strong> on the Canvas Component to <strong class="userinput"><code>World Space</code></strong>.</li><li>Assign the <code class="literal">Main Camera</code> to the <strong class="userinput"><code>Event Camera</code></strong> slot.</li><li>Since this Canvas is a child of <code class="literal">Mage</code>, its coordinate system is relative to the <code class="literal">Mage</code>. To have it perfectly positioned over the <code class="literal">Mage</code>, change both the Rect Transform <strong class="userinput"><code>Pos X</code></strong> and <strong class="userinput"><code>Pos Y</code></strong> to <code class="literal">0</code>.</li></ol></div><div class="orderedlist"><ol class="orderedlist arabic" start="6" type="1"><li>The <code class="literal">Canvas</code> is significantly bigger than the <code class="literal">Mage</code>. Make the size more reasonable by changing both the Rect Transform <strong class="userinput"><code>Width</code></strong> and <strong class="userinput"><code>Height</code></strong> to <code class="literal">1</code>.</li><li>Now that we have the Canvas scaled and positioned in the scene around the <code class="literal">Mage</code>, we can add UI Elements to it. Right-click on <code class="literal">Canvas</code> in the Hierarchy and create a UI Button. Name the new button <code class="literal">Alert</code>.</li><li>Resize the Button to match the <code class="literal">Canvas</code> by setting its <strong class="userinput"><code>Rect Transform</code></strong> stretch and anchor to stretch fully across the <code class="literal">Canvas</code>.</li><li>Change the <strong class="userinput"><code>Source Image</code></strong> on the <code class="literal">Alert</code> Button's Image component to the UI <code class="literal">Knob</code> image. It looks better as a circle <span>than</span><a id="id325370083" class="indexterm"></a> as the default button sprite:
<div class="mediaobject"><img src="/graphics/9781787125520/graphics/42f3edd0-9e20-4489-a4f7-3f18ca890f0b.png" /></div></li><li>Change the <code class="literal">Text</code> child of <code class="literal">Alert</code> to display <code class="literal">!</code> instead of <code class="literal">Button</code>.</li><li>The Button's text is not currently visible. To fix this, change the <strong class="userinput"><code>Dynamic Pixels Per Unit</code></strong> property on the <strong class="userinput"><code>Canvas Scalar</code></strong> component of <code class="literal">Canvas</code> to <code class="literal">1000</code>.</li><li>Move the <code class="literal">Alert</code> Button so that it is positioned over the <code class="literal">Mage</code>'s head.
<div class="mediaobject"><img src="/graphics/9781787125520/graphics/b12b326c-e17a-4cce-8afc-1799aa6d12df.png" /></div></li></ol></div><div class="orderedlist"><ol class="orderedlist arabic" start="13" type="1"><li>Add a <strong class="userinput"><code>Canvas Group</code></strong> component to the <code class="literal">Alert</code> Button.</li><li>Set the <strong class="userinput"><code>Canvas Group</code></strong> component's <strong class="userinput"><code>Alpha</code></strong> property to <code class="literal">0</code>, and set both the <strong class="userinput"><code>Interactable</code></strong> and <strong class="userinput"><code>Blocks Raycasts</code></strong> properties to <strong class="userinput"><code>False</code></strong>.</li><li>Give the <code class="literal">Alert</code> Button an <strong class="userinput"><code>On Click ()</code></strong> Event that calls the <code class="literal">ShowTheDialogBox()</code> function on the <code class="literal">MageInteractions</code> script attached to the <code class="literal">Mage</code>:
<div class="mediaobject"><img src="/graphics/9781787125520/graphics/8e99cd73-0767-4b51-9adf-8bcf1afe9359.png" /></div></li><li>Right-click on <code class="literal">Canvas</code> in the Hierarchy and create a UI Text object. Name the new <code class="literal">Text</code> object <code class="literal">Dialog</code>.</li><li>Resize the <code class="literal">Text</code> object to match the <code class="literal">Canvas</code> by setting its <strong class="userinput"><code>Rect Transform</code></strong> stretch and anchor to stretch fully across the <code class="literal">Canvas</code>.</li><li>Change the <strong class="userinput"><code>Text</code></strong> component on the <code class="literal">Dialog</code> object to say <code class="literal">Thanks!!!</code>. Also, center align the text and set the <strong class="userinput"><code>Horizontal Overflow</code></strong> to <strong class="userinput"><code>Overflow</code></strong>.</li><li>Move the <code class="literal">Dialog</code> object so that it is <span>positioned</span><a id="id325631078" class="indexterm"></a> above the head of the <code class="literal">Mage</code>:
<div class="mediaobject"><img src="/graphics/9781787125520/graphics/3d4ba3f8-8ae4-442f-9f99-d5d226935548.png" /></div></li><li>Add a <strong class="userinput"><code>Canvas Group</code></strong> component to the <code class="literal">Dialog</code> Text object.</li><li>Set the <strong class="userinput"><code>Canvas Group</code></strong> component's <strong class="userinput"><code>Alpha</code></strong> property to <code class="literal">0</code>, and set both the <strong class="userinput"><code>Interactable</code></strong> and the <strong class="userinput"><code>Blocks Raycasts</code></strong> properties to <strong class="userinput"><code>False</code></strong>.</li><li>Select the Mage and add <code class="literal">Alert</code> to <strong class="userinput"><code>The Exclamation Point</code></strong> property and add <code class="literal">Dialog</code> to <strong class="userinput"><code>The Dialog Box</code></strong> property.</li></ol></div><p>If you play the game, you'll see the exclamation point Button appear after 3 seconds. Clicking on the Button will make the <code class="literal">Text</code> appear. Try moving around the <code class="literal">Mage</code> in the scene. You'll see that, no matter where he is, the exclamation point Button and Text appear over his head. This is a really helpful technique for creating UI elements <span>that</span><a id="id325631155" class="indexterm"></a> stay with moving characters.</p><p>I know that the example is a bit boring the way it is now, but I recommend using some of the techniques discussed in <a class="link" href="#" linkend="ch08">Chapter 8</a>, <span class="emphasis"><em>Animations and Particles in the UI</em></span>, to add a nice bouncy animation to the exclamation point and have the Text fade in and out.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl2sec93"></a>3D hovering health bars</h3></div></div></div><p>Making World Space UI in a 3D scene <span>takes</span><a id="id325631181" class="indexterm"></a> a little more work than making World Space UI in a 2D scene if the camera can be rotated and moved throughout the 3D space. If the camera can move and rotate, the UI likely needs to constantly <span class="emphasis"><em>face</em></span> the camera. Otherwise, the player will not be able to see the UI Element.</p><p>For this example, we will once again create a new scene. <span>For you to not have to build out the scene, we will start with an <code class="literal">Asset</code> package that includes all the required items</span>.</p><p>We'll create a simple hovering health bar that constantly faces the camera. It will also receive clicks so that we can watch the health bar <span>reduce:</span></p><div class="mediaobject"><img src="/graphics/9781787125520/graphics/2ae2f0d1-85f9-46db-b81a-76f75054cc09.png" /></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note97"></a>Note</h3><p>The art used in this example was accessed from <a class="ulink" href="https://opengameart.org/content/space-kit" target="_blank">https://opengameart.org/content/space-kit</a>.</p></div><p>To create the health bar that always faces the camera and receives player-click input, complete the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Import the Chapter <code class="literal">9 Example 2-Starting.unitypackage</code> package. This package contains a scene with a 3D character facing the camera. The camera uses the Standard Unity Asset <code class="literal">FreeLookCameraRig</code> provided by Unity. The package also contains a <code class="literal">ReduceHealth</code>script that is attached to the <code class="literal">astronaut</code> character. This script has a function, <code class="literal">ReduceHealthBar</code>, that we will call when the health bar above the character's head is clicked on.</li><li>We want the health bar to be tied to the position of the <code class="literal">astronaut</code> within the scene. Therefore, we will create a Canvas that is a child of the <code class="literal">astronaut</code> in World Space.
Right-click on the <code class="literal">astronaut</code> in the Hierarchy and add a UI Canvas as a child of the <code class="literal">astronaut</code>.</li><li>Select the newly created <code class="literal">Canvas</code>, and change the <strong class="userinput"><code>Render Mode</code></strong> on the <strong class="userinput"><code>Canvas Component</code></strong> to <strong class="userinput"><code>World Space</code></strong>.</li><li>The <code class="literal">Main Camera</code> is a child of <code class="literal">FreeLookCameraRig/Pivot</code>. Assign the <code class="literal">Main Camera</code> to the <strong class="userinput"><code>Event Camera</code></strong> slot.</li><li>Since this Canvas is a child of <code class="literal">astronaut</code>, its coordinate system is relative to the <code class="literal">astronaut</code>. To have it perfectly positioned over the <code class="literal">astronaut</code>, change both the Rect Transform <strong class="userinput"><code>Pos X</code></strong> and <strong class="userinput"><code>Pos Y</code></strong> to <code class="literal">0</code>.</li><li>The <code class="literal">Canvas</code> is significantly bigger than the <code class="literal">astronaut</code>. Make the size more reasonable by changing the Rect Transform <strong class="userinput"><code>Width</code></strong> to <code class="literal">10</code> and the <strong class="userinput"><code>Height</code></strong> to <code class="literal">1</code>.</li><li>Position the Canvas so that it is above the head of the <code class="literal">astronaut</code>:
<div class="mediaobject"><img src="/graphics/9781787125520/graphics/a12d2f67-5b60-477d-8192-733bbdb641a7.png" /></div></li><li>Now that we have the Canvas scaled and positioned in the scene around the <code class="literal">astronaut</code>, we can add UI Elements to it. Right-click on <code class="literal">Canvas</code> in the Hierarchy and create a UI Button. Name the new button <code class="literal">Health Bar</code>.</li><li>Resize the Button to match the <code class="literal">Canvas</code> by setting its <strong class="userinput"><code>Rect Transform</code></strong> stretch and anchor to stretch fully across the <code class="literal">Canvas</code>.</li><li>Change the <strong class="userinput"><code>Source Image</code></strong> on the <strong class="userinput"><code>Image</code></strong> component of the <code class="literal">Health Bar</code> to <strong class="userinput"><code>None</code></strong> to give it a white rectangle as an image:
<div class="mediaobject"><img src="/graphics/9781787125520/graphics/619f5277-6211-4d69-9143-23a18ef4611a.png" /></div></li></ol></div><div class="orderedlist"><ol class="orderedlist arabic" start="11" type="1"><li>Change the <code class="literal">Text</code> child of <code class="literal">Health Bar</code> to say <code class="literal">Click to reduce my health</code>.</li><li>Set both the <strong class="userinput"><code>Horizontal Overflow</code></strong> and <strong class="userinput"><code>Vertical Overflow</code></strong> properties of the Text component on the <code class="literal">Text</code> child to <strong class="userinput"><code>Overflow</code></strong>. This will allow you to see the size the text is currently rendering at in the scene:
<div class="mediaobject"><img src="/graphics/9781787125520/graphics/a4552af9-964c-4c05-b160-0fe5b4b01992.png" /></div></li><li>Set the Text's <strong class="userinput"><code>Font Size</code></strong> to <code class="literal">10</code>, and deselect the <strong class="userinput"><code>Raycast Target</code></strong> on the <strong class="userinput"><code>Text</code></strong> component.</li><li>Select the Canvas and hover over the <strong class="userinput"><code>Dynamic Pixels Per Unit</code></strong>property in the <strong class="userinput"><code>Canvas Scaler</code></strong> component until you see two <span>arrows</span><a id="id325631513" class="indexterm"></a> appear around your mouse cursor. Once you see those arrows, click and drag to the right. This makes the property work like a slider, allowing you to see how increasing the <strong class="userinput"><code>Dynamic Pixels Per Unit</code></strong> property continuously changes the way the text renders in the scene. Do this until the text fits within the Canvas:
<div class="mediaobject"><img src="/graphics/9781787125520/graphics/567c1584-25ba-4c4a-a673-04e3e6054d02.png" /></div></li></ol></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip98"></a>Note</h3><p>When trying to get the text to look nice in 3D space, if only changing the <strong class="userinput"><code>Dynamic Pixels Per Unit Size</code></strong> results in <span class="emphasis"><em>choppy</em></span> text, change the property until the text looks <strong class="userinput"><code>Dynamic Pixels Per Unit Size</code></strong> perfectly crisp in the scene. Then, use a combination of changing the Rect Transform <strong class="userinput"><code>Scale</code></strong> and <strong class="userinput"><code>Font Size</code></strong> of the <code class="literal">Text</code> object to find the <span class="emphasis"><em>sweet spot</em></span>.</p></div><div class="orderedlist"><ol class="orderedlist arabic" start="15" type="1"><li>Right-click on the <code class="literal">Health Bar</code> Button and add a UI Image as a child. Name the new Image <code class="literal">Health Fill</code>.</li><li>Resize <code class="literal">Health Fill</code> to match the <code class="literal">Canv Health Bar</code> by setting its Rect Transform stretch and anchor to stretch fully across the <code class="literal">Health Bar</code>.</li><li>Now change the anchor and <span>pivot</span><a id="id325631592" class="indexterm"></a> to left stretch so that it will scale <span class="emphasis"><em>leftward</em></span>.
<div class="mediaobject"><img src="/graphics/9781787125520/graphics/bed2624d-f8c8-435c-8e38-ac7aae6f9493.png" /></div></li><li>Reposition the <code class="literal">Health Bar</code> in the Hierarchy so that it is above <code class="literal">Text</code>. This will have the fill render behind the <code class="literal">Text</code> object.
<div class="mediaobject"><img src="/graphics/9781787125520/graphics/351ac938-8531-4375-9231-6654b01f25f8.png" /></div></li></ol></div><div class="orderedlist"><ol class="orderedlist arabic" start="19" type="1"><li>On the <strong class="userinput"><code>Image</code></strong> component of the <code class="literal">Health Fill</code>, change the <strong class="userinput"><code>Color</code></strong> property to red and deselect the <strong class="userinput"><code>Raycast Target</code></strong> property.</li><li>Select the <code class="literal">astronaut</code> and assign the <code class="literal">Health Fill</code> object to the <strong class="userinput"><code>Health Fill</code></strong> property on the <code class="literal">ReduceHealth</code> component.</li><li>Add an <strong class="userinput"><code>On Click()</code></strong> Event to the <code class="literal">Health Bar</code> Button that calls the <code class="literal">ReduceHealthBar</code> function of the <code class="literal">ReduceHealth</code> script on the <code class="literal">astronaut</code>:
<div class="mediaobject"><img src="/graphics/9781787125520/graphics/a3014a38-5207-455c-9add-a81c8c5d5be1.png" /></div>
Playing the game now should result in the <code class="literal">Health Fill</code> reducing its fill value when you click on the <code class="literal">Health Bar</code> Button:
<div class="mediaobject"><img src="/graphics/9781787125520/graphics/5cdbf910-e29b-4dca-a8e6-80ad088a306b.png" /></div></li><li>Now we just need to add a billboard effect to the <code class="literal">Canvas</code>. Create a new script called <code class="literal">BillboardPlane</code> in the <code class="literal">Assets/Scripts</code> folder.</li><li>Change the script of the <code class="literal">BillboardPlane</code> class to the following:</li></ol></div><pre class="programlisting">public Camera theCamera;

void Update(){
    transform.LookAt(2*transform.position-theCamera.transform.position);
}</pre><div class="orderedlist"><ol class="orderedlist arabic" start="24" type="1"><li>Attach the <code class="literal">BillboardPlane</code> script to the <code class="literal">Canvas</code>.</li><li>Assign the <code class="literal">Main Camera</code> to <strong class="userinput"><code>The Camera</code></strong> slot in the <code class="literal">BillboardPlane</code> component.</li></ol></div><p>If you play the game now, you'll see that, as you <span>move</span><a id="id325368770" class="indexterm"></a> the camera around, the health bar always faces the <code class="literal">Main Camera</code>. Try changing the <strong class="userinput"><code>Transform</code></strong> position of the camera in the scene to see the <code class="literal">LookAt()</code> function work more drastically.</p></div></div>