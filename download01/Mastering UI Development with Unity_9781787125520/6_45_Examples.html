<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch06lvl1sec48"></a>Examples</h2></div></div><hr /></div><p>In this chapter, we'll expand on the scene we've been building further and also add in a new scene that occurs between our start screen <span>and</span><a id="id325368569" class="indexterm"></a> our main game screen.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec68"></a>Animated text</h3></div></div></div><p>First, we will create a new <span>scene</span><a id="id325368584" class="indexterm"></a> that acts like a "cut scene" between our start screen and our gameplay scene. It will include our cat, introducing itself. The text will animate in as if it is being typed, and the user will have the option to <span>speed</span><a id="id325368593" class="indexterm"></a> it up by pressing a button. Once the text is fully displayed, pressing that same button will either show the next block of text or go to the gameplay scene. The text windows will appear as follows:</p><div class="mediaobject"><img src="/graphics/9781787125520/graphics/a637aa85-17a6-4c52-82c9-71e02df548fa.png" /></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch06lvl3sec45"></a>Creating a Background Canvas prefab and a new scene</h4></div></div></div><p>Before we can start making animated text, we need to <span>build</span><a id="id325368617" class="indexterm"></a> out our scene. In both the scenes we have created so far, we have used the <code class="literal">Background Canvas</code> to display the background image, and we will use it again in a new scene.</p><p>Since it's likely that we will use this <code class="literal">Background Canvas</code> multiple times, we should create a <code class="literal">Background Canvas</code> prefab. A prefab is a reusable GameObject. Using a prefab in a scene creates an instance of the prefab within the scene. If you make a <span>change</span><a id="id325599111" class="indexterm"></a> to the saved prefab, the change will be reflected to all prefab unbroken instances across all scenes.</p><p>To create a reusable <code class="literal">Background Canvas</code> prefab GameObject, complete the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Create a new folder named <code class="literal">Prefabs</code> within your <code class="literal">Assets</code> folder. We'll use this folder to store any prefabs we create in the future.</li><li>Drag the <code class="literal">Background Canvas</code> GameObject from the <strong class="userinput"><code>Hierarchy</code></strong> into the <code class="literal">Prefabs</code> folder within the <strong class="userinput"><code>Project</code></strong> view. The name <code class="literal">Background Canvas</code> should now be blue in the <strong class="userinput"><code>Hierarchy</code></strong> (symbolizing that it is a prefab).</li><li>Let's create a new scene in which we will use this <code class="literal">Background Canvas</code> prefab. Create a new scene called <code class="literal">Chapter6AnimatedText</code>.</li></ol></div><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>Drag the <code class="literal">Background Canvas.prefab</code> into the new <span>scene</span><a id="id325630298" class="indexterm"></a> from the <strong class="userinput"><code>Project</code></strong> view.</li><li>Assign the <code class="literal">Main Camera</code> to the <strong class="userinput"><code>Render Camera</code></strong> slot of the <strong class="userinput"><code>Canvas</code></strong> component on the <code class="literal">Background Canvas</code>.</li></ol></div><p>Now we can start setting up the windows <span>that</span><a id="id325630328" class="indexterm"></a> will hold our <span>animated text</span>.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch06lvl3sec46"></a>Laying out the Text Box Windows</h4></div></div></div><p>To create the textbox windows <span>that</span><a id="id325630348" class="indexterm"></a> will display our text, complete the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Create a new UI Canvas and name it <code class="literal">Text Canvas</code>. Set its <strong class="userinput"><code>Canvas</code></strong> and <strong class="userinput"><code>Canvas Scalar</code></strong> properties, as shown:
<div class="mediaobject"><img src="/graphics/9781787125520/graphics/77b6cd7d-f821-428b-a903-66142444166f.png" /></div></li><li>Create a new UI Image and name it <code class="literal">TextHolder1</code>. Set its anchor and pivot to <strong class="userinput"><code>middle center</code></strong>. Assign <code class="literal">uiElements_10</code> to the <strong class="userinput"><code>Source Image</code></strong>, and then select <strong class="userinput"><code>Set Native Size</code></strong> to cause the image's size to be set to <code class="literal">223</code> x <code class="literal">158</code>.</li></ol></div><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>This panel will hold an image of our cat, some text, and a continue button. Utilizing anchors, pivots, and stretching, lay out the UI objects as children of <code class="literal">TextHolder1</code> so that they appear as illustrated:
<div class="mediaobject"><img src="/graphics/9781787125520/graphics/94d9fa1c-9416-4dba-87b2-4da17bd6bdbd.png" /></div>
Note that in the preceding screenshot, the <code class="literal">Text</code> child's Rect Transform does not stretch all the way across the image of <code class="literal">TextHolder1</code>. That way, the text won't cross over the white area of the window.</li><li>We'll want to be able to <span>turn</span><a id="id325631259" class="indexterm"></a> this window on and off, so add a <strong class="userinput"><code>Canvas Group</code></strong> component to <code class="literal">TextHolder1</code>. Leave the settings at their default values.</li><li>Duplicate <code class="literal">TextHolder1</code> and name the duplicate <code class="literal">TextHolder2</code>.</li><li>Replace the text on the Text child of <code class="literal">TextHolder1</code> with <code class="literal">Hello there!</code> and the text on the <code class="literal">Text</code> child of  <code class="literal">TextHolder2</code> with <code class="literal">I'm a cat and, for some reason, I'm collecting food!</code>.</li><li>Let's hide and disable <code class="literal">TextHolder2</code> by disabling <strong class="userinput"><code>Interactable</code></strong>, disabling <strong class="userinput"><code>Blocks Raycasts</code></strong>, and setting the <strong class="userinput"><code>Alpha</code></strong> value to <code class="literal">0</code> on the <strong class="userinput"><code>Canvas Group</code></strong> component.</li></ol></div><p>Now we're ready to start animating our text!</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch06lvl3sec47"></a>Animating the Text Box text</h4></div></div></div><p>Now that we have our layout set up, we can <span>animate</span><a id="id325631332" class="indexterm"></a> our text. To do this, we will need to create a new script. This script will control the animation of the text as well as load the next scene when all text has displayed.</p><p>To create animated text that looks like it's typing out, complete the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Create a new C# script called <code class="literal">AnimateText.cs</code>.</li><li>We will be writing code that accesses UI elements as well as code that implements scene loading. Therefore, we need to include the following namespaces at the top of our new script:</li></ol></div><pre class="programlisting">using UnityEngine.UI;
using UnityEngine.SceneManagement;</pre><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>Now, let's begin our variable declaration. We'll create three lists that hold our Canvas Groups, Text display objects, and the strings of dialogue that we want to display. Declare the following three public variables within your <code class="literal">AnimateText</code> class:</li></ol></div><pre class="programlisting">public List&lt;CanvasGroup&gt; textHolder=new List&lt;CanvasGroup&gt;();
public List&lt;Text&gt; textDisplayBox=new List&lt;Text&gt;();
public List&lt;string&gt; dialogue=new List&lt;string&gt;();</pre><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>Create one more public variable that <span>will</span><a id="id325631419" class="indexterm"></a> hold the name of the scene that loads after the text is done animating:</li></ol></div><pre class="programlisting">public string nextScene; //name of the next scene</pre><div class="orderedlist"><ol class="orderedlist arabic" start="5" type="1"><li>Before we proceed, let's assign these variables in the Unity Editor. Attach the <code class="literal">AnimateText.cs</code> script to the <code class="literal">Main Camera</code>. Now, drag <code class="literal">TextHolder1</code> from the <strong class="userinput"><code>Hierarchy</code></strong> and hover over the words <strong class="userinput"><code>Text Holder</code></strong> within the <strong class="userinput"><code>Animate Text</code></strong> component until you see the square with the plus sign, as shown:
<div class="mediaobject"><img src="/graphics/9781787125520/graphics/bb4cf587-9e3a-4b79-b45a-ee99e5b5752b.png" /></div>
Once you release your mouse, you should see that <strong class="userinput"><code>TextHolder1 (Canvas Group)</code></strong> has been added to the <strong class="userinput"><code>Element 0</code></strong> slot. It's important to note that if <code class="literal">TextHolder1</code> did not have a Canvas Group component attached to it, we would not have been able to add it to this list.
</li><li>Add <code class="literal">TextHolder2</code> to the list in the same way you added <code class="literal">TextHolder1</code>. Also, add the <code class="literal">Text</code> children of <code class="literal">TextHolder1</code> and <code class="literal">TextHolder2</code> to the <strong class="userinput"><code>Text Boxes</code></strong> list. Once completed, you should see the following:
<div class="mediaobject"><img src="/graphics/9781787125520/graphics/9c4209b1-cb87-404b-8188-582e48b8172a.png" /></div>
Ensure that you drag the <code class="literal">Text</code> objects in the correct order.</li><li>Now change the <strong class="userinput"><code>Size</code></strong> of the <strong class="userinput"><code>Dialogue</code></strong> list to <code class="literal">2</code>. Then, add the following text to <strong class="userinput"><code>Element 0</code></strong> and <strong class="userinput"><code>Element 1</code></strong>, respectively: <code class="literal">Hello there!</code> and <code class="literal">I'm a cat and, for some reason, I'm collecting food!</code>. We will be generating the text within the textboxes via code using this list. In the last subsection, we added the text to the textboxes that we placed in the scene. However, due to the code we <span>will</span><a id="id325631542" class="indexterm"></a> write, that step will be rendered unnecessary. It was helpful adding the text to those textboxes, though, because we were able to see exactly how it will display.</li><li>The last thing we need to do in the Editor, for now, is assigned the scene that the game will navigate to once the dialogue has completed. We'll create a scene called <code class="literal">Chapter6</code> later, but, for now, let's just assign the <code class="literal">Chapter5</code> scene to the <strong class="userinput"><code>Next Scene</code></strong> slot by typing <code class="literal">Chapter5</code>.</li><li>Now we can go back to our <code class="literal">AnimateText.cs</code> script. We aren't quite done with our variable declaration. We need two variables that will track string in our dialogue we wish to display as well as which character within that specific string we are displaying. Add the following variable declaration to your script:</li></ol></div><pre class="programlisting">int whichText=0; //which string will be read
int positionInString=0; //which letter is being typed</pre><div class="orderedlist"><ol class="orderedlist arabic" start="10" type="1"><li>Note that these two variables are not public and thus cannot be adjusted in the Inspector. Their values will be adjusted by the script. The <code class="literal">whichText</code> variable will allow us to switch between displaying the first string in the dialogue list and the second. The code we will write will easily be extendable to more strings. The <code class="literal">positionInString</code> variable <span>will</span><a id="id325628348" class="indexterm"></a> keep track of which character is being typed out by the animation. We want to keep track of this so that we can tell whether the text is being sped up by the user or if they have already read the whole text and just want to proceed to the next part.</li><li>We will use a coroutine to animate our text one letter at a time. Coroutines work very well for timed and scheduled events. The last variable we need to declare will allow us to reference our coroutine so that we can easily stop it. Declare the following variable:</li></ol></div><pre class="programlisting">Coroutine textPusher; //so we can stop the coroutine</pre><div class="orderedlist"><ol class="orderedlist arabic" start="12" type="1"><li>The coroutine that will control the text animation is as follows:</li></ol></div><pre class="programlisting">IEnumerator WriteTheText(){
     for(int i=0; i&lt;=dialogue[whichText].Length; i++){
          textDisplayBox[whichText].text=dialogue[whichText].Substring(0,i);
          positionInString++;
          yield return new WaitForSeconds(0.1f);
     }
}</pre><div class="orderedlist"><ol class="orderedlist arabic" start="13" type="1"><li>This code finds the current string in the <code class="literal">dialogue</code> list using the <code class="literal">whichText</code> variable and loops through all of its characters. With each step of the loop, the text property of the UI Text object is updated to display the first <code class="literal">i</code> characters of the string, where <code class="literal">i</code> represents the current step of the loop. It then increases the <code class="literal">positionInString</code> variable and waits a tenth of a second to display the next character by proceeding to the next step in the loop.</li><li>Before the preceding code will do anything, we need to start our coroutine. In the process of starting it, I also want to assign the <code class="literal">textPusher</code> variable. Add the following to the <code class="literal">Start()</code> function:</li></ol></div><pre class="programlisting">void Start () {
textPusher=StartCoroutine(WriteTheText());
}</pre><div class="orderedlist"><ol class="orderedlist arabic" start="15" type="1"><li>If you play your game now, you should see the "Hello there!" text type out within your scene.</li></ol></div><div class="orderedlist"><ol class="orderedlist arabic" start="16" type="1"><li>The coroutine currently only loops through the first string in the dialogue list. We need to now make it proceed to the next string in the list by increasing the <code class="literal">whichText</code> variable. We also need to add functionality to <span>allow</span><a id="id325628537" class="indexterm"></a> players to show all the text so that they don't have to wait for it to fully animate, if they're impatient. Let's create a function that will be called by the press of our buttons:</li></ol></div><pre class="programlisting">public void ProceedText(){
  //haven't made it to the end of the string
  if(positionInString&lt;dialogue[whichText].Length){
    //stop typing the text
    StopCoroutine(textPusher);
    //show the full string
    textDisplayBox[whichText].text=dialogue[whichText];
    positionInString=dialogue[whichText].Length;

  //have completed the whole string
  }else{
    //hide the text holder
    textHolder[whichText].alpha=0;
    textHolder[whichText].interactable=false;
    textHolder[whichText].blocksRaycasts=false;

    //proceed to next string
    whichText++;

    //there's no more text, go to the next scene
    if(whichText&gt;=textDisplayBox.Count){
      SceneManager.LoadScene(nextScene);

    //there are more text boxes, show them
    }else{
      positionInString=0;
      textHolder[whichText].alpha=1;
      textHolder[whichText].interactable=true;
      textHolder[whichText].blocksRaycasts=true;
      textPusher=StartCoroutine(WriteTheText());
    }
  }
}</pre><div class="orderedlist"><ol class="orderedlist arabic" start="17" type="1"><li>When a button is pressed, the code first determines whether the whole string has been displayed using the <code class="literal">positionInString</code> variable. If the <code class="literal">positionInString</code> variable is smaller than the total characters in the current string, it displays the complete string; otherwise, it proceeds.
When the <code class="literal">positionInString</code> variable is less than the total characters in the current string, the coroutine is stopped early with <code class="literal">StopCoroutine(textPusher)</code>. The text property of the <code class="literal">textDisplayBox</code> is updated to display the full string, and the <code class="literal">positionInString</code> is set to the length of the string; that way, if the button is clicked on again, this function will know that it can proceed to the next step.
When the <code class="literal">positionInString</code> variable is not <span>less</span><a id="id325628581" class="indexterm"></a> than the total characters in the current string, the current Canvas Group is deactivated, and then the <code class="literal">whichText</code> variable is increased. Once this variable is increased, the code checks whether there are any more textboxes that need animating. If there are not, the next scene loads. If there are more textboxes that need animating, the <code class="literal">positionInString</code> variable is reset to 0, so the very first character in the string needs to be displayed first. The new Canvas Group is now activated, and the <code class="literal">textPusher</code>variable is reassigned so that the coroutine loop will play again.</li><li>Now that our code is done, we just need to hook up our buttons to perform the function described in the previous step. For both buttons on both <code class="literal">TextHolders</code>, set the <strong class="userinput"><code>On Click()</code></strong> event to run the <code class="literal">ProceedText()</code> function in the <code class="literal">AnimateText</code> script attached to the <code class="literal">Main Camera</code>. Now, when you play the game, clicking on the button when the text isn't finished yet will cause it to finish, and clicking on it when it is done will cause it to go to the next dialogue or the next scene.</li></ol></div><p>To improve on this script, you might want to put a checker that ensures that your three lists are all of the same length. You can also create a prefab of the <code class="literal">TextHolder</code> object and generate a set amount in code based on the text you enter. I would recommend implementing this change if you will be making a more complicated dialogue system.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec69"></a>Custom font</h3></div></div></div><p>Let's take a step away from building out our <span>scenes</span><a id="id325628664" class="indexterm"></a> for a moment to explore making a custom font. We won't be using this <span>custom</span><a id="id325628673" class="indexterm"></a> font in the scenes we've been working on, but the process of creating a custom font is still important to cover. We'll create a custom font that displays the number 0 through 9 using the following sprites:</p><div class="mediaobject"><img src="/graphics/9781787125520/graphics/7cb6b57c-8f5c-4f01-bf83-349591b66718.png" /></div><p>The sprites used to create the font are modified from the free art asset found at <a class="ulink" href="https://opengameart.org/content/shooting-gallery" target="_blank">https://opengameart.org/content/shooting-gallery</a>.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip54"></a>Note</h3><p>To create an evenly spaced sprite sheet for this font, I used the TexturePacker program along with Photoshop. The process can be done entirely with a photo editing software such as Photoshop, but TexturePacker simplifies the process. TexturePacker can be found at <a class="ulink" href="https://www.codeandweb.com/texturepacker" target="_blank">https://www.codeandweb.com/texturepacker</a>.</p></div><p>The process of creating a <span>custom</span><a id="id325628711" class="indexterm"></a> font is time-consuming and kind of a pain. To create a custom font, you have to put in coordinate location for <span>each</span><a id="id325628721" class="indexterm"></a> character you plan on rendering with the font, so I don't really recommend it for anything other than numbers or a very limited character set.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip55"></a>Note</h3><p>If you want a custom font with a more robust character set, check out the Unity asset store for various options on streamlining the bitmap font process.</p></div><p>To create the custom font displayed in the preceding image, complete the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Create a new folder called <code class="literal">Custom Font</code> within your <code class="literal">Assets/Fonts</code> folder.</li><li>Find the <code class="literal">customFontSpriteSheet.png</code>file within the code bundle and drag the file into the folder you created in step 1. The sprite sheet appears as follows:
<div class="mediaobject"><img src="/graphics/9781787125520/graphics/f3528cff-2359-46d2-8211-a0fa2029a074.jpg" /></div>
When manually creating a custom font, it is important that your individual characters be spaced evenly. This will make your life significantly easier while entering the settings of the individual characters. You can leave the sprite sheet's import settings at the default <strong class="userinput"><code>Sprite (2D and UI) Texture Type</code></strong> and <strong class="userinput"><code>Single Sprite Mode</code></strong>.</li></ol></div><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>A custom font requires a material to render. Create a new material by right-clicking in your <strong class="userinput"><code>Custom Font</code></strong> folder and selecting <strong class="userinput"><code>Create</code></strong> | <strong class="userinput"><code>Material</code></strong>. Rename the new material to <strong class="userinput"><code>CustomFontMaterial</code></strong>.</li></ol></div><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>Select <strong class="userinput"><code>CustomFontMaterial</code></strong> to <span>bring</span><a id="id325628807" class="indexterm"></a> up its <strong class="userinput"><code>Inspector</code></strong>. Drag <code class="literal">customFontSpriteSheet</code> into the square next to <strong class="userinput"><code>Albedo</code></strong> in <strong class="userinput"><code>Main Maps</code></strong>. Once you do so, the material's preview image should update:
<div class="mediaobject"><img src="/graphics/9781787125520/graphics/1ff93358-dbca-4964-b32f-6d3e53165d7a.png" /></div></li><li>Now we need to change the material's shader. There are a few different options you can use for the Shader. You can use <strong class="userinput"><code>UI</code></strong> | <strong class="userinput"><code>Default</code></strong> or any of the unlit or unlit UI options. My preference is to use <strong class="userinput"><code>GUI</code></strong> | <strong class="userinput"><code>Text Shader</code></strong>, as I tend to have the best luck with it rendering correctly, and I prefer the <span>way</span><a id="id325628889" class="indexterm"></a> it displays in the <strong class="userinput"><code>Project</code></strong> view.
<div class="mediaobject"><img src="/graphics/9781787125520/graphics/14cea952-475e-45b0-bc28-e84a7d9d1037.png" /></div></li><li>Now we can create our Custom Font. Within the <code class="literal">Custom Font</code> folder, right-click and select <strong class="userinput"><code>Create</code></strong> | <strong class="userinput"><code>Custom Font</code></strong>. Name the new font <code class="literal">CustomFont</code>.</li><li>Select <code class="literal">CustomFont</code> and assign <code class="literal">CustomFontMaterial</code> to the <strong class="userinput"><code>Default Material</code></strong> slot.</li></ol></div><div class="orderedlist"><ol class="orderedlist arabic" start="8" type="1"><li>The properties under <strong class="userinput"><code>Character Rects</code></strong> will specify the coordinates of the individual characters on the sprite sheet. The <strong class="userinput"><code>Size</code></strong> property specifies how many total characters are there in our sprite sheet. Many of these properties are repeated for each character. To save time, I like to set the properties of <strong class="userinput"><code>Element 0</code></strong> before I increase my <strong class="userinput"><code>Character Rects</code></strong>' <strong class="userinput"><code>Size</code></strong> to the amount of characters I <span>wish</span><a id="id325628962" class="indexterm"></a> to display. This way, the properties I specify in <strong class="userinput"><code>Element 0</code></strong> will be duplicated to all subsequent Elements. So, set the <strong class="userinput"><code>Size</code></strong> property to <code class="literal">1</code> for now. We will change it to <code class="literal">10</code> once we have the properties that will repeat for all characters entered.
When you set the <strong class="userinput"><code>Size</code></strong> to <code class="literal">1</code>, you should see the properties of <strong class="userinput"><code>Element 0</code></strong> appear.
<div class="mediaobject"><img src="/graphics/9781787125520/graphics/a402da02-902d-4060-86ca-7291a7b51955.png" /></div></li><li>The first properties that repeat for all <span>characters</span><a id="id325629005" class="indexterm"></a> are <strong class="userinput"><code>UV W</code></strong> and <strong class="userinput"><code>UV H</code></strong>. These values represent the percentage of the sprite's total width and total height that the individual character takes up. Since our characters are all evenly spaced in our sprite sheet, these values will be the same for all characters. If your characters are evenly sized, you can calculate these values as follows:</li></ol></div><div class="mediaobject"><img src="/graphics/9781787125520/graphics/37e4303b-a589-4a6c-9b85-022ac3f0be54.png" /></div><p>There are a total of five columns of characters. Therefore, each sprite takes up one-fifth of the width of the sprite. One-fifth is equal to 20 percent or 0.2 as a decimal. We need to put <code class="literal">0.2</code> in the <strong class="userinput"><code>UV W</code></strong> slot. If you're not great with percentages, that's fine. Unity will perform the calculation for you! Typing <code class="literal">1/5</code> in the <strong class="userinput"><code>UV W</code></strong> slot and pressing <span class="emphasis"><em>Enter</em></span> will automatically compute the <code class="literal">0.2</code> decimal.
There are total two rows of characters. Therefore, each sprite takes up 1/2 of the height of the sprite; one-fifth is equal to 50 percent or 0.5 as a decimal. Typing <code class="literal">1/2</code> in the <strong class="userinput"><code>UV H</code></strong> slot and pressing <span class="emphasis"><em>Enter</em></span> will automatically compute the correct decimal of <code class="literal">0.5</code> in the slot.</p><div class="orderedlist"><ol class="orderedlist arabic" start="10" type="1"><li>The next values that repeat for <span>each</span><a id="id325629073" class="indexterm"></a> character are the <strong class="userinput"><code>Vert W</code></strong> and <strong class="userinput"><code>Vert H</code></strong> values. When the sprite sheet was created, each individual sprite was made from a 50x57 pixel image. So, type <code class="literal">50</code> in the W slot and <code class="literal">-57</code> in the <strong class="userinput"><code>H</code></strong> slot. Remember that the <strong class="userinput"><code>H</code></strong> property will always be negative!</li><li>The last property that remains consistent throughout all the characters is the <strong class="userinput"><code>Advance</code></strong> property. This property is the space <span>between</span><a id="id325629106" class="indexterm"></a> the characters. Since our sprites are a width of 50, we should make this property 50 or larger. You can fiddle with this property to see what looks best to you, but I think it looks nice at <code class="literal">51</code>.
After completing steps 9 through 11, your Element 0 character should have the following properties:
<div class="mediaobject"><img src="/graphics/9781787125520/graphics/8a7392f5-7dba-43ca-b538-529aad3ac6d8.png" /></div></li></ol></div><div class="orderedlist"><ol class="orderedlist arabic" start="12" type="1"><li>Now that we have placed all the repeated properties, we can increase the <strong class="userinput"><code>Size</code></strong> or our <strong class="userinput"><code>Character Rects</code></strong> set. There are a total of 10 character in our sprite sheet, so change the <strong class="userinput"><code>Size</code></strong> property to <code class="literal">10</code>. You'll see that <span>once</span><a id="id325629182" class="indexterm"></a> we do this, the properties of <strong class="userinput"><code>Element 0</code></strong> are repeated in <strong class="userinput"><code>Element 1</code></strong> through <strong class="userinput"><code>Element 9</code></strong>.
<div class="mediaobject"><img src="/graphics/9781787125520/graphics/b93c1ae8-75ee-4d2c-abe6-28c95adb73d9.png" /></div></li><li>Now we need to specify the ASCII index of each element. This will tie the typed text to the correct sprite. Without this, the <span>font</span><a id="id325629213" class="indexterm"></a> would not know that typing the number 0 should show the first sprite in the sheet. The following table indicates that the numbers 0-9 are the ASCII numbers 48-57: <a class="ulink" href="http://www.ascii.cl/" target="_blank">http://www.ascii.cl/</a>.
Therefore, we should enter the Index values of <code class="literal">48</code> through <code class="literal">57</code> in <strong class="userinput"><code>Element 0</code></strong> through <strong class="userinput"><code>Element 9</code></strong>:
<div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; "><colgroup><col /><col /><col /><col /><col /><col /><col /><col /><col /><col /><col /></colgroup><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span>Element</span></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>0</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>1</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>2</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>3</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>4</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>5</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>6</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>7</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>8</p></td><td style="border-bottom: 0.5pt solid ; "><p>9</p></td></tr><tr><td style="border-right: 0.5pt solid ; "><p>Index</p></td><td style="border-right: 0.5pt solid ; "><p>48</p></td><td style="border-right: 0.5pt solid ; "><p>49</p></td><td style="border-right: 0.5pt solid ; "><p>50</p></td><td style="border-right: 0.5pt solid ; "><p>51</p></td><td style="border-right: 0.5pt solid ; "><p>52</p></td><td style="border-right: 0.5pt solid ; "><p>53</p></td><td style="border-right: 0.5pt solid ; "><p>54</p></td><td style="border-right: 0.5pt solid ; "><p>55</p></td><td style="border-right: 0.5pt solid ; "><p>56</p></td><td style=""><p>57</p></td></tr></tbody></table></div></li></ol></div><div class="orderedlist"><ol class="orderedlist arabic" start="14" type="1"><li>The next step is to specify the <strong class="userinput"><code>UV X</code></strong> and <strong class="userinput"><code>Y</code></strong> values. This is the part of creating custom fonts that takes up the most time. These values represent the UV coordinate position of the characters in the sprite sheet. These numbers are calculated based on the row and column numbers that <span>the</span><a id="id325368688" class="indexterm"></a> character lies in. The row and column numbers start at 0 and start in the bottom-left corner.
<div class="mediaobject"><img src="/graphics/9781787125520/graphics/38a599d1-1a4a-4cd3-8bdd-e3df2fdae83f.png" /></div>
To calculate the <strong class="userinput"><code>UV X</code></strong> and <strong class="userinput"><code>UV Y</code></strong> values, use the following formulas:
<div class="mediaobject"><img src="/graphics/9781787125520/graphics/0fc444bf-9cb3-4509-b4cf-e72c2df88347.png" /></div>
Remember that since our characters <span>are</span><a id="id325368725" class="indexterm"></a> evenly spaced, our <strong class="userinput"><code>UV W</code></strong> and <strong class="userinput"><code>UV H</code></strong> values are the same for each character.
So, if we look at <strong class="userinput"><code>Element 0</code></strong>, its <strong class="userinput"><code>UV X</code></strong> value can be found by multiplying 0 (for column 0) by 0.2 (the <strong class="userinput"><code>UV W</code></strong> value) to get <code class="literal">0</code>. Its <strong class="userinput"><code>UV Y</code></strong> value can be found by multiplying 1 (for row 1) by 0.5 (the UV H value) to get <code class="literal">0.5</code>.
The following chart represents the <strong class="userinput"><code>UV X</code></strong> and <strong class="userinput"><code>UV Y</code></strong> values that should be entered for each character:<div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; "><colgroup><col /><col /><col /></colgroup><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span>Element</span></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>UV X</p></td><td style="border-bottom: 0.5pt solid ; "><p>UV Y</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>0</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>0</p></td><td style="border-bottom: 0.5pt solid ; "><p>0.5</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>1</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>0.2</p></td><td style="border-bottom: 0.5pt solid ; "><p>0.5</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>2</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>0.4</p></td><td style="border-bottom: 0.5pt solid ; "><p>0.5</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>3</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>0.6</p></td><td style="border-bottom: 0.5pt solid ; "><p>0.5</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>4</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>0.8</p></td><td style="border-bottom: 0.5pt solid ; "><p>0.5</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>5</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>0</p></td><td style="border-bottom: 0.5pt solid ; "><p>0</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>6</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>0.2</p></td><td style="border-bottom: 0.5pt solid ; "><p>0</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>7</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>0.4</p></td><td style="border-bottom: 0.5pt solid ; "><p>0</p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>8</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>0.6</p></td><td style="border-bottom: 0.5pt solid ; "><p>0</p></td></tr><tr><td style="border-right: 0.5pt solid ; "><p>9</p></td><td style="border-right: 0.5pt solid ; "><p>0.8</p></td><td style=""><p>0</p></td></tr></tbody></table></div></li></ol></div><p>The following image gives a more visual representation of the coordinate pattern:</p><div class="mediaobject"><img src="/graphics/9781787125520/graphics/04c62655-9d27-4515-bfad-9909a1f45091.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="15" type="1"><li>Now, we can test our font to see whether it works. Within any of your scenes, create a new <strong class="userinput"><code>UI Text</code></strong> object. I have created a new scene called <code class="literal">Chapter6CustomFont</code> on which I have my test fonts. Change the <strong class="userinput"><code>Text</code></strong> to <code class="literal">0123456789</code> and drag the <code class="literal">CustomFont</code> into the <code class="literal">Font</code> slot. The text should appear as it did at the beginning of this example.</li></ol></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch06lvl3sec48"></a>Adjusting the character spacing and changing the font size</h4></div></div></div><p>In our example, all <span>the</span><a id="id325369014" class="indexterm"></a> numbers are evenly spaced and <span>the</span><a id="id325369022" class="indexterm"></a> font size cannot be changed. It's very likely that you will want your numbers to be closer together or of a different font size. Let's alter our custom font so that the sprites are closer together. The following image shows our font after the adjustments versus the original created in the last part of this example:</p><div class="mediaobject"><img src="/graphics/9781787125520/graphics/665c7808-df9a-4422-9202-be5f517bf75a.png" /></div><p>To change <span>the</span><a id="id325369043" class="indexterm"></a> spacing of the characters, complete <span>the</span><a id="id325369051" class="indexterm"></a> following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Duplicate the CustomFont with <span class="emphasis"><em>Ctrl </em></span>+ <span class="emphasis"><em>D</em></span> and rename the duplicate to <code class="literal">CustomFontTight</code>. Open the <strong class="userinput"><code>Inspector</code></strong> of <code class="literal">CustomFontTight</code>.</li><li>If you'd like the numbers to be closer together, you have to simply change the <strong class="userinput"><code>Advance</code></strong> property for the specific elements. The <strong class="userinput"><code>Advance</code></strong> property represents the pixels from the start of the sprite to the start of the next sprite. So, if we wanted the number 2 to appear closer to the number 1, we could change the <strong class="userinput"><code>Advance</code></strong> on <strong class="userinput"><code>Element 1</code></strong> to something smaller, as shown here:
<div class="mediaobject"><img src="/graphics/9781787125520/graphics/950928bb-70ce-436c-a577-7419906aab05.png" /></div></li></ol></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip56"></a>Note</h3><p>You can change the settings on your custom font while previewing the results in the Scene. To get the text to refresh in the scene after making a change to your custom font, you have to first save the scene.</p></div><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>Adjust the <strong class="userinput"><code>Advance</code></strong> properties of each element based on the following chart:<div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; "><colgroup><col /><col /><col /><col /><col /><col /><col /><col /><col /><col /><col /></colgroup><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span>Element</span></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>0</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>1</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>2</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>3</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>4</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>5</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>6</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>7</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>8</p></td><td style="border-bottom: 0.5pt solid ; "><p>9</p></td></tr><tr><td style="border-right: 0.5pt solid ; "><p>Advance</p></td><td style="border-right: 0.5pt solid ; "><p>39</p></td><td style="border-right: 0.5pt solid ; "><p>30</p></td><td style="border-right: 0.5pt solid ; "><p>35</p></td><td style="border-right: 0.5pt solid ; "><p>35</p></td><td style="border-right: 0.5pt solid ; "><p>35</p></td><td style="border-right: 0.5pt solid ; "><p>35</p></td><td style="border-right: 0.5pt solid ; "><p>35</p></td><td style="border-right: 0.5pt solid ; "><p>35</p></td><td style="border-right: 0.5pt solid ; "><p>38</p></td><td style=""><p>35</p></td></tr></tbody></table></div></li></ol></div><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>The font should now appear as follows:</li></ol></div><div class="mediaobject"><img src="/graphics/9781787125520/graphics/bcbdb316-0821-43f0-ae87-070817252c14.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="5" type="1"><li>There is still a bit too much spacing between the 0 and the 1; however, if you try to reduce the <strong class="userinput"><code>Advance</code></strong> on the 0 to bring 1 closer, other numbers will overlap the 0 if they follow the 0. The following example shows what will happen if the Advance on Element 0 were reduced to 35; the one looks good following 0, but the 0 overlaps it.
<div class="mediaobject"><img src="/graphics/9781787125520/graphics/fcf147a9-9ea8-46cf-a998-823806681227.png" /></div></li></ol></div><div class="orderedlist"><ol class="orderedlist arabic" start="6" type="1"><li>To move in the 1 closer, we need to change <span>the</span><a id="id325369349" class="indexterm"></a><strong class="userinput"><code>Vert X</code></strong> property on <strong class="userinput"><code>Element 1</code></strong>. Change the <strong class="userinput"><code>Vert X</code></strong> property on <strong class="userinput"><code>Element 1</code></strong> to <code class="literal">-3</code> to shift it left just a smidge. This will give the character a more favorable spacing.</li><li>Now, if you'd like to adjust <span>the</span><a id="id325369374" class="indexterm"></a> font size, you cannot change the size of a custom font by changing the <strong class="userinput"><code>Font Size</code></strong> property of the Text component; changing the <strong class="userinput"><code>Font Size</code></strong> value will do nothing. To change the size of the font, you must change the <strong class="userinput"><code>Scale X</code></strong> and <strong class="userinput"><code>Scale Y</code></strong> of the Rect Transform component. To get the font half the size, change <strong class="userinput"><code>Scale X</code></strong> and <strong class="userinput"><code>Scale Y</code></strong> to <code class="literal">0.5</code>.</li></ol></div><p>As I said earlier, we probably won't be using this font to build our master example scene, but the process of creating a custom font is still a useful exercise. Now, let's move on to creating some other common UI assets—health/progress pars.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec70"></a>Horizontal and circular health/progress meters</h3></div></div></div><p>Let's <span>get</span><a id="id325369415" class="indexterm"></a> back <span>to</span><a id="id325369424" class="indexterm"></a> our <span>main</span><a id="id325369430" class="indexterm"></a> scene. Duplicate the <code class="literal">Chapter5</code> scene to <span>create</span><a id="id325369442" class="indexterm"></a> a <code class="literal">Chapter6</code> scene.</p><p>In this section, we'll cover how to create two types of progress meters, a horizontal one and a vertical one, as shown:</p><div class="mediaobject"><img src="/graphics/9781787125520/graphics/c47e7b43-8e4d-4698-b2aa-cc35adb81fd7.png" /></div><p>We'll hook up the circular <span>and</span><a id="id325369464" class="indexterm"></a> horizontal progress <span>meters</span><a id="id325369473" class="indexterm"></a> so that they <span>both</span><a id="id325369479" class="indexterm"></a> display the progress of the same variable and we can watch them both change at the same time.</p><p>The circular progress meter doesn't really fit in the <span>master</span><a id="id325369491" class="indexterm"></a> scene that we've been building and we'll hide it after this chapter, but circular progress bars are common game elements, and it's hard to find information on how to do them, so I thought it was important to include an example of how to do them in the text.</p><p>Remember when we created the scene <code class="literal">Chapter6AnimatedText</code>, I stated that we'd change the scene that loads after it once we created <code class="literal">Chapter6</code>. Now that we have a <code class="literal">Chapter6</code> scene, let's change the scene navigation before we begin working on the progress bars.</p><p>To hook up the correct scene navigation, complete the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Open the <code class="literal">Chapter6AnimatedText</code> scene and select the <code class="literal">Main Camera</code>.</li><li>In the <strong class="userinput"><code>Animated Text</code></strong> component, change the text in the <strong class="userinput"><code>Next Scene</code></strong> slot to <code class="literal">Chapter6</code>.</li><li>Open the <code class="literal">Chapter5StartScreen</code> scene and select the <code class="literal">Play Button</code> in the <code class="literal">Button Canvas</code>.</li><li>In the <strong class="userinput"><code>Level Loader</code></strong> component, change the text in the <strong class="userinput"><code>Scene To Load</code></strong> slot to <code class="literal">Chapter6AnimatedText</code>.</li><li>Open the <strong class="userinput"><code>Build Settings</code></strong>. Remove the <code class="literal">Chapter5</code> scene, and add the <code class="literal">Chapter6AnimatedText</code> and <code class="literal">Chapter6</code> scenes.</li></ol></div><p>Now when you play the game from the start screen, <code class="literal">Chapter5StartScreen</code>, the game will play through the animated text and load the main game screen.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch06lvl3sec49"></a>Horizontal health bar</h4></div></div></div><p>There are a few different ways that a <span>horizontal</span><a id="id325369588" class="indexterm"></a> health bar can be created, but the quickest and easiest way is to scale a single axis based on percentage. When setting up a horizontal health bar in this way, it is important to ensure that the anchor is set at the position that represents a completely depleted bar.</p><p>Remember that back in <a class="link" href="#" linkend="ch02">Chapter 2</a>, <span class="emphasis"><em>Canvases, Panels, and Basic Layouts</em></span>, we set the anchor of the health bar to the left, so we have already set the anchor correctly. We also scaled the health bar in the <span class="emphasis"><em>x</em></span> direction to show what the bar would look like as it depleted.</p><div class="mediaobject"><img src="/graphics/9781787125520/graphics/9820f337-9fca-4172-8bbd-a7dc7cbb291a.png" /></div><p>Now, all we need to do is tie the percentage to the <strong class="userinput"><code>X Scale</code></strong> of the health bar.</p><p>To tie the fill of the health bar to an actual value, complete the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Create a new C# script in your <code class="literal">Scripts</code> folder and name it <code class="literal">ProgressMeters.cs</code>.</li><li>In the <code class="literal">ProgressMeters</code> script, initialize the following four variables.</li></ol></div><pre class="programlisting">public uint health;
public uint totalHealth;
public float percentHealth;
public RectTransform healthBar;</pre><p>The <code class="literal">health</code> variable represents the current health of the player, and the <code class="literal">totalHealth</code> variable represents the total health the player can obtain. As it doesn't make sense for these values to be negative, they have been initialized at the <code class="literal">uint</code> type or a positive integer. I have made these two variables <span>public</span><a id="id325369662" class="indexterm"></a> so that they can easily be edited in the inspector. The <code class="literal">percentHealth</code> variable will be calculated based on the quotient of the health and <code class="literal">totalHealth</code> variables. I made this value public, not so that we can edit it in the Inspector but so that we can easily see its values change in the <strong class="userinput"><code>Inspector</code></strong>. The <code class="literal">healthBar</code> variable stores the <code class="literal">RectTransform</code> component of the <strong class="userinput"><code>Health Bar UI</code></strong> Image within our scene.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note57"></a>Note</h3><p>Since <code class="literal">RectTransform</code> inherits from <code class="literal">Transform</code>, we could have declared <code class="literal">healthBar</code> as a <code class="literal">Transform</code> and the following code would still work.</p></div><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>Return to the Unity Editor and drag the <code class="literal">ProgessMeters</code> script onto the <code class="literal">Main Camera</code>. Assign the value <code class="literal">500</code> to both the <strong class="userinput"><code>Health</code></strong> and <strong class="userinput"><code>Total Health</code></strong> slots. Drag the <code class="literal">Health Bar</code> UI Image into the <strong class="userinput"><code>Health Bar</code></strong> slot. Any value you try to type in to the <strong class="userinput"><code>Percent Health</code></strong> slot will be overridden by the code we write in the next step.</li><li>We want any changes made to our health value to automatically update the <code class="literal">percentHealth</code> value and the scale of our <code class="literal">healthBar</code>. Therefore, we need to put the following code in the <code class="literal">Update()</code> function:</li></ol></div><pre class="programlisting">void Update () {
    //cap health
    if(health&gt;totalHealth){
      health=totalHealth;
    }

    //calculate health percentage
    percentHealth=(float)health/totalHealth;

    //horizontal health bar
    healthBar.localScale=new Vector2(percentHealth, 1f);
  }</pre><p>Declaring our health and <code class="literal">totalHealth</code> variables with the <code class="literal">uint</code> type stopped them from becoming negative, but we still need to put a cap on our health variable. It doesn't make sense for it to exceed the <code class="literal">totalHealth</code> variable.
While <code class="literal">percentHealth</code> is a float variable, performing a division between two <code class="literal">uint</code> variables will result in a <code class="literal">uint</code>, so adding <code class="literal">(float)</code> at the beginning of the integer division provides a float result from the division.
The last part of the code sets the <code class="literal">localScale</code> of the <code class="literal">healthBar</code>. When you scale a UI object, you have to use <code class="literal">localScale</code>. This scales the <span>object</span><a id="id325369862" class="indexterm"></a> locally, meaning relative to its parent object.</p><div class="orderedlist"><ol class="orderedlist arabic" start="5" type="1"><li>Now we can test the code easily in the Editor. Play the game and hover your mouse over the word <strong class="userinput"><code>Health</code></strong> in the <strong class="userinput"><code>Progress Meter</code></strong> component of the <code class="literal">Main Camera</code> until the mouse displays two arrows around it, as shown in the following screenshot:
<div class="mediaobject"><img src="/graphics/9781787125520/graphics/8d2bb214-b4fc-4235-8d3d-b11cfe30b82c.png" /></div>
When these arrows appear, clicking and dragging will manipulate the values of the variable based on your mouse position. You'll see, as you do this, that the <strong class="userinput"><code>Health</code></strong> value decreases, the <strong class="userinput"><code>Percent Health</code></strong> value decreases, and the <code class="literal">Health Bar</code> in the scene changes size. You'll note that you cannot set the value of Health below 0 or above 500.</li></ol></div><p>As you can see, setting up a horizontal health bar isn't terribly difficult. Duplicating this process in a game where the health reduces by events won't require a lot of steps to achieve. Just ensure that you set the anchor of the health bar correctly. This process will work similarly for a vertical health bar.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch06lvl3sec50"></a>Circular progress meter</h4></div></div></div><p>Horizontal health bars didn't take a lot of <span>work</span><a id="id325369915" class="indexterm"></a> to set up. The work to make a circular progress meter is just about as easy and can be completed with only two more lines of code. Since we don't already have a circular progress bar in our scene, we will have to start with a bit of setup first.</p><p>To create a <span>circular</span><a id="id325369924" class="indexterm"></a> progress bar, complete the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>From the code bundle, drag the <code class="literal">circular meter.png</code>image into the <code class="literal">Sprites</code> folder of your project.</li><li>Set the <strong class="userinput"><code>Sprite Mode</code></strong> of the <code class="literal">circular meter.png</code> to <strong class="userinput"><code>Multiple</code></strong> and automatically slice it in the Sprite Editor.</li><li>Select the <code class="literal">Top Left Panel</code> within the <strong class="userinput"><code>Hierarchy</code></strong> and give it a new UI Image child. Name the image <code class="literal">Progress Holder</code>.</li><li>Similar to how we set up the health bar, there will be a holder and a fill. Drag the <code class="literal">circular meter_0</code>subimage into the <strong class="userinput"><code>Source Image</code></strong> slot of the Image component of <code class="literal">Progress Holder</code>.</li><li>It's important that we get the right proportions on our holder and fill images. So, to ensure that holder image is correctly proportioned, hit the <strong class="userinput"><code>Set Native Size</code></strong> button on the <strong class="userinput"><code>Image</code></strong> component.</li><li>Now, add a child UI image to <code class="literal">Progress Holder</code> called <code class="literal">Progress Meter</code>.</li><li>Set the anchor preset of <code class="literal">Progress Meter</code> to middle center. Do not stretch it.</li><li>Add <code class="literal">circular meter_1</code> to the <strong class="userinput"><code>Source Image</code></strong> of the <strong class="userinput"><code>Image</code></strong> component on the <code class="literal">Progress Meter</code>.</li><li>Hit the <strong class="userinput"><code>Set Native Size</code></strong> button for the <code class="literal">Progress Meter</code><strong class="userinput"><code>Image</code></strong> component as well. After completing this step, you should see the following:
<div class="mediaobject"><img src="/graphics/9781787125520/graphics/a0367c36-72ad-4f49-b5ec-fdfad01019e1.png" /></div>
If the pink fill is not perfectly nestled inside the blue holder, you may have forgotten to hit the <strong class="userinput"><code>Set Native Size</code></strong> button on one of the images or the <code class="literal">Progress Meter</code> does not have its anchor preset set to middle center.</li></ol></div><div class="orderedlist"><ol class="orderedlist arabic" start="10" type="1"><li>Let's move this meter and scale it a bit. Select <code class="literal">Progress Holder</code> and move it below the <code class="literal">Character Holder</code>. Set the <strong class="userinput"><code>Scale X</code></strong> and <strong class="userinput"><code>Scale Y</code></strong> of the <code class="literal">Progress Holder</code> to <code class="literal">0.8</code> to make it a little smaller.
<div class="mediaobject"><img src="/graphics/9781787125520/graphics/ad06318e-4234-4db4-b343-3a279983b3a0.png" /></div></li><li>The last thing to do before <span>we code to the code</span> is change the <strong class="userinput"><code>Image Type</code></strong> of the <code class="literal">Progress Meter</code>. Change the <strong class="userinput"><code>Image Type</code></strong> to <strong class="userinput"><code>Filled</code></strong> with a <strong class="userinput"><code>Radial 360 Fill Method</code></strong>. Change the <strong class="userinput"><code>Fill Origin</code></strong> to <strong class="userinput"><code>Top</code></strong>. Adjust the <span>scroll</span><a id="id325370178" class="indexterm"></a> bar on the <strong class="userinput"><code>Fill Amount</code></strong> to preview the meter filling:
<div class="mediaobject"><img src="/graphics/9781787125520/graphics/1060ef8f-1a79-4a85-a3c8-69e78d2628d5.png" /></div></li></ol></div><div class="orderedlist"><ol class="orderedlist arabic" start="12" type="1"><li>Now we're ready to write some code. As you have probably guessed from adjusting the <strong class="userinput"><code>Fill Amount</code></strong>, we'll want to tie the <strong class="userinput"><code>Fill Amount</code></strong> to the <code class="literal">percentHealth</code> variable in our code. First, we need to create a <span>public</span><a id="id325370214" class="indexterm"></a> variable with which we can access the Image component of our <code class="literal">Progress Meter</code>. Declare the following variable at the top of your code:</li></ol></div><pre class="programlisting"> public Image progressMeter;</pre><div class="orderedlist"><ol class="orderedlist arabic" start="13" type="1"><li>Now, add the following at the end of the <code class="literal">Update()</code> function:</li></ol></div><pre class="programlisting">//circular progress meter
progressMeter.fillAmount=percentHealth;</pre><div class="orderedlist"><ol class="orderedlist arabic" start="14" type="1"><li>The last thing we need to do is hook the <code class="literal">Progress Meter</code> UI Image to the <code class="literal">progressMeter</code> variable. Drag the <code class="literal">Progress Meter</code> into the <strong class="userinput"><code>Progress Meter</code></strong> slot.</li><li>Play the game and Adjust the <strong class="userinput"><code>Health</code></strong> value in the Inspector as you did earlier and watch the two meters move in unison:
<div class="mediaobject"><img src="/graphics/9781787125520/graphics/f89fe28e-af46-448d-8368-f64570ee139c.png" /></div></li></ol></div><p>As you can see, making a circular progress meter is really not more difficult than making a horizontal one!</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec71"></a>Wrapped text with Gradient</h3></div></div></div><p>The banner of our <code class="literal">Pause Panel</code> has been looking a bit bare so far. Now that we’ve covered using TextMesh Pro-Text, we can create a nice <span>curved</span><a id="id325370293" class="indexterm"></a> text with a gradient that lines up well with our banner.</p><div class="mediaobject"><img src="/graphics/9781787125520/graphics/cb809bc3-a84e-4247-b4da-f63209a48df3.png" /></div><p>To create the curved text shown in the preceding screenshot, complete the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><span>If you have not done so already</span>, download the TextMesh Pro asset for free on the Unity Asset store at <a class="ulink" href="https://www.assetstore.unity3d.com/en/#!/content/84126" target="_blank">https://www.assetstore.unity3d.com/en/#!/content/84126</a>. Import all the provided files.</li><li>Select the <code class="literal">Pause Banner</code> UI Image and give it a child TextMeshPro-Text object by right-clicking on it in the Hierarchy and selecting <strong class="userinput"><code>UI | TextMeshPro-Text</code></strong>. Rename the child object <code class="literal">Paused Text-Pro</code>.</li><li>In the <strong class="userinput"><code>Text Mesh Pro UGUI</code></strong> component, change the <strong class="userinput"><code>Text Input Box</code></strong> setting to <code class="literal">Paused</code>.</li><li>Set the <strong class="userinput"><code>Font Style</code></strong> to bold and center align the text in both the horizontal and vertical axes. Set the Font Size to 43.</li><li>Adjust the Rect Transform so that the text is centered more within the banner. Your text should appear as follows:
<div class="mediaobject"><img src="/graphics/9781787125520/graphics/5b53705c-0c4d-47e8-acee-092b7110bf78.png" /></div>
In the preceding image, I have hidden the <code class="literal">Inventory Panel</code> behind the <code class="literal">Pause Panel</code> from my scene view to make the text easier to see.</li><li>Now, let's give the text a gradient fill. Select the checkbox next to <strong class="userinput"><code>Color Gradient</code></strong>.</li><li>To achieve the desired look, we will <span>leave</span><a id="id325336152" class="indexterm"></a> the <strong class="userinput"><code>Top Left</code></strong> and <strong class="userinput"><code>Top Right</code></strong> colors white. Select the white rectangle next to B<strong class="userinput"><code>ottom Left</code></strong> to bring up the Color picker. Select the eye dropper at the top of the Color picker and then move your mouse over the tan area of the <code class="literal">Pause Panel</code> image. When you close the Color picker window, the tan color should now be in the <strong class="userinput"><code>Bottom Left</code></strong> slot.
<div class="mediaobject"><img src="/graphics/9781787125520/graphics/947d9f01-0306-467a-8656-8db16a0b9679.png" /></div></li><li><p>Right-click on the color in the <strong class="userinput"><code>Bottom Left</code></strong> slot and select <strong class="userinput"><code>Copy</code></strong>.</p></li><li>Right-click on the color in the <strong class="userinput"><code>Bottom Right</code></strong> slot and select <strong class="userinput"><code>Paste</code></strong>. Now, the two <strong class="userinput"><code>Top</code></strong>colors should be white and two<strong class="userinput"><code>Bottom</code></strong>colors should be tan.</li><li>In the O<strong class="userinput"><code>utline Settings</code></strong>, select <strong class="userinput"><code>Enable</code></strong>. Set the <strong class="userinput"><code>Color</code></strong> to white (if it is not already) and change the <strong class="userinput"><code>Thickness</code></strong> to <code class="literal">0.25</code>.</li><li>The last thing to do is curve the text. TextMeshPro has made this pretty easy for us by providing an example script that curves text at runtime. To view the changes, you have to play the game, and they are not represented in the Scene view. Select the A<strong class="userinput"><code>dd Component</code></strong> button and choose <strong class="userinput"><code>Scripts</code></strong> | <strong class="userinput"><code>TMPro.Examples</code></strong> | <strong class="userinput"><code>Warp Text Example</code></strong>.</li></ol></div><div class="orderedlist"><ol class="orderedlist arabic" start="12" type="1"><li>Select the wavy green lines in the <strong class="userinput"><code>Vertex Curve</code></strong> slot to bring up the curve editor. Select the option on the far left, the flat line:
<div class="mediaobject"><img src="/graphics/9781787125520/graphics/52856fc1-f453-4c2e-bf61-8031691c3793.png" /></div></li><li>Right-click on the green <span>line</span><a id="id325336301" class="indexterm"></a> at the <strong class="userinput"><code>0.5</code></strong> mark and select <strong class="userinput"><code>Add Key</code></strong>.</li><li>Select that new key and drag it upward to a little below <strong class="userinput"><code>1.3</code></strong>.
<div class="mediaobject"><img src="/graphics/9781787125520/graphics/1bacd8ae-114d-43ab-9d59-f61f5a4a9f85.png" /></div></li></ol></div><div class="orderedlist"><ol class="orderedlist arabic" start="15" type="1"><li>Now, select the keys at the <strong class="userinput"><code>0.0</code></strong> mark and <strong class="userinput"><code>1.0</code></strong> mark and grab the handles that appear. Drag the handles upward until <span>they</span><a id="id325336346" class="indexterm"></a> are at approximately 45 and -45 degree angles.
<div class="mediaobject"><img src="/graphics/9781787125520/graphics/60be261d-39af-4300-8c44-9876c41c2446.png" /></div></li><li>Play the game and press the <span class="emphasis"><em>P</em></span> key to view the <code class="literal">Pause Panel</code>. The text should now appear as it did at the beginning of this example.</li></ol></div></div></div>