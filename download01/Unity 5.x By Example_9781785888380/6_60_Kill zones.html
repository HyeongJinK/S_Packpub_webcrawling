<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch06lvl1sec61"></a>Kill zones</h2></div></div><hr /></div><p>A common scripted <a id="id361" class="indexterm"></a>feature required by all scenes, but not yet implemented, is the <span class="strong"><strong>Kill Zone</strong></span>. That is, the functionality to mark out a region of 2D space in the level that, when entered by the player, will kill them or damage them. This is especially <a id="id362" class="indexterm"></a>useful to kill the player whenever they fall down a hole in the ground. Thus, the Kill Zone will be required in every level because every level created so far contains pits and holes in the ground. To implement this functionality, create a new and empty <span class="strong"><strong>GameObject</strong></span> in any scene. (It doesn't matter which because we'll be making a prefab object that can be reused anywhere.) As mentioned, new <span class="strong"><strong>GameObjects</strong></span> are created with the menu option, <span class="strong"><strong>GameObject</strong></span> | <span class="strong"><strong>Create Empty</strong></span>. Once created, name the object <code class="literal">KillZone</code>, then position it at the world origin (0,0,0), and finally, attach a Box Collider 2D component using the menu command, <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>Physics 2D</strong></span> | <span class="strong"><strong>Box Collider 2D</strong></span>. The Box Collider will define the Kill Zone area. Remember to make sure that the <span class="strong"><strong>Box Collider 2D</strong></span> is configured as a Trigger by checking the <span class="strong"><strong>Is Trigger</strong></span> checkbox in the Inspector from the <span class="strong"><strong>Box Collider 2D</strong></span> component. See <span class="emphasis"><em>Figure 6.7</em></span>. A Trigger differs from a Collider; colliders prevent objects from passing through and Triggers detect when objects pass through, allowing you to perform custom behaviors.</p><div class="mediaobject"><img src="/graphics/9781785888380/graphics/figure_06_07.jpg" /><div class="caption"><p>Figure 6.7: Creating a Kill Zone object and Trigger</p></div></div><p>Next, create a new script file <code class="literal">KillZone.cs</code>, which should be attached to the Kill Zone object in the scene. This script file is responsible for damaging the player's health for as long as they are in the Kill Zone. At this stage, there are several ways to approach kill zone implementation. One way is to destroy the player as soon as they enter the Kill Zone. The other is to damage the player for as long as they are in the Kill Zone. The second method is <a id="id363" class="indexterm"></a>preferred here because of its versatility and <a id="id364" class="indexterm"></a>contribution toward code reuse. Specifically, we get the option to damage the player by reducing their health at a particular speed (if we need to) as well as killing the player instantly simply by reducing their health by an increase in reduction speed. Let's see this at work in the following <span class="emphasis"><em>Code Sample 6.2</em></span>:</p><div class="informalexample"><pre class="programlisting">//--------------------------------
using UnityEngine;
using System.Collections;
//--------------------------------
public class KillZone : MonoBehaviour {
    //--------------------------------
    //Amount to damage player per second
    public float Damage = 100f;
    //--------------------------------
    void OnTriggerStay2D(Collider2D other)
    {
        //If not player then exit
        if(!other.CompareTag("Player"))return;

        //Damage player by rate
        if(PlayerControl.PlayerInstance!=null)
            PlayerControl.Health -= Damage * Time.deltaTime;
    }
    //--------------------------------
}
//--------------------------------</pre></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec25"></a>Code Sample 6.2</h3></div></div></div><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>The <a id="id365" class="indexterm"></a>
<code class="literal">KillZone</code> class is responsible for continually damaging the player health when a <code class="literal">GameObject</code>, tagged as <code class="literal">Player</code>, enters and remains within a Trigger Volume.</p></li><li style="list-style-type: disc"><p>The <code class="literal">OnTriggerStay2D</code> function is called automatically by Unity, once per frame, when <a id="id366" class="indexterm"></a>an object with <code class="literal">RigidBody</code> enters and remains within a Trigger Volume. Thus, when a physics object enters the Kill Zone trigger, the <code class="literal">OnTriggerStay2D</code> function will be called as frequently as the <code class="literal">Update</code> function. More <a id="id367" class="indexterm"></a>information on <code class="literal">OnTriggerStay2D</code> can be found at the online Unity documentation at <a class="ulink" href="http://docs.unity3d.com/ScriptReference/MonoBehaviour.OnTriggerStay2D.html" target="_blank">http://docs.unity3d.com/ScriptReference/MonoBehaviour.OnTriggerStay2D.html</a>.</p></li><li style="list-style-type: disc"><p>The <code class="literal">Damage</code> variable encodes the reduction of health for the player by adjusting the public static property, <code class="literal">Health</code>, which is part of the <code class="literal">PlayerControl</code> class. When <code class="literal">Health</code> reaches <code class="literal">0</code>, the player will be destroyed.</p></li></ul></div><p>Now, give <a id="id368" class="indexterm"></a>the game a test run, marking out a Kill Zone in the scene and walking the Player into it during play mode. On entry, the player character should be destroyed or damaged. To ensure that the player is killed instantly, increase the damage to a very high number, such as <code class="literal">9000</code>! After testing, create a prefab from the Kill Zone by dragging and dropping it from the scene <span class="strong"><strong>Hierarchy</strong></span> panel to the <span class="strong"><strong>Project</strong></span> panel in the <span class="strong"><strong>Prefab</strong></span> folder. Then, add the <span class="strong"><strong>Kill Zone</strong></span> prefab to each level, adjusting and sizing the Collider as needed. See <span class="emphasis"><em>Figure 6.8</em></span>:</p><div class="mediaobject"><img src="/graphics/9781785888380/graphics/figure_06_08.jpg" /><div class="caption"><p>Figure 6.8: Configuring a Kill Zone to destroy on contact</p></div></div></div></div>