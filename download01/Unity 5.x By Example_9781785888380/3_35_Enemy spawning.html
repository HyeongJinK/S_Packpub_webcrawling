<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch03lvl1sec39"></a>Enemy spawning</h2></div></div><hr /></div><p>To make the level fun and <a id="id230" class="indexterm"></a>challenging, we'll need more than simply one enemy. In fact, for a game that's essentially endless, we'll need to continually add enemies. These should be added gradually over time. Essentially, we'll need either regular or intermittent spawning of enemies, and this section will add that functionality. Before we can do this, however, we'll need to make a prefab from the enemy object. This can be achieved easily. Select the enemy in the <span class="strong"><strong>Hierarchy</strong></span> panel and then drag and drop it to the <span class="strong"><strong>Project</strong></span> panel in the <code class="literal">Prefabs</code> folder. This creates an <code class="literal">Enemy</code> prefab. See <span class="emphasis"><em>Figure 3.43</em></span>:</p><div class="mediaobject"><img src="/graphics/9781785888380/graphics/B05118_03_43.png.jpg" /><div class="caption"><p>Figure 3.43: Creating an Enemy prefab</p></div></div><p>Now, we'll make a new script (<code class="literal">Spawner.cs</code>) that spawns new enemies in the scene over time within a specified radius from the player spaceship. This script should be attached to a new, empty game <a id="id231" class="indexterm"></a>object in the scene. See <span class="emphasis"><em>Code Sample 3.9</em></span>:</p><div class="informalexample"><pre class="programlisting">//------------------------------
using UnityEngine;
using System.Collections;
//------------------------------
public class Spawner : MonoBehaviour
{
  public float MaxRadius = 1f;
  public float Interval = 5f;
  public GameObject ObjToSpawn = null;
  private Transform Origin = null;
  //------------------------------
  void Awake()
  {
  Origin = GameObject.FindGameObjectWithTag("Player").GetComponent&lt;Transform&gt;();
  }
  //------------------------------
  // Use this for initialization
  void Start () 
  {
    <span class="strong"><strong>InvokeRepeating("Spawn", 0f, Interval);</strong></span>
  }
  //------------------------------
  void Spawn () 
  {
    if(Origin == null)return;

    Vector3 SpawnPos = Origin.position + <span class="strong"><strong>Random.onUnitSphere *</strong></span> MaxRadius;
    SpawnPos = new Vector3(SpawnPos.x, 0f, SpawnPos.z);
    Instantiate(ObjToSpawn, SpawnPos, Quaternion.identity);
  }
  //------------------------------
}
//------------------------------</pre></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec18"></a>Code Sample 3.9</h3></div></div></div><p>The following points summarize the code sample:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>The <a id="id232" class="indexterm"></a>
<code class="literal">Spawner</code> class will spawn instances of <code class="literal">ObjToSpawn</code> (a prefab) on each interval of <code class="literal">Interval</code>. The interval is measured in seconds. The spawned objects will be created within a random radius from a center point, <code class="literal">Origin</code>.</p></li><li style="list-style-type: disc"><p>During the <code class="literal">Start</code> event, the <code class="literal">InvokeRepeating</code> function is called to continually execute the <code class="literal">Spawn</code> function on every interval to spawn a new enemy.</p></li><li style="list-style-type: disc"><p>The <code class="literal">Spawn</code> function will create instances of the enemy in the scene at a random radius from an origin point. Once spawned, the enemy will behave as normal, heading toward the player for an attack.</p></li></ul></div><p>The <code class="literal">Spawner</code> class is a global behavior that applies scene-wide. It does not depend on the player specifically, nor on any specific enemy. For this reason, it should be attached to an empty game object. Create one of these by selecting <span class="strong"><strong>GameObject</strong></span> | <span class="strong"><strong>Create Empty</strong></span> from the application menu. Name this <code class="literal">Spawner</code> and attach the <code class="literal">Spawner</code> script to it. See <span class="emphasis"><em>Figure 3.44</em></span>:</p><div class="mediaobject"><img src="/graphics/9781785888380/graphics/B05118_03_44.png.jpg" /><div class="caption"><p>Figure 3.44: Creating an empty game object</p></div></div><p>Once added to the scene, from the <span class="strong"><strong>Object Inspector</strong></span>, drag and drop the <code class="literal">Enemy</code> prefab to the <span class="strong"><strong>Obj To Spawn</strong></span> field in the <span class="strong"><strong>Spawner</strong></span> component. Set the <span class="strong"><strong>Interval</strong></span> to <code class="literal">2</code> seconds and increase the <span class="strong"><strong>Max Radius</strong></span> to <code class="literal">5</code>. See <span class="emphasis"><em>Figure 3.45</em></span>:</p><div class="mediaobject"><img src="/graphics/9781785888380/graphics/B05118_03_45.png.jpg" /><div class="caption"><p>Figure 3.45: Configuring the Spawner for Enemy objects</p></div></div><p>Now (drum roll), let's try the level. Press play on the toolbar and take the game for a test run. You <a id="id233" class="indexterm"></a>should now have a level with a fully controllable player character surrounded by a growing army of tracking enemy ships! Excellent work! See <span class="emphasis"><em>Figure 3.46</em></span>:</p><div class="mediaobject"><img src="/graphics/9781785888380/graphics/B05118_03_46.png.jpg" /><div class="caption"><p>Figure 3.46: Spawned enemy objects moving toward the player</p></div></div></div></div>