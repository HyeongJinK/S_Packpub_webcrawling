<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch05lvl1sec54"></a>Environment Physics</h2></div></div><hr /></div><p>The main problem <a id="id317" class="indexterm"></a>with our level as it stands is that it lacks interactivity. Specifically, if we dragged and dropped a player object to the level and pressed play on the toolbar, the player would drop through the floor and walls because the foreground texture isn't recognized by Unity as a solid object. It's just a texture and exists only in appearance and not in substance. In this section, we'll correct this using Physics and Colliders. To get started, we'll create a temporary player object (not the final version but just a temporary <span class="emphasis"><em>White Box</em></span> version used only for testing purposes). To create this, generate a capsule object in the scene by navigating to <span class="strong"><strong>GameObject</strong></span> | <span class="strong"><strong>3D Object</strong></span> | <span class="strong"><strong>Capsule</strong></span> from the application menu. Set the <span class="emphasis"><em>Z</em></span> position of the transform to match the foreground texture (for me, this is <code class="literal">-2</code>). Once generated, remove <span class="strong"><strong>Capsule Collider</strong></span> from the object. By default, the Capsule is assigned a 3D collider (such as the <span class="strong"><strong>Capsule Collider</strong></span>), which is useful primarily for 3D physics, but our game will be 2D. To remove the Collider, click on the Cog icon on the <span class="strong"><strong>Capsule Collider</strong></span> component in the <span class="strong"><strong>Object Inspector</strong></span> and choose <span class="strong"><strong>Remove Component</strong></span> from the menu. See <span class="emphasis"><em>Figure 5.16</em></span>:</p><div class="mediaobject"><img src="/graphics/9781785888380/graphics/figure_05_16.jpg" /><div class="caption"><p>Figure 5.16: Removing a Capsule Collider component</p></div></div><p>To make the object compatible with 2D Physics, add a Circle Collider component by choosing <a id="id318" class="indexterm"></a>
<span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>Physics 2D</strong></span> | <span class="strong"><strong>Circle Collider</strong></span> from the application menu. Once added, use the <span class="strong"><strong>Offset</strong></span> and <span class="strong"><strong>Radius</strong></span> settings on the Circle Collider component in the Inspector to adjust the size and position of the circle in relation to the capsule object in order to approximate the feet of a player character. To aid you in positioning the <span class="strong"><strong>Circle Collider</strong></span> more easily, you can switch the <span class="strong"><strong>Scene</strong></span> viewport mode to <span class="strong"><strong>Wireframe</strong></span> and <span class="strong"><strong>2D</strong></span>, if needed. To do this, use the <span class="strong"><strong>2D Toggle</strong></span> button and the <span class="strong"><strong>Scene Render</strong></span> mode drop-down button in the viewport toolbar. See <span class="emphasis"><em>Figure 5.17</em></span>:</p><div class="mediaobject"><img src="/graphics/9781785888380/graphics/figure_05_17.jpg" /><div class="caption"><p>Figure 5.17: Adjusting the Circle Collider for the player character</p></div></div><p>Next, to make the <span class="strong"><strong>Circle Collider</strong></span> work with 2D Physics, add a RigidBody2D component to the Capsule. To do this, select <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>Physics 2D</strong></span> | <span class="strong"><strong>RigidBody2D</strong></span> from the application menu. You can confirm that this has worked by previewing the game in Play mode. When you click on the play icon, the Capsule object should fall down and through the foreground floor under the effect of gravity. See <span class="emphasis"><em>Figure 5.18</em></span>:</p><div class="mediaobject"><img src="/graphics/9781785888380/graphics/figure_05_18.jpg" /><div class="caption"><p>Figure 5.18: Adding a Rigidbody 2D component to a test character</p></div></div><p>Now, it's <a id="id319" class="indexterm"></a>time to configure the foreground texture to work as a unified whole with physics. Right now, our test player character falls through the floor and this is not what we want. To fix this, we'll need to add a collider to the foreground environment. One method for this is to use Edge Collider 2D. This lets you draw out a low polygon mesh collider around your ground image manually, approximating the terrain. To get started, select the foreground in the scene and then choose <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>Physics 2D</strong></span> | <span class="strong"><strong>Edge Collider 2D</strong></span> from the application menu. Doing this will add an Edge Collider 2D component to the foreground object. See <span class="emphasis"><em>Figure 5.19</em></span>:</p><div class="mediaobject"><img src="/graphics/9781785888380/graphics/figure_05_19.jpg" /><div class="caption"><p>Figure 5.19: Adding an Edge Collider</p></div></div><p>By default, adding an Edge Collider 2D appears to have little effect on the selected object or any other objects, except for a single horizontal line drawn across the width of the scene. This can be seen in the <span class="strong"><strong>Scene</strong></span> tab when the <span class="strong"><strong>Foreground</strong></span> object is selected and in the <span class="strong"><strong>Game</strong></span> tab if the <span class="strong"><strong>Gizmos</strong></span> tool button is enabled. If the player is positioned above the horizontal line and <a id="id320" class="indexterm"></a>you press Play on the toolbar, the player character will fall downward and treat the horizontal edge as a solid platform. See <span class="emphasis"><em>Figure 5.20</em></span>:</p><div class="mediaobject"><img src="/graphics/9781785888380/graphics/figure_05_20.jpg" /><div class="caption"><p>Figure 5.20: The Edge Collider is useful to approximate platforms and solid surfaces</p></div></div><p>Of course, our terrain isn't simply a straight-edged surface. Rather, it has elevations, bumps, and platforms. These can be approximated closely with the Edge Collider 2D component using the <span class="strong"><strong>Collider Edit</strong></span> mode. To access this mode, click on the <span class="strong"><strong>Edit Collider</strong></span> button from the <span class="strong"><strong>Object Inspector</strong></span>. See <span class="emphasis"><em>Figure 5.21</em></span>:</p><div class="mediaobject"><img src="/graphics/9781785888380/graphics/figure_05_21.jpg" /><div class="caption"><p>Figure 5.21: The Edit Collider mode lets you change the shape of an Edge Collider 2D</p></div></div><p>With the <span class="strong"><strong>Edit Collider</strong></span> mode active, you can reshape the collider to conform to the terrain. Let's focus on one area such as the bottom right-hand side of the terrain. By moving your mouse cursor over the edge points of the <span class="strong"><strong>Edge Collider</strong></span> (the green line), you can click and drag to reposition it. To approximate the bottom right island of the terrain, click and drag <a id="id321" class="indexterm"></a>the rightmost edge point to the right-hand side of the scene. See <span class="emphasis"><em>Figure 5.22</em></span>:</p><div class="mediaobject"><img src="/graphics/9781785888380/graphics/figure_05_22.jpg" /><div class="caption"><p>Figure 5.22: Starting to reshape the Edge Collider to approximate the terrain</p></div></div><p>Next, click and drag the left point of the collider to match with the leftmost edge of the right-hand island. See <span class="emphasis"><em>Figure 5.23</em></span>:</p><div class="mediaobject"><img src="/graphics/9781785888380/graphics/figure_05_23.jpg" /><div class="caption"><p>Figure 5.23: Positioning the left-most of the right-hand island</p></div></div><p>Now that the left and right edge points are positioned, let's add some additional points on the line between to reshape it, conforming to the right-hand island. Move your cursor anywhere on the line, click and drag to insert a new point, and reposition it to match the island. Repeat this process, adding additional points to reshape the line as needed. See <span class="emphasis"><em>Figure 5.24</em></span>:</p><div class="mediaobject"><img src="/graphics/9781785888380/graphics/figure_05_24.jpg" /><div class="caption"><p>Figure 5.24: Shaping the Edge Collider to the right-most island</p></div></div><p>You now have a fully shaped line that matches the terrain's right-most island. Having created this, exit the <span class="strong"><strong>Edit Collider</strong></span> mode by simply clicking on the <span class="strong"><strong>Edit Collider</strong></span> button again from the <span class="strong"><strong>Object Inspector</strong></span>. To create colliders for the remaining islands of the terrain, add a new <span class="strong"><strong>Edge Collider</strong></span> to the same object. You can then add any number of <span class="strong"><strong>Edge Colliders</strong></span> to a single object, and each collider should be used to approximate the topology of a single, isolated island in the complete terrain. See <span class="emphasis"><em>Figure 5.25</em></span>:</p><div class="mediaobject"><img src="/graphics/9781785888380/graphics/figure_05_25.jpg" /><div class="caption"><p>Figure 5.25: Multiple Edge Colliders on one object can be used to approximate complex terrain</p></div></div><p>Multiple Edge Collider components are now added together to a single foreground object, approximating the complete terrain for the scene. We can now test play collisions against the <span class="strong"><strong>Player Capsule</strong></span> object by pressing the play icon on the toolbar and seeing how the capsule reacts against the terrain. This time, the capsule will collide and interact with the ground as opposed to passing <a id="id322" class="indexterm"></a>through. This confirms that the terrain is configured appropriately with the physics system. See <span class="emphasis"><em>Figure 5.26</em></span>:</p><div class="mediaobject"><img src="/graphics/9781785888380/graphics/figure_05_26.jpg" /><div class="caption"><p>Figure 5.26: Capsule Object interacting with a terrain made from Edge Colliders</p></div></div><p>Congratulations! In this section, we've created a complete terrain for a single scene using Edge Collider components. This terrain not only fits the screen and appears as intended, but acts as a physical obstacle for the player character and other physics-based objects. Of course, so far, we've been using a rough approximation for the player and now it's time to expand upon this.</p></div>