<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch02lvl1sec21"></a>C# scripting in Unity</h2></div></div><hr /></div><p>Defining game <a id="id104" class="indexterm"></a>logic, rules, and behavior often requires scripting. Specifically, to <a id="id105" class="indexterm"></a>transform a static and lifeless scene with objects into an environment that does something, a developer needs to code behaviors. It requires someone to define how things should act and react under specific conditions. The coin collection game is no exception to this. In particular, it requires three main features:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>To know when the player collects a coin</p></li><li style="list-style-type: disc"><p>To keep track of how many coins are collected during gameplay</p></li><li style="list-style-type: disc"><p>To determine whether a timer has expired</p></li></ul></div><p>There's no default out-of-the-box functionality included with Unity to handle this scenario. So we must write some code to achieve it. Unity supports two languages, namely, UnityScript (sometimes called JavaScript) and C#. Both are capable and useful languages, but this book uses C# because, going forward, support for JavaScript will eventually be dropped. Let's start coding these three features in sequence. To create a new script file, right-click on an <a id="id106" class="indexterm"></a>empty area in the <span class="strong"><strong>Project</strong></span> panel, and from the context menu, choose <span class="strong"><strong>Create</strong></span> | <span class="strong"><strong>C# Script</strong></span>. Alternatively, you can navigate to <span class="strong"><strong>Assets</strong></span> | <span class="strong"><strong>Create</strong></span> | <span class="strong"><strong>C# Script</strong></span> from the application menu. See <span class="emphasis"><em>Figure 2.11</em></span>:</p><div class="mediaobject"><img src="/graphics/9781785888380/graphics/figure_02_11.jpg" /><div class="caption"><p>Figure 2.11: Creating a new C# script</p></div></div><p>After the file is <a id="id107" class="indexterm"></a>created, you'll need to assign a descriptive name to it. I'll call it <code class="literal">Coin.cs</code>. In Unity, each script file represents a single, discrete class of matching names. Hence, the <code class="literal">Coin.cs</code> file encodes the <code class="literal">Coin</code> class. The <code class="literal">Coin</code> class will encapsulate the behavior of a <code class="literal">Coin</code> object and will, eventually, be attached to the <code class="literal">Coin</code> object in the scene. See <span class="emphasis"><em>Figure 2.12</em></span>:</p><div class="mediaobject"><img src="/graphics/9781785888380/graphics/figure_02_12.jpg" /><div class="caption"><p>Figure 2.12: Naming a script file</p></div></div><p>Double-click on the <code class="literal">Coin.cs</code> file from the <span class="strong"><strong>Object Inspector</strong></span> to open it to edit in <span class="strong"><strong>MonoDevelop</strong></span>, a third-party <a id="id108" class="indexterm"></a>IDE application that ships with Unity. This program lets you <a id="id109" class="indexterm"></a>edit and write code for your games. Once opened in MonoDevelop, the source file will appear, as shown in <span class="emphasis"><em>Code Sample 2.1</em></span>:</p><div class="informalexample"><pre class="programlisting">using UnityEngine;
using System.Collections;

public class Coin : MonoBehaviour
{

  // Use this for initialization
  void Start () {}
  
  // Update is called once per frame
  void Update () {}
}</pre></div><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip0007"></a>Tip</h3><p>
<span class="strong"><strong>Downloading the example code</strong></span>
</p><p>You can download the example code files for this book from your account at <a class="ulink" href="http://www.packtpub.com" target="_blank">http://www.packtpub.com</a>. If you purchased this book elsewhere, you can visit <a class="ulink" href="http://www.packtpub.com/support" target="_blank">http://www.packtpub.com/support</a> and register to have the files e-mailed directly to you.</p><p>You can download the code files by following these steps:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>Log in or register to our website using your e-mail address and password.</p></li><li style="list-style-type: disc"><p>Hover the mouse pointer on the <span class="strong"><strong>SUPPORT</strong></span> tab at the top.</p></li><li style="list-style-type: disc"><p>Click on <span class="strong"><strong>Code Downloads &amp; Errata</strong></span>.</p></li><li style="list-style-type: disc"><p>Enter the name of the book in the <span class="strong"><strong>Search</strong></span> box.</p></li><li style="list-style-type: disc"><p>Select the book for which you're looking to download the code files.</p></li><li style="list-style-type: disc"><p>Choose from the drop-down menu where you purchased this book from.</p></li><li style="list-style-type: disc"><p>Click on <span class="strong"><strong>Code Download</strong></span>.</p></li></ul></div><p>Once the file is downloaded, please make sure that you unzip or extract the folder using the latest version of:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>WinRAR / 7-Zip for Windows</p></li><li style="list-style-type: disc"><p>Zipeg / iZip / UnRarX for Mac</p></li><li style="list-style-type: disc"><p>7-Zip / PeaZip for Linux</p></li></ul></div></div><p>By default, all newly created classes derive from <code class="literal">MonoBehavior</code>, which defines a common set of functionality <a id="id110" class="indexterm"></a>shared by all components. The <code class="literal">Coin</code> class features two autogenerated functions, namely <code class="literal">Start</code> and <code class="literal">Update</code>. These functions are events invoked automatically by Unity. <code class="literal">Start</code> is called once as soon as the <code class="literal">GameObject</code> (to which the script is attached) is created in the <span class="strong"><strong>Scene</strong></span>. <code class="literal">Update</code> is called once per frame on the object to which the script is attached. <code class="literal">Start</code> is useful for initialization code and <code class="literal">Update</code> is useful to create behaviors over time, such as motion and change. Now, before moving any further, let's attach the newly created script file to the <code class="literal">Coin</code> object in the <span class="strong"><strong>Scene</strong></span>. To do this, drag and drop the <code class="literal">Coin.cs</code> script file from the <span class="strong"><strong>Project</strong></span> panel on the <code class="literal">Coin</code> object. When you do this, a new <span class="strong"><strong>Coin</strong></span> component is added to the object. This means that the script is instantiated and lives on the object. See <span class="emphasis"><em>Figure 2.13</em></span>, attaching a script file to an object:</p><div class="mediaobject"><img src="/graphics/9781785888380/graphics/figure_02_13.jpg" /><div class="caption"><p>Figure 2.13: Attaching a script file to an object</p></div></div><p>When a script is attached to an object, it exists on the object as a component. A script file can normally be added to multiple objects and even to the same object multiple times. Each component represents a separate and unique instantiation of the class. When a script is attached in this way, Unity automatically invokes its events, such as <code class="literal">Start</code> and <code class="literal">Update</code>. You can confirm that your script is working normally by including a <code class="literal">Debug.Log</code> statement in the <code class="literal">Start</code> <a id="id111" class="indexterm"></a>function. This prints a debug message to the <span class="strong"><strong>Console</strong></span> window <a id="id112" class="indexterm"></a>when the <code class="literal">GameObject</code> is created in the <span class="strong"><strong>Scene</strong></span>. Consider <span class="emphasis"><em>Code Sample 2.2</em></span>, which achieves this:</p><div class="informalexample"><pre class="programlisting">using UnityEngine;
using System.Collections;

public class Coin : MonoBehaviour
 {
  // Use this for initialization
  void Start () {
    <span class="strong"><strong>Debug.Log ("Object Created");</strong></span>
  }
  
  // Update is called once per frame
  void Update () {
  

  }
}</pre></div><p>If you press play (<span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>P</em></span>) on the toolbar to run your game with the preceding script attached to an object, you will see the message, <span class="strong"><strong>Object Created</strong></span>, printed to the <span class="strong"><strong>Console</strong></span> windowâ€”once for each instantiation of the class. See <span class="emphasis"><em>Figure 2.14</em></span>:</p><div class="mediaobject"><img src="/graphics/9781785888380/graphics/figure_02_14.jpg" /><div class="caption"><p>Figure 2.14: Printing messages to the Console window</p></div></div><p>Good work! We've now created a basic script for the <code class="literal">Coin</code> class and attached it to the coin. Next, let's <a id="id113" class="indexterm"></a>define its functionality to keep track of coins as they are <a id="id114" class="indexterm"></a>collected.</p></div>