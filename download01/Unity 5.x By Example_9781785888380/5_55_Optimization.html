<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch05lvl1sec57"></a>Optimization</h2></div></div><hr /></div><p>Our work so <a id="id344" class="indexterm"></a>far has produced an interesting environment and a controllable character within this environment. Before moving forward, let's turn our attention to optimizationâ€”an issue that should be considered early during development. Optimization refers to the tips and tricks that we can apply to improve runtime performance as well as our workflow generally. Here, we'll consider prefabs to improve our workflow and Sprite Packing to improve runtime performance. Let's start with prefabs.</p><p>A prefab is a Unity asset that lets you group together many objects in a scene and package them together as a single unit that can be added to the <span class="strong"><strong>Project</strong></span> panel as an asset. From here, the prefab can be added as a complete unit to any other scene or environment as though it were a separate and complete <span class="emphasis"><em>thing</em></span>. The player character is an ideal candidate for a prefab because it must feature in all the other scenes we create. Let's create a prefab from the player. To do this, simply drag and drop the <span class="strong"><strong>Player</strong></span> object to the <span class="strong"><strong>Project</strong></span> panel in a separate folder called <code class="literal">Prefabs</code>. See <span class="emphasis"><em>Figure 5.49</em></span>:</p><div class="mediaobject"><img src="/graphics/9781785888380/graphics/figure_05_49.jpg" /><div class="caption"><p>Figure 5.49: Generating a player prefab</p></div></div><p>After the <span class="strong"><strong>Prefab</strong></span> is created, the <span class="strong"><strong>Player</strong></span> object name in the hierarchy panel will turn blue, indicating that it's connected to the Prefab asset. This means that if you select the <span class="strong"><strong>Prefab</strong></span> in the <span class="strong"><strong>Project</strong></span> panel and make changes in the Inspector, then the <span class="strong"><strong>Player</strong></span> object in the scene will change <a id="id345" class="indexterm"></a>automatically to match these changes. You can, however, break the connection between the <span class="strong"><strong>Player</strong></span> in the scene and <span class="strong"><strong>Prefab</strong></span> by selecting the <span class="strong"><strong>Player</strong></span> object and choosing <span class="strong"><strong>GameObject</strong></span> | <span class="strong"><strong>Break Prefab Instance</strong></span> from the application menu. This converts the scene object into a separate and independent duplicate of the Prefab. See <span class="emphasis"><em>Figure 5.50</em></span>:</p><div class="mediaobject"><img src="/graphics/9781785888380/graphics/figure_05_50.jpg" /><div class="caption"><p>Figure 5.50: Breaking a prefab instance</p></div></div><p>Most of the time, however, you'll want to keep the connection between objects and their prefabs. Sometimes, though, you may make changes to the object in the scene, and then want these changes to feedback to the <span class="strong"><strong>Prefab</strong></span> asset in the <span class="strong"><strong>Project</strong></span> panel, affecting all other linked instances if there are any. To do this, select the object to which changes have been made, and then <a id="id346" class="indexterm"></a>select <span class="strong"><strong>GameObject</strong></span> | <span class="strong"><strong>Apply Changes to Prefab</strong></span> from the application menu. See <span class="emphasis"><em>Figure 5.51</em></span>:</p><div class="mediaobject"><img src="/graphics/9781785888380/graphics/figure_05_51.jpg" /><div class="caption"><p>Figure 5.51: Applying changes to a prefab</p></div></div><p>In addition to making Prefabs, you'll also want to optimize the render performance for your 2D games. Right now, when running the game, Unity will perform a unique and separate draw call for each and every unique texture or sprite onscreen at the time. A draw call simply refers to a step or process cycle that Unity must run through to properly display a graphic onscreen, such as a mesh, material, or texture. Draw calls represent a computational expense, and so it's a good idea to reduce them wherever possible.</p><p>For 2D games, we can reduce draw calls by batching together related textures, such as all the props for a scene, all the enemies, or all the weapons. That is, by indicating to Unity that a group of textures belong together, Unity can perform internal optimizations that increase render performance. Specifically, Unity will paste all related textures in a single and larger internal texture that it uses instead. To achieve this optimization, select all <span class="emphasis"><em>prop</em></span> textures. For our game, I will include the <span class="strong"><strong>Player</strong></span>, <span class="strong"><strong>House</strong></span>, <span class="strong"><strong>Platform</strong></span>, and <span class="strong"><strong>Gem</strong></span> as props. These textures are all featured in the <span class="strong"><strong>Project</strong></span> panel, though not all are used in the game yet. Select these textures and, from the Inspector, assign them the same name for the <span class="strong"><strong>Packing Tag</strong></span> field (Props). Then, click on <span class="strong"><strong>Apply</strong></span>. See <span class="emphasis"><em>Figure 5.52</em></span>:</p><div class="mediaobject"><img src="/graphics/9781785888380/graphics/figure_05_52.jpg" /><div class="caption"><p>Figure 5.52: Assigning multiple textures to the same Packing Tag</p></div></div><p>Now, repeat <a id="id347" class="indexterm"></a>this process for the <span class="strong"><strong>Backgrounds</strong></span>, selecting all backgrounds and assigning them to the <span class="strong"><strong>Background Packing</strong></span> tag. Then, click on <span class="strong"><strong>Apply</strong></span>. See <span class="emphasis"><em>Figure 5.53</em></span>:</p><div class="mediaobject"><img src="/graphics/9781785888380/graphics/figure_05_53.jpg" /><div class="caption"><p>Figure 5.53: Creating a Background batch of textures</p></div></div><p>That's it! Now, when you press on the play icon, Unity will automatically batch and organize the textures for optimal performance based on your groupings. This technique can significantly reduce draw calls. On pressing the play icon, you may see a loading bar or progress bar while Unity internally generates a new texture set. During Play Mode, you can view how Unity has organized the textures through the <span class="strong"><strong>Sprite Packer</strong></span> window. To access this, select <span class="strong"><strong>Window</strong></span> | <span class="strong"><strong>Sprite Packer</strong></span>. See <span class="emphasis"><em>Figure 5.54</em></span>:</p><div class="mediaobject"><img src="/graphics/9781785888380/graphics/figure_05_54.jpg" /><div class="caption"><p>Figure 5.54: Unity organizes all similarly tagged textures into the same texture space as an Atlas</p></div></div></div>