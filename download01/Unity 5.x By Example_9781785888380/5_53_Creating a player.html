<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch05lvl1sec55"></a>Creating a player</h2></div></div><hr /></div><p>The player <a id="id323" class="indexterm"></a>character is a small, green alien-looking creature that can be controlled and guided by the gamer through a level using many conventional platform-game mechanics, such as walking, jumping, and interacting. In the previous section, we built a <span class="emphasis"><em>White Box</em></span> (prototype) character to test physical interactions with the environment, but here, we'll develop the player character in more depth. <span class="emphasis"><em>Figure 5.27</em></span> illustrates our character texture imported earlier in the chapter, representing all limbs and parts for the player:</p><div class="mediaobject"><img src="/graphics/9781785888380/graphics/figure_05_27.jpg" /><div class="caption"><p>Figure 5.27: Character and his limbs in a consolidated texture</p></div></div><p>The player texture, as <a id="id324" class="indexterm"></a>shown in <span class="emphasis"><em>Figure 5.27</em></span>, is called an <span class="strong"><strong>Atlas Texture</strong></span> or <span class="strong"><strong>Sprite Sheet</strong></span> <a id="id325" class="indexterm"></a>because it contains all frames or parts of a character in a single texture space. The problem with this texture, as it stands, is that when dragged and <a id="id326" class="indexterm"></a>dropped from the <span class="strong"><strong>Project</strong></span> panel to the scene, it'll be added as a single, self-contained sprite. This is because Unity recognizes all the separate parts as a single sprite. Rather, these should be separated into distinct units. See <span class="emphasis"><em>Figure 5.28</em></span>:</p><div class="mediaobject"><img src="/graphics/9781785888380/graphics/figure_05_28.jpg" /><div class="caption"><p>Figure 5.28: The player sprite texture needs to be divided into separate parts</p></div></div><p>To divide the character texture into separate parts on a per-limb basis, we'll use <span class="strong"><strong>Sprite Editor</strong></span>. To access this tool, select the character texture in the <span class="strong"><strong>Project</strong></span> panel. Then, from the <span class="strong"><strong>Object Inspector</strong></span>, change <span class="strong"><strong>Sprite Mode</strong></span> from <span class="strong"><strong>Single</strong></span> to <span class="strong"><strong>Multiple</strong></span>. Then, click on <span class="strong"><strong>Apply</strong></span>. Next, click on the <span class="strong"><strong>Sprite Editor</strong></span> button to open the <span class="strong"><strong>Sprite Editor</strong></span> tool, allowing you cut apart the whole texture into specific slices. See <span class="emphasis"><em>Figure 5.29</em></span>:</p><div class="mediaobject"><img src="/graphics/9781785888380/graphics/figure_05_29.jpg" /><div class="caption"><p>Figure 5.29: Specifying a sprite as Multiple</p></div></div><p>With the <span class="strong"><strong>Sprite Editor</strong></span> tool, you can separate different parts of a texture into discrete and separate units. One <a id="id327" class="indexterm"></a>method to achieve this is by drawing a rectangle around each image area that should be separate, and simply clicking and dragging your mouse to draw a texture region. See <span class="emphasis"><em>Figure 5.30</em></span>:</p><div class="mediaobject"><img src="/graphics/9781785888380/graphics/figure_05_30.jpg" /><div class="caption"><p>Figure 5.30: Drawing a sprite manually</p></div></div><p>Now, although a sprite can be separated manually, as we've just seen, Unity can often cut apart the texture automatically, identifying isolated areas of pixels and saving us a lot of time. We'll do that here for the player character. To do this, click on the <span class="strong"><strong>Slice</strong></span> button listed at the top <a id="id328" class="indexterm"></a>left corner of the <span class="strong"><strong>Sprite Editor</strong></span> window. See <span class="emphasis"><em>Figure 5.31</em></span>:</p><div class="mediaobject"><img src="/graphics/9781785888380/graphics/figure_05_31.jpg" /><div class="caption"><p>Figure 5.31: Accessing the Slice tool</p></div></div><p>From the <span class="strong"><strong>Slice</strong></span> tool window, ensure that <span class="strong"><strong>Type</strong></span> is set to <span class="strong"><strong>Automatic</strong></span>, which means that Unity will auto-detect the location of separate sprites. <span class="strong"><strong>Pivot</strong></span> can be left at <span class="strong"><strong>Center</strong></span>, determining the pivot point for each sprite. <span class="strong"><strong>Method</strong></span> should be <span class="strong"><strong>Delete Existing</strong></span>, meaning that any existing sprites or slices in the texture space will be erased and replaced entirely by the newly autogenerated slices. Then, click on the <span class="strong"><strong>Slice</strong></span> button to confirm the operation and the texture will be sliced into separate sprites with a clear border drawn around each sprite. See <span class="emphasis"><em>Figure 5.32</em></span>:</p><div class="mediaobject"><img src="/graphics/9781785888380/graphics/figure_05_32.jpg" /><div class="caption"><p>Figure 5.32: A fully sliced sprite</p></div></div><p>The texture is now divided into several sprites: head, body, arm, and leg. The final character in-scene will obviously have two arms and two legs but these will be formed from duplicated sprites. The final process now is to set the pivot point for each sprite—the point around which the sprite will rotate. This will be important later to animate the character correctly, as we'll see. Let's start by setting the pivot for the head. Select the head sprite in the editor and then click and drag the pivot handle (blue circle) to reposition the sprite's center of rotation. Click and drag the handle to the bottom middle of the head, roughly <a id="id329" class="indexterm"></a>where the head would connect to the neck. This makes sense because the head will rotate and hinge from around this point. As you move the pivot around, you should see the <span class="strong"><strong>X</strong></span> and <span class="strong"><strong>Y</strong></span> values change from the <span class="strong"><strong>Custom Pivot</strong></span> field in the <span class="strong"><strong>Sprite Properties</strong></span> dialog, shown in the bottom right-hand corner of the <span class="strong"><strong>Sprite Editor</strong></span> window. See <span class="emphasis"><em>Figure 5.33</em></span>:</p><div class="mediaobject"><img src="/graphics/9781785888380/graphics/figure_05_33.jpg" /><div class="caption"><p>Figure 5.33: Repositioning the sprite pivot</p></div></div><p>Next, position the pivot for the arm, which should be at the shoulder joint where the arm connects to a torso; then <a id="id330" class="indexterm"></a>for the leg, which should be near the hip where the leg connects to a torso, and finally, the torso itself, whose pivot should be at the hip joint. See <span class="emphasis"><em>Figure 5.34</em></span>:</p><div class="mediaobject"><img src="/graphics/9781785888380/graphics/figure_05_34.jpg" /><div class="caption"><p>Figure 5.34: Positioning the pivot for the torso</p></div></div><p>When completed, click on the <span class="strong"><strong>Apply</strong></span> button to confirm changes and then close the <span class="strong"><strong>Sprite Editor</strong></span>. On returning to the main Unity interface, the appearance of the character texture will have changed in the <span class="strong"><strong>Project</strong></span> panel. Specifically, the character texture features a small arrow icon attached to the right-hand side. When you click this, the texture expands to review all the separate <a id="id331" class="indexterm"></a>sprites in a row, which can be dragged and dropped individually to the scene. See <span class="emphasis"><em>Figure 5.35</em></span>:</p><div class="mediaobject"><img src="/graphics/9781785888380/graphics/figure_05_35.jpg" /><div class="caption"><p>Figure: 5.35: Previewing character sprites</p></div></div><p>Now that we've isolated all player sprite textures, we can start to build a game character in the scene. Start by creating an empty game object with the <span class="strong"><strong>GameObject</strong></span> | <span class="strong"><strong>Create Empty</strong></span> command from the application menu. Name the object <code class="literal">Player</code> and assign it a Player Tag from the Inspector. This object will act as the ultimate or topmost parent object for the player character. Existing beneath this object as children will be the character's constituent parts: torso, arms, and legs. So, let's drag and drop the Torso sprite from the <span class="strong"><strong>Project</strong></span> panel to the <span class="strong"><strong>Hierarchy</strong></span> panel as a child of the <span class="strong"><strong>Player</strong></span> object. See <span class="emphasis"><em>Figure 5.36</em></span>:</p><div class="mediaobject"><img src="/graphics/9781785888380/graphics/figure_05_36.jpg" /><div class="caption"><p>Figure 5.36: Starting the player character</p></div></div><p>After the torso has been added, we can add legs and arms. The arms should be added as children of the torso because the torso determines where the arms will be. However, the legs should be added as <a id="id332" class="indexterm"></a>children of the <span class="strong"><strong>Player</strong></span> object and are therefore siblings of the torso, because the torso can rotate independently of the legs. See <span class="emphasis"><em>Figure 5.37</em></span> for the complete hierarchical arrangement. As you add each limb, you'll want to offset its position so that it appears correctly in relation to other limbs—the head should appear above the feet and so on.</p><div class="mediaobject"><img src="/graphics/9781785888380/graphics/figure_05_37.jpg" /><div class="caption"><p>Figure 5.37: Building a character</p></div></div><p>The rendering order of body parts is probably not correct by default insofar as each item will have an identical order in the Sprite Renderer component. This means that Unity could potentially render each limb in any order, allowing arms to appear in front of the head, legs to appear in front of the body, and so on. To correct this, we'll select each limb in turn and assign it an appropriate order value, taking care that it's higher than the world background order and less than the world foreground order. I've assigned the body an order of <code class="literal">103</code>, the head <a id="id333" class="indexterm"></a>
<code class="literal">105</code>, left arm <code class="literal">102</code>, right arm <code class="literal">104</code>, left leg <code class="literal">100</code>, and right leg <code class="literal">101</code>. See <span class="emphasis"><em>Figure 5.38</em></span>:</p><div class="mediaobject"><img src="/graphics/9781785888380/graphics/figure_05_38.jpg" /><div class="caption"><p>Figure 5.38: Ordering body parts</p></div></div><p>The rendering order for limbs is now configured successfully. Let's set up collisions and physics for the player. To do this, add two colliders—a Circle Collider to approximate the character feet, allowing us to determine when the character is in contact with the ground, and a Box Collider that approximates most of the body including the head. These colliders can be added by selecting the <span class="strong"><strong>Player</strong></span> object (the topmost object) and then navigating to <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>Physics 2D</strong></span> | <span class="strong"><strong>Circle Collider 2D</strong></span> and <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>Physics 2D</strong></span> | <span class="strong"><strong>Box Collider 2D</strong></span>. See <span class="emphasis"><em>Figure 5.39</em></span>:</p><div class="mediaobject"><img src="/graphics/9781785888380/graphics/figure_05_39.jpg" /><div class="caption"><p>Figure 5.39: Adding two colliders to the Player Object: Circle Collider and Box Collider</p></div></div><p>The Circle Collider is of special importance because it's the primary means to determine whether the character is touching the ground, and it'll also be in contact with the ground as the character moves. For <a id="id334" class="indexterm"></a>this reason, a Physics Material should be assigned to this collider to prevent friction effects from stopping or corrupting character motion as it moves around the scene. To achieve this, create a new Physics Material by right-clicking in the empty space in the <span class="strong"><strong>Project</strong></span> panel and choose <span class="strong"><strong>Create</strong></span> | <span class="strong"><strong>Physics2D Material</strong></span> from the context menu. Name the material <code class="literal">Low Friction</code>. See <span class="emphasis"><em>Figure 5.40</em></span>:</p><div class="mediaobject"><img src="/graphics/9781785888380/graphics/figure_05_40.jpg" /><div class="caption"><p>Figure 5.40: Creating a new Physics Material</p></div></div><p>Select the Physics2D material in the <span class="strong"><strong>Project</strong></span> panel, and from the <span class="strong"><strong>Inspector</strong></span>, change the Friction setting to <code class="literal">0.1</code>. Then, drag and drop the Physics2D material from the <span class="strong"><strong>Project</strong></span> panel to the <span class="strong"><strong>Material</strong></span> slot for the CircleCollider2D component on the <span class="strong"><strong>Player</strong></span> object. See <span class="emphasis"><em>Figure 5.41</em></span>. Using these settings, the character will behave more realistically.</p><div class="mediaobject"><img src="/graphics/9781785888380/graphics/figure_05_41.jpg" /><div class="caption"><p>Figure 5.41: Assigning a Physics material to the player character</p></div></div><p>Then, finally assign RigidBody2D to the <span class="strong"><strong>Player</strong></span> object and set both <span class="strong"><strong>Linear Drag</strong></span> and <span class="strong"><strong>Gravity Scale</strong></span> to <code class="literal">3</code>. In addition, set <span class="strong"><strong>Collison Detection</strong></span> to <span class="strong"><strong>Continuous</strong></span> for the most accurate collision detection and <span class="strong"><strong>Freeze Rotation</strong></span> of the object on the <span class="emphasis"><em>Z</em></span> axis because the player character should <a id="id335" class="indexterm"></a>never rotate. Now, you have a fully completed physical object representing the player. See <span class="emphasis"><em>Figure 5.42</em></span>. Good work!</p><div class="mediaobject"><img src="/graphics/9781785888380/graphics/figure_05_42.jpg" /><div class="caption"><p>Figure 5.42: Configuring the player character for Physics</p></div></div></div>