<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch09lvl1sec93"></a>Creating a generic ragdoll with character joints</h2></div></div><hr /></div><p>This time we will create a <span>ragdoll</span><a id="id325241232" class="indexterm"></a> for a non-humanoid <span>character</span><a id="id325241554" class="indexterm"></a>. We cannot use the Ragdoll Wizard in this case, but instead we will make the ragdoll manually.</p><div class="mediaobject"><img src="/graphics/9781785883910/graphics/41aeaf08-7428-4937-a7f5-2c8e0a58f2a4.png" /></div><p>A generic character ragdoll in action</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl2sec289"></a>Getting ready</h3></div></div></div><p>For this recipe, we need a nonhumanoid character. We use our old fellow <strong class="userinput"><code>Spider</code></strong> as an example. The character needs to be rigged. You can also open the example Unity project and go to the <code class="literal">Chapter 09 Physics and animations\Recipe 05 Creating a generic ragdoll with character joints</code> directory. If you open the <code class="literal">Example.unity</code> scene there and play the game, you will see a falling spider with the ragdoll already turned on. You can find the <strong class="userinput"><code>Spider</code></strong> in the <code class="literal">Rigs</code> directory.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl2sec290"></a>How to do it...</h3></div></div></div><p>To create a generic ragdoll, follow these steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Import the character to Unity and place it in the scene.</li><li>Select all the bones of the character's rig that will be used in the ragdoll simulation. In our example, we skipped the fangs.</li><li>Add <strong class="userinput"><code>Capsule Collider</code></strong>, <strong class="userinput"><code>Rigidbody</code></strong>, and <strong class="userinput"><code>Character Joint</code></strong> components to the selected bones.</li></ol></div><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>Adjust the shapes of the colliders to match the limbs of the character. You should <span>avoid</span><a id="id325522881" class="indexterm"></a> colliders intersecting with each other. You may need to change a few <span>colliders</span><a id="id325522917" class="indexterm"></a> to <strong class="userinput"><code>Box Colliders</code></strong> or <strong class="userinput"><code>Sphere Colliders</code></strong> (our Spider's abdomen has <strong class="userinput"><code>Box Colliders</code></strong> instead of <strong class="userinput"><code>Capsule Colliders</code></strong> and the head has a <strong class="userinput"><code>Sphere Collider</code></strong>).</li><li>Make sure all <strong class="userinput"><code>Character Joints</code></strong> have the <strong class="userinput"><code>Auto Configure Connected</code></strong><strong class="userinput"><code>Anchor</code></strong> option selected.</li><li>Choose the root body part of your character (for our <strong class="userinput"><code>Spider</code></strong>, it was the abdomen).</li><li>Remove the <strong class="userinput"><code>Character Joint</code></strong> component from that body part to make it work just like a normal rigid body.</li><li>Connect all other <strong class="userinput"><code>Character Joints</code></strong> to their parent game objects (also containing the <strong class="userinput"><code>Character Joint</code></strong> components). For instance, if the character has a leg with three segments, <strong class="userinput"><code>Leg1</code></strong>, <strong class="userinput"><code>Leg2</code></strong>, and <strong class="userinput"><code>Leg3</code></strong>, drag the <strong class="userinput"><code>Leg2</code></strong> object to <strong class="userinput"><code>Leg3</code></strong> object's <strong class="userinput"><code>Connected Body</code></strong> field in the <strong class="userinput"><code>Character Joint</code></strong> component. Then drag <strong class="userinput"><code>Leg1</code></strong> to the <strong class="userinput"><code>Connected Body</code></strong> field of <strong class="userinput"><code>Leg2</code></strong>. Finally, drag <strong class="userinput"><code>Leg1</code></strong> to its root bone's <strong class="userinput"><code>Connected Body</code></strong> field (in our case it's the <strong class="userinput"><code>Abdomen</code></strong>).</li><li>Repeat this process for all the bones with <strong class="userinput"><code>Character Joints</code></strong>. The hierarchy of the joints should reflect the hierarchy of the rig.</li><li>Disable the character's <strong class="userinput"><code>Animator</code></strong> component and play the game to see the effect. You may need to further adjust <strong class="userinput"><code>Character Joint</code></strong> components' properties to achieve the desired effect:</li></ol></div><div class="mediaobject"><img src="/graphics/9781785883910/graphics/bbe3ae9e-67b4-4f5a-a7d6-2d1bd14836eb.png" /></div><p>Spider with a defined ragdoll</p><p></p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl2sec291"></a>How it works...</h3></div></div></div><p>In this recipe, we use the <strong class="userinput"><code>Character Joint</code></strong> components to create a ragdoll from scratch. Every such component works with a <strong class="userinput"><code>Rigidbody</code></strong> component and a <strong class="userinput"><code>Collider</code></strong> component that have to be attached to the same game object. We can create chains of <strong class="userinput"><code>Character Joint</code></strong> components by dragging a connected game object to the <strong class="userinput"><code>Connected Body</code></strong> field of the joint.</p><p><strong class="userinput"><code>Character Joint</code></strong><span>components</span><a id="id325536007" class="indexterm"></a> have a set of <span>parameters</span><a id="id325540288" class="indexterm"></a> we can tweak:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><strong class="userinput"><code>Connected Body</code></strong>: This is the <span>parent</span><a id="id325540339" class="indexterm"></a> object to which the joint is connected.</li><li style="list-style-type: disc"><strong class="userinput"><code>Anchor</code></strong>: This is the point in space the joint rotates around.</li><li style="list-style-type: disc"><strong class="userinput"><code>Axis</code></strong>: This is the twist axis—the one our bone will twist around. It is visualized with an orange arrow.</li><li style="list-style-type: disc"><strong class="userinput"><code>Auto Configure Connected Anchor</code></strong>: Enable this if you want Unity to try to autoconfigure the Connected Anchor.</li><li style="list-style-type: disc"><strong class="userinput"><code>Connected Anchor</code></strong>: If you disable the <strong class="userinput"><code>Auto Configure Connected Anchor</code></strong>, you can manually configure it here.</li><li style="list-style-type: disc"><strong class="userinput"><code>Swing Axis</code></strong>: This is the axis our bone will swing (or bend) around . It is visualized with a green arrow.</li><li style="list-style-type: disc"><strong class="userinput"><code>Low Twist Limit</code></strong>: This is the lower limit angle for bone twisting.</li><li style="list-style-type: disc"><strong class="userinput"><code>High Twist Limit</code></strong>: This is the higher limit angle for bone twisting.</li><li style="list-style-type: disc"><strong class="userinput"><code>Swing 1 Limit</code></strong>: This is the lower limit angle for bone swinging.</li><li style="list-style-type: disc"><strong class="userinput"><code>Swing 2 Limit</code></strong>: This is the upper limit angle for bone swinging.</li><li style="list-style-type: disc"><strong class="userinput"><code>Break Force</code></strong>: This is the force needed to break the joint.</li><li style="list-style-type: disc"><strong class="userinput"><code>Break Torque</code></strong>: This is the torque needed to break the joint.</li><li style="list-style-type: disc"><strong class="userinput"><code>Enable Collision</code></strong>: If this is checked, collisions between rigid bodies connected to this joint are enabled.</li><li style="list-style-type: disc"><strong class="userinput"><code>Enable Preprocessing</code></strong>: This is used to stabilize impossible-to-fulfill scenarios.</li></ul></div></div></div>