<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch08lvl1sec86"></a>Synchronizing subtitles</h2></div></div><hr /></div><p>In this recipe, we create <span>subtitles</span><a id="id325241223" class="indexterm"></a> and synchronize them with the animation:</p><div class="mediaobject"><img src="/graphics/9781785883910/graphics/24484d2c-c9bf-4885-b1c2-15fe656c4900.png" /></div><p>Subtitles synchronized with animation</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch08lvl2sec270"></a>Getting ready</h3></div></div></div><p>In this recipe, we will use the same cutscene as in the previous one. You can also open the example Unity project and go to the <code class="literal">Chapter 08 Animating Cutscenes\Recipe 05 Synchronizing subtitles</code> directory. If you open the <code class="literal">Example.unity</code> scene there and play the game, you will see changing subtitles synchronized with the animation.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch08lvl2sec271"></a>How to do it...</h3></div></div></div><p>To synchronize <span>subtitles</span><a id="id325509816" class="indexterm"></a> with a cutscene, follow these steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Import the cutscene the same way as in the previous recipe.</li><li>Create a new <strong class="userinput"><code>Image</code></strong> (go to <strong class="userinput"><code>Game Object</code></strong> | <strong class="userinput"><code>UI</code></strong> | <strong class="userinput"><code>Image</code></strong>).</li><li>Name it <strong class="userinput"><code>SubtitlesContainer</code></strong>.</li><li>Create a new Text game object and parent it to the <strong class="userinput"><code>SubtitlesContainer</code></strong>. To do so, right-click on the <strong class="userinput"><code>SubtitlesContainer</code></strong> and choose <strong class="userinput"><code>UI</code></strong> |<strong class="userinput"><code>Text</code></strong>.</li><li>Change the color of the <strong class="userinput"><code>SubtitlesContainer</code></strong>'s<strong class="userinput"><code> </code></strong><strong class="userinput"><code>Image</code></strong> component to semitransparent black. Change the color of the <strong class="userinput"><code>Text</code></strong> component to white. Adjust the position and size of the objects as desired.</li><li>Place the model in the <strong class="userinput"><code>Scene</code></strong>.</li><li>Create a new script and call it <code class="literal">Subtitles.cs</code>. This script has a <code class="literal">string subtitlesText</code> variable in which we will store the text displayed in the subtitles. It also has public references to the <strong class="userinput"><code>SubtitlesContainer</code></strong> and <strong class="userinput"><code>Text</code></strong> game objects: <code class="literal">public GameObject subtitlesContainer</code> and <code class="literal">public Text textComponent</code>. This script has one <code class="literal">public void SetSubtitles(string text)</code> function. It is called from an Animation Event and is used to set the <code class="literal">subtitlesText</code> variable's value:</li></ol></div><pre class="programlisting">        public void SetSubtitles(string text) 
        { 
            subtitlesText = text; 
        } </pre><div class="orderedlist"><ol class="orderedlist arabic" start="8" type="1"><li>In the <code class="literal">Update()</code> function of this script, we check if the <code class="literal">subtitlesText</code> variable contains any text. If so, we enable the <strong class="userinput"><code>SubtitlesContainer</code></strong> game object and set the <strong class="userinput"><code>Text</code></strong> game object to display our subtitles. If <code class="literal">subtitlesText</code> is an empty string, we disable the <strong class="userinput"><code>SubtitlesContainer</code></strong>:</li></ol></div><pre class="programlisting">        if (string.IsNullOrEmpty(subtitlesText) 
        &amp;&amp; subtitlesContainer.activeSelf) 
        { 
            subtitlesContainer.SetActive(false); 
        } 
        else if (!string.IsNullOrEmpty(subtitlesText) 
        &amp;&amp; !subtitlesContainer.activeSelf) 
        { 
            subtitlesContainer.SetActive(true); 
        } 
        else 
        { 
            textComponent.text = subtitlesText; 
        } </pre><div class="orderedlist"><ol class="orderedlist arabic" start="9" type="1"><li>Attach the script to the cutscene game object (the one that has the Animator component and animates all the props).</li><li>Open the <strong class="userinput"><code>Animation Import Settings</code></strong> for the cutscene animation.</li><li>You can scrub through the timeline and add Animation Events.</li><li>Add an Animation Event and name the function as <strong class="userinput"><code>SetSubtitles</code></strong>. Enter the text you want to display as subtitles in the <code class="literal">String</code> parameter, as shown in the following screenshot:</li></ol></div><div class="mediaobject"><img src="/graphics/9781785883910/graphics/0e0c0719-5755-4d8a-bb09-c9a52b14548b.png" /></div><p>SetSubtitles Animation Event with the "Goooal!" text</p><div class="orderedlist"><ol class="orderedlist arabic" start="13" type="1"><li>If you want the subtitles to disappear, add a <strong class="userinput"><code>SetSubitles</code></strong> Animation Event and leave the <code class="literal">String</code> parameter empty.</li><li>Apply the <strong class="userinput"><code>Animation Import Settings</code></strong>.</li><li>Play the game to see the effect.</li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch08lvl2sec272"></a>How it works...</h3></div></div></div><p>In this recipe, we use <strong class="userinput"><code>Animation Events</code></strong> to synchronize subtitles with the cutscene. The principle is the same as in the <span class="emphasis"><em>Using Animation Events to trigger sound and visual effects</em></span> recipe in <span><a class="link" href="#" linkend="ch07">Chapter 7</a></span>, <span class="emphasis"><em>Special Effects</em></span>. The <code class="literal">Subtitles.cs</code> script also handles showing and hiding the subtitles, depending on the value of the <code class="literal">subtitlesText</code> variable set by the <code class="literal">public void</code><code class="literal">SetSubitltes(string text)</code> function that we call with the Animation Events.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip17"></a>Note</h3><p>If you want to localize your subtitles, use string localization keys instead of text. The <code class="literal">Subtitles.cs</code> script will then have to search for the text in your localization base using those keys.</p></div></div></div>