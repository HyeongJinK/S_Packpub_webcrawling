<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch07lvl1sec75"></a>Using Blend Shapes to morph an object into another one</h2></div></div><hr /></div><p>Previously, we used <span>Blend Shapes</span><a id="id325241415" class="indexterm"></a> to create face expressions. Blend Shapes are also an excellent tool for special effects. In this recipe, we will morph one object into another.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec235"></a>Getting ready</h3></div></div></div><p>To follow this recipe, we need to prepare an <span>object</span><a id="id325509768" class="indexterm"></a> with Blend Shapes. We've created a really simple example in Blender—a subdivided cube with one shape key that looks like a sphere. See the following screenshot for reference:</p><div class="mediaobject"><img src="/graphics/9781785883910/graphics/85271f1c-58fb-4020-b647-f2b0651a02da.png" /></div><p>A cube with a Blend Shape that turns it into a sphere</p><p>You can also go to the <code class="literal">Chapter 07 Special effects\Recipe 05 Using blendshapes to morph an object into another one</code> directory. Open the <code class="literal">Example.unity</code> scene there. You will see a number of cubes there. If you hit the space bar in play mode, the cubes will morph into spheres. You can find the <code class="literal">Cuboid.fbx</code> asset with the required <strong class="userinput"><code>Blend Shapes</code></strong> in the <code class="literal">Model</code> directory.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec236"></a>How to do it...</h3></div></div></div><p>To use <strong class="userinput"><code>Blend Shapes</code></strong> to morph objects, follow these steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Import the model with at least one <strong class="userinput"><code>Blend Shape</code></strong> to Unity. You may need to go to the <strong class="userinput"><code>Import Settings</code></strong>, <strong class="userinput"><code>Model</code></strong> tab, and choose <strong class="userinput"><code>Import BlendShapes</code></strong>.</li><li>Place the model in the <strong class="userinput"><code>Scene</code></strong>.</li><li>Create a new script and call it <code class="literal">ChangeShape.cs</code>. This script is similar to the one from the previous recipe. In the <code class="literal">Update()</code> function, we change the weight of the first Blend Shape when player presses the space bar. Again, we use a helper variable <code class="literal">weightTarget</code> to set the new <code class="literal">weight</code> to 0 or 100, depending on its current value. Blend Shapes have weights from 0 to 100 instead of 1. Finally, we interpolate the <code class="literal">weight</code> value in time to make the transition smoother. We use the <code class="literal">SetBlendShapeWeight()</code> function on the <code class="literal">skinnedRenderer</code> object. This variable is set in the <code class="literal">Start()</code> function with the <code class="literal">GetComponent&lt;SkinnedMeshRenderer&gt;()</code> function:</li></ol></div><pre class="programlisting">        if (Input.GetKeyDown(KeyCode.Space)) 
        { 
            if (weightTarget &lt; 50f) 
            { 
                weightTarget = 100f; 
            } 
            else if (weightTarget &gt; 50f) 
            { 
                weightTarget = 0f; 
            } 
        } 
        weight = Mathf.Lerp(weight, weightTarget, Time.deltaTime * 
        blendShapeLerpSpeed); 
        skinnedRenderer.SetBlendShapeWeight(0, weight); </pre><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>Attach the script to the model on the scene.</li><li>Play the game and press the space bar to see the model morph.</li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec237"></a>How it works...</h3></div></div></div><p>stores vertices position of a mesh. We have to create them in a 3D package. Unity imports Blend Shapes and we can modify their weights in runtime using the <code class="literal">SetBlendShapeWeight()</code> function on the <strong class="userinput"><code>Skinned Mesh Renderer</code></strong> component. We can also use <span>animations</span><a id="id325526660" class="indexterm"></a> as shown in the, <span class="emphasis"><em>Animating facial expressions with Blend Shapes</em></span> recipe in <span><a class="link" href="#" linkend="ch05">Chapter 5</a></span>, <span class="emphasis"><em>Characters Actions and Expressions</em></span>.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip15"></a>Note</h3><p><span>Blend Shapes</span><a id="id325526756" class="indexterm"></a> have trouble with storing <strong class="userinput"><code>Normals</code></strong>. If we import <strong class="userinput"><code>Normals</code></strong> from our model, it may look weird after morphing. Sometimes, setting the <strong class="userinput"><code>Normals</code></strong> option to <strong class="userinput"><code>Calculate</code></strong> in the <strong class="userinput"><code>Import Settings</code></strong> can helps with the problem. If we choose this option, Unity will calculate <strong class="userinput"><code>Normals</code></strong> based on the angle between faces of our model. This allowed us to morph a hard surface cube into a smooth sphere in this example.</p></div><p> </p></div></div>