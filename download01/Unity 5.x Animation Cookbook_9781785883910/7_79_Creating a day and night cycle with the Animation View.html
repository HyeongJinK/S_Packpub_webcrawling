<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch07lvl1sec80"></a>Creating a day and night cycle with the Animation View</h2></div></div><hr /></div><p>In this recipe, we will create a simple <span>day and night</span><a id="id325241223" class="indexterm"></a> cycle animation using the <span>Animation View</span><a id="id325241232" class="indexterm"></a>.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec251"></a>Getting ready</h3></div></div></div><p>We are going to create this recipe from scratch in Unity, so we don't need any additional assets. You can also use the provided example Unity project and go to the <code class="literal">Chapter 07 Special effects\Recipe 10 Creating a day and night cycle with the animation window</code> directory. You will find an <code class="literal">Example.unity</code> scene there.</p><p> </p><p>Open it and play the game to see the effect.</p><div class="mediaobject"><img src="/graphics/9781785883910/graphics/bb69d931-8868-495e-bd8c-8e7a174949a4.png" /></div><p>Simple day and night cycle</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec252"></a>How to do it...</h3></div></div></div><p>To create a <span>day and night</span><a id="id325241422" class="indexterm"></a> cycle with the <span>Animation View</span><a id="id325241431" class="indexterm"></a>, follow these steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Create an empty game object and call it <code class="literal">DayAndNight</code>.</li><li>Create another empty game object, call it <code class="literal">SunAndMoonPivot</code>, and parent it to the <strong class="userinput"><code>DayAndNight</code></strong> game object.</li><li>Create two more game objects, <strong class="userinput"><code>SunPivot</code></strong> and <strong class="userinput"><code>MoonPivot</code></strong>, and parent them to <strong class="userinput"><code>SunAndMoonPivot</code></strong>.</li><li>Then create the <strong class="userinput"><code>Sun</code></strong> and <strong class="userinput"><code>Moon</code></strong> objects and parent the first one to <strong class="userinput"><code>SunPivot</code></strong> and the second one to <strong class="userinput"><code>MoonPivot</code></strong>.</li><li>Lastly, create two <strong class="userinput"><code>Directional Lights</code></strong> and two <strong class="userinput"><code>Spheres</code></strong> and parent one of each to the <strong class="userinput"><code>Sun</code></strong> object and the remaining two to the <strong class="userinput"><code>Moon</code></strong> object.</li><li>The hierarchy should look like the following:
<div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><strong class="userinput"><code>DayAndNight</code></strong> | <strong class="userinput"><code>SunAndMoonPivot</code></strong></li><li><strong class="userinput"><code>SunAndMoonPivot</code></strong> | <strong class="userinput"><code>SunPivot</code></strong></li><li><strong class="userinput"><code>SunAndMoonPivot</code></strong> | <strong class="userinput"><code>MoonPivot</code></strong></li><li><strong class="userinput"><code>SunPivot</code></strong> | <strong class="userinput"><code>Sun</code></strong></li><li><strong class="userinput"><code>MoonPivot</code></strong> | <strong class="userinput"><code>Moon</code></strong></li><li><strong class="userinput"><code>Sun</code></strong> | <strong class="userinput"><code>Directional Light</code></strong></li><li><strong class="userinput"><code>Sun</code></strong> | <strong class="userinput"><code>SunSphere</code></strong></li><li><strong class="userinput"><code>Moon</code></strong> | <strong class="userinput"><code>Directional Light</code></strong></li><li><strong class="userinput"><code>Moon</code></strong> | <strong class="userinput"><code>MoonSphere</code></strong></li></ol></div></li><li>Create two materials: <strong class="userinput"><code>Moon</code></strong> and <strong class="userinput"><code>Sun</code></strong>. Choose the <strong class="userinput"><code>Unlit</code></strong> | <strong class="userinput"><code>Color</code></strong> shader for them and adjust the colors to your liking (you can also use the Standard Shader with an Emission color).</li><li>Apply the materials to the <strong class="userinput"><code>SunSphere</code></strong> and <strong class="userinput"><code>MoonSphere</code></strong> objects.</li><li>Move the <strong class="userinput"><code>Sun</code></strong> and the <strong class="userinput"><code>Moon</code></strong> away from the center. You can also use the <strong class="userinput"><code>SunPivot</code></strong> and <strong class="userinput"><code>MoonPivot</code></strong> to rotate the <strong class="userinput"><code>Sun</code></strong> and the <strong class="userinput"><code>Moon</code></strong>. See the following screenshot for reference:</li></ol></div><div class="mediaobject"><img src="/graphics/9781785883910/graphics/4e7a3015-2af6-4f42-bd68-34284950f4e1.png" /></div><p>Sun and Moon placement</p><div class="orderedlist"><ol class="orderedlist arabic" start="10" type="1"><li>Select the <strong class="userinput"><code>DayAndNight</code></strong> game object and add an <strong class="userinput"><code>Animator</code></strong> component to it.</li><li>Create a new script and call it <code class="literal">CameraColor.cs</code>. This script has one <code class="literal">public Color cameraColor</code> variable. In the <code class="literal">Update()</code> function of this script, we set the <code class="literal">backgroundColor</code> of the main camera to the <code class="literal">cameraColor</code> variable's value:</li></ol></div><pre class="programlisting">        void Update () { 
            Camera.main.backgroundColor = cameraColor; 
        } </pre><div class="orderedlist"><ol class="orderedlist arabic" start="12" type="1"><li>Assign the script to the <strong class="userinput"><code>DayAndNight</code></strong> game object.</li><li>With the <strong class="userinput"><code>DayAndNight</code></strong> game object selected, open the <strong class="userinput"><code>Animation</code></strong> View.</li><li>Create an animation of the <strong class="userinput"><code>Sun</code></strong> and <strong class="userinput"><code>Moon</code></strong> moving on the horizon. Rotate the <strong class="userinput"><code>SunAndMoonPivot</code></strong> to make the job easier.</li><li>Animate the <strong class="userinput"><code>Directional Light</code></strong> colors and their <strong class="userinput"><code>Intensity</code></strong> and <strong class="userinput"><code>Shadow Strength</code></strong>. In the day, only the <strong class="userinput"><code>Sun's </code></strong><strong class="userinput"><code>Directional Light</code></strong> should cast shadows, and in the night, only the <strong class="userinput"><code>Moon's Directional Light</code></strong> should cast shadows.</li><li>If you are using the camera's background color as the background color of the scene, animate it using the <code class="literal">public Color cameraColor</code> of the script attached to <strong class="userinput"><code>SunAndMoonPivot</code></strong> game object. If you're using Unity's parametric skybox, make sure to choose your <strong class="userinput"><code>Sun's Directional Light</code></strong> as the <strong class="userinput"><code>Sun</code></strong> in the <strong class="userinput"><code>Lighting</code></strong> settings. This will make the skybox change with the respect of <strong class="userinput"><code>Sun's Directional Light</code></strong> rotation.</li><li>Run the game to see the effect.</li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec253"></a>How it works...</h3></div></div></div><p>In this recipe, we use the <strong class="userinput"><code>Hierarchy</code></strong> to animate rotation of <strong class="userinput"><code>Sun</code></strong> and <strong class="userinput"><code>Moon</code></strong>. We also animate the <strong class="userinput"><code>Intensity</code></strong>, <strong class="userinput"><code>Color</code></strong>, and <strong class="userinput"><code>Shadow Strength</code></strong> of <strong class="userinput"><code>Directional Lights</code></strong> attached to those game objects. This way, we can create an illusion of a day and night cycle.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec254"></a>There's more...</h3></div></div></div><p>To control the <span>speed</span><a id="id325241526" class="indexterm"></a> of the <span>day and night</span><a id="id325241534" class="indexterm"></a> cycle animation, you can modify the <code class="literal">anim.speed</code> parameter in runtime from scripts. The <code class="literal">anim</code> variable is a reference to the <strong class="userinput"><code>Animator</code></strong> component attached to the <strong class="userinput"><code>DayAndNight</code></strong> game object.</p></div></div>