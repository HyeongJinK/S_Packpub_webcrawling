<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch07lvl1sec73"></a>Using the Animation View to animate public script variables</h2></div></div><hr /></div><p>In Unity, we can animate <span>public script variables</span><a id="id325241415" class="indexterm"></a>. Most standard types are supported. We can use this to achieve interesting effects that are not possible to achieve directly. For instance, we can animate fog color and density, which is not directly accessible through the <span>Animation View</span><a id="id325509834" class="indexterm"></a>.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec229"></a>Getting ready</h3></div></div></div><p>In this recipe, everything will be created from scratch, so you don't need to prepare any special assets. You can also use the example project and go to the <code class="literal">Chapter 07 Special effects\Recipe 03 Using the animation window to animate public script variables</code> directory. You can find the <code class="literal">Example.unity</code> scene there. If you open it and press the space bar, you can observe the fog changing color and density.</p><p> </p><p>It is achieved by <span>animating</span><a id="id325509861" class="indexterm"></a> the <span>public variables</span><a id="id325509869" class="indexterm"></a> of a script.</p><div class="mediaobject"><img src="/graphics/9781785883910/graphics/dd46881d-07d0-4fa6-9722-5ca09bb4fa65.png" /></div><p>Animated fog</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec230"></a>How to do it...</h3></div></div></div><p>To animate public script variables, follow these steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Create a new script and call it <code class="literal">FogAnimator.cs</code>.</li><li>Create two public variables in this script: <code class="literal">public float fogDensity</code> and <code class="literal">public Color fogColor</code>.</li><li>In this script's <code class="literal">Update()</code> function, we call the <strong class="userinput"><code>ChangeFog </code></strong><code class="literal">Trigger</code> in the controller when player presses the space bar. We also set the <code class="literal">RenderSettings.fogColor</code> and <code class="literal">RenderSettings.fogDensity</code> parameters using our public variables. We also adjust the <strong class="userinput"><code>Main Camera</code></strong>'s background color to match the fog color:</li></ol></div><pre class="programlisting">        if (Input.GetKeyDown(KeyCode.Space)) 
        { 
            anim.SetTrigger("ChangeFog"); 
        } 
        RenderSettings.fogColor = fogColor; 
        RenderSettings.fogDensity = fogDensity; 
 
        Camera.main.backgroundColor = fogColor; </pre><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>Create a new game object and name it <code class="literal">FogAnimator</code>.</li><li>Attach the <code class="literal">FogAnimator.cs</code> script to it.</li><li>Select the <strong class="userinput"><code>FogAnimator</code></strong> game object and add an Animator component to it.</li><li>Open the <strong class="userinput"><code>Animation</code></strong> View.</li><li>Create a new Animation Clip.</li><li>Make sure the record button is pressed.</li><li>Create an animation for <code class="literal">public float fogDensity</code> and <code class="literal">public Color fogColor</code> parameters by changing their values.</li><li>You can create any number of animations and connect them in the automatically created Animator Controller with transitions based on the <strong class="userinput"><code>ChangeFog </code></strong><code class="literal">Trigger</code> (you need to add this parameter to the controller first).</li><li>The following is an example controller:</li></ol></div><div class="mediaobject"><img src="/graphics/9781785883910/graphics/543de254-1f7d-4b01-acb4-f57e01047d8f.png" /></div><p>Example controller for different fog animations</p><div class="orderedlist"><ol class="orderedlist arabic" start="13" type="1"><li>Remember that you don't need to create animations of the fog changing its color or density. You can rely on blending between animations in the controller. All you need to have is one key for the density and one for the color in each animation. In this example, all <strong class="userinput"><code>Transition Durations</code></strong> are set to 1 second and every transition's <strong class="userinput"><code>Has Exit Time</code></strong> parameter is set to false.</li><li>Make sure fog is enabled in the <strong class="userinput"><code>Lighting</code></strong> settings.</li><li>Play the game and press the space bar to see the effect.</li></ol></div><p> </p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec231"></a>How it works...</h3></div></div></div><p>Normally, we can't animate the fog's color or density using the <strong class="userinput"><code>Animation</code></strong> View. But we can do it easily with a script that sets the <code class="literal">RenderSettings.fogColor</code> and <code class="literal">RenderSettings.fogDensity</code> parameters every frame. We use animations to change the script's <span>public variable</span><a id="id325540289" class="indexterm"></a>s values in time. This way we've created a <span>workaround</span><a id="id325540332" class="indexterm"></a> for animating fog in Unity.</p><p>We've just scratched the surface of what's possible with animating public script variables. Try experimenting to achieve awesome effects.</p></div></div>