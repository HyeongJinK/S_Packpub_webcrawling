<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch02lvl1sec25"></a>Using the Hierarchy to animate local rotation - creating an orbiting planet</h2></div></div><hr /></div><p>In this recipe, we will explore local transform animations further. We will use the <strong class="userinput"><code><span>Hierarchy</span><a id="id325289203" class="indexterm"></a></code></strong> and create smart parent-child relationships between our game objects to make an interesting effect of <span>orbiting planets</span><a id="id325289211" class="indexterm"></a>. Learning how to animate an object's local position and rotation and use the <strong class="userinput"><code>Hierarchy</code></strong> to our advantage is key to getting the most of Unity's animation system.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec64"></a>Getting ready</h3></div></div></div><p>Before we start, you need to prepare at least two objects to animate. We are using planets in this example. You can also use the example Unity project provided and go to the <code class="literal">Chapter 02 Working with the animation view\Recipe 05 Using the hierarchy to animate local rotation - creating an orbiting planet</code> directory. You will find an <code class="literal">Example.unity</code> scene there. There is a <strong class="userinput"><code>Planets</code></strong> game object with an Animator component and an Animator Controller assigned. If you select the <strong class="userinput"><code>Planets</code></strong> game object and go to <strong class="userinput"><code>Window | Animation</code></strong>, you can edit the animation of orbiting planets.
</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec65"></a>How to do it...</h3></div></div></div><p>To use Hierarchy to animate an object's local rotation, follow these steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Put your planet models into the scene.</li><li>One of our planets will be the parent of our little "planetary system." Call it <strong class="userinput"><code>Planet1</code></strong> (as we will refer to it in this recipe a lot).</li><li>Add an empty child game object to <strong class="userinput"><code>Planet1</code></strong> and name it <strong class="userinput"><code>Planet2Orbit</code></strong>. The <strong class="userinput"><code>Planet2Orbit</code></strong> game object should be placed in the center of the <strong class="userinput"><code>Planet1</code></strong> game object.</li><li>Parent your second planet game object (let's call it <strong class="userinput"><code>Planet2</code></strong>) to the <strong class="userinput"><code>Planet2Orbit</code></strong> game object.</li><li>Set the position of the <strong class="userinput"><code>Planet2</code></strong> game object to 0x, 0y, 0z to place it exactly in the same position as the <strong class="userinput"><code>Planet2Orbit</code></strong> (and <strong class="userinput"><code>Planet1</code></strong>) game object.</li><li>Move your <strong class="userinput"><code>Planet2</code></strong> object to the desired distance from <strong class="userinput"><code>Planet1</code></strong>. Use only one axis (X, Y, or Z). See the following screenshot :</li></ol></div><div class="mediaobject"><img src="/graphics/9781785883910/graphics/310311c4-beee-4b09-8de1-b5e3ebcd31a4.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="7" type="1"><li>Add an Animator component to the root game object of our planetary system (<strong class="userinput"><code>Planet1</code></strong>).</li><li>Open the <strong class="userinput"><code>Animation</code></strong> View with the <strong class="userinput"><code>Planet1</code></strong> game object selected (go to <strong class="userinput"><code>Window | Animation</code></strong>).</li><li>Create a new Animation Clip by clicking on the <strong class="userinput"><code>Create</code></strong> button.</li><li>Make sure the record button is pressed (upper-left corner of the <strong class="userinput"><code>Animation</code></strong> View).</li><li>Select the <strong class="userinput"><code>Planet2Orbit</code></strong> game object from the <strong class="userinput"><code>Hierarchy</code></strong>.</li></ol></div><div class="orderedlist"><ol class="orderedlist arabic" start="12" type="1"><li>Rotate the <strong class="userinput"><code>Planet2Orbit</code></strong> a bit in one axis (choose <span class="emphasis"><em>Y</em></span> for instance) to create a new key frame. After you rotate it, the <strong class="userinput"><code>Rotation</code></strong> property of that object will be added automatically to the <strong class="userinput"><code>Animation</code></strong> View. Find the <strong class="userinput"><code>Rotation</code></strong> section, in the <strong class="userinput"><code>Transform</code></strong> component in the <strong class="userinput"><code>Inspector</code></strong> of the <strong class="userinput"><code>Planet2Orbit</code></strong> game object, and enter 0 in the axis you chose (<span class="emphasis"><em>Y</em></span> in this example).</li><li>Move the timeline in the <strong class="userinput"><code>Animation</code></strong> View a few seconds forward to create the second key frame.</li><li>Make sure the <strong class="userinput"><code>Planet2Orbit</code></strong> game object is still selected and the record button is pressed.</li><li>Type <code class="literal">360</code> in the rotation section in the <code class="literal">Transform</code> component of the <strong class="userinput"><code>Planet2Orbit</code></strong> game object. Remember to type it in the same axis you chose before (<span class="emphasis"><em>Y</em></span> in this example). This will create the second key frame and the animation will be perfectly looped.</li><li>Play the game to see the effect of an orbiting planet.</li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec66"></a>How it works...</h3></div></div></div><p>The key element of this recipe is the <strong class="userinput"><code><span>Hierarchy</span><a id="id325550896" class="indexterm"></a></code></strong> of our game objects. All animations created with Unity's <strong class="userinput"><code>Animation</code></strong> View are made in local space, which means that if you animate a parent object's position or rotation, its child objects will also move or rotate, respectively.</p><p>Our Hierarchy looks like this: <strong class="userinput"><code>Planet1 | Planet2Orbit | Planet2</code></strong>:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><strong class="userinput"><code>Planet1:</code></strong> This is our root game object. We can move it in space and our animation will still work perfectly.</li><li style="list-style-type: disc"><strong class="userinput"><code>Planet2Orbit: </code></strong>This game object is the child of the <strong class="userinput"><code>Planet1</code></strong> game object. It is placed in the center of <strong class="userinput"><code>Planet1</code></strong>. Only this object is animated in the whole <strong class="userinput"><code>Hierarchy</code></strong>. We use this empty game object because we may want to rotate the root planet (<strong class="userinput"><code>Planet1</code></strong>) and we need another object in the <strong class="userinput"><code><span>Hierarchy</span><a id="id325289147" class="indexterm"></a></code></strong> to desynchronize the rotation of <strong class="userinput"><code>Planet1</code></strong> with the orbiting movement of <strong class="userinput"><code>Planet2</code></strong>.</li><li style="list-style-type: disc"><strong class="userinput"><code>Planet2</code></strong>-This game object is the child of <strong class="userinput"><code>Planet2Orbit.</code></strong> It is translated in the local space of <strong class="userinput"><code>Planet2Orbit</code></strong> in one axis only. The rotation of the <strong class="userinput"><code>Planet2Orbit</code></strong> game object makes <strong class="userinput"><code>Planet2</code></strong> move in circles, which creates the orbiting planet effect.</li></ul></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec67"></a>There's more...</h3></div></div></div><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">You can add more planets to our planetary system. In the provided example, there is also a <strong class="userinput"><code>Moon</code></strong> game object orbiting <strong class="userinput"><code>Planet2</code></strong>.</li><li style="list-style-type: disc">You can also have nested game objects with their own Animator components attached. That will make it possible to have multiple Animator Controllers driving animations of different parts of the <strong class="userinput"><code>Hierarchy</code></strong>.</li></ul></div></div></div>