<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch10lvl1sec98"></a>Using math to animate an object</h2></div></div><hr /></div><p>We can use <span>mathematical</span><a id="id325522924" class="indexterm"></a> formulas to create interesting-looking animations. We are going to use this concept to make an endless curve animation with the <code class="literal">Mathf.Sin()</code> and <code class="literal">Mathf.Cos()</code> functions.</p><p> </p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch10lvl2sec304"></a>Getting ready</h3></div></div></div><p>We don't need anything special for this recipe. We are going to create it from scratch in Unity. You may also download the provided example project. Open the <code class="literal">Chapter 10 Miscellaneous\Recipe 01 Using math to animate an object</code> directory and load the <code class="literal">Example.unity</code> scene there. If you run the game, you will see the finished effect—a curve <span>animated</span><a id="id325526643" class="indexterm"></a> with the <code class="literal">Mathf.Sin()</code> and <code class="literal">Mathf.Cos()</code> functions:</p><div class="mediaobject"><img src="/graphics/9781785883910/graphics/1cf57212-8df0-44c8-8699-a801f8900965.png" /></div><p>Final effect—curve animated with the Mathf.Sin() and Mathf.Cos() functions</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch10lvl2sec305"></a>How to do it...</h3></div></div></div><p>To use math for animating a curve, follow these steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Create an empty game object.</li><li>Add a <strong class="userinput"><code>Line Renderer</code></strong> component to it.</li><li>Create a new material of your liking and assign it to the <strong class="userinput"><code>Line Renderer</code></strong>.</li><li>Make sure the <strong class="userinput"><code>Use </code></strong><strong class="userinput"><code>World Space</code></strong> option in the <strong class="userinput"><code>Line renderer</code></strong> component is not selected (we will use local coordinates in this example as it makes it slightly easier to position the <strong class="userinput"><code>Line Renderer</code></strong> in the camera).</li><li>Change the <strong class="userinput"><code>Start Width</code></strong> and <strong class="userinput"><code>End Width</code></strong> of the <strong class="userinput"><code>Line Renderer</code></strong> to 0.2 to make the line thinner.</li><li>Create a new C# script and name it <code class="literal">MathAnim.cs</code>. In this script's <code class="literal">Start()</code> function, we set the number of points of the <code class="literal">Line Renderer</code> using the <code class="literal">SetVertices()</code> method:</li></ol></div><pre class="programlisting">      positions = new Vector3[linePoints]; 
      lRenderer = GetComponent&lt;LineRenderer&gt;(); 
      if (lRenderer != null) 
      { 
          lRenderer.SetVertexCount(linePoints); 
      } </pre><div class="orderedlist"><ol class="orderedlist arabic" start="7" type="1"><li>Then, in the <code class="literal">Update()</code> function, we call the <code class="literal">void SetLinePositions()</code> function and we move the game object so that the line center is at the (0, 0, 0) point:</li></ol></div><pre class="programlisting">      transform.position = new Vector3(-0.5f 
                          * lineLenght, 0f, 0f); 
      SetLinePositions(); </pre><div class="orderedlist"><ol class="orderedlist arabic" start="8" type="1"><li>In the <code class="literal">void SetLinePositions()</code> function, use the <code class="literal">Mathf.Sin()</code> and <code class="literal">Mathf.Cos()</code> functions to calculate the point's Y and Z positions. We set the line points positions with the <code class="literal">SetPositions()</code> function. We also use a simple timer to introduce time into our formula. We have two timers: <code class="literal">timerY</code> and <code class="literal">timerZ</code>. The first one works for the Y position values and the second one for Z position values. We also have the <code class="literal">public float</code> variables for controlling <code class="literal">frequencyY</code>, <code class="literal">frequencyZ</code>, <code class="literal">amplitudeY</code>, and <code class="literal">amplitudeZ</code>. The X positions of the line points are set in equal distances so that the total length of the line is equal the <code class="literal">public float lineLength</code> variable's value:</li></ol></div><pre class="programlisting">      if (lRenderer == null) 
      { 
          return; 
      } 
 
      timerY += Time.deltaTime * speedY; 
      timerZ += Time.deltaTime * speedZ; 
 
      for (int i = 0; i &lt; positions.Length; i++) 
      { 
          positions[i].x = lineLenght * (float)i / 
                      (float)positions.Length; 
     
          positions[i].y = amplitudeY * Mathf.Sin(frequencyY 
                  * ((2f*Mathf.PI * (float)i / 
                  (float)positions.Length) + timerY)); 
     
          positions[i].z = amplitudeZ * Mathf.Cos(frequencyZ 
                  * ((2f * Mathf.PI * (float)i / 
                  (float)positions.Length) + timerZ)); 
      } 
      lRenderer.SetPositions(positions); </pre><p> </p><div class="orderedlist"><ol class="orderedlist arabic" start="9" type="1"><li>Attach the script to our game object.</li><li>Play the game to see the effect.</li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch10lvl2sec306"></a>How it works...</h3></div></div></div><p>We have plenty of mathematical formulas that we can use from the <code class="literal">Mathf</code> library. Using <span>some</span><a id="id325549051" class="indexterm"></a> of them can give interesting results for animation. We are using the <code class="literal">Mathf.Sin()</code> and <code class="literal">Mathf.Cos()</code> functions in this example. They are periodic, which gives us an infinite loop motion.</p></div></div>