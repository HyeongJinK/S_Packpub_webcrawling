<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch01lvl1sec12"></a>Creating and assigning an Animator Controller</h2></div></div><hr /></div><p><span class="strong"><strong><span>Animator Controllers</span><a id="id325289101" class="indexterm"></a></strong></span> are state machines (graphs) responsible for controlling the flow of animations of any animated object in the game. The same Animator Controller asset can be used by multiple objects or characters. Unity will create an independent runtime copy of the asset for each animated object it is assigned to.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec20"></a>Getting ready</h3></div></div></div><p>As always, you should have a rigged and animated character ready before we start. Import it into Unity, choose the proper rig type, and put it into a scene. You can download the example Unity project and go to the <code class="literal">Chapter 01 Working with animations\Recipe 03 Creating and assigning an animator controller</code> directory. There is a scene called <code class="literal">Example.unity</code> there. If you open it, you'll find a Sheep character in the <strong class="userinput"><code>Hierarchy</code></strong>. It has an Animator Controller already created and assigned. You can also use the <code class="literal">Quadruped.fbx</code> file from the <code class="literal">Chapter 01 Working with animations\Recipe 03 Creating and assigning an animator controller\Rigs</code> directory to follow the recipe step by step.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec21"></a>How to do it...</h3></div></div></div><p>To create and assign an <span>Animator Controller</span><a id="id325535995" class="indexterm"></a>, follow these steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Navigate to the <strong class="userinput"><code>Project View</code></strong> (any directory in the <code class="literal">Assets</code> folder) and press  the right mouse button.</li><li>Choose <strong class="userinput"><code>Create</code></strong> | <strong class="userinput"><code><span>Animator Controlle</span><a id="id325540331" class="indexterm"></a>r</code></strong> from the menu. A controller asset will be created. You can name it as you wish.</li><li>Double-click on the created controller. An <strong class="userinput"><code>Animator</code></strong> tab will appear. It will show the current selected <strong class="userinput"><code>Animator Controller</code></strong>.</li></ol></div><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>Here you can add the first animation. Navigate to your imported character in the <strong class="userinput"><code>Project View</code></strong>. Unfold it and drag and drop one of the imported animations into the <strong class="userinput"><code>Animator</code></strong> window. A new state will be created and will be colored orange, showing that this is the default animation state—the state from which your graph starts.</li></ol></div><div class="mediaobject"><img src="/graphics/9781785883910/graphics/025efb3b-9b24-452e-99c0-fb4ca0eddbf4.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="5" type="1"><li>Navigate to your character on the scene and select it.</li><li>Find the <span>Animator component</span><a id="id325549037" class="indexterm"></a> in the <strong class="userinput"><code>Inspector</code></strong> tab. All animated objects have an <strong class="userinput"><code>Animator</code></strong> component added automatically.</li><li>Find the <strong class="userinput"><code>Controller</code></strong> slot in the <strong class="userinput"><code>Animator</code></strong> component inspector.</li><li>Drag and drop your <strong class="userinput"><code>Animator Controller</code></strong> asset into the <strong class="userinput"><code>Controller</code></strong> slot of the <strong class="userinput"><code>Animator</code></strong> component.</li><li>Run the game to see your character play the default state animation of your <span>Animator Controller.</span><a id="id325550885" class="indexterm"></a> If the animation is not looped, it will be played just once and then the character will freeze.</li><li>You can also select your character in runtime and navigate to the <strong class="userinput"><code>Animator</code></strong> tab to see what animation state the character is currently in. Current animation state will have a blue progress bar displayed.</li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec22"></a>How it works...</h3></div></div></div><p>Every animated object in Unity uses an Animator component and an A<span>nimator Controller</span><a id="id325550905" class="indexterm"></a> asset. The component is responsible for playing animations in runtime. It has a number of parameters that we have to set or we can use to tweak the component's functionality:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><strong class="userinput"><code>Controller</code></strong>: This is the field we have to attach the <span>Animator Controller</span><a id="id325550921" class="indexterm"></a> asset to. It determines which animation graph the Animator component will use.</li></ul></div><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><strong class="userinput"><code>Avatar</code></strong>: In Unity, <strong class="userinput"><code>Avatars</code></strong> are rig definitions. For instance, if we have multiple files containing <span>animation</span><a id="id325532861" class="indexterm"></a>s with the same <strong class="userinput"><code>Generic</code></strong> rig, we should use the same <strong class="userinput"><code>Avatar</code></strong> for all of them. You can find more information about it in the <span class="emphasis"><em>Using animations from multiple assets</em></span> recipe.</li><li style="list-style-type: disc"><strong class="userinput"><code>Apply Root Motion</code></strong>: With this checkbox, we can turn the root motion on and off. It can be useful when we have <span>animation</span><a id="id325532884" class="indexterm"></a>s with root motion but don't want to use the root motion definition for a given character.</li><li style="list-style-type: disc"><strong class="userinput"><code>Update Mode</code></strong>: This parameter tells Unity in which update the animations should be evaluated. The <strong class="userinput"><code>Normal</code></strong> option makes the animations <span>synchronized</span><a id="id325532900" class="indexterm"></a> with the normal <code class="literal">Update()</code> call, the <strong class="userinput"><code>Animate Physics</code></strong> option synchronizes animations with the physics <code class="literal">FixedUpdate()</code> call, and the <strong class="userinput"><code>Unscaled Time</code></strong> option synchronizes the animation with the normal <code class="literal">Update()</code> call, but disables animation time scaling (the animation is played with 100 percent speed regardless of the <code class="literal">Time.timeScale</code> variable value).</li><li style="list-style-type: disc"><strong class="userinput"><code>Culling Mode</code></strong>: This <span>parameter</span><a id="id325532933" class="indexterm"></a> tells Unity when to turn off the animation playback on a given Animator. The <strong class="userinput"><code>Always Animate</code></strong> option makes the Animator always play animations (event when off-screen), the <strong class="userinput"><code>Cull Update Transforms</code></strong> option culls Retarget and IK Transforms when the Animator is not visible on screen, and the <strong class="userinput"><code>Cull Completely</code></strong> option disables the animation completely when the Animator is not visible on screen.</li></ul></div><p>The Animator Controller asset stores a graph of animations (animation states) and defines the rules of switching between them, blending them, and so on. The controller (asset) is attached to the component's <strong class="userinput"><code>Controller</code></strong> field (the component is attached to a character prefab or a character placed in the scene). Many objects or characters can share the same Animator Controller if they use the same animations (have the same rigs or are humanoid characters).</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec23"></a>See also</h3></div></div></div><p>If you want to learn how to create <span>animation</span><a id="id325532963" class="indexterm"></a> graphs and control their flow, see the next two recipes: <span class="emphasis"><em>Creating animation transitions in Animator Controller</em></span> and <span class="emphasis"><em>Using parameters to control the animation flow</em></span>.</p></div></div>