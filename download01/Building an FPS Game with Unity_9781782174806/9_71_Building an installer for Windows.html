<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch09lvl1sec69"></a>Building an installer for Windows</h2></div></div><hr /></div><p>Like I mentioned<a id="id608" class="indexterm"></a> previously, having a separate <code class="literal">Data</code> folder with <code class="literal">.exe</code> is <a id="id609" class="indexterm"></a>somewhat of a pain. Rather than give people a <code class="literal">.zip</code> file and hope they extract it all and keep everything in the same folder, I'd let the process be automatic and give the person an opportunity to install it just like a professional game. With this in mind, I'm going to go over a free way to create a Windows installer.</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>The first thing we need to do is to get our setup program. For our demonstration, I will be <a id="id610" class="indexterm"></a>using Jordan Russell's <span class="strong"><strong>Inno Setup</strong></span> installer. Go to <a class="ulink" href="http://jrsoftware.org/isinfo.php" target="_blank">http://jrsoftware.org/isinfo.php</a> and click on the <span class="strong"><strong>Download Inno Setup</strong></span> link.</p><div class="mediaobject"><img src="/graphics/9781782174806/graphics/B04317_09_08.jpg" /></div></li><li><p>Click on the<a id="id611" class="indexterm"></a> <span class="strong"><strong>Stable Release</strong></span> button and select<a id="id612" class="indexterm"></a> the <code class="literal">isetup-5.5.6.exe</code> file. Then, double-click on the executable to open it, click on the <span class="strong"><strong>Run</strong></span> button if it shows a <span class="strong"><strong>Security Warning</strong></span> dialog, and select <span class="strong"><strong>Yes</strong></span> to allow changes.</p></li><li><p>In the <span class="strong"><strong>Select Setup Language</strong></span> window, leave the selected language to <span class="strong"><strong>English</strong></span> and click on <span class="strong"><strong>OK</strong></span>.</p><div class="mediaobject"><img src="/graphics/9781782174806/graphics/B04317_09_09.jpg" /></div></li><li><p>Run through<a id="id613" class="indexterm"></a> the installation, making sure that the <a id="id614" class="indexterm"></a>
<span class="strong"><strong>Install Inno Setup Preprocessor</strong></span> option is unchecked since we won't be using it. Upon finishing, make sure that <span class="strong"><strong>Launch Inno Setup</strong></span> is checked and then press the <span class="strong"><strong>Finish</strong></span> button.</p><p>When you open the program, it will look similar to the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781782174806/graphics/B04317_09_10.jpg" /></div></li><li><p>Choose <a id="id615" class="indexterm"></a>
<span class="strong"><strong>Create a new script file using the Script Wizard</strong></span><a id="id616" class="indexterm"></a> and select <span class="strong"><strong>OK</strong></span>.</p></li><li><p>Click on the <span class="strong"><strong>Next</strong></span> button and you'll come to the <span class="strong"><strong>Application Information</strong></span> section. Fill in your information and press <span class="strong"><strong>Next</strong></span>.</p><div class="mediaobject"><img src="/graphics/9781782174806/graphics/B04317_09_11.jpg" /></div></li><li><p>Next, you'll <a id="id617" class="indexterm"></a>see some information on the <code class="literal">Application</code> <a id="id618" class="indexterm"></a>folder. In general, you will not want to change this information, so you can go ahead and click on <span class="strong"><strong>Next</strong></span>.</p></li><li><p>You'll be brought to the <span class="strong"><strong>Application Files</strong></span> section, where you need to specify the files you want to install. Under the application main executable file, select <span class="strong"><strong>Browse</strong></span> to go to the location of your <span class="strong"><strong>Export</strong></span> folder, select the <code class="literal">.exe</code> file, and click on <span class="strong"><strong>Open</strong></span>.</p><div class="mediaobject"><img src="/graphics/9781782174806/graphics/B04317_09_12.jpg" /></div></li><li><p>Now you <a id="id619" class="indexterm"></a>need <a id="id620" class="indexterm"></a>to add the <code class="literal">Data</code> folder. Click on the <span class="strong"><strong>Add Folderâ€¦</strong></span> button, select the <code class="literal">Data</code> folder, and then press <span class="strong"><strong>OK</strong></span>.</p><div class="mediaobject"><img src="/graphics/9781782174806/graphics/B04317_09_13.jpg" /></div></li><li><p>It will ask<a id="id621" class="indexterm"></a> whether the files in the subfolders should be <a id="id622" class="indexterm"></a>included as well. Select <span class="strong"><strong>Yes</strong></span>. Then, select the folder in the <span class="strong"><strong>Other Applications file</strong></span> section and press the <span class="strong"><strong>Edit</strong></span> button. Set the <span class="strong"><strong>Destination subfolder</strong></span> property to the same name as your <code class="literal">Data</code> folder, press <span class="strong"><strong>OK</strong></span>, and then press <span class="strong"><strong>Next</strong></span>.</p><div class="mediaobject"><img src="/graphics/9781782174806/graphics/B04317_09_14.jpg" /></div></li><li><p>In the next<a id="id623" class="indexterm"></a> menu, check whichever options you'd like<a id="id624" class="indexterm"></a> and press <span class="strong"><strong>Next</strong></span>.</p><div class="mediaobject"><img src="/graphics/9781782174806/graphics/B04317_09_15.jpg" /></div></li><li><p>Now, you'll <a id="id625" class="indexterm"></a>have an option to include a license <a id="id626" class="indexterm"></a>file, such as an EULA or whatever your publisher may require and any personal stuff you want to tell your users before or after installation. The program accepts <code class="literal">.txt</code> and <code class="literal">.rtf</code> files. Once you're ready, click on the <span class="strong"><strong>Next</strong></span> button.</p></li><li><p>Next, they'll allow you to specify the languages you want the installation to work for. I'll just go for <span class="strong"><strong>English</strong></span>, but you can add more. Afterward, click on <span class="strong"><strong>Next</strong></span>.</p></li><li><p>Finally, you <a id="id627" class="indexterm"></a>need to set where you want the setup to be <a id="id628" class="indexterm"></a>placed as well as the icon for it or a password. I created a new folder on my desktop called <code class="literal">TwinstickSetup</code> and used it. Then, click on <span class="strong"><strong>Next</strong></span>.</p><div class="mediaobject"><img src="/graphics/9781782174806/graphics/B04317_09_16.jpg" /></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note87"></a>Note</h3><p>If you want to include a<a id="id629" class="indexterm"></a> custom icon but don't have an <code class="literal">.ico</code> file you can use <a class="ulink" href="http://www.icoconverter.com/" target="_blank">http://www.icoconverter.com/</a>
</p></div></li><li><p>Next, you'll be brought to the successfully completed Script Wizard screen. After this, click on <span class="strong"><strong>Finish</strong></span>!</p><div class="mediaobject"><img src="/graphics/9781782174806/graphics/B04317_09_17.jpg" /></div></li><li><p>Now, it will ask <a id="id630" class="indexterm"></a>you if you'd like to compile the script. Select <a id="id631" class="indexterm"></a>
<span class="strong"><strong>Yes</strong></span>. It'll also ask if you want to save your script. Select <span class="strong"><strong>Yes</strong></span>; I saved it to the same folder as my exporting. It'll take a minute or two; but as soon as you see <span class="strong"><strong>Finished</strong></span> in the console window, it should be done.</p><div class="mediaobject"><img src="/graphics/9781782174806/graphics/B04317_09_18.jpg" /></div></li><li><p>If you go to the <a id="id632" class="indexterm"></a>same place as your export folder, you<a id="id633" class="indexterm"></a> should see your installer.</p><div class="mediaobject"><img src="/graphics/9781782174806/graphics/B04317_09_19.jpg" /></div></li><li><p>If you run it, it'll look something like the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781782174806/graphics/B04317_09_20.jpg" /></div></li></ol></div><p>With this, we have a<a id="id634" class="indexterm"></a> working <a id="id635" class="indexterm"></a>installer for our game.</p></div>