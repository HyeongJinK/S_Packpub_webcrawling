<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch11lvl1sec97"></a>Extending the level</h2></div></div><hr /></div><p>At the moment, Jake <a id="id372" class="indexterm"></a>moves forward and eventually will run to the edge and drop. To avoid this, we will simply generate the next piece of the level every time the player leaves one level piece behind. We will also destroy the <span class="emphasis"><em>old</em></span> and already used piece of level to keep things clean.</p><p>We will use the <code class="literal">OnTriggerEnter</code> method to recognize when the player reaches the <code class="literal">ExitTrigger</code> of a certain level piece:</p><div class="mediaobject"><img src="/graphics/9781785287596/graphics/B04245_11_13.jpg" /></div><p>First things first; we need to make sure that our level generator contains the functionality needed to extend the level. Let's add the <code class="literal">Remove OldestPiece void</code> method to the level generator.</p><p>With your coding experience, you should easily understand line by line what we are doing in this method. If you don't, just remember that this method will remove the oldest <code class="literal">levelPiece</code> from the level.</p><p>We are getting closer to a working endless level. The last piece of the puzzle that is missing is calling the <code class="literal">AddPiece</code> and <code class="literal">RemoveOldestPiece</code> methods when the <code class="literal">Player</code> game object enters the trigger.</p><p>Let's write one more <a id="id373" class="indexterm"></a>component that we will add to the <code class="literal">LeaveTrigger</code> game object in every <code class="literal">LevelPiecePrefab</code>. Create a new C# script and call it <code class="literal">LeaveTrigger</code>.</p><div class="mediaobject"><img src="/graphics/9781785287596/graphics/B04245_11_14.jpg" /></div><p>The <code class="literal">OnTriggerEnter2D</code> method is called automatically by Unity whenever <code class="literal">RigidBody2D</code> enters the 2D collider. If you look closely at the <code class="literal">Player</code> game object, you will see that one of its components is a <code class="literal">Rigidbody</code>. Where is our trigger then? We actually have a game object called <code class="literal">LeaveTrigger</code> as a child of <code class="literal">LevelPieceBasic</code>. In theory, we have all the parts needed for the <code class="literal">OnTriggerEnter2D</code> method to be called on the <code class="literal">LeaveTrigger</code>.</p><p>Add the <code class="literal">LeaveTrigger</code> component to the <code class="literal">LeaveTrigger</code> game object and click on <span class="strong"><strong>Play</strong></span> in Unity.</p><p>What should happen? After you press <span class="emphasis"><em>S</em></span> to start the game, Jake will run through the level. As soon as he enters the <code class="literal">LeaveTrigger</code> game object, we will call the <code class="literal">AddPiece</code> method to extend the level and the <code class="literal">RemoveOldestPiece</code> method to clean up the oldest piece in the level.</p><p>Please note that you can observe level generation only in the scene view. Why? Because the <span class="strong"><strong>Main Camera</strong></span> we are using to render what is happening is in a static position right now. We will add a <a id="id374" class="indexterm"></a>smart script to the camera very soon to make it follow the <code class="literal">Player</code> game object:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Download <code class="literal">CameraFollow.unitypackage</code> from the Packt hub and import it to your project.</p></li><li><p>Add the <code class="literal">CameraFollow</code> component to the <span class="strong"><strong>Main Camera</strong></span> game object.</p></li><li><p>Drag the <code class="literal">Player</code> game object into the <span class="strong"><strong>Target</strong></span> slot in the <span class="strong"><strong>Camera Follow</strong></span> component, as shown in this image:</p><div class="mediaobject"><img src="/graphics/9781785287596/graphics/B04245_11_15.jpg" /></div></li></ol></div></div>