<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch13lvl1sec109"></a>The coin prefab</h2></div></div><hr /></div><p>To make things a little <a id="id415" class="indexterm"></a>easier, I have already prepared the visual part of our coin. Download <code class="literal">Coin.unitypackage</code> and import it into your project:</p><div class="mediaobject"><img src="/graphics/9781785287596/graphics/B04245_13_01.jpg" /></div><p>Great job! Now we drag the <a id="id416" class="indexterm"></a>
<span class="strong"><strong>Coin</strong></span> prefab into the <span class="strong"><strong>Hierarchy</strong></span> view so that we can take a look at it. As mentioned before, I prepared this prefab visually. I have added <span class="strong"><strong>Sprite</strong></span>
<code class="literal"> Renderer</code> to the game object and linked it with the coin sprite. I have also created a simple spin animation controlled by the <span class="strong"><strong>Animator</strong></span>. Don't worry about it right now.</p><p>Now, you have to pick up from where I finished. Most collectables react with the environment through the physics of the game. We can use the 2D trigger here to react with the <code class="literal">Player</code> Game Object <code class="literal">Rigidbody2D</code> component. This is the exactly the same way we inserted <code class="literal">LeaveTriggers</code> into the game previously.</p><p>Select the coin and add the <code class="literal">CircleCollider2D</code> component. A green circle will appear around the coin, representing the triggering area. Make sure you tweak the radius value to roughly match the size of the coin. In my case, a value of 0.35 works great.</p><p>Another requirement that we need to fulfill to make the trigger work is ticking the <code class="literal">IsTrigger</code> checkbox. That's it! Our coin is ready to process trigger events. All that we need to do now is write some code to manage its behavior:</p><div class="mediaobject"><img src="/graphics/9781785287596/graphics/B04245_13_02.jpg" /></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch13lvl2sec78"></a>The Collectable class</h3></div></div></div><p>Let's plan what <a id="id417" class="indexterm"></a>behavior we want from our collectable. We will need the following methods:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>
<code class="literal">Show()</code>: This will show the coin and activate its collider</p></li><li style="list-style-type: disc"><p>
<code class="literal">Hide()</code>: This will hide the coin and deactivate its collider</p></li><li style="list-style-type: disc"><p>
<code class="literal">Collect()</code>: This is called at the moment of collection of the coin</p></li><li style="list-style-type: disc"><p>
<code class="literal">OnTriggerEnter2D</code>(Collider2D other): This is called by Unity's physics system when the collider enters our coin's trigger</p></li></ul></div><p>Create a new C# script, call it <code class="literal">Collectable</code>, and write the following code:</p><div class="mediaobject"><img src="/graphics/9781785287596/graphics/B04245_13_03.jpg" /></div><p>Add the <code class="literal">Collectable</code> <a id="id418" class="indexterm"></a>script to your <code class="literal">coin</code> prefab. We are ready to test it now! Make the <code class="literal">coin</code> prefab a child of one of the level chunks. Create a few copies of the coin next to each other so that you can test them better.</p><div class="mediaobject"><img src="/graphics/9781785287596/graphics/B04245_13_04.jpg" /></div><p>Let's click on <span class="strong"><strong>Play</strong></span> in Unity and see what happens. You should notice that the coin disappears upon contact with a <code class="literal">Player</code> Game Object. That's exactly what we wanted. Well done!</p><p>The last thing to do now is counting the collected coins. We will store the number of coins collected in the <a id="id419" class="indexterm"></a>
<code class="literal">GameManager</code> class and increment the <code class="literal">int</code> number every time a coin is collected. Let's add some functionality to the <code class="literal">GameManager</code> class:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Add the <code class="literal">collectedCoins</code> public member:</p><div class="informalexample"><pre class="programlisting">  public int collectedCoins = 0;</pre></div></li><li><p>Add a <code class="literal">public</code> method that you can call when a coin is collected:</p><div class="informalexample"><pre class="programlisting">public void CollectedCoin() {
  collectedCoins ++;
}</pre></div><p>What this method does is increment the <code class="literal">collectedCoins</code> variable by <code class="literal">1</code> every time the <code class="literal">++</code> operator is used.</p></li><li><p>In the <code class="literal">Collectable</code> class, add a single line calling <code class="literal">CollectedCoin()</code> from the <code class="literal">Collect</code> method, as follows:</p><div class="mediaobject"><img src="/graphics/9781785287596/graphics/B04245_13_05.jpg" /></div></li></ol></div><p>Now click on <span class="strong"><strong>Play</strong></span> in <a id="id420" class="indexterm"></a>Unity. Let's take a quick look to check whether it works. Select <span class="strong"><strong>GameManager</strong></span> and press the <span class="strong"><strong>Play</strong></span> button. You will notice that the number of collected coins in the Unity <span class="strong"><strong>Inspector</strong></span> increases every time a new coin is collected. Great! We now know that our <code class="literal">collectedCoin</code> variable works. However, we still need to update the label value in the <code class="literal">gameView</code> so that our user can see exactly how many coins they have collected.</p><p>It's a good idea to keep UI-controlling code separate from the <code class="literal">GameManager</code>. Let's write a short script that controls the UI on the <span class="strong"><strong>Game View</strong></span>. Create and add this component to the <code class="literal">InGameCanvas</code> game object:</p><div class="mediaobject"><img src="/graphics/9781785287596/graphics/B04245_13_06.jpg" /></div><p>Once you have the <span class="strong"><strong>View In Game</strong></span> component added, drag the <code class="literal">coinLabel</code> game object into the <span class="strong"><strong>coinsLabel</strong></span> slot:</p><div class="mediaobject"><img src="/graphics/9781785287596/graphics/B04245_13_07.jpg" /></div><p>The <span class="strong"><strong>View In Game</strong></span> <a id="id421" class="indexterm"></a>component should look like this:</p><div class="mediaobject"><img src="/graphics/9781785287596/graphics/B04245_13_08.jpg" /></div><p>What our code does is update the <code class="literal">.text</code> string value on the label. By doing this, the text on the UI changes and is always up-to-date with the <code class="literal">collectedCoins</code> value in <span class="strong"><strong>Game Manager</strong></span>.</p></div></div>