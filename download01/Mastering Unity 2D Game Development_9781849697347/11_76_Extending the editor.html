<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch11lvl1sec70"></a>Extending the editor</h2></div></div><hr /></div><p>Everyone <a id="id990" class="indexterm"></a>who uses Unity knows about the editor. It's the core place where you will spend a great deal of time putting your game together. You will spend the rest of your time in the choice of your code editor, patching things together, adding values, and working around with what most see as limitations of the editor itself. This, however, is not the case.</p><p>The people at Unity realized early that they couldn't do everything, since everyone wanted something different or little tweaks here and there; if they had tried to do everything, nothing would have ever left their doors.</p><p>So, from the ground up, Unity was designed to be extensible, and they exposed much of what is needed to build your own editor in effect within Unity itself.</p><p>If you browse<a id="id991" class="indexterm"></a> the asset store (<a class="ulink" href="https://www.assetstore.unity3d.com/en" target="_blank">https://www.assetstore.unity3d.com/en</a>), you will see a lot of assets that take advantage of this, and they have produced some really snazzy bolt-ons for the editor. These can reduce the need to code and just build things using the editor GUI.</p><p>These aren't magical <a id="id992" class="indexterm"></a>things and don't even require low-level C++ coding to achieve (although some do). You can update your editor to fix your game very easily, and you can do this in any of the languages that Unity supports.</p><p>The scripting framework behind the editor is broken up into several distinct layers that can be combined to give you almost any effect you need to build your content.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch11lvl2sec129"></a>The property drawers</h3></div></div></div><p>The editor <a id="id993" class="indexterm"></a>only has a basic way of looking at the properties<a id="id994" class="indexterm"></a> in the <span class="strong"><strong>Inspector</strong></span> pane based on the classes and objects used in your game. If you are using an existing Unity class, such as a string, color, or curve, Unity already has readymade property drawers (or visual handles) to manage these with their own editor windows in some cases (such as the curve editor). The majority of these are also built on the extensible framework that Unity exposes and is available to you as well.</p><p>Other classes such as vectors and numbers have a basic implementation, which is usually fine, but sometimes you would just prefer it in a different way.</p><p>This is where the property drawers come in. They can either replace the existing property viewer for a single field or for a type of object entirely. If you want a slider to alter a value between two values, add a <code class="literal">PropertyDrawer</code> attribute to the property to show a slider instead of just <code class="literal">int</code> or <code class="literal">float</code> as follows:</p><div class="informalexample"><pre class="programlisting">[Range (0, 100)]
public float health = 100;</pre></div><p>The preceding code example shows a range slider instead of a single float value as you can see here:</p><div class="mediaobject"><img src="/graphics/9781849697347/graphics/7347OT_11_01.jpg" /></div><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip81"></a>Tip</h3><p>For a more advanced example, check out the post on the Unity blog, which shows several<a id="id995" class="indexterm"></a> different patterns to use your property drawers and even create them. The post is available at <a class="ulink" href="http://blogs.unity3d.com/2012/09/07/property-drawers-in-unity-4/" target="_blank">http://blogs.unity3d.com/2012/09/07/property-drawers-in-unity-4/</a>.</p></div><p>While<a id="id996" class="indexterm"></a> building the property drawers, you will use the <code class="literal">EditorGUI</code> controls to draw the elements on the screen. The <code class="literal">EditorGUI</code> class provides<a id="id997" class="indexterm"></a> a rich collection of controls that can be used. For the <a id="id998" class="indexterm"></a>list of available controls, visit <a class="ulink" href="https://docs.unity3d.com/Documentation/ScriptReference/EditorGUI.html" target="_blank">https://docs.unity3d.com/Documentation/ScriptReference/EditorGUI.html</a>.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note125"></a>Note</h3><p>The property drawers can only use the default layouts in the <code class="literal">EditorGUI</code> class. For performance reasons, they cannot use the automatic controller found in the <code class="literal">EditorGUILayout</code> class, which is used in <code class="literal">EditorWindows</code>.</p></div><p>For more information on property drawers, see the Unity reference guide at <a class="ulink" href="https://docs.unity3d.com/Documentation/ScriptReference/PropertyDrawer.html" target="_blank">https://docs.unity3d.com/Documentation/ScriptReference/PropertyDrawer.html</a>.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip82"></a>Tip</h3><p>If you want to see some more creative uses of the property drawers, check out the simple little GitHub repository at <a class="ulink" href="https://github.com/tenpn/ChestOfPropertyDrawers" target="_blank">https://github.com/tenpn/ChestOfPropertyDrawers</a>.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch11lvl3sec75"></a>Property drawers examples</h4></div></div></div><p>Using <a id="id999" class="indexterm"></a>the <code class="literal">NPC</code> script in <code class="literal">Assets\Scripts\Classes</code>, let's see the effect of adding some simple property drawers to our NPCs in the <span class="strong"><strong>Inspector</strong></span> pane.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h5 class="title"><a id="ch11lvl4sec13"></a>Built-in property drawers</h5></div></div></div><p>Starting <a id="id1000" class="indexterm"></a>simply, we can decorate some <a id="id1001" class="indexterm"></a>of the properties of the <code class="literal">NPC</code> class in our game with the <code class="literal">Range</code> attribute by adding the following code:</p><div class="informalexample"><pre class="programlisting">public string Name;
<span class="strong"><strong>[Range(10, 100)]</strong></span>
public int Age;
public string Faction;
public string Occupation;
<span class="strong"><strong>[Range(1, 10)]</strong></span>
public int Level;</pre></div><p>The <a id="id1002" class="indexterm"></a>preceding code has the following effect on the editor<a id="id1003" class="indexterm"></a> inspector:</p><div class="mediaobject"><img src="/graphics/9781849697347/graphics/7347OT_11_02.jpg" /></div><p>This just makes it easier to manage your settings and makes it a little prettier to look at. Now, let's look at something that is a little more complicated.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h5 class="title"><a id="ch11lvl4sec14"></a>Custom property drawers</h5></div></div></div><p>Creating<a id="id1004" class="indexterm"></a> your own property drawer is certainly a <a id="id1005" class="indexterm"></a>bit more advanced. However, once you have learned the basics, it is quite easy to build your own.</p><p>For this example, we will create a simple pop up that takes an array of values for the possible selection, as shown here:</p><div class="mediaobject"><img src="/graphics/9781849697347/graphics/7347OT_11_03.jpg" /></div><p>First, we<a id="id1006" class="indexterm"></a> need a property type or attribute that we<a id="id1007" class="indexterm"></a> want to control. This could be a set of parameters (such as the <code class="literal">Range</code> property, which has a beginning and an end), a validation string, or even an enumeration.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note126"></a>Note</h3><p>The property type or attribute you want to control has to live in your project folder and <span class="strong"><strong>not</strong></span> in the special <code class="literal">Editor</code> folder. The Unity documents are not clear enough on this.</p></div><p>So, create a new folder named <code class="literal">Properties</code> in <code class="literal">Assets\Scripts\Classes</code>. Then, create a new C# script named <code class="literal">PopupAttribute</code> in the <code class="literal">Properties</code> folder and replace its contents with the following code:</p><div class="informalexample"><pre class="programlisting">using UnityEngine;
public class PopUpAttribute: PropertyAttribute
{
  public string[] value;
  public PopUpAttribute(params string[] input)
  {
    value = input;
  }
}</pre></div><p>Note that your <code class="literal">property</code> class must be derived from the <code class="literal">PropertyAttribute</code> class, and it must have a constructor with the same number of parameters required for your attribute (for example, the <code class="literal">Range</code> attribute has two <code class="literal">int</code> values).</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip83"></a>Tip</h3><p>In a strange (I suspect reflection) circumstance, you can either call your class by its name or suffix it with the word <code class="literal">Attribute</code> (as shown in the preceding code); both will be recognized by the name alone.</p><p>For example, <code class="literal">PopUpAttribute</code> can be recognized as <code class="literal">PopUp</code> or <code class="literal">PopUpAttribute</code>.</p></div><p>With<a id="id1008" class="indexterm"></a> the property in place, we can now add <a id="id1009" class="indexterm"></a>our custom property drawer code. Unlike the property we just created, this does have to live in the special <code class="literal">Editor</code> folder.</p><p>So, create a new folder named <code class="literal">PropertyDrawers</code> in the <code class="literal">Assets\Scripts\</code>
<span class="strong"><strong>Editor </strong></span>folder and create a new script named <code class="literal">PopUpCustomPropertyDrawer</code>, replacing its contents with the following code:</p><div class="informalexample"><pre class="programlisting">using UnityEditor;
using UnityEngine;

[CustomPropertyDrawer(typeof(PopUpAttribute))]
public class PopUpCustomPropertyDrawer : PropertyDrawer {

  PopUpAttribute popUpAttribute { 
    get { return ((PopUpAttribute)attribute); } }
}</pre></div><p>The preceding code gives us the basic framework for our custom property drawer (the <code class="literal">public</code> property I've added isn't mandatory, but provides quick and easy access to the underlying property type we are enabling). Next, we need to add the <code class="literal">OnGUI</code> function that will draw our custom property UI using the following code:</p><div class="informalexample"><pre class="programlisting">public override void OnGUI(Rect position, SerializedProperty prop, GUIContent label)
{
  if (prop.propertyType != SerializedPropertyType.String)
  {
    throw new UnityException("property " + prop + " must be string to use with PopUpAttribute ");
  }

  var popupRect = EditorGUI.PrefixLabel(position, GUIUtility.GetControlID(FocusType.Passive), label);

  var currentItem = prop.stringValue;
  var currentIndex = popUpAttribute.value.Length - 1;
  for (; currentIndex &gt;= 0; currentIndex--)
  {
    if (popUpAttribute.value[currentIndex] == currentItem)
      break;
  }

  int selectedIndex = EditorGUI.Popup(popupRect, currentIndex, popUpAttribute.value);
  prop.stringValue = selectedIndex &lt; 0 ? "" : popUpAttribute.value[selectedIndex];
}</pre></div><p>Walking<a id="id1010" class="indexterm"></a> through the preceding script is quite simple; it is <a id="id1011" class="indexterm"></a>described as follows:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>The class is decorated with a <code class="literal">CustomPropertyDrawer</code> attribute and the type of class it is targeted at.</p></li><li style="list-style-type: disc"><p>As stated, the class is derived from the <code class="literal">PropertyDrawer</code> class.</p></li><li style="list-style-type: disc"><p>A helper property (<code class="literal">popUpAttribute</code>) gets the correct type of class from the attribute property of the <code class="literal">PropertyDrawer</code> base class (optional).</p></li><li style="list-style-type: disc"><p>We override the <code class="literal">OnGUI</code> function for the property drawers.</p></li><li style="list-style-type: disc"><p>We then check whether the target property (the variable you will attach this to) is of the correct type (in this case, a string). It returns <code class="literal">UnityException</code> if it is not correct.</p></li><li style="list-style-type: disc"><p>A <code class="literal">Rect</code> variable is defined for where we want to draw the output from our property <a id="id1012" class="indexterm"></a>drawer (a requirement to use the <code class="literal">EditorGUI.Popup</code> control).</p></li><li style="list-style-type: disc"><p>We get the current value for the property we are attached to and compare it with the possible values for the item. We do this only because we have a list of options and need to know which the current one is. For other types, this may not be needed.</p></li><li style="list-style-type: disc"><p>We draw a pop-up control using the <code class="literal">EditorGUI.Popup</code> control.</p></li><li style="list-style-type: disc"><p>Lastly, we set the property we are attached to with the value the user has selected.</p></li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note127"></a>Note</h3><p>We could have used an <code class="literal">enum</code> object instead of an array to give us a more programmatic approach, in which case the preceding steps would be very similar. However, this approach allows us to set the scope of the selection for each property.</p></div><p>With the property and our custom property drawer in place, we can decorate the variables in our <code class="literal">NPC</code> <a id="id1013" class="indexterm"></a>class to achieve the result I pictured<a id="id1014" class="indexterm"></a> earlier, as follows:</p><div class="informalexample"><pre class="programlisting">public string Name;
[Range(10, 100)]
public int Age;
<span class="strong"><strong>[PopUp("Imperial", "Independant", "Evil")]</strong></span>
public string Faction;
<span class="strong"><strong>[PopUp("Mayor", "Wizard", "Layabout")]</strong></span>
public string Occupation;
<span class="strong"><strong>[Range(1, 10)]</strong></span>
public int Level;</pre></div><p>It may seem like a lot of fuss. However, once it's complete, you can tune the Unity editor to work for you more efficiently.</p></div></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch11lvl2sec130"></a>Custom editors</h3></div></div></div><p>Say you<a id="id1015" class="indexterm"></a> want to control the entire scope of a single class or <code class="literal">ScriptableObject</code>; this is where <code class="literal">CustomEditor</code> scripts come in.</p><p>They can<a id="id1016" class="indexterm"></a> be used against any script that can be attached to a game object to alter how it works in the Unity editor inspector.</p><p>As an example of these (the best way to show custom editors is through code), we will add some functionality to a camera to provide us with better control over it in a scene.</p><p>First, we'll need a very simple camera script that will point the camera to a specified target, starting at <code class="literal">0</code>, <code class="literal">0</code> ,<code class="literal">0</code>. So, create a new script named <code class="literal">CameraLookAt</code> in <code class="literal">Assets\Scripts</code> and replace its contents with the following code:</p><div class="informalexample"><pre class="programlisting">using UnityEngine;

public class CameraLookAt : MonoBehaviour
{
  public Vector3 cameraTarget = Vector3.zero;

  void Update()
  {
    transform.LookAt(cameraTarget);
  }
}</pre></div><p>We can then define a <code class="literal">CustomEditor</code> script that will be run by the editor whenever it detects a game object with the script attached to it.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note128"></a>Note</h3><p>As with a lot of editor features, remember (as a good rule of thumb) that if a class requires the <code class="literal">UnityEditor</code> namespace, it will need to live in the special <code class="literal">Editor</code> folder in your project.</p></div><p>So, create<a id="id1017" class="indexterm"></a> a new C# script called <code class="literal">CameraTargetEditor</code> in <code class="literal">Assets\Scripts\Editor</code> in your project and replace its contents<a id="id1018" class="indexterm"></a> with the following code:</p><div class="informalexample"><pre class="programlisting">using UnityEngine;
using UnityEditor;

[CustomEditor(typeof(CameraLookAt))]
public class CameraTargetEditor : Editor
{
    public override void OnInspectorGUI()
    {
        CameraLookAt targetScript = (CameraLookAt)target;
        
        targetScript.cameraTarget =
          EditorGUILayout.Vector3Field ("Look At Point",
            targetScript.cameraTarget);
        if (GUI.changed)
            EditorUtility.SetDirty(target);        
    }
}</pre></div><p>This script doesn't do much yet; we now have a <code class="literal">Vector3</code> handle in our script that displays the position of the camera's target (the specific point it is looking at). What is very nice here is that you can edit the values and the camera will automatically transform itself to look at the new point. To demonstrate this, create a new scene named <code class="literal">EditorDemos</code> in <code class="literal">Assets\Scenes</code> and attach the <code class="literal">CameraLookAt</code> script to <span class="strong"><strong>Main Camera</strong></span>. If you then select the <span class="strong"><strong>Main Camera</strong></span> game object in the hierarchy, you will see the following settings in the <span class="strong"><strong>Inspector</strong></span> pane:</p><div class="mediaobject"><img src="/graphics/9781849697347/graphics/7347OT_11_04.jpg" /></div><p>This is a lot easier than messing with the rotation values of the ordinary camera. Let's continue to add more functionalities that will blow your mind.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note129"></a>Note</h3><p>If the custom editor script depends on certain properties or components being available on the game object you attach it to, then be sure to use the <code class="literal">RequireConponent</code> attribute on the base class (not the <code class="literal">CustomEditor</code> script).</p></div><p>To make it<a id="id1019" class="indexterm"></a> even more useful, we can also represent this <a id="id1020" class="indexterm"></a>selection in the scene view as a control handle. To do this, we simply add another function to our <code class="literal">CameraTargetEditor</code> <code class="literal">CustomEditor</code> script; add the following <code class="literal">OnSceneGUI</code> function to the script:</p><div class="informalexample"><pre class="programlisting">void OnSceneGUI()
{
    CameraLookAt targetScript = (CameraLookAt)target;
 
    targetScript.cameraTarget = Handles.PositionHandle(
            targetScript.cameraTarget, Quaternion.identity);
 
    if (GUI.changed)
        EditorUtility.SetDirty(target);
}</pre></div><p>Just as the <code class="literal">OnGUI</code> method draws in to your game, this function will draw in to the editor scene. Using the <code class="literal">Handles.PositionHandle</code> control, it will draw a regular handlebars control in the scene at the point you have specified, in this case, the camera's look-at target, as seen here:</p><div class="mediaobject"><img src="/graphics/9781849697347/graphics/7347OT_11_05.jpg" /><div class="caption"><p>Camera Target (1) and Camera Transform (2)</p></div></div><p>Want<a id="id1021" class="indexterm"></a> more?? You can then alter how the handlebars <a id="id1022" class="indexterm"></a>will look on the screen with the following code:</p><div class="informalexample"><pre class="programlisting">void OnSceneGUI()
{
    CameraLookAt targetScript = (CameraLookAt)target;
 
    targetScript.cameraTarget = Handles.PositionHandle(
targetScript.cameraTarget, Quaternion.identity);
    <span class="strong"><strong>Handles.SphereCap(0, targetScript.cameraTarget, </strong></span>
<span class="strong"><strong>Quaternion.identity, 2);</strong></span>
    if (GUI.changed)
        EditorUtility.SetDirty(target);
}</pre></div><p>As shown in the following screenshot, this simply alters the handlebars we are drawing, decorating them with a sphere. There are several other options as well should you choose to explore them.</p><div class="mediaobject"><img src="/graphics/9781849697347/graphics/7347OT_11_06.jpg" /><div class="caption"><p>(1) Camera Target Sphere, (2) Camera Transform</p></div></div><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip84"></a>Tip</h3><p>For <a id="id1023" class="indexterm"></a>more information about custom editors, see<a id="id1024" class="indexterm"></a> the<a id="id1025" class="indexterm"></a> Unity reference guide at <a class="ulink" href="http://docs.unity3d.com/Documentation/ScriptReference/Editor.html" target="_blank">http://docs.unity3d.com/Documentation/ScriptReference/Editor.html</a>.</p><p>For more <a id="id1026" class="indexterm"></a>information about handles and what you can do with them, see the Unity reference guide at <a class="ulink" href="http://docs.unity3d.com/Documentation/ScriptReference/Handles.html" target="_blank">http://docs.unity3d.com/Documentation/ScriptReference/Handles.html</a>.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch11lvl2sec131"></a>The editor window</h3></div></div></div><p>Quite simply, Unity <a id="id1027" class="indexterm"></a>editor windows are just separate <a id="id1028" class="indexterm"></a>containers for collections of editor GUI controls. These windows are a more advanced version of the property drawers described previously, and as such use a different set of custom controls.</p><p>The <span class="strong"><strong>Inspector</strong></span>, <span class="strong"><strong>Game</strong></span>, and <span class="strong"><strong>Scene</strong></span> windows, and in fact, pretty much every other dockable window in the Unity editor, are editor windows. In fact, they are all built in the same way using the same scripting framework.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note130"></a>Note</h3><p>As stated previously, remember that any script that uses the editor functionality or the <code class="literal">UnityEditor</code> namespace must be placed in a special project folder titled <code class="literal">Editor</code>.</p></div><p>To implement <a id="id1029" class="indexterm"></a>your own editor window, you simply need <a id="id1030" class="indexterm"></a>to create a class that is derived from <code class="literal">EditorWindow</code> instead of <code class="literal">MonoBehaviour</code>. The script must also live in the special <code class="literal">Editor</code> folder within the project structure, so create a new script called <code class="literal">MyEditorWindow</code> in <code class="literal">Assets\Scripts\Editor</code>, as follows:</p><div class="informalexample"><pre class="programlisting">using UnityEditor;
using UnityEngine;

public class MyEditorWindow : EditorWindow
{
string windowName = "My Editor Window";
bool groupEnabled;
bool DisplayToggle = true;
float Offset = 1.23f;

}</pre></div><p>I've added some properties to give some depth to the example.</p><p>With your new window in place, you then need to implement a function to display the window when it is called inside the new <code class="literal">MyEditorWindow</code> class:</p><div class="informalexample"><pre class="programlisting">[MenuItem ("Window/My Window")]
public static void ShowWindow ()
{
    EditorWindow.GetWindow(typeof(MyEditorWindow));
}</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note131"></a>Note</h3><p>It doesn't matter what the preceding function is called; it's just an editor reference attribute attached to the function that shows where the option will appear in the Unity editor menu.</p></div><p>If you want more control over the size and position of your editor window, instead of using <a id="id1031" class="indexterm"></a>the preceding <code class="literal">GetWindow</code> function, you can use the following <code class="literal">GetWindowWithRect</code> function:</p><div class="informalexample"><pre class="programlisting">[MenuItem ("Window/My Window")]
public static void ShowWindow ()
{
    EditorWindow.GetWindowWithRect(typeof(MyEditorWindow),
      new Rect(0, 0, 400, 150));
}</pre></div><p>This will set the <a id="id1032" class="indexterm"></a>position and size of the window to a fixed point on the screen, but as with all other editor windows, it can then be resized and docked like <a id="id1033" class="indexterm"></a>any other window. This method is more useful to display a collection of properties in the scene view to edit nodes or other position-based visual configuration.</p><p>Lastly, you need some GUI code. This is pretty much the same as the normal GUI code, but with a few editor extensions because it is being drawn in the editor. This goes in to an <code class="literal">OnGUI</code> method, for example:</p><div class="informalexample"><pre class="programlisting">void OnGUI()
{
    // Your custom Editor Window GUI code
    GUILayout.Label("Base Settings", EditorStyles.boldLabel);
    windowName = EditorGUILayout.TextField("Window Name", 
      windowName);
 
    groupEnabled = 
      EditorGUILayout.BeginToggleGroup("Optional Settings", 
        groupEnabled);

    DisplayToggle = 
      EditorGUILayout.Toggle("Display Toggle", DisplayToggle);

    Offset = EditorGUILayout.Slider("Offset Slider",
      Offset, -3, 3);
    EditorGUILayout.EndToggleGroup();
}</pre></div><p>The preceding example will show the following menu window:</p><div class="mediaobject"><img src="/graphics/9781849697347/graphics/7347OT_11_09.jpg" /></div><p>When<a id="id1034" class="indexterm"></a> you put GUI elements together in an editor window, you <a id="id1035" class="indexterm"></a>can use either the basic <code class="literal">EditorGUI</code> controls or the more advanced <code class="literal">EditorGUILayout</code> controls, which implement some additional automatic layout features on top of the basic controls.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip85"></a>Tip</h3><p>For more <a id="id1036" class="indexterm"></a>details on the controls available with <code class="literal">EditorGUILayout</code>, check out the Unity reference at <a class="ulink" href="https://docs.unity3d.com/Documentation/ScriptReference/EditorGUILayout.html" target="_blank">https://docs.unity3d.com/Documentation/ScriptReference/EditorGUILayout.html</a>.</p><p>For more <a id="id1037" class="indexterm"></a>information on editor windows, see the Unity reference guide at <a class="ulink" href="https://docs.unity3d.com/Documentation/ScriptReference/EditorWindow.html" target="_blank">https://docs.unity3d.com/Documentation/ScriptReference/EditorWindow.html</a>.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch11lvl2sec132"></a>Gizmos</h3></div></div></div><p>With custom <a id="id1038" class="indexterm"></a>editors, you could also have handles to represent a <a id="id1039" class="indexterm"></a>control in the scene view, extending the <span class="strong"><strong>Inspector</strong></span> features in to the scene.</p><p>We also have another way to have class-based features that are only available in the editor through the use of Gizmos.</p><p>Gizmos offer a much richer graphical way to add visual elements to the scene to aid the use of a class, unlike custom editors, which are only added to your base class that the editor will then make use of.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note132"></a>Note</h3><p><code class="literal">OnDrawGizmo</code> functions are only available on classes that are derived from <code class="literal">MonoBehaviour</code>, not the <code class="literal">Editor</code> classes.</p></div><p>For example, we<a id="id1040" class="indexterm"></a> can amend the <code class="literal">CameraLookAt</code> script we created <a id="id1041" class="indexterm"></a>earlier and make it draw a Gizmo line from the camera to the target's look-at point by adding the following code to the script:</p><div class="informalexample"><pre class="programlisting">void OnDrawGizmos()
{
    Gizmos.color = Color.yellow;
    Gizmos.DrawLine(transform.position, cameraTarget);
}</pre></div><p>The code produces the result as follows:</p><div class="mediaobject"><img src="/graphics/9781849697347/graphics/7347OT_11_07.jpg" /></div><p>Now, when you return to the editor and move the look-at point or the camera, there will be a yellow line drawn between them.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note133"></a>Note</h3><p>If you collapse the script in the <span class="strong"><strong>Inspector</strong></span> pane, this will turn off the Gizmo. This is handy if you want to just hide it.</p></div><p>If you don't want the Gizmo drawn all the time, you can also track when the user has the Gizmo selected using the <code class="literal">OnDrawGizmosSelected</code> method, as follows:</p><div class="informalexample"><pre class="programlisting">void OnDrawGizmosSelected()
{
    Gizmos.color = Color.red;
    Gizmos.DrawLine(transform.position, cameraTarget);
}</pre></div><p>Now when the game object the script is attached to is selected in the editor, the line will be drawn in <a id="id1042" class="indexterm"></a>red instead of yellow. Alternatively, just use <a id="id1043" class="indexterm"></a>the <code class="literal">OnDrawGizmosSelected</code> function on its own to only draw a line when selected.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip86"></a>Tip</h3><p>For more <a id="id1044" class="indexterm"></a>information on Gizmos, see the Unity reference guide at <a class="ulink" href="http://docs.unity3d.com/Documentation/ScriptReference/Gizmos.html" target="_blank">http://docs.unity3d.com/Documentation/ScriptReference/Gizmos.html</a>.</p><p>For <a id="id1045" class="indexterm"></a>fantastic additional resources and tutorials, check out the article on CatLike Coding's blog at <a class="ulink" href="http://catlikecoding.com/unity/tutorials/editor/star/" target="_blank">http://catlikecoding.com/unity/tutorials/editor/star/</a>.</p><p>Or, you can check out the <a id="id1046" class="indexterm"></a>excellent Gimzo-driven design tutorial at <a class="ulink" href="http://code.tutsplus.com/tutorials/how-to-add-your-own-tools-to-unitys-editor--active-10047" target="_blank">http://code.tutsplus.com/tutorials/how-to-add-your-own-tools-to-unitys-editor--active-10047</a>.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch11lvl2sec133"></a>Building your editor menus</h3></div></div></div><p>Another <a id="id1047" class="indexterm"></a>way of extending in to the editor is to<a id="id1048" class="indexterm"></a> customize it by adding your own menus. We covered little bits of this in previous chapters by adding extra options to create your assets and such, but there is much more to it.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note134"></a>Note</h3><p><code class="literal">MenuItem</code> functions must be declared as <code class="literal">Static</code> functions, else they will not be recognized, and scripts must be placed in the special <code class="literal">Editor</code> folder.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch11lvl3sec76"></a>Adding a MenuItem attribute</h4></div></div></div><p>The main <a id="id1049" class="indexterm"></a>way of adding a new menu item is <a id="id1050" class="indexterm"></a>to define a script in <code class="literal">Assets\Scripts\Editor</code> and append the <code class="literal">MenuItem</code> attribute to a static method within it. So, create a new script called <code class="literal">MyMenu</code> in this folder and replace its contents with the following code:</p><div class="informalexample"><pre class="programlisting">using UnityEditor;
using UnityEngine;
public class MyMenu  
{
    // Add a menu item named MenuItem1 to a Menu option called 
    // MenuName in the menu bar.
    [MenuItem ("MenuName/MenuItem1")]
    static void EnableMyAwesomeFeature ()
    {
        Debug.Log ("I am a leaf on the wind. Watch how I soar.");
    }
}</pre></div><p>This<a id="id1051" class="indexterm"></a> code simply creates a new top-level menu <a id="id1052" class="indexterm"></a>option called <code class="literal">MenuName</code> with a single item called <code class="literal">MenuItem1</code>, as shown here:</p><div class="mediaobject"><img src="/graphics/9781849697347/graphics/7347OT_11_10.jpg" /></div><p>From here, you can execute whatever you need to.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip87"></a>Tip</h3><p>When you return to Unity after adding a menu script, it may sometimes not show up immediately. You can either click on the menu bar or restart the editor to make it appear (it just needs a nudge).</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch11lvl3sec77"></a>Enabling/disabling a MenuItem attribute</h4></div></div></div><p>We can <a id="id1053" class="indexterm"></a>extend this further by adding a validation<a id="id1054" class="indexterm"></a> logic method to support a <code class="literal">MenuItem</code> attribute. This<a id="id1055" class="indexterm"></a> controls whether the menu<a id="id1056" class="indexterm"></a> option is enabled or not.</p><p>For this, you need to create a pair of the following items:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>A menu item</p></li><li style="list-style-type: disc"><p>A menu item validator</p></li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note135"></a>Note</h3><p>The menu item and the menu item validator must have the same menu path. So, if the menu item (as declared previously) is <code class="literal">[MenuItem ("MenuName/MenuItem1")]</code>, the validator must have the same menu definition as follows:</p><div class="informalexample"><pre class="programlisting">[MenuItem ("MenuName/MenuItem1", true)]</pre></div><p>Validators do not add menu items. They only extend or validate the existing menu items.</p></div><p>So, using <a id="id1057" class="indexterm"></a>the menu item we just added <a id="id1058" class="indexterm"></a>earlier, we can add a validator menu<a id="id1059" class="indexterm"></a> function. It must have a return type of <code class="literal">bool</code> and an <a id="id1060" class="indexterm"></a>additional flag set against the function attribute, as follows:</p><div class="informalexample"><pre class="programlisting">[MenuItem ("MenuName/MenuItem1", true)]
static bool CheckifaGameObjectisselected() {
    // Return false if no transform is selected.
    return Selection.activeTransform != null;
}</pre></div><p>This simple validator just checks whether you have a game object selected in the editor; if not, then <code class="literal">MenuItem1</code> is disabled.</p><p>This new validation function is evaluated by the editor whenever it displays the menu item of the same name. By setting the <code class="literal">bool</code> flag at the end of the <code class="literal">MenuItem</code> attribute, it tells the editor that this function provides the validation logic for a <code class="literal">MenuItem</code> attribute of the same name. Then, the editor will enable or disable that <code class="literal">MenuItem</code> attribute based on the return of the validator function.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch11lvl3sec78"></a>Adding shortcut keys to a MenuItem attribute</h4></div></div></div><p>If <a id="id1061" class="indexterm"></a>you add <code class="literal">%</code> and a letter to <a id="id1062" class="indexterm"></a>the end of your <code class="literal">MenuItem</code> attribute, Unity <a id="id1063" class="indexterm"></a>will also enable a shortcut key for that letter.</p><p>So, <code class="literal">%g</code> would enable a shortcut of <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>G</em></span> on Windows and <span class="emphasis"><em>cmd</em></span> + <span class="emphasis"><em>G</em></span> on a Mac.</p><p>For example, add a new function to our <code class="literal">MyMenu</code> script as follows:</p><div class="informalexample"><pre class="programlisting">[MenuItem ("MenuName/MenuItem2 %g")]
static void EnableMyOtherAwesomeFeature()
{
    Debug.Log ("Find my key and win the prize - g");
}</pre></div><p>This<a id="id1064" class="indexterm"></a> will show us an additional<a id="id1065" class="indexterm"></a> option with the shortcut defined, as <a id="id1066" class="indexterm"></a>you can see here:</p><div class="mediaobject"><img src="/graphics/9781849697347/graphics/7347OT_11_11.jpg" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch11lvl3sec79"></a>Adding contextual MenuItems</h4></div></div></div><p>The<a id="id1067" class="indexterm"></a> last bit of trickery you can <a id="id1068" class="indexterm"></a>perform is to add menu items<a id="id1069" class="indexterm"></a> to the existing features of Unity, even <span class="strong"><strong>Inspector</strong></span>.</p><p>You do this with a custom name for the <code class="literal">MenuItem</code> attribute and a different signature for the function. So, we add the following method to our <code class="literal">MyMenu</code> script:</p><div class="informalexample"><pre class="programlisting">[MenuItem("CONTEXT/Transform/Move to Center")]
static void MoveToCenter(MenuCommand command)
{
    Transform transform = (Transform)command.context;
    transform.position = Vector3.zero;
    Debug.Log("Moved object to " + 
      transform.position + " from a Context Menu.");
}</pre></div><p>The preceding script attaches itself to any transform component (in this case, the <span class="strong"><strong>Inspector</strong></span> pane). Then, when it is run, the parameter on the function receives the instance of the object it was run on and lets you interrogate or alter it, resulting in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781849697347/graphics/7347OT_11_12.jpg" /></div><p>The <a id="id1070" class="indexterm"></a>structure of the <a id="id1071" class="indexterm"></a>special <code class="literal">MenuItem</code> name is as <a id="id1072" class="indexterm"></a>follows:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p><span class="strong"><strong>CONTEXT</strong></span>: This<a id="id1073" class="indexterm"></a> is a fixed item to identify the menu as a contextual item</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Object</strong></span>: This is <a id="id1074" class="indexterm"></a>the type of object this context menu will be available on</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Name</strong></span>: This is <a id="id1075" class="indexterm"></a>the name of the menu item</p></li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note137"></a>Note</h3><p>You can just add extra dimensions/children to context menus by adding additional <code class="literal">"/"</code> characters.</p><p>However, if there is an error or the depth of your menus is too deep, Unity won't show the error; it just won't display the menu item (leaving you scratching your head). If this happens, try setting a shorter or different menu name.</p></div><p>Context menus can be added to just about any object/component in the Unity editor, including your own objects.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip88"></a>Tip</h3><p>For<a id="id1076" class="indexterm"></a> more information <a id="id1077" class="indexterm"></a>on the <code class="literal">MenuItem</code> class<a id="id1078" class="indexterm"></a> and its use in <a id="id1079" class="indexterm"></a>Unity Editor, see the Unity scripting reference guide at <a class="ulink" href="https://docs.unity3d.com/Documentation/ScriptReference/MenuItem.html" target="_blank">https://docs.unity3d.com/Documentation/ScriptReference/MenuItem.html</a>.</p></div></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch11lvl2sec134"></a>Running scripts in the Editor folder</h3></div></div></div><p>The last little<a id="id1080" class="indexterm"></a> tidbit you should be aware <a id="id1081" class="indexterm"></a>of surrounds scripts and their execution.</p><p>If you<a id="id1082" class="indexterm"></a> put a script in the <code class="literal">Editor</code> folder, it will be executed when you are in the editor. However, what about all your other scripts?</p><p>Sure you can run the game and see the script running, but that doesn't help you when you are in the editor. What if you want to see the effect of your script while manipulating game objects in your scene? If you are using GUI controls, this becomes even more critical when you are trying to place controls on the screen.</p><p>Thankfully, there is a way to force the editor to run your script, and all it takes is yet another attribute called <code class="literal">ExecuteInEditMode</code> added to your class. To show this, let's open the <code class="literal">CommandBar</code> script under <code class="literal">Assets\Scripts</code> in our project and add the <code class="literal">[ExecuteInEditMode]</code> attribute to that class as follows:</p><div class="informalexample"><pre class="programlisting">using UnityEngine;
using System.Collections;
 
<span class="strong"><strong>[ExecuteInEditMode]</strong></span>
public class CommandBar : MonoBehaviour
{</pre></div><p>Now when you open up the <code class="literal">Battle</code> scene, <code class="literal">CommandBar</code> will always be drawn as shown here:</p><div class="mediaobject"><img src="/graphics/9781849697347/graphics/7347OT_11_13.jpg" /></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note138"></a>Note</h3><p>If <a id="id1083" class="indexterm"></a>you are applying this <a id="id1084" class="indexterm"></a>to the GUI that repositions itself to the <a id="id1085" class="indexterm"></a>scene like with <code class="literal">CommandBar</code>, the visual aspect you see in the editor may not be the same as when the game is running. So, things may position differently. You either manage it in the code or live with it in the editor; it's up to you.</p><p>If you have portions of your script that rely on other components that may not be active in the editor, be sure to check for null references in your code to avoid nasty errors in the console that may lead you down a dark path.</p><p>For example, in the <code class="literal">CommandBar</code> script, we need to have <code class="literal">null</code> checking on the <code class="literal">MessagingManager</code> calls and the <code class="literal">SetPosition</code> function, which have been updated in the sample app.</p><p>Also, any calls to <code class="literal">Static</code> classes in the <code class="literal">OnDestroy</code> method may generate errors/warnings when they are run in the editor; so just be aware!</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch11lvl3sec80"></a>Alternative approaches</h3></div></div></div><p>There is <a id="id1086" class="indexterm"></a>always more than one way to cut the cheese as they say, and so too it is with Unity. Some more advanced options to run the scripts in the editor include the following methods.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch11lvl4sec15"></a>The [InitialiseOnLoad] attribute</h4></div></div></div><p>Another advanced feature with the editor is to make use of the <code class="literal">[InitialiseOnLoad]</code> attribute. What this attribute does is run whatever class or script it is attached to when the editor <a id="id1087" class="indexterm"></a>opens or when a build event <a id="id1088" class="indexterm"></a>occurs (such as after you edit a script or run the project). Most developers use this for tracking purposes or to have background processes run whenever something is changed. This is especially useful if you have some level data stored in a custom file and need to regenerate a scene or level based on that configuration.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note139"></a>Note</h3><p>Unlike <code class="literal">[ExecuteInEditMode]</code>, the <code class="literal">[InitialiseOnLoad]</code> attribute is an editor-only feature, and the scripts using it must be placed in the special <code class="literal">Editor</code> folder in your project.</p></div><p>It is recommended that you combine the use of the <code class="literal">[InitialiseOnLoad]</code> attribute together with a static constructor to ensure the script will run before any other scripts in the scene or project.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip90"></a>Tip</h3><p>If you are loading resources in an <code class="literal">[InitialiseOnLoad]</code> class, beware that the filesystem may not be initialized when the script starts. It's recommended you delay it until the first editor update (using the following method). For more details, check<a id="id1089" class="indexterm"></a> out the detailed post at <a class="ulink" href="http://bit.ly/InitiliseOnLoadResources" target="_blank">http://bit.ly/InitiliseOnLoadResources</a>.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch11lvl4sec16"></a>The EditorApplication callbacks</h4></div></div></div><p>The editor, like <a id="id1090" class="indexterm"></a>a lot of things in Unity, also<a id="id1091" class="indexterm"></a> comes adorned with several callbacks to mark when things happen. Exposed through the <code class="literal">EditorApplication</code> class, you can gain access to the following events:</p><div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; "><colgroup><col align="left" /><col align="left" /></colgroup><thead><tr><th style="border-bottom: 0.5pt solid ; " align="left" valign="bottom">
<p>Event/delegate</p>
</th><th style="border-bottom: 0.5pt solid ; " align="left" valign="bottom">
<p>Description</p>
</th></tr></thead><tbody><tr><td style="" align="left" valign="top">
<p><code class="literal">Update</code></p>
</td><td style="" align="left" valign="top">
<p>This <a id="id1092" class="indexterm"></a>event is called every time the editor window is updated or refreshed. Note that this is more often that the game or scene update calls.</p>
</td></tr><tr><td style="" align="left" valign="top">
<p><code class="literal">projectWindowItemOnGUI</code></p>
</td><td style="" align="left" valign="top">
<p>This <a id="id1093" class="indexterm"></a>event is called for each project item in view of the <span class="strong"><strong>Project</strong></span> window when it is drawn to the screen.</p>
</td></tr><tr><td style="" align="left" valign="top">
<p><code class="literal">hierarchyWindowItemOnGUI</code></p>
</td><td style="" align="left" valign="top">
<p>This<a id="id1094" class="indexterm"></a> event is called for each item in the <span class="strong"><strong>Hierarchy</strong></span> window when it is drawn to the screen.</p>
</td></tr><tr><td style="" align="left" valign="top">
<p><code class="literal">projectWindowChanged</code></p>
</td><td style="" align="left" valign="top">
<p>This <a id="id1095" class="indexterm"></a>event is called whenever an item is changed in the <span class="strong"><strong>Project</strong></span> window.</p>
</td></tr><tr><td style="" align="left" valign="top">
<p><code class="literal">hierarchyWindowChanged</code></p>
</td><td style="" align="left" valign="top">
<p>This<a id="id1096" class="indexterm"></a> event is called whenever an item is changed in the <span class="strong"><strong>Hierarchy</strong></span> window.</p>
</td></tr><tr><td style="" align="left" valign="top">
<p><code class="literal">playmodeStateChanged</code></p>
</td><td style="" align="left" valign="top">
<p>This <a id="id1097" class="indexterm"></a>event is called when you start or stop the game in the editor.</p>
</td></tr><tr><td style="" align="left" valign="top">
<p><code class="literal">searchChanged</code></p>
</td><td style="" align="left" valign="top">
<p>This <a id="id1098" class="indexterm"></a>event is called whenever the search criteria is changed in any <span class="strong"><strong>Editor</strong></span> window.</p>
</td></tr><tr><td style="" align="left" valign="top">
<p><code class="literal">modifierKeysChanged</code></p>
</td><td style="" align="left" valign="top">
<p>This <a id="id1099" class="indexterm"></a>event is used to track when a modifier key (<span class="emphasis"><em>Alt</em></span>, <span class="emphasis"><em>cmd</em></span>, <span class="emphasis"><em>Ctrl</em></span>, and so on) is pressed. So, you need to change a view when a modifier key is pressed, and you need to watch for this event/delegate.</p>
</td></tr></tbody></table></div><p>These<a id="id1100" class="indexterm"></a> events can be added to any class/script in your <code class="literal">Editor</code> project folder, so you can hook up a functionality to run when <a id="id1101" class="indexterm"></a>these events occur using the following syntax. For example, let's employ the following methods in an editor script to fire whenever we change the project's hierarchy:</p><div class="informalexample"><pre class="programlisting">void OnEnable()
{
    // Event / delegate registration, usually put in the OnEnable 
    //or other function
    EditorApplication.hierarchyWindowChanged += HierarchyWindowChanged;
}

//callback function for when event occurs
void HierarchyWindowChanged()
{
    //Scan hierarchy for new items
    //If found add something to the editor window
}
 
void OnDestroy()
{
    // Don't forget to unregister the delegate when it goes out of 
    //scope or is not needed
    EditorApplication.hierarchyWindowChanged -= HierarchyWindowChanged;
}</pre></div><p>This <a id="id1102" class="indexterm"></a>gives your editor scripts the ability <a id="id1103" class="indexterm"></a>to react to whatever the editor does by attaching to the <code class="literal">hierarchyWindowChanged</code> event when the script is enabled (making sure to unattach it when the script is disabled).</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch11lvl4sec17"></a>Mixing it up</h4></div></div></div><p>In more <a id="id1104" class="indexterm"></a>advanced cases, you can build a framework that combines with the previous approaches effectively to create a complete editor manager. This needs to be implemented in a class with a static constructor so that it is initialized as soon as the editor starts.</p><p>To demonstrate this, let's create a simple script that will save the scene for us when we hit the play button. First, create a new script called <code class="literal">SaveSceneOnPlay</code> in <code class="literal">Assets\Scripts\Editor</code> and replace its contents with the following code:</p><div class="informalexample"><pre class="programlisting">using UnityEditor;
using UnityEngine;
[InitializeOnLoad]
public class SaveSceneOnPlay
{
    // Static class constructor, 
    // this is initialized as soon as Unity Starts
    static SaveSceneOnPlay()
    {
 
    }
}</pre></div><p>This gives us the framework for an <code class="literal">[InitializeOnLoad]</code> script that will run when Unity starts. Then, we add our static function to do the work of saving the scene:</p><div class="informalexample"><pre class="programlisting">static void SaveSceneIfPlaying()
{
 
    if (EditorApplication.isPlayingOrWillChangePlaymode &amp;&amp; 
      !EditorApplication.isPlaying)
    {
 
        Debug.Log("Automatically saving scene (" + 
          EditorApplication.currentScene + 
            ") before entering play mode ");
 
        EditorApplication.SaveAssets();
        EditorApplication.SaveScene();
    }
}</pre></div><p>This <a id="id1105" class="indexterm"></a>method checks whether the editor is about to change the play state and is not being played currently; if this is the case, then it saves the current changed assets and the current scene.</p><p>Next, we hook up this function with the <code class="literal">playmodeStateChanged</code> event delegate in the static constructor as follows:</p><div class="informalexample"><pre class="programlisting">static SaveSceneOnPlay()
{
<span class="strong"><strong>    EditorApplication.playmodeStateChanged += SaveSceneIfPlaying;</strong></span>
}</pre></div><p>Now, with this script in our project, whenever we hit play, the script will automatically save the project for us.</p></div></div></div>