<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch02lvl1sec17"></a>Putting it together</h2></div></div><hr /></div><p>So now that we have understood how to import our 2D assets into our project and how the sprite system works, let's look at building our game with it.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip09"></a>Tip</h3><p><span class="strong"><strong>Downloading the example code</strong></span></p><p>You can download the example code files for all Packt books you have purchased from your account at <a class="ulink" href="http://www.packtpub.com" target="_blank">http://www.packtpub.com</a>. If you purchased this book elsewhere, you can visit <a class="ulink" href="http://www.packtpub.com/support" target="_blank">http://www.packtpub.com/support</a> and register to have the files e-mailed directly to you.</p></div><p>I'm going to talk about the usual thought process that is used to build such systems and highlight issues that you might commonly face and how to resolve them, rather than just pointing out fingers and saying do this and that.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note15"></a>Note</h3><p>The lessons learned in the <span class="emphasis"><em>Classes</em></span> section are very important lessons to learn early on as we are just starting out with the 2D features. We won't use them just yet but refer to this again when we hit <a class="link" href="#" linkend="ch05">Chapter 5</a>, <span class="emphasis"><em>NPCs and Interactions</em></span>, and start implementing them fully.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec23"></a>Importing our main character</h3></div></div></div><p>So with what<a id="id196" class="indexterm"></a> we have learned, let us get our main character imported into our game.</p><p>Select the image titled <code class="literal">01.png</code> from the <code class="literal">01_characters</code> folder under <code class="literal">FANTASY_PACK</code> from the free game art pack, then drag it to the <code class="literal">Characters</code> folder under <code class="literal">Assets\Sprites\</code> in your Unity project, as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781849697347/graphics/7347OT_02_25.jpg" /></div><p>Next, as our image <a id="id197" class="indexterm"></a>contains all the frames of the sprite's animation for our main character, we need to break it up. So select the image from the project view and change <span class="strong"><strong>Sprite Mode</strong></span> in the <span class="strong"><strong>Inspector</strong></span> to <span class="strong"><strong>Multiple</strong></span>, as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781849697347/graphics/7347OT_02_26.jpg" /></div><p>You should now <a id="id198" class="indexterm"></a>see that the <span class="strong"><strong>Sprite Editor</strong></span> button is now enabled; click on it to bring up the <span class="strong"><strong>Sprite Editor</strong></span> window, as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781849697347/graphics/7347OT_02_27.jpg" /></div><p>To carve up our sprites, change the slicing options to <code class="literal">Grid</code> and enter a width of <code class="literal">95</code> and a height of <code class="literal">128</code>; then, click on <span class="strong"><strong>Slice</strong></span>, as shown in the preceding screenshot. Leave the <span class="strong"><strong>Pivot</strong></span> point as <code class="literal">Bottom</code>.</p><p>Now, click on <span class="strong"><strong>Apply</strong></span> and close Sprite Editor. Upon returning to the project view, you should now see an<a id="id199" class="indexterm"></a> arrow symbol next to the image asset we imported; clicking on it will show you all the individual sprites that were identified, excluding any blank spaces on the sheet as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781849697347/graphics/7347OT_02_28.jpg" /></div><p>Now that we have our <a id="id200" class="indexterm"></a>character in our project and it is properly imported, let's put our hero into the scene.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec24"></a>The hero</h3></div></div></div><p>Earlier, we imported our hero character's spritesheet into our project and carved up the sprites from that sheet to<a id="id201" class="indexterm"></a> ensure they are ready to use. So, let's first just get him or her into the play area.</p><p>As with most things in Unity, there are two ways in which we can do this; first, we'll do this manually and then show you a shortcut route. The following steps describe the manual procedure:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Create an empty game object in our game's hierarchy for our hero (by navigating to <span class="strong"><strong>GameObject</strong></span> | <span class="strong"><strong>Create Empty</strong></span> in the menu) and name it <code class="literal">Player</code>.</p></li><li><p>Add a sprite renderer component to the player's game object by navigating to <span class="strong"><strong>Add Component</strong></span> | <span class="strong"><strong>Rendering</strong></span> | <span class="strong"><strong>Sprite Renderer</strong></span>.</p></li><li><p>Expand the <code class="literal">01</code> asset in the <code class="literal">Sprite</code> folder so that you can see all the sprites in that spritesheet.</p></li><li><p>Drag the sprite named <code class="literal">01_5</code> (the idle sprite) to the <code class="literal">Sprite</code> parameter of the sprite renderer on the player's game object.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note16"></a>Note</h3><p>Be sure to set your transform values for the new game object to <code class="literal">0</code> or it will create issues later with the animation. Always define animations with objects set at the center to avoid confusion; you can always move/place them later.</p></div></li></ol></div><p>You should now have the same screen as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781849697347/graphics/7347OT_02_29.jpg" /></div><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip10"></a>Tip</h3><p>Alternatively, you<a id="id202" class="indexterm"></a> can just drag the individual sprite on to the project hierarchy to achieve the same effect.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec25"></a>Controlling the hero</h3></div></div></div><p>A sprite that only<a id="id203" class="indexterm"></a> stands on the screen isn't going to make much of a game, so we'll add a script to allow the player to move the hero to the left or right.</p><p>First, we'll add the physics component to control the movements related to our hero; we don't need anything heavy, just a rigidbody so that we won't pass through other objects in the world and a collider so that we know when we bump into things:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Add a <code class="literal">Rigidbody2D</code> component by navigating to <span class="strong"><strong>Add Component</strong></span> | <span class="strong"><strong>Physics2D</strong></span> | <span class="strong"><strong>Rigidbody 2D</strong></span> in the player's <code class="literal">GameObject</code> inspector.</p></li><li><p>Set the <span class="strong"><strong>Gravity Scale</strong></span> parameter to <code class="literal">0</code> (as we are not using gravity), and check the <span class="strong"><strong>Fixed Angle</strong></span> checkbox (as we want the player to always remain in the standing position).</p></li><li><p>Next, add a <code class="literal">BoxCollider2D</code> component by navigating to <span class="strong"><strong>Add Component</strong></span> | <span class="strong"><strong>Physics2D</strong></span> | <span class="strong"><strong>Box Collider 2D</strong></span>, and scale down the <span class="strong"><strong>Size X</strong></span> parameter to <code class="literal">0.41</code> (just to narrow the collision box to the width of the hero).</p></li></ol></div><p>This should give you the<a id="id204" class="indexterm"></a> following view in the inspector:</p><div class="mediaobject"><img src="/graphics/9781849697347/graphics/7347OT_02_30.jpg" /></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note17"></a>Note</h3><p>As we are only setting up the basic physics and collisions, we won't be using the full range of <code class="literal">Rigidbody 2D</code> settings. For <a id="id205" class="indexterm"></a>more details on what the rest of the <code class="literal">Rigidbody 2D</code> properties do, check the Unity Rigidbody<a id="id206" class="indexterm"></a> video at <a class="ulink" href="https://www.youtube.com/watch?v=rq6c2B_socs" target="_blank">https://www.youtube.com/watch?v=rq6c2B_socs</a>.</p></div><p>To finish off this chapter, add a new C# script to the <code class="literal">Scripts</code> folder by navigating to <span class="strong"><strong>Create</strong></span> | <span class="strong"><strong>C# script</strong></span> in the<a id="id207" class="indexterm"></a> project window and saving it as <code class="literal">Assets\Scripts\ CharacterMovement.cs</code>. Open the script in the editor and replace its contents with the following script:</p><div class="informalexample"><pre class="programlisting">using UnityEngine;

public class CharacterMovement : MonoBehaviour
{
  // RigidBody component instance for the player
  private Rigidbody2D playerRigidBody2D;

 //Variable to track how much movement is needed from input
  private float movePlayerVector;

  // For determining which way the player is currently facing.
  private bool facingRight;

  // Speed modifier for player movement
  public float speed = 4.0f;

  //Initialize any component references
  void Awake()
  {
    playerRigidBody2D = (Rigidbody2D)GetComponent(typeof(Rigidbody2D));
  }

  // Update is called once per frame
  void Update () {
    // Get the horizontal input.
    movePlayerVector = Input.GetAxis("Horizontal");

    playerRigidBody2D.velocity = new Vector2(movePlayerVector * speed, playerRigidBody2D.velocity.y);

    if (movePlayerVector &gt; 0 &amp;&amp; !facingRight)
    {
      Flip();
    }
    else if (movePlayerVector &lt; 0 &amp;&amp; facingRight)
    {
      Flip();
   }
  }

  void Flip()
  {
    // Switch the way the player is labeled as facing.
    facingRight = !facingRight;

    // Multiply the player's x local scale by -1.
    Vector3 theScale = transform.localScale;
    theScale.x *= -1;
    transform.localScale = theScale;
  }
}</pre></div><p>The script is fairly basic; it simply has some parameters to control the speed and its facing direction. The <code class="literal">update</code> method checks if the player is controlling the game using the default horizontal keys (left and right) and then applies force to move the hero accordingly. Finally, we <a id="id208" class="indexterm"></a>check which way the hero is facing, and based on the direction the player has pressed, it will flip the sprite to face the correct direction.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip11"></a>Tip</h3><p>The <code class="literal">scale</code> parameters are a common way to swap which way a sprite is drawn toward. This means you don't need sprites for every single angle of your game; you can just flip or rotate them.</p></div><p>To finish off, add the script to the player's game object by either dragging it to the object in the hierarchy or navigating to <span class="strong"><strong>Add Component</strong></span> | <span class="strong"><strong>Scripts</strong></span> | <span class="strong"><strong>Character Movement</strong></span>.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note18"></a>Note</h3><p>You should note that this very simple controller code only uses a keyboard input. For touch-only-based platforms such as iOS, WP8, and arguably Android, you would need to include touch controls or use the accelerometer.</p></div><p>If you run the project now, you should see our hero on the screen, and using the left and right arrows on the keyboard, we will move the player to the left or right.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note19"></a>Note</h3><p>An alternative approach to writing your own controller code is to make use of the built-in <code class="literal">Character controller</code> components<a id="id209" class="indexterm"></a> of Unity. These components help you reduce the amount of code you need to control a player's movements and also add other recommended components such as physics.</p><p>You should also<a id="id210" class="indexterm"></a> check out Unity's enhanced <span class="strong"><strong>Sample Assets Beta</strong></span>, which introduces a new true multiplatform singular control system complete with touch controls. Check out <a class="ulink" href="http://blogs.unity3d.com/2014/01/17/new-sample-assets-beta/" target="_blank">http://blogs.unity3d.com/2014/01/17/new-sample-assets-beta/</a> for more details.</p></div></div></div>