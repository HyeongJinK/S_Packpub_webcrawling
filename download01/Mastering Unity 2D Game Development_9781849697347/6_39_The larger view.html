<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch06lvl1sec40"></a>The larger view</h2></div></div><hr /></div><p>Our budding hero is now ready to pack his bags and leave the shelter of his hometown for the wider <a id="id458" class="indexterm"></a>world. So, we need to widen the scope of what the player can see and build a large map with places of interest to visit.</p><p>This usually opens the floodgates for just how big your game will be. Planning can decide whether your game will be a hit or feel just too short.</p><p>Maps in RPGs certainly aren't mandatory; several hit games just go from place to place with maybe an animation or cut scene to show movement. However, in the best cases, a map just opens up the scope of the game and gives the player an understanding of the world they are travelling in.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec68"></a>Types of maps</h3></div></div></div><p>When looking at what kind of map or world you are going to choose to connect the dots between places to visit or secret hideaways, there are a few paths you can take. Generally, there are two options:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p><span class="strong"><strong>Fixed</strong></span>: In<a id="id459" class="indexterm"></a> this option, images are usually drawn by an artist<a id="id460" class="indexterm"></a> and have extensive detail of the world surrounding the player or are blank, exposing places as the player travels to or discovers them.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Generated</strong></span>: In<a id="id461" class="indexterm"></a> this option, each run of the game <a id="id462" class="indexterm"></a>completely randomizes the places to go or events that will take place, with the focus being on unpredictability.</p></li></ul></div><p>Both the preceding options are perfectly valid and there's nothing to say; you need to focus on just one or the other, mix it up if you wish. Generally, the better the variety, the better the chances of the player being engaged in your game—it will entice them to explore and play more.</p><p>Another keen element is that it should support repeatability and replayability—let players return to existing locations and discover new things, and reuse what you have to the fullest.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch06lvl3sec42"></a>Fixed maps</h4></div></div></div><p>There are <a id="id463" class="indexterm"></a>many resources to get maps for your title if you don't have a dedicated artist and, in some ways, these also provide insight or creative juice for how you want your maps to look. The following map image is a good example of a high-quality paid map:</p><div class="mediaobject"><img src="/graphics/9781849697347/graphics/7347OT_06_01.jpg" /></div><p>The first <a id="id464" class="indexterm"></a>site to mention, primarily because it is also completely<a id="id465" class="indexterm"></a> free, is <a class="ulink" href="http://freefantasymaps.org/" target="_blank">http://freefantasymaps.org/</a>. The preceding screenshot is a prime example of the level of quality you can get from the site. Although the images on the site are free to use for any purpose, I would recommend you to use their images to donate to the running of the site so that they remain free.</p><p>Another<a id="id466" class="indexterm"></a> useful site is the <span class="strong"><strong>Cartographers' Guild</strong></span> at <a class="ulink" href="http://www.cartographersguild.com/" target="_blank">http://www.cartographersguild.com/</a>. This is a veritable map paradise with lots of content available for use in most projects. Unlike the preceding site, all works are protected and you will need to purchase them or gain rights to use them. However, they are of a very high quality.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip37"></a>Tip</h3><p>When browsing maps and art, <span class="emphasis"><em>always</em></span> be sure to check the license and usage policies of the images you download. This should be done  whenever you acquire art, even from Google. Be safe, check, and get permission.</p><p>The same can be said for code and any other kinds of assets. If in doubt, check the license and even if it's free, just check with the author whether they feel it's ok to use in your project.</p><p>Always check the license on anything you download and use.</p></div><p>Another<a id="id467" class="indexterm"></a> good feature of the Cartographers' Guild is that it allows you to request a map. They have an awesome request system and hundreds of artists are ready to commission anything your heart wants (see <a class="ulink" href="http://www.cartographersguild.com/mapmaking-requests/" target="_blank">http://www.cartographersguild.com/mapmaking-requests/</a>).</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch06lvl3sec43"></a>Generated maps</h4></div></div></div><p>There are <a id="id468" class="indexterm"></a>also many other resources out there to get maps for your game. Another method is to use an online map generation system. Now, to be fair, most are aimed at tabletop gamers and most are of a low quality, but there are a few gems to be found.</p><p>The one I used for the game we are building is from <a class="ulink" href="http://donjon.bin.sh/fantasy/world/" target="_blank">http://donjon.bin.sh/fantasy/world/</a>, because I like it and it provides fairly high-resolution generated images and includes world features and places. It looks like a nice place to have a holiday (if you are an Orc). The following image is the map I've used in the sample project with lots of interesting places to see and explore:</p><div class="mediaobject"><img src="/graphics/9781849697347/graphics/7347OT_06_02_New.jpg" /></div><p>As you can<a id="id469" class="indexterm"></a> see, there is a lot of detail here and a very large world for the player to explore.</p><p>DonJon's site also offers a vast array of other generators to build maps and other RPG elements. There are even name and game dialogue generators, so it really does meet most RPG needs.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h5 class="title"><a id="ch06lvl4sec10"></a>In-game generated maps</h5></div></div></div><p>Now, if you <a id="id470" class="indexterm"></a>want more control over what the player <a id="id471" class="indexterm"></a>sees or will have in their game, you can go all the way and start building maps and more through either Unity's asset pipeline or in-code within the game.</p><p>External tools<a id="id472" class="indexterm"></a> such as <span class="strong"><strong>Tiled</strong></span> (<a class="ulink" href="http://www.mapeditor.org/" target="_blank">http://www.mapeditor.org/</a>), which is shown in the following image, can be used to build and design maps. It has many interesting features and can even output several layers. You can also use either top-down, 2D side scrolling, or even isometric maps.</p><div class="mediaobject"><img src="/graphics/9781849697347/graphics/7347OT_06_04.jpg" /></div><p>A great Unity<a id="id473" class="indexterm"></a> example of this is a project called <code class="literal">uTiled</code> (<a class="ulink" href="https://bitbucket.org/vinull/utiled" target="_blank">https://bitbucket.org/vinull/utiled</a>), which provides a Unity asset that can read maps<a id="id474" class="indexterm"></a> from Tiled. Here, the author has customized a<a id="id475" class="indexterm"></a> map generation system that uses an external tool to build maps according to a predefined set of map tiles, which are just small textures used when building the map.</p><p>The following image is a simple example of what can be achieved with Tiled editor that generates the maps:</p><div class="mediaobject"><img src="/graphics/9781849697347/graphics/7347OT_06_03_New.jpg" /></div><p>The project is<a id="id476" class="indexterm"></a> a great example of not just how to import <a id="id477" class="indexterm"></a>a 2D-based tile map system into Unity, but also how to construct and run these 2D maps in your game.</p><p>Using a system like <code class="literal">uTiled</code>, you can either build a selection of maps in Tiled for use as world maps in your game, or even full 2D scenes.</p><p>Alternatively, you could use procedural techniques (see the <span class="emphasis"><em>Going procedural</em></span> section) to build the map while the game is running, using the framework to knit individual segments of your map together. We will discuss this more later.</p></div></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec69"></a>2D doesn't mean you have to use only 2D</h3></div></div></div><p>Just because<a id="id478" class="indexterm"></a> the rest of your game is 2D, it doesn't mean you have to<a id="id479" class="indexterm"></a> use 2D. Some of the best games I've seen use a mixture of 2D and 3D, and Unity will help you there because it's not limited.</p><p>Whether you have 2D play areas and 3D terrain for maps, or 3D villages and a 2D map, it doesn't really matter. Just go with whatever you are comfortable with or what fits with the aesthetic of your game.</p><p>Thanks to<a id="id480" class="indexterm"></a> the way 2D is implemented in Unity, you can even mix it up by <a id="id481" class="indexterm"></a>having 3D elements placed and animated in your 2D scene either as background elements or interactive components.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note63"></a>Note</h3><p><span class="strong"><strong>A word to the wise</strong></span></p><p>Although you can mix the 2D and 3D rendering in a single scene, you cannot mix the 2D and 3D physics. This is simply because they are separate engines and have no connection to each other. Keep this in mind depending on what you are trying to build in your game.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec70"></a>Going procedural</h3></div></div></div><p>If you are the bold or adventurous sort, another route to flesh out your world is to procedurally <a id="id482" class="indexterm"></a>generate it. What you usually see when you look for procedural generation in Unity are dungeon generators. In fact, some of the best examples I've seen out there involve randomly generated dungeons where every run of the game is different from the last. Other examples are usually found in endless running games where a style of procedural selection is done to choose the next running area or to put random scene items in.</p><p>When we try to apply this to RPG games, we want to balance the fixed part of the world/story we are looking to convey with a more random placement of towns/villages or places of interest. This will make the world we see different for every player but still convey the background of the theme.</p><p>Now, the whole subject of procedural generation is far too large to go into for this book, but I can give you a few points for where to look.</p><p>The best <a id="id483" class="indexterm"></a>place to start is the <span class="strong"><strong>Procedural Content Generation Wiki</strong></span> available at <a class="ulink" href="http://pcg.wikidot.com/" target="_blank">http://pcg.wikidot.com/</a>; it's the go-to place to start learning the following general techniques:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p><span class="strong"><strong>Iterated function systems</strong></span>: These <a id="id484" class="indexterm"></a>are fractals to create land masses or structured <a id="id485" class="indexterm"></a>areas</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>L-systems</strong></span>: These <a id="id486" class="indexterm"></a>are <a id="id487" class="indexterm"></a>used for roads or path generation</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Diamond-square and midpoint displacement algorithms</strong></span>: These<a id="id488" class="indexterm"></a> are used<a id="id489" class="indexterm"></a> to<a id="id490" class="indexterm"></a> create random height<a id="id491" class="indexterm"></a> terrains</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Perlin and simplex noise system</strong></span>s: These <a id="id492" class="indexterm"></a>are <a id="id493" class="indexterm"></a>used to add further randomness<a id="id494" class="indexterm"></a> to <a id="id495" class="indexterm"></a>the generation</p></li></ul></div><p><a class="ulink" href="http://Reddit.com" target="_blank">Reddit.com</a> is also a<a id="id496" class="indexterm"></a> great place for examples, questions, and <a id="id497" class="indexterm"></a>queries on procedural generation. Two of the best reddits are as follows:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p><a class="ulink" href="http://www.reddit.com/r/proceduralgeneration" target="_blank">http://www.reddit.com/r/proceduralgeneration</a> (this is the main procedural <a id="id498" class="indexterm"></a>generation reddit. Although it's mostly promotional these days, there are still a lot of older posts with samples and information. It's also a good place to start with questions.)</p></li><li style="list-style-type: disc"><p><a class="ulink" href="http://www.reddit.com/r/worldbuilding" target="_blank">http://www.reddit.com/r/worldbuilding</a> (this is a good source of information for this section on maps for your game. It is mainly related to D&amp;D, but it does contain a lot of useful information.)</p></li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note64"></a>Note</h3><p><span class="strong"><strong>A word to the wise</strong></span></p><p>Procedural generation is not for the faint of heart, there is a lot of math involved and a lot of trial and error. However, if you can master small parts, you can achieve a truly wondrous game with lots of replayability.</p><p>Procedural generation is too large a subject for this book. Hopefully, I've given you a few tips and tidbits to get you going, so you know what to look for should you want to venture down this road.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec71"></a>Screen space and world space</h3></div></div></div><p>When dealing with either touch or mouse input, we have to recognize that coordinates managed by Unity are in <span class="strong"><strong>screen space</strong></span> and not <span class="strong"><strong>world space</strong></span>. Both of these terms are defined as follows:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p><span class="strong"><strong>Screen space</strong></span>: This<a id="id499" class="indexterm"></a> refers to coordinates relative to the screen / display area, starting at the top-left corner of the screen</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>World space</strong></span>: This <a id="id500" class="indexterm"></a>refers to the coordinates that are used inside the Unity engine</p></li></ul></div><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip38"></a>Tip</h3><p>The starting position, (0, 0) 2D coordinate, for the mouse can be different depending on how you access it:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>If you use <code class="literal">Input.mousePosition</code>, then (0, 0) is in the top-left corner of the screen</p></li><li style="list-style-type: disc"><p>If, however, you use <code class="literal">Event.current.mousePosition</code>, then (0, 0) is in the bottom-left corner of the screen</p></li></ul></div><p>For touch, however, it is always in the the top-left corner of the screen. This is something to keep in mind when you access input—always check.</p></div><p>When you poll for the mouse position (which can only be one mouse), use the following line of code:</p><div class="informalexample"><pre class="programlisting">Input.mousePosition</pre></div><p>When we are looking at touch points (which can be many), we use the following line of code:</p><div class="informalexample"><pre class="programlisting">Input.GetTouch(&lt;touch index&gt;).position</pre></div><p>However, because the position we get back is always in screen space, we need to convert it to world space when checking it against objects in the game world. Thankfully, this is very simple to do using the following built-in Unity function:</p><div class="informalexample"><pre class="programlisting">Camera.main.ScreenToWorldPoint(&lt;screenCoordinate&gt;)</pre></div><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip40"></a>Tip</h3><p>The preceding default function uses the main camera to translate the coordinate from screen space to world space. If you are taking input from an alternate view (like a mini-map), be sure to use the specific camera for that view to convert the value, or else you will get incorrect results.</p></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note65"></a>Note</h3><p>Remember that any coordinate you get back from the input system or used in world coordinates are always Vector3 coordinates. However, because this is a 2D game, we need coordinates in Vector2 coordinates, so you will need to convert the value you get back for any 2D functions such as colliders or 2D distance checking.</p></div></div></div>