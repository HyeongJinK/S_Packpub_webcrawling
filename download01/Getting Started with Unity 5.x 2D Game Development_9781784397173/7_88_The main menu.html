<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch07lvl1sec87"></a>The main menu</h2></div></div><hr /></div><p>As in many games, there is a main menu when the game starts, and so, also, in our game we cannot forget a main menu. This will give us the possibility to explore a bit more of what we have touched upon in <a class="link" href="#" linkend="ch01">Chapter 1</a>, <span class="emphasis"><em>A Flat World in Unity</em></span>, about changing scenes in Unity.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec104"></a>Designing the main menu</h3></div></div></div><p>As we learnt back in <a class="link" href="#" linkend="ch03">Chapter 3</a>, <span class="emphasis"><em>Communicating with the Player – the User Interface</em></span>, it's good practice to have a design of the user interface, and the main menu is an extension of the user interface. As such, it should be designed with the same principles of UI design in mind.</p><p>The menu for our game is very simple: we have a cool background, and three buttons placed just below the center of the screen. They are respectively:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p><span class="strong"><strong>NEW GAME</strong></span>: Creates a new game for the player, by loading the level we have been creating so far</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>SETTINGS</strong></span>: Triggers a setting screen, where the player can manipulate some options (this is left as an exercise, in the <span class="emphasis"><em>Homework</em></span> section)</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>QUIT</strong></span>: As the name suggests, it closes the game</p></li></ul></div><p>So, our design will look something like the following:</p><div class="mediaobject"><img src="/graphics/9781784397173/graphics/B03794_07_13.jpg" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec105"></a>Creating the main menu in another scene</h3></div></div></div><p>To create another scene in Unity, you can select <span class="strong"><strong>File</strong></span> | <span class="strong"><strong>New Scene</strong></span> from the top bar, but it's preferable to navigate in the <span class="strong"><strong>Project</strong></span> panel within the <code class="literal">Scene</code> folder so that by right-clicking you can select <span class="strong"><strong>Create |
</strong></span>
<span class="strong"><strong> Scene</strong></span>. In this second way, the scene will be directly created within the right folder; as a result, your project is ordered and tidy.</p><p>You can name the scene <code class="literal">Main Menu</code>, and then double-click to open it. And here from scratch again, there is an empty void to fill up with your creativity and fantasies!</p><p>Now, you should have the skills to do the following without a step-by-step explanation:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Create a UI image (which will automatically generate a <span class="strong"><strong>Canvas</strong></span> as well as the <span class="strong"><strong>Event System</strong></span>), and name it <code class="literal">Background</code>. Then, extend it to the whole screen, and place the cool background you have in mind.</p></li><li><p>Tweak the canvas settings if you need to achieve what you have in mind.</p></li><li><p>Create three buttons, change their graphics if you want, and their texts so to match <span class="strong"><strong>NEW GAME</strong></span>, <span class="strong"><strong>SETTINGS</strong></span>, and <span class="strong"><strong>QUIT</strong></span> respectively. Place them, as in the design of the previous section.</p></li><li><p>Create an empty GameObject where we will attach a script to handle all the different interactions.</p></li><li><p>On the three buttons, add an <code class="literal">OnClick()</code> event and drag the new empty object into the <code class="literal">object</code> variable</p></li></ol></div><p>Once the menu is created, we can save the scene.</p><p>Since we have two scenes, if we want to include them in the final version of the game, we need to include them in the <span class="strong"><strong>Scenes In Build</strong></span>. To do so, we need to open the building settings from the top bar menu by clicking on <span class="strong"><strong>File</strong></span> |<span class="strong"><strong> Building Settings… </strong></span>. You can drag and drop the scene in the <span class="strong"><strong>Scenes In Build</strong></span> area from your <span class="strong"><strong>Project</strong></span> panel, and they will appear there in a determined order. The numbers you see next to the scenes are the identifiers of the scene. For instance, we can use this identifier to specify which scene to load.</p><p>In our case, be sure that the <code class="literal">Main Menu</code> scene is before our <code class="literal">Level_01</code>, as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781784397173/graphics/B03794_07_14.jpg" /></div><p>Now, it's time to create the script with all the functionalities.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec106"></a>Loading scenes through scripts</h3></div></div></div><p>Create a new script and call it <code class="literal">MainMenuFunctionalities</code>. Since its functions will be triggered by the <code class="literal">OnClick()</code> event, we need to make them public.</p><p>In particular, we have a function for loading the level of our game. If you remember, its ID is <code class="literal">1</code>. To load a scene in Unity, you use a special class called <code class="literal">SceneManager</code>. As such, we need to import its library by adding the following line of code at the beginning of our script:</p><pre class="programlisting">using UnityEngine.SceneManagement; &#13;
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note106"></a>Note</h3><p>The <code class="literal">SceneManager</code> class along with the <code class="literal">UnityEngine.SceneManagement</code> library are relatively new in Unity. In fact, these allow you to perform many actions on scenes, such as loading them together, loading them dynamically, and unloading them, all at runtime. This gives you a new universe of possibilities, which I hope you will have chance to explore, since in this book we don't have time to go through everything in detail. In any case, a good starting point is, as usual, the official documentation that you can find here: <a class="ulink" href="https://docs.unity3d.com/ScriptReference/SceneManagement.SceneManager.html" target="_blank">https://docs.unity3d.com/ScriptReference/SceneManagement.SceneManager.html</a>.</p><p>For the more curious of you, before the <code class="literal">SceneManager</code> class, scenes were handled by the <code class="literal">Application</code> class. So, in case you have some outdated code, which still uses the <code class="literal">Application</code> class to load scenes, you know that it was written for previous versions of Unity. If that code belongs to your project, consider (if possible, due to legal issues) to update it using the <code class="literal">SceneManager</code> class.</p></div><p>The most common function of the <code class="literal">SceneManager</code> class is <code class="literal">LoadScene()</code>, which can load another scene. One way to specify the scene is with its identifier (as we will do in our script), but there are also other ways, such as with a string containing the name of the scene.</p><p>We can implement the function that will be called by the <span class="strong"><strong>NEW GAME</strong></span> button in the following way, which is really simple and straight forward:</p><pre class="programlisting">
<span class="emphasis"><em>//Function that loads the first level</em></span> &#13;
public void NewGame() { &#13;
  SceneManager.LoadScene(1); &#13;
} &#13;
</pre><p>The function related to the <span class="strong"><strong>SETTINGS</strong></span> button, instead, is left as an exercise (see<span class="emphasis"><em> Homework </em></span>section):</p><pre class="programlisting">
<span class="emphasis"><em>//Function that displays the settings</em></span> &#13;
public void Settings() { &#13;
 <span class="emphasis"><em> //Your own code here</em></span> &#13;
} &#13;
</pre><p>Finally, the function to quit the game uses the <code class="literal">Application</code> class (more on this class in the official documentation here: <a class="ulink" href="https://docs.unity3d.com/ScriptReference/Application.html" target="_blank">https://docs.unity3d.com/ScriptReference/Application.html</a>), where there is a specific function to quit your game:</p><pre class="programlisting">
<span class="emphasis"><em>//Function that closes the game</em></span> &#13;
public void Quit() { &#13;
  Application.Quit(); &#13;
} &#13;
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note107"></a>Note</h3><p>Keep in mind that this function doesn't work in some circumstances, such as when the game is running in the editor (in Unity itself), or for instance, for web-based games. As such, closing a game that should be shipped on different platforms might require more work. More about multi-platform games in the next chapter.</p></div><p>Save the script, and come back to the <code class="literal">OnClick()</code> events on the three buttons.</p><p>Assign the correct function to each of them. Here is the example of how the <span class="strong"><strong>NEW GAME</strong></span> button event should look:</p><div class="mediaobject"><img src="/graphics/9781784397173/graphics/B03794_07_15.jpg" /></div><p>And also, the main menu has been implemented. With this, our game is basically completed and functioning. Let's recap what we have done and learnt so far in the next section.</p></div></div>