<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch05lvl1sec59"></a>Colliders</h2></div></div><hr /></div><p>Imagine that you have the heroine of your game moving in a complex environment; by complex, I mean detailed, for instance, the kitchen of the king's castle. If the Physics engine is super realistic, it should take in consideration that the hand of the heroine can go over the table, as far as the body stays on its side. However, this is impossible (or at least out of reach for the current hardware of your players) to run in real time. So colliders provide an approximate shape for objects and characters that need to have some kind of physical interaction, such as a collision. For instance, characters are often approximated as a capsule-shaped collider and objects with a sphere-shaped or box-shaped collider. Of course, if a deeper level of detail is required, different colliders can act as a more complex one. And ultimately, all the polygons of the 3D model (or perimeter of the 2D Sprite) can be part of the collider, having a much better realism but at the cost of performance. Therefore, you'll want to be careful to always have the right level of detail for each situation.</p><p>In Unity, colliders can be of five types, which are:</p><div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; "><colgroup><col /><col /><col /></colgroup><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
<p><span class="strong"><strong>Name</strong></span></p>
</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
<p><span class="strong"><strong>Appearance in the <span class="strong"><strong>Inspector</strong></span>
</strong></span></p>
</td><td style="border-bottom: 0.5pt solid ; ">
<p><span class="strong"><strong>Description</strong></span></p>
</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
<p><span class="strong"><strong>Circle Collider 2D</strong></span></p>
</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
<div class="mediaobject"><img src="/graphics/9781784397173/graphics/B03794_05_20a.jpg" /></div>
</td><td style="border-bottom: 0.5pt solid ; ">
<p>The collider's shape is a circle, which is defined by a position and a radius expressed in the local coordinate.</p>
</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
<p><span class="strong"><strong>Box Collider 2D</strong></span></p>
</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
<div class="mediaobject"><img src="/graphics/9781784397173/graphics/B03794_05_20b.jpg" /></div>
</td><td style="border-bottom: 0.5pt solid ; ">
<p>The collider's shape is a rectangle aligned to the world axis (<span class="emphasis"><em>x</em></span> and <span class="emphasis"><em>y</em></span>), and it is defined with a width and a height in the local coordinate.</p>
</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
<p><span class="strong"><strong>Polygon Collider 2D</strong></span></p>
</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
<div class="mediaobject"><img src="/graphics/9781784397173/graphics/B03794_05_20c.jpg" /></div>
</td><td style="border-bottom: 0.5pt solid ; ">
<p>The collider's shape is defined by a freeform edge made of line segments. In this way, you can adjust it to fit the shape of the Sprite graphic with great precision. Please note that this collider's edge must completely enclose an area (unlike <span class="strong"><strong>Edge Collider 2D</strong></span>).</p>
</td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
<p><span class="strong"><strong>Edge Collider 2D</strong></span></p>
</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; ">
<div class="mediaobject"><img src="/graphics/9781784397173/graphics/B03794_05_20d.jpg" /></div>
</td><td style="border-bottom: 0.5pt solid ; ">
<p>The collider's shape is defined by a freeform edge made of line segments. In this way, you can adjust it to fit the shape of the Sprite graphic with great precision. Unlike the <span class="strong"><strong>Polygon Collider 2D</strong></span>, its edge does not necessarily enclose an area. For instance, it's possible to create an <span class="emphasis"><em>N</em></span> shape or just a straight line.</p>
</td></tr><tr><td style="border-right: 0.5pt solid ; ">
<p><span class="strong"><strong>Capsule Collider 2D</strong></span></p>
</td><td style="border-right: 0.5pt solid ; ">
<div class="mediaobject"><img src="/graphics/9781784397173/graphics/B03794_05_20e.jpg" /></div>
</td><td style="">
<p>The collider's shape is a capsule without vertexes (so that it is hard it remains stuck between vertexes or corners of other colliders). Moreover, it's a solid collider, so if an object is completely inside this collider, it is pushed out and detected as colliding.</p>
</td></tr></tbody></table></div><p>All of them share the same core settings, and some additional ones to customize the shape of the collider. For instance, for <span class="strong"><strong>Circle Collider 2D</strong></span>, we can decide the center and the radius. However, Unity automatically tries to enclose/envelop the Sprite or 3D model within the collider, though manual tweaking may be required (see further for editing the collider in a visual way).</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note69"></a>Note</h3><p>Since this book focuses on the 2D world, for brevity we will refer to the colliders without the ending 2D, assuming we are always referring to the 2D component and not to the 3D one with the same name. For example, <span class="strong"><strong>Box Collider 2D</strong></span> becomes <span class="strong"><strong>Box Collider</strong></span>.</p></div><p>Let's explore the core options of each collider:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p><span class="strong"><strong>Density</strong></span>: This affects the mass of the rigidbody that it is referring to. A value of zero means that the collider will be completely ignored in the calculation of the mass of the rigidbody. The higher the value, the more the collider will contribute to the mass of the rigidbody.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note70"></a>Note</h3><p>If you don't see the <span class="strong"><strong>Density</strong></span> option, it's normal. In fact, it will be visible only if the optionÂ <span class="strong"><strong>Auto Mass</strong></span> is enabled on the rigidbody associated (so attached on the same game object of the collider or on some of its parents up in the hierarchy). In fact, when the rigidbody component automatically calculates the mass, it takes into consideration all the colliders linked to that rigidbody and their densities.</p></div></li><li style="list-style-type: disc"><p><span class="strong"><strong>Material</strong></span>: A physics material that determines properties of collisions, such as friction and bounce (we will see more about physics materials later).</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Is Trigger</strong></span>: Check this if you want the collider to behave as a trigger. This means that the collider won't be used to do collisions but rather to trigger something when another collider enters within this one (see the next section for more details).</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Used By Effector</strong></span>: Check this if you want the collider to be used by an attached effector (we will see more about effectors later).</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Offset</strong></span>: This is the offset of the collider geometry expressed in local coordinates; in other words, how far in terms of <span class="emphasis"><em>x</em></span> and <span class="emphasis"><em>y</em></span> the collider should be from the position of the game object on which it is attached.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Info</strong></span>: A foldout showing all the other variables of the collider. It is very useful in debugging.</p></li></ul></div><p>Then, there are the specific ones for each collider:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p><span class="strong"><strong>Radius</strong></span>: Used only for the circle collider, and it determines the radius of the circle.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Size</strong></span>: This is used only for the box and the capsule collider. In the first case, it determines the size of the box, and in the second the size of the box that the capsule fills up (and therefore indirectly the size of the capsule) as shown in the following diagram:</p><div class="mediaobject"><img src="/graphics/9781784397173/graphics/image_05_022.jpg" /></div></li><li style="list-style-type: disc"><p><span class="strong"><strong>Points</strong></span>: This is non-editable information for the polygon or edge colliders about their complexity. It describes all the points of the collider and how they are connected in paths.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Direction</strong></span>: This is used only for capsule colliders and it can be set to be either <span class="strong"><strong>Vertical</strong></span> or <span class="strong"><strong>Horizontal</strong></span>. This controls which way round the capsule sets; specifically, it defines the positioning of the semi-circular end-caps.</p></li></ul></div><p>Furthermore, it is possible to visually edit the colliders by clicking on the following icon, available in all the colliders:</p><div class="mediaobject"><img src="/graphics/9781784397173/graphics/image_05_023.jpg" /></div><p>As a result, you will able to modify the collider directly into the <span class="strong"><strong>Scene</strong></span> view. It is quite intuitive, so I'll let you explore this feature by yourself.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip71"></a>Tip</h3><p>You can create a vertex for the edge or polygon colliders by clicking on one of their edges.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec63"></a>Dealing with colliders</h3></div></div></div><p>Often, in video games, when colliders collide, we want to trigger some actions and run specific code. For instance, imagine a bullet that hits the surface of the wall, we may want to instantiate a particle effect in the point, and remove the bullet. The same applies for a fireball, but with a fire effect. Or imagine the player walks through a door and a cut-scene is triggered. In this case, there is a volume trigger (a collider with <span class="strong"><strong>is Trigger</strong></span> set toÂ true) so that when the player enters, the volume triggers the cut-scene. Another example, is an area full of toxic gasses, and the longer the player stays in that area, his health is gradually reducing.</p><p>All of this can be achieved by using some special functions. If you remember, in <a class="link" href="#" linkend="ch02">Chapter 2</a>, <span class="emphasis"><em>BakingÂ Cupcake Tower</em></span>, we have seen that every script that derives from monobehaviour could have some functions, such as <code class="literal">Start()</code> and <code class="literal">Update()</code> that are automatically called by Unity. Among these functions there are some that are called by the Physics engine of Unity.</p><p>For trigger volumes, there are the following functions:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p><code class="literal">OnTriggerEnter2D(Collider2D other)</code>: This is called on both the rigidbody and the volume trigger when the former enters in the latter. Information about the other collider is passed as a parameter in the <code class="literal">other</code> variable.</p></li><li style="list-style-type: disc"><p><code class="literal">OnTriggerStay2D(Collider2D other)</code>: This is called on every frame on both the rigidbody and the volume trigger as long as the former is within the second one. Information about the other collider is passed as a parameter in the <code class="literal">other</code> variable.</p></li><li style="list-style-type: disc"><p><code class="literal">OnTriggerExit2D(Collider2D other)</code>: This is called on both the rigidbody and the trigger volume when the former leaves/exits the second one. Information about the other collider is passed as a parameter in the <code class="literal">other</code> variable.</p></li></ul></div><p>For colliders not set to be triggers, there are similar functions. However, instead of having just information about the other collider, information about the whole collision is available through the class <code class="literal">Collision2D</code>, which stores â other than the colliders â the contact points, relative velocities, and so on. More information about this can be found here in the official documentation at:Â <a class="ulink" href="https://docs.unity3d.com/ScriptReference/Collision2D.html" target="_blank">https://docs.unity3d.com/ScriptReference/Collision2D.html</a></p><p>So, the functions for colliders are:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p><code class="literal">OnCollisionEnter2D(Collision2D coll)</code>: This is called on both the rigidbodies/colliders that have just made contact (had a collision). Information about the collision can be found inside the <code class="literal">coll</code> variable.</p></li><li style="list-style-type: disc"><p><code class="literal">OnCollisionStay2D(Collision2D coll)</code>: This is called on both rigidbodies/colliders every frame as long as they are touching each other. Information about the collision can be found inside the <code class="literal">coll</code> variable.</p></li><li style="list-style-type: disc"><p><code class="literal">OnCollisionExit2D(Collision2D coll)</code>: This is called on both two rigidbodies/colliders when they stop making contact. Information about their collision can be found inside the <code class="literal">coll</code> variable.</p></li></ul></div><p>In our specific case, we will need these functions (the trigger ones) to detect when the sprinkles hit the enemies, to reduce their health, and eventually trigger the right animation. We will see this at the end of the chapter.</p></div></div>