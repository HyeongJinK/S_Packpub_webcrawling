<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch05lvl1sec36"></a>A Screen Space – Camera health bar</h2></div></div><hr /></div><p>Now let's move <a id="id545" class="indexterm"></a>on to building our UI. For this example, we will build a simple health chart for our fighter to track the shield and hull strength of our craft, as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783553617/graphics/3617OS_05_10.jpg" /><div class="caption"><p>A top slider bar in blue for shields and a green bottom slider for health</p></div></div><p>Using our assets, let's throw this little gem together.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec57"></a>What's in a Canvas?</h3></div></div></div><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip308"></a>Tip</h3><p>As a big tip, when <a id="id546" class="indexterm"></a>you are working on just building UI elements and with positioning on a UI Canvas, it's best to switch to <span class="strong"><strong>2D</strong></span> mode (using the 2D button at the top of the scene view). It just makes things a lot easier with the UI.</p><p>When you have finished working on the UI, feel free to flip back into 3D mode (tap the <span class="strong"><strong>2D</strong></span> button again) to continue working with a 3D scene.</p><p>Granted, if you are creating a 2D game, you may never leave the 2D mode.</p></div><p>Firstly, add a new <span class="strong"><strong>Canvas</strong></span> to the scene using <span class="strong"><strong>Create</strong></span> | <span class="strong"><strong>UI</strong></span> | <span class="strong"><strong>Canvas</strong></span> from the project <span class="strong"><strong>Hierarchy</strong></span> or <span class="strong"><strong>GameObject</strong></span> | <span class="strong"><strong>UI</strong></span> | <span class="strong"><strong>Canvas</strong></span> from the menu and then rename it to <code class="literal">ScreenSpaceCameraCanvas</code>.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note134"></a>Note</h3><p>We'll just use the project <span class="strong"><strong>Hierarchy</strong></span> from now on since you know where both the options are.</p></div><p>Now with the canvas in the <a id="id547" class="indexterm"></a>scene, update its <span class="strong"><strong>Canvas Render</strong></span> mode to <span class="strong"><strong>Screen Space – Camera</strong></span> and you should see the following view:</p><div class="mediaobject"><img src="/graphics/9781783553617/graphics/3617OS_05_11.jpg" /></div><p>There are a few things to note:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>The bottom left-hand corner of the <span class="strong"><strong>Canvas</strong></span> in the scene starts at the position of the topmost element in the project hierarchy, in this case, the fighter. Just an observation: the Canvas is not actually linked to it. It's still a <span class="strong"><strong>Screen Space - Camera</strong></span> Canvas so its position doesn't really matter.</p></li><li style="list-style-type: disc"><p>The size of the <span class="strong"><strong>Canvas</strong></span> will fluctuate based on the actual scene screen size. Resize the scene view and watch the width and height update. If you recall from the last chapter, this is something you need to watch out for, especially with multi-resolution support (supporting your game on different resolutions).</p></li><li style="list-style-type: disc"><p>The layer of the new <span class="strong"><strong>Canvas</strong></span> is automatically set to <span class="strong"><strong>UI</strong></span> by default. You can change this later if you wish. Remember this in your game if you are culling certain layers from <span class="strong"><strong>Camera</strong></span> views (just as the Camera for this Canvas will only draw the UI layer, but we'll come to that in a minute).</p></li><li style="list-style-type: disc"><p>A new <span class="strong"><strong>Render Camera</strong></span> option appears along with a <span class="strong"><strong>Plane Distance</strong></span> option, which we'll look at next.</p></li><li style="list-style-type: disc"><p>There is nothing to see here. This canvas has been left intentionally blank (mainly because you haven't added anything to it yet, of course). If you recall, in previous chapters, when you added a UI element to a scene, it will have created a <span class="strong"><strong>Canvas</strong></span> for you and then placed the new UI component on it. We have just created the Canvas itself, so it's brand new, yet to be unwrapped.</p></li><li style="list-style-type: disc"><p>An <span class="strong"><strong>EventSystem</strong></span> was also added to the scene but you should have expected this by now!</p></li></ul></div><p>Right! It's time to put <a id="id548" class="indexterm"></a>our health bar UI into action.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note135"></a>Note</h3><p>We won't be playing with the <span class="strong"><strong>Canvas Scaler</strong></span> in this chapter as we went through it in some depth in the previous one. <span class="strong"><strong>Canvas Scalers</strong></span> only really becomes important when you are deploying your title and need to work with multiple resolutions. For this chapter, we are concentrating on creating the UI and working with the Canvas itself. (But don't let this stop you. Play with it as much as you like; it's your game as well, you know!).</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec58"></a>Am I dead yet?</h3></div></div></div><p>For the health bar, we'll reuse <a id="id549" class="indexterm"></a>some of the tricks you learned in previous chapters but with some nicer graphics using our <span class="strong"><strong>Doomstalker</strong></span> free UI bits.</p><p>So let's start by adding a panel to the <span class="strong"><strong>Canvas</strong></span>. Right-click on the <span class="strong"><strong>Canvas</strong></span> in the project hierarchy and select <span class="strong"><strong>UI</strong></span> | <span class="strong"><strong>Panel</strong></span>. Once done, rename this new GameObject <code class="literal">HealthUIPanel</code>.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip39"></a>Tip</h3><p>You could alternatively use the <span class="strong"><strong>Image</strong></span> UI component as a start if you wish; they are pretty much identical. The only real difference, is that the <span class="strong"><strong>Panel</strong></span> starts its life stretched to the full size of the <span class="strong"><strong>Canvas</strong></span> and has a default background image, whereas the <span class="strong"><strong>Image</strong></span> starts off smaller with no preset image. They are still exactly the same, but with different defaults.</p></div><p>Your <span class="strong"><strong>Scene</strong></span> view will<a id="id550" class="indexterm"></a> now look like what is shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783553617/graphics/3617OS_05_12.jpg" /></div><p>Not much to see here, so just resize the <span class="strong"><strong>Panel</strong></span> down to the bottom right-hand corner using its Rect Handles (blue dots) and for good measure, pull the bottom right-hand corner back from the edge of the screen as well. While you are at it, change the <span class="strong"><strong>Source Image</strong></span> of the panel to the <code class="literal">Backdrop_Light</code> sprite we created earlier from the <code class="literal">HUD_BaseA.psd</code> file. Since this is your UI, you decide on its final placement and size; the following screenshot is where I ended up:</p><div class="mediaobject"><img src="/graphics/9781783553617/graphics/3617OS_05_13.jpg" /></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note136"></a>Note</h3><p>Because we started with the <span class="strong"><strong>Panel</strong></span> UI control, the anchors are by default stretched to the size of the Canvas (its parent), and as such, will resize with the screen when it changes.</p><p>If you had started with an <span class="strong"><strong>Image</strong></span>, the anchors would be set at the middle of the screen and would not resize.</p><p>Additionally, because we haven't applied a <span class="strong"><strong>Canvas Scaler</strong></span>, the resizing will not be uniform with the screen as the spacing values would remain fixed.</p><p>Something to remember!</p></div><p>Since we are almost <a id="id551" class="indexterm"></a>repeating what we did earlier in <a class="link" href="#" linkend="ch04">Chapter 4</a>, <span class="emphasis"><em>Anchors Away</em></span>, for the health bar, we will quickly whip through the steps for creating the Top blue health bar, which will be for our shields:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Right-click on the <span class="strong"><strong>HealthUIPanel</strong></span> panel<a id="id552" class="indexterm"></a> and select <span class="strong"><strong>UI</strong></span> | <span class="strong"><strong>Slider</strong></span>.</p></li><li><p>Expand the new slider in the project hierarchy and delete the <span class="strong"><strong>Handle Slide Area</strong></span>.</p></li><li><p>Select the <span class="strong"><strong>Slider</strong></span> and set the <span class="strong"><strong>Target Graphic</strong></span> to the Slider's <span class="strong"><strong>Fill</strong></span> GameObject (which is a child of the <span class="strong"><strong>Fill Area</strong></span>).</p></li><li><p>Click on the <span class="strong"><strong>Handle Rect</strong></span> property and hit <span class="emphasis"><em>Delete</em></span> (or click on the circle icon to the right of the property and select <span class="strong"><strong>None</strong></span>).</p></li><li><p>Click on the <span class="strong"><strong>Anchor Presets</strong></span> of the <span class="strong"><strong>Slider</strong></span> and hold <span class="emphasis"><em>Alt</em></span> and click on the <span class="strong"><strong>Top Stretch</strong></span> option (second from the top on the far right).</p></li><li><p>Bring in the left and <a id="id553" class="indexterm"></a>right sides of the <span class="strong"><strong>Slider</strong></span> (about 10 for Left and Right).</p></li><li><p>Select the <span class="strong"><strong>Background</strong></span> GameObject (child of the slider) and set the <span class="strong"><strong>Source Image</strong></span> to the <code class="literal">Slider_Top</code> sprite.</p></li><li><p>Resize the slider to give it a chunkier look (either by resizing the slider itself or altering the <span class="strong"><strong>Background</strong></span> GameObject).</p></li><li><p>Select the <span class="strong"><strong>Fill</strong></span> GameObject and set the <span class="strong"><strong>Source Image</strong></span> to the <code class="literal">Slider_Bar_Top</code> sprite.</p></li><li><p>With the <span class="strong"><strong>Fill</strong></span> GameObject selected, alter its <span class="strong"><strong>Rect Transform</strong></span> handles to dock with its parent size (maximizing the <span class="strong"><strong>Fill</strong></span> area's <span class="strong"><strong>Rect Transform</strong></span>).</p></li><li><p>Still with the <span class="strong"><strong>Fill</strong></span> GameObject selected, click on the <span class="strong"><strong>Color</strong></span> property and set it to dark blue (H 244, S 255, V 255, A 255).</p></li><li><p>Select the <span class="strong"><strong>Fill Area</strong></span> GameObject and resize it so that it covers the bar portion of the <span class="strong"><strong>Slider</strong></span> Background image.</p></li></ol></div><p>With this, you should end up with something like the following:</p><div class="mediaobject"><img src="/graphics/9781783553617/graphics/3617OS_05_14.jpg" /></div><p>Obviously, feel free to play with the design and make it your own.</p><p>Now duplicate the <a id="id554" class="indexterm"></a>Top slider, replace the <span class="strong"><strong>TOP</strong></span> sprites with the <span class="strong"><strong>BOTTOM</strong></span> versions and place them below the Top slider, remembering to position the <span class="strong"><strong>Fill</strong></span> area over the new <span class="strong"><strong>Slider</strong></span> area. (I'll leave it to you to decide whether you want to anchor the bottom slider to the bottom or top of the panel; each has its advantages.) Also, alter the color of the fill to green for ship/hull health; this is to give it a finished look, as follows:</p><div class="mediaobject"><img src="/graphics/9781783553617/graphics/3617OS_05_15.jpg" /></div><p>Now ain't that pretty? However, looking at the full picture and the game view, it still looks pretty much the same as a <span class="strong"><strong>Screen Space – Overlay</strong></span> canvas. So let's do something about this.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip40"></a>Tip</h3><p>In one test I sized both the <span class="strong"><strong>Background</strong></span> and the <span class="strong"><strong>Fill Area</strong></span> Rect Transform's to fill the entire of the <span class="strong"><strong>Slider</strong></span> Rect Transform size. Just a thought, makes them bigger and easier to handle.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec59"></a>Reaching in</h3></div></div></div><p>So we've got our fancy slider bars in play, but it still looks flat. To break this perception, we need to add some perspective and to do this we need a new <span class="strong"><strong>Camera</strong></span>.</p><p>Without a separate camera, the <span class="strong"><strong>Screen Space – Camera</strong></span> Canvas still operates exactly like a <span class="strong"><strong>Screen Space – Overlay</strong></span> Canvas, as there is nothing to tell it how to draw differently. So let's add one.</p><p>Create a new <span class="strong"><strong>Camera</strong></span> in the scene (<span class="strong"><strong>Create</strong></span> | <span class="strong"><strong>Camera</strong></span>) and name it <code class="literal">GUICamera</code>. The first thing you will notice (especially if you look at the game view) is that our scene has now vanished! Well, almost everything, the new <span class="strong"><strong>UI</strong></span> we created is still shown. This is simply because both the new <span class="strong"><strong>Camera</strong></span> you created and the <span class="strong"><strong>Main Camera</strong></span> attached to the ship are both competing to draw to the same render depth, <span class="strong"><strong>Depth</strong></span> <code class="literal">0</code>, as shown in the <span class="strong"><strong>Camera</strong></span> properties. Because the new <span class="strong"><strong>GUICamera</strong></span> is at the bottom of the project hierarchy, it is drawn last and wins.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note137"></a>Note</h3><p>Remember, in Unity 4.5, Unity Technologies changed how the rendering chain worked. Elements are now drawn according to the order they appear in the project <span class="strong"><strong>Hierarchy</strong></span>, which by default is normally alphabetic.</p></div><p>Now, as this <span class="strong"><strong>Camera</strong></span> is going to be specifically used for <span class="strong"><strong>UI</strong></span> rendering, we can update its options to focus on just <span class="strong"><strong>UI</strong></span> elements.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip41"></a>Tip</h3><p>If you plan to use multiple <span class="strong"><strong>Screen Space – Camera</strong></span> Canvases (which is possible), each with their own <span class="strong"><strong>Camera</strong></span>, be sure to use separate <span class="strong"><strong>Layers</strong></span> for each canvas unless you want them to draw each other! A fascinating bug that showed up while creating the demo scene, which saw my <span class="strong"><strong>World Canvas</strong></span> UI flying along in the background of the scene. This was because it was drawing on the same layer as my <span class="strong"><strong>Main Camera</strong></span>, which was very weird to see.</p></div><p>So, for<a id="id555" class="indexterm"></a> GUICamera, update the following options:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Set the <span class="strong"><strong>Layer</strong></span> property (the rendering layer) to <span class="strong"><strong>UI</strong></span>.</p></li><li><p>Set the <span class="strong"><strong>Clear Flags</strong></span> property to <span class="strong"><strong>Don't Clear</strong></span> (since we want UI to be additive).</p></li><li><p>Change the <span class="strong"><strong>Field of View</strong></span> property to <code class="literal">100</code> (just for a little extra depth).</p></li><li><p>Set the <span class="strong"><strong>Culling Mask</strong></span> property to <span class="strong"><strong>UI</strong></span> (select <span class="strong"><strong>Nothing</strong></span> from the dropdown and then select <span class="strong"><strong>UI</strong></span> to just select <span class="strong"><strong>UI</strong></span>).</p></li></ol></div><p>Now with the camera setup, just add it to the <span class="strong"><strong>Render Camera</strong></span> property of the <span class="strong"><strong>Canvas</strong></span> on the <span class="strong"><strong>ScreenSpaceCameraCanvas</strong></span> GameObject and hey presto! </p><p>Wait, nothing <a id="id556" class="indexterm"></a>happened! What's going on here? What kind of snake oil is this?</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec60"></a>It's all gone a bit flat</h3></div></div></div><p>So while setting up our <span class="strong"><strong>UI</strong></span>, we attached a <a id="id557" class="indexterm"></a>
<span class="strong"><strong>Camera</strong></span> with some funky settings to it but nothing changed! Why?</p><p>The answer to this riddle is very simple: if you set something flat, it's going to be drawn flat. It doesn't matter what funky perspective you apply to it; it's still flat.</p><p>So how to change this? (If you have read this chapter carefully, you should already know the solution! Hmm, let that settle for a bit.)</p><p>Earlier, I showed you a way to add perspective when drawing your UI, here we simply need to do the same thing. For this example, we'll just do something very simple; I will leave it to you to experiment further.</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>Expand the <span class="strong"><strong>ScreenSpaceCameraCanvas</strong></span> GameObject in the project <span class="strong"><strong>Hierarchy</strong></span>.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note138"></a>Note</h3><p>Note that all the <span class="strong"><strong>Rect Transform</strong></span> properties are read-only.</p><p>Both types of Screen Space Canvases (Overlay and Camera) take up the full screen. As such, their size, rotation, and scale are all determined by the device they are being run on, which includes the editor.</p></div></li><li style="list-style-type: disc"><p>Select the <span class="strong"><strong>HealthUIPanel</strong></span> GameObject and set the <span class="strong"><strong>Rect Transform</strong></span> <span class="strong"><strong>Rotation</strong></span> <span class="strong"><strong>Y</strong></span> value to <code class="literal">10</code>.</p></li></ul></div><p>In the <span class="strong"><strong>Scene</strong></span> view, you will see a minor change to the display of the <span class="strong"><strong>HealthUIPanel</strong></span>. However, switch to <span class="strong"><strong>Game</strong></span> view and you see the full effect of the rotation paired with the default <span class="strong"><strong>FOV</strong></span> of the <span class="strong"><strong>GUICamera</strong></span>, as shown here:</p><div class="mediaobject"><img src="/graphics/9781783553617/graphics/3617OS_05_16.jpg" /></div><p>As you can see, the <a id="id558" class="indexterm"></a>
<span class="strong"><strong>Screen Space – Camera</strong></span> Canvas goes far to add some depth to an otherwise flat UI.</p><p>As detailed earlier, there are many options you can use with this, either tinkering with the camera, rotation, or depth of UI components.</p><p>Go wild and experiment!</p></div></div>