<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch03lvl1sec19"></a>Dealing with text</h2></div></div><hr /></div><p>The first control/component we <a id="id334" class="indexterm"></a>deal with is the <span class="strong"><strong>Text</strong></span> control. This is used as the basis for all text drawing for all controls.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip24"></a>Tip</h3><p>You can find the examples shown here in the <span class="emphasis"><em>Scenes\01-Text Control</em></span> scene in the bundled sample code.</p></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note75"></a>Note</h3><p>As you will see, each control is reused by most other controls in a truly modular approach. This is a nice clean break from the Legacy GUI in which all controls were concrete implementations.</p><p>However, some may not like this approach and may prefer to build their own UI controls in the old way, as single controls. With the source now available to all, the choice is up to you.</p></div><p>Whenever and wherever text is displayed in the new UI system, the <span class="strong"><strong>Text</strong></span> control is implemented behind the <a id="id335" class="indexterm"></a>scenes or added as a child component/control to the control you are adding.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note76"></a>Note</h3><p>
<span class="strong"><strong>The Unity Text System</strong></span>
</p><p>At the time of <a id="id336" class="indexterm"></a>writing, the actual text drawing is still using the legacy text drawing system; this isn't ideal and can cause graphic artifacts on the screen when the text is scaled. This is due to be replaced in a later version of Unity, most likely not until Unity 5, but it could also be included in the later 4.x series.</p><p>If you need <a id="id337" class="indexterm"></a>a more advanced <span class="strong"><strong>Text</strong></span> drawing in your project or would like a few more text effects, then you can check out <span class="strong"><strong>TextMeshPro</strong></span> on the <span class="strong"><strong>Asset Store</strong></span>, <a class="ulink" href="http://bit.ly/UnityUITextMeshPro" target="_blank">http://bit.ly/UnityUITextMeshPro</a>.</p><p>Its author, Stephan Bouchard, has been hard at work, updating this awesome tool to work in hand with the new UI framework, so from day one, you will be able to implement this in your project with awesome effects.</p></div><p>Getting started, we can add a <span class="strong"><strong>Text</strong></span> control to our scene (either create a new scene or reuse an existing one) by using any of the following approaches:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>From the Menu: <span class="strong"><strong>GameObject</strong></span> | <span class="strong"><strong>UI</strong></span> | <span class="strong"><strong>Text</strong></span>
</p></li><li style="list-style-type: disc"><p>From the project<span class="strong"><strong> Hierarchy</strong></span>: <span class="strong"><strong>Create</strong></span> | <span class="strong"><strong>UI</strong></span> | <span class="strong"><strong>Text</strong></span>
</p></li><li style="list-style-type: disc"><p>From the project<span class="strong"><strong> Hierarchy</strong></span>: Right-click | <span class="strong"><strong>UI</strong></span> | <span class="strong"><strong>Text</strong></span>
</p></li></ul></div><p>Additionally, because all of the new <span class="strong"><strong>UI</strong></span> controls are also components, you can add a <span class="strong"><strong>Text</strong></span> control to any other GameObject on a <span class="strong"><strong>Canvas</strong></span>, either from:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>The Menu: <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>UI</strong></span> | <span class="strong"><strong>Text</strong></span>
</p></li><li style="list-style-type: disc"><p>The <span class="strong"><strong>Inspector</strong></span>: <span class="strong"><strong>Add Component</strong></span> | <span class="strong"><strong>UI</strong></span> | <span class="strong"><strong>Text</strong></span>
</p></li></ul></div><p>In all cases, this will result in the default view of the <span class="strong"><strong>Text</strong></span> control/component on your <span class="strong"><strong>Canvas</strong></span> in the <span class="strong"><strong>Scene</strong></span> view as you can see here:</p><div class="mediaobject"><img src="/graphics/9781783553617/graphics/3617OS_03_01.jpg" /><div class="caption"><p>A new Text control added to a scene with the color set to white to make it more visible</p></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note77"></a>Note</h3><p>The border around the text is just the selection box around the control. <span class="strong"><strong>Text</strong></span> controls do not have a border, they are just text.</p><p>There's no need to add a <span class="strong"><strong>Canvas</strong></span> if you don't have one already; all UI controls will automatically add a parent <span class="strong"><strong>Canvas</strong></span> and an <span class="strong"><strong>EventSystem</strong></span> to your scene, if you don't have one already.</p></div><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip25"></a>Tip</h3><p>The <span class="strong"><strong>default color </strong></span>of <a id="id338" class="indexterm"></a>the text on the control is now <span class="strong"><strong>Black</strong></span>. This was changed in the beta due to popular demand. I have simply changed it to white in the previous example to make it more visible.</p></div><p>If we then look at the <span class="strong"><strong>Inspector</strong></span>, we can see the following:</p><div class="mediaobject"><img src="/graphics/9781783553617/graphics/3617OS_03_02.jpg" /></div><p>This gives us several familiar text style properties to configure how the text is drawn and presented on the screen.</p><p>Walking through the <span class="strong"><strong>Text</strong></span> component properties, we <a id="id339" class="indexterm"></a>have the following:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>
<span class="strong"><strong>Text</strong></span>: This is the <a id="id340" class="indexterm"></a>text to be displayed on the screen.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Font</strong></span>: This decides <a id="id341" class="indexterm"></a>which font to use from the list of imported fonts in your project. By default, only <span class="strong"><strong>Arial</strong></span> is supplied.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note78"></a>Note</h3><p>Unity supports a wide range of Font types and many can be imported using Font Definition files and you can even create your own.</p><p>You can read more <a id="id342" class="indexterm"></a>about Fonts in Unity at <a class="ulink" href="http://bit.ly/Unity3DFonts" target="_blank">http://bit.ly/Unity3DFonts</a>.</p><p>As the font system is not changing in Unity 4.x, it isn't covered in great depth in this book.</p></div></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Font Style</strong></span>: This <a id="id343" class="indexterm"></a>decides whether the text will be in <span class="strong"><strong>Bold</strong></span>, <span class="strong"><strong>Italics</strong></span>, <span class="emphasis"><em>both</em></span>, or just <span class="strong"><strong>Normal</strong></span>.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Font Size</strong></span>: This <a id="id344" class="indexterm"></a>decides the size of the font to be displayed (see the previous note about the font system).</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Line Spacing</strong></span>: This <a id="id345" class="indexterm"></a>decides the spacing in-between font lines. By default all text controls are multilined.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Rich Text</strong></span>: This <a id="id346" class="indexterm"></a>
<span class="strong"><strong>Text</strong></span> control enables rich text drawing capabilities (same as with legacy GUI, as detailed in <a class="link" href="#" linkend="ch01">Chapter 1</a>, <span class="emphasis"><em>Looking Back, Looking Forward</em></span>, in the Rich Text formatting section).</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Alignment</strong></span>: This <a id="id347" class="indexterm"></a>decides where the text is placed within the bounds of the text control, such as left/right or top/bottom, and so on.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Horizontal Overflow</strong></span>: If <a id="id348" class="indexterm"></a>the text is too big for the control to display, this controls how the text should continue overflowing the control bounds. This can be set to <span class="strong"><strong>Overflow</strong></span> (continue on same line) or <span class="strong"><strong>Wrap</strong></span> (continue the next word on a new line).</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Vertical Overflow</strong></span>: Like the <span class="strong"><strong>Horizontal Overflow</strong></span>, the <span class="strong"><strong>Vertical Overflow</strong></span> controls how far <a id="id349" class="indexterm"></a>down the screen the text will flow. This can be set to <span class="strong"><strong>Overflow</strong></span> (continue lines vertically) or <span class="strong"><strong>Truncate</strong></span> (no further characters displayed).</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note79"></a>Note</h3><p>If text doesn't fit vertically (either due to line breaks or wrapping) and <span class="strong"><strong>Vertical Overflow</strong></span> is set to <span class="strong"><strong>Truncate</strong></span>, the lines that don't fit will be entirely removed even if they fall a fraction outside the Text control area. Only lines that completely fit within the box will be displayed in this mode. (Courtesy of Adam Dawes, one of my excellent reviewers.)</p></div></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Best Fit</strong></span>: This allows the text to resize the font to ensure it fits within the bounds of the <a id="id350" class="indexterm"></a>control. It also allows you to set minimum and maximum font sizes if you want to constrain the scaling.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Color</strong></span>: The base <a id="id351" class="indexterm"></a>color of the font (which can be overridden by Rich Text formatting features), the default color of text is <span class="strong"><strong>Black</strong></span>.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Material</strong></span>: The <a id="id352" class="indexterm"></a>default material the text should be rendered with. Note that this does not include Font atlases; these are not supported in the base <span class="strong"><strong>Text</strong></span> control (but you could extend it). This is also used to assign shaders.</p></li></ul></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec36"></a>A simple FPS control</h3></div></div></div><p>The simplest text <a id="id353" class="indexterm"></a>example that is used in most games is an FPS counter, so <a id="id354" class="indexterm"></a>first let's create a script for that. Start by creating a new <code class="literal">C#</code> script in your project called <code class="literal">FPSCounter</code> and replace its contents with the following:</p><div class="informalexample"><pre class="programlisting">using UnityEngine;
using UnityEngine.UI;
 
[RequireComponent(typeof(Text))]
public class FPSCounter : MonoBehaviour {
}</pre></div><p>We start off with the expectation that the control has a <span class="strong"><strong>Text</strong></span> component attached to the GameObject using the <code class="literal">RequireComponent</code> attribute, we also add the brand new <code class="literal">UnityEngine.UI</code> namespace that holds all the new <span class="strong"><strong>UI</strong></span> functionality.</p><p>Next, we'll add some simple properties to track the FPS for our script:</p><div class="informalexample"><pre class="programlisting">private Text textComponent;
private int frameCount = 0;
private float fps =0;
private float timeLeft = 0.5f;
private float timePassed = 0f;
private float updateInterval = 0.5f;</pre></div><p>Nothing too fancy, and now we need to capture a reference to the <span class="strong"><strong>Text</strong></span> component used by the GameObject (always try to use strict references and not to keep looking up the <span class="strong"><strong>Text</strong></span> component reference on each use), we do this in the <code class="literal">Awake</code> function as follows:</p><div class="informalexample"><pre class="programlisting">void Awake()
{
  textComponent = GetComponent&lt;Text&gt;(); 
  if (!textComponent)
  {
  Debug.LogError
   ("This script needs to be attached to a Text component!");
    enabled = false;
    return;
  }
}</pre></div><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip26"></a>Tip</h3><p>Because we are using the <code class="literal">RequireComponent</code> attribute, we don't actually have to have to put the error test for the component in the script; however, it is a good practice to get into and will avoid nasty bugs appearing, when you least expect it, when you reference other components from scripts!</p></div><p>Lastly, we need an <a id="id355" class="indexterm"></a>update loop to calculate the <code class="literal">FPS</code> and set the <code class="literal">Text</code> variable <a id="id356" class="indexterm"></a>on the <span class="strong"><strong>Text</strong></span> control:</p><div class="informalexample"><pre class="programlisting">void Update()
{
  frameCount += 1;
  timeLeft -= Time.deltaTime;
  timePassed += Time.timeScale / Time.deltaTime;
  //FPS Calculation each second
  if (timeLeft &lt;= 0f)
  {
    fps = timePassed / frameCount;
    timeLeft = updateInterval;
    timePassed = 0f;
    frameCount = 0;
  }
  //Set the color of the text
  if (fps &lt; 30) { textComponent.color = Color.red; }
  else if (fps &lt; 60) { textComponent.color = Color.yellow; }
  else { textComponent.color = Color.green; }
  //Set Text string
  textComponent.text = string.Format("{0}: FPS", fps);
}</pre></div><p>If you now add a <span class="strong"><strong>Text</strong></span> control to your scene and then add the script to it, (you can just add the script to a GameObject and it will automatically add the <span class="strong"><strong>Text</strong></span> component, thanks to the <code class="literal">RequireComponent</code> attribute), you will then get your basic <span class="strong"><strong>FPS</strong></span> output as shown here:</p><div class="mediaobject"><img src="/graphics/9781783553617/graphics/3617OS_03_03.jpg" /></div><p>You could also use rich <a id="id357" class="indexterm"></a>text to draw the text, if you so wish, if you have it <a id="id358" class="indexterm"></a>enabled in the <span class="strong"><strong>Text</strong></span> settings.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec37"></a>Adding interaction with input</h3></div></div></div><p>Displaying <a id="id359" class="indexterm"></a>text is all well and good, but what about when you need the player to enter some text? Using the native platforms input features is OK <a id="id360" class="indexterm"></a>but it breaks the illusion of the world within by breaking out of the game and showing a bulky platform input box.</p><p>To give a better look and feel, Unity have provided a base text <span class="strong"><strong>Input</strong></span> component, which is best used when combined with the <span class="strong"><strong>Text</strong></span> control (The <span class="strong"><strong>Input Field</strong></span> control will add a Text component by default) along with an <span class="strong"><strong>Image</strong></span> component as a background. (Although you can add it to any other UI control if you wish.)</p><p>When you add an <span class="strong"><strong>Input Field</strong></span> control, navigate to <span class="strong"><strong>Create</strong></span>
<span class="emphasis"><em> | </em></span>
<span class="strong"><strong>UI</strong></span>
<span class="emphasis"><em> | </em></span>
<span class="strong"><strong>InputField </strong></span>in the <span class="strong"><strong>Hierarchy</strong></span> window (or from the multitude of options as detailed at the start of this section) you will see the following additional options in the <span class="strong"><strong>Inspector</strong></span> window:</p><div class="mediaobject"><img src="/graphics/9781783553617/graphics/3617OS_03_04.jpg" /></div><p>This control went through many iterations until it arrived at this final design with a lot of debate to boot.</p><p>As you can see, there are a multitude of different options, from the primary <span class="strong"><strong>Text Component</strong></span> field, which holds the entered value (for which you can supply a default value and a limit on the number of characters the user can enter), to the <span class="strong"><strong>Placeholder Text</strong></span> field, which is only displayed until the user enters a value (useful as it separates default values from actual user data). By default, adding the <span class="strong"><strong>Input Field</strong></span> control also adds two child <span class="strong"><strong>Text</strong></span> components for the <span class="strong"><strong>Text</strong></span> and <span class="strong"><strong>Placeholder</strong></span> properties.</p><p>The control also provides a multitude of configurations for the <span class="strong"><strong>Input Field</strong></span> through the <span class="strong"><strong>Input Type</strong></span> property, each with their own configurable elements:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>
<span class="strong"><strong>Standard</strong></span>: Single <a id="id361" class="indexterm"></a>or multiple lined</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Autocorrected</strong></span>: Single <a id="id362" class="indexterm"></a>or multiple lined with word prompts (depending on the platform it runs on, does not function in editor)</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Integer </strong></span><a id="id363" class="indexterm"></a>
<span class="strong"><strong>Number/Decimal Number</strong></span>: Only numbers</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Alphanumeric</strong></span>: Only <a id="id364" class="indexterm"></a>letters and numbers; no special characters</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Name</strong></span>: Letters <a id="id365" class="indexterm"></a>only, and first characters of each word are uppercase</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>E-mail address</strong></span>: Complete <a id="id366" class="indexterm"></a>with e-mail address text validation </p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Password/Pin</strong></span>: Hashed <a id="id367" class="indexterm"></a>out entry with either all characters or just numbers</p></li></ul></div><p>Additionally, there is <a id="id368" class="indexterm"></a>a custom option where you can mix and match the option above you build your own style of input control.</p><p>Several other options are available as well from setting the blink rate of the Text caret (blinking line showing where you are typing) and the color of the text when the user highlights/selects it.</p><p>We'll discuss the <span class="strong"><strong>Transition</strong></span> options when we go over the <span class="strong"><strong>Button</strong></span> control and the <span class="strong"><strong>Navigation</strong></span> option in the <span class="strong"><strong>Navigation</strong></span> section.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec38"></a>Shadows and effects</h3></div></div></div><p>In any modern <a id="id369" class="indexterm"></a>UI framework, there are always options to apply effects to <a id="id370" class="indexterm"></a>content, whether it is with shadows, gloss, or blur. Usually, this is done with shaders but it's tricky at the best of times and without adequate experience, very time-consuming.</p><p>To this end, Unity has all over implemented a modular effect component system that can modify the vertexes (points in 3D space) of the content being drawn before it is passed to the rendering system.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note80"></a>Note</h3><p>All UI content when drawn to the scene through the Canvas renderer is batched into quads for fast and easy rendering. This results in a simple way to alter the makeup of these quads for effects before rendering occurs, quickly and efficiently. This also means it will work for any platform regardless of what type of graphic system it is.</p></div><p>Unity provides several of these effects out of the box in 4.6, one of which provides a shadow effect on the UI GameObjects it's attached to. It gives the best effect on <span class="strong"><strong>Text</strong></span> components. It can only be used, however, on any GameObject that uses the <span class="strong"><strong>Canvas Renderer</strong></span> in the new UI system (for example, the new UI controls).</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip27"></a>Tip</h3><p>You don't have to stop there either; all effects are based on the <code class="literal">IVertexModifier</code> interface, which allows you to create your own effects as well. Just look at the source code for the UI system for additional details on building these effects from the provided implementations (see <a class="link" href="#" linkend="ch06">Chapter 6</a>, <span class="emphasis"><em>Working with the UI Source</em></span>).</p></div><p>To use these effects, simply add the required component (for example, <span class="strong"><strong>Add Component</strong></span> | <span class="strong"><strong>UI</strong></span> | <span class="strong"><strong>Effects</strong></span> | <span class="strong"><strong>Shadow</strong></span>) to the GameObject you want affected. The <span class="strong"><strong>Shadow</strong></span> component when added, looks like the following <a id="id371" class="indexterm"></a>in the inspector window:</p><div class="mediaobject"><img src="/graphics/9781783553617/graphics/3617OS_03_05.jpg" /></div><p>As you can see, the <span class="strong"><strong>Shadow</strong></span> component gives you a couple of options to set the color of the shadow (only color, not material) and how far out from the GameObject the shadow should extrude. Here is what it looks like when the <span class="strong"><strong>Shadow effect</strong></span> is applied:</p><div class="mediaobject"><img src="/graphics/9781783553617/graphics/3617OS_03_06.jpg" /></div><p>Along with the <span class="strong"><strong>Shadow effect</strong></span>, Unity is also shipping two other Effect components out of the box, these include:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>
<span class="strong"><strong>Outline</strong></span>: An <a id="id372" class="indexterm"></a>extension of the <span class="strong"><strong>Shadow</strong></span> script, which provides a customizable outline for the text instead of just an offset shadow.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Position As UV1</strong></span>: Provides UV1 data for shaders about the <span class="strong"><strong>Text</strong></span>. A bit more of an <a id="id373" class="indexterm"></a>advanced case that was requested quite strongly in the beta. This also serves as a great example for how to build other effects that use the vertex data of UI elements.</p></li></ul></div><p>As stated, if that's not <a id="id374" class="indexterm"></a>enough for you, then flex your coding skills and make some <a id="id375" class="indexterm"></a>more effects of your own, to share (you should always share if you can), or even sell them if they are fancy enough. I'd expect a fair few of these to turn up after release.</p></div></div>