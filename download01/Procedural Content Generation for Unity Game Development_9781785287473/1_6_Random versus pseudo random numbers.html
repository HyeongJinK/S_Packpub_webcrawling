<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch01lvl1sec12"></a>Random versus pseudo random numbers</h2></div></div><hr /></div><p>The most important<a id="id13" class="indexterm"></a> distinction to make is that PRNs are not random numbers. A truly random event would be something like a die roll. We could write some sort of physics simulation to simulate a die roll to achieve a random number. We could also take the static from a TV screen and plot it on an XY plane and take a single point to represent a random number. However, PRNs are preferred in game programming because they are easier to generate. The preceding examples would take too much processing power as they are a fairly complex idea. But a PRN generator is an equation that calculates a string of numbers. This also produces an added benefit of being able to find our way back to a certain generated result.</p><p>You could generate a more random sequence of numbers by grabbing points off our TV static graph, but what if you want to reproduce a result? Imagine we created an entire planet using a specific sequence of random numbers. Unless we generate that planet the first time, record the sequence used, and ship the game with the sequence included in the code, we might never be able to reproduce those results again.</p><p>Now imagine we generated trillions of planets. We would have to somehow come up with a system to store all the results of generating each planet on the first run. That just sounds unwieldy. A PRN generator, however, uses a seed number to generate a sequence, which will eventually repeat. So, instead of saving all the information needed to generate the planets, we just need the PRN generator equation and seed to regenerate all the planets at runtime.</p><div class="mediaobject"><img src="/graphics/9781785287473/graphics/4808_01_03.jpg" /><div class="caption"><p>Random number noise signals â€“ on the left is a random number pattern that does not repeat and on the right is a PRN pattern that repeats</p></div></div><p>A <span class="strong"><strong>seed</strong></span> in reference<a id="id14" class="indexterm"></a> to PRNs, is simply a number either designated by you or by some other pseudo random means. The Unity Random method will acquire a seed from the system time if you don't provide one. The seed of a PRN generator can be stored as a variable like you would store any number in a script. This is useful when we need to recreate the sequence. We just plug our seed back into our number generator and get the same sequence again.</p><p>For example, imagine we used a sequence of PRNs to create a level. Let's say the numbers represent <a id="id15" class="indexterm"></a>whether a room, a hallway, or a trap is placed in a certain area. Now, a player has just finished that level and we decide to delete the level to save space in the memory. But later, the player gets a quest that requires them to go back to that same level. If we keep the seed number we used to generate the level, we can put the seed back into our number generator, get the original sequence, and remake the level as it was initially.</p><p>As stated earlier, one of the side effects of PRN generation is that it is cyclical. There comes a point in which the PRN generator generates the seed again, starting the process over. This is important to consider as it might become a cause of repetition in some of your procedurally generated content. There are multiple factors in avoiding repetition, such as the size of the number, the value, and the sequence range. Unity's Random method should be enough for most cases though.</p><p>So, in short, you know<a id="id16" class="indexterm"></a> that PRNs are not random numbers but they are close enough. The key points are:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>PRN generators need a seed value</p></li><li style="list-style-type: disc"><p>You should store the seed value so we can easily recreate the PRN sequence</p></li><li style="list-style-type: disc"><p>PRN generators will eventually repeat</p></li><li style="list-style-type: disc"><p>If repetition becomes a problem, look into creating a more complex equation for a longer seed range</p></li></ul></div><p>PRNs are cool and all, but how are they used?</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec08"></a>PRNs in PCG</h3></div></div></div><p>You can use PRNs as a<a id="id17" class="indexterm"></a> decision driver to PCG. As a developer you want to be concerned about minimizing minor detail decisions. These decisions could be tasks such<a id="id18" class="indexterm"></a> as placing every single tree by hand in a forest scene. You want the<a id="id19" class="indexterm"></a> scene to look realistic but placing all of them yourself could be very time consuming. You can use PCG for some of this decision making. Using some directed randomness to build the forest for you saves a massive amount of time.</p><div class="mediaobject"><img src="/graphics/9781785287473/graphics/4808_01_04.jpg" /><div class="caption"><p>A forest scene created with Unity Terrain Engine which uses PRNs</p></div></div><p>So it's time to get our hands on this! As previously stated, PRN generation can be a complicated mathematical <a id="id20" class="indexterm"></a>problem but Unity has a built-in class for us called <code class="literal">Random</code>. Now, let's get exposed to PRNs in our first PCG example.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch01lvl3sec01"></a>Random Hello World</h4></div></div></div><p>We are going to start<a id="id21" class="indexterm"></a> with an age-old classic programming example, the <code class="literal">Hello World</code> program. If you have been programming for a while, you likely have done one or more of these already. There will be a twist though. We are going to use PRNs to randomize how we say <code class="literal">Hello World</code>.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note03"></a>Note</h3><p>Be aware that this book is using Unity 5.2.2. Some of the examples will be incompatible with earlier versions.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch01lvl3sec02"></a>Classic Hello World</h4></div></div></div><p>Let's begin by setting up the<a id="id22" class="indexterm"></a> project and completing the classic <code class="literal">Hello World</code> program. Start by launching Unity and creating a new project. You can name it <code class="literal">Hello World</code>. You can also set the perspective to 2D since most of what we do in this book will be in 2D.</p><div class="mediaobject"><img src="/graphics/9781785287473/graphics/4808_01_05.jpg" /><div class="caption"><p>Unity launch screen</p></div></div><p>Once the project is loaded, we will create a new Text GameObject in order to render our <code class="literal">Hello World</code> to<a id="id23" class="indexterm"></a> the screen. On the top toolbar, select <span class="strong"><strong>GameObject</strong></span> | <span class="strong"><strong>UI</strong></span> | <span class="strong"><strong>Text</strong></span>. This will place a new Canvas object with a Text object child onto the scene. An EventSystem is also placed in the <span class="strong"><strong>Hierarchy</strong></span> panel but you can ignore this.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note04"></a>Note</h3><p>If you are unfamiliar with or <a id="id24" class="indexterm"></a>would like to know more about Unity's UI features, Unity Technologies offers video lessons on the topic. You can find them at <a class="ulink" href="http://unity3d.com/learn/tutorials/topics/user-interface-ui" target="_blank">http://unity3d.com/learn/tutorials/topics/user-interface-ui</a>.</p></div><div class="mediaobject"><img src="/graphics/9781785287473/graphics/4808_01_06.jpg" /></div><p>Canvas is mostly off <a id="id25" class="indexterm"></a>screen and you have to zoom out quite a lot to see the full view. Rather than zooming out, let's adjust the Canvas to occupy the Main Camera view space, as follows:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select <span class="strong"><strong>Canvas</strong></span>.</p></li><li><p>Select the <span class="strong"><strong>Render Mode</strong></span> dropdown in the <span class="strong"><strong>Canvas</strong></span> component section.</p></li><li><p>Select <span class="strong"><strong>Screen Space - Camera</strong></span>.</p></li><li><p>This will open up a new field called <span class="strong"><strong>Render Camera</strong></span>.</p></li><li><p>From the <span class="strong"><strong>Hierarchy</strong></span> pane, drag and drop the <span class="strong"><strong>Main Camera</strong></span> object into the <span class="strong"><strong>Render Camera</strong></span> field.</p></li></ol></div><p>This will adjust your <a id="id26" class="indexterm"></a>
<span class="strong"><strong>Canvas</strong></span> object to fit the <span class="strong"><strong>Main Camera</strong></span> view. You might still need to zoom out slightly to see the edges of <span class="strong"><strong>Canvas</strong></span>.</p><div class="mediaobject"><img src="/graphics/9781785287473/graphics/4808_01_07.jpg" /><div class="caption"><p>Workflow to get the Canvas in Main Camera view</p></div></div><p>You might have noticed at this point that there is some text on the screen. In the lower left corner of the <span class="strong"><strong>Canvas</strong></span>, it says <span class="strong"><strong>New Text</strong></span> in a default grey that is difficult to see. Let's change that.</p><p>Select the <span class="strong"><strong>Text</strong></span> object, which is a child of the <span class="strong"><strong>Canvas</strong></span> object. First, we will change the position. In the <span class="strong"><strong>Rect Transform</strong></span> component section:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select the value in the <span class="strong"><strong>Pos X</strong></span> field and change it to <code class="literal">0</code>.</p></li><li><p>Repeat for the <span class="strong"><strong>Pos Y</strong></span> field.</p></li></ol></div><p>The anchors are set to center so the <span class="strong"><strong>Rect</strong></span> should snap to the center of the <span class="strong"><strong>Canvas</strong></span>. Next, we'll change the size of the <span class="strong"><strong>Rect</strong></span> so that we can make the text larger:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select the <span class="strong"><strong>Width</strong></span> field and change it to <code class="literal">500</code>.</p></li><li><p>Select the <span class="strong"><strong>Height</strong></span> field and change it to <code class="literal">65</code>.</p></li></ol></div><p>This will allow us to <a id="id27" class="indexterm"></a>have much larger text. Note that if we had just tried to change the font size without changing the <span class="strong"><strong>Rect</strong></span> size, the text would be clipped or would even vanish completely. Now let's get the text looking nice by going to the <span class="strong"><strong>Text (Script)</strong></span> component section:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Under <span class="strong"><strong>Character</strong></span>, select the <span class="strong"><strong>Font Size</strong></span> field and change it to <code class="literal">55</code>.</p></li><li><p>Under <span class="strong"><strong>Paragraph</strong></span>, select the center alignment button.</p></li><li><p>Select the <span class="strong"><strong>Color</strong></span> field and change it to white.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note05"></a>Note</h3><p>The center alignment button appears as <span class="inlinemediaobject"><img src="/graphics/9781785287473/graphics/4808_01_08.jpg" /></span> in the Unity Editor.</p></div></li></ol></div><p>Now our text is nice and visible. At this point, you can select the text in the <span class="strong"><strong>Text</strong></span> field and delete it. We are going to have our script write the text for us.</p><div class="mediaobject"><img src="/graphics/9781785287473/graphics/4808_01_09.jpg" /><div class="caption"><p>Finished canvas and text formatting</p></div></div><p>Let's start scripting by creating a new C# script. On the top toolbar, select <span class="strong"><strong>Assets</strong></span> | <span class="strong"><strong>Create</strong></span> | <span class="strong"><strong>C# Script</strong></span>. This will create a new script in your <span class="strong"><strong>Assets</strong></span> folder under the <span class="strong"><strong>Project</strong></span> pane. You can name the <a id="id28" class="indexterm"></a>script <code class="literal">HelloWorld.cs</code>.</p><p>Open the script in MonoDevelop or your favorite IDE. We are going to use the following <span class="emphasis"><em>Code Snip 1.1</em></span>:</p><div class="informalexample"><pre class="programlisting">1 using UnityEngine;
2 using UnityEngine.UI;
3 using System.Collections;
4 
5 public class HelloWorld : MonoBehaviour {
6 
7   public Text textString;
8 
9   void Start () {
10     textString.text = "Hello World";
11  }
12 }</pre></div><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip02"></a>Tip</h3><p><span class="strong"><strong>Downloading the example code</strong></span></p><p>You can download the example code files for all Packt books you have purchased from your account at <a class="ulink" href="http://www.packtpub.com" target="_blank">http://www.packtpub.com</a>. If you purchased this book elsewhere, you can visit <a class="ulink" href="http://www.packtpub.com/support" target="_blank">http://www.packtpub.com/support</a> and register to have the files e-mailed directly to you.</p></div><p>Let's take a look at what's happening in <span class="emphasis"><em>Code Snip 1.1</em></span>:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p><code class="literal">Line 2</code>: Be sure to include <code class="literal">UnityEngine.UI</code> or you won't be able to access the <code class="literal">Text</code> component</p></li><li style="list-style-type: disc"><p><code class="literal">Line 7</code>: This is our public <code class="literal">Text</code> object, which we will define in the Unity editor</p></li><li style="list-style-type: disc"><p><code class="literal">Line 10</code>: At the start of the scene, we will take our text object and assign the string <code class="literal">Hello World</code> to it.</p></li></ul></div><p>That's all there is to it. Now, we just need to add the script to the scene. It doesn't matter which object you attach the <code class="literal">HelloWorld.cs</code> script to because we will declare the specific <code class="literal">Text</code> object the script acts on. To keep things organized, this way works well:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Drag and drop the <code class="literal">HelloWorld.cs</code> script from the <span class="strong"><strong>Assets</strong></span> folder to the <span class="strong"><strong>Text</strong></span> object on the scene.</p></li><li><p>Drag and drop the <span class="strong"><strong>Text</strong></span> object from the <span class="strong"><strong>Hierarchy</strong></span> pane to the <span class="strong"><strong>Text String</strong></span> field in the <span class="strong"><strong>Hello World (Script)</strong></span> component of the <span class="strong"><strong>Text</strong></span> object.</p></li></ol></div><p>Now, you can press the play button, and you'll see <span class="strong"><strong>Hello World</strong></span> in a large font:</p><div class="mediaobject"><img src="/graphics/9781785287473/graphics/4808_01_10.jpg" /><div class="caption"><p>Hello World program's result</p></div></div><p>That completes the<a id="id29" class="indexterm"></a> <code class="literal">Hello World</code> program. However, that's not all that interesting. In order to give this classic programming example some new flair, let's add some randomness.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch01lvl3sec03"></a>PCG Hello World</h4></div></div></div><p>Using our <code class="literal">Hello World</code> example, we will<a id="id30" class="indexterm"></a> add PRNs into the mix and give our program some procedurally generated text. We'll start by editing our current <code class="literal">HelloWorld.cs</code> script. The goal here is to randomly display one of a few variations of the Hello World text.</p><p>You can achieve this by creating an array of different strings and having Unity's Random method choose a number from 0 to the length of the array. You will use that PRN as the index of the string array. In this case, our array holds the Hello World string in a few different languages. So instead of telling the <code class="literal">Text</code> object to display <span class="strong"><strong>Hello World</strong></span>, we will tell it to display the contents of the array at the PRN index.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note06"></a>Note</h3><p>Unity's <code class="literal">Random.Range</code> has a usage of (inclusive, exclusive). In our code, we use <code class="literal">Random.Range (0, 4)</code>, which means 0 will be in the selected range but the range stops at 3. One reason for this is if we have a C# list, we can write the range as <code class="literal">(0, List.Count)</code> instead of <code class="literal">(0, ListCount - 1)</code>.</p><p>You can find more<a id="id31" class="indexterm"></a> information on Unity's Random at <a class="ulink" href="http://docs.unity3d.com/ScriptReference/Random.html" target="_blank">http://docs.unity3d.com/ScriptReference/Random.html</a>.</p></div><p>Open the <code class="literal">HelloWorld.cs</code> script and make the following changes in <span class="emphasis"><em>Code Snip 1.2</em></span>:</p><div class="informalexample"><pre class="programlisting">5 public class HelloWorld : MonoBehaviour {
6 
7   public string[] hellos = new string[4] {
      "Hello World", "Hola Mundo", "Bonjour Le Monde", "Hallo Welt"};
8 
9   public Text textString;
10
11  void Start () {
12    Random.seed = (int)System.DateTime.Now.Ticks;
13    int randomIndex = Random.Range (0, hellos.Length);
14    textString.text = hellos[randomIndex];
15  }
16 }</pre></div><p>The changes in <span class="emphasis"><em>Code Snip 1.2</em></span> are as follows:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p><code class="literal">Line 7</code>: Here you will declare a string array that we can call <code class="literal">hellos</code>, which will hold all our <code class="literal">Hello World</code> strings.</p></li><li style="list-style-type: disc"><p><code class="literal">Line 12</code>: This is the PRN generator seed, which we discussed earlier in the chapter. We are picking a random number to seed the generator. The seed comes from your <a id="id32" class="indexterm"></a>computer's current time in processor ticks (which is somewhere around a millisecond).</p></li><li style="list-style-type: disc"><p><code class="literal">Line 13</code>: Here, we call <code class="literal">Random.Range</code> to choose a PRN from 0 to 3, which will be the index of <code class="literal">hellos</code> that we choose to display.</p></li><li style="list-style-type: disc"><p><code class="literal">Line 15</code>: This line is a modification from our previous example; here, we set the text display to our randomly selected <code class="literal">Hello World</code> string.</p></li></ul></div><p>Head back into the Unity editor to see the changes. You should see the new <span class="strong"><strong>Hellos</strong></span> field. If you expand it, then you will see all of the strings contained in the array. The script might also lose connection to the <span class="strong"><strong>Text</strong></span> object. You can just drag and drop the <span class="strong"><strong>Text</strong></span> object into the <span class="strong"><strong>Text String</strong></span> field to reconnect it.</p><div class="mediaobject"><img src="/graphics/9781785287473/graphics/4808_01_11.jpg" /><div class="caption"><p>Hello World with PRNs program result</p></div></div><p>And that's it. You<a id="id33" class="indexterm"></a> completed your first PCG capable program. Test it out by pressing the play button. You will randomly get one of the four <code class="literal">Hello World</code> strings displayed in the <span class="strong"><strong>Game</strong></span> screen. There are only four choices so you might have to try a couple of times before you start seeing any variation.</p></div></div></div>