<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch03lvl1sec21"></a>PCG algorithm overview</h2></div></div><hr /></div><p>Now that we settled on our data structure for managing our Game Board grid, we need to design our algorithm<a id="id102" class="indexterm"></a> for placing tiles. This algorithm will use two types of PCG. We will only create tiles that the player discovers, which is a form of player-triggered PCG. We will also use random numbers to dictate the look of the tile and to choose which floor tiles will have a wall tile placed on top.</p><p>To start our algorithm design, let's imagine and try to visualize a use case. We want our player to start in a small area that has already been revealed and added to our data structure. When the game starts, let's create a 5 x 5 grid of tiles for an initial Game Board. We can then place our player character in the center of the grid initially.</p><div class="mediaobject"><img src="/graphics/9781785287473/graphics/B04808-03-06.jpg" /><div class="caption"><p>The initial Game Board grid with the player</p></div></div><p>As the player explores, our algorithm will reveal more tiles in the direction the player is headed. We<a id="id103" class="indexterm"></a> will refer to this as the player's <span class="emphasis"><em>line of sight</em></span>. We can use any arbitrary number of tiles to reveal ahead of the player. Six tiles feels like a good amount, though. This will give us a center point on which to place the player character.</p><div class="mediaobject"><img src="/graphics/9781785287473/graphics/B04808-03-07.jpg" /><div class="caption"><p>The line of sight grid squares are shaded</p></div></div><p>Every time the <a id="id104" class="indexterm"></a>player moves into another tile, we will check the six tiles in front of the character. In order to accomplish this, we will need to track the player's position as a <code class="literal">Vector2</code> with an X and Y coordinate. We will also need to track the direction in which the player is moving. With the player position and direction, we can find the coordinates of the six tiles in front of the player.</p><div class="mediaobject"><img src="/graphics/9781785287473/graphics/B04808-03-08.jpg" /><div class="caption"><p>Revealing more tiles as the player moves right</p></div></div><p>As the player explores and returns to the areas, the six tiles spaces in the player's line of sight might <a id="id105" class="indexterm"></a>have already been revealed and in our dictionary. So, with every step the player takes, we need to check each of the six lines of sight tiles to see whether the player has already discovered them. If we find that a tile is already in our dictionary, we don't want to overwrite it with a new tile because it might change its look.</p><div class="mediaobject"><img src="/graphics/9781785287473/graphics/B04808-03-09.jpg" /><div class="caption"><p>The tiles are iterated over to check whether they have already been discovered</p></div></div><p>When we check the player's line of sight, we will perform one of two actions on each tile. If the tile is undiscovered, we will add its coordinates to our dictionary, randomly choose a floor tile sprite to place, put it on the Game Board, and randomly add a wall tile on top of the floor tile. Otherwise, if the floor tile is already in our dictionary, we will just ignore it. We<a id="id106" class="indexterm"></a> have to make sure that we are updating the player's position as well for this algorithm to work.</p><p>Here is a summary of our PCG algorithm:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>The player moves one tile in any direction</p></li><li style="list-style-type: disc"><p>Get direction where the player moved</p></li><li style="list-style-type: disc"><p>Update the coordinates of the player's position</p></li><li style="list-style-type: disc"><p>Use the player's position to find and check the 6th line of sight tiles</p></li><li style="list-style-type: disc"><p>Add undiscovered tiles to our dictionary and place them on the Game Board</p></li><li style="list-style-type: disc"><p>Randomly add wall tiles to newly added floor tiles</p></li><li style="list-style-type: disc"><p>Ignore previously discovered tiles</p></li></ul></div></div>