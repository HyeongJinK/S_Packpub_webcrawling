<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch09lvl1sec126"></a>Tracking performance</h2></div></div><hr /></div><p>Unity provides us with many tools that allow us to determine how well our game is running. The <a id="id703" class="indexterm"></a>first we will be covering is readily available for both Unity Pro and Basic users. However, the information is rather limited, though still useful. The second is only available to Unity Pro users. It provides significantly more detail and information on performance. Finally, we will create our own tool, allowing us to view the performance of our scripts in detail.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl2sec144"></a>Editor statistics</h3></div></div></div><p>In the top-right of the <span class="strong"><strong>Game</strong></span> window, there is a button labeled <span class="strong"><strong>Stats</strong></span>. Clicking on this button will open a window, giving<a id="id704" class="indexterm"></a> us information about how the game is running. There is little bit of information about how fast the game is running. Most of the information in this window concerns how well the game is being rendered, largely amounting to how many objects are currently on the screen, how many are animating, and how much memory they take up.</p><div class="mediaobject"><img src="/graphics/9781849692014/graphics/2014OT_09_02.jpg" /></div><p>The various statistics in Unity Editor are explained as follows:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>At the top-right of the Unity Editor <span class="strong"><strong>Statistics</strong></span> window is the current <span class="strong"><strong>FPS</strong></span> (<span class="strong"><strong>Frames Per Second</strong></span><a id="id705" class="indexterm"></a>) and the time in milliseconds that the last frame took to render. These values are unaffected by the rendering of the rest of the Unity Editor, though there is a slight performance hit by running the game in the Editor. In general, if you can keep your game running at more than 60 FPS, your game will run pretty well on your target platform.</p></li><li style="list-style-type: disc"><p>The <span class="strong"><strong>Main Thread</strong></span> statistic<a id="id706" class="indexterm"></a> provides us with the time in milliseconds that it took to run through the code for the frame and <a id="id707" class="indexterm"></a>render everything to the screen. This is the total amount of time it takes to process a single frame of your game.</p></li><li style="list-style-type: disc"><p>To the right of <span class="strong"><strong>Main Thread</strong></span>, we <a id="id708" class="indexterm"></a>have <span class="strong"><strong>Renderer</strong></span>. This statistic is the number of milliseconds the rendering of the frame alone took. This time is already included in the <span class="strong"><strong>Main Thread</strong></span> statistic.</p></li><li style="list-style-type: disc"><p>The <span class="strong"><strong>Draw Calls</strong></span> statistic<a id="id709" class="indexterm"></a> is the number of unique objects that had to be drawn on screen. This is roughly equal to the number of objects that are currently visible to the camera. So, things behind the camera are not drawn and do not add to this value.</p></li><li style="list-style-type: disc"><p>The <span class="strong"><strong>Saved by batching</strong></span> statistic<a id="id710" class="indexterm"></a> is closely related to the number of <span class="strong"><strong>Draw Calls</strong></span>. We will learn more about batching later. But, suffice it to say for now, batching is a special grouping process that reduces the number of <span class="strong"><strong>Draw Calls</strong></span>, making the game render faster.</p></li><li style="list-style-type: disc"><p>Ultimately, every model in 3D graphics is made from a series of triangles. <span class="strong"><strong>Tris</strong></span> is the total number of triangles seen and being rendered by the camera.</p></li><li style="list-style-type: disc"><p>Most of the information<a id="id711" class="indexterm"></a> in a model file is concerned with the position of each vertex. <span class="strong"><strong>Verts</strong></span><a id="id712" class="indexterm"></a> is the total number of vertexes seen and rendered by the camera. The lower the number of vertexes for each model, the faster it will be rendered to the screen.</p></li><li style="list-style-type: disc"><p>The first number for the<a id="id713" class="indexterm"></a> <span class="strong"><strong>Used Textures</strong></span> statistic is the total number of unique textures that are being used in this frame. The second is the total amount of memory they take up. By reducing texture quality or by combining textures, this statistic can be reduced, allowing the game to run faster.</p></li><li style="list-style-type: disc"><p>The <span class="strong"><strong>Render Textures</strong></span> statistic is<a id="id714" class="indexterm"></a> a special type of texture used for special effects such as security cameras and real-time reflections. This statistic displays the total number visible and the amount of memory needed for them.</p></li><li style="list-style-type: disc"><p>The <span class="strong"><strong>switches</strong></span> statistic<a id="id715" class="indexterm"></a> essentially amounts to how much work the <span class="strong"><strong>Render Textures</strong></span> statistic is doing. Fewer <span class="strong"><strong>Render Textures</strong></span> and simpler materials will reduce this number and the resulting cost to rendering time.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Screen</strong></span> is the current width and height, in pixels, of the <span class="strong"><strong>Game</strong></span> window. It also displays the amount<a id="id716" class="indexterm"></a> of memory needed for rendering at that size. A smaller size results in less detail for your game, but also makes the game easier to render.</p></li><li style="list-style-type: disc"><p>The <span class="strong"><strong>VRAM usage</strong></span> statistic<a id="id717" class="indexterm"></a> gives the approximate minimum and maximum video memory currently being used. It also provides the current total amount of video memory available in parentheses. With this statistic and knowing the amount of video memory available in your target device, you can determine whether graphics of your game are simple enough to run on that device.</p></li><li style="list-style-type: disc"><p>The <span class="strong"><strong>VBO Total</strong></span> statistic is the total number of unique meshes currently being rendered by your game. Every<a id="id718" class="indexterm"></a> distinct model you might use will add to this statistic.</p></li><li style="list-style-type: disc"><p>The <span class="strong"><strong>Shadow Casters</strong></span> statistic is used when making use of real-time shadows. Real-time shadows <a id="id719" class="indexterm"></a>are expensive. If possible, they should not be used on mobile devices. But, if you have to have them, minimize the number of objects that cast those shadows. Limit it to moving objects that are large enough for the user to see the shadow. Small, static objects especially do not need to cast shadows.</p></li><li style="list-style-type: disc"><p>The <span class="strong"><strong>Visible Skinned Meshes</strong></span> statistic<a id="id720" class="indexterm"></a> is the total number of rigged objects currently in the view of the camera. <span class="strong"><strong>Skinned Meshes</strong></span> are most often going to be your characters and just about anything else that animates.</p></li><li style="list-style-type: disc"><p>The <span class="strong"><strong>Animations</strong></span> statistic<a id="id721" class="indexterm"></a> provides the current total<a id="id722" class="indexterm"></a> number of animations playing in the scene.</p></li><li style="list-style-type: disc"><p>The <span class="strong"><strong>Network</strong></span> group of statistics only becomes visible when connected to other players in a multiplayer game. The information generally amounts to how many people the game is connected to and how fast those connections are.</p></li></ul></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl2sec145"></a>The Profiler</h3></div></div></div><p>The <span class="strong"><strong>Profiler</strong></span> window<a id="id723" class="indexterm"></a>, found in <a id="id724" class="indexterm"></a>Unity's toolbar under <span class="strong"><strong>Window</strong></span> | <span class="strong"><strong>Profiler</strong></span>, is a great tool for analyzing how your game is running. It gives us a colorful breakdown of each part of our system and how much work it is doing. The only really unfortunate part of this tool is that it is only available for Unity Pro users.</p><div class="mediaobject"><img src="/graphics/9781849692014/graphics/2014OT_09_12.jpg" /></div><p>By first opening the <span class="strong"><strong>Profiler</strong></span> window, we can then play our game in the window and watch the tool give us a fairly detailed breakdown of what is going on. We can click on any point and see detailed information about that frame in the bottom of the window. The information provided is specific to the lane that you clicked on, <span class="strong"><strong>CPU Usage</strong></span>, <span class="strong"><strong>Rendering</strong></span>, <span class="strong"><strong>Memory</strong></span>, and so on.</p><p>The <span class="strong"><strong>CPU Usage</strong></span> information is particularly useful when trying to find parts of our game that are taking too long to process. Spikes in processing cost stand out pretty easily. By clicking on a spike, we <a id="id725" class="indexterm"></a>can see the breakdown of what each part of the game played in making that frame expensive. For most of these parts we can dig down to the exact object or function that is causing the issue. However, we can only get down to the function level. Just because we know where an issue in the code <a id="id726" class="indexterm"></a>generally is, the Profiler will not tell us exactly which part of that function is causing the issue.</p><p>In order to actually work, the Profiler needs to hook into every part of your game. This introduces a little extra cost in the speed of your game. Therefore, when analyzing the information provided, it is best to consider the relative costs rather than hold each cost as an exact value.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl2sec146"></a>Tracking script performance</h3></div></div></div><p>All of these tools that Unity provides are great, but not always the right solution. The Unity Basic user does not have access to the Profiler. Also, both the Profiler and the Editor Statistics are<a id="id727" class="indexterm"></a> fairly generalized. We can get a little more detail with the Profiler, but not always enough. In this next part, we will be creating a special script capable of tracking the performance of specific parts of any script. It should definitely become a regular piece of your developer kit.</p></div></div>