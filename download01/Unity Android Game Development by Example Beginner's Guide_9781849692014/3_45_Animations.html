<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch03lvl1sec49"></a>Animations</h2></div></div><hr /></div><p>The next topic we will be covering is animation. As we explore animations in Unity, we will be creating some targets for our tank to shoot at. Much of the power of Unity's animation system, Mecanim, lies<a id="id241" class="indexterm"></a> in working with humanoid characters. But, setting up and animating human type characters is a book unto itself, so it will not be covered here. However, there is still much we can learn and do with Mecanim.</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>Before we continue with the explanation of the animation import settings, we need an animated model to work with. We have one last set of assets to import to our project. Import the <code class="literal">Target.blend</code> and <code class="literal">Target.png</code> files into the <code class="literal">Targets</code> folder of our project. Once imported, adjust the <span class="strong"><strong>Import Settings</strong></span> window on the <span class="strong"><strong>Model</strong></span> page for the target, just as we did for the tank. Now switch to the <span class="strong"><strong>Rig</strong></span> tab.</p><div class="mediaobject"><img src="/graphics/9781849692014/graphics/2014OT_03_08.png.jpg" /></div></li><li style="list-style-type: disc"><p>The <span class="strong"><strong>Animation Type</strong></span> attribute tells <a id="id242" class="indexterm"></a>Unity what type of skeleton the current model is going to use when animating.</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>The <span class="strong"><strong>Humanoid</strong></span> option adds many more buttons and switches to this page for working with human type characters. But again, it is too complex to cover here.</p></li><li style="list-style-type: disc"><p>A <span class="strong"><strong>Generic</strong></span> rig still uses Mecanim and many of its features. Really, this is just any animation skeleton that does not resemble a human in structure.</p></li><li style="list-style-type: disc"><p>The third option, <span class="strong"><strong>Legacy</strong></span>, utilizes Unity's old animation system. But, this system will be phased out over the next few versions of Unity, so it will not be covered either.</p></li><li style="list-style-type: disc"><p>The last option, <span class="strong"><strong>None</strong></span>, indicates that the object will not be animating. You could select this option for both the tank and the city, because it also keeps Unity from adding that <code class="literal">Animator</code> component and saves space in the final project size.</p></li><li style="list-style-type: disc"><p>The <span class="strong"><strong>Root Node</strong></span> value is a list of every object that is in the model file. Its purpose is to select the base object of your animation rig. For this target, select <span class="strong"><strong>Bone_Arm_Upper</strong></span>, which is underneath the second <span class="strong"><strong>Armature</strong></span> option.</p></li></ul></div><div class="mediaobject"><img src="/graphics/9781849692014/graphics/2014OT_03_09.png.jpg" /></div></li><li style="list-style-type: disc"><p>The last page of the import settings, <span class="strong"><strong>Animations</strong></span>, contains everything that we need to get the animations from our files into Unity. At the top of the <span class="strong"><strong>Target Import Settings</strong></span> window, we have the <span class="strong"><strong>Import Animation</strong></span> checkbox. If an object is not going to<a id="id243" class="indexterm"></a> animate, it is a good idea to turn this option off. Doing so will also save space in your project.</p></li><li style="list-style-type: disc"><p>The option below that, <span class="strong"><strong>Bake Animations</strong></span>, is only used when your animations contain Kinematics and are from 3Ds Max or Maya. This target is from Blender, so the option is grayed out.</p></li><li style="list-style-type: disc"><p>The next four options, <span class="strong"><strong>Anim. Compression</strong></span>, <span class="strong"><strong>Rotation Error</strong></span>, <span class="strong"><strong>Position Error</strong></span>, and <span class="strong"><strong>Scale Error</strong></span>, are primarily for smoothing jittery animations. Nearly all of the time, the defaults will suit just fine.</p></li><li style="list-style-type: disc"><p>The <span class="strong"><strong>Clips</strong></span> section is what we are really concerned about. This will be a list of every animation clip that is currently being imported from the model. On the left-hand side of the list, we have the name of the clip. On the right-hand side, we can see the start<a id="id244" class="indexterm"></a> and end frames of the clip.</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>Unity will add the <span class="strong"><strong>Default Take</strong></span> animation clip to every new model. This is a clip generated from the default preview range of your modelling program, when the file was saved.</p></li><li style="list-style-type: disc"><p>In Blender, it is also possible to create a series of actions for each rig. By default, they are imported by Unity as animation clips. In this case, the <span class="strong"><strong>ArmatureAction</strong></span> clip is created.</p></li><li style="list-style-type: disc"><p>Below and to the right-hand side of the clips, there is a little tab with <span class="strong"><strong>+</strong></span> and <span class="strong"><strong>-</strong></span> buttons. These two buttons add a clip to the end and remove the selected clip respectively.</p></li></ul></div><div class="mediaobject"><img src="/graphics/9781849692014/graphics/2014OT_03_10.png.jpg" /></div></li><li style="list-style-type: disc"><p>When a clip is selected, the next section appears. It starts with a text field for changing the name<a id="id245" class="indexterm"></a> of the clip.</p></li><li style="list-style-type: disc"><p>Below the text field, there is a <span class="strong"><strong>Source Take</strong></span> drop-down list. This list is the same as the default animations. Most of the time, you will just use <span class="strong"><strong>Default Take</strong></span>; but if your animation is ever appearing wrong or is missing, try changing the <span class="strong"><strong>Source Take</strong></span> drop-down list first.</p></li><li style="list-style-type: disc"><p>Then, we have a small timeline, followed by input fields for the start and end frames of the animation clip. Clicking-and-dragging on the two blue flags in the timeline will change the numbers in the input fields.</p></li><li style="list-style-type: disc"><p>Next we have <span class="strong"><strong>Loop Pose</strong></span> and <span class="strong"><strong>Cycle Offset</strong></span>. If we want our animation to repeat, check the box next to <span class="strong"><strong>Loop Pose</strong></span>. <a id="id246" class="indexterm"></a>When an animation is looping, <span class="strong"><strong>Cycle Offset</strong></span> will become available. This value lets us adjust the frame that the looping animation starts on.</p></li><li style="list-style-type: disc"><p>The next three small sections, <span class="strong"><strong>Root Transform Rotation</strong></span>, <span class="strong"><strong>Root Transform Position (Y)</strong></span>, and <span class="strong"><strong>Root Transform Position (XZ)</strong></span>, allow us to control the movement of a character through the animation.</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>All three of these sections have a <span class="strong"><strong>Bake into Pose</strong></span> option. If these are left unchecked, the movement of the root node (we selected it under the <span class="strong"><strong>Rig</strong></span> page) within the animation is translated into movement of the whole object. Think of it like this: say you were to animate a character running to the right and inside of the animation program, you actually move them, rather than animating in place as normal. With Unity's old animation system, for the physical part of a character to move the collider, the <code class="literal">GameObject</code> had to be moved with code. So, if you were to use that animation, the character would appear as if it had moved, but it would have no collision. With this new system, the whole character will move when that animation is played. However, this requires a different and more complex setup to work completely. So, it was not chosen to be used on the tank, though we could have used it.</p></li><li style="list-style-type: disc"><p>Each of the three sections also has a <span class="strong"><strong>Based Upon</strong></span> drop-down option. The choice of this option dictates the object's center for each of the sections. There are more choices if you are working with humanoid characters, but for now we only have two.</p><p>A choice of <span class="strong"><strong>Root Node</strong></span> means the pivot point of the root node object is the center.</p><p>A choice of <span class="strong"><strong>Original</strong></span> means the origin as defined by the animation program is the center of the object.</p></li><li style="list-style-type: disc"><p>There is also an <span class="strong"><strong>Offset</strong></span> option for the first two of these sections that works to correct errors in the motion. When animating a walk cycle for a character, if the character is pulling to the side slightly, adjusting the <span class="strong"><strong>Offset</strong></span> option under <span class="strong"><strong>Root Transform Rotation</strong></span> will correct it.</p></li></ul></div></li><li style="list-style-type: disc"><p>The last option for our animation clip is a <span class="strong"><strong>Transform Mask</strong></span> option<a id="id247" class="indexterm"></a>. By clicking on the arrow to the left, you can expand a list of all objects in the model. Each object has a checkbox next to it. The objects that are not checked will not be animated when this clip is played. This is useful in the case of a hand-waving animation. Such an animation would only need to move the arm and hand, so we would uncheck all of the objects that might make up the body of the character. We could then layer animations, making our character capable of waving while standing, walking, or running, without the need to create three extra animations.</p></li><li style="list-style-type: disc"><p>Finally, we<a id="id248" class="indexterm"></a> have our <span class="strong"><strong>Revert</strong></span> button, <span class="strong"><strong>Apply</strong></span> button, and the <span class="strong"><strong>Preview</strong></span> window at the bottom. Just as with all of our other import settings, we have to hit one of these buttons when changes are made. This <span class="strong"><strong>Preview</strong></span> window is made special by the speed slider in the top-right corner and the big <span class="strong"><strong>play</strong></span> button in the top-left corner. By clicking on this button, we can preview the selected animation. This lets us detect those errors in motion that we talked about earlier, and just generally make sure that the animation is what we want.</p></li></ul></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec37"></a>The target's animations</h3></div></div></div><p>So, now that the description is all out of the way, let's actually make something with it. We start by setting up the animations for the target.</p></div></div>