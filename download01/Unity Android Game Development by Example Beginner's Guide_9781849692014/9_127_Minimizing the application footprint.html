<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch09lvl1sec125"></a>Minimizing the application footprint</h2></div></div><hr /></div><p>One of the keys to a successful game is the size of the game itself. Many users will quickly uninstall any application that appears<a id="id650" class="indexterm"></a> to be unnecessarily large. Also, all of the mobile app stores have limits to how your game will be supplied to users based on the size of the application itself. Becoming familiar with the options <a id="id651" class="indexterm"></a>you have for minimizing the size of your game is the key to control how your game will be distributed.</p><p>The first thing to note when working to minimize the footprint is how Unity handles assets as it builds the game. Only assets that are used somewhere in one of the scenes for the build are actually included in the game. If it is not in the scene itself or referenced by an asset that is in the scene, it will not be included. This means you could have test versions of assets, or incomplete<a id="id652" class="indexterm"></a> versions; as long as they are not referenced, they will not affect the final build size of your game.</p><p>Unity also allows you to keep your assets in the format you need for working on them. When the final build is made, all assets are converted to an appropriate version for their type. This means you can keep models in the format native to your modeling program. Or keep your images as Photoshop files, or any other format you work in, and they will be converted to <code class="literal">JPG</code> or <code class="literal">PNG</code> appropriately when the game is built.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl2sec141"></a>Editor log</h3></div></div></div><p>When you are finally ready<a id="id653" class="indexterm"></a> to work with the footprint of your game, it is possible to find out exactly what is causing your game to be larger than desired. In the top-right corner of the <span class="strong"><strong>Console</strong></span> window is a drop-down menu button. Inside this menu is <span class="strong"><strong>Open Editor Log</strong></span><a id="id654" class="indexterm"></a>.</p><div class="mediaobject"><img src="/graphics/9781849692014/graphics/2014OT_09_07.jpg" /></div><p>The editor log is the location where Unity outputs information while it is running. This includes information about the current version, license checks, and any asset importing. The log will also contain detailed information about the file size and assets included in the game, after it has been built.</p><div class="mediaobject"><img src="/graphics/9781849692014/graphics/2014OT_09_08.jpg" /></div><p>We can see a breakdown of the aspects of the final build. Every asset category has a size and percentage of the<a id="id655" class="indexterm"></a> total build size. We are also supplied with a list of every asset that is actually included in the game, organized by their file size before being added to the build. This information becomes very useful when looking for assets that can stand to be made smaller.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl2sec142"></a>Asset compression</h3></div></div></div><p>Inside the <span class="strong"><strong>Import Settings</strong></span> for models, textures, and audio there are options that affect the size and quality<a id="id656" class="indexterm"></a> of imported assets. In general, the affected change is a reduction in quality. However, especially when working on mobile devices, asset quality can be reduced well below the levels required for a computer before the difference<a id="id657" class="indexterm"></a> is noticeable on the device. Once you understand the options available for each type of asset, you will be able to make optimal decisions regarding the quality of your game. When working with any of these options, look for a setting that minimizes the size before introducing undesired artifacts.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch09lvl3sec01"></a>Models</h4></div></div></div><p>No matter what program or method you use to create your models, ultimately they are always a list of vertex positions and triangles, with a few references to textures. Most of the file size of a model comes from the list of vertex positions. To make sure the models in your game are of the highest quality, <a id="id658" class="indexterm"></a>start in the modeling program of your choice. Delete any and all extra vertexes and faces. Not only will this result in a smaller file when building your final game, it will also reduce the import time when working in the editor.</p><p>The <span class="strong"><strong>Import Settings</strong></span> for models consists of three pages, resulting in more options to adjust the quality. Each page tab corresponds to the relevant part of the model, allowing us to fine-tune each one of them.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch09lvl3sec02"></a>Model tab</h4></div></div></div><p>On the <span class="strong"><strong>Model</strong></span> tab, we are able to affect how the mesh is imported. When it comes to optimizing our use of the<a id="id659" class="indexterm"></a> models, there are many options here that are key to success. Once your game is looking and playing<a id="id660" class="indexterm"></a> the way you want it to, we should have a good look at the settings shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781849692014/graphics/2014OT_09_03.jpg" /></div><p>The settings available under the <span class="strong"><strong>Model</strong></span> tab are explained as follows:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>
<span class="strong"><strong>Mesh Compression</strong></span>: This option<a id="id661" class="indexterm"></a> lets us select how much compression should be applied to the model. The effect amounts to combining vertexes to reduce the overall amount of detail that has to be stored for the mesh. This setting is likely to introduce undesired oddities in the mesh. So, always pick the highest setting that does not introduce any artifacts.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Read/Write Enabled</strong></span>: This option is only<a id="id662" class="indexterm"></a> useful when you want to manipulate the mesh while the game is running, through the script. If you never touch the mesh with any of your scripts, uncheck this box. While not affecting the final build size, this will affect how much memory is required to run your game.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Optimize Mesh</strong></span>: This option causes Unity to reorder the triangles list that describes the model. This is always a good<a id="id663" class="indexterm"></a> one to leave checked. The only reason you might want to uncheck it is if you are manipulating the game or mesh based on the specific order of the triangles.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Generate Colliders</strong></span>: This option is almost always a candidate to leave off. This option will add Mesh Collider <a id="id664" class="indexterm"></a>components to every mesh in your model. These are relatively expensive to calculate when working with physics in your game. If possible, you should always use a group of the significantly simpler Box Colliders and Sphere Colliders.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Generate Lightmap UVs</strong></span>: This option<a id="id665" class="indexterm"></a> should only be used when working with objects that need static shadows. If the object does not, it will introduce excess vertex information and bloat the asset.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Normals</strong></span>: This option is used by materials <a id="id666" class="indexterm"></a>for determining which direction a vertex faces and how lighting should affect it. If the mesh never uses a material needing <span class="strong"><strong>Normals</strong></span> information, be sure to set this to <span class="strong"><strong>None</strong></span>.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Tangents</strong></span>: This option is used by materials<a id="id667" class="indexterm"></a> for faking detail with bump maps and similar special effects. Just as with the <span class="strong"><strong>Normals</strong></span> setting, if you don't need them, don't import them. If <span class="strong"><strong>Normals</strong></span> is set to <span class="strong"><strong>None</strong></span>, this setting will automatically be grayed out and no longer imported.</p></li></ul></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch09lvl3sec03"></a>Rig tab</h4></div></div></div><p>The following is a screenshot <a id="id668" class="indexterm"></a>that displays the <span class="strong"><strong>Rig</strong></span> tab:</p><div class="mediaobject"><img src="/graphics/9781849692014/graphics/2014OT_09_09.jpg" /></div><p>There are really<a id="id669" class="indexterm"></a> only two things to keep in mind when working to optimize your animation rig. The first is, if the asset does not animate, then don't import it. By setting <span class="strong"><strong>Animation Type</strong></span> to <span class="strong"><strong>None</strong></span>, Unity will not try to import the rig or any useless animations. The second thing to keep in mind is to remove any unnecessary bones. Once imported to Unity, delete any and all objects from the rig that do not actually have an effect on the animation <a id="id670" class="indexterm"></a>or character. Unity converts any inverse<a id="id671" class="indexterm"></a> kinematics that you might use for animating into forward kinematics, so the guides used for it can be deleted once in Unity.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch09lvl3sec04"></a>Animations tab</h4></div></div></div><p>As with with the <span class="strong"><strong>Rig</strong></span> tab, if the model <a id="id672" class="indexterm"></a>does not animate, do not import animations. Unchecking the <span class="strong"><strong>Import Animation</strong></span> box, when first importing the asset, will avoid any extra components being added to your GameObjects in Unity. <a id="id673" class="indexterm"></a>Also, if any extra animations get added to your final build accidentally, they can quickly make your application over-sized.</p><div class="mediaobject"><img src="/graphics/9781849692014/graphics/2014OT_09_06.jpg" /></div><p>The settings available under the <span class="strong"><strong>Animations</strong></span> tab are explained as follows:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>
<span class="strong"><strong>Anim. Compression</strong></span><a id="id674" class="indexterm"></a>: This option adjusts how Unity handles excess keyframes in your animations. For most situations, the default option works well.</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>
<span class="strong"><strong>Off</strong></span>: This option should only be used if you need a high-precision animation. This is the largest and most costly setting to choose.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Keyframe Reduction</strong></span>: This option will reduce the number of keyframes used by the animation based on the Error settings that follow. Essentially, if a keyframe does not have a noticeable effect upon the animation, it is ignored.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Keyframe Reduction and Compression</strong></span>: This option does the same as the previous option but additionally compresses the file size of the animations. At<a id="id675" class="indexterm"></a> runtime, though, the animation will still require the same amount of processor resources to calculate as the previous option.</p></li></ul></div></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Rotation Error</strong></span>: This <a id="id676" class="indexterm"></a>option is the number of degrees different between keyframes that will be ignored when performing keyframe<a id="id677" class="indexterm"></a> reduction.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Position Error</strong></span>: This option<a id="id678" class="indexterm"></a> is the movement distance that will be ignored between keyframes when performing the keyframe reduction.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Scale Error</strong></span>: This option is the amount <a id="id679" class="indexterm"></a>of size adjustment in the animation that will be ignored between keyframes when performing the keyframe<span class="strong"><strong> </strong></span>reduction.</p></li></ul></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch09lvl3sec05"></a>Textures</h4></div></div></div><p>When working with textures in computer graphics, it is always better to work in <span class="strong"><strong>Powers of 2</strong></span><a id="id680" class="indexterm"></a>. A Power of 2 is any value where it and its subsequent halves can be evenly divided by two until one is reached. This is important because they<a id="id681" class="indexterm"></a> are faster for the computer to calculate and process. By default, Unity will convert any textures that do not meet this requirement by scaling them to the nearest Power of 2.</p><div class="mediaobject"><img src="/graphics/9781849692014/graphics/2014OT_09_04.jpg" /></div><p>The various <span class="strong"><strong>Texture</strong></span> settings available in Unity are explained as follows:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>
<span class="strong"><strong>Texture Type</strong></span>: This option affects<a id="id682" class="indexterm"></a> what type of texture this image will be treated as. It is always best to select the type most appropriate for the <a id="id683" class="indexterm"></a>intended use of the image.</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>
<span class="strong"><strong>Texture</strong></span>: This option is the most common and default setting. This should be used for your normal model textures.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Normal Map</strong></span>: This option is used for special effects such as bump maps. Materials using this type of texture will also need the normal and tangent information from the model import settings.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>GUI</strong></span>: This option should be used if the image is going to appear in the GUI and not on any models.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Reflection</strong></span>: These textures are used for creating cube maps that imitate the reflective properties of real objects.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Cookie</strong></span>: These textures are used on lights, changing how the light is emitted from the light object.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Advanced</strong></span>: This option gives full control over all of the settings concerned with importing images. You will only need this setting if you have special purposes for your textures.</p><p>When the <span class="strong"><strong>Texture Type</strong></span> option is set to <span class="strong"><strong>Advanced</strong></span>, the <span class="strong"><strong>Read / Write Enabled</strong></span> box becomes available. This should only be left checked if you plan on manipulating the texture from your scripts while the game is running. If unchecked, Unity does not maintain a copy of the data in the CPU, freeing memory for other parts of the game.</p></li></ul></div></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Generate Mip Maps</strong></span>: This option is another <span class="strong"><strong>Advanced</strong></span> setting that lets you control the creation of smaller <a id="id684" class="indexterm"></a>versions of the texture. These are then used when the texture is small on the screen, reducing the amount of processing needed to draw the texture and the object using it on the screen.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Filter Mode</strong></span>: This option<a id="id685" class="indexterm"></a> is available for all of the texture types. It affects how the image will look when you are very close to it. <span class="strong"><strong>Point</strong></span> will make the image look blocky, while <span class="strong"><strong>Bilinear</strong></span> and <span class="strong"><strong>Trilinear</strong></span> will blur the pixels. In general, <span class="strong"><strong>Point</strong></span> is the fastest; <span class="strong"><strong>Trilinear</strong></span> is the slowest but gives the best looking effect.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Max Size</strong></span>: This option adjusts how <a id="id686" class="indexterm"></a>large the image can be when it is used in the game. This allows you to work with images that are very large but import them to Unity in an appropriately small size. In general, values greater than <span class="strong"><strong>1024</strong></span> are poor choices; not just because of the increased memory requirement, but also because the video cards on most mobile devices cannot handle textures that are any larger. Choosing the smallest size possible will have a great effect on the footprint size<a id="id687" class="indexterm"></a> of the textures in your final build.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Format</strong></span>: This option adjusts<a id="id688" class="indexterm"></a> how the image should be imported and how much detail each pixel can hold. <span class="strong"><strong>Compressed</strong></span> is the smallest, while <span class="strong"><strong>Truecolor</strong></span> provides the most detail.</p></li></ul></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch09lvl3sec06"></a>Audio</h4></div></div></div><p>Giving a game quality<a id="id689" class="indexterm"></a> sound always adds a lot to the final size of the game. It is one of those assets that a game cannot do without, but can be hard to include at a suitable level. When working on them in your audio program, keep them as short as possible to minimize their size. The audio import settings all have an effect on either their footprint in the build size, or the memory required to run the game.</p><div class="mediaobject"><img src="/graphics/9781849692014/graphics/2014OT_09_05.jpg" /></div><p>The various <span class="strong"><strong>Audio</strong></span> settings available in Unity are explained as follows:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>
<span class="strong"><strong>Audio Format</strong></span>: This setting changes how the file will be stored in your game. <span class="strong"><strong>Native</strong></span> offers higher quality while <span class="strong"><strong>Compressed</strong></span> results in a smaller file size. As a special feature of mobile platforms, compressed audio can be retrieved relatively faster<a id="id690" class="indexterm"></a> than on other platforms because of some special hardware in the mobile devices.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>3D Sound</strong></span>: This setting dictates<a id="id691" class="indexterm"></a> whether or not the file will be affected by its position in the game relative to the <span class="strong"><strong>Audio Listener</strong></span>. If this is unchecked, some calculations can be avoided, reducing the processing required in each frame of your game.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Force to mono</strong></span>: This setting converts stereo audio into mono. While most devices are technically capable of playing stereo sounds, they do not always have the multiple speakers required <a id="id692" class="indexterm"></a>for it to make a difference. Checking this box can significantly reduce the file size of the audio, by removing that extra audio channel.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Load type</strong></span>: This setting affects how much of the system's memory is used, while the game is running, to handle loading audio files. <span class="strong"><strong>Decompress on load</strong></span> uses the most memory, and is best for small, short sounds. <span class="strong"><strong>Compressed in memory</strong></span> only decompresses<a id="id693" class="indexterm"></a> the file while it is playing, using a medium amount of memory, and is best for medium-sized files. <span class="strong"><strong>Stream from disc</strong></span> means that only the part of the file currently being played is stored in the runtime memory. This is like streaming video or music from the Internet. This option is best for large files but should only be used by a few at one time.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Compression (kbps)</strong></span>: This setting adjusts the amount of detail in the audio file. A smaller value will <a id="id694" class="indexterm"></a>reduce the file size, but also reduce quality. A larger value will result in a larger file size and greater quality. If the amount of compression already applied by your audio is smaller than the value here, the setting will have no effect on the sound. In general, it is best to pick the smallest size while maintaining the desired level of quality.</p></li></ul></div></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl2sec143"></a>Player settings</h3></div></div></div><p>Open your game's <span class="strong"><strong>Player Settings</strong></span> by going to Unity's toolbar and navigating to <span class="strong"><strong>Edit</strong></span> | <span class="strong"><strong>Project Settings</strong></span> | <span class="strong"><strong>Player</strong></span>. In the <span class="strong"><strong>Per-Platform Settings</strong></span>, for Android, we have another few options under <span class="strong"><strong>Other Settings</strong></span> that will affect the <a id="id695" class="indexterm"></a>final size and speed of our game.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch09lvl3sec07"></a>Rendering</h4></div></div></div><p>The following is the screenshot that displays the <a id="id696" class="indexterm"></a>
<span class="strong"><strong>Rendering</strong></span> settings:</p><div class="mediaobject"><img src="/graphics/9781849692014/graphics/2014OT_09_10.jpg" /></div><p>The various <span class="strong"><strong>Rendering</strong></span> settings<a id="id697" class="indexterm"></a> available in Unity are explained as follows:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>When we worked with making lightmaps, we had<a id="id698" class="indexterm"></a> to set some objects as static. This told Unity that the objects will never be moving and allows them to be lightmapped. It also allows Unity Pro users to utilize <span class="strong"><strong>Static Batching</strong></span> that allows Unity to significantly speed up rendering times by grouping identical objects. For each group it then renders one object in multiple places, rather than each object individually. Potentially, this setting can add some extra girth to your final build size, because Unity will need to save extra information about your static objects to make it work.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Dynamic Batching</strong></span> works the same as <span class="strong"><strong>Static Batching</strong></span>, with two major differences. First, it is available to both Unity Pro and Basic users. Second, it groups objects that are not marked as static.</p></li></ul></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch09lvl3sec08"></a>Optimization</h4></div></div></div><p>The <span class="strong"><strong>Optimization</strong></span> settings are<a id="id699" class="indexterm"></a> shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781849692014/graphics/2014OT_09_11.jpg" /></div><p>The various <span class="strong"><strong>Optimization</strong></span> settings available in Unity are explained as follows:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>
<span class="strong"><strong>Api Compatibility Level</strong></span>: This setting <a id="id700" class="indexterm"></a>determines which set of the .Net functions to include in the final build. <span class="strong"><strong>.Net 2.0</strong></span> will include all of the available functions, making the largest footprint. <span class="strong"><strong>.Net 2.0 Subset</strong></span> is a smaller portion of the functions, including only those that your programming is most likely to use. Unless you need some special functionality, <span class="strong"><strong>.Net 2.0 Subset</strong></span> should always be the option you choose.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>The Stripping Level</strong></span>: This setting is a Unity Pro only feature. It allows you to reduce the size of your final build by removing all of the excess code before compiling it. System functions are grouped into what are called libraries for easy reference. <span class="strong"><strong>Strip Assemblies</strong></span> removes the unused libraries from the final build. <a id="id701" class="indexterm"></a>The <span class="strong"><strong>Use micro mscorlib</strong></span> option performs the same function as the previous option, but utilizes a minimized form of the libraries. While significantly smaller, this library possesses fewer functions for your code to use. However, unless your game is complex, it should not make a difference.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Optimize Mesh Data</strong></span>: This setting will remove extra information from all of your meshes that are not being<a id="id702" class="indexterm"></a> used by any materials applied to them. This includes the <span class="strong"><strong>Normals</strong></span>, <span class="strong"><strong>Tangents</strong></span>, and a few other bits of information. Unless you have a very special case, this is a good box to always check.</p></li></ul></div></div></div></div>