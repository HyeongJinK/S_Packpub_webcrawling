<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch08lvl1sec122"></a>Time for action – adding explosions</h2></div></div><hr /></div><p>A single particle system and script will allow<a id="id639" class="indexterm"></a> us to create some nice explosions that can be used everywhere.</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>We first need some new textures to make the explosion look like fire. Luckily, Unity provides a multitude of basic particle textures. To include them in your project, go to the top of the Unity Editor and navigate to <span class="strong"><strong>Assets</strong></span> | <span class="strong"><strong>Import Package</strong></span> | <span class="strong"><strong>Particles</strong></span>.</p></li><li><p>In the resulting window, select <span class="strong"><strong>Import</strong></span> and wait for Unity to finish importing them. This package is a great resource, including both textures and complete particle systems. However, all of the particle systems included use the old system that will be phased out of Unity over the next few versions. Despite this, we can still make full use of the included materials.</p></li><li><p>Create a new <code class="literal">particleSystem</code> object and name it <code class="literal">Explosion</code>.</p></li><li><p> First, in the <span class="strong"><strong>Initial</strong></span> module, we need to make the effect last for a short time. Set the <span class="strong"><strong>Duration</strong></span> to <span class="strong"><strong>0.5</strong></span> and the <span class="strong"><strong>Start Lifetime</strong></span> option to <span class="strong"><strong>1</strong></span>.</p></li><li><p>To keep the particles close together, use a value of <span class="strong"><strong>0.5</strong></span> for the <span class="strong"><strong>Start Speed</strong></span> option.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip26"></a>Tip</h3><p>When we are done with this system, it will not loop. However, it is easier to see what we are working with if we let it loop for now.</p></div></li><li><p>Next, we need more particles, so go to the <span class="strong"><strong>Emission</strong></span> module. Set the <span class="strong"><strong>Rate</strong></span> option to <span class="strong"><strong>120</strong></span> to generate the proper amount.</p></li><li><p>An explosion is generally round, so we need to adjust the <span class="strong"><strong>Shape</strong></span> module next. Select <span class="strong"><strong>Sphere</strong></span> for the <span class="strong"><strong>Shape</strong></span> setting and set the <span class="strong"><strong>Radius</strong></span> option to <span class="strong"><strong>0.5</strong></span>.</p></li><li><p>Now for the<a id="id640" class="indexterm"></a> <span class="strong"><strong>Color over Lifetime</strong></span> module. An explosion is bright at the beginning and fades to brown, followed by black as it burns. For the <span class="strong"><strong>Color</strong></span> option, start with an army green color, followed by faded yellow, then medium brown, and finally black at the end. Also, cause <span class="strong"><strong>Alpha</strong></span> to fade in at the beginning and out at the end. This keeps the particles from popping in and out of existence.</p><div class="mediaobject"><img src="/graphics/9781849692014/graphics/2014OT_08_20.png.jpg" /></div></li><li><p>Next, we need a fire material for our particles. For the <span class="strong"><strong>Material</strong></span> setting in the <span class="strong"><strong>Renderer</strong></span> module, select the <span class="strong"><strong>Fire Smoke</strong></span> material. It can also be found in your <span class="strong"><strong>Project</strong></span> window by going to <span class="strong"><strong>Standard Assets</strong></span> | <span class="strong"><strong>Particles</strong></span> | <span class="strong"><strong>Sources</strong></span> | <span class="strong"><strong>Materials</strong></span>.</p></li><li><p>Once we are satisfied with the look of the system, make sure the <span class="strong"><strong>Play On Awake</strong></span> checkbox is checked and the <span class="strong"><strong>Looping</strong></span> checkbox is not checked in the <span class="strong"><strong>Initial</strong></span> module.</p></li><li><p>As with the asteroids and enemy ships, the explosion needs to move around our player as they move. It also needs to destroy itself when it is done emitting. So, create a new script and name it <code class="literal">Explosion</code>.</p></li><li><p>This script is short and only<a id="id641" class="indexterm"></a> includes two functions. The first function, <code class="literal">Update</code>, checks to see if the <code class="literal">particleSystem</code> object is missing or has finished playing. If either is true, the <code class="literal">gameObject</code> is destroyed.</p><div class="informalexample"><pre class="programlisting">public void Update() {
  if(particleSystem == null || !particleSystem.isPlaying)
    Destroy(gameObject);
}</pre></div></li><li><p>The second function, <code class="literal">LateUpdate</code>, simply uses the <code class="literal">PlayerShip.Rotate</code> function, which we created in <a class="link" href="#" linkend="ch06">Chapter 6</a>, <span class="emphasis"><em>Specialities of the Mobile Device – Touch and Tilt</em></span>, to move the explosion for the player's movement. This is the same way we move the asteroids and enemy ships around as the player moves.</p><div class="informalexample"><pre class="programlisting">public void LateUpdate() {
  PlayerShip.Rotate(transform);
}</pre></div></li><li><p>Return to Unity and add the script to the <code class="literal">Explosion</code> object.</p></li><li><p>Next, add an <span class="strong"><strong>Audio Source</strong></span> component to the object.</p></li><li><p>For this component, we need the <span class="strong"><strong>Play On Awake</strong></span> checkbox checked. Also select <span class="strong"><strong>Linear Rolloff</strong></span> for the <span class="strong"><strong>Volume Rolloff</strong></span> mode and <span class="strong"><strong>10</strong></span> for the <span class="strong"><strong>Min Distance</strong></span>, both found under <span class="strong"><strong>3D Sound Settings</strong></span>.</p></li><li><p>And, of course, select the <span class="strong"><strong>Explosion</strong></span> sound effect for the source's audio clip. These settings will cause the sound to play as soon as the explosion is spawned.</p></li><li><p>To complete the explosion's creation, turn the object into a prefab and delete the instance from the scene.</p></li><li><p>Next, we need to update the <code class="literal">TouchShoot</code> script to utilize the explosion. Open it now.</p></li><li><p>To the beginning, we add a variable to hold a reference to the explosion.</p><div class="informalexample"><pre class="programlisting">public GameObject explosion;</pre></div></li><li><p>After the line where we make use of the <code class="literal">Physics.Raycast</code> function<a id="id642" class="indexterm"></a> and before we destroy the shot object, add this line. If there is a reference to the explosion, it uses the <code class="literal">Instantiate</code> function to spawn a new instance of the explosion and sets its position and rotation to that of the object that was shot.</p><div class="informalexample"><pre class="programlisting">if(explosion != null) Instantiate(explosion, hit.transform.position, hit.transform.rotation);</pre></div></li><li><p>Back in Unity, find the instance of the <code class="literal">TouchShoot</code> script component on the player's ship. Add the reference to<a id="id643" class="indexterm"></a> the <code class="literal">Explosion</code> prefab in the new <span class="strong"><strong>Explosion</strong></span> slot.</p><div class="mediaobject"><img src="/graphics/9781849692014/graphics/2014OT_08_21.png.jpg" /></div></li></ol></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch08lvl2sec136"></a>
<span class="emphasis"><em>What just happened?</em></span>
</h3></div></div></div><p>We created an explosion. Unity provides us with a slew of particle textures with which we can create a multitude of effects. There are also a few particle systems already created, including an explosion. However, that explosion uses the old system and will not be included in Unity for much longer. We also updated our enemy ships and asteroids so they spawn the explosions when they are destroyed by the player.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch08lvl2sec137"></a>Have a go hero – more types of explosions</h3></div></div></div><p>One explosion is alright, but it is odd that the asteroids explode in the same manner as the ships. Different gases, fuels, and rock compositions all burn in different colors and with varying amounts of vigor. Create some more explosions for the different objects flying around your space. Change the colors and size to suit what is exploding. Also, explore other sound effects that provide differing auditory clues as to what is exploding. Finally, try to create a multi-explosion system. Perhaps the shots from the player cause the first explosion, and a chain reaction causes explosions in the weapon hold and engine compartment. To achieve this, take a look at using subemitters, or spawn a couple of different particle systems around the ship when it is destroyed.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch08lvl2sec138"></a>Creating laser blasts</h3></div></div></div><p>Being able to destroy objects and<a id="id644" class="indexterm"></a> see them explode is great. It gives the player a reward for performing a simple action. However, when one fires a gun of any sort, you expect a reaction from it, whether or not anything is hit. To that end, we are going to create a muzzle-flash-type effect for the player's ship. Every time they tap the screen to fire, some particle systems will flash and a sound effect will play.</p></div></div>