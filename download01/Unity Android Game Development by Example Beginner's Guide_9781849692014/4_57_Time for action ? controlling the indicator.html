<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch04lvl1sec60"></a>Time for action â€“ controlling the indicator</h2></div></div><hr /></div><p>We now need to create a script <a id="id303" class="indexterm"></a>that will control the indicator slices. This will include creating new slices as they are needed. Also, the <code class="literal">GameObject</code> it is attached to will act as a center point for the indicator slices, that we just created, to rotate around.</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Create a new script and name it <code class="literal">IndicatorControl</code>.</p></li><li><p>We start this script off with a pair of variables. The first will hold a reference to the prefab that was just created. This will allow us to spawn instances of it whenever we desire. The second is a static variable, meaning it can be easily accessed without a reference to the component that exists in the scene. It will be filled when the game starts with a reference to the instance of this script that is in the scene.</p><div class="informalexample"><pre class="programlisting">public GameObject indicatorPrefab;
private static IndicatorControl control;</pre></div></li><li><p>This next function will be used by the targets. Soon, we will be updating the target's script to call this function at the beginning of the game. The function is static, just like the variable, and starts by checking to see whether there is a reference to any object in it. If it is empty, equal to null, <code class="literal">Object.FindObjectOfType</code> is used to attempt to fill the variable. By telling it what type of object we want to find, it will search in the game and try to find one. This is relatively a slow process and should not be used often, but we use this process and the variable so that we can always be sure that the system can find the script. The second part of the <code class="literal">CreateSlice</code> function checks to make sure our static variable is not empty. If so, it then tells the instance to create a new indicator slice and passes it to the target.</p><div class="informalexample"><pre class="programlisting">public static void CreateSlice(Transform target) {
  if(control == null) {
    control = Object.FindObjectOfType(typeof(IndicatorControl)) as IndicatorControl;
  }

  if(control != null) {
    control.NewSlice(target);
  }
}</pre></div></li><li><p>One more function for this script. The <code class="literal">NewSlice</code> function<a id="id304" class="indexterm"></a> does as its name implies, it creates new indicator slices when called. It does this by first using the <code class="literal">Instantiate</code> function<a id="id305" class="indexterm"></a> to create a copy of the <code class="literal">GameObject</code> that is passed to it. The second line of the function makes the new slice a child of the control's transform. The next line <a id="id306" class="indexterm"></a>just zeroes out the local position of the new slice. This way it will be centered properly after it is created. The last line uses the slice's <code class="literal">SendMessage</code> function to call the <code class="literal">SetTarget</code> function that we created previously and passes it the desired target object.</p><div class="informalexample"><pre class="programlisting">public void NewSlice(Transform target) {
  GameObject slice = Instantiate(indicatorPrefab) as GameObject;
  slice.transform.parent = transform;
  slice.transform.localPosition = Vector3.zero;
  slice.SendMessage("SetTarget", target);
}</pre></div></li><li><p>Now that the script is created, we need to use it. Create an empty <code class="literal">GameObject</code> and name it <code class="literal">IndicatorControl</code>.</p></li><li><p>The new <code class="literal">GameObject</code> needs to be made a child of your tank, followed by having its position set to zero on each axis.</p></li><li><p>Add the script we just created to <code class="literal">IndicatorControl</code>.</p></li><li><p>Finally, with the <code class="literal">GameObject</code> selected, add the reference to the <code class="literal">IndicatorSlice</code> prefab. Do this by dragging the prefab from the <span class="strong"><strong>Project</strong></span> window to the proper slot in the <span class="strong"><strong>Inspector</strong></span> window.</p></li></ol></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec51"></a>
<span class="emphasis"><em>What just happened?</em></span>
</h3></div></div></div><p>We created a script that will control the spawning of our target indicator slices. The <code class="literal">GameObject</code> we created at the end will also allow us to control the size of the whole indicator with ease. We are almost done with the target indicator.</p></div></div>