<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch05lvl1sec83"></a>Time for action – creating spawns</h2></div></div><hr /></div><p>The script we will be creating in this<a id="id405" class="indexterm"></a> section will keep our game world populated with all the enemies our player might want to destroy:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>We need another new script for this section. Once created, name it <code class="literal">SpawnPoint</code>.</p></li><li><p>This script begins simply with a few variables. The first variable will hold a reference to our <code class="literal">EnemyTank</code> prefab. We need it so we can spawn duplicates.</p><div class="informalexample"><pre class="programlisting">public GameObject tankPrefab;</pre></div></li><li><p>The second variable tracks the spawned tank. When it is destroyed we will create a new one. Using this variable we prevent the game from becoming overwhelmed with the enemy. There will only be as many tanks as spawn points.</p><div class="informalexample"><pre class="programlisting">private GameObject currentTank;</pre></div></li><li><p>The third variable is for setting a distance from the player, to prevent spawning tanks on top of the player. If the player is outside this distance, a new tank can be spawned. If they are within, a new tank will not be spawned.</p><div class="informalexample"><pre class="programlisting">public float minPlayerDistance = 10;</pre></div></li><li><p>The first function we <a id="id406" class="indexterm"></a>will use is <code class="literal">FixedUpdate</code>. It will start by checking a function to see whether it needs to spawn a new tank. If it does, it will call the <code class="literal">SpawnTank</code> function to do so.</p><div class="informalexample"><pre class="programlisting">public void FixedUpdate() {
  if(CanSpawn())
    SpawnTank();
}</pre></div></li><li><p>Next, we create the <a id="id407" class="indexterm"></a>
<code class="literal">CanSpawn</code> function. The first line of the function checks to see whether we already have a tank and returns <code class="literal">false</code> if we do. The second line uses <code class="literal">Vector3.Distance</code> to determine how far away the player currently is. The last line compares that distance to the minimum distance away that the player needs to be before we can spawn anything and returns the result.</p><div class="informalexample"><pre class="programlisting">public bool CanSpawn() {
  if(current != null) return false;

  float currentDistance = Vector3.Distance(PlayerPosition.position, transform.position);
  return currentDistance &gt; minPlayerDistance;
}</pre></div></li><li><p>The last function, <code class="literal">SpawnTank</code>, starts by checking to make sure the <code class="literal">tankPrefab</code> reference has been connected. It can't continue if there is nothing to spawn. The second line uses the <code class="literal">Instantiate</code> function to create a duplicate of the prefab. In order to store it in our variable, we use <code class="literal">as GameObject</code> to make it the proper type. The last line moves the new tank to the spawn point's position. We don't want the tanks appearing in random locations.</p><div class="informalexample"><pre class="programlisting">public void SpawnTank() {
  if(tankPrefab == null) return;

  currentTank = Instantiate(tankPrefab) as GameObject;
  currentTank.transform.position = transform.position;
}</pre></div></li><li><p>Return to Unity, create an empty <span class="strong"><strong>GameObject</strong></span>, and rename it to <code class="literal">SpawnPoint</code>.</p></li><li><p>Add the <code class="literal">SpawnPoint</code> script that we just created, to it.</p></li><li><p>Next, with the spawn point selected, connect the prefab reference by dragging the <code class="literal">EnemyTank</code> prefab<a id="id408" class="indexterm"></a> from the <code class="literal">Prefabs</code> folder and dropping it on the appropriate value.</p></li><li><p>Now, turn the <code class="literal">SpawnPoint</code> object into a prefab, by dragging-and-dropping it from the <span class="strong"><strong>Hierarchy</strong></span> window<a id="id409" class="indexterm"></a> and into the <code class="literal">Prefabs</code> folder.</p></li><li><p>Finally, populate the city with the new points. Positioning one in each corner of the city will work well.</p><div class="mediaobject"><img src="/graphics/9781849692014/graphics/2014OT_05_06.jpg" /></div></li></ol></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec76"></a>
<span class="emphasis"><em>What just happened?</em></span>
</h3></div></div></div><p>We created spawn points for the game. Each point will spawn a new tank. When a tank is destroyed, a new one is created at the spawn point. Feel free to build the game and try it out on your device. This section and chapter are now complete and ready for wrap up.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec77"></a>Have a go hero – two for one</h3></div></div></div><p>Having one spawn point per tank is great, until we want many tanks. Or, we desire them to all spawn in the same location. Your challenge here is to make a single spawn point track multiple tanks. If any one of the tanks is destroyed, a new one should be created. You will definitely need an array to keep track of all the tanks. Also, implement a delay for the spawn. We don't want it spawning multiple tanks on top of each other.</p><p>Now that you have all the knowledge and tools that you need, as a further challenge, try creating other types of enemy tanks. Experiment with size and speed. They can also have different strengths, or give more<a id="id410" class="indexterm"></a> points when destroyed. Perhaps there is a tank that actually gives the player points when shooting at them. Play around and have some fun with it.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec78"></a>Pop Quiz – understanding enemies</h3></div></div></div><p>Q1. Probably the most common act performed in games is shooting with guns. We have done it a couple of times now. Do you remember what function we use to determine where and what our bullet might hit?</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>
<code class="literal">Input.mousePosition</code>
</p></li><li><p>
<code class="literal">Transform.position</code>
</p></li><li><p>
<code class="literal">Physics.Raycast</code>
</p></li></ol></div><p>Q2. We will need a great many enemies running around for us to shoot at. Do you remember which function we use to make them move around our NavMesh?</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>
<code class="literal">CharacterController.Move</code>
</p></li><li><p>
<code class="literal">NavMeshAgent.SetDestination</code>
</p></li><li><p>
<code class="literal">NavMesh.CalculatePath</code>
</p></li></ol></div><p>Q3. Finally, all these enemies will have to be spawned again and again. Do you remember what function we use to spawn these enemies?</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>
<code class="literal">Instantiate</code>
</p></li><li><p>
<code class="literal">Destroy</code>
</p></li><li><p>
<code class="literal">Start</code>
</p></li></ol></div></div></div>