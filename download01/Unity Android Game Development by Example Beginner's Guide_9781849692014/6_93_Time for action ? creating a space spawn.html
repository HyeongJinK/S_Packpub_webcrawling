<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch06lvl1sec94"></a>Time for action – creating a space spawn</h2></div></div><hr /></div><p>Our last script will populate <a id="id450" class="indexterm"></a>our space and will be attached to the player's ship, since it is the center of the game world:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>To fill our space with the objects, we need to create another script. Name it <code class="literal">SpaceSpawn</code>.</p></li><li><p>We start it out with two variables. These two define the space within which the new objects will be spawned. They will be created outside the minimum range but within the maximum range.</p><div class="informalexample"><pre class="programlisting">public float minRange = 200f;
public float maxRange = 300f;</pre></div></li><li><p>Next, we have two variables for controlling the frequency at which objects should be spawned. These will work the same as the ones we used for making the enemy ships shoot at the player.</p><div class="informalexample"><pre class="programlisting">public float frequency = 0.3f;
private float spawnTime = 0;</pre></div></li><li><p>The final variable for this script, is an array. It is simply a list of all of the objects that can be spawned. We will be filling it in a little bit, when we return to Unity to set it up.</p><div class="informalexample"><pre class="programlisting">public GameObject[] spawnList = new GameObject[0];</pre></div></li><li><p>
<code class="literal">Update</code> is once again our function of choice for the script. We start it off by making sure that there is something in the list to be spawned. If there are no objects to be spawned, there is no point in continuing.</p><div class="informalexample"><pre class="programlisting">public void Update() {
  if(spawnList.Length &lt;= 0) return;</pre></div></li><li><p>Next, we track how long it has been since the last spawn and check to see if it has been long enough to spawn once more. Again, this works just like the shooting of the enemy ships.</p><div class="informalexample"><pre class="programlisting">spawnTime += Time.deltaTime;
if(spawnTime &lt; frequency) return;</pre></div></li><li><p>Now, we need to figure out where to spawn the next object in space. To do this, we first use <code class="literal">Random.onUnitSphere</code> to find a random direction. Next, we find a random distance that lies within our min and max ranges. Finally, they are multiplied together to give us a position.</p><div class="informalexample"><pre class="programlisting">Vector3 direction = Random.onUnitSphere;
float distance = Random.Range(minRange, maxRange);
Vector3 position = direction * distance;</pre></div></li><li><p>To pick a random object, we use <code class="literal">Random.Range</code> and pass the length of the list of objects to it.<a id="id451" class="indexterm"></a> This will give us the index of one of the slots of the list. The following line of code makes sure that there is an object in the slot. If there isn't, we cannot spawn it.</p><div class="informalexample"><pre class="programlisting">int index = Random.Range(0, spawnList.Length);
if(spawnList[index] == null) return;</pre></div></li><li><p>Next, we actually spawn the object using our good friend, the <code class="literal">Instantiate</code> function. We pass the object we randomly selected, the position we found, and finally, a random rotation to the <a id="id452" class="indexterm"></a>
<code class="literal">Instantiate</code> function. As a result, the object is created in the scene and set into place.</p><div class="informalexample"><pre class="programlisting">Instantiate(spawnList[index], position, Random.rotation);</pre></div></li><li><p>Finally, we subtract the <code class="literal">frequency</code> variable from our time tracker to finish off the function and the script. This will cause a spawn to occur on every frequency tick without losing any time.</p><div class="informalexample"><pre class="programlisting">  spawnTime -= frequency;
}</pre></div></li><li><p>We now return to Unity to set up the script. Add it to the <code class="literal">PlayerShipPivot</code> object. It will work as well here as anywhere else.</p></li><li><p>To fill the list, just drag your prefabs from the <span class="strong"><strong>Project</strong></span> window and drop them on <span class="strong"><strong>Spawn List</strong></span> in the <span class="strong"><strong>Inspector</strong></span> window. The little triangle to the left of the field will let you expand the list and see what is currently in it. If you want to adjust the chances of the various objects appearing, just change how many of them are in the list. There is nothing keeping you from putting nine references to the asteroid prefab into the list and a single reference to the enemy ship prefab, to give the ship a one in 10 chance of being spawned. Whatever you choose, use the list to set the object chances and include at least one of each obstacle we have created.</p></li><li><p>Finally, test it out. Hit play and fly around to see the objects spawn and fly around.</p><div class="mediaobject"><img src="/graphics/9781849692014/graphics/2014OT_06_07.jpg" /></div></li></ol></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec92"></a>
<span class="emphasis"><em>What just happened?</em></span>
</h3></div></div></div><p>We created a system for<a id="id453" class="indexterm"></a> spawning objects randomly in space. First, we tracked time in the same way as we did for making the enemy ships shoot at the player. Next, we found a random direction and the range with which we determined a position. After that, the system selects a random object from the list and finally spawns it. In order to adjust the chances of any single object appearing, we just adjust how often it appears in the list of objects to be spawned, relative to the other objects in the list.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec93"></a>Have a go hero – more to spawn and shoot</h3></div></div></div><p>Included in the starting assets for this chapter are two more asteroid meshes and a mine. Using these, you can create more objects to be spawned in the game. The mine can also be created with a much larger trigger volume. This would allow it to explode when ships get close, not just hit it. If you were additionally inclined, you could at least make the asteroids randomly pick a scale when they are spawned. This would give the appearance of even greater variety in the asteroids, even though there are only a few.</p><p>Also, try creating another ship or several other ships. Perhaps one is a transport ship and it flees from the player. A hard one would be a ship that splits into two smaller ships when destroyed. Or, just recreate your favorite space ships from your favorite sci-fi media. In this game, the universe is the limit.</p><p>For the Tank Battle game, <a id="id454" class="indexterm"></a>we created a turbo boost button for getting the player across the city quickly. It is also useful for fleeing enemies. Implement it for the space fighter. It would be useful for catching enemies and dodging bullets.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec94"></a>Pop Quiz – understanding Android components</h3></div></div></div><p>Modern mobile devices have many parts that perform a huge variety of functions. Knowing what they are and how they work together is the first step towards being able to use them. Are the following statements true or false?</p><p>Q1. The magnometer and accelerometer work together to give position on a map.</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>True</p></li><li><p>False</p></li></ol></div><p>Q2. The gyroscope detects rotation and movement of the device.</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>True</p></li><li><p>False</p></li></ol></div><p>Q3. 2D positions on the touch screen can be translated into 3D positions in the game.</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>True</p></li><li><p>False</p></li></ol></div><p>Q4. What line of code will allow us to translate the user's touch to a 3D position in the game?</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>
<code class="literal">Camera.main.ScreenPointToRay(Input.GetTouch(0).position)</code>
</p></li><li><p>
<code class="literal">Input.GetMouseButton(0)</code>
</p></li><li><p>
<code class="literal">Camera.main.WorldToScreenPoint(Input.GetTouch(0).position)</code>
</p></li></ol></div><p>Q5. What line of code will give us the device's acceleration?</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>
<code class="literal">Input.gyro</code>
</p></li><li><p>
<code class="literal">Input.compass</code>
</p></li><li><p>
<code class="literal">Input.acceleration</code>
</p></li></ol></div></div></div>