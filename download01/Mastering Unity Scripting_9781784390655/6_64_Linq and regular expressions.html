<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch06lvl1sec66"></a>Linq and regular expressions</h2></div></div><hr /></div><p>Linq, of course, need not work in isolation. It can, for example, be combined with regular expressions to extract specific string patterns from a larger string that converts the matched results into a<a id="id501" class="indexterm"></a> traversable array. This can be especially useful in processing comma-separated value files (CSV files), for example, where data is formatted inside a text file, each entry being separated<a id="id502" class="indexterm"></a> by a comma character. Both Linq and regular expressions can be used to read each value into a unique array element very quickly and easily. For example, consider an RTS game where human names must be generated for new units. The names themselves are stored in a CSV format and are divided into two groups: male and female. On generating a character, it can be either male or female, and an appropriate name must be assigned to them from the CSV data, as shown in the following code sample 6-24:</p><div class="informalexample"><pre class="programlisting">01 //Generate female name
02 //Regular Expression Search Pattern
03 //Find all names prefixed with 'female:' but do not include the prefix in the results
04 string search = @"(?&lt;=\bfemale:)\w+\b";
05 
06 //CSV Data - names of characters
07 string CSVData = "male:john,male:tom,male:bob,female:betty,female:jessica,male:dirk";

08 
09 //Retrieve all prefixed with 'female'. Don't include prefix
10 string[] FemaleNames = (from Match m in Regex.Matches(CSVData, search)

11          select m.Groups[0].Value).ToArray();
12 
13 //Print all female names in results
14 foreach(string S in FemaleNames)
15 Debug.Log (S);
16 
17 //Now pick a random female name from collection
18 string RandomFemaleName = FemaleNames[Random.Range(0, FemaleNames.Length)];</pre></div><p>The following are the comments for code sample 6-24:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>
<span class="strong"><strong>Line 04</strong></span>: The member variable <code class="literal">Search</code> defines a regular expression search pattern. The <code class="literal">Search</code> variable, in this case, is for all words prefixed with <code class="literal">female:</code>. More than<a id="id503" class="indexterm"></a> this, however, the prefix itself should not be included in the resultant strings.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Line 07</strong></span>: The member<a id="id504" class="indexterm"></a> variable <code class="literal">CSVData</code> defines a complete CSV string with both male and female names that are structured in the expected format. This string essentially represents the database or data source.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Lines 10-11</strong></span>: Here, Linq is used in conjunction with a regular expression search to retrieve all female names from the CSV, minus the prefixes. This list is then converted into a string array <code class="literal">FemaleNames</code>.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note24"></a>Note</h3><p>
<span class="strong"><strong>Strings and the @ symbol</strong></span>
</p><p>Notice from line 04 <a id="id505" class="indexterm"></a>of the code sample 6-24 that the regular expression string is prefixed with the symbol <code class="literal">@</code>. This is a C# convention that allows<a id="id506" class="indexterm"></a> you to write a string literal in a source file; this string literal can contain escape sequences (such as <code class="literal">\</code>) without breaking or invalidating the string itself.</p></div></li></ul></div></div>