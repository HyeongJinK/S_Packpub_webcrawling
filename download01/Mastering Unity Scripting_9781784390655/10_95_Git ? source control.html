<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch10lvl1sec95"></a>Git – source control</h2></div></div><hr /></div><p>The term <span class="strong"><strong>source control</strong></span> or <span class="strong"><strong>revision control</strong></span><a id="id712" class="indexterm"></a> refers to any software aimed at making development in practice<a id="id713" class="indexterm"></a> both simpler and safer for as many people as possible. In short, it allows you to track and undo changes to your files easily and quickly, as well as share these changes with others. Typically, software development (including game development) relies on two important facts or ingredients. First, it’s a collective effort where multiple<a id="id714" class="indexterm"></a> developers work together as part of a team, either at the same physical location (such as an office) or across distant locations but sharing a virtual space (such as a virtual office, forum, or even e-mail). Second, during development, developers will tweak, edit, and make improvements to the source code. From these two seemingly simple facts comes a range of important needs that revision control aims to satisfy.</p><p>These needs are as follows:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>
<span class="strong"><strong>Collaboration</strong></span>: When multiple developers work on coding the same project, they’ll usually need to <a id="id715" class="indexterm"></a>share source files. They can send them back and forth through e-mail or other manual methods, but this makes coding difficult on a large scale and on long-term projects. It quickly becomes difficult to monitor the code changes over time and integrate or merge two sets of changes into one file.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Reverting</strong></span>: Sometimes, code changes and improvements turn out to be mistaken. A proposed edit or fix doesn’t always have the intended outcome and must be undone<a id="id716" class="indexterm"></a> or reverted to the earlier state. You can keep copies of the earlier files yourself, but maintaining potentially many copies over time will be tedious and unnecessarily confusing.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Tracking changes and histories</strong></span>: Often, you’ll need to keep track of who does what, especially when debugging. If someone makes a code edit, you’ll want to know who <a id="id717" class="indexterm"></a>changed the code, why, and when. Again, you could manually maintain a logfile, writing in comments and<a id="id718" class="indexterm"></a> entries to document the changed process, but this would be tedious and time consuming.</p></li></ul></div><p>Revision control aims to solve the three main problems of collaboration, reversion, and tracking changes. Revision control software includes Git, Perforce, Microsoft Team Foundation Server, and others. This chapter specifically considers Git; it is widely used, free, cross-platform, and open source. Using Git, you can begin by configuring a special database, known as a<a id="id719" class="indexterm"></a> <span class="strong"><strong>repository</strong></span>, which can be either local (on your computer) or remote (via a network). Then, once configured, you can track and maintain all and any changes to your Unity projects, allowing you to revert to the earlier states of your project, if needed, and to share or collaborate with others. Let’s see how to configure Git for general use using a graphical user interface.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch10lvl2sec58"></a>Step #1 – downloading</h3></div></div></div><p>There are many ways<a id="id720" class="indexterm"></a> to get up and running with Git for Unity projects. This chapter explores a combination of the official Git package alongside the frontend TortoiseGit. Using these two packages, developers can track and maintain all changes to their projects, whether working alone or in a team.</p><p>To get started, download and install the official Git<a id="id721" class="indexterm"></a> software, which is available at <a class="ulink" href="http://git-scm.com/" target="_blank">http://git-scm.com/</a>:</p><div class="mediaobject"><img src="/graphics/9781784390655/graphics/0655OT_10_01.jpg" /><div class="caption"><p>Downloading and installing Git</p></div></div><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip66"></a>Tip</h3><p>Detailed information on using Git can be found in the free, online e-book, <span class="emphasis"><em>Pro Git</em></span>, <span class="emphasis"><em>Scott Chacon and Ben Straub</em></span>, <span class="emphasis"><em>Apress</em></span>, available<a id="id722" class="indexterm"></a> at <a class="ulink" href="http://git-scm.com/book/en/v2" target="_blank">http://git-scm.com/book/en/v2</a>.</p></div><p>After Git is installed <a id="id723" class="indexterm"></a>and downloaded, it’s useful to get TortoiseGit. This is not part of the original Git package but is an optional frontend component for Windows, which it allows you to integrate Git with the Windows shell as well as interact with Git through a GUI rather than the command line.</p><p>To<a id="id724" class="indexterm"></a> download and install TortoiseGit, go to <a class="ulink" href="https://code.google.com/p/tortoisegit/" target="_blank">https://code.google.com/p/tortoisegit/</a>:</p><div class="mediaobject"><img src="/graphics/9781784390655/graphics/0655OT_10_02.jpg" /><div class="caption"><p>Downloading and installing TortoiseGit</p></div></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch10lvl2sec59"></a>Step #2 – building a Unity project</h3></div></div></div><p>The reason to install Git originally was to track and maintain changes to a Unity project, allowing you to revert them if needed, acting as a backup version in case anything happens to the original files, and to<a id="id725" class="indexterm"></a> share changes with other developers. This depends, therefore, on whether <a id="id726" class="indexterm"></a>you already have a Unity project to maintain. The next step, then, after installing both Git and TortoiseGit is to either create a new Unity project or to find an existing one that should be tracked. The following is the screenshot of the Unity project folder:</p><div class="mediaobject"><img src="/graphics/9781784390655/graphics/0655OT_10_03.jpg" /><div class="caption"><p>Viewing a Unity project folder</p></div></div><p>After finding a Unity project, open the project folder in Windows explorer to see the project files. If you don’t know or don’t remember the location of the folder, you could open it directly in explorer from the Unity Editor interface. To achieve this, right-click inside the Unity <span class="strong"><strong>Project</strong></span> panel and select <span class="strong"><strong>Show in Explorer</strong></span> from the context menu:</p><div class="mediaobject"><img src="/graphics/9781784390655/graphics/0655OT_10_04.jpg" /><div class="caption"><p>Accessing the project folder from the Unity interface</p></div></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch10lvl2sec60"></a>Step #3 – configuring Unity for source control</h3></div></div></div><p>Git works with both binary and text files, but it works best with text files. When working with Unity, the editor generates many metadata files for your project and the assets you import. By default, these files are hidden and are in a binary form, and they exist inside the Unity project folder. Some <a id="id727" class="indexterm"></a>of the generated metafiles<a id="id728" class="indexterm"></a> are specific only to the instance of Unity that runs on your computer, such as interface preferences, while other files pertain to assets and data that are part of the project, such as meshes, textures, and script files. To get the best results from Git, you’ll need to adjust Unity’s default behavior by making metafiles visible in the <span class="strong"><strong>Project</strong></span> explorer, and also using text-based formats as opposed to binary formats. To achieve this, go to <span class="strong"><strong>Edit</strong></span> | <span class="strong"><strong>Project Settings</strong></span> | <span class="strong"><strong>Editor</strong></span> from the menu bar.</p><p>From here, use the object inspector to set the <span class="strong"><strong>Version Control</strong></span> field to <span class="strong"><strong>Visible Meta Files</strong></span> and the <span class="strong"><strong>Asset Serialization</strong></span> field to <span class="strong"><strong>Force Text</strong></span>:</p><div class="mediaobject"><img src="/graphics/9781784390655/graphics/0655OT_10_05.jpg" /><div class="caption"><p>Configuring Unity for version control</p></div></div><p>When these settings are changed, you will see a <code class="literal">.meta</code> file associated with each project asset, including scenes. In <a id="id729" class="indexterm"></a>addition, the metafile will be in a human-readable text format, which can even be edited (though manual editing is not recommended). Have a look at the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781784390655/graphics/0655OT_10_06.jpg" /><div class="caption"><p>Viewing a scene asset (in text format) inside a text editor</p></div></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch10lvl2sec61"></a>Step #4 – creating a Git repository</h3></div></div></div><p>The next phase, after creating and configuring a Unity project, is to create the Git database or repository itself that will track and maintain all changes to the Unity files. The repository can be either<a id="id730" class="indexterm"></a> remote (hosted on a network or external computer) or local (hosted on the same computer). The repository will retain the original files and all the changes done to them over time, allowing you to revert to earlier versions of files, if required. The repository can also be shared and merged with other repositories for file sharing. This chapter considers only local repositories, so let’s create one now. To do this, open the Unity project folder (the root folder) and then right-click to show the Windows context menu. From the menu, choose <span class="strong"><strong>Git Init Here</strong></span>:</p><div class="mediaobject"><img src="/graphics/9781784390655/graphics/0655OT_10_07.jpg" /><div class="caption"><p>Creating a Git repository</p></div></div><p>Once created, a new and hidden folder named <code class="literal">.git</code> will be generated. This folder features all the repository files for the project. The icons for files and folders will change to default red symbols, indicating that the files inside the project folder have not yet been added to the repository, so Git cannot track changes made to them (we’ll deal with this soon). This is shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781784390655/graphics/0655OT_10_08.jpg" /><div class="caption"><p>Folders highlighted in red contain files not included in the Git repository</p></div></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch10lvl2sec62"></a>Step #5 – ignoring files</h3></div></div></div><p>The Git repository is now created, ready to receive its first set of files (a <span class="emphasis"><em>commit</em></span>). However, before adding <a id="id731" class="indexterm"></a>them, there are some specific files and types that can safely be ignored. Unity features some project or system-specific files that are less project critical than user critical; that is, some files always contain only user interface preferences as <a id="id732" class="indexterm"></a>well as read-only files, or temps, and other specific data that need not be added to the repository and can be safely ignored. To ignore these, we can create a <code class="literal">.gitignore</code> text file inside the project’s root folder and list all the files and folders to be ignored, as shown here:</p><div class="mediaobject"><img src="/graphics/9781784390655/graphics/0655OT_10_09.jpg" /><div class="caption"><p>Creating a Git ignore file to exclude specific file types from the repository</p></div></div><p>For Unity, this file (<code class="literal">.gitignore</code>) should look as follows. Be sure to put the file inside the root folder:</p><div class="informalexample"><pre class="programlisting">[Ll]ibrary/
[Tt]emp/
[Oo]bj/
[Bb]uild/
/*.csproj
/*.unityproj
/*.sln
/*.suo
/*.user
/*.userprefs
/*.pidb
/*.booproj
sysinfo.txt</pre></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch10lvl2sec63"></a>Step #6 – creating the first commit</h3></div></div></div><p>The repository is now configured to receive the first set of Unity project files. To add these, right-click inside<a id="id733" class="indexterm"></a> the root folder window, and from the context menu, go to <span class="strong"><strong>Git Commit</strong></span> | <span class="strong"><strong>Master</strong></span>. In Git, files are typically submitted not one by one but in batches. The <span class="strong"><strong>Commit</strong></span> window allows you to <a id="id734" class="indexterm"></a>select all files to commit.</p><p>Click on the <span class="strong"><strong>All</strong></span> button to select all files in the folder and then assign a description in the <span class="strong"><strong>Message</strong></span> field to the commit. The message should allow any user to understand the files that the commit contains. When ready, click on <span class="strong"><strong>OK</strong></span> to commit the files:</p><div class="mediaobject"><img src="/graphics/9781784390655/graphics/0655OT_10_10.jpg" /><div class="caption"><p>Submitting the original project files</p></div></div><p>When the commit is completed, the file icons will turn green to indicate a file match, that is, to indicate that the files in the project folder are identical to those in the repository:</p><div class="mediaobject"><img src="/graphics/9781784390655/graphics/0655OT_10_11.jpg" /><div class="caption"><p>Files are up to date with the repository</p></div></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch10lvl2sec64"></a>Step #7 – changing files</h3></div></div></div><p>Git is supposed<a id="id735" class="indexterm"></a> to be a complete file-tracking solution; this means that it should store not only your original files but all the subsequent changes and edits, allowing you to revert to any <a id="id736" class="indexterm"></a>previous version.</p><p>If you now return to Unity and change your files, adding new assets or editing the existing ones, the file icons inside the Windows explorer change to red again, indicating a mismatch between the local files and the repository files:</p><div class="mediaobject"><img src="/graphics/9781784390655/graphics/0655OT_10_12.jpg" /><div class="caption"><p>Changing files</p></div></div><p>If you decide that your most recent changes were a mistake and you’d like to revert back to the changes made last, you can do this by right-clicking inside the project folder window and going to <span class="strong"><strong>TortoiseGit</strong></span> | <span class="strong"><strong>Revert...</strong></span> from the context menu:</p><div class="mediaobject"><img src="/graphics/9781784390655/graphics/0655OT_10_13.jpg" /><div class="caption"><p>Reverting (undoing) recent changes</p></div></div><p>The <span class="strong"><strong>Revert</strong></span> dialog will show, allowing you to select files for reversion. Select all the required files and then <a id="id737" class="indexterm"></a>choose <span class="strong"><strong>OK</strong></span>. Git will then restore all the selected files, overwriting the local versions with the latest versions from the repository:</p><div class="mediaobject"><img src="/graphics/9781784390655/graphics/0655OT_10_14.jpg" /><div class="caption"><p>Select files to revert</p></div></div><p>On the other hand, you might not want to revert or undo the recent changes. Instead, you might have created a valid change; this should be added to the Git repo as the latest version of the files. If so, then simply recommit the files. Right-click inside the project folder window and, from the<a id="id738" class="indexterm"></a> context menu, go to <span class="strong"><strong>Git Commit</strong></span> | <span class="strong"><strong>Master</strong></span>. Be sure to enter a new and descriptive message for the commit inside the <span class="strong"><strong>Message</strong></span> field of the <span class="strong"><strong>Commit</strong></span> dialog.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch10lvl2sec65"></a>Step #8 – getting files from the repo</h3></div></div></div><p>Once the original<a id="id739" class="indexterm"></a> commit of all the files has been made, if you<a id="id740" class="indexterm"></a> were to delete every file in the Unity folder either intentionally or accidentally, except <a id="id741" class="indexterm"></a>for the <code class="literal">.git</code> and <code class="literal">.gitignore</code> files, you could still retrieve all the latest files again. This is because the Git repo contains the files.</p><div class="mediaobject"><img src="/graphics/9781784390655/graphics/0655OT_10_15.jpg" /><div class="caption"><p>You can retrieve deleted files in the project folder from the Git repo</p></div></div><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip67"></a>Tip</h3><p>Of course, if you are really following along with the book by deleting your own files, make sure to keep a manual backup of them, in case anything goes wrong during testing!</p></div><p>To achieve this, right-click inside the project folder window and navigate to <span class="strong"><strong>TortoiseGit</strong></span> | <span class="strong"><strong>Switch/Checkout</strong></span> from the context menu:</p><div class="mediaobject"><img src="/graphics/9781784390655/graphics/0655OT_10_16.jpg" /><div class="caption"><p>Using the Switch/Checkout option to retrieve the latest files from the repo</p></div></div><p>From the <span class="strong"><strong>Switch/Checkout</strong></span> dialog, select the <span class="strong"><strong>Master</strong></span> branch for the <span class="strong"><strong>Switch To</strong></span> field.</p><p>You might also need to enable the <span class="strong"><strong>Force</strong></span> check from the options (see the documentation for more details). Then, click on <span class="strong"><strong>OK</strong></span> to retrieve the latest files. You will see the following screenshot once<a id="id742" class="indexterm"></a> all the files are retrieved:</p><div class="mediaobject"><img src="/graphics/9781784390655/graphics/0655OT_10_17.jpg" /><div class="caption"><p>Retrieving the latest files with checkout</p></div></div><p>Alternatively, you <a id="id743" class="indexterm"></a>might want to switch your project back to an earlier commit in the repo, retrieving not the latest files, but an earlier commit instead. To do this, first go to <span class="strong"><strong>Tortoise Git</strong></span> | <span class="strong"><strong>Switch /Checkout</strong></span> from the context menu to show the <span class="strong"><strong>Checkout</strong></span> dialog. Then, from the <span class="strong"><strong>Switch To</strong></span> group, enable the <span class="strong"><strong>Commit</strong></span> radio box:</p><div class="mediaobject"><img src="/graphics/9781784390655/graphics/0655OT_10_18.jpg" /><div class="caption"><p>Enabling the Commit radio button to retrieve older commits</p></div></div><p>Click the browse button (<span class="strong"><strong>…</strong></span>) next to the <span class="strong"><strong>Commit</strong></span> field to display the repo commits available, and select the earlier version to switch to. Then, click on <span class="strong"><strong>OK</strong></span> to exit the <span class="strong"><strong>Repo Commits</strong></span> dialog, and click on <span class="strong"><strong>OK</strong></span> again to confirm the checkout from the selected commit. The files <a id="id744" class="indexterm"></a>from the selected commit will then be restored to the project folder. Remember that each<a id="id745" class="indexterm"></a> commit has an author (for those working in teams), and this lets you get a picture of who has changed what:</p><div class="mediaobject"><img src="/graphics/9781784390655/graphics/0655OT_10_19.jpg" /><div class="caption"><p>Selecting older commits from the repo to restore</p></div></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch10lvl2sec66"></a>Step #9 – browsing the repo</h3></div></div></div><p>Sometimes, you’ll want to<a id="id746" class="indexterm"></a> neither add nor retrieve files from the repository, but simply browse them to see <a id="id747" class="indexterm"></a>what is there. You can do this quickly and easily using the Repo Browser tool, which is part of TortoiseGit. To access the tool, go to <span class="strong"><strong>TortoiseGit</strong></span> | <span class="strong"><strong>Repo Browser</strong></span> from the context menu:</p><div class="mediaobject"><img src="/graphics/9781784390655/graphics/0655OT_10_20.jpg" /><div class="caption"><p>View the Repo Browser tool</p></div></div><p>The Repo Browser tool allows you to preview the files and hierarchy from a GUI window:</p><div class="mediaobject"><img src="/graphics/9781784390655/graphics/0655OT_10_21.jpg" /><div class="caption"><p>Examining the files inside the repo</p></div></div></div></div>