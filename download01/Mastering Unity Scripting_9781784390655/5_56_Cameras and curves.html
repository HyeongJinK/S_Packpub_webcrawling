<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch05lvl1sec58"></a>Cameras and curves</h2></div></div><hr /></div><p>For cut-scenes, menu backgrounds, or simpler camera fly-throughs, you might just need the camera to travel<a id="id428" class="indexterm"></a> roughly in a straight line that allows some curvature and fluctuation in speed as the camera moves using a smooth-in and smooth-out motion. This<a id="id429" class="indexterm"></a> means that the camera picks up speed at the beginning and slowly drops in speed towards the end of the path. To achieve this, you can use a prescripted animation via Unity's animation editor, or you can use animation curves, which offer a high degree of flexibility and control over object transformations across time, as shown here:</p><div class="mediaobject"><img src="/graphics/9781784390655/graphics/0655OT_05_12.jpg" /><div class="caption"><p>Moving cameras with animation curves</p></div></div><p>To create a camera control script that allows you to control object speed and motion over time, including <a id="id430" class="indexterm"></a>curved motion and smoothing or damping of speed, the<a id="id431" class="indexterm"></a> following code sample 5-12 can be used:</p><div class="informalexample"><pre class="programlisting">//-----------------------------
 using UnityEngine;
 using System.Collections;
 //-----------------------------
 public class CameraMover : MonoBehaviour 
 {
    //-----------------------------
    //Total time for animation
    public float TotalTime = 5.0f;
 
    //Total Distance to move on each axis
    public float TotalDistance = 30.0f;
    //Curves for motion
    public AnimationCurve XCurve;
    public AnimationCurve YCurve;
    public AnimationCurve ZCurve;
 
    //Transform for this object
    private Transform ThisTransform = null;
    //-----------------------------
    void Start()
   {
         //Get transform component
         ThisTransform = GetComponent&lt;Transform&gt;();
 
        //Start animation
        StartCoroutine(PlayAnim());
    }
    //-----------------------------
    public IEnumerator PlayAnim()
    {
         //Time that has passed since anim start
         float TimeElapsed = 0.0f;
 
          while(TimeElapsed &lt; TotalTime)
          {
                //Get normalized time
                float NormalTime = TimeElapsed / TotalTime;
 
               //Sample graph for X Y and Z
               Vector3 NewPos = ThisTransform.right.normalized * XCurve.Evaluate(NormalTime) * TotalDistance;

                NewPos += ThisTransform.up.normalized * YCurve.Evaluate(NormalTime) * TotalDistance;

                NewPos += ThisTransform.forward.normalized * ZCurve.Evaluate(NormalTime) * TotalDistance;
 
               //Update position
               ThisTransform.position = NewPos;
 
               //Wait until next frame
               yield return null;
 
               //Update time
               TimeElapsed += Time.deltaTime;
          }
    }
    //-----------------------------
 
 }
 //-----------------------------</pre></div><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip35"></a>Tip</h3><p>A sample project using animation curves for camera movement can be found in the book's companion files (code bundle) inside the <code class="literal">Camera_Anim_Curves</code> folder of this chapter.</p></div><p>To use the <code class="literal">CameraMover</code> class, attach the script to a camera, and from the Object Inspector, click on each of the <span class="strong"><strong>X</strong></span>, <span class="strong"><strong>Y</strong></span>, and <span class="strong"><strong>Z</strong></span> curve fields to plot the distance and speed of the camera over time. By clicking on a <span class="strong"><strong>Graph</strong></span> swatch, you can edit the graph, thus adding points and defining<a id="id432" class="indexterm"></a> a motion curve to apply for that axis. Notice that the <span class="strong"><strong>X</strong></span>, <span class="strong"><strong>Y</strong></span>, and <span class="strong"><strong>Z</strong></span> motion is plotted to the object's local axes (forward, up, and right) and not to the <a id="id433" class="indexterm"></a>world axes (<span class="emphasis"><em>x</em></span>, <span class="emphasis"><em>y</em></span>, and <span class="emphasis"><em>z</em></span>). This allows the object motion to apply relatively that offers you root-level control of object motion while honoring the relevance of animation data, as shown here:</p><div class="mediaobject"><img src="/graphics/9781784390655/graphics/0655OT_05_13.jpg" /><div class="caption"><p>Plotting motion curves using animation curves</p></div></div><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip36"></a>Tip</h3><p>More information on<a id="id434" class="indexterm"></a> animation curves can be found online in the Unity documentation at <a class="ulink" href="http://docs.unity3d.com/Manual/AnimatorCurves.html" target="_blank">http://docs.unity3d.com/Manual/AnimatorCurves.html</a>.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec39"></a>Camera paths â€“ iTween</h3></div></div></div><p>One very common feature request that, strangely, has not yet been implemented as a native Unity feature is programmable<a id="id435" class="indexterm"></a> motion paths. This refers to the ability to have a <code class="literal">GameObject</code>, such as a camera, smoothly follow a path or spline using spherical interpolation, where the path is defined by a series of connected game objects. This feature already exists in the sense that camera motion can be defined through prescripted animations that are created using Unity's animation editor. However, there is a desire for more<a id="id436" class="indexterm"></a> flexible and programmatic control over a motion path in which the path is defined by a set of waypoints that can be adjusted in code over time. This functionality is especially useful, for example, for space-shooter games where the trajectory of enemy ships clearly follows smooth, curved flight paths that sometimes change according to the position of the player's space ship, as shown in the following screenshot. There are many ways to achieve this in Unity, but a quick and easy solution is to use the freely available add-on, iTween by Bob Berkebile; this can be downloaded and imported directly<a id="id437" class="indexterm"></a> from Unity's Asset Store. More information on iTween can be found at <a class="ulink" href="http://itween.pixelplacement.com/index.php" target="_blank">http://itween.pixelplacement.com/index.php</a>.</p><div class="mediaobject"><img src="/graphics/9781784390655/graphics/0655OT_05_14.jpg" /><div class="caption"><p>Creating camera motion paths with iTween</p></div></div><p>In addition to the default iTween package, you can also download the freely available extension for iTween, namely, the <a id="id438" class="indexterm"></a>Visual iTween Path Editor, which is accessible from <a class="ulink" href="http://pixelplacement.com/2010/12/03/visual-editor-for-itween-motion-paths/" target="_blank">http://pixelplacement.com/2010/12/03/visual-editor-for-itween-motion-paths/</a>.</p><p>After importing both iTween packages, the next step is to start using it to create an object animated along a path. To take the<a id="id439" class="indexterm"></a> example of a camera fly-through, drag-and-drop the script <code class="literal">iTweenPath</code> onto a camera object. This script allows you to create an independent and named path that consists of multiple waypoints, as shown here:</p><div class="mediaobject"><img src="/graphics/9781784390655/graphics/0655OT_05_15.jpg" /><div class="caption"><p>The iTweenPath script allows you to define a path of waypoints</p></div></div><p>To define multiple waypoints for a path, enter the total number of waypoints to create inside the <span class="strong"><strong>Node Count</strong></span> field and then select each node gizmo in the <span class="strong"><strong>Scene</strong></span> viewport that transforms each into place. Notice the curved path drawn between the points that outline the path for the camera to take:</p><div class="mediaobject"><img src="/graphics/9781784390655/graphics/0655OT_05_16.jpg" /><div class="caption"><p>Defining the waypoints for a path</p></div></div><p>Then, to make the camera<a id="id440" class="indexterm"></a> follow the path at runtime, add the following code sample 5-13 script to the camera :</p><div class="informalexample"><pre class="programlisting"> using UnityEngine;
 using System.Collections;
 
 public class cam_itween_mover : MonoBehaviour 
 {
    // Use this for initialization
    void Start () 
    {
<span class="strong"><strong>         iTween.MoveTo(gameObject, iTween.Hash("path", iTweenPath.GetPath("Camera Fly") , "time", 4f, "easetype", iTween.EaseType.easeInOutSine));</strong></span>
    }
 }</pre></div><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip37"></a>Tip</h3><p>More information on iTween and its usage<a id="id441" class="indexterm"></a> can be found online at <a class="ulink" href="http://itween.pixelplacement.com/gettingstarted.php" target="_blank">http://itween.pixelplacement.com/gettingstarted.php</a>.</p></div></div></div>