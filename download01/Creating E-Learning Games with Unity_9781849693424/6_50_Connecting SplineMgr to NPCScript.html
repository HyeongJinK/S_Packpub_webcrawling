<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch06lvl1sec51"></a>Connecting SplineMgr to NPCScript</h2></div></div><hr /></div><p>To prepare a <a id="id292" class="indexterm"></a>spline curve to be used by the <code class="literal">splineMgr</code> class, we can perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Create an empty GameObject, and set its position to (<code class="literal">0</code>,<code class="literal">0</code>,<code class="literal">0</code>). This will be the parent node to the collection of waypoints. Name it something appropriate, such as <code class="literal">curve1</code>.</p></li><li><p>Create a series of spheres named <code class="literal">waypoint1</code>, <code class="literal">waypoint2</code>, and so on. Note, we use GameObjects instead of empty objects so that we can enable the mesh renderer on the nodes if debugging or visualization is necessary. Our system will require a minimum of five points and two segments.</p></li><li><p>Arrange<a id="id293" class="indexterm"></a> these points in the editor so that they form an appealing curve that meets your needs. Note that we interpolate the position of the waypoints only, so rotating them will not impact the trajectory of the interpolation.</p></li><li><p>Create a GameObject that will be used to interpolate the curve. Name it <code class="literal">SplineObj</code> and assign it to the <code class="literal">headObj</code> reference of the <code class="literal">SplineMgr</code> class.</p></li><li><p>Create a <code class="literal">lineRenderer</code> component, and attach it to the <code class="literal">headObj</code> object. Give the <code class="literal">lineRenderer</code> component 1024 position fields to start with so that it has enough pre-allocated segments to draw our curves.</p></li><li><p>Your curve should look something like the one in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781849693424/graphics/3424OS_06_01.jpg" /></div></li><li><p>To playback the spline, create an instance of the <code class="literal">SplineMgr</code> class, and attach it to a GameObject. Set the <code class="literal">dt</code> variable and playback type to <code class="literal">0.1</code> and <code class="literal">loop</code>.</p></li><li><p>Assign <code class="literal">curve1</code> to the <code class="literal">SplineNodeRoot</code> field of the <code class="literal">splineMgr</code> class.</p></li><li><p>Create an instance of <code class="literal">npcScript</code>, and attach it to the <code class="literal">headObj</code> object as well. Assign the <code class="literal">SplineMgr</code> component on the <code class="literal">headObj</code> object to the path reference in the <code class="literal">npcScript</code> class.</p><div class="mediaobject"><img src="/graphics/9781849693424/graphics/3424OS_06_08.jpg" /></div></li><li><p>The <code class="literal">DecisionMgr</code> reference will remain empty for the time being. Not to worry! This just means that the NPC will have no way to change its internal state or react to the player. We will develop this system in the subsequent segment.</p></li><li><p>Once <a id="id294" class="indexterm"></a>you have this system working, feel free to create another curve and another NPC to follow it. By following the same pattern, you can populate your game right away with simple moving objects.</p></li><li><p>Note that by switching from the <code class="literal">const_dt</code> playback to the <code class="literal">const_dist</code> playback, you can get a curve that either moves at a constant speed or finishes in a predictable amount of time. The first is useful for character motion, while the latter is for projectiles, animated objects, and other gameplay elements.</p></li></ol></div><p>Congratulations! Your NPC can now walk along the path. Make sure you have selected the NPC in the editor to show the translation gizmo on the character while it moves; having a large frame of reference can help to debug the motion.</p><p>By ensuring that <code class="literal">showPath</code> is enabled on the NPC Script, your path should look as follows:</p><div class="mediaobject"><img src="/graphics/9781849693424/graphics/3424OS_06_02.jpg" /></div></div>