<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch10lvl1sec89"></a>Using delete/load patterns</h2></div></div><hr /></div><p>Having<a id="id500" class="indexterm"></a> planned how to organize our GameObjects into globally persistent and level-specific lifespans, we must further update <code class="literal">GameMgr.cs</code> to ensure that only the current level is loaded at any time. To do this, perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>In <code class="literal">GameMgr.cs</code>, inside the <code class="literal">ChangeState()</code> method<a id="id501" class="indexterm"></a>, the first thing we do is tell the game to delete any potential level-specific GameObject hierarchies that may be loaded:</p><div class="informalexample"><pre class="programlisting">if (GameObject.Find("_level1")
  Destroy (GameObject.Find ("_level1"));
if (GameObject.Find("_level2")
  Destroy (GameObject.Find ("_level2"));
if (GameObject.Find("_level3")
  Destroy (GameObject.Find ("_level3"));</pre></div></li><li><p>Inside the <code class="literal">switch</code> statement that <code class="literal">ChangeState()</code> implements, we signal a <code class="literal">LoadLevelAdditive()</code> call when changing to <code class="literal">LEVEL1</code>, <code class="literal">LEVEL2</code>, or <code class="literal">LEVEL3</code>. However, when switching to <code class="literal">MAIN</code>, we simply need to destroy the <code class="literal">_level1</code>, <code class="literal">_level2</code>, and <code class="literal">_level3</code> GameObjects since <code class="literal">_global</code> remains persistent throughout.</p></li><li><p>Recall that each <a id="id502" class="indexterm"></a>level-specific scene file must be constructed according to the pattern <code class="literal">_leveln</code> (where <code class="literal">n</code> is 1 for <code class="literal">LEVEL1</code>, 2 for <code class="literal">LEVEL2</code>, and 3 for <code class="literal">LEVEL3</code>). This is because while Unity does provide a function for loading a scene file additively, it does <span class="emphasis"><em>not</em></span> provide a way to unload a scene file once the objects have been loaded. To accomplish this, we perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Ensure that we construct our levels with a single parent GameObject at the root.</p></li><li><p>Name the root GameObject so that it follows a consistent pattern. We use <code class="literal">_level1</code>, <code class="literal">_level2</code>, and <code class="literal">_level3</code> for our scene files.</p></li></ol></div></li><li><p>This permits us to implement an unload scene file functionality by simply destroying the root object. Doing this will destroy the object and all the objects that are children of its hierarchy.</p></li></ol></div><p>Congratulations! You have now finished updating the <code class="literal">GameMgr</code> system to handle loading and unloading scene files. This system of loading additively and naming the scene files consistently may be extended to other gameplay levels.</p></div>