<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch09lvl1sec84"></a>Creating the Time object</h2></div></div><hr /></div><p>The <code class="literal">Time</code> object <a id="id489" class="indexterm"></a>will implement the game's clock functionality in this level. If the time ever reaches zero, this class will display the mission failed pop up. Recall that the source of the added pressure this time around is the clock ticking down to zero. We want this because a little pressure makes the game fun and encourages cognitive flow. Perform the following steps to create the <code class="literal">Time</code> object:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Create a new script named <code class="literal">TimeScript.cs</code>. Add an instance of it to a new GameObject of type <code class="literal">GUIText</code>. Place <code class="literal">GUIText</code> on the left-hand side of the screen opposite the score. Note, this is done by adjusting the <span class="strong"><strong>PixelOffset</strong></span> field of the <code class="literal">GUIText</code> component, and not by moving the transform (this is one of the few exceptions to the rule when placing objects in Unity).</p></li><li><p>A pixel inset of <code class="literal">-60</code>, <code class="literal">-20</code> looks good at a screen resolution of 1024 x 768. Some of the settings for the <code class="literal">GUIText</code> component are shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781849693424/graphics/3424OS_09_12.jpg" /></div></li><li><p>Add the following four variables to the script:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p><code class="literal">public GameObject failPopup</code>: This variable will hold the reference to the pop up that is displayed if the user fails the mission by letting time run out.</p></li><li style="list-style-type: disc"><p><code class="literal">public float starting_time</code>: This variable will store the time when the timer should start before the level ends. Let's remember to set this to <code class="literal">120</code> seconds.</p></li><li style="list-style-type: disc"><p><code class="literal">private float t</code>: This variable will be used to store the current elapsed time.</p></li><li style="list-style-type: disc"><p><code class="literal">public boolean timeElapsed = false</code>: This Boolean variable will store whether or not this timer has reached zero at this time through the level.</p></li></ul></div><p>These <a id="id490" class="indexterm"></a>variables can be declared in the following manner:</p><div class="informalexample"><pre class="programlisting">public GameObject failPopup;
public float starting_time;
private float t;
public boolean timeElapsed = false;</pre></div></li><li><p>Inside the <code class="literal">update()</code> loop, we subtract the actual amount of time elapsed from <code class="literal">t</code> each time <code class="literal">update()</code> is called as shown in the following code:</p><div class="informalexample"><pre class="programlisting">t -= Time.deltaTime;</pre></div></li><li><p>Once the time has elapsed, we tell the camera to look up and then show the fail pop up by setting its enabled flag to <code class="literal">true</code>. We set the local <code class="literal">timeElapsed</code> Boolean to <code class="literal">true</code> as well so that this response cannot show multiple times in a row accidentally:</p><div class="informalexample"><pre class="programlisting">if (t &lt; 0.0f)
{
   GameObject camObj = Camera.main.gameObject;
   if (camObj) {
      camObj.GetComponent&lt;GameCam&gt;().LookUp();
      failPopup.SetActive(true);
      timeElapsed = true; }
}</pre></div></li><li><p>Each time <code class="literal">update()</code> is called, the <code class="literal">Time</code> script will set the text of the <code class="literal">GUIText</code> component to be the string concatenation of <code class="literal">Time</code> and the elapsed time left (cast as an integer). We cast it to an integer to remove the trailing decimal points as shown in the following code:</p><div class="informalexample"><pre class="programlisting">this.gameObject.GetComponent&lt;GUIText&gt;().text = "Time : "+((int)t).ToString ();</pre></div></li></ol></div><p>Congratulations! We now have a working game clock to add just enough game-play pressure to the player in the level. Consider adjusting the amount of time you give to the player based on a difficulty setting in your game, the age of the player, or perhaps on how well the player is actually<a id="id491" class="indexterm"></a> playing in the game. Remember, flow is achieved not only when the task at hand is somewhat challenging, but also in a scenario of moderate pressure.</p><div class="mediaobject"><img src="/graphics/9781849693424/graphics/3424OS_09_05.jpg" /></div></div>