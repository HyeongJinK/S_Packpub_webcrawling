<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch11lvl1sec118"></a>Simulating underwater ambience with audio filters</h2></div></div><hr /></div><p>It doesn't matter how great <a id="id895" class="indexterm"></a>your graphics are: an underwater scene is <a id="id896" class="indexterm"></a>never realistic enough without the muffled sound caused by submersion. In this recipe, we will learn how to simulate that effect whenever our player is under water.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch11lvl2sec411"></a>Getting ready</h3></div></div></div><p>For this recipe, we have prepared a basic scene including a camera controlled by the up and down arrow keys. The scene is available inside the <code class="literal">AudioFilterScene</code> package, within the <code class="literal">0423_11_04</code> folder, where you can also find the <code class="literal">OceanSound.wav</code> audio file.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch11lvl2sec412"></a>How to do it...</h3></div></div></div><p>To simulate underwater ambience, perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Import the <span class="strong"><strong>AudioFilterScene</strong></span> package and the <span class="strong"><strong>OceanSound.wav</strong></span> audio file into your Unity project.</p></li><li><p>Open the <span class="strong"><strong>FilterScene</strong></span> level, inside the <span class="strong"><strong>11_04 AudioFilter</strong></span> folder in the <span class="strong"><strong>Project</strong></span> view.</p></li><li><p>From the <span class="strong"><strong>Project</strong></span> view, drag the <span class="strong"><strong>OceanSound</strong></span> asset into the <span class="strong"><strong>Daylight Simple Water</strong></span> game object in the <span class="strong"><strong>Hierarchy</strong></span> view.</p></li><li><p>In the <span class="strong"><strong>Hierarchy</strong></span> view, select <span class="strong"><strong>Daylight Simple Water</strong></span> and select the <span class="strong"><strong>Loop</strong></span> option of the <span class="strong"><strong>Audio Source</strong></span> component:</p><div class="mediaobject"><img src="/graphics/9781849690423/graphics/0423_12_09.jpg" /></div></li><li><p>In the <span class="strong"><strong>Hierarchy</strong></span> view, select the <span class="strong"><strong>Main Camera</strong></span>. Then, add an <span class="strong"><strong>Audio Low Pass Filter</strong></span> component to it (<span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>Audio</strong></span> | <span class="strong"><strong>Audio Low Pass Filter</strong></span>).</p></li><li><p>Change the component's <span class="strong"><strong>Cutoff Frequency</strong></span> value to <code class="literal">1000</code>:</p><div class="mediaobject"><img src="/graphics/9781849690423/graphics/0423_12_10.jpg" /></div></li><li><p>Create a<a id="id897" class="indexterm"></a> new C# script and rename it as <code class="literal">UnderwaterSound</code>.</p></li><li><p>Open the <span class="strong"><strong>UnderwaterSound</strong></span> script in your editor and replace everything with the following code:</p><div class="informalexample"><pre class="programlisting">using UnityEngine;
using System.Collections;

public class UnderwaterSound : MonoBehaviour
{
    public GameObject oceanObject;
    public float falloff = 1.0f;
    private AudioLowPassFilter filter;
    void Start(){
      filter =  GetComponent&lt;AudioLowPassFilter&gt;();
      filter.enabled = false;
    }
    void Update()
    {
        if (transform.position.y &lt; oceanObject.transform.position.y){
            filter.enabled = true;
            filter.cutoffFrequency = 1000 - (transform.position.y * falloff);
        }else{
            filter.enabled = false;
        }
    }
}</pre></div></li><li><p>Save your script and <a id="id898" class="indexterm"></a>attach it to the <span class="strong"><strong>Main Camera</strong></span> by dragging it from the <span class="strong"><strong>Project</strong></span> view into the game object in the <span class="strong"><strong>Hierarchy</strong></span> window.</p></li><li><p>Drag the <span class="strong"><strong>Water3Example</strong></span> game object from the <span class="strong"><strong>Project</strong></span> view into the <span class="strong"><strong>Ocean Object</strong></span> slot of the <span class="strong"><strong>Underwater Sound</strong></span> component. Also, change the <span class="strong"><strong>Falloff</strong></span> parameter to <code class="literal">20</code>:</p><div class="mediaobject"><img src="/graphics/9781849690423/graphics/0423_12_11.jpg" /></div></li><li><p>Play the scene and press the down arrow key to move the camera down. The filter should <a id="id899" class="indexterm"></a>be activated <a id="id900" class="indexterm"></a>as the camera goes below the water level, dampening the sound.</p></li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch11lvl2sec413"></a>How it works...</h3></div></div></div><p>Once <span class="strong"><strong>Audio Low Pass Filter</strong></span> has been attached, all we need to do is detect whether the camera is below the water level to enable it, also amplifying its effect by raising the <span class="strong"><strong>Cutoff Frequency</strong></span> of the filter as the camera goes down even further.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch11lvl2sec414"></a>There's more...</h3></div></div></div><p>The following are some information on how to fine-tune and customize this recipe:</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch11lvl3sec93"></a>Keeping the Cutoff Frequency unchanged</h4></div></div></div><p>To keep the <a id="id901" class="indexterm"></a>
<span class="strong"><strong>Cutoff Frequency</strong></span> the same regardless of how deep in the water the camera is, just change the <span class="strong"><strong>Falloff</strong></span> value to <code class="literal">0</code>.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch11lvl3sec94"></a>Adding more filters</h4></div></div></div><p>Audio filters can be expensive in terms of processing, but that doesn't mean you can't experiment or use them in you projects. In fact, you could add a second audio filter to this recipe, such as Echo, to make the sound effect more interesting.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch11lvl2sec415"></a>See also</h3></div></div></div><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>The <span class="emphasis"><em>Simulating underwater ambience with Audio filters</em></span> recipe</p></li></ul></div></div></div>