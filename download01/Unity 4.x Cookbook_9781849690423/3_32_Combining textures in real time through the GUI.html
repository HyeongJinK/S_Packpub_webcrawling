<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch03lvl1sec36"></a>Combining textures in real time through the GUI</h2></div></div><hr /></div><p>The customization of <a id="id193" class="indexterm"></a>avatars usually includes the selection of one or more textures that define its looks. In this recipe, we will implement a GUI that allows the player to create their avatar by combining two texture channels.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec112"></a>Getting ready</h3></div></div></div><p>The 3D object and image files needed for this recipe are included in the <code class="literal">selectTexture</code> package, available inside the <code class="literal">0423_03_07</code> folder.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec113"></a>How to do it...</h3></div></div></div><p>To overlay textures, follow these steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Import the Unity package named <code class="literal">selectTexture</code><a id="id194" class="indexterm"></a> into your project.</p></li><li><p>Open the level named <span class="strong"><strong>selTextScene</strong></span>.</p></li><li><p>Let's create our base material: in the <span class="strong"><strong>Project</strong></span> view, use the drop down menu to create a new material. Name it <code class="literal">selectableMaterial</code><a id="id195" class="indexterm"></a>.</p></li><li><p>Change the <span class="strong"><strong>Shader</strong></span> option of the <span class="strong"><strong>selectableMaterial</strong></span> material to <span class="strong"><strong>Decal</strong></span>. Then, apply the texture map named <code class="literal">face1</code> as the <span class="strong"><strong>Base</strong></span> map and <code class="literal">prop1</code> as the <span class="strong"><strong>Decal</strong></span> map, as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781849690423/graphics/0423_03_28.jpg" /></div></li><li><p>Apply the material to the <code class="literal">Avatar</code> game object. You can do this by dragging the material from the <span class="strong"><strong>Project</strong></span> view into the game object's name in the <span class="strong"><strong>Hierarchy</strong></span> view.</p></li><li><p>In the <span class="strong"><strong>Project</strong></span> view, create a new C# script and rename it <code class="literal">SelectTexture</code>.</p></li><li><p>Open <code class="literal">SelectTexture</code> in your script editor and replace everything with the following code:</p><div class="informalexample"><pre class="programlisting">using UnityEngine;
using System.Collections;

public class SelectTexture : MonoBehaviour
{
    public Texture2D[] faces;
    public Texture2D[] props;

    void OnGUI()
    {
        for (int i = 0; i &lt; faces.Length; i++)
            if (GUI.Button(new Rect(0, i * 64, 128, 64), faces[i]))
                ChangeMaterial("faces", i);

        for (int j = 0; j &lt; props.Length; j++)
            if (GUI.Button(new Rect(128, j * 64, 128, 64), props[j]))
                ChangeMaterial("props", j);
    }
    void ChangeMaterial(string category, int index)
    {
        if (category == "faces")
            renderer.material.mainTexture = faces[index];

        if (category == "props")
            renderer.material.SetTexture("_DecalTex", props[index]);
    }
}</pre></div></li><li><p>Save your <a id="id196" class="indexterm"></a>script and apply it to <code class="literal">Avatar</code> game object.</p></li><li><p>In the <span class="strong"><strong>Inspector</strong></span> view, change the <span class="strong"><strong>Size</strong></span> value of both <span class="strong"><strong>Faces</strong></span> and <span class="strong"><strong>Props</strong></span> to <code class="literal">2</code>.</p></li><li><p>Set <span class="strong"><strong>Element 0</strong></span> and <span class="strong"><strong>Element 1</strong></span> of <span class="strong"><strong>Faces</strong></span> to <span class="strong"><strong>face1</strong></span> and <span class="strong"><strong>face2</strong></span> respectively. Do the same for <span class="strong"><strong>Element 0</strong></span> and <span class="strong"><strong>Element 1</strong></span> of <span class="strong"><strong>Props</strong></span> (changing it to <span class="strong"><strong>prop1</strong></span> and <span class="strong"><strong>prop2</strong></span> instead):</p><div class="mediaobject"><img src="/graphics/9781849690423/graphics/0423_03_29.jpg" /></div></li><li><p>Play the scene.<a id="id197" class="indexterm"></a> You will be able to select your texture combination by clicking on the appropriate buttons:</p><div class="mediaobject"><img src="/graphics/9781849690423/graphics/0423_03_30.jpg" /></div></li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec114"></a>How it works...</h3></div></div></div><p>The script allows the user to create two collections of textures: one for the Base map (named <span class="strong"><strong>Faces</strong></span>) and another one for the Decal map (named <span class="strong"><strong>Props</strong></span>). When the scene is played, the textures are displayed inside GUI buttons which can be used to change the texture in the <code class="literal">Avatar</code> game object's material by calling the <code class="literal">ChangeMaterial</code> function<a id="id198" class="indexterm"></a>. This function will receive, as parameters, both the category (either <span class="strong"><strong>Face</strong></span> or <span class="strong"><strong>Prop</strong></span>) and index of the image, assigning the correspondent texture map to the appropriate texture channel.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec115"></a>There's more...</h3></div></div></div><p>This recipe could<a id="id199" class="indexterm"></a> be easily adapted to change other parameters of different material shaders. Check Unity's online documentation to learn about other texture names at <a class="ulink" href="http://unity3d.com/support/documentation/ScriptReference/Material.SetTexture.html" target="_blank">http://unity3d.com/support/documentation/ScriptReference/Material.SetTexture.html</a>. Also, you might want to learn more about shaders by exploring the built-in shaders' source available at <a class="ulink" href="http://unity3d.com/support/resources/assets/built-in-shaders" target="_blank">http://unity3d.com/support/resources/assets/built-in-shaders</a>.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec116"></a>See also</h3></div></div></div><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>The <span class="emphasis"><em>Creating a color selection dialog</em></span> recipe.</p></li></ul></div></div></div>