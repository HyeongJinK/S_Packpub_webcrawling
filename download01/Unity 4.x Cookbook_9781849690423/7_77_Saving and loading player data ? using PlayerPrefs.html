<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch07lvl1sec77"></a>Saving and loading player data – using PlayerPrefs</h2></div></div><hr /></div><p>While the <a id="id522" class="indexterm"></a>previous recipe illustrates how static properties<a id="id523" class="indexterm"></a> allow a game to "remember" values between different scenes, <a id="id524" class="indexterm"></a>
<a id="id525" class="indexterm"></a>those values are "forgotten" once the game application has quit. Unity provides the <code class="literal">PlayerPrefs</code> feature to allow a game to store and retrieve data between different game-playing sessions.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec267"></a>Getting ready</h3></div></div></div><p>This recipe builds upon the previous recipe. In case you haven't completed the previous recipe, we have included a complete project named <code class="literal">BlueSpheres-static</code> in the <code class="literal">0423_07_05</code> folder. In order to follow this recipe, make a copy of that folder as your starting point.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec268"></a>How to do it...</h3></div></div></div><p>To save and load player data, follow these steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Open the <code class="literal">BlueSpheres-static</code> project and delete the <code class="literal">Player</code> C# script.</p></li><li><p>Edit the <code class="literal">MenuStart</code> C# script by replacing the <code class="literal">OnGUI()</code> method with the following code (the <code class="literal">if</code> statement is to be changed):</p><div class="informalexample"><pre class="programlisting">private void OnGUI() {
string rules = "Easiest Game Ever -- Click the blue spheres to add points and advance levels.";
GUILayout.Label(rules);

  if(PlayerPrefs.HasKey("username"))
    WelcomeGUI();
  else
    CreatePlayerGUI();
}</pre></div></li><li><p>Edit the <code class="literal">MenuStart</code> C# script<a id="id526" class="indexterm"></a> by replacing the <code class="literal">ResetGameData()</code> method<a id="id527" class="indexterm"></a> with the following code:</p><div class="informalexample"><pre class="programlisting">private void ResetGameData() {
  PlayerPrefs.DeleteAll();
  playerNameField = DEFAULT_PLAYER_NAME;
}</pre></div></li><li><p>Edit<a id="id528" class="indexterm"></a> the <code class="literal">MenuStart</code> C# script by replacing the first line of the <code class="literal">WelcomeGUI()</code> method<a id="id529" class="indexterm"></a> with the following:</p><div class="informalexample"><pre class="programlisting">string welcomeMessage = "Welcome, " + PlayerPrefs.GetString("username") + ". You currently have " + PlayerPrefs.GetInt("score") + " points.";</pre></div></li><li><p>Also, locate the lines:</p><div class="informalexample"><pre class="programlisting">Player.username = playerNameField;
Player.score = 0;</pre></div><p>And replace them with:</p><div class="informalexample"><pre class="programlisting">PlayerPrefs.SetString("username", playerNameField);
PlayerPrefs.SetInt("score", 0);</pre></div></li><li><p>Now<a id="id530" class="indexterm"></a> edit the <code class="literal">SphereClick</code> C# script by replacing the <code class="literal">ONGUI()</code> and <code class="literal">OnMouseDown()</code> methods<a id="id531" class="indexterm"></a> with the following code:</p><div class="informalexample"><pre class="programlisting">private void OnGUI(){
  GUILayout.Label( "Score: " + PlayerPrefs.GetInt("score") );
}

private void OnMouseDown() {
  if( gameObject.CompareTag("blue") ){
    int newScore = 50 + PlayerPrefs.GetInt("score");
    PlayerPrefs.SetInt("score", newScore);
  }

  Destroy(gameObject);
  GotoNextLevel();
}</pre></div></li><li><p>Edit the <code class="literal">MenuEnd</code> C# script by replacing the first two lines of the <code class="literal">OnGUI()</code> method with the following:</p><div class="informalexample"><pre class="programlisting">GUILayout.Label("Congratulations " + PlayerPrefs.GetString("username"));

GUILayout.Label("You have finished the game, score = " + PlayerPrefs.GetInt("score"));</pre></div></li><li><p>Save your scripts and play the game. Close Unity and then restart the application. You should find that the player's name, level, and score are now kept between game sessions.</p></li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec269"></a>How it works...</h3></div></div></div><p>All we needed to do was to change our code to take advantage of Unity's <code class="literal">PlayerPrefs</code> <code class="literal">Runtime</code> class. <a id="id532" class="indexterm"></a>This class is capable of storing and accessing information (<code class="literal">String</code>, <code class="literal">Int</code>, and <code class="literal">Float</code> variables) in<a id="id533" class="indexterm"></a> the user's machine. Values are stored in a "plist" file (Mac) or the registry (Windows), in <a id="id534" class="indexterm"></a>a similar way to web browser "cookies", and therefore "remembered" between game application sessions.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note23"></a>Note</h3><p>For more information on <code class="literal">PlayerPrefs</code>, see Unity's online documentation at <a class="ulink" href="http://docs.unity3d.com/Documentation/ScriptReference/PlayerPrefs.html" target="_blank">http://docs.unity3d.com/Documentation/ScriptReference/PlayerPrefs.html</a>.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec270"></a>See also</h3></div></div></div><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>The <span class="emphasis"><em>Saving and loading player data – using static properties</em></span> recipe.</p></li></ul></div></div></div>