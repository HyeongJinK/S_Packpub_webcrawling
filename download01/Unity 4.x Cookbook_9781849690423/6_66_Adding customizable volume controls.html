<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch06lvl1sec67"></a>Adding customizable volume controls</h2></div></div><hr /></div><p>Sound volume adjustment can be a very important feature, especially if your game is a standalone. After all, it can be very frustrating needing to access the operational system volume control. In this recipe, we will create a sound volume control GUI that can be switched from a single volume bar to independent music and effects controls.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec228"></a>Getting ready</h3></div></div></div><p>For this recipe, you'll need the <code class="literal">soundFX.wav</code> and <code class="literal">soundtrack.mp3</code> audio files, available in the <code class="literal">0423_06_02</code> folder.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec229"></a>How to do it...</h3></div></div></div><p>To add <a id="id442" class="indexterm"></a>volume control sliders<a id="id443" class="indexterm"></a> to your scene, follow these steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Import the required <code class="literal">soundtrack.mp3</code> audio file.</p></li><li><p>In the <span class="strong"><strong>Project</strong></span> view, select the <code class="literal">soundtrack.mp3</code> file. Make sure the <span class="strong"><strong>3D Sound</strong></span> option of the <span class="strong"><strong>Audio Importer</strong></span> (in the <span class="strong"><strong>Inspector</strong></span> view) is unselected. If not, unselect it.</p></li><li><p>Let's now import the <code class="literal">soundFX.wav</code> audio clip. This time, we will make sure to leave the <span class="strong"><strong>3D Sound</strong></span> option checked.</p></li><li><p>Make sure the <span class="strong"><strong>First Person Controller</strong></span> prefab is available in your project. You can do that by importing it from <span class="strong"><strong>Assets</strong></span> | <span class="strong"><strong>Import Packageâ€¦</strong></span> | <span class="strong"><strong>Character Controller</strong></span>.</p></li><li><p>Add the <span class="strong"><strong>First Person Controller</strong></span> prefab to your scene by dragging it from the <span class="strong"><strong>Project</strong></span> view to the <span class="strong"><strong>Hierarchy</strong></span> view. Then, in the <span class="strong"><strong>Inspector</strong></span> view, reset its<a id="id444" class="indexterm"></a> position to <span class="strong"><strong>X: 0</strong></span>, <span class="strong"><strong>Y:0</strong></span>, <span class="strong"><strong>Z:0</strong></span>, as shown in the <a id="id445" class="indexterm"></a>following screenshot:</p><div class="mediaobject"><img src="/graphics/9781849690423/graphics/0423_06_06.jpg" /></div></li><li><p>Delete the original <span class="strong"><strong>Main Camera</strong></span> from the scene.</p></li><li><p>Expand the <span class="strong"><strong>First Person Controller</strong></span> object in the <span class="strong"><strong>Hierarchy</strong></span> view and select the <span class="strong"><strong>Main Camera</strong></span> child.</p></li><li><p>Drag the <span class="strong"><strong>soundtrack</strong></span> audio clip file from the <span class="strong"><strong>Project</strong></span> view to the bottom of the <span class="strong"><strong>Main Camera Inspector</strong></span> view, adding it as an <span class="strong"><strong>Audio Source</strong></span> component. Check the <span class="strong"><strong>Loop</strong></span> option:</p><div class="mediaobject"><img src="/graphics/9781849690423/graphics/0423_06_07.jpg" /></div></li><li><p>Using the <span class="strong"><strong>Create</strong></span> drop-down of the <span class="strong"><strong>Hierarchy</strong></span> view, add a <span class="strong"><strong>Plane</strong></span> to your scene.</p></li><li><p>In the<a id="id446" class="indexterm"></a> <span class="strong"><strong>Transform</strong></span> component of the <a id="id447" class="indexterm"></a>
<span class="strong"><strong>Inspector</strong></span> view, change the <span class="strong"><strong>Plane's</strong></span> <span class="strong"><strong>Scale X</strong></span> and <span class="strong"><strong>Z</strong></span> values to <span class="strong"><strong>100</strong></span>. Also, change its position to <span class="strong"><strong>X:0</strong></span>, <span class="strong"><strong>Y: -2</strong></span>, <span class="strong"><strong>Z:0</strong></span>. The <span class="strong"><strong>Plane</strong></span> object will be the ground for our scene:</p><div class="mediaobject"><img src="/graphics/9781849690423/graphics/0423_06_08.jpg" /></div></li><li><p>Using the <span class="strong"><strong>Create</strong></span> drop-down of the <span class="strong"><strong>Hierarchy</strong></span> view, add a Cube to your scene and rename it to <code class="literal">FXSource</code>. Set its position to <span class="strong"><strong>X:0</strong></span>, <span class="strong"><strong>Y:0</strong></span>, <span class="strong"><strong>Z:6</strong></span>.</p></li><li><p>Drag the <span class="strong"><strong>soundFX</strong></span> clip from the <span class="strong"><strong>Project</strong></span> view to bottom of the <span class="strong"><strong>FXSource Inspector</strong></span> view, adding it as an <span class="strong"><strong>Audio Source</strong></span> component.</p></li><li><p>In the <span class="strong"><strong>Audio Source</strong></span> component of the <span class="strong"><strong>FXSource</strong></span> cube, check the <span class="strong"><strong>Loop</strong></span> option and set <span class="strong"><strong>Doppler Level</strong></span> to <span class="strong"><strong>0</strong></span>:</p><div class="mediaobject"><img src="/graphics/9781849690423/graphics/0423_06_09.jpg" /></div></li><li><p>Add a <a id="id448" class="indexterm"></a>
<span class="strong"><strong>Directional Light</strong></span> to the scene.</p></li><li><p>In the <span class="strong"><strong>Project</strong></span> view, <a id="id449" class="indexterm"></a>create a new C# script and rename it <code class="literal">VolumeControl</code>.</p></li><li><p>Open the script in your editor and replace everything with the following code:</p><div class="informalexample"><pre class="programlisting">using UnityEngine;
[RequireComponent(typeof(AudioSource))]
public class VolumeControl : MonoBehaviour{
    bool separateSoundtrack = true;
    float minVolume = 0.0f;
    float maxVolume = 1.0f;
    float initialVolume = 1.0f;
    float soundtrackVolume = 1.0f;
    bool displaySliders = false;

    void Start(){
        if (separateSoundtrack){
            audio.ignoreListenerVolume = true;
        }
    }
    void Update(){
        AudioListener.volume = initialVolume;
        if (separateSoundtrack){
            audio.volume = soundtrackVolume;
        }else{
            audio.volume = initialVolume;
        }
    }

    void OnGUI(){
        Event e = Event.current;
        if (e.type == EventType.KeyUp &amp;&amp; e.keyCode == KeyCode.Escape){
            displaySliders = !displaySliders;
        }
        if (displaySliders){
            if (!separateSoundtrack){
                GUI.Label(new Rect(10, 0, 100, 30), "Volume");
                initialVolume = GUI.HorizontalSlider(new Rect(10, 20, 100, 30), initialVolume, minVolume, maxVolume);
            }else{
                GUI.Label(new Rect(10, 0, 100, 30), "Sound FX");
                initialVolume = GUI.HorizontalSlider(new Rect(10, 20, 100, 30), initialVolume, minVolume, maxVolume);
                GUI.Label(new Rect(10, 40, 100, 30), "Music");
                soundtrackVolume = GUI.HorizontalSlider(new Rect(10, 60, 100, 30), soundtrackVolume, minVolume, maxVolume);
            }
        }
    }
}</pre></div></li><li><p>Save your script and attach it to the <span class="strong"><strong>Main Camera</strong></span> by dragging it from the <span class="strong"><strong>Project</strong></span> view to camera game object in the <span class="strong"><strong>Hierarchy</strong></span> view.</p></li><li><p>Play the scene and hit <span class="emphasis"><em>Esc</em></span> in your keyboard. You'll see the volume slidebars on the top-left of the game's viewport.</p></li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec230"></a>How it works...</h3></div></div></div><p>By default, <a id="id450" class="indexterm"></a>every sound in the scene has its volume controlled <a id="id451" class="indexterm"></a>by the <span class="strong"><strong>Volume</strong></span> parameter of the camera's <span class="strong"><strong>Audio Listener</strong></span> component. With our script, we assign the <span class="strong"><strong>Volume</strong></span> slidebar value to that parameter. Also, we create a separate volume bar for the <code class="literal">soundtrack.mp3</code> file, making it independent from the camera's <span class="strong"><strong>Audio Listener</strong></span> component.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec231"></a>There's more...</h3></div></div></div><p>Here is some information on how to fine-tune and customize this recipe.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch06lvl3sec52"></a>Using a single volume bar</h4></div></div></div><p>If you need to simplify the volume controls even more, you can use a single volume bar by leaving the <span class="strong"><strong>Separate Soundtrack</strong></span> option unchecked.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch06lvl3sec53"></a>Bypassing the Esc key</h4></div></div></div><p>If you want your volume bars to be displayed automatically, make sure to tick the checkbox for the parameter named <span class="strong"><strong>Display Sliders</strong></span>.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec232"></a>See also</h3></div></div></div><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>The <span class="emphasis"><em>Making a dynamic soundtrack</em></span> recipe.</p></li><li style="list-style-type: disc"><p>The <span class="emphasis"><em>Pausing the game</em></span> recipe.</p></li></ul></div></div></div>