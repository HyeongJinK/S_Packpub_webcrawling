<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch03lvl1sec38"></a>Animating textures by looping through array of materials (for example, simulated video)</h2></div></div><hr /></div><p>There are <a id="id206" class="indexterm"></a>occasions when you want the material of an object to be animated, for example a simulated computer screen in a spaceship control room, or a clickable object acting as a button to which you wish to draw the player's attention. While Unity Pro offers one solution of a video that can play as a texture, often this is overkill (or not an option if you are using Unity free). So another solution is to use code to change the texture of an object in real time.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec121"></a>Getting ready</h3></div></div></div><p>You'll need a <a id="id207" class="indexterm"></a>set of images that work as a sequence. It's usually a good idea to name them sequentially, for example, <code class="literal">computerScreen1.png</code>, <code class="literal">computerScreen2.png</code>, and so on.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec122"></a>How to do it...</h3></div></div></div><p>To animate textures by looping through an array of materials, follow these steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Start a new scene.</p></li><li><p>Create a <span class="strong"><strong>Plane</strong></span> at (0,0,0), and set its rotation to (-90,0,0), so that it is squarely facing the camera.</p></li><li><p>Create a <code class="literal">ScriptClasses</code> project folder and in that folder create the <code class="literal">AnimatedTexture</code> C# script class (and paste the following code snippet inside this class):</p><div class="informalexample"><pre class="programlisting">// file: AnimatedTexture.cs
using UnityEngine;
using System.Collections;

public class AnimatedTexture : MonoBehaviour 
{
  public float frameInterval = 0.9f;
  public Texture2D[] imageArray;
  private int imageIndex = 0;

  private void Awake() {
    if (imageArray.Length &lt; 1)
      Debug.LogError("no images in array!");
    else
      StartCoroutine( PlayAnimation() );
  }

  private IEnumerator PlayAnimation() {
    while( true ) {
      ChangeImage();
      yield return new WaitForSeconds(frameInterval);
    }
  }

  private void ChangeImage() {
    imageIndex++;
    imageIndex = imageIndex % imageArray.Length;
    Texture2D nextImage = imageArray[ imageIndex ];
    renderer.material.SetTexture("_MainTex", nextImage);
  }
}</pre></div></li><li><p>Add the <code class="literal">AnimatedTexture</code> C# script class as a component of your <span class="strong"><strong>Plane</strong></span> scene object.</p></li><li><p>Populate <a id="id208" class="indexterm"></a>the public array with your sequence of images (you'll need to first set the <code class="literal">size</code> property of the array to the number of images).</p></li><li><p>To control the speed of the animation, in the <span class="strong"><strong>Inspector</strong></span> view choose an appropriate value for the <span class="strong"><strong>Frame Interval</strong></span> public variable:</p><div class="mediaobject"><img src="/graphics/9781849690423/graphics/0423_03_32.jpg" /></div></li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec123"></a>How it works...</h3></div></div></div><p>The <code class="literal">imageArray</code> array<a id="id209" class="indexterm"></a> stores the sequence of images. The <code class="literal">Awake()</code> method<a id="id210" class="indexterm"></a> checks if there are some contents in the array, and starts the <code class="literal">PlayAnimation()</code> method as a co-routine.</p><p>The <code class="literal">PlayAnimation()</code> method<a id="id211" class="indexterm"></a> runs an infinite loop, which calls the method to display the next image in the sequence, and then makes the <code class="literal">PlayAnimation()</code> method wait for the number of seconds set in <code class="literal">frameInterval</code> variable.</p><p>The <code class="literal">ChangeImage()</code> method<a id="id212" class="indexterm"></a> needs to find the next image in the sequence and make the material of the parent game object use that image. The <code class="literal">imageIndex</code> instance variable always stores the array index of the currently displaying image. By adding 1 to this index value, and then applying a modulus operation, the result is the next highest array index, or zero, if the last image has already been displayed. A local <code class="literal">nextImage</code> variable<a id="id213" class="indexterm"></a> is set to store the next image to be displayed from the array, and the main texture of the material of the parent game object is set to this image in the final statement of the method.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec124"></a>There's more...</h3></div></div></div><p>You can also use a similar technique to change materials in real time.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch03lvl3sec35"></a>Using materials rather than Texture2D images</h4></div></div></div><p>If you prefer to work with materials <a id="id214" class="indexterm"></a>rather than texture images, you could use the following code with an array of materials named <code class="literal">materialArray</code><a id="id215" class="indexterm"></a>, and change the shared material of the render of the parent game object, as illustrated in the final statement of this method:</p><div class="informalexample"><pre class="programlisting">  private void ChangeMaterial()	{
    materialIndex++;
    materialIndex = (materialIndex % materialArray.Length);
    Material nextMaterial = materialArray[ materialIndex ]; 
    renderer.sharedMaterial = nextMaterial;
  }</pre></div></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec125"></a>See also</h3></div></div></div><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>The <span class="emphasis"><em>Highlighting materials at mouse over</em></span> recipe.</p></li></ul></div></div></div>