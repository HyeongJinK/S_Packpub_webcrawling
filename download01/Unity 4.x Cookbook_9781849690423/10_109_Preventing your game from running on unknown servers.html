<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch10lvl1sec106"></a>Preventing your game from running on unknown servers</h2></div></div><hr /></div><p>After all the hard work you've done to complete your web game project, it wouldn't be fair if it ended up <a id="id791" class="indexterm"></a>generating traffic and income for someone else's website. In this recipe, we will create a script that prevents the main game menu from showing up unless it's hosted by an authorized server.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch10lvl2sec370"></a>Getting ready</h3></div></div></div><p>To test this recipe, you will need access to a provider where you can host the game.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch10lvl2sec371"></a>How to do it...</h3></div></div></div><p>To prevent your <a id="id792" class="indexterm"></a>web game from being pirated, perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Add the following C# Script to <span class="strong"><strong>Main Camera</strong></span>:</p><div class="informalexample"><pre class="programlisting">// file: BlockAccess
using UnityEngine;
using System.Collections;

public class BlockAccess : MonoBehaviour {
    public bool checkDomain = true;
    public bool fullURL = true;
    public string[] DomainList;
    public string message;
    private bool illegalCopy = true;

    private void Start(){
    print (Application.absoluteURL);
        if (Application.isWebPlayer &amp;&amp; checkDomain){
            int i = 0;
            for (i = 0; i &lt; DomainList.Length; i++){
                if (Application.absoluteURL == DomainList[i]){
                    illegalCopy = false;
                }else if (Application.absoluteURL.Contains(DomainList[i]) &amp;&amp; !fullURL){
                    illegalCopy = false;
                }
            }
        }
    }

    private void OnGUI() {
        if (illegalCopy)
            GUI.Label(new Rect(Screen.width * 0.5f - 200, Screen.height * 0.5f - 10, 400, 32), message);
        else
            Application.LoadLevel(Application.loadedLevel + 1);
    }
}</pre></div></li><li><p>Now fill out its variables. Leave the options <span class="strong"><strong>Check Domain</strong></span> and <span class="strong"><strong>Full URL</strong></span> checked; increase the <span class="strong"><strong>Size</strong></span> of <span class="strong"><strong>Domain List</strong></span> to <span class="strong"><strong>1</strong></span> and fill out <span class="strong"><strong>Element 0</strong></span> with the complete URL for your game. Type in the sentence <code class="literal">This is not a valid copy of the game</code> in the <span class="strong"><strong>Message</strong></span> field, as shown in the following screenshot:</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note50"></a>Note</h3><p>Remember to include the <code class="literal">.unity3d</code> filename and extension in the URL, and not the HTML where it is embedded.</p></div><div class="mediaobject"><img src="/graphics/9781849690423/graphics/0423_10_05.jpg" /></div></li><li><p>Save your scene as <code class="literal">menu</code>.</p></li><li><p>Create a <a id="id793" class="indexterm"></a>new scene and change its <span class="strong"><strong>Main Camera</strong></span> background color to black. Save this scene as <code class="literal">nextLevel</code>.</p></li><li><p>Let's build the game. Navigate to <span class="strong"><strong>File</strong></span> | <span class="strong"><strong>Build Settingsâ€¦</strong></span>, include the scenes <span class="strong"><strong>menu</strong></span> and <span class="strong"><strong>nextLevel</strong></span>, in that order, in the build list (scenes in <span class="strong"><strong>Build</strong></span>). Also, select <span class="strong"><strong>Web Player</strong></span> as your platform and click on <span class="strong"><strong>Build</strong></span>.</p></li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch10lvl2sec372"></a>How it works...</h3></div></div></div><p>As soon as the scene starts, the script compares the actual URL of the <code class="literal">.unity3d</code> file to the ones listed in the <span class="strong"><strong>Block Access</strong></span> component. If they don't match, the next level in the build is not loaded and a message appears on screen.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch10lvl2sec373"></a>There's more...</h3></div></div></div><p>The following is some information on how to fine-tune and customize this recipe:</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch10lvl3sec84"></a>Improving security by using full URLs in your Domain List</h4></div></div></div><p>Your game<a id="id794" class="indexterm"></a> will be more secure if you fill out the <span class="strong"><strong>Domain List</strong></span> with complete URLs (such as <code class="literal">http://www.myDomain.com/unitygame/game.unity3d</code>). In fact, it's recommended that you leave the <span class="strong"><strong>Full URL</strong></span> option selected, so your game won't be stolen and published under a URL such as <code class="literal">www.stolenGames.com/yourgame.html?www.myDomain.com</code>.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch10lvl3sec85"></a>Allowing redistribution with more domains</h4></div></div></div><p>If you want your game to run <a id="id795" class="indexterm"></a>from several different domains, increase <span class="strong"><strong>Size</strong></span> and enter more URLs. Also, you can leave your game completely free of protection by leaving the <span class="strong"><strong>Check Domain</strong></span> option unchecked.</p></div></div></div>