<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch10lvl1sec108"></a>Reducing the number of objects by destroying objects at a "death" time</h2></div></div><hr /></div><p>Optimization principal 2: <span class="emphasis"><em>Minimize the number of objects in a scene</em></span>. As soon as an object is no longer needed, we should destroy it. This saves both memory and also processing resources, since Unity <a id="id810" class="indexterm"></a>no longer needs to send the object <code class="literal">Update()</code> and <code class="literal">OnGUI()</code> messages, or consider collisions or physics for such objects, and so on.</p><p>However, there may be times when we wish not to destroy an object immediately, but at some known future point in time. Examples might include, after a sound has finished playing (see <a class="link" href="#" linkend="ch06">Chapter 6</a>, <span class="emphasis"><em>Playing and Manipulating Sounds</em></span>, for such a recipe), or perhaps the player only has a certain time to collect a bonus object before it disappears, or perhaps an object displaying<a id="id811" class="indexterm"></a> a message to the player should disappear after a certain time (See <a class="link" href="#" linkend="ch04">Chapter 4</a>, <span class="emphasis"><em>Creating GUIs</em></span>, for such a recipe).</p><p>This recipe demonstrates how objects can be told to "start dying", and then to automatically destroy themselves after a given delay has passed.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch10lvl2sec378"></a>How to do it...</h3></div></div></div><p>To destroy objects after a <a id="id812" class="indexterm"></a>specified time, perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Create a cube named <code class="literal">Cube</code>.</p></li><li><p>Add the following script class <code class="literal">DeathTimeExample.cs</code> to <code class="literal">Cube</code>:</p><div class="informalexample"><pre class="programlisting">// file: DeathTimeExample.cs
using UnityEngine;
using System.Collections;

public class DeathTimeExample : MonoBehaviour {
  public float deathDelay = 4f;
  private float deathTime = -1;

  private bool menuMode = true;

  private void OnGUI(){
    if( menuMode )
      GUIMenu();
    else
      GUITimeDisplay();
  }

  private void GUITimeDisplay(){
    float timeLeft = Time.time - deathTime;
    GUILayout.Label("time left before death = " + timeLeft);

  }

  private void GUIMenu(){
    bool startDyingButtonClicked = GUILayout.Button("Start dying");
    if( startDyingButtonClicked ){
      StartDying();
      menuMode = false;
    }
  }

  private void Update() {
    if( deathTime &gt; 0 &amp;&amp; Time.time &gt; deathTime )
      Destroy( gameObject );
  }

  private void StartDying() {
    deathTime = Time.time + deathDelay;
  }
}</pre></div></li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch10lvl2sec379"></a>How it works...</h3></div></div></div><p>The <code class="literal">OnGUI()</code> method<a id="id813" class="indexterm"></a>
<a id="id814" class="indexterm"></a> initially presents a button to the user, which when clicked causes the <code class="literal">StartDying()</code> method<a id="id815" class="indexterm"></a> to be called. After the button is clicked, the time left before the object destroys itself is displayed. Which of the two GUI methods is executed depends on the value of the Boolean variable <code class="literal">menuMode</code>.</p><p>The float variable <code class="literal">deathDelay</code><a id="id816" class="indexterm"></a> stores the number of seconds the object waits before destroying itself, once the decision has been made for the object to start dying. The float variable <code class="literal">deathTime</code><a id="id817" class="indexterm"></a> either has a value of <code class="literal">-1</code> (no death time set yet), or it is a positive value, which is the time we wish the object to destroy itself. When method <code class="literal">StartDying()</code> is called, it sets this <code class="literal">deathTime</code> variable to the current time plus whatever value is set in <code class="literal">deathDelay</code>.</p><p>Every frame <code class="literal">Update()</code> method<a id="id818" class="indexterm"></a> calls the <code class="literal">CheckDeath()</code> method<a id="id819" class="indexterm"></a>. <code class="literal">CheckDeath()</code> tests if <code class="literal">deathTime</code> greater than zero (that is, a death time has been set), and then tests whether the current time has passed the death time. If the death time has passed, then the parent <code class="literal">gameObject</code> is immediately destroyed.</p><p>When you run the scene, you'll see the Cube GameObject removed from the <span class="strong"><strong>Hierarchy</strong></span> panel once its death time has been reached.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch10lvl2sec380"></a>See also</h3></div></div></div><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>The <span class="emphasis"><em>Reducing the number of enabled objects by disabling objects whenever possible</em></span> recipe</p></li></ul></div></div></div>