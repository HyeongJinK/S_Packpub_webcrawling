<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch07lvl1sec80"></a>Animating your own characters with the Microsoft Kinect controller</h2></div></div><hr /></div><p>Perhaps the best <a id="id549" class="indexterm"></a>way to understand how the Zigfu objects and event <a id="id550" class="indexterm"></a>messages can be used in your own Unity projects is to build a basic figure out of cubes, and associate particular cubes with particular skeleton objects. In this recipe, you'll build part of a block character from cubes (a head, left shoulder, elbow, and hand), and use Zigfu scripts to be able to control this arm when the game runs with the Kinect controller attached.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec279"></a>Getting ready</h3></div></div></div><p>Please note that the scripts you'll be using in this recipe can be found in the following folders of the <span class="strong"><strong>Project</strong></span> panel once you have imported the ZDK Unity package:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p><code class="literal">Zigfu/Scripts/UserEngagers/</code></p></li><li style="list-style-type: disc"><p><code class="literal">Zigfu/Scripts/UserControls/</code></p></li><li style="list-style-type: disc"><p><code class="literal">Zigfu/SampleScenes/Scripts/</code></p></li><li style="list-style-type: disc"><p><code class="literal">Standard Assets/Scripts/CameraScripts/</code></p></li></ul></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec280"></a>How to do it...</h3></div></div></div><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Create a new Unity project and import the ZDK package.</p></li><li><p>Add <span class="strong"><strong>Directional Light</strong></span>.</p></li><li><p>Create an empty game object and name it <code class="literal">MyContainer</code>.</p></li><li><p>Create an empty game object named <code class="literal">MyCharacter</code>, and in the <span class="strong"><strong>Hierarchy</strong></span> view, drag this object to become a child of <span class="strong"><strong>MyContainer</strong></span>.</p></li><li><p>Create the following cubes, and in the <span class="strong"><strong>Hierarchy</strong></span> view, drag these objects to become a children of <span class="strong"><strong>MyCharacter</strong></span>:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>A cube named <code class="literal">CubeHead</code> at (0,0,0) sized (0.2, 0.2, 0.2)</p></li><li style="list-style-type: disc"><p>A cube named <code class="literal">CubeShoulderL</code> at (0.2, -0.2, 0) sized (0.2, 0.2, 0.2)</p></li><li style="list-style-type: disc"><p>A cube named <code class="literal">CubeElbowL</code> at (0.5, -0.2, 0) sized (0.2, 0.2, 0.2)</p></li><li style="list-style-type: disc"><p>A cube named <code class="literal">CubeHandL</code> at (0.8, -0.2, 0) sized (0.2, 0.2, 0.2)</p></li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note29"></a>Note</h3><p>The positions of these cubes don't matter since their positions in the game will be controlled by the head/arm positions detected by the Kinect sensor. However, it can be handy to lay them out in an approximation of a block-person to avoid getting confused when adding new cubes.</p></div></li><li><p>Create an empty game object and name it <span class="strong"><strong>Zig</strong></span>:</p><div class="mediaobject"><img src="/graphics/9781849690423/graphics/0423_07_04.jpg" /></div></li><li><p>Add to <span class="strong"><strong>Main Camera</strong></span> the <span class="strong"><strong>SmoothFollow</strong></span> scripted component, set its <span class="strong"><strong>Distance</strong></span> variable<a id="id551" class="indexterm"></a> to <span class="strong"><strong>4</strong></span>, and with <span class="strong"><strong>Main Camera</strong></span> selected, in the <span class="strong"><strong>Inspector</strong></span> view drag <span class="strong"><strong>CubeHead</strong></span> into the public variable <a id="id552" class="indexterm"></a>slot for <span class="strong"><strong>Target</strong></span> for the <span class="strong"><strong>SmoothFollow</strong></span> scripted component.</p></li><li><p>Add the <span class="strong"><strong>Zig</strong></span> scripted component to <span class="strong"><strong>Zig</strong></span>.</p></li><li><p>Add <span class="strong"><strong>ZigEngageSingleUser</strong></span> scripted component to <span class="strong"><strong>Zig</strong></span>.</p></li><li><p>While ensuring <span class="strong"><strong>Zig</strong></span> is selected, in the <span class="strong"><strong>Inspector</strong></span> view for the <span class="strong"><strong>ZigEngageSingleUser</strong></span> component drag <span class="strong"><strong>MyCubeCharacter</strong></span> over the <span class="strong"><strong>Engaged Users</strong></span> public variable (its size should increase from 0 to 1, and <span class="strong"><strong>MyCharacter</strong></span> should be listed as <span class="strong"><strong>Element 0</strong></span>).</p></li><li><p>Add the <span class="strong"><strong>ZigSkeleton</strong></span> scripted component to <span class="strong"><strong>MyCharacter</strong></span>. In the <span class="strong"><strong>Inspector</strong></span> view, ensure the following options are ticked (checked):</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p><span class="strong"><strong>Update Joint Positions</strong></span></p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Update Root Positions</strong></span></p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Update Orientation</strong></span></p></li></ul></div></li><li><p>With <span class="strong"><strong>MyCharacter</strong></span> selected, drag the following cubes in the <span class="strong"><strong>Inspector</strong></span> view:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p><span class="strong"><strong>CubeHead</strong></span> into the public variable slot for <span class="strong"><strong>Head</strong></span></p></li><li style="list-style-type: disc"><p><span class="strong"><strong>CubeShoulderL</strong></span> into the public variable slot for <span class="strong"><strong>Left Shoulder</strong></span></p></li><li style="list-style-type: disc"><p><span class="strong"><strong>CubeElbowL</strong></span> into the public variable slot for <span class="strong"><strong>Left Elbow</strong></span></p></li><li style="list-style-type: disc"><p><span class="strong"><strong>CubeHandL</strong></span> into the public variable slot for <span class="strong"><strong>Left Hand</strong></span></p></li></ul></div></li><li><p>Run the scene. You should<a id="id553" class="indexterm"></a> now<a id="id554" class="indexterm"></a> be controlling the cubes on screen as you move your head and left arm!</p></li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec281"></a>How it works...</h3></div></div></div><p>The <code class="literal">ZigEngageSingleUser</code> component<a id="id555" class="indexterm"></a> applies observed (Kinect input) positions and rotations for skeleton objects to associated game objects in the scene. In step 12, you linked the transforms of the cubes you created with particular skeleton elements that the <code class="literal">ZigEngageSingleUser</code> component is tracking form the Kinect. For each frame, this component applies the position and transform changes to your cubes, and we see our block character move as we move ourselves in front of the camera.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec282"></a>There's more...</h3></div></div></div><p>Here are some details you don't want to miss.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch07lvl3sec64"></a>Completing your block character</h4></div></div></div><p>To complete your block character<a id="id556" class="indexterm"></a>, you might use a capsule game object for the torso, and cubes for the other parts of the arms and legs. You might wish to refer to the Zigfu <code class="literal">Blockman3rdPerson</code> sample scene, since it is essentially the same as this recipe when it has been completed.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec283"></a>See also</h3></div></div></div><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>The <span class="emphasis"><em>Control characters in Unity with the Microsoft Kinect using the Zigfu samples</em></span> recipe.</p></li><li style="list-style-type: disc"><p>The <span class="emphasis"><em>Homemade mocap by storing movements from the Microsoft Kinect controller</em></span> recipe.</p></li></ul></div></div></div>