<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch04lvl1sec42"></a>Displaying an analogue clock</h2></div></div><hr /></div><p>Analogue clocks <a id="id229" class="indexterm"></a>are often more visually appealing, and often worth<a id="id230" class="indexterm"></a> the little extra effort in creating the GUI elements for the clock-face and hands.</p><div class="mediaobject"><img src="/graphics/9781849690423/graphics/0423_04_02.jpg" /></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec135"></a>How to do it...</h3></div></div></div><p>To display <a id="id231" class="indexterm"></a>an analogue clock, please follow these steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Create a new scene, and add a <span class="strong"><strong>Directional light</strong></span> in the direction of the camera.</p></li><li><p>Create the clock face, this is a <span class="strong"><strong>Cylinder</strong></span> with the following properties:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p><span class="strong"><strong>Position</strong></span> (0, 0, 3)</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Rotation</strong></span> (90, 0, 0)</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Scale</strong></span> (13, 0.1, 13)</p></li></ul></div></li><li><p>Create three differently colored or textured materials (for example, red, green, and blue), to be applied to the hands of the clock. Name these materials as <code class="literal">m_seconds</code>, <code class="literal">m_minutes</code>, and <code class="literal">m_hours</code>.</p></li><li><p>Create a new cube named <code class="literal">hand-seconds</code>, apply the <code class="literal">m_seconds</code> material<a id="id232" class="indexterm"></a>, and then turn this into a long, thin second hand by setting the following properties:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p><span class="strong"><strong>Position</strong></span> (0, 2.5, 0)</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Scale</strong></span> (0.1, 5, 1)</p></li></ul></div></li><li><p>Create a new cube named <code class="literal">hand-minutes</code>, apply the <code class="literal">m_minutes</code> material<a id="id233" class="indexterm"></a>, and turn this into a medium long, medium width minute hand by setting the following properties:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p><span class="strong"><strong>Position</strong></span> (0, 2, 1)</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Scale</strong></span> (0.25, 4, 1)</p></li></ul></div></li><li><p>Create a new cube<a id="id234" class="indexterm"></a> named <code class="literal">hand-hours</code>, apply the <code class="literal">m_hours</code> material<a id="id235" class="indexterm"></a>, and turn this into a short, wide hour hand by setting the following properties:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p><span class="strong"><strong>Position</strong></span> (0, 1.5, 2)</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Scale</strong></span> (0.5, 3, 1)</p></li></ul></div></li><li><p>You now need to create <code class="literal">pivot</code> game objects for each hand to rotate around. Create a new empty game object named <code class="literal">hours-pivot</code> at (0,0,0). Make this the parent of <code class="literal">hand-hours</code>. Create another named <code class="literal">minutes-pivot</code> at (0,0,0), and make this the parent of <code class="literal">hand-minutes</code>. Create a final object named <code class="literal">seconds-pivot</code> at (0,0,0), and make this the parent of <code class="literal">hand-seconds</code>.</p></li><li><p>Attach the following script class to the <span class="strong"><strong>Main Camera</strong></span>:</p><div class="informalexample"><pre class="programlisting">// file: ClockAnalogue.cs
using UnityEngine;
using System.Collections;

using System;

public class ClockAnalogue : MonoBehaviour 
{
  public Transform secondHandPivot;
  public Transform minuteHandPivot;
  public Transform hourHandPivot;
  
  private void Update() 
  {
    DateTime time = DateTime.Now;
    float seconds = (float)time.Second;
    float minutes = (float)time.Minute;
    float hours12 = (float)time.Hour % 12;
    float angleSeconds = -360 * (seconds/60);
    float angleMinutes = -360 * (minutes/60);
    float angleHours = -360 * (hours12 / 12);
    
    // rotate each hand
    secondHandPivot.localRotation = Quaternion.Euler(0f, 0f, angleSeconds);
    minuteHandPivot.localRotation = Quaternion.Euler(0f, 0f, angleMinutes);
    hourHandPivot.localRotation = Quaternion.Euler(0f, 0f, angleHours);
  }
}</pre></div></li><li><p>With the <span class="strong"><strong>Main Camera</strong></span> selected in the <span class="strong"><strong>Hierarchy</strong></span> view, drag the three parent "pivot" objects<a id="id236" class="indexterm"></a> for each of the clock hands into the <span class="strong"><strong>Inspector</strong></span> view, for the corresponding public <span class="strong"><strong>Transform</strong></span> variables:</p><div class="mediaobject"><img src="/graphics/9781849690423/graphics/0423_04_03.jpg" /></div></li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec136"></a>How it works...</h3></div></div></div><p>The clock-face is <a id="id237" class="indexterm"></a>constructed as follows:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>The clock-face is a very thin <span class="strong"><strong>Cylinder</strong></span> object</p></li><li style="list-style-type: disc"><p>The three hands are stretched cubes.</p></li><li style="list-style-type: disc"><p>Each object is at a different z-axis position, so they appear to the viewer as follows:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>The clock-face at the back</p></li><li style="list-style-type: disc"><p>Then the fat hour hand</p></li><li style="list-style-type: disc"><p>Then the middle sized minute hand</p></li><li style="list-style-type: disc"><p>And closest to the viewer is the thin long second hand</p></li></ul></div></li></ul></div><p>Every frame's <code class="literal">Update()</code> method rotates all three hands about their clock-face center pivot game object by an angle proportionate to the seconds/minutes/hours of the <code class="literal">DateTime</code> object.</p><p>An angle in<a id="id238" class="indexterm"></a> degrees is calculated as a proportion of 360 for each hand. This angle is used as the amount the object should be rotated about its z axis (calculated using the <code class="literal">Quaternion.Euler()</code> function<a id="id239" class="indexterm"></a> provided by Unity).</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note09"></a>Note</h3><p>Due to the LHS (left-hand-system) arrangement of the z axis in Unity, the rotation angles have to be negative—hence the negative 360 multiplied each time for the calculations for each clock hand angle in degrees.</p></div><p>Each clock-hand has its original position arranged as the center of the clock-face, and then half the length of the hand added to the y-axis co-ordinate. For example, the clock face has a center of (0,0,0), and the second hand is a cube with a y-axis scale of 5, so its center is (0, 2.5, 0). This means that each hand, when rotated around the center of the clock-face, moves correctly. The width of the hands is determined by the x-axis scaling, so the second hand is thin (x-axis scale is 0.1) and long (y-axis scale is 5), while the hour hand is wide (x-axis scale is 0.5) and short (y-axis scale is 3). The wider short hands are further from the user (larger z-axis positions), and the thinner long hands are nearer the user, so that the wide hour hand can be seen behind the thinner minute and second hands even when pointing to the same clock-face position.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec137"></a>There's more...</h3></div></div></div><p>Here are some details you don't want to miss.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch04lvl3sec39"></a>Configuring a screen corner clock camera</h4></div></div></div><p>Usually, <a id="id240" class="indexterm"></a>a clock does not take up the whole screen, and one method of having a view of a <code class="literal">GameObject</code> that only takes up part of the screen, is by having a second camera. The following screenshot shows a scene where the Main Camera shows a cube, but a second camera (<span class="strong"><strong>Camera – clock</strong></span>) has been created to display in the top-right corner of the screen:</p><div class="mediaobject"><img src="/graphics/9781849690423/graphics/0423_04_04.jpg" /></div><p>By default, cameras display to a "normalized viewport" of the whole screen (0,0)-(1,1). However, by <a id="id241" class="indexterm"></a>setting the rectangle of a camera's normalized viewport to less than the whole screen, the desired effect can be created, as shown in the following screenshot. Our second <span class="strong"><strong>Camera – clock</strong></span> camera has a viewport rectangle of (0.8,0.8)-(1,1) which defines the 20 percent top-right corner of the screen, as we can see in.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note10"></a>Note</h3><p>Remove the <span class="strong"><strong>AudioListener</strong></span> component from the second camera, since each scene should only have one such component.</p></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note11"></a>Note</h3><p>To ensure the content of our clock is displayed in front of the <span class="strong"><strong>Main Camera</strong></span> content, we need to set the Depth of our clock camera to 1, and to set its <span class="strong"><strong>Clear Flags</strong></span> property to <span class="strong"><strong>Depth Only</strong></span>.</p></div><div class="mediaobject"><img src="/graphics/9781849690423/graphics/0423_04_05.jpg" /></div></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec138"></a>See also</h3></div></div></div><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>The <span class="emphasis"><em>Displaying a digital clock</em></span> recipe.</p></li></ul></div></div></div>