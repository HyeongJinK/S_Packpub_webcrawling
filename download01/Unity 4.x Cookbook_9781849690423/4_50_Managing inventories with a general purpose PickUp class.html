<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch04lvl1sec53"></a>Managing inventories with a general purpose PickUp class</h2></div></div><hr /></div><p>There<a id="id297" class="indexterm"></a> are often several different kinds of items players are <a id="id298" class="indexterm"></a>expected to pick up and collect during a game (keys, extra lives, items that score points, and so on). A general <code class="literal">PickUp</code> class to represent the properties for each pickup item can be very useful, and the GUI display of inventory items can be made straightforward using a C# <code class="literal">List&lt;T&gt;</code> collection of such objects.</p><div class="mediaobject"><img src="/graphics/9781849690423/graphics/0423_04_20.jpg" /></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec182"></a>Getting ready</h3></div></div></div><p>In the <code class="literal">0423_04_13</code> folder <a id="id299" class="indexterm"></a>you'll find a selection of images and icons for keys and hearts.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec183"></a>How to do it...</h3></div></div></div><p>To display graphical icons for a general purpose inventory, please follow these steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Create a new scene and add a directional light.</p></li><li><p>Create a new terrain size, with <span class="strong"><strong>Size</strong></span> set to 2000 x 2000 and positioned at (-1000, 0, -1000). Now, apply a texture to it.</p></li><li><p>Create the following C# script class:</p><div class="informalexample"><pre class="programlisting">// file: PickUp.cs
using UnityEngine;
using System.Collections;

public class PickUp : MonoBehaviour {
  public enum PickUpCategory{
    KEY, HEALTH, SCORE
  }
  
  public Texture icon;
  public int points;
  public string fitsLockTag;
  public PickUpCategory catgegory;
}</pre></div></li><li><p>Import the built-in <span class="strong"><strong>Character Controller</strong></span> Unity package and add a <span class="strong"><strong>3rd Person Controller</strong></span> to your scene at position (0, 1, 0).</p></li><li><p>Attach the<a id="id300" class="indexterm"></a> following C# script class to your <span class="strong"><strong>3rd Person Controller</strong></span>:</p><div class="informalexample"><pre class="programlisting">// file: GeneralInventory.cs
using UnityEngine;
using System.Collections;
using System.Collections.Generic;

public class GeneralInventory : MonoBehaviour {
  const int ICON_HEIGHT = 32;
  private List&lt;PickUp&gt; inventory = new List&lt;PickUp&gt;();
  
  private void OnGUI(){
    // restrict display to left of screen
    Rect r = new Rect(0,0,Screen.width/2, ICON_HEIGHT);
    GUILayout.BeginArea(r);
    GUILayout.BeginHorizontal();
    
    DisplayInventory();
    
    GUILayout.FlexibleSpace();
    GUILayout.EndHorizontal();
    GUILayout.EndArea();
  }
  
  private void DisplayInventory(){
    foreach (PickUp item in inventory)
        GUILayout.Label( item.icon );
  }
  
  private void OnTriggerEnter(Collider hitCollider){
    if( "pickup" == hitCollider.tag ){
      PickUp item = hitCollider.GetComponent&lt;PickUp&gt;();
      inventory.Add( item );
      Destroy ( hitCollider.gameObject );
    }
  }
}</pre></div></li><li><p>Create a cube named <code class="literal">Cube – health</code> at position (0, 1, 5) with scale (2, 2, 2), and do the<a id="id301" class="indexterm"></a> following (use the next screenshot as a reference):</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>Tag this objet with <span class="strong"><strong>pickup</strong></span></p></li><li style="list-style-type: disc"><p>Tick its <span class="strong"><strong>Is Trigger</strong></span> checkbox</p></li><li style="list-style-type: disc"><p>Add the <code class="literal">PickUp</code> script class as a component of this object</p></li><li style="list-style-type: disc"><p>Drag the heart icon into the <span class="strong"><strong>Inspector</strong></span> view for the corresponding public variable</p></li><li style="list-style-type: disc"><p>Choose <span class="strong"><strong>HEALTH</strong></span> form the <span class="strong"><strong>Category</strong></span> dropdown list</p></li><li style="list-style-type: disc"><p>Add the heart image to the material for this object</p></li></ul></div><div class="mediaobject"><img src="/graphics/9781849690423/graphics/0423_04_21.jpg" /></div></li><li><p>Make several duplicates of <span class="strong"><strong>Cube – health</strong></span>, and change some of them to have colored key images and icons as appropriate. This will ensure that there are several different items for the player to pick up in your game.</p></li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec184"></a>How it works...</h3></div></div></div><p>The <code class="literal">PickUp</code> class has no methods, but it declares several useful public variables. It also declares a public <code class="literal">enum</code> category defining three possible categories of pickups: <code class="literal">KEY</code>, <code class="literal">HEALTH</code>, and <code class="literal">SCORE</code>. Each object of the <code class="literal">PickUp</code> class can define an image icon, an integer number of points, a string (for key items, the tag of locks that such a key would fit), and which of the <code class="literal">enum</code> categories each <code class="literal">PickUp</code> item belongs to.</p><p>Game objects can have a scripted object of the <code class="literal">PickUp</code> added as a component. In this recipe, cubes with images to illustrate what they are have been used, but the game objects the player meets in the game world could be interactive 3D objects or whatever. Each game object with a <code class="literal">PickUp</code> component needs to have its properties set appropriately. For example, yellow key objects should have a yellow key icon assigned, be set as being in the <code class="literal">KEY</code> category, and have the <span class="strong"><strong>tag</strong></span> string set for locks it can open.</p><p>The player's character<a id="id302" class="indexterm"></a> controller has the <code class="literal">GeneralInventory</code> script added. This is a relatively straightforward GUI script that has two main functions: first, it maintains a <code class="literal">List&lt;T&gt;</code> collection of <code class="literal">PickUp</code> objects, representing items the player is "carrying" at any point in time, and it displays the icons for each item via the <code class="literal">OnGUI()</code> method. Second, it detects collisions with pickup game objects via the <code class="literal">OnTriggerEnter()</code> method, and objects tagged <code class="literal">pickup</code> that are collided with are added to the inventory list.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec185"></a>There's more...</h3></div></div></div><p>Here are some details you don't want to miss:</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch04lvl3sec49"></a>Responding to non-display pickups</h4></div></div></div><p>By having<a id="id303" class="indexterm"></a> different categories of pickups, the actions for collisions can be different. So perhaps for <code class="literal">HEALTH</code> pickups, the <code class="literal">Points</code> value is added to the player's health, and the object is destroyed rather than being added to the inventory. This would simply require an <code class="literal">if</code> or a <code class="literal">case</code> statement inside the <code class="literal">OnTriggerEnter()</code> method to decide what to do once an object tagged <code class="literal">pickup</code> has been collided with.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch04lvl3sec50"></a>Removing items from the List&lt;&gt; collection</h4></div></div></div><p>Events <a id="id304" class="indexterm"></a>may occur (for example, open a door for a key being carried) that result in an item needing to be removed from the inventory <code class="literal">List&lt;&gt;</code>. For example, if a yellow door were collided with, and the player was carrying a key that could open such doors, then that item should be removed from the inventory <code class="literal">List&lt;&gt;</code> collection and the door be opened. To implement this, you would need to add an <code class="literal">if</code> statement test inside <code class="literal">OnTriggerEnter()</code> to detect a collision with the item tagged <code class="literal">yellowDoor</code>:</p><div class="informalexample"><pre class="programlisting">if( "yellowDoor" == hitCollider.tag )
  OpenDoor(hitCollider.gameObject);</pre></div><p>The <code class="literal">OpenDoor()</code> method would need to identify which item (if any) in the inventory can open such a door, and if found, then that item should be removed from the <code class="literal">List&lt;&gt;</code> collection and the door be opened by the appropriate method:</p><div class="informalexample"><pre class="programlisting">private void OpenDoor(GameObject doorGO){
  // search for key to open the tag of doorGO
  int colorKeyIndex = FindItemIndex(doorGO.tag);
  if( colorKeyIndex &gt; -1 ){
    // remove key item
    inventory.RemoveAt( colorKeyIndex );
    
    // now open the door ...
    doorGO.animation.Play ("open");
  }
}

private int FindItemIndex(string doorTag){
  for (int i = 0; i &lt; inventory.Count; i++){
    PickUp item = inventory[i];
    if( item.fitsLockTag == doorTag )
      return i;
  }
}</pre></div></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec186"></a>See also</h3></div></div></div><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>The <span class="emphasis"><em>Displaying inventory text for single object pickups</em></span> recipe.</p></li><li style="list-style-type: disc"><p>The <span class="emphasis"><em>Displaying inventory icons for single object pickups</em></span> recipe.</p></li></ul></div></div></div>