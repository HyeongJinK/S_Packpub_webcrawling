<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch06lvl1sec65"></a>Tile-based level creation</h2></div></div><hr /></div><p>For most games with <a id="id309" class="indexterm"></a>content, you'll typically have levels, each with their own environments. When building levels in games, there are some advantages to placing everything by hand, but if you're creating a game with many levels, that work will decrease your productivity. It's also important to note that the more assets you create for your game, the higher the cost will be in terms of development time and/or price to hire someone to do the art for you.</p><p>With that in mind, it's a much better idea to create parts that can be reused to create games. If you've played older 2D games in the past, such as an adventure, RPG, or platforming game, you may have realized that there were a lot of places in the world that looked similar to each other, such as the trees, a wall, chest, and door.</p><p>The reason they looked similar is due to the fact that they were using the same sprites. This is because they were tile-based games. A tile-based game is where the playing area consists of small rectangular, square, or hexagonal graphic images, referred to as tiles. Imagine a grid of blocks where every block is given a number or ID. Based on the ID, the game will determine how that grid is drawn and behaves when a player interacts with it.</p><p>An important thing to mention is that tile-based games are not a distinct genre; rather, the term refers to the technology a game engine uses for its visual representation. For example, most of the <span class="emphasis"><em>Pokémon</em></span> series of games are top-down role-playing video games and the traditional <span class="emphasis"><em>Mario</em></span> series of games are side-scrolling platformers, but both use a tile-based system for graphics. Tile-based techniques allow developers to create large levels quickly with relatively few art assets, which is great as a programmer.</p><p>To show how easy it is to build, we will be coding a tile-based system for this project:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>The first thing that we're going to want to do is actually create the blocks we'll be placing for the world. Let's first create a <span class="strong"><strong>Cube</strong></span> by selecting <span class="strong"><strong>GameObject</strong></span> | <span class="strong"><strong>3D Object</strong></span> | <span class="strong"><strong>Cube</strong></span>.</p></li><li><p>We want this cube to have collision so our player can collide against it, but this time, we will<a id="id310" class="indexterm"></a> use a <span class="strong"><strong>Box Collider</strong></span>. Check the <span class="strong"><strong>Inspector</strong></span> to confirm that it is there. If not, add this component by selecting <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>Physics</strong></span> | <span class="strong"><strong>Box Collider</strong></span>:</p><div class="mediaobject"><img src="/graphics/9781785883118/graphics/B05212_06_02.jpg" /></div></li></ol></div><p>The <span class="strong"><strong>Box Collider</strong></span> is<a id="id311" class="indexterm"></a> the 3D equivalent of the <span class="strong"><strong>Box Collider 2D</strong></span> component for 3D space.</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Rename the cube to <code class="literal">Wall</code> by selecting the top bar on the <span class="strong"><strong>Inspector</strong></span>, renaming it and pressing <span class="emphasis"><em>Enter</em></span>:</p><div class="mediaobject"><img src="/graphics/9781785883118/graphics/B05212_06_03.jpg" /></div></li><li><p>In the <span class="strong"><strong>Project</strong></span> tab, go to the <span class="strong"><strong>Prefabs</strong></span> folder in the Project Browser and drag and drop the <span class="strong"><strong>Wall</strong></span> object from our <span class="strong"><strong>Hierarchy</strong></span> into it. Once that is finished, select the <span class="strong"><strong>Wall</strong></span> object in the <span class="strong"><strong>Hierarchy</strong></span> tab and then delete it by pressing the <span class="emphasis"><em>Delete</em></span> key.</p></li><li><p>Now we will <a id="id312" class="indexterm"></a>be spawning a large amount of objects into our world. It would be a good idea to have a parent object to store all of these objects. To do this, let's create an empty game object by going to <span class="strong"><strong>GameObject</strong></span> | <span class="strong"><strong>Create Empty</strong></span>. From there with the object selected go to the <span class="strong"><strong>Inspector</strong></span> and set its name to <code class="literal">Dynamic Objects</code> and optionally for neatness sake, set its <span class="strong"><strong>Position</strong></span> to (<code class="literal">0, 0, 0</code>).</p></li><li><p>The next thing we are going to do is create a <span class="strong"><strong>Game Controller</strong></span> to hold the behavior to create our blocks. Create an empty game object with a name of <code class="literal">Game Controller</code> and reset its <span class="strong"><strong>Position</strong></span> to (<code class="literal">0, 0, 0</code>). Once created, from the <span class="strong"><strong>Hierarchy</strong></span> tab, drag and drop the object to the top of the <span class="strong"><strong>Hierarchy</strong></span> to make it easier to access.</p></li><li><p>Underneath the name, you'll see the <span class="strong"><strong>Tag</strong></span> property. Change it from <code class="literal">Untagged</code> to <code class="literal">GameController</code>:</p><div class="mediaobject"><img src="/graphics/9781785883118/graphics/B05212_06_04.jpg" /></div></li><li><p>Next, select <span class="strong"><strong>Add Component | New Script</strong></span> once brought to the next menu, change the<a id="id313" class="indexterm"></a> language to <span class="strong"><strong>C Sharp</strong></span> (C#) and set the name of the script to <span class="strong"><strong>GameController</strong></span> and then hit <span class="strong"><strong>Create and add</strong></span>:</p><div class="mediaobject"><img src="/graphics/9781785883118/graphics/B05212_06_05.jpg" /></div></li><li><p>Select the newly created script and move it to the <code class="literal">Assets\Scripts</code> folder. Go into your IDE of choice by double-clicking on the script file.</p></li><li><p>Inside the newly <a id="id314" class="indexterm"></a>created code, we will first need to add two new variables for us to use—a level that will contain the data needed to create our level and Wall which will contain the block we want to spawn:</p><div class="informalexample"><pre class="programlisting">private int[][] level = new int[][]
{
    new int[]{1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1},
    new int[]{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
    new int[]{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
    new int[]{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
    new int[]{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1},
    new int[]{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1},
    new int[]{1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1},
    new int[]{1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
    new int[]{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
    new int[]{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
    new int[]{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
    new int[]{1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
    new int[]{1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1},
    new int[]{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1},
    new int[]{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
    new int[]{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1},
    new int[]{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1},
    new int[]{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1},
    new int[]{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1},
    new int[]{1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1},
    new int[]{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1},
    new int[]{1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1},
    new int[]{1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1},
    new int[]{1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1},
    new int[]{1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1}
};
    public Transform wall;</pre></div></li></ol></div><p>The wall variable looks<a id="id315" class="indexterm"></a> similar to things we've created before, but the level variable looks a bit different.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec34"></a>Working with arrays</h3></div></div></div><p>The level variable is<a id="id316" class="indexterm"></a> an <span class="strong"><strong>array</strong></span>. We could create an integer for each <a id="id317" class="indexterm"></a>place inside of our level detailing what type is there; however, that is quite tedious and we'd have to remember each element's identifier. An array is a holder of multiple elements of the same type. To access an individual element of the array, we simply need to specify an index of where it is placed in between the square brackets (the <code class="literal">[ </code>and <code class="literal">]</code> characters). Arrays are played sequentially in memory, which means that it's really easy to move between elements of them and it's a very fast operation to access an individual element.</p><p>The level variable<a id="id318" class="indexterm"></a> is actually a multidirectional array, which can be thought of as an array of integers. We will use a multidirectional array because it allows us to "draw" with numbers like a grid to place each of the elements in our level.</p><p>This being said, now we actually need to build the level. To do this:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Let's create a function named <code class="literal">Bu</code>
<code class="literal">ildLevel</code>:</p><div class="informalexample"><pre class="programlisting">    void BuildLevel() 
    {
/*
Get the DynamicObjects object that we created already in the scene so we can make it our newly created
objects' parent
*/
        GameObject dynamicParent = GameObject.Find ("Dynamic Objects");
        //Go through each element inside our level variable
        for (int yPos = 0; yPos &lt; level.Length; yPos++)
        {
            for (int xPos = 0; xPos &lt; (level[yPos]).Length; xPos++)
            {
                // Do nothing if the value is 0
                // If the value is 1, we want a wall
                if (level[yPos][xPos] == 1)
                {
                // Create the wall
                Transform newObject = Instantiate (wall, new Vector3(xPos, (level.Length - yPos), 0), wall.rotation) as Transform;
/*
Set the object's parent to the
DynamicObjects variable so it doesn't clutter our Hierarchy
*/
               newObject.parent = dynamicParent.transform;
              }
          }
        }
    }</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note43"></a>Note</h3><p>The <code class="literal">Quaternion</code> class is what is used for rotations inside of Unity. In this instance, we are using the object's original rotation. For more information on quaternions, please<a id="id319" class="indexterm"></a> check <a class="ulink" href="http://docs.unity3d.com/ScriptReference/Quaternion.html" target="_blank">http://docs.unity3d.com/ScriptReference/Quaternion.html</a>.</p></div><p>As you can see, we access each of the arrays stored in a <code class="literal">level</code> by using <code class="literal">array[index]</code> and for an index inside of that array we use array[<code class="literal">index1</code>][<code class="literal">index2</code>].</p></li><li><p>Next, we need to<a id="id320" class="indexterm"></a> actually call this function. Do so in your <code class="literal">Start</code> function:</p><div class="informalexample"><pre class="programlisting">void Start () 
{
    BuildLevel();
}</pre></div></li><li><p>Save the script and exit out to the Unity Editor. When you get back, you should see under the <span class="strong"><strong>Game Controller</strong></span> script that there is the Wall variable that still needs a value for its variable. In order to assign the prefab we created previously, we'll need to go to the folder and then drag and drop it there without releasing our mouse:</p><div class="mediaobject"><img src="/graphics/9781785883118/graphics/B05212_06_06.jpg" /></div></li><li><p>After this, press<a id="id321" class="indexterm"></a> the <span class="strong"><strong>Start</strong></span> button to see the code execute:</p><div class="mediaobject"><img src="/graphics/9781785883118/graphics/B05212_06_07.jpg" /></div></li></ol></div><p>You may see a bit of the result in the <span class="strong"><strong>Game</strong></span> screen that pops up, but if you click on the <span class="strong"><strong>Scene</strong></span> tab, you'll see the level has been built for us!</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note44"></a>Note</h3><p>You can<a id="id322" class="indexterm"></a> drag and drop the <span class="strong"><strong>Scene</strong></span> tab to share the space with the <span class="strong"><strong>Game</strong></span> tab if you'd like, as you can see in the preceding picture. </p><p>There are a number of other ways you may modify your layout as well. There are also some provided ones as well, which may help your workflow.</p><p>To view them, you can go to the <span class="strong"><strong>Window</strong></span> | <span class="strong"><strong>Layouts</strong></span> menu or select the rightmost dropdown on the toolbar.</p><p>I personally use the <span class="strong"><strong>Default</strong></span> layout for this book, but when I have two monitors, I like to spread things out with the <span class="strong"><strong>Game</strong></span> tab on one monitor and everything else.</p><p>One of our technical editors prefers the 2 by 3 layout with a one-column project tab (right-click on the <span class="strong"><strong>Project</strong></span> tab and then select one-column layout.</p></div></div></div>