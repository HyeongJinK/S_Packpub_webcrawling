<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch01lvl1sec12"></a>Shooting behavior</h2></div></div><hr /></div><p>The<a id="id40" class="indexterm"></a> next thing we will do is give our player the ability to shoot:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Open up the <code class="literal">PlayerBehaviour</code> script. In the top section where the other variables are present, we need to add some additional ones that we'll use:</p><div class="informalexample"><pre class="programlisting">// The laser we will be shooting
public Transform laser;

// How far from the center of the ship should the laser be
public float laserDistance = .2f;

// How much time (in seconds) we should wait before 
// we can fire again
public   float   timeBetweenFires = .3f;

// If value is less than or equal 0, we can fire
private float timeTilNextFire = 0.0f;</pre></div><p>One thing you may have noticed is that we have a <code class="literal">laser</code> variable that is of the type <code class="literal">Transform</code>. This is the laser we'll fire, which we will create shortly.</p><p>In our game, the player may want to shoot using either my clicking or the <span class="emphasis"><em>Space</em></span> key. You may even want to use something else. Rather than restricting the player to just having one button or using an Axis like we did previously, we will store all of the possible ways to shoot in their own container. To do this, we are going to use a <span class="strong"><strong>list</strong></span>, which is a holder for multiple objects that we can add or remove while the game is being played. However, to use a list, we will need to add the following to the top of our code:</p><p>
<code class="literal">using System.Collections.Generic; // List</code>
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note10"></a>Note</h3><p>For more information on lists, check out <a class="ulink" href="http://msdn.microsoft.com/en-us/library/6sh2ey19(v=vs.110).aspx" target="_blank">http://msdn.microsoft.com/en-us/library/6sh2ey19(v=vs.110).aspx</a>.</p></div><p>Afterwards, add the following variable below the others:</p><div class="informalexample"><pre class="programlisting">// The buttons that we can use to shoot lasers
public List&lt;KeyCode&gt; shootButton;</pre></div></li><li><p>Inside our <code class="literal">Update</code> function, we will need to add some additional code, which is as follows:</p><div class="informalexample"><pre class="programlisting">// a foreach loop will go through each item inside of 
// shootButton and do whatever we placed in {}s using the 
// element variable to hold the item
foreach (KeyCode element in shootButton)
{
  if(Input.GetKey(element) &amp;&amp; timeTilNextFire &lt; 0)
  {
    timeTilNextFire = timeBetweenFires;
    ShootLaser();
    break;
  }
}

timeTilNextFire -= Time.deltaTime;</pre></div><p>In this code we check each of the keys we allow the player to shoot with (such as the spacebar and <span class="emphasis"><em>Enter</em></span> keys). If they press any of these keys and can fire again, then we will reset our timer and shoot a laser. However, we haven't made the <code class="literal">ShootLaser</code> function. Let's do that now.</p></li><li><p>Underneath<a id="id41" class="indexterm"></a> the functions, add the following function:</p><div class="informalexample"><pre class="programlisting">// Creates a laser and gives it an initial position in 
// front of the ship.    
void ShootLaser()
{
  // We want to position the laser in relation to 
  // our player's location
  Vector3 laserPos = this.transform.position;
  // The angle the laser will move away from the center
  float rotationAngle = transform.localEulerAngles.z - 90;
  // Calculate the position right in front of the ship's
  // position laserDistance units away
  laserPos.x += (Mathf.Cos((rotationAngle) * 
               Mathf.Deg2Rad) * -laserDistance);
  laserPos.y += (Mathf.Sin((rotationAngle) * 
               Mathf.Deg2Rad) * -laserDistance);
  
  Instantiate(laser, laserPos, this.transform.rotation);
}</pre></div></li><li><p>Save <a id="id42" class="indexterm"></a>your file, and go back into Unity. You'll now see a number of additional variables that we can now set.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note11"></a>Note</h3><p>If, for some reason, your <span class="strong"><strong>Inspector</strong></span> window doesn't update, save your project and restart Unity. Upon reset, it should be updated.</p></div></li><li><p>Now, change the <span class="strong"><strong>Size</strong></span> of each of the <span class="strong"><strong>Shoot Button</strong></span> variables to <code class="literal">2</code>, and fill in the <span class="strong"><strong>Element 0</strong></span> value with <code class="literal">Mouse0</code> and <span class="strong"><strong>Element 1</strong></span> with <code class="literal">Space</code>. When you've finished, it should look something like the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781785883118/graphics/B05212_01_16.jpg" /></div></li><li><p>Next, we <a id="id43" class="indexterm"></a>will need to create our laser to fill in the <span class="strong"><strong>Laser</strong></span> variable. Go back into our <code class="literal">Assets</code> folder from the example code, and move the <code class="literal">laser.png</code> file into our <span class="strong"><strong>Project</strong></span> tab's <code class="literal">Sprites</code> folder.</p></li><li><p>Following that, drag and drop it into your scene from the <span class="strong"><strong>Scene</strong></span> tab to place it in the level.</p></li><li><p>Right-click the <code class="literal">Scripts</code> folder you created earlier, click on <span class="strong"><strong>Create</strong></span>, and select the <span class="strong"><strong>C# Script</strong></span> label. Call this new script <code class="literal">LaserBehaviour</code>. Go into <code class="literal">your IDE</code>, and use the following code:</p><div class="informalexample"><pre class="programlisting">using UnityEngine;
using System.Collections;

public class LaserBehaviour : MonoBehaviour 
{
  // How long the laser will live
  public float lifetime = 2.0f;

  // How fast will the laser move
  public float speed = 5.0f;


  // How much damage will this laser do if we hit an enemy
  public int damage = 1;

  // Use this for initialization
  void Start () 
  {
    // The game object that contains this component will be
    // destroyed after lifetime seconds have passed
    Destroy(gameObject, lifetime);
  }
  
  // Update is called once per frame
  void Update () 
  {
    transform.Translate(Vector3.up * Time.deltaTime * speed);
  }
}</pre></div></li><li><p>Attach <code class="literal">LaserBehaviour</code> to the <a id="id44" class="indexterm"></a>laser object. Finally, add a <span class="strong"><strong>Box Collider 2D</strong></span> component by first selecting the laser object and then going to <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>Physics 2D</strong></span> | <span class="strong"><strong>Box Collider 2D</strong></span>. The collision box, by default, will be the size of the image, but I want to shrink it to fit what is inside of it. To do that, we will change the <span class="strong"><strong>Size</strong></span> attribute's <span class="strong"><strong>X</strong></span> property to <code class="literal">.09</code> and <span class="strong"><strong>Y</strong></span> to <code class="literal">.5</code>. To see exactly what we're modifying, you can zoom in the camera by using the mouse wheel in the <span class="strong"><strong>Scene</strong></span> tab:</p><div class="mediaobject"><img src="/graphics/9781785883118/graphics/B05212_01_17.jpg" /></div><p>Now, the laser will move in the direction that it's facing and die after a period of two seconds! Next, let's make it so that the player can shoot them.</p></li><li><p>To <a id="id45" class="indexterm"></a>differentiate this object from the <code class="literal">laser </code>sprite that we used to create it, select your laser object in the <span class="strong"><strong>Hierarchy</strong></span> tab and then under the <span class="strong"><strong>Inspector</strong></span> change its name to <code class="literal">Laser</code>.</p></li><li><p>In the <span class="strong"><strong>Project</strong></span> tab, go to the <span class="strong"><strong>Assets</strong></span> | <span class="strong"><strong>Prefabs</strong></span> folder, and drag and drop the Laser object from our <span class="strong"><strong>Hierarchy</strong></span> tab into it. You'll notice that the object <span class="strong"><strong>Hierarchy</strong></span> will turn blue to show that it is a prefab.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note12"></a>Note</h3><p>
<span class="strong"><strong>Prefabs</strong></span> or prefabricated objects are the objects that we set aside to make copies during runtime, such as our bullets and eventually enemies that we'll spawn into the world, and we can create as many as we want. When you add a prefab to a scene, you create an instance of it. All of these instances are clones of the object located in our <code class="literal">Assets</code>. Whenever you change something in the prefab located in our <code class="literal">Prefab</code> folder, those changes are applied to all of the objects that are already inside of your scene. For example, if you add a new component to <code class="literal">Prefab</code>, all of the other objects we have in the scene will instantly contain the component as well. We can also apply any of the ones in our scene to be the blueprint for the others as well, which we will do later on. However, it is also possible to change the properties of a single instance while keeping the link intact. Simply change any property of a prefab instance inside your scene, and that particular value will become bolded to show that the value is overridden, and they will not be affected by changes in the source prefab. This allows you to modify prefab instances to make them different (unique) from their source prefabs without breaking the prefab link.</p></div><p>Have a look at the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781785883118/graphics/B05212_01_18.jpg" /></div></li><li><p>Now, because <a id="id46" class="indexterm"></a>we have the prefab created, we don't need the original in the scene because we'll be spawning them instead. With that in mind, delete the <code class="literal">Laser</code> object from our scene, and then go to the <code class="literal">playerShip</code> object. For clarity, rename it to <code class="literal">Player Ship</code> and then drag and drop the <code class="literal">Laser</code> prefab from the <span class="strong"><strong>Project</strong></span> tab into the <span class="strong"><strong>Laser</strong></span> property of the <code class="literal">PlayerBehavior</code> component.</p></li><li><p>Finally, we want our player to have collision as well, so let's add a circle collider to our ship by going to <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>Physics 2D</strong></span> | <span class="strong"><strong>Circle Collider 2D.</strong></span> Change the <span class="strong"><strong>Radius</strong></span> property to <code class="literal">0.3</code>.</p></li></ol></div><p>Generally, in <a id="id47" class="indexterm"></a>games, we want to be as efficient as possible toward calculations. Polygon collision is the most accurate collision, but it is much slower than using a box or a circle. In this case, I wanted to use a circle, because not only is it more efficient but also allows the player some leeway in how close they can get to enemies without being hurt. Players will always think it's their skill if they get away, but if the collider is too big they will think the game is broken, which we want to avoid.</p><p>Have a look at the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781785883118/graphics/B05212_01_19.jpg" /></div><p>Now, our ship can shoot in the direction that the mouse is currently facing.</p></div>