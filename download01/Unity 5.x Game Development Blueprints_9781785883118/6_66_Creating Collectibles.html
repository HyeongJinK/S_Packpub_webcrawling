<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch06lvl1sec67"></a>Creating Collectibles</h2></div></div><hr /></div><p>At this point, we have<a id="id346" class="indexterm"></a> the basis of our game, but now we need to add some gameplay to our world. Perhaps we will have it so that we need to collect all of the coins in the level and then the goal will open:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Create a new <span class="strong"><strong>Particle System</strong></span> by going into <span class="strong"><strong>GameObject</strong></span> | <span class="strong"><strong>Particle System</strong></span>. Change the name of the object to <span class="strong"><strong>Collectible</strong></span> and center it in the world by changing its position to <code class="literal">0</code>, <code class="literal">0</code>, <code class="literal">0</code>. Next, we need to assign the object's tag to <span class="strong"><strong>Orb</strong></span>. To do so, select <span class="strong"><strong>Tag</strong></span> | <span class="strong"><strong>Add Tag</strong></span>. Once at the <span class="strong"><strong>Tag</strong></span> menu, press the <span class="strong"><strong>+</strong></span> button to the right of <span class="strong"><strong>Tags</strong></span> and then from the assign Tag <span class="strong"><strong>0</strong></span>, put in <span class="strong"><strong>Orb</strong></span> and press <span class="emphasis"><em>Enter</em></span>:</p><div class="mediaobject"><img src="/graphics/9781785883118/graphics/B05212_06_15.jpg" /></div></li><li><p>Then, select the<a id="id347" class="indexterm"></a> <span class="strong"><strong>Collectible</strong></span> game object in the <span class="strong"><strong>Hierarchy</strong></span> again and then select the <span class="strong"><strong>Tag</strong></span> as <span class="strong"><strong>Orb</strong></span>. Under the <span class="strong"><strong>Shape</strong></span> section, change the <span class="strong"><strong>Shape </strong></span>variable to <span class="strong"><strong>Sphere</strong></span> and the <span class="strong"><strong>Radius</strong></span> to <span class="strong"><strong>0.01</strong></span>:</p><div class="mediaobject"><img src="/graphics/9781785883118/graphics/B05212_06_16.jpg" /></div></li><li><p>Click on the Arrow on the right-hand side of <span class="strong"><strong>Start Lifetime</strong></span> and change the values to be <span class="strong"><strong>Random Between Two Constants</strong></span>. Change those values to <code class="literal">0</code> and .<code class="literal">2</code>. Do the <a id="id348" class="indexterm"></a>same with <span class="strong"><strong>Start Speed</strong></span> between <code class="literal">0</code> and <code class="literal">1</code>. Make <span class="strong"><strong>Start Size</strong></span> use random values between <span class="strong"><strong>0</strong></span> and <span class="strong"><strong>1.5</strong></span>:</p><div class="mediaobject"><img src="/graphics/9781785883118/graphics/B05212_06_17.jpg" /></div></li><li><p>Under <span class="strong"><strong>Start Color</strong></span>, change the <a id="id349" class="indexterm"></a>value to yellow by clicking on the color to bring up the <span class="strong"><strong>Color</strong></span> select dialogue. Once there set the alpha (<span class="strong"><strong>A</strong></span>) to <span class="strong"><strong>39</strong></span>:</p><div class="mediaobject"><img src="/graphics/9781785883118/graphics/B05212_06_18.jpg" /></div></li><li><p>Next, click<a id="id350" class="indexterm"></a> on the <span class="strong"><strong>Emission</strong></span> section to open it up, and from there, <span class="strong"><strong>set</strong></span> the <span class="strong"><strong>Rate</strong></span> to <span class="strong"><strong>100</strong></span>.</p></li><li><p>Now add a <span class="strong"><strong>Sphere Collider</strong></span> by selecting <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>Physics</strong></span> | <span class="strong"><strong>Sphere Collider</strong></span>. Inside of the <span class="strong"><strong>Inspector</strong></span>, set the <span class="strong"><strong>Is Trigger</strong></span> Boolean to <code class="literal">true</code>, set the <span class="strong"><strong>Center</strong></span> to (<code class="literal">0, 0, 0</code>) and then set the <span class="strong"><strong>Radius</strong></span> to <span class="strong"><strong>0.4</strong></span>:</p><div class="mediaobject"><img src="/graphics/9781785883118/graphics/B05212_06_19.jpg" /></div></li><li><p>Finally, drag and <a id="id351" class="indexterm"></a>drop the <span class="strong"><strong>Collectible</strong></span> object into the <span class="strong"><strong>Prefabs</strong></span> section of the <span class="strong"><strong>Project</strong></span> folder and delete the object in the <span class="strong"><strong>Hierarchy</strong></span>:</p></li></ol></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec38"></a>Adding new objects to our level builder</h3></div></div></div><p>Now, we need to modify our original <code class="literal">Build Level</code> function to have support in order to add these collectibles <a id="id352" class="indexterm"></a>as well to our level. While we're at it, let's make it so the level can spawn the <code class="literal">Player</code> as well. Rename our player object to <code class="literal">Player</code> if not done yet and drag and drop it to the <code class="literal">Prefabs</code> folder as well. After we've created the prefabs, go ahead and delete the <code class="literal">Player</code> object.</p><p>So because we're writing a new function, we have some new variables to introduce in the <code class="literal">GameController</code> class:</p><div class="informalexample"><pre class="programlisting">[Header("Object References")]
public Transform wall;
public Transform player;
public Transform orb;</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note48"></a>Note</h3><p>Note that in this case, I added in a Header as well, which will help you convey what these variables actually are.</p></div><p>Then<a id="id353" class="indexterm"></a> change the <code class="literal">BuildLevel</code> function replacing what was inside our for loops to:</p><div class="informalexample"><pre class="programlisting">    void BuildLevel () 
    {
        // Get the DynamicObjects object so we can make it our
       // newly created objects' parent
        GameObject dynamicParent = 
        GameObject.Find("Dynamic Objects");

        // Go through each element inside our level variable
        for (int yPos = 0; yPos &lt; level.Length; yPos++) 
        {
            for (int xPos = 0; xPos &lt; (level[yPos]).Length;         xPos++) 
            {
                Transform toCreate = null;
                switch(level[yPos][xPos])
                {
                    case 0:
                    // Do nothing because we don't want anything 
                   // in this place
                   break;

                   case 1:
                   toCreate = wall;
                   break;

                   case 2:
                   toCreate = player;
                   break;

                   case 3:
                   toCreate = orb;
                   break;

                   default:
                   print("Invalid number: " + (level[yPos][xPos]).ToString());
                   break;	
}

                if(toCreate != null)
                {
                    Transform newObject = Instantiate(toCreate, new Vector3(xPos, (level.Length - yPos), 0),
                    toCreate.rotation) as Transform;

                // Set the object's parent to the DynamicObjects
                // variable so it doesn't clutter our Hierachy
                newObject.parent = dynamicParent.transform;
                }
                
            }
        }
    }</pre></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch06lvl3sec05"></a>Switch statements continued</h4></div></div></div><p>As we described briefly previously in <a class="link" href="#" linkend="ch03">Chapter 3</a>, <span class="emphasis"><em>GUIs Part 2 â€“ Clicker Game</em></span>, a <code class="literal">switch</code> statement can be thought of as a nice way to compare<a id="id354" class="indexterm"></a> a single variable against a number of different values. As the case here, the switch statement could be rewritten as:</p><div class="informalexample"><pre class="programlisting">if(level[yPos][xPos] == 0)
{

}
else if(level[yPos][xPos] == 1)
{
toCreate = wall;
}
else if(level[yPos][xPos] == 2)
{
    toCreate = player;
    }
    else if(level[yPos][xPos] == 3)
    {
        toCreate = orb;
    }
    else
    {
        print("Invalid number: " + (level[yPos][xPos]).ToString());
    }</pre></div><p>However, surely you can tell that writing it as a <code class="literal">switch</code> statement is much nicer to look at and requires less<a id="id355" class="indexterm"></a> code duplication, which is something we want to reduce as much as possible:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>After this, we need to modify our level array to actually have the collectibles and player in it. Replace one 0s in your level to a 2 to put the player there and add in some 3s for the player to collect. Mine looks like the following:</p><div class="informalexample"><pre class="programlisting">private int[][] level = new int[][]
{
    new int[]{1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1}, 
    new int[]{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1}, 
    new int[]{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1}, 
    new int[]{1, 3, 0, 0, 0, 0, 0, 0, 0, 0, 3, 3, 3, 0, 0, 0, 0, 0, 1}, 
    new int[]{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1}, 
    new int[]{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1}, 
    new int[]{1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1}, 
    new int[]{1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1}, 
    new int[]{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1}, 
    new int[]{1, 0, 0, 0, 0, 0, 3, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1},
    new int[]{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1}, 
    new int[]{1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1}, 
    new int[]{1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1}, 
    new int[]{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 3, 1}, 
    new int[]{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1}, 
    new int[]{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1}, 
    new int[]{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1}, 
    new int[]{1, 0, 0, 0, 0, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1}, 
    new int[]{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1}, 
    new int[]{1, 0, 0, 0, 3, 0, 0, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1}, 
    new int[]{1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1}, 
    new int[]{1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1}, 
    new int[]{1, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1}, 
    new int[]{1, 0, 2, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1}, 
    new int[]{1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1} 
};</pre></div></li><li><p>Save your <a id="id356" class="indexterm"></a>script and exit back into the editor. Select your <span class="strong"><strong>Game Controller</strong></span> and then assign the <span class="strong"><strong>Player</strong></span> and <span class="strong"><strong>Orb</strong></span> variables with the appropriate prefabs:</p><div class="mediaobject"><img src="/graphics/9781785883118/graphics/B05212_06_20.jpg" /></div></li><li><p>Finally, save your scene and run the game:</p><div class="mediaobject"><img src="/graphics/9781785883118/graphics/B05212_06_21.jpg" /></div><p>And there<a id="id357" class="indexterm"></a> we go! Our player as well as collectibles are now spawning via our <code class="literal">BuildLevel</code> function. Finally, let's make it so we can actually collect these.</p></li><li><p>After we have the physical representation of the object done, let's now implement its functionality. Create a new script in our <span class="strong"><strong>Scripts</strong></span> folder, which we will name <code class="literal">OrbBehaviour</code>. Open it up in <code class="literal">MonoDevelop</code> and fill it in with the following:</p><div class="informalexample"><pre class="programlisting">using UnityEngine;

public class OrbBehaviour : MonoBehaviour 
{
    void OnTriggerEnter(Collider other) 
    {
        Destroy(this.gameObject);
    }
}</pre></div></li><li><p>Assign the <span class="strong"><strong>OrbBehaviour</strong></span> component to the <span class="strong"><strong>Orb</strong></span> prefab by going to the <span class="strong"><strong>Project</strong></span> tab and <a id="id358" class="indexterm"></a>opening the <span class="strong"><strong>Prefabs</strong></span> folder and selecting the <span class="strong"><strong>Collectible</strong></span> object. From there, scroll all the way down on the <span class="strong"><strong>Inspector</strong></span> tab, click on <span class="strong"><strong>Add Component</strong></span>, and start typing in <span class="strong"><strong>Orb</strong></span> and then hitting the <span class="emphasis"><em>Enter</em></span> key:</p><div class="mediaobject"><img src="/graphics/9781785883118/graphics/B05212_06_22.jpg" /></div></li><li><p>Save the scene and then play the game:</p><div class="mediaobject"><img src="/graphics/9781785883118/graphics/B05212_06_23.jpg" /></div><p>And with this, we <a id="id359" class="indexterm"></a>can now collect orbs and they dissapear when we touch them!</p></li></ol></div></div></div></div>