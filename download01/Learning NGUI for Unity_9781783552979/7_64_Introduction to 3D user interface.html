<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch07lvl1sec64"></a>Introduction to 3D user interface</h2></div></div><hr /></div><p>Until now, we've <a id="id757" class="indexterm"></a>created 2D user interface elements and flat widgets viewed with an orthographic camera, on which the <span class="emphasis"><em>z</em></span> axis has no influence.</p><p>3D user interface elements are viewed with perspectives taken into account, which means that the <span class="emphasis"><em>z</em></span> axis makes widgets feel "farther away" or "closer to" the camera. Rotation can also be applied, which will make them look like they are a part of the 3D environment.</p><p>In this section, we will create 3D user interface elements. First, we need to explain what the <span class="strong"><strong>3D UI Root</strong></span> is, and then create one.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec123"></a>The 3D UI Root</h3></div></div></div><p>It's interesting to <a id="id758" class="indexterm"></a>separate our 2D and 3D layers in order to<a id="id759" class="indexterm"></a> make sure you can easily hide or show one of them by simply enabling/disabling the camera that renders them.</p><p>Indeed, consider we have  <code class="literal">UI Root</code> to hold the 2D UI and another to hold the 3D UI exclusively. If we need to hide the 2D UI and show a 3D pause menu, we can simply perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Disable the 2D <code class="literal">UI Root</code> that holds and renders the in-game 2D UI.</p></li><li><p>Enable the 3D <code class="literal">UI Root</code> that holds and renders the 3D pause menu.</p></li></ol></div><p>Since <code class="literal">UI Root</code> handles <a id="id760" class="indexterm"></a>widget scaling depending on the screen, we should only have one <code class="literal">UI Root</code> instance running in the same scene. The NGUI plugin won't let us create a new 3D <code class="literal">UI Root</code> within a scene that already has a 2D <code class="literal">UI Root</code>. This is why we need to disable the <code class="literal">InGame2DUI</code> root for now:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select <code class="literal">InGame2DUI</code> and disable it.</p></li><li><p>Create a new <code class="literal">3D UI</code> by navigating to <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>Create</strong></span> | <span class="strong"><strong>3D UI</strong></span>.</p></li><li><p>Select a new <code class="literal">UI Root (3D)</code> GameObject.</p></li><li><p>Rename it to <code class="literal">InGame3DUI</code>.</p></li><li><p>For its attached <code class="literal">UI Root</code> component, perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Set its <span class="strong"><strong>Scaling Style</strong></span> to <span class="strong"><strong>Constrained</strong></span>.</p></li><li><p>Set its <span class="strong"><strong>Content Width</strong></span> to 1920.</p></li><li><p>Set its <span class="strong"><strong>Content Height</strong></span> to 1080.</p></li><li><p>Check its height <span class="strong"><strong>Fit</strong></span> option.</p></li></ol></div></li></ol></div><p>Now, let's create a new layer to hold all 3D UI elements:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Access <span class="strong"><strong>Edit</strong></span> | <span class="strong"><strong>Project Settings</strong></span> | <span class="strong"><strong>Tags and Layers</strong></span>.</p></li><li><p>Next to <span class="strong"><strong>User Layer 10</strong></span>, enter <span class="strong"><strong>3DUI</strong></span> in the field.</p></li><li><p>Select the <code class="literal">InGame3DUI</code> GameObject.</p></li><li><p>Switch its layer to <span class="strong"><strong>3DUI</strong></span>.</p></li></ol></div><p>Unity will prompt you with a popup, asking if you desire to change the layer for all child objects. Click on the <span class="strong"><strong>Yes, change children</strong></span> button.</p><p>Now that we've set our <code class="literal">InGame3DUI</code> in the <code class="literal">3DUI</code> layer, we need to make sure this layer is rendered by <code class="literal">UICamera</code>. Perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select our <code class="literal">InGame3DUI</code> | <code class="literal">Camera</code> GameObject.</p></li><li><p>For the <code class="literal">Camera</code> component, set <span class="strong"><strong>Culling Mask</strong></span> to display <span class="strong"><strong>3D UI</strong></span> only.</p></li></ol></div><p>Now that our 3D <code class="literal">UI Root</code> is created and configured, we can re-enable our <code class="literal">InGame2DUI</code> root and make <a id="id761" class="indexterm"></a>sure its culling mask hasn't been changed. We can do so by following the steps mentioned:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select the <code class="literal">InGame2DUI</code> GameObject and enable it.</p></li><li><p>Select the <code class="literal">InGame2DUI</code> | <code class="literal">Camera</code> GameObject.</p></li><li><p>For <code class="literal">Camera</code>, make sure <span class="strong"><strong>Culling Mask</strong></span> is set to <span class="strong"><strong>InGame2DUI</strong></span>.</p></li></ol></div><p>Ok, we're now ready to display 3D widgets!</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec124"></a>Scale calibration</h3></div></div></div><p>What I call scale calibration for the 3D UI is the process of making sure a fullscreen 3D widget is <a id="id762" class="indexterm"></a>actually taking the entire screen. We'll need to create a<a id="id763" class="indexterm"></a> calibration sprite of 1920 x 1080 and see if it fits our <span class="strong"><strong>Game</strong></span> view correctly:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select the <code class="literal">InGame3DUI</code> GameObject.</p></li><li><p>Create a new child sprite with <span class="emphasis"><em>Alt</em></span> + <span class="emphasis"><em>Shift</em></span> +<span class="emphasis"><em>S</em></span>.</p></li><li><p>Set its <span class="strong"><strong>Atlas</strong></span> to the <span class="strong"><strong>SciFi</strong></span> atlas.</p></li><li><p>Change its <span class="strong"><strong>Sprite</strong></span> to the <span class="strong"><strong>Dark</strong></span> sprite.</p></li><li><p>Make sure its <span class="strong"><strong>Type</strong></span> is set to <span class="strong"><strong>Sliced</strong></span>.</p></li><li><p>Set white for <span class="strong"><strong>Color Tint</strong></span>.</p></li><li><p>Change <span class="strong"><strong>Size</strong></span> to 1920 x 1080.</p></li></ol></div><p>We have a virtual screen of 1920 x 1080. With the current 3D UI configuration, you will notice that our 1920 x 1080 sliced sprite is much larger than the screen! This isn't good, and we need to find a way to calibrate our UI's scale.</p><p>In order to correct this, we can simply move the camera farther away from the widgets to reduce the UI's display size:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select the <code class="literal">InGame3DUI</code> | <code class="literal">Camera</code>.</p></li><li><p>Set the <span class="strong"><strong>Transform</strong></span> position to {<code class="literal">0</code>, <code class="literal">0</code>, <code class="literal">-935</code>}.</p></li></ol></div><p>Ok, that's better; our 1920 x 1080 sprite now fits the screen without getting out of bounds. You can now delete our calibration, <code class="literal">Sprite</code>, from the scene.</p><p>Your game scene's <span class="strong"><strong>Hierarchy</strong></span> view should now have the elements shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783552979/graphics/2979OT_07_01.jpg" /></div><p>For Unity 4.5 and<a id="id764" class="indexterm"></a> above, the order of the elements might be different since objects aren't sorted alphabetically anymore.</p><p>Now that our UI's scale is calibrated, we can move on and create our first 3D widget.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec125"></a>The score counter</h3></div></div></div><p>The first 3D <a id="id765" class="indexterm"></a>widget we will create is a score counter at the top <a id="id766" class="indexterm"></a>right of the screen:</p><div class="mediaobject"><img src="/graphics/9781783552979/graphics/2979OT_07_02.jpg" /></div><p>As you can see in the preceding image, our score counter has a slight 3D effect due to a <span class="emphasis"><em>y</em></span> axis rotation<a id="id767" class="indexterm"></a> of 20 degrees.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch07lvl3sec72"></a>The text label</h4></div></div></div><p>Let's start by<a id="id768" class="indexterm"></a> creating the score counter's label:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select the <code class="literal">InGame3DUI</code> GameObject.</p></li><li><p>Create a new empty GameObject with <span class="emphasis"><em>Alt</em></span> + <span class="emphasis"><em>Shift</em></span> + <span class="emphasis"><em>N</em></span>.</p></li><li><p>Rename this new child to <code class="literal">Score</code>.</p></li><li><p>Create a new label with <span class="emphasis"><em>Alt</em></span> + <span class="emphasis"><em>Shift</em></span> + <span class="emphasis"><em>L</em></span>.</p></li></ol></div><p>Ok, we have our new label. Let's configure it now:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select our new <code class="literal">InGame3DUI</code> | <code class="literal">Score</code> | <code class="literal">Label</code> GameObject.</p></li><li><p>Set its font type to <span class="strong"><strong>Unity</strong></span>, with a <code class="literal">Lato</code> font.</p></li><li><p>Set its <span class="strong"><strong>Font Size</strong></span> to 60, with a <code class="literal">Normal</code> (not <code class="literal">Bold</code>) style.</p></li><li><p>Change its <span class="strong"><strong>Text</strong></span> value to <code class="literal">999999</code>.</p></li><li><p>Change its <span class="strong"><strong>Overflow</strong></span> parameter to <span class="strong"><strong>ResizeFreely</strong></span>.</p></li><li><p>Set a black <span class="strong"><strong>Shadow</strong></span> effect with <span class="strong"><strong>X</strong></span> and <span class="strong"><strong>Y</strong></span> values as 1.</p></li><li><p>Change <span class="strong"><strong>Color Tint</strong></span> to {R: 255, G: 255, B: 150, A: 255}.</p></li><li><p>Change <span class="strong"><strong>Pivot</strong></span> to <code class="literal">Right</code> (click on the right arrow followed by the middle bar).</p></li><li><p>Set <span class="strong"><strong>Depth</strong></span> to 2.</p></li></ol></div><p>Ok, now that we have our label with its pivot set to the right side, we can add a background sprite that will wrap around it.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch07lvl3sec73"></a>The background</h4></div></div></div><p>Let's add a <a id="id769" class="indexterm"></a>dark transparent background sprite to make this score counter more visible:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select our <code class="literal">InGame3DUI</code> | <code class="literal">Score</code> GameObject.</p></li><li><p>Create a new sprite pressing on <span class="emphasis"><em>Alt + Shift + S</em></span>.</p></li><li><p>Rename this new child as <code class="literal">Background</code>.</p></li><li><p>Change its <span class="strong"><strong>Atlas</strong></span> value to the <span class="strong"><strong>SciFi</strong></span> atlas.</p></li><li><p>Change its <span class="strong"><strong>Sprite</strong></span> value to the <span class="strong"><strong>Dark</strong></span> sprite.</p></li><li><p>Make sure its <span class="strong"><strong>Type</strong></span> is set to <span class="strong"><strong>Sliced</strong></span>.</p></li><li><p>Set <span class="strong"><strong>Depth</strong></span> to 0 to display behind the label.</p></li><li><p>Change its <span class="strong"><strong>Size</strong></span> to 235 x 80.</p></li><li><p>Change <span class="strong"><strong>Color Tint</strong></span> to {R: 160, G: 120, B: 30, A: 150}.</p></li></ol></div><p>Ok, now let's<a id="id770" class="indexterm"></a> configure the background's anchor to make sure it wraps around the label:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Change <span class="strong"><strong>Anchor Type</strong></span> to <span class="strong"><strong>Unified</strong></span>.</p></li><li><p>Drag our <code class="literal">Score</code> | <code class="literal">Label</code> GameObject to the <span class="strong"><strong>Target</strong></span> field.</p></li></ol></div><p>If you add or remove numbers in the score counter label, you'll see that the background adjusts itself to wrap it accordingly.</p><p>We can now add a border to this sprite to have more visible edges.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch07lvl3sec74"></a>The border sprite</h4></div></div></div><p>Let's use the<a id="id771" class="indexterm"></a> background sprite as a base to create a border sprite:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select our <code class="literal">InGame3DUI</code> | <code class="literal">Score</code> | <code class="literal">Background</code> GameObject.</p></li><li><p>Duplicate it by pressing <span class="emphasis"><em>Ctrl + D</em></span>.</p></li><li><p>Rename this new duplicate to <code class="literal">Border</code>.</p></li><li><p>Change <span class="strong"><strong>Sprite</strong></span> to the <span class="strong"><strong>Highlight</strong></span> sprite.</p></li><li><p>Uncheck the <span class="strong"><strong>Fill Center</strong></span> parameter.</p></li><li><p>Set <span class="strong"><strong>Depth</strong></span> to 1 to display over the background.</p></li><li><p>Change <span class="strong"><strong>Color Tint</strong></span> to {R: 255, G: 255, B: 0, A: 255}.</p></li><li><p>Drag our <code class="literal">Score</code> | <code class="literal">Background</code> to the <span class="strong"><strong>Anchor Target</strong></span> field.</p></li></ol></div><p>Great, we now have our score counter. We can now place it where it should be.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch07lvl3sec75"></a>The position and rotation</h4></div></div></div><p>Let's make sure it's anchored<a id="id772" class="indexterm"></a> at the top-right corner of the screen<a id="id773" class="indexterm"></a> and rotate it slightly:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select our <code class="literal">InGame3DUI</code> | <code class="literal">Score</code> GameObject.</p></li><li><p>Set the <span class="strong"><strong>Transform</strong></span> rotation to {0, 20, 0} to create a 3D effect.</p></li><li><p>Click on the <span class="strong"><strong>Add Component</strong></span> button in the inspector.</p></li><li><p>Type in <code class="literal">anc</code> to search for components with this name.</p></li><li><p>Select <span class="strong"><strong>Anchor</strong></span> and hit <span class="emphasis"><em>Enter</em></span> or click on it with your mouse.</p></li></ol></div><p>Now, for the newly attached <code class="literal">UIAnchor</code> component of <code class="literal">Score</code>:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Change <span class="strong"><strong>Side</strong></span> to <span class="strong"><strong>TopRight</strong></span>.</p></li><li><p>Change its <span class="strong"><strong>Relative Offset</strong></span> to {-0.09, -0.08}.</p></li></ol></div><p>That's it; we now<a id="id774" class="indexterm"></a> have our 3D score counter at the top-right<a id="id775" class="indexterm"></a> corner of the screen! Now, let's see how we can make our score increase when needed.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note39"></a>Note</h3><p>
<code class="literal">UIAnchor</code> is a legacy component because all widgets have the built-in anchoring system. However, it's interesting to know it exists and see it can still be used to anchor objects that aren't widgets.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch07lvl3sec76"></a>The ScoreController component</h4></div></div></div><p>In order to control the score counter's behavior, we'll create a new <code class="literal">ScoreController</code> component that <a id="id776" class="indexterm"></a>will update the score label when a player's current score is changed.</p><p>The score<a id="id777" class="indexterm"></a> modification feedback must be obvious. We'll make sure it uses a simple scale animation; the score first scales up, increases its value over time, and goes back to its initial scale when it has reached its final value.</p><p>First, let's create our new ScoreController component:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select our <code class="literal">InGame3DUI</code> | <code class="literal">Score</code> GameObject.</p></li><li><p>Click on the <span class="strong"><strong>Add Component</strong></span> button in the Inspector.</p></li><li><p>Type in <code class="literal">ScoreController</code> with your keyboard and hit <span class="emphasis"><em>Enter</em></span>.</p></li><li><p>Make sure <span class="strong"><strong>Language</strong></span> is set to <span class="strong"><strong>CSharp</strong></span>, and hit <span class="emphasis"><em>Enter </em></span>again.</p></li><li><p>Open the newly added <code class="literal">ScoreController.cs</code> script.</p></li></ol></div><p>Within this new <code class="literal">ScoreController.cs</code> script, declare the global variables, as shown in the following snippet:</p><div class="informalexample"><pre class="programlisting">// We'll need to store the score label
<span class="strong"><strong>private UILabel label;</strong></span>
// We'll need to separate the displayed score
<span class="strong"><strong>private int previousScore;</strong></span>
// The private _currentScore value
<span class="strong"><strong>private int _currentScore;</strong></span>
</pre></div><p>Also, add a public <code class="literal">currentScore</code> variable with a custom setter method in order to make sure that each time the score is changed, the <code class="literal">previousScore</code> value is updated and the label's text is refreshed:</p><div class="informalexample"><pre class="programlisting">// The public currentscore with custom setter
<span class="strong"><strong>public int currentScore</strong></span>
{
<span class="strong"><strong>  get</strong></span>
  {
<span class="strong"><strong>    return _currentScore;</strong></span>
  }
<span class="strong"><strong>  set</strong></span>
  {
    // Update the previous score to current score
<span class="strong"><strong>    previousScore = _currentScore;</strong></span>
    // Update the private _currentScore value
<span class="strong"><strong>    _currentScore = value;</strong></span>
    // Update the label with new score
<span class="strong"><strong>    UpdateLabel();</strong></span>
  }
}</pre></div><p>Now, let's make sure<a id="id778" class="indexterm"></a> variables are initialized correctly at the start. Replace the default <code class="literal">Start()</code> method with the following snippet:</p><div class="informalexample"><pre class="programlisting">// At start
<span class="strong"><strong>private void Start ()</strong></span>
{
  // Get the score counter's label
<span class="strong"><strong>  label = GetComponentInChildren&lt;UILabel&gt;();</strong></span>
  // Set the currentScore value to 0
<span class="strong"><strong>  currentScore = 0;</strong></span>
}</pre></div><p>Now that variables are initialized correctly, we can add the <code class="literal">UpdateLabel()</code> method, which is called at the last line of the <code class="literal">currentScore</code> getter method:</p><div class="informalexample"><pre class="programlisting">// Method to update the score label
<span class="strong"><strong>public void UpdateLabel()</strong></span>
</pre></div><div class="informalexample"><pre class="programlisting">{
  // Launch the coroutine to update the label
<span class="strong"><strong>  StartCoroutine(UpdateLabelRoutine());</strong></span>
}</pre></div><p>The above <code class="literal">Updat</code>
<code class="literal">eLabel()</code> method starts the <code class="literal">UpdateLabelRoutine</code> coroutine. Let's add this<a id="id779" class="indexterm"></a> coroutine, which actually updates the label:</p><div class="informalexample"><pre class="programlisting">// Coroutine that updates the label
<span class="strong"><strong>private IEnumerator UpdateLabelRoutine()</strong></span>
{
  // Scale up the score label to 1.2
<span class="strong"><strong>  UITweener tween =</strong></span>
<span class="strong"><strong>    TweenScale.Begin(label.gameObject, 0.1f, Vector3.one * 1.2f);</strong></span>
  
  // Wait for the scale tween to finish
<span class="strong"><strong>  yield return new WaitForSeconds(0.1f);</strong></span>
  
  // Calculate difference between old and new score
<span class="strong"><strong>  int scoreDelta = currentScore - previousScore;</strong></span>
  
  // While previous score is below current score...
<span class="strong"><strong>  while(previousScore &lt; currentScore)</strong></span>
  {
    // ...Increase the previousScore value
<span class="strong"><strong>    previousScore += Mathf.CeilToInt(scoreDelta * Time.deltaTime * 3.5f);</strong></span>
    // Set the label to the previousScore value
<span class="strong"><strong>    label.text = previousScore.ToString();</strong></span>
    // Wait for next frame
<span class="strong"><strong>    yield return null;</strong></span>
  }
  
  // When score has reached final score value
  // Update the score label with current score
<span class="strong"><strong>  label.text = currentScore.ToString();</strong></span>
  
  // Wait a little
<span class="strong"><strong>  yield return new WaitForSeconds(0.3f);</strong></span>
  // Re-scale down the score label
<span class="strong"><strong>  TweenScale.Begin(label.gameObject, 0.1f, Vector3.one);</strong></span>
}</pre></div><p>The preceding method first scales up the label, increases its value until it reaches the <code class="literal">currentScore</code> value, and then scales it back down again.</p><p>We can now make sure the score increases when the player brings the power source's correct element. Open the <code class="literal">PlayerController.cs</code> script and add this line of code in the <code class="literal">UseElement()</code> method just below the <code class="literal">targetFeed.Feed()</code> instruction:</p><div class="informalexample"><pre class="programlisting">// Increase Score
<span class="strong"><strong>ScoreController.Instance.currentScore += 1000;</strong></span>
</pre></div><p>Hit Unity's play button. Your <a id="id780" class="indexterm"></a>score will increase by 1,000 points each time a power feed is fed; for example, if you collect and deliver the lightning element to the lightning power feed.</p><p>Ok, great! We are now ready to start working on an in-game pause menu.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec126"></a>The pause button</h3></div></div></div><p>We'll now <a id="id781" class="indexterm"></a>create a 3D pause<a id="id782" class="indexterm"></a> button, as shown:</p><div class="mediaobject"><img src="/graphics/9781783552979/graphics/2979OT_07_03.jpg" /></div><p>Ok, let's create this button now. We'll need a <code class="literal">Buttons</code> holder GameObject:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select the <code class="literal">InGame3DUI</code> GameObject.</p></li><li><p>Create a new child by pressing <span class="emphasis"><em>Alt</em></span> +<span class="emphasis"><em>Shift</em></span> + <span class="emphasis"><em>N</em></span>.</p></li><li><p>Rename this new child to <code class="literal">TopButtons</code>.</p></li></ol></div><p>Now that we have our <code class="literal">TopButtons</code> holder, we can create the button:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>In the <span class="strong"><strong>Project</strong></span> view, search for <code class="literal">button</code>.</p></li><li><p>Drag <code class="literal">Control â€“ Simple Button</code> to our new <code class="literal">TopButtons</code> GameObject.</p></li><li><p>Rename this new button to <code class="literal">Pause</code>.</p></li><li><p>Reset the <span class="strong"><strong>Transform</strong></span> position to {0, 0, 0}.</p></li><li><p>In the <span class="strong"><strong>Inspector</strong></span> view, click on the <span class="strong"><strong>Add Component</strong></span> button.</p></li><li><p>Type in <code class="literal">sca</code> to search for components with this name.</p></li><li><p>Select <span class="strong"><strong>Button Scale</strong></span> and hit the <span class="emphasis"><em>Enter</em></span> key or click on it with your mouse.</p></li></ol></div><p>For the attached <code class="literal">UISprite</code> component, perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Set <span class="strong"><strong>Size</strong></span> to 320 x 100.</p></li><li><p>Change <span class="strong"><strong>Pivot</strong></span> to <code class="literal">Top</code> (middle + up arrow).</p></li></ol></div><p>For the<a id="id783" class="indexterm"></a> attached <code class="literal">UIButton</code> component, perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Set the <span class="strong"><strong>Normal</strong></span> color to {R: <code class="literal">255</code>, G: <code class="literal">255</code>, B: <code class="literal">255</code>, A: <code class="literal">255</code>}.</p></li><li><p>Set the <span class="strong"><strong>Hover</strong></span>
<code class="literal"> </code>color to {R: <code class="literal">225</code>, G: <code class="literal">200</code>, B: <code class="literal">150</code>, A: <code class="literal">255</code>}.</p></li><li><p>Set the <span class="strong"><strong>Pressed</strong></span> color to {R: <code class="literal">120</code>, G: <code class="literal">120</code>, B: <code class="literal">120</code>, A: <code class="literal">255</code>}.</p></li></ol></div><p>Now, select the child <code class="literal">Label</code> GameObject executing the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Set the font type to <span class="strong"><strong>Unity</strong></span>.</p></li><li><p>Set <span class="strong"><strong>Font</strong></span> to <span class="strong"><strong>Arial</strong></span>.</p></li><li><p>Set <span class="strong"><strong>Color Tint</strong></span> to {R: <code class="literal">0</code>, G: <code class="literal">0</code>, B: <code class="literal">0</code>, A: <code class="literal">255</code>}.</p></li><li><p>Change <span class="strong"><strong>Font Size</strong></span> to <code class="literal">40</code>.</p></li><li><p>Change <span class="strong"><strong>Text</strong></span> to <code class="literal">Pause</code>
</p></li></ol></div><p>Ok, our pause button is looking good. Now, we would like to add a slight 3D effect and position it at the top of the screen:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select our <code class="literal">InGame3DUI</code> | <code class="literal">TopButtons</code> GameObject.</p></li><li><p>Set its <span class="strong"><strong>Transform</strong></span> rotation to {-15, 0, 0} for a slight 3D effect.</p></li></ol></div><p>The <code class="literal">TopButtons</code> GameObject is just a container and not a widget; we cannot assign a size or pivot to it. We can correct this by adding the <code class="literal">UIWidget</code> component to it:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select our <code class="literal">InGame3DUI</code> | <code class="literal">TopButtons</code> GameObject.</p></li><li><p>In the <span class="strong"><strong>Inspector</strong></span> view, type in <code class="literal">widg</code> to search for components.</p></li><li><p>Select <span class="strong"><strong>NGUI Widget</strong></span> and hit the <span class="emphasis"><em>Enter</em></span> key or click on it with your mouse.</p></li></ol></div><p>Our <code class="literal">TopButtons</code> is now considered as a widget. We can set its new <code class="literal">UIWidget</code> component's <span class="strong"><strong>Size</strong></span> and <span class="strong"><strong>Pivot</strong></span> and make sure it's placed at the top of the screen:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Set its <span class="strong"><strong>Size</strong></span> to 320 x 100.</p></li><li><p>Change its <span class="strong"><strong>Pivot</strong></span> to <code class="literal">Top</code> (middle + up arrow).</p></li><li><p>Set the <span class="strong"><strong>Transform</strong></span> position to {<code class="literal">0</code>, <code class="literal">540</code>, <code class="literal">0</code>}.</p></li></ol></div><p>That's it; you should now have the pause button attached to the top of the screen:</p><div class="mediaobject"><img src="/graphics/9781783552979/graphics/2979OT_07_04.jpg" /></div><p>Now that we have a<a id="id784" class="indexterm"></a> pause button, let's create the associated pause menu.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec127"></a>The pause menu</h3></div></div></div><p>We will now <a id="id785" class="indexterm"></a>create this<a id="id786" class="indexterm"></a> specific in-game 3D pause menu:</p><div class="mediaobject"><img src="/graphics/9781783552979/graphics/2979OT_07_05.jpg" /></div><p>Let's start by creating the container panel and box.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch07lvl3sec77"></a>The panel and box</h4></div></div></div><p>First, we need to<a id="id787" class="indexterm"></a> create a new panel to contain the pause<a id="id788" class="indexterm"></a> menu's background and border:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select the <code class="literal">InGame3DUI</code> GameObject.</p></li><li><p>Create a new empty child GameObject by pressing <span class="emphasis"><em>Alt</em></span> + <span class="emphasis"><em>Shift</em></span> + <span class="emphasis"><em>N</em></span>.</p></li><li><p>Rename this new child to <code class="literal">PauseMenu</code>.</p></li><li><p>Click on the <span class="strong"><strong>Add Component</strong></span> button in the inspector.</p></li><li><p>Type in <code class="literal">panel</code> to search for components with this name.</p></li><li><p>Select <span class="strong"><strong>NGUI Panel</strong></span> and hit <span class="emphasis"><em>Enter</em></span> or click on it with your mouse.</p></li><li><p>Set the <span class="strong"><strong>Depth</strong></span> value of the newly attached <code class="literal">UIPanel</code> to 1.</p></li></ol></div><p>We can now create the pause menu's background:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select our new <code class="literal">InGame3DUI</code> | <code class="literal">PauseMenu</code> GameObject.</p></li><li><p>Create a new child sprite pressing <span class="emphasis"><em>Alt</em></span> + <span class="emphasis"><em>Shift</em></span> +<span class="emphasis"><em> S</em></span>.</p></li><li><p>Rename the new sprite to <code class="literal">Background</code>.</p></li><li><p>Change <span class="strong"><strong>Atlas</strong></span> to <span class="strong"><strong>Wooden Atlas</strong></span>.</p></li><li><p>Set <span class="strong"><strong>Sprite</strong></span> to the <span class="strong"><strong>Window</strong></span> sprite.</p></li><li><p>Make sure that the sprite type is set to <span class="strong"><strong>Sliced</strong></span>.</p></li><li><p>Set <span class="strong"><strong>Color Tint </strong></span>to {R: <code class="literal">255</code>, G: <code class="literal">200</code>, B: <code class="literal">130</code>, A: <code class="literal">200</code>}.</p></li><li><p>Set <span class="strong"><strong>Size</strong></span> to <code class="literal">1100 x 600</code>.</p></li></ol></div><p>Now, let's add the box's border sprite:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select our <code class="literal">InGame3DUI</code> | <code class="literal">PauseMenu</code> | <code class="literal">Background</code> GameObject.</p></li><li><p>Duplicate it pressing <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>D</em></span>.</p></li><li><p>Rename this new duplicate to <code class="literal">Border</code>.</p></li><li><p>Uncheck its <code class="literal">UISprite</code> and the <span class="strong"><strong>Fill Center</strong></span> option.</p></li><li><p>Set <span class="strong"><strong>Color Tint</strong></span> to {R: 255, G: 230, B: 60, A: 255}.</p></li><li><p>Change the <span class="strong"><strong>Depth</strong></span> value to 2.</p></li><li><p>Change <span class="strong"><strong>Anchor Type</strong></span> to <span class="strong"><strong>Unified</strong></span>.</p></li><li><p>Drag our <code class="literal">InGame3DUI</code> | <code class="literal">PauseMenu</code> | <code class="literal">Background</code> in the <span class="strong"><strong>Target</strong></span> field.</p></li></ol></div><p>Now that we have a nice yellow border, we can create the title bar.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch07lvl3sec78"></a>The title bar</h4></div></div></div><p>Let's create the title bar <a id="id789" class="indexterm"></a>that displays the <code class="literal">Pause</code> label:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select our <code class="literal">InGame3DUI</code> | <code class="literal">PauseMenu</code> GameObject.</p></li><li><p>Create a new empty child GameObject by pressing <span class="emphasis"><em>Alt</em></span> + <span class="emphasis"><em>Shift</em></span> + <span class="emphasis"><em>N</em></span>.</p></li><li><p>Rename this new child to <code class="literal">Title</code>.</p></li><li><p>Select our <code class="literal">InGame3DUI</code> | <code class="literal">PauseMenu</code> | <code class="literal">Background</code> GameObject.</p></li><li><p>Duplicate it by pressing <span class="emphasis"><em>Ctrl + D</em></span>.</p></li><li><p>Drag this new duplicate inside the new <code class="literal">Title</code> GameObject.</p></li><li><p>Check the <span class="strong"><strong>Fill Center</strong></span> option of <code class="literal">UISprite</code>.</p></li><li><p>Set <span class="strong"><strong>Color Tint </strong></span>to {R: 255, G: 200, B: 90, A: 255}.</p></li><li><p>Set the <span class="strong"><strong>Depth</strong></span> value to 1.</p></li><li><p>Change <span class="strong"><strong>Anchor Type</strong></span> to <span class="strong"><strong>Unified</strong></span>.</p></li><li><p>Drag our <code class="literal">InGame3DUI</code> | <code class="literal">PauseMenu</code> | <code class="literal">Background</code> in the <span class="strong"><strong>Target</strong></span> field.</p></li><li><p>Change the <span class="strong"><strong>Bottom</strong></span> anchor field to <span class="strong"><strong>Target's Top</strong></span>.</p></li><li><p>Set the <span class="strong"><strong>Bottom</strong></span> anchor offset to -100.</p></li></ol></div><p>The title bar's background is set up. Now, let's add the title bar's label:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select our <code class="literal">InGame3DUI</code> | <code class="literal">PauseMenu</code> | <code class="literal">Title</code> GameObject.</p></li><li><p>Create a new child label by pressing <span class="emphasis"><em>Alt</em></span> + <span class="emphasis"><em>Shift</em></span> + <span class="emphasis"><em>L</em></span>.</p></li><li><p>Set the <span class="strong"><strong>Transform</strong></span> position to {<code class="literal">0</code>, <code class="literal">250</code>, <code class="literal">0</code>}.</p></li><li><p>For the attached <code class="literal">UILabel</code> component, perform the following steps:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>Change the font type to <span class="strong"><strong>Unity</strong></span>.</p></li><li style="list-style-type: disc"><p>Set <span class="strong"><strong>Font</strong></span> to <span class="strong"><strong>GoodDog</strong></span>.</p></li><li style="list-style-type: disc"><p>Change <span class="strong"><strong>Font Size</strong></span>
<code class="literal"> </code>to <code class="literal">65</code>.</p></li><li style="list-style-type: disc"><p>Change its <span class="strong"><strong>Overflow</strong></span> parameter to <span class="strong"><strong>ResizeFreely</strong></span>.</p></li><li style="list-style-type: disc"><p>Change the label's <span class="strong"><strong>Text</strong></span>
<code class="literal"> </code>to <code class="literal">Pause</code>.</p></li><li style="list-style-type: disc"><p>Set a black <span class="strong"><strong>Outline</strong></span> effect with the <span class="strong"><strong>X</strong></span> and <span class="strong"><strong>Y</strong></span> values as 1.</p></li><li style="list-style-type: disc"><p>Set <span class="strong"><strong>Color Tint</strong></span> to {R: <code class="literal">255</code>, G: <code class="literal">200</code>, B: <code class="literal">150</code>, A: <code class="literal">255</code>}.</p></li></ul></div></li></ol></div><p>Ok, good. You should now have a window like this with the following hierarchy:</p><div class="mediaobject"><img src="/graphics/9781783552979/graphics/2979OT_07_06.jpg" /></div><p>We can now move<a id="id790" class="indexterm"></a> on to creating the two pause menu's buttons.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch07lvl3sec79"></a>Buttons</h4></div></div></div><p>In this section, we'll <a id="id791" class="indexterm"></a>create the <code class="literal">Resume</code>
<a id="id792" class="indexterm"></a> and <code class="literal">Exit</code> 3D buttons.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h5 class="title"><a id="ch07lvl4sec16"></a>Resume</h5></div></div></div><p>We can first create<a id="id793" class="indexterm"></a> the <code class="literal">Resume</code> button by executing the <a id="id794" class="indexterm"></a>following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select our <code class="literal">InGame3DUI</code> | <code class="literal">PauseMenu</code> GameObject.</p></li><li><p>Create a new empty child GameObject by pressing <span class="emphasis"><em>Alt</em></span> + <span class="emphasis"><em>Shift</em></span> + <span class="emphasis"><em>N</em></span>.</p></li><li><p>Rename this new child to <code class="literal">Buttons</code>.</p></li><li><p>Open the <code class="literal">Prefab</code> toolbar navigating to <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>Open</strong></span> | <span class="strong"><strong>Prefab Toolbar</strong></span>.</p></li><li><p>Drag the <span class="strong"><strong>Simple</strong></span> button by navigating to <code class="literal">InGame3DUI</code> | <code class="literal">PauseMenu</code> | <code class="literal">Buttons</code>.</p></li><li><p>Rename this new button to <code class="literal">Resume</code>.</p></li><li><p>Set the <span class="strong"><strong>Transform</strong></span> position to {-270, -40, 0}.</p></li></ol></div><p>Configure the attached <code class="literal">UISprite</code> executing the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Change <span class="strong"><strong>Atlas</strong></span> to the <span class="strong"><strong>Game</strong></span> atlas.</p></li><li><p>Set <span class="strong"><strong>Sprite</strong></span> to the <span class="strong"><strong>Background_Button</strong></span> sprite.</p></li><li><p>Set <span class="strong"><strong>Size</strong></span> to 420 x 420.</p></li></ol></div><p>Now, for the<a id="id795" class="indexterm"></a> attached <code class="literal">UIButton</code> component, perform the <a id="id796" class="indexterm"></a>following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Set the <span class="strong"><strong>Normal</strong></span> color to {R: <code class="literal">170</code>, G: <code class="literal">255</code>, B: <code class="literal">160</code>, A: <code class="literal">255</code>}.</p></li><li><p>Set the <span class="strong"><strong>Hover</strong></span> color to {R: 100, G: 255, B: 100, A: 255}.</p></li><li><p>Set the <span class="strong"><strong>Pressed</strong></span> color to {R: 25, G: 75, B: 0, A: 255}.</p></li><li><p>In the <span class="strong"><strong>Inspector</strong></span> view, type in <code class="literal">sca</code> to search for components with this name.</p></li><li><p>Select <span class="strong"><strong>Button Scale</strong></span> and hit <span class="emphasis"><em>Enter</em></span> or click on it with your mouse.</p></li></ol></div><p>We can now configure the child label executing the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select our <code class="literal">PauseMenu</code> | <code class="literal">Buttons</code> | <code class="literal">Resume</code> | <code class="literal">Label</code> GameObject.</p></li><li><p>Set the font type to <span class="strong"><strong>Unity</strong></span> with the <span class="strong"><strong>GoodDog</strong></span> font.</p></li><li><p>Change <span class="strong"><strong>Font Size</strong></span> to <code class="literal">60</code>.</p></li><li><p>Set <span class="strong"><strong>Text</strong></span> to <code class="literal">Resume</code>.</p></li><li><p>Set a black <span class="strong"><strong>Outline</strong></span> effect with the <span class="strong"><strong>X</strong></span> and <span class="strong"><strong>Y</strong></span> values as 1.</p></li><li><p>Set <span class="strong"><strong>Color Tint</strong></span> to {R: <code class="literal">180</code>, G: <code class="literal">255</code>, B: <code class="literal">170</code>, A: <code class="literal">255</code>}.</p></li><li><p>Change <span class="strong"><strong>Depth</strong></span> to <code class="literal">6</code>.</p></li></ol></div><p>Now that everything is set for this button, we can create the resume sprite:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select our <code class="literal">PauseMenu</code> | <code class="literal">Buttons</code> | <code class="literal">Resume</code> GameObject.</p></li><li><p>Create a new child sprite by pressing <span class="emphasis"><em>Alt</em></span> + <span class="emphasis"><em>Shift</em></span> + <span class="emphasis"><em>S</em></span>.</p></li><li><p>Rename this new sprite to <code class="literal">Icon</code>.</p></li><li><p>Change <span class="strong"><strong>Sprite</strong></span> to the <span class="strong"><strong>Game</strong></span> atlas.</p></li><li><p>Set <span class="strong"><strong>Sprite</strong></span> to the <span class="strong"><strong>Icon_Play</strong></span> sprite.</p></li><li><p>Change <span class="strong"><strong>Type</strong></span> to <span class="strong"><strong>Simple</strong></span>.</p></li><li><p>Set <span class="strong"><strong>Color Tint</strong></span> to {R: <code class="literal">115</code>, G: <code class="literal">240</code>, B: <code class="literal">75</code>, A: <code class="literal">255</code>}.</p></li><li><p>Set <span class="strong"><strong>Depth</strong></span> to 5.</p></li><li><p>Change <span class="strong"><strong>Size</strong></span> to 380 x 380.</p></li></ol></div><p>Great! Now that we have our <code class="literal">Resume</code> button, we can move on to the <code class="literal">Exit</code> button.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h5 class="title"><a id="ch07lvl4sec17"></a>Exit</h5></div></div></div><p>Follow<a id="id797" class="indexterm"></a> these steps to<a id="id798" class="indexterm"></a> create the <code class="literal">Exit</code> button based on<a id="id799" class="indexterm"></a> the <code class="literal">Resume</code> button:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select our <code class="literal">PauseMenu</code> | <code class="literal">Buttons</code> | <code class="literal">Resume</code> GameObject.</p></li><li><p>Duplicate it by pressing <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>D</em></span>.</p></li><li><p>Rename this new duplicate button to <code class="literal">Exit</code>.</p></li><li><p>Change the <span class="strong"><strong>Transform</strong></span> position to {<code class="literal">270</code>, <code class="literal">-40</code>, <code class="literal">0</code>}.</p></li><li><p>Set the <span class="strong"><strong>Normal</strong></span> color to {R: <code class="literal">255</code>, G: <code class="literal">180</code>, B: <code class="literal">160</code>, A: <code class="literal">255</code>}.</p></li><li><p>Set the <span class="strong"><strong>Hover</strong></span> color to {R: <code class="literal">255</code>, G: <code class="literal">85</code>, B: <code class="literal">85</code>, A: <code class="literal">255</code>}.</p></li><li><p>Set the <span class="strong"><strong>Pressed</strong></span> color to {R: <code class="literal">75</code>, G: <code class="literal">0</code>, B: <code class="literal">0</code>, A: <code class="literal">255</code>}.</p></li></ol></div><p>We can now update the child label to red, similar to what we did in the background. Execute the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select our <code class="literal">PauseMenu</code> | <code class="literal">Buttons</code> | <code class="literal">Exit</code> | <code class="literal">Label</code> GameObject.</p></li><li><p>Set <span class="strong"><strong>Text</strong></span> to <code class="literal">Exit</code>.</p></li><li><p>Set <span class="strong"><strong>Color Tint</strong></span> to {R: <code class="literal">255</code>, G: <code class="literal">210</code>, B: <code class="literal">210</code>, A: <code class="literal">255</code>}.</p></li></ol></div><p>We must now change the icon and make sure it's red too:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select our <code class="literal">PauseMenu</code> | <code class="literal">Buttons</code> | <code class="literal">Exit</code> | <code class="literal">Icon</code> GameObject.</p></li><li><p>Change <span class="strong"><strong>Sprite</strong></span> to <span class="strong"><strong>Icon_Exit</strong></span>.</p></li><li><p>Set <span class="strong"><strong>Color Tint</strong></span> to {R: <code class="literal">255</code>, G: <code class="literal">180</code>, B: <code class="literal">180</code>, A: 255}.</p></li></ol></div><p>Good! Now, let's add a 3D effect to give the impression that our pause menu is displayed on the level's ground:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select our <code class="literal">InGame3DUI</code> | <code class="literal">PauseMenu</code> GameObject.</p></li><li><p>Change the <span class="strong"><strong>Transform</strong></span> rotation to {<code class="literal">22</code>, <code class="literal">0</code>, <code class="literal">0</code>}.</p></li></ol></div><p>Great! Our pause menu is now ready. Your <span class="strong"><strong>Game</strong></span> view and <span class="strong"><strong>Hierarchy</strong></span> should look like this:</p><div class="mediaobject"><img src="/graphics/9781783552979/graphics/2979OT_07_07.jpg" /></div><p>We can<a id="id800" class="indexterm"></a> now see how<a id="id801" class="indexterm"></a> to show this pause menu when<a id="id802" class="indexterm"></a> required.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch07lvl3sec80"></a>Displaying the pause menu</h4></div></div></div><p>We need to display the <a id="id803" class="indexterm"></a>pause menu when the pause button is pressed. Let's do this using an alpha tween to gradually change the pause menu's alpha value.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h5 class="title"><a id="ch07lvl4sec18"></a>The tween alpha</h5></div></div></div><p>Follow these<a id="id804" class="indexterm"></a> steps to configure a <code class="literal">Tween Alpha</code> component <a id="id805" class="indexterm"></a>on <code class="literal">PauseMenu</code>:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select our <code class="literal">InGame3DUI</code> | <code class="literal">PauseMenu</code> GameObject.</p></li><li><p>Click on the <span class="strong"><strong>Add Component</strong></span> button in the inspector.</p></li><li><p>Type in <code class="literal">alp</code> to search for components with this name.</p></li><li><p>Select <span class="strong"><strong>Tween Alpha</strong></span> and hit <span class="emphasis"><em>Enter</em></span> or click on it with your mouse.</p></li><li><p>Set the <span class="strong"><strong>From</strong></span> value to 0 in the newly attached <code class="literal">Tween Alpha</code>.</p></li><li><p>Change the <span class="strong"><strong>Duration</strong></span> value to <code class="literal">0.5</code>.</p></li></ol></div><p>The alpha tween is configured. We must now request it to play when necessary.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h5 class="title"><a id="ch07lvl4sec19"></a>The Play Tween</h5></div></div></div><p>We'll use <a id="id806" class="indexterm"></a>
<code class="literal">Play Tween</code> to play the alpha tween when the <code class="literal">Pause</code>
<a id="id807" class="indexterm"></a> button is clicked on:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select our <code class="literal">InGame3DUI</code> | <code class="literal">TopButtons</code> | <code class="literal">Pause</code> GameObject.</p></li><li><p>Click on the <span class="strong"><strong>Add Component</strong></span> button in the inspector.</p></li><li><p>Type in <code class="literal">play</code> to search for components with this name.</p></li><li><p>Select <span class="strong"><strong>Play Tween</strong></span> and hit <span class="emphasis"><em>Enter</em></span> or click on it with your mouse.</p></li><li><p>Drag our <code class="literal">InGame3DUI</code> | <code class="literal">PauseMenu</code> in the <span class="strong"><strong>Tween Target</strong></span> field.</p></li><li><p>Set the <span class="strong"><strong>If target is disabled</strong></span> field to <span class="strong"><strong>EnableThenPlay</strong></span>.</p></li></ol></div><p>The pause menu will be faded in when the pause button is clicked on. We need to make sure it fades out when the resume button is clicked on, using <code class="literal">Play Tween</code> again:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select our <code class="literal">InGame3DUI</code> | <code class="literal">PauseMenu</code> | <code class="literal">Buttons</code> | <code class="literal">Resume</code> GameObject.</p></li><li><p>Click on the <span class="strong"><strong>Add Component</strong></span> button in the inspector.</p></li><li><p>Type in <code class="literal">play</code> to search for components with this name.</p></li><li><p>Select <span class="strong"><strong>Play Tween</strong></span> and hit <span class="emphasis"><em>Enter</em></span> or click on it with your mouse.</p></li><li><p>Drag our <code class="literal">InGame3DUI</code> | <code class="literal">PauseMenu</code> in its <span class="strong"><strong>Tween Target</strong></span> field.</p></li><li><p>Set the <span class="strong"><strong>Play Direction</strong></span> field to <span class="strong"><strong>Reverse</strong></span>.</p></li><li><p>Set the <span class="strong"><strong>When finished</strong></span> field to <span class="strong"><strong>Disable After Reverse</strong></span>.</p></li></ol></div><p>Good! The pause menu will now fade out and disable itself when the resume button is pressed. We can now hide the pause button when the pause menu is displayed, and display it again when the resume button is pressed. Perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select our <code class="literal">InGame3DUI</code> | <code class="literal">TopButtons</code> | <code class="literal">Pause</code> GameObject.</p></li><li><p>Click on the <span class="strong"><strong>Add Component</strong></span> button in the <span class="strong"><strong>Inspector</strong></span> view.</p></li><li><p>Type in <code class="literal">acti</code> to search for components with this name.</p></li><li><p>Select <span class="strong"><strong>Button Activate</strong></span> and hit <span class="emphasis"><em>Enter</em></span> or click on it with your mouse.</p></li><li><p>Drag <code class="literal">InGame3DUI</code> | <code class="literal">TopButtons</code> | <code class="literal">Pause</code> (itself) in the <span class="strong"><strong>Target</strong></span> field.</p></li><li><p>Uncheck the <span class="strong"><strong>State</strong></span> option to make it disable itself upon clicking.</p></li></ol></div><p>The <code class="literal">Button Activate</code> component enables or disables the state of <code class="literal">Target</code>, depending on the <code class="literal">State</code> bool's value. In the previous steps, we unchecked the <code class="literal">State</code> checkbox, so the pause button will be disabled as soon as it's clicked on.</p><p>Now, we can use the same component to re-enable the pause button when the resume button is pressed. Perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select<a id="id808" class="indexterm"></a> our <code class="literal">InGame3DUI</code> | <code class="literal">PauseMenu</code> | <code class="literal">Buttons</code> | <code class="literal">Resume</code> GameObject.</p></li><li><p>Click on the <span class="strong"><strong>Add Component</strong></span> button in the inspector.</p></li><li><p>Type in <code class="literal">acti</code> to search for components with this name.</p></li><li><p>Select <span class="strong"><strong>Button Activate</strong></span> and hit <span class="emphasis"><em>Enter</em></span> or click on it with your mouse.</p></li><li><p>Drag our <code class="literal">InGame3DUI</code> | <code class="literal">TopButtons</code> | <code class="literal">Pause</code> button in its <span class="strong"><strong>Target</strong></span> field.</p></li><li><p>Leave the <span class="strong"><strong>State</strong></span> option checked.</p></li></ol></div><p>Now, the pause button will be re-enabled when the resume button is clicked on. We need our pause menu to be disabled at the start. Let's do this by executing the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select our <code class="literal">InGame3DUI</code> | <code class="literal">PauseMenu</code> GameObject.</p></li><li><p>Disable it in the <span class="strong"><strong>Inspector</strong></span> checkbox.</p></li></ol></div><p>Hit Unity's play<a id="id809" class="indexterm"></a> button. You can now hit the <span class="strong"><strong>Pause</strong></span> button. <code class="literal">PauseMenu</code> fades in as if it were displayed on the level's ground. When you hit the <span class="strong"><strong>Resume</strong></span> button, the menu fades out and the <span class="strong"><strong>Pause</strong></span> button reappears.</p><p>We can now link the buttons to methods to handle the actual pause and exit behaviors.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch07lvl3sec81"></a>Linking the buttons</h4></div></div></div><p>We'll first add the <a id="id810" class="indexterm"></a>necessary methods, and then link our buttons to them.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h5 class="title"><a id="ch07lvl4sec20"></a>Methods</h5></div></div></div><p>Open <a id="id811" class="indexterm"></a>the <code class="literal">GameManager.cs</code> script and add the following methods:</p><div class="informalexample"><pre class="programlisting">// Method called when pause button is pressed
<span class="strong"><strong>public void PausePressed()</strong></span>
{
  // Request pause
<span class="strong"><strong>  SetPause(true);</strong></span>
}

// Method called when resume button is pressed
<span class="strong"><strong>public void ResumePresssed()</strong></span>
{
  // Request unpause
<span class="strong"><strong>  SetPause(false);</strong></span>
}

// Method called when Exit button is pressed
<span class="strong"><strong>public void ExitPressed()</strong></span>
{
  // Request to return to main menu
<span class="strong"><strong>  ReturnToMenu();</strong></span>
}</pre></div><p>The above methods<a id="id812" class="indexterm"></a> will be linked to the buttons shortly. Before we do this, we need to add the required <code class="literal">ReturnToMenu()</code> and <code class="literal">SetPause()</code> methods:</p><div class="informalexample"><pre class="programlisting">// Use this method to return to the main menu
<span class="strong"><strong>public void ReturnToMenu()</strong></span>
{
  // Unpause the game
<span class="strong"><strong>  ResumePresssed();</strong></span>
  // Destroy the player instance
<span class="strong"><strong>  Destroy(PlayerController.Instance);</strong></span>

  Transform mainMenu = null;
<span class="strong"><strong>  mainMenu = MenuManager.Instance.transform.FindChild("Main");</strong></span>
  if(mainMenu != null)
  {
    // Set the MenuManager | Main scale to 1
<span class="strong"><strong>    mainMenu.localScale = Vector3.one;</strong></span>
  }
  // Launch the EnterMenu couroutine
<span class="strong"><strong>StartCoroutine(EnterMenu());</strong></span>
}

// EnterMenu Coroutine
<span class="strong"><strong>private IEnumerator EnterMenu()</strong></span>
{
  // Show the main menu UI by enabling cam
<span class="strong"><strong>  MenuManager.Instance.uiCamera.enabled = true;</strong></span>
  // Fade in the UI background
<span class="strong"><strong>  TweenAlpha.Begin(MenuManager.Instance.background, 0.5f, 1);</strong></span>
  // Wait for the tween to finish
<span class="strong"><strong>  yield return new WaitForSeconds(0.5f);</strong></span>
  // Load the Menu scene now
<span class="strong"><strong>  Application.LoadLevel("Menu");  </strong></span>
}

// Use this method to pause / unpause game
<span class="strong"><strong>public void SetPause(bool state)</strong></span>
{
  // Set the timescale to appropriate value
<span class="strong"><strong>  Time.timeScale = (state ? 0 : 1);</strong></span>
}</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note40"></a>Note</h3><p>Make sure that the <code class="literal">Menu</code> and <code class="literal">Game</code> scenes are both in the <code class="literal">Build Settings</code> of the project by navigating to <span class="strong"><strong>File</strong></span> | <span class="strong"><strong>Build Settings</strong></span>.</p></div><p>Good! The preceding <a id="id813" class="indexterm"></a>code pauses the game when <code class="literal">SetPause(true)</code> is called, and resumes it on <code class="literal">SetPause(false)</code>.</p><p>The <code class="literal">ReturnToMenu()</code> method destroys the player, shows our main menu by resetting its scale to 1, and launches the <code class="literal">EnterMenu()</code> coroutine.</p><p>This coroutine re-enables the main menu's camera and fades back the UI background before loading the <code class="literal">Menu</code> scene.</p><p>We can now move on to linking our buttons to their appropriate methods.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h5 class="title"><a id="ch07lvl4sec21"></a>Link</h5></div></div></div><p>Follow these<a id="id814" class="indexterm"></a> steps to link our pause, resume, and exit buttons to their respective methods:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select our <code class="literal">InGame3DUI</code> | <code class="literal">TopButtons</code> | <code class="literal">Pause</code> button.</p></li><li><p>For the attached <code class="literal">UIButton</code> component:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Drag <code class="literal">GameManager</code> to the <span class="strong"><strong>On Click Notify</strong></span> field.</p></li><li><p>Navigate to <span class="strong"><strong>GameManager</strong></span> | <span class="strong"><strong>PausePressed</strong></span>.</p></li></ol></div></li><li><p>Select our <code class="literal">InGame3DUI</code> | <code class="literal">PauseMenu</code> | <code class="literal">Buttons</code> | <code class="literal">Resume</code> button.</p></li><li><p>For its attached <code class="literal">UIButton</code> component:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Drag <code class="literal">GameManager</code> to the <span class="strong"><strong>On Click Notify</strong></span> field.</p></li><li><p>Navigate to <span class="strong"><strong>GameManager</strong></span> | <span class="strong"><strong>ResumePressed</strong></span>.</p></li></ol></div></li><li><p>Select our <code class="literal">InGame3DUI</code> | <code class="literal">PauseMenu</code> | <code class="literal">Buttons</code> | <code class="literal">Exit</code> button.</p></li><li><p>For its attached <code class="literal">UIButton</code> component:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Drag <code class="literal">GameManager</code> to the <span class="strong"><strong>On Click Notify</strong></span> field.</p></li><li><p>Navigate to <span class="strong"><strong>GameManager</strong></span> | <span class="strong"><strong>ExitPressed</strong></span>.</p></li></ol></div></li></ol></div><p>Now, load the <code class="literal">Menu</code> scene and hit Unity's play button. You can launch the game and hit the pause button. The game pauses, and you can either resume the game or go back to the main menu using<a id="id815" class="indexterm"></a> the two buttons!</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note41"></a>Note</h3><p>Though <code class="literal">Time.timeScale</code> is set to 0, the pause menu's alpha tween still works correctly. This is because the tween's <span class="strong"><strong>Ignore Time Scale</strong></span> option is checked.</p></div></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch07lvl3sec82"></a>Key bindings</h4></div></div></div><p>We can add a<a id="id816" class="indexterm"></a> simple feature; when the player hits the <span class="emphasis"><em>Escape</em></span> key, the game pauses or resumes. We'll do this using the <code class="literal">UIKey Binding</code>
<a id="id817" class="indexterm"></a> component:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Open the <code class="literal">Game</code> scene</p></li><li><p>Select both our <code class="literal">InGame3DUI</code> | <code class="literal">TopButtons</code> | <code class="literal">Pause</code> and <code class="literal">PauseMenu</code> | <code class="literal">Buttons</code> | <code class="literal">Resume</code> buttons.</p></li><li><p>Click the <span class="strong"><strong>Add Component</strong></span> button in the inspector.</p></li><li><p>Type in <code class="literal">key</code> to search for components with this name.</p></li><li><p>Select <span class="strong"><strong>Key Binding</strong></span> and hit <span class="emphasis"><em>Enter</em></span> or click on it with your mouse.</p></li><li><p>Set the <span class="strong"><strong>Key Code</strong></span> field of the newly added <code class="literal">UIKey Binding</code> to escape.</p></li></ol></div><p>You can now hit Unity's play button; you'll see that hitting <span class="emphasis"><em>Escape</em></span> will pause and resume the game anytime!</p><p>Great! We have a slight problem; interactive elements are still active while the game is paused. We need to find a way to easily prevent the player from moving or right-clicking on a power source, or changing the character's destination while the game is paused.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch07lvl3sec83"></a>Interaction override</h4></div></div></div><p>We will create what can be referred<a id="id818" class="indexterm"></a> to as an <span class="strong"><strong>interaction override</strong></span>. Here, a trigger collider is placed over our game's interactive elements, which will <a id="id819" class="indexterm"></a>prevent them from being hit by the interaction raycast of <code class="literal">UICamera</code>. Since the 3D UI with NGUI uses the <code class="literal">Depth</code> value to check collisions, we should also add the <code class="literal">UIWidget</code> component to the interaction override.</p><p>We can create it right now for the pause menu:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select our <code class="literal">InGame3DUI</code> | <code class="literal">PauseMenu</code> GameObject.</p></li><li><p>Create a new empty child GameObject by pressing <span class="emphasis"><em>Alt</em></span> + <span class="emphasis"><em>Shift</em></span> + <span class="emphasis"><em>N</em></span>.</p></li><li><p>Rename this new child to <code class="literal">Override</code>.</p></li><li><p>Click on the <span class="strong"><strong>Add Component</strong></span> button in the inspector.</p></li><li><p>Type in <code class="literal">box</code> to search for components with this name.</p></li><li><p>Select <span class="strong"><strong>Box Collider</strong></span> and hit <span class="emphasis"><em>Enter</em></span>.</p></li><li><p>Click the <span class="strong"><strong>Add Component</strong></span> button again.</p></li><li><p>Type in <code class="literal">wid</code> to search for components with this name.</p></li><li><p>Select <span class="strong"><strong>NGUI Widget</strong></span> and hit <span class="emphasis"><em>Enter</em></span> or click on it with your mouse.</p></li></ol></div><p>We now have<a id="id820" class="indexterm"></a> a box collider and <code class="literal">UI Widget</code> on our <code class="literal">Override</code> GameObject. Configure them as follows in order to make sure they take up the entire screen:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select our new <code class="literal">InGame3DUI</code> | <code class="literal">PauseMenu</code> | <code class="literal">Override</code> GameObject.</p></li><li><p>Set the <span class="strong"><strong>Transform</strong></span> rotation to {-22, 0, 0}.</p></li><li><p>For the attached <code class="literal">UIWidget</code> component:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>Check the <span class="strong"><strong>Collider auto-adjust to match</strong></span> option.</p></li><li style="list-style-type: disc"><p>Set <span class="strong"><strong>Size</strong></span> to 1920 x 1080.</p></li><li style="list-style-type: disc"><p>Set <span class="strong"><strong>Depth</strong></span> to 3.</p></li></ul></div></li><li><p>For its attached <code class="literal">Box Collider</code> component:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>Check the <span class="strong"><strong>Is Trigger</strong></span> option.</p></li></ul></div></li></ol></div><p>Good! Hit Unity's play button. When you pause the game, interactive elements such as power sources and the ground become inactive because the raycast of <code class="literal">UICamera</code> first touches the collider of <code class="literal">Override</code>.</p><p>Now that we have our nice 3D pause menu, let's see how we can add a 3D text or sprites directly onto the environment's objects.</p></div></div></div>