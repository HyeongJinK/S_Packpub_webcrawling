<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch04lvl1sec46"></a>Saving options</h2></div></div><hr /></div><p>The player's <a id="id545" class="indexterm"></a>nickname is saved automatically within <code class="literal">PlayerPrefs</code> because its <span class="strong"><strong>Saved As</strong></span> parameter is set to <code class="literal">PlayerName</code>. The current language<a id="id546" class="indexterm"></a> is saved thanks to the <code class="literal">Language Selection</code> component attached to our language popup list.</p><p>We'll now use an NGUI component that helps us to save other user interface values like progress bars and checkbox states in <code class="literal">PlayerPrefs</code>.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec87"></a>The UISaved option</h3></div></div></div><p>In order to achieve this, we<a id="id547" class="indexterm"></a> simply have to<a id="id548" class="indexterm"></a> attach the <code class="literal">UISaved Option</code> component to NGUI widgets. Select the following GameObjects we'll want to save the option to:</p><div class="mediaobject"><img src="/graphics/9781783552979/graphics/2979OT_04_20.jpg" /><div class="caption"><p>Select the Subtitle's List, Sound Checkbox, and Volume's SFX and Music sliders.</p></div></div><p>With the preceding selection, follow these steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Click the <span class="strong"><strong>Add Component</strong></span> button in the Inspector view.</p></li><li><p>Type <code class="literal">save</code> with your keyboard to search for components.</p></li><li><p>Select <span class="strong"><strong>Saved Option</strong></span> and hit <span class="emphasis"><em>Enter</em></span> or click on it with your mouse.</p></li></ol></div><p>We've just added<a id="id549" class="indexterm"></a> the <code class="literal">UISaved Option</code> component to our selection.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch04lvl3sec52"></a>Configuration</h4></div></div></div><p>The only parameter the <code class="literal">UISaved Option</code> component has is <span class="strong"><strong>Key Name</strong></span>. You must define the <code class="literal">PlayerPrefs</code> key name for the saved option.</p><p>We'll now configure them so that all these <a id="id550" class="indexterm"></a>user interface elements save their values in their appropriate <code class="literal">PlayerPrefs</code> key names:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select the <code class="literal">Options</code> | <code class="literal">Subtitles</code> | <code class="literal">List</code> GameObject, and enter <code class="literal">Subtitles</code> for <span class="strong"><strong>Key Name</strong></span> of <code class="literal">UISaved Option</code>.</p></li><li><p>Select the <code class="literal">Options</code> | <code class="literal">Sound</code> | <code class="literal">Checkbox</code> GameObject, and enter <code class="literal">Sound</code> for <span class="strong"><strong>Key Name</strong></span> of <code class="literal">UISaved Option</code>.</p></li><li><p>Select the <code class="literal">Options</code> | <code class="literal">Volume</code> | <code class="literal">SFX</code> GameObject and enter <code class="literal">SFX</code> for <span class="strong"><strong>Key Name</strong></span> of <code class="literal">UISaved Option</code>.</p></li><li><p>Select the <code class="literal">Options</code> | <code class="literal">Volume</code> | <code class="literal">Music</code> GameObject and enter <code class="literal">Music</code> for <span class="strong"><strong>Key Name</strong></span> of <code class="literal">UISaved Option</code>.</p></li></ol></div><p>Hit Unity's <span class="strong"><strong>play</strong></span> button. You'll now see that the states of the sound checkbox, volumes sliders, and subtitles popup list are now saved, even after game exit.</p><p>We have a small problem concerning the sound checkboxâ€¦</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec88"></a>The sound checkbox</h3></div></div></div><p>We have an issue with the sound<a id="id551" class="indexterm"></a> enabling checkbox<a id="id552" class="indexterm"></a> saving option. Indeed, if you disable sound, exit the play mode, and enter it again, you'll encounter the following aberration:</p><div class="mediaobject"><img src="/graphics/9781783552979/graphics/2979OT_04_21.jpg" /></div><p>As you can see on the preceding<a id="id553" class="indexterm"></a> screenshot, the sound is disabled, but the volume box is displayed. Even worse; if you enable sound, the volume box disappears!</p><p>This issue is prompted by the<a id="id554" class="indexterm"></a> fact that the checkbox's state is saved and up-to-date, but <code class="literal">UIPlay Tween</code> that hides or shows the volume box is only triggered on a click event.</p><p>We'll correct this by forcing the checkbox's <code class="literal">UIPlay Tween</code> to play forward (hide volume box) if it's unchecked at <code class="literal">Start()</code>:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select the <code class="literal">Options</code> | <code class="literal">Sound</code> | <code class="literal">Checkbox</code> GameObject.</p></li><li><p>In the <span class="strong"><strong>Hierarchy</strong></span> view, click the <span class="strong"><strong>Add Component</strong></span> button.</p></li><li><p>Type <code class="literal">ToggleInit</code> on your keyboard. No match will be found.</p></li><li><p>With the <span class="strong"><strong>New Script</strong></span> option highlighted, hit <span class="emphasis"><em>Enter</em></span> on your keyboard.</p></li><li><p>In the next dialog box, make sure the <span class="strong"><strong>Language</strong></span> is in <span class="strong"><strong>CSharp</strong></span> and hit <span class="emphasis"><em>Enter</em></span>.</p></li></ol></div><p>Now, open our new <code class="literal">ToggleInit</code> <code class="literal">.cs</code> script and replace the <code class="literal">Start()</code> method with this one:</p><div class="informalexample"><pre class="programlisting">// At Start
<span class="strong"><strong>void Start () {</strong></span>

  // Retrieve the attached UIToggle
<span class="strong"><strong>  UIToggle toggle = GetComponent&lt;UIToggle&gt;();</strong></span>

  // If there's an unchecked UIToggle...
  if(toggle != null &amp;&amp; !toggle.value)
  {
    // ...Retrieve the tween to play
    UIPlayTween tweenToPlay = GetComponent&lt;UIPlayTween&gt;();

    // If there's a tween to play...
    if(tweenToPlay != null)
    {
      // ...Play it now
<span class="strong"><strong>      tweenToPlay.Play(true);</strong></span>
    }
  }
}</pre></div><p>Save the script. In the <a id="id555" class="indexterm"></a>preceding code, we force the volume box to fade out (play attached tween forward) if the checkbox is unchecked (<code class="literal">toggle.value == false</code>).</p><p>If you test it now, you'll see that if the checkbox is saved as unchecked, the sound will remain disabled and the volume sliders won't be displayed. Good!</p><p>Now, let's talk about an important matter: the UI's persistence through scene changing.</p></div></div>