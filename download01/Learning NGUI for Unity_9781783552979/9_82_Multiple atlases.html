<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch09lvl1sec80"></a>Multiple atlases</h2></div></div><hr /></div><p>One<a id="id951" class="indexterm"></a> problem we'll have when scaling up our UI is that the images' quality will be decreased. A 256 x 256 pixels sprite scaled up to 512 x 512 will look blurry.</p><p>In order to avoid having blurry sprites, we could simply have all our assets in high-definition sizes. On the one hand, they will always look good, even on high-resolution displays. On the<a id="id952" class="indexterm"></a> other hand, displaying a 1024 x 1024 sprite on a small screen with an effective final size of 128 x 128 will result in a waste of the device's memory.</p><p>Hence, it is useful to create, for example, three atlases for different resolution ranges:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>
<code class="literal">SDAtlas</code>: This <a id="id953" class="indexterm"></a>is for screens up to 800 x 480. Example devices include:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>iPhone 3G and 3GS 480 x 320</p></li></ul></div></li><li><p>
<code class="literal">HDAtlas</code>: This <a id="id954" class="indexterm"></a>is for screens from 800 x 480 to 1600 x 1200. Example devices include:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>iPhone 4 and 4S: 960 x 640</p></li><li style="list-style-type: disc"><p>iPhone 6: 1334 x 750</p></li><li style="list-style-type: disc"><p>iPad 2: 1024 x 768</p></li><li style="list-style-type: disc"><p>Galaxy S2: 1280 x 720</p></li></ul></div></li><li><p>
<code class="literal">SHDAtlas</code>: This<a id="id955" class="indexterm"></a> is for screens from 1600 x 1200 and above. Example devices include:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>Nexus 5: 1920 x 1080</p></li><li style="list-style-type: disc"><p>iPad 3: 2048 x 1536</p></li><li style="list-style-type: disc"><p>Nexus 7: 1920 x 1200</p></li><li style="list-style-type: disc"><p>Nexus 10: 2560 x 1600</p></li></ul></div></li></ol></div><p>The preceding three atlases will contain the same sprites of different resolutions. We can then switch the used atlas at runtime depending on the device's screen resolution. If you are using bitmap fonts, they also have to be created with different sizes so that we don't end up with aliased and blurry text for large titles.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl2sec147"></a>Creating the atlases</h3></div></div></div><p>We will<a id="id956" class="indexterm"></a> now create three atlases: <code class="literal">SDAtlas</code>, <code class="literal">HDAtlas</code>, and <a id="id957" class="indexterm"></a>
<code class="literal">SHDAtlas</code>. They will contain the <code class="literal">Button</code> sprite in its appropriate resolution: standard definition, high definition, or super high definition.</p><p>A fourth, <code class="literal">ScreenAtlas</code>, which <a id="id958" class="indexterm"></a>we call a <span class="strong"><strong>reference atlas</strong></span>, will also be created. <code class="literal">ScreenAtlas</code> will simply point to the correct atlas depending on the screen's resolution.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip27"></a>Tip</h3><p>Remember that an atlas should:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>Always have a power-of-two size</p></li><li style="list-style-type: disc"><p>Minimize wasted space</p></li><li style="list-style-type: disc"><p>Contain small images, such as buttons, scrollbars, icons, and so on</p></li><li style="list-style-type: disc"><p>Not contain large background images or textures</p></li></ul></div><p>Remember<a id="id959" class="indexterm"></a> to use the <code class="literal">UITexture</code> component<a id="id960" class="indexterm"></a> to display backgrounds or large textures instead of adding them to atlases.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch09lvl3sec90"></a>SDAtlas</h4></div></div></div><p>Let's start <a id="id961" class="indexterm"></a>by creating the standard definition atlas. Follow these steps to <a id="id962" class="indexterm"></a>create it now:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Open <span class="strong"><strong>Atlas Maker</strong></span> by navigating to <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>Open</strong></span> | <span class="strong"><strong>Atlas Maker</strong></span>.</p></li><li><p>Click on the <span class="strong"><strong>New</strong></span> button (<span class="strong"><strong>1</strong></span>) of <span class="strong"><strong>Atlas Maker</strong></span>, as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783552979/graphics/2979OT_09_06.jpg" /></div></li><li><p>In the <span class="strong"><strong>Project</strong></span> view, go to the <code class="literal">Assets/Resources/Textures</code> folder:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>Select the <code class="literal">ButtonSD</code> texture file</p></li></ul></div></li><li><p>Click on the <span class="strong"><strong>Atlas Maker</strong></span> window's <span class="strong"><strong>Create</strong></span> button, as follows:</p><div class="mediaobject"><img src="/graphics/9781783552979/graphics/2979OT_09_07.jpg" /></div></li><li><p>In<a id="id963" class="indexterm"></a> the window that appears, go to <code class="literal">Assets/Resources/Atlas</code>:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>Enter <code class="literal">SDAtlas</code> for the new atlas's name</p></li><li style="list-style-type: disc"><p>Click <a id="id964" class="indexterm"></a>on the window's <span class="strong"><strong>Save</strong></span> button</p></li></ul></div></li></ol></div><p>Okay. We have <code class="literal">SDAtlas</code> with the button's sprite in standard definition. We can do the same for the high-definition atlas.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch09lvl3sec91"></a>HDAtlas</h4></div></div></div><p>Now, let's <a id="id965" class="indexterm"></a>create <code class="literal">HDAtlas</code>:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Open<a id="id966" class="indexterm"></a> <span class="strong"><strong>Atlas Maker</strong></span> by navigating to <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>Open</strong></span> | <span class="strong"><strong>Atlas Maker</strong></span>:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>Click on the <span class="strong"><strong>New</strong></span> button of <span class="strong"><strong>Atlas Maker</strong></span>
</p></li></ul></div></li><li><p>In the <span class="strong"><strong>Project</strong></span> view, go to the <code class="literal">Assets/Resources/Textures</code> folder:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>Select the <code class="literal">ButtonHD</code> texture file</p></li></ul></div></li><li><p>Click on the <span class="strong"><strong>Atlas Maker</strong></span> window's <span class="strong"><strong>Create</strong></span> button:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>Go to <code class="literal">Assets/Resources/Atlas</code>
</p></li><li style="list-style-type: disc"><p>Enter <code class="literal">HDAtlas</code> for the new atlas's name</p></li><li style="list-style-type: disc"><p>Click on the window's <span class="strong"><strong>Save</strong></span> button</p></li></ul></div></li></ol></div><p>
<code class="literal">HDAtlas</code> has been created, containing the button sprite in high definition. Let's finally create the super high definition atlas.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch09lvl3sec92"></a>SHDAtlas</h4></div></div></div><p>Follow<a id="id967" class="indexterm"></a> these steps to create <code class="literal">SHDAtlas</code>:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Open <a id="id968" class="indexterm"></a>
<span class="strong"><strong>Atlas Maker</strong></span> by navigating to <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>Open</strong></span> | <span class="strong"><strong>Atlas Maker</strong></span>:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>Click on the <span class="strong"><strong>New</strong></span> button of <span class="strong"><strong>Atlas Maker</strong></span>
</p></li></ul></div></li><li><p>In the <span class="strong"><strong>Project</strong></span> view, go to the <code class="literal">Assets/Resources/Textures</code> folder:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>Select the <code class="literal">ButtonSHD</code> texture file</p></li></ul></div></li><li><p>Click on the <span class="strong"><strong>Atlas Maker</strong></span> window's <span class="strong"><strong>Create</strong></span> button:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>Go to <code class="literal">Assets/Resources/Atlas</code>
</p></li><li style="list-style-type: disc"><p>Enter <code class="literal">SHDAtlas</code> for the new atlas's name</p></li><li style="list-style-type: disc"><p>Click on the window's <span class="strong"><strong>Save</strong></span> button</p></li></ul></div></li></ol></div><p>
<code class="literal">SHDAtlas</code> is ready and has the button sprite in super high definition. We can now create the last <code class="literal">ScreenAtlas</code> reference atlas.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch09lvl3sec93"></a>ScreenAtlas</h4></div></div></div><p>This<a id="id969" class="indexterm"></a> fourth atlas is special; it isn't at atlas, really. It only points to<a id="id970" class="indexterm"></a> the desired atlas. We'll use that to change the selected atlas to use through code. Let's create it now:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>In the <span class="strong"><strong>Project</strong></span> view, go to the <code class="literal">Assets/Resources/Atlas</code> folder.</p></li><li><p>Select the <span class="strong"><strong>SDAtlas </strong></span>prefab file, as follows:</p><div class="mediaobject"><img src="/graphics/9781783552979/graphics/2979OT_09_08.jpg" /></div></li><li><p>Duplicate it with <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>D</em></span>.</p></li><li><p>Rename the new duplicate from <code class="literal">SDAtlas 1</code> to <code class="literal">ScreenAtlas</code>.</p></li><li><p>Select our new <span class="strong"><strong>ScreenAtlas</strong></span> prefab file.</p></li></ol></div><p>The <span class="strong"><strong>Inspector</strong></span> view displays the following content:</p><div class="mediaobject"><img src="/graphics/9781783552979/graphics/2979OT_09_09.jpg" /></div><p>The <span class="strong"><strong>ScreenAtlas</strong></span> prefab's <span class="strong"><strong>Atlas Type</strong></span> (<span class="strong"><strong>1</strong></span>) value is currently set to <span class="strong"><strong>Normal</strong></span>. Switch it to <span class="strong"><strong>Reference</strong></span> now. The<a id="id971" class="indexterm"></a> <span class="strong"><strong>Inspector</strong></span> panel now looks like this:</p><div class="mediaobject"><img src="/graphics/9781783552979/graphics/2979OT_09_10.jpg" /></div><p>You might <a id="id972" class="indexterm"></a>notice that all atlas information has disappeared; it's currently empty and points to nothing. Let's make it point to <code class="literal">SDAtlas</code> by default:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Click on the <span class="strong"><strong>Atlas</strong></span> button (<span class="strong"><strong>1</strong></span>).</p></li><li><p>Select <span class="strong"><strong>SDAtlas</strong></span> in the pop-up window.</p></li></ol></div><p>Good. Now, when we configure our widgets in the editor, we'll use <code class="literal">ScreenAtlas</code> instead of any other. By default, it will point to <code class="literal">SDAtlas</code>, and we'll need to make sure that it points to <code class="literal">HDAtlas</code> or <code class="literal">SHDAtlas</code> depending on the device's screen resolution.</p><p>We can<a id="id973" class="indexterm"></a> create <a id="id974" class="indexterm"></a>a test button right now and see how it works by changing the reference manually.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl2sec148"></a>The test button</h3></div></div></div><p>Follow these <a id="id975" class="indexterm"></a>steps to create a button using the button sprite <a id="id976" class="indexterm"></a>through <code class="literal">ScreenAtlas</code>:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Navigate to <span class="strong"><strong>NGUI</strong></span> | <span class="strong"><strong>Open</strong></span> | <span class="strong"><strong>Prefab Toolbar</strong></span>.</p></li><li><p>Drag <span class="strong"><strong>Simple Button</strong></span> inside our <code class="literal">UI Root</code> GameObject in the Hierarchy view:</p><div class="mediaobject"><img src="/graphics/9781783552979/graphics/2979OT_09_11.jpg" /></div></li><li><p>Rename <code class="literal">Control â€“ Simple Button</code> to <code class="literal">Button</code>.</p></li><li><p>Select our new <code class="literal">UI Root</code> | <code class="literal">Button</code> GameObject.</p></li><li><p>Click on its attached <code class="literal">UISprite</code> GameObject's <span class="strong"><strong>Atlas</strong></span> button:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>Select <span class="strong"><strong>ScreenAtlas</strong></span> in the pop-up window</p></li></ul></div></li><li><p>Click on its attached <code class="literal">UISprite</code> GameObject's <span class="strong"><strong>Sprite</strong></span> button:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>Select the <span class="strong"><strong>ButtonSD</strong></span> sprite in the pop-up window</p></li></ul></div></li><li><p>Make sure its <span class="strong"><strong>Transform</strong></span> position is at {<code class="literal">0</code>, <code class="literal">0</code>, <code class="literal">0</code>}.</p></li><li><p>Click on the <span class="strong"><strong>Snap</strong></span> (<span class="strong"><strong>1</strong></span>) button to make it pixel perfect, as follows:</p><div class="mediaobject"><img src="/graphics/9781783552979/graphics/2979OT_09_12.jpg" /></div></li></ol></div><p>Good. You<a id="id977" class="indexterm"></a> should now have our button centered on the screen<a id="id978" class="indexterm"></a> as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781783552979/graphics/2979OT_09_13.jpg" /></div><p>Good! We can now see what happens when the reference atlas points to another one.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch09lvl3sec94"></a>Changing the reference atlas</h4></div></div></div><p>Let's <a id="id979" class="indexterm"></a>change the <code class="literal">ScreenAtlas</code> reference atlas so <a id="id980" class="indexterm"></a>that it points to <code class="literal">HDAtlas</code> instead of <code class="literal">SDAtlas</code>:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>In the <span class="strong"><strong>Project</strong></span> view, go to <code class="literal">Assets/Resources/Atlas</code>.</p></li><li><p>Select the <code class="literal">ScreenAtlas</code> prefab.</p></li><li><p>In the <span class="strong"><strong>Inspector</strong></span> view, click on the <span class="strong"><strong>Atlas</strong></span> button.</p></li><li><p>Click on the <span class="strong"><strong>Show All</strong></span> button at the bottom of the pop-up window.</p></li><li><p>Select <span class="strong"><strong>HDAtlas</strong></span>.</p></li></ol></div><p>Now that <a id="id981" class="indexterm"></a>the reference atlas points to <code class="literal">HDAtlas</code>, our <a id="id982" class="indexterm"></a>button should automatically change to the button's high-definition sprite.</p><p>If you look at your Game view, you'll see that our button has disappeared! Why is that? In <code class="literal">SDAtlas</code>, the button sprite is called <code class="literal">ButtonSD</code>, whereas it is called <code class="literal">ButtonHD</code> in the <code class="literal">HDAtlas</code> sprite.</p><p>The reference atlas is trying to retrieve the <code class="literal">ButtonSD</code> sprite that doesn't exist within <code class="literal">HDAtlas</code>. In order to fix that, we must rename our sprites so that they have the same name throughout all three atlases.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl2sec149"></a>Renaming sprites</h3></div></div></div><p>We have <a id="id983" class="indexterm"></a>added our different files for each atlas. If we<a id="id984" class="indexterm"></a> want the reference atlas to find the sprites within all atlases, we must make sure that they have the same name. Let's do it for our button sprite now:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>In the <span class="strong"><strong>Project</strong></span> view, go to <code class="literal">Assets/Resources/Atlas</code>.</p></li><li><p>Select the <code class="literal">SDAtlas</code> prefab, and look for <span class="strong"><strong>Sprite Details</strong></span> in the <span class="strong"><strong>Inspector</strong></span> panel.</p></li><li><p>Change the sprite's name to <code class="literal">Button</code> (<span class="strong"><strong>1</strong></span>) and hit the <span class="strong"><strong>Rename</strong></span> button (<span class="strong"><strong>2</strong></span>), as follows:</p><div class="mediaobject"><img src="/graphics/9781783552979/graphics/2979OT_09_14.jpg" /></div></li></ol></div><p>Now, let's do the same for the <code class="literal">HDAtlas</code> prefab's <code class="literal">ButtonHD</code> sprite:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>In the <span class="strong"><strong>Project</strong></span> view, go to the <code class="literal">Assets/Resources/Atlas/HDAtlas</code> prefab.</p></li><li><p>Change the sprite's name to <code class="literal">Button</code> and hit the <span class="strong"><strong>Rename</strong></span> button.</p></li></ol></div><p>Finally, we<a id="id985" class="indexterm"></a> can follow the same steps for the <code class="literal">SHDAtlas</code> prefab's <code class="literal">ButtonSHD</code> sprite:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>In the <a id="id986" class="indexterm"></a>
<span class="strong"><strong>Project</strong></span> view, go to <code class="literal">Assets/Resources/Atlas/SHDAtlas</code>.</p></li><li><p>Change the sprite's name to <code class="literal">Button</code> and hit the <span class="strong"><strong>Rename</strong></span> button.</p></li></ol></div><p>Now that our <code class="literal">Button</code> sprite has the same name within all atlases, we can change our button to display it instead of the previous <code class="literal">ButtonSD</code> sprite:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select our <code class="literal">UI Root</code> | <code class="literal">Button</code> GameObject.</p></li><li><p>Click on the <span class="strong"><strong>Sprite</strong></span> button.</p></li><li><p>In the sprite selection pop-up window, double-click on the <span class="strong"><strong>Button</strong></span> sprite.</p></li></ol></div><p>The displayed <code class="literal">Button</code> sprite in the pop-up window was actually the sprite from <code class="literal">HDAtlas</code>, since we have set <code class="literal">ScreenAtlas</code> to point to it instead of <code class="literal">SDAtlas</code>.</p><p>In the game view, we now have the HD button of 442 x 264 pixels, as follows:</p><div class="mediaobject"><img src="/graphics/9781783552979/graphics/2979OT_09_15.jpg" /></div><p>Now, we can test the manual atlas switching to check whether it works:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>In the <span class="strong"><strong>Project</strong></span> view, go to <code class="literal">Assets/Resources/Atlas</code>.</p></li><li><p>Select the <code class="literal">ScreenAtlas</code> prefab.</p></li><li><p>In the <span class="strong"><strong>Inspector</strong></span> view, click on the <span class="strong"><strong>Atlas</strong></span> button.</p></li><li><p>Click on the <span class="strong"><strong>Show All</strong></span> button at the bottom of the pop-up window.</p></li><li><p>Select <span class="strong"><strong>SHDAtlas</strong></span>.</p></li></ol></div><p>Good. If you <a id="id987" class="indexterm"></a>look at the Game view, you'll notice that with the changing of the reference atlas to point to <code class="literal">SHDAtlas</code>, the button sprite has been updated and now displays a 588 x 351 sprite instead of the previous 442 x 264 version:</p><div class="mediaobject"><img src="/graphics/9781783552979/graphics/2979OT_09_16.jpg" /></div><p>This<a id="id988" class="indexterm"></a> means that by simply changing the atlas the <code class="literal">ScreenAtlas</code> points to, we can display different sprites depending on the screen resolution.</p><p>We can now work on a script to automatically switch atlases at runtime.</p></div></div>