<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch01lvl1sec12"></a>Running a sample</h2></div></div><hr /></div><p>Unity ships the ML-Agents package with a number of <span>prepared</span><a id="id325397677" class="indexterm"></a> samples that demonstrate various aspects of learning and training scenarios. Let's open up Unity and load up a sample project and get a feel for how the ML-Agents run by following this exercise:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Open the Unity editor and go to the starting <strong class="userinput"><code>Project</code></strong> dialog. </li></ol></div><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Click the <strong class="userinput"><code>Open</code></strong> button at the top of the dialog and navigate to and select the <code class="literal">ML-Agents/ml-agents/unity-environment</code> folder, as shown in the following screenshot:</li></ol></div><div class="mediaobject"><img src="/graphics/9781789138139/graphics/ff8e57a2-763a-4110-88ba-e2de5cb369cd.png" /></div><p>Loading the unity-environment project into the editor
</p><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>This will load the <code class="literal">unity-environment</code> project into the Unity editor. Depending on the Unity version you are using, you may get a warning that the version needs to be upgraded. As long as you are using a recent version of Unity, you can just click Continue. If you do experience problems, try upgrading or downgrading your version of Unity.</li><li>Locate the <code class="literal">Scene</code> file in the <code class="literal">Assets/ML-Agents/Examples/3DBall</code> folder of the <strong class="userinput"><code>Project</code></strong> window, as shown in the following screenshot:</li></ol></div><div class="mediaobject"><img src="/graphics/9781789138139/graphics/8527df8a-06b1-4bfc-8e2c-15034521a629.png" /></div><p>Locating the example scene file in the 3DBall folder</p><div class="orderedlist"><ol class="orderedlist arabic" start="5" type="1"><li>Double-click the <code class="literal">3DBall</code> scene file to open the scene in the editor.</li><li>Press the Play button at the top center of the editor to run the scene. You will see that the scene starts running and that balls are being dropped, but the balls just fall off the platforms. This is because the scene starts up in <strong class="userinput"><code>Player</code></strong> mode, which means you can control the platforms with keyboard input. Try to balance the balls on the platform using the arrow keys on the keyboard.</li><li>When you are done running the scene, click the Play button again to stop the scene.</li></ol></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec7"></a>Setting the agent Brain</h3></div></div></div><p>As you witnessed, the scene is currently set for <span>Player</span><a id="id325398060" class="indexterm"></a> control, but obviously we want to see how some of this ML-Agents stuff works. In order to do that, we need to change the Brain <span>type</span><a id="id325398069" class="indexterm"></a> the agent is using. Follow along to switch the Brain type in the 3D Ball agent:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Locate the <code class="literal">Ball3DAcademy</code> object in the <strong class="userinput"><code>Hierarchy</code></strong> window and expand it to reveal the <span class="strong"><strong><strong class="userinput"><code>Ball3DBrain </code></strong></strong></span>object.</li><li>Select the <strong class="userinput"><code><span class="strong"><strong>Ball3DBrain</strong></span></code></strong> object and then <span>look</span><a id="id325408538" class="indexterm"></a> to the <strong class="userinput"><code>Inspector</code></strong> window, as shown in the following screenshot:</li></ol></div><div class="mediaobject"><img src="/graphics/9781789138139/graphics/96238e36-08cc-46fc-8130-4b722d525c41.png" /></div><p>Switching the Brain on the Ball3DBrain object</p><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>Switch the Brain component, as shown in the preceding excerpt, to the <strong class="userinput"><code><span class="strong"><strong>Heuristic</strong></span></code></strong> setting. The <strong class="userinput"><code>Heuristic</code></strong> brain setting is for <span class="strong"><strong>ML-Agents</strong></span> that are internally coded within Unity scripts in a heuristic manner. Heuristic programming is nothing more than selecting a simpler quicker solution when a classic, in our case, ML algorithms, may take longer. Writing a Heuristic brain can often help you better define a problem and it is a technique we will use later in this chapter. The majority of current game AIs fall within the category of using Heuristic algorithms. </li></ol></div><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>Press Play to run the scene. Now, you will see the platforms balancing each of the balls – very impressive for a heuristic algorithm. Next, we want to open the script with the heuristic brain and take a look at some of the code.</li></ol></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip9"></a>Note</h3><p>You may need to adjust the Rotation Speed property, up or down, on the <strong class="userinput"><code>Ball 3D Decision (Script)</code></strong>. Try a value of <code class="literal">.5</code> for a rotation speed if the Heuristics brain seems unable to effectively balance the balls. The Rotation Speed is hidden in the preceding screen excerpt.</p></div><div class="orderedlist"><ol class="orderedlist arabic" start="5" type="1"><li>Click the Gear icon <span>beside</span><a id="id324988521" class="indexterm"></a> the <span class="strong"><strong><strong class="userinput"><code>Ball 3D Decision</code></strong></strong></span><strong class="userinput"><code> (Script)</code></strong>, and from the context menu, select <strong class="userinput"><code>Edit Script</code></strong>, as shown in the following screenshot:</li></ol></div><div class="mediaobject"><img src="/graphics/9781789138139/graphics/84f841be-2f3c-45fa-af8a-277fee8dae1f.png" /></div><p>Editing the Ball 3D Decision script</p><div class="orderedlist"><ol class="orderedlist arabic" start="6" type="1"><li>Take a look at the <code class="literal">Decide</code> method in the script as follows:</li></ol></div><pre class="programlisting">      public float[] Decide(
              List&lt;float&gt; vectorObs,
              List&lt;Texture2D&gt; visualObs,
              float reward,
              bool done,
              List&lt;float&gt; memory)
          {
              if 
              (gameObject.GetComponent&lt;Brain()
              .brainParameters.vectorActionSpaceType
                 == SpaceType.continuous)
              {
                  List&lt;float&gt; act = new List&lt;float&gt;();

        // state[5] is the velocity of the ball in the x orientation. 
        // We use this number to control the Platform's z axis rotation 
         speed, 
        // so that the Platform is tilted in the x orientation 
        correspondingly. 
          act.Add(vectorObs[5] * rotationSpeed);

        // state[7] is the velocity of the ball in the z orientation. 
        // We use this number to control the Platform's x axis rotation 
        speed, 
        // so that the Platform is tilted in the z orientation 
        correspondingly. 
          act.Add(-vectorObs[7] * rotationSpeed);

          return act.ToArray();
          }

          // If the vector action space type is discrete, then we don't do 
          anything. 
          return new float[1] { 1f };
          }</pre><div class="orderedlist"><ol class="orderedlist arabic" start="7" type="1"><li>We will cover more details about what the inputs and outputs of this method mean later. For now though, look at how simple the code is. This is the heuristic brain that is balancing the balls on the platform, which is fairly impressive when you see the code. The question that may just hit you is: why are we bothering with ML programming, then? The simple answer is that the 3D ball problem is deceptively simple and can be easily modeled with eight states. Take a look at the code again and you can see that only eight states are used (<code class="literal">0</code> to <code class="literal">7</code>), with each state representing the direction the ball is moving in. As you can see, this works well for this problem but when we get to more complex examples, we may have millions upon billions of states – hardly anything we could easily solve using heuristic methods.</li></ol></div><p><span><span class="strong"><strong>Heuristic</strong></span></span> brains should not be confused with <span class="strong"><strong>Internal</strong></span> brains, which we will get to in <a class="link" href="#" linkend="ch06">Chapter 6</a>, <span class="emphasis"><em>Terrarium Revisited – Building a Multi-Agent Ecosystem</em></span>. While you <span>could</span><a id="id324988637" class="indexterm"></a> replace the <span>heuristic</span><a id="id324988644" class="indexterm"></a> code in the 3D ball example with an ML algorithm, that is not the best practice for running an advanced ML such as <span>Deep</span><a id="id324988651" class="indexterm"></a> Learning algorithms, which we will discover in <a class="link" href="#" linkend="ch03">Chapter 3</a>, <span class="emphasis"><em>Deep Reinforcement Learning with Python</em></span>. </p><p>In the next section, we are going to modify the Basic example in order to get a better feel for how ML-Agents components work together.</p></div></div>