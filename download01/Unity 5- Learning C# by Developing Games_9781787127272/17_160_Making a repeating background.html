<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch17lvl1sec149"></a>Making a repeating background</h2></div></div><hr /></div><p>Of course, we <a id="id645" class="indexterm"></a>could have the background remain static throughout the project, but that would get boring rather quickly and the plane will not appear to actually be moving. Instead, to make the game more visually interesting, let's have the background move to make the player's plane appear to be flying:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>From the <span class="strong"><strong>Project</strong></span> tab, open the <code class="literal">Scripts</code> folder and then select <span class="strong"><strong>Create | C# Script</strong></span>. Name the newly created script <code class="literal">RepeatingBackground</code>.</p></li><li><p>Double-click on the script file to open it up in your IDE of choice and use the following code:</p><div class="informalexample"><pre class="programlisting">using UnityEngine;

public class RepeatingBackground : MonoBehaviour
{

    [Tooltip("How fast should this object move")] 
    public float scrollSpeed;

    /// &lt;summary&gt;
    /// How far to move until the image is offscreen.
    /// &lt;/summary&gt;
    public const float ScrollWidth = 8;  // bg width / 
                                         // pixels per unit

    /// &lt;summary&gt;
    /// Called at a fixed time frame, moves the objects and 
    /// if they are off the screen do the appropriate thing
    /// &lt;/summary&gt;
    private void FixedUpdate()
    {
        // Grab my current position
        Vector3 pos = transform.position;

        // Move the object a certain amount to the left 
        // (negative in the x axis)
        pos.x -= scrollSpeed * Time.deltaTime;

        //Check if object is now fully offscreen
        if (transform.position.x &lt; -ScrollWidth)
        {
            Offscreen(ref pos);
        }

        // If not destroyed, set our new position
        transform.position = pos;
    }

    /// &lt;summary&gt;
    /// Called whenever the object this is attached to goes 
    /// completely off-screen
    /// &lt;/summary&gt;
    /// &lt;param name="pos"&gt;reference to position&lt;/param&gt; 
    protected virtual void Offscreen(ref Vector3 pos)
    {
        // Moves the object to be to off-screen on the
       // right side
        pos.x += 2 * ScrollWidth;
    }
    
}</pre></div></li></ol></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch17lvl2sec94"></a>Repeating background script</h3></div></div></div><p>The <a id="id646" class="indexterm"></a>repeating <code class="literal">background</code> script does a number of different things. First, we have two properties, <code class="literal">scrollSpeed</code>, which is the measure of how fast the background will move, and <code class="literal">ScrollWidth</code>, which is a <code class="literal">const</code> variable. The <code class="literal">const</code> keyword stands for constant, which means that this value cannot change from 8â€” the width of our background sprite.</p><p>We're also using a function named <code class="literal">FixedUpdate</code>, which unlike the regular update is called at a fixed time to keep the movement of our image steady. In this function, we set a helper variable <code class="literal">pos</code> to the object's current positon and then move it in the x axis negatively (to the left), and after we move it, we check whether it's completely off screen. If it is, then we call the <code class="literal">Offscreen</code> function. Afterwards, we set our position to the <code class="literal">pos</code> value.</p><p>The <code class="literal">Offscreen</code> function is something we would like to extend in the future. Instead of being public or private, we are using a new access modifier named <a id="id647" class="indexterm"></a>
<span class="strong"><strong>protected</strong></span>, which means that it acts private, unless it is used by a child class, then it is still accessible. In addition, the function is also <a id="id648" class="indexterm"></a>
<span class="strong"><strong>virtual</strong></span>, which means that we can override it in the future if we'd like to, which we will when we are creating our obstacles.</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Save the script and move back to the Unity editor. Then, select the background object from the <span class="strong"><strong>Hierarchy</strong></span> tab and add the <span class="strong"><strong>RepeatingBackground</strong></span> component to it. From the <span class="strong"><strong>Inspector</strong></span> tab, change the <span class="strong"><strong>Scroll Speed</strong></span> property to <code class="literal">5</code> and then run the game:</p><div class="mediaobject"><img src="/graphics/9781787127272/graphics/B05212_04_04.jpg" /></div><p>You'll see that now the background image will move all the way over to the left and then repeat itself again! This is great, but half the time, there's some other background on our screen. Now we will see how we can easily fix this.</p></li><li><p>Create <a id="id649" class="indexterm"></a>an empty game object, name it<code class="literal"> Background</code>, and set its position to <code class="literal">0,0,0</code>. From there, drag and drop our background object on top of it to make it a child. Then, select the child again and duplicate it (<span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>D</em></span>). Select the duplicate object from the <span class="strong"><strong>Hierarchy</strong></span> tab and then change the <span class="strong"><strong>X</strong></span> position to <code class="literal">8</code>:</p><div class="mediaobject"><img src="/graphics/9781787127272/graphics/B05212_04_05.jpg" /></div><p>This <a id="id650" class="indexterm"></a>sprite on the right-hand side will move the same way as our original and will fill in the space that our left side leaves behind. It'll also be fully on the screen when we move the first image to the right via the <code class="literal">Offscreen</code> function.</p><p>With this, we now have an infinitely repeating background, but we can also reuse this same function in other interesting ways to create a more dynamic feel by adding some elements in front of the background.</p></li><li><p>From the <span class="strong"><strong>Art Assets</strong></span> folder, bring in the <code class="literal">groundGrass</code> sprite and place it into the world at <code class="literal">0, -2, 0</code>.</p></li><li><p>Then, attach a <span class="strong"><strong>RepeatingBackground</strong></span> component to the object with a <span class="strong"><strong>Scroll Speed</strong></span> of <code class="literal">5</code> and change the two background object's <span class="strong"><strong>Scroll Speed</strong></span> down to <code class="literal">2</code>.</p></li><li><p>Make <a id="id651" class="indexterm"></a>the <code class="literal">groundGrass</code> a child of the <code class="literal">Background </code>object as well and then duplicate (<span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>D</em></span>) it with a position to <code class="literal">8,-2,0</code>.</p></li><li><p>Save the scene and play the game!</p></li></ol></div><div class="mediaobject"><img src="/graphics/9781787127272/graphics/B05212_04_06.jpg" /></div><p>And with this, we have a much more realistic world, with objects closer to the camera moving faster than objects far away, in addition to repeating forever!</p></div></div>