<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch15lvl1sec131"></a>Pausing the game</h2></div></div><hr /></div><p>Now that we have started <a id="id557" class="indexterm"></a>on our main menu, let's add some additional GUI functionality to our game, adding in the ability to pause our game and restart it. However, before we do that, let's take a look at some stuff we can do to make our lives easier when it comes to customization:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>We also want to make these buttons have the same appearance as the stuff we've done previously. So I'm going to create a <span class="strong"><strong>Prefab</strong></span> of one of our buttons so we can create them easily in the future. So with that in mind, select our <span class="strong"><strong>Start Game</strong></span> button and duplicate it by pressing <span class="emphasis"><em>Ctrl + D</em></span> and renaming our previous one <span class="strong"><strong>Start Game</strong></span>.</p></li><li><p>We don't want every single button we create to load the gameplay level, so click on the outside part of the <code class="literal">On Click ()</code> property, then click on the <span class="strong"><strong>â€“</strong></span> button to remove it.</p></li><li><p>Next, rename the button <span class="strong"><strong>Base Button</strong></span> and then from the <span class="strong"><strong>Project</strong></span> tab, open up the <code class="literal">Prefabs</code> folder and drag and drop our <span class="strong"><strong>Base Button</strong></span> object into the folder.</p></li><li><p>After the prefab has been created, we can now remove <span class="strong"><strong>Base Button</strong></span> from <span class="strong"><strong>Hierarchy</strong></span>.</p></li><li><p>Now, go to the <span class="strong"><strong>Project</strong></span> tab and select the <span class="strong"><strong>Base Button</strong></span> object and change the <span class="strong"><strong>Anchor</strong></span> preset to middle-center and then change <span class="strong"><strong>Width</strong></span> to <code class="literal">150</code>.</p></li><li><p>Next, go to the <span class="strong"><strong>Scenes</strong></span> folder and open up our <span class="strong"><strong>Gameplay</strong></span> scene, saving <code class="literal">Main_Menu</code> as we go.</p></li><li><p>Go to <span class="strong"><strong>GameObject</strong></span> | <span class="strong"><strong>UI</strong></span> | <span class="strong"><strong>Panel</strong></span>. Panels fill the entire screen, and we don't want that, so let's go ahead and change Anchor Presets to middle-center and change <span class="strong"><strong>Width</strong></span> to <code class="literal">450</code> and <span class="strong"><strong>Height</strong></span> to <code class="literal">150</code>.</p></li><li><p>Like before, we will want to use <span class="strong"><strong>Canvas Scaler</strong></span>, so select the <code class="literal">Canvas </code>object from <span class="strong"><strong>Hierarchy</strong></span> and<a id="id558" class="indexterm"></a> then in <span class="strong"><strong>Inspector</strong></span> from <span class="strong"><strong>Canvas Scaler</strong></span>, change <span class="strong"><strong>Ui Scale Mode</strong></span> to <span class="strong"><strong>Scale with Screen Size</strong></span>. From there, change <span class="strong"><strong>Reference Resolution</strong></span> to <code class="literal">800 x 600</code> if it isn't there already.</p></li><li><p>Next, select the <span class="strong"><strong>Panel</strong></span> object and then add a <span class="strong"><strong>Vertical Layout Group</strong></span> component to it. (By clicking on <span class="strong"><strong>Add Component</strong></span>, you can type in the name of components and hit <span class="emphasis"><em>Enter</em></span> to select them.) From there, change <span class="strong"><strong>Padding</strong></span> to <code class="literal">10</code> in all directions and under <span class="strong"><strong>Spacing</strong></span> put in <code class="literal">10</code>.</p></li><li><p>Then, drag and drop our <span class="strong"><strong>Base Button</strong></span> object on top of the <span class="strong"><strong>Panel</strong></span> name in <span class="strong"><strong>Hierarchy</strong></span> to make it a child of the object. Then, duplicate it twice.</p><div class="mediaobject"><img src="/graphics/9781787127272/graphics/B05212_02_16.jpg" /></div></li><li><p>You'll notice that the buttons have resized themselves to fit the area that the panel had, with the spacing and padding we created taken into consideration.</p></li><li><p>Change the text and name of the three buttons to <span class="strong"><strong>Resume</strong></span>, <span class="strong"><strong>Main Menu</strong></span>, and <span class="strong"><strong>Quit Game</strong></span>.</p></li><li><p>Now, just like before, we<a id="id559" class="indexterm"></a> will need to create the functionality for these items, as well as the way to have the menu appear and disappear properly, so with that in mind, let's go ahead and create an empty game object with a name of <span class="strong"><strong>Pause Menu Behaviour</strong></span> with a <code class="literal">PauseMenuBehaviour</code> script attached to it.</p><p>Use the following code:</p><div class="informalexample"><pre class="programlisting">using UnityEngine;

public class PauseMenuBehaviour : MainMenuBehaviour
{
    public static bool isPaused;
    public GameObject pauseMenu;
    public void Start()
    {
        isPaused = false;
        pauseMenu.SetActive(false);
    }
    public void Update()
    {
        if (Input.GetKeyUp("escape"))
        {
            // If false becomes true and vice-versa
            isPaused = !isPaused;
            // If isPaused is true, 0 otherwise 1
            Time.timeScale = (isPaused) ? 0 : 1;
            pauseMenu.SetActive(isPaused);
        }
    }
    public void ResumeGame()
    {
        isPaused = false;
        pauseMenu.SetActive(false);
        Time.timeScale = 1;
    }
}</pre></div><p>Note that this time <code class="literal">PauseMenuBehaviour</code> inherits <code class="literal">MainMenuBehaviour</code>, which means all of the main menu stuff will be included here as well.</p></li><li><p>Next, save your script and move back into the Unity editor. Once there, set the <span class="strong"><strong>Panel</strong></span> object of our <span class="strong"><strong>Pause Menu</strong></span> to the <code class="literal">pause menu</code> variable. Then, set the <span class="strong"><strong>Resume</strong></span> button's <code class="literal">OnClick</code> to call the <span class="strong"><strong>Pause Menu Behaviour's</strong></span> <code class="literal">Resume</code> function. Then, the <span class="strong"><strong>Main Menu</strong></span> button call <code class="literal">LoadLevel</code> with a parameter of <code class="literal">Main_Menu</code>, and <span class="strong"><strong>Quit Game</strong></span> with <code class="literal">QuitGame</code>.</p></li><li><p>Finally, to make it a little easier for you to see, go ahead and select the <span class="strong"><strong>Panel</strong></span> object, rename it <span class="strong"><strong>Pause Menu</strong></span>, and then click on the checkmark to the left of the name in Inspector to disable it, making it disappear. However, due to <span class="strong"><strong>Pause Menu Behaviour</strong></span>, we <a id="id560" class="indexterm"></a>still have a way to access it.</p></li><li><p>At this point, the game will work correctly, but when you pause the game the player still seems to rotate and can shoot. So, let's fix that real quick. Open up the <span class="strong"><strong>PlayerBehaviour</strong></span> script and modify the <code class="literal">Update</code> function to check if the game is paused before doing anything with the following bolded lines:</p><div class="informalexample"><pre class="programlisting">  // Update is called once per frame
  void Update () 
  {
      if (!PauseMenuBehaviour.isPaused)
      {

          // Rotate player to face mouse
          Rotation();
          // Move the player's body
          Movement();

  // a foreach loop will go through each item inside of 
  // shootButton and do whatever we placed in {}s using the 
  //element variable to hold the item
          foreach (KeyCode element in shootButton)
          {
              if (Input.GetKey(element) &amp;&amp; timeTilNextFire &lt; 0)
              {
                  timeTilNextFire = timeBetweenFires;
                  ShootLaser();
                  break;
              }
          }

          timeTilNextFire -= Time.deltaTime;
      }

  }</pre></div></li><li><p>Save your scene and level and go ahead to play the game!</p><div class="mediaobject"><img src="/graphics/9781787127272/graphics/B05212_02_17.jpg" /></div></li></ol></div><p>Now, we have a fully functional <a id="id561" class="indexterm"></a>pause menu that will allow us to press the <span class="emphasis"><em>Esc</em></span> key and leave what we're doing in the project. We've also made it incredibly easy for us to draw buttons in the style that we created for other sections.</p></div>