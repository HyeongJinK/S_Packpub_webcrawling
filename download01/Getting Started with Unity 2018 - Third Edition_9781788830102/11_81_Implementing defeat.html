<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch11lvl1sec79"></a>Implementing defeat</h2></div></div><hr /></div><p>There are two game conditions in <span>which</span><a id="id288345145" class="indexterm"></a> the player can lose the game. The first condition is if there are no cucumbers left in the game. The second condition is if all three lives are gone. Let's look at each of these defeat conditions separately.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch11lvl2sec99"></a>Scripting defeat based on no cucumbers remaining</h3></div></div></div><p>Our <code class="literal">CucumberManager</code> script already <span>keeps</span><a id="id288601251" class="indexterm"></a> track of the number of cucumbers in the game, so we merely need to give that script's <code class="literal">currentCucumberCount</code> class variable the static modifier and then update our <code class="literal">VictoryManager</code> script. Here are the steps.</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Edit the <code class="literal">CucumberManager</code> script so the <code class="literal">currentCucumberCount</code> variable declaration is as follows:</p></li></ol></div><pre class="programlisting">      public static int currentCucumberCount;</pre><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>In the <code class="literal">Awake()</code> method, change <code class="literal">currentCucumberCount = 0;</code> to <code class="literal">currentCucumberCount = 1;</code>. This will help ensure the game does not think there are no cucumbers when the game starts.</li><li>Add the following statement at the end of the <code class="literal">Update()</code> method, <code class="literal">currentCucumberCount = cucumbers.Length;</code>. This will keep the counter updated in each frame.</li></ol></div><p>Those were the only changes needed for the <code class="literal">CucumberManager</code> script. Next, we will edit the <code class="literal">VictoryManager</code> script:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Edit the <code class="literal">VictoryManager</code> script by adding the int cucumberCount; class variable.
</li></ol></div><p> </p><div class="orderedlist"><ol class="orderedlist arabic" start="2" type="1"><li>Add the following lines of code to the bottom of the <code class="literal">Update()</code> method. These lines will continually check to see whether there are no cucumbers remaining and display the <strong class="userinput"><code>You Lost!</code></strong> text when the count equals zero:</li></ol></div><pre class="programlisting">cucumberCount=CucumberManager.currentCucumberCount;

if(cucumberCount==0){
Victory.text=("YouLost!");
}</pre><p>You are now ready to test this defeat condition. </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip43"></a>Note</h3><p>You can speed up your testing by deleting cucumbers from the <strong class="userinput"><code>Hierarchy</code></strong> panel when in game mode. When you exit game mode, all deleted objects will be restored.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch11lvl2sec100"></a>Scripting defeat for no lives remaining</h3></div></div></div><p>We will use the <code class="literal">CucumberManManager</code> script to <span>keep</span><a id="id288614190" class="indexterm"></a> track of the number of lives the Cucumber Man has remaining. Edit that script and make the following changes:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Add the public static int livesRemaining; class variable. We will use this variable to track the number of remaining lives.</li><li>Add the public Animator anim; class variable. We will use this to play the Cucumber Man's death animation.</li><li>Add the <code class="literal">livesRemaining = 3;</code> statement to the bottom of the<code class="literal">Awake()</code>method.</li></ol></div><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>Add the following <code class="literal">if</code> statement block to the bottom of the <code class="literal">Update()</code> method:</li></ol></div><pre class="programlisting">if(livesRemaining==0){
            anim = GetComponent&amp;lt;Animator&gt; ();
             anim.Play ("CM_Die");
}</pre><p>As you can see in the changes to our <code class="literal">Update()</code> method, we are simply checking the value of <code class="literal">livesRemaining</code> and, when no lives remain, we play the appropriate death animation.</p><p>You can test this defeat condition by following these steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Remove the <code class="literal">static</code> modifier from the <code class="literal">public static int livesRemaining</code> statement</li><li>Put the game in game-mode</li><li>In the <strong class="userinput"><code>Hierarchy</code></strong> panel, click the <code class="literal">CucumberMan</code> GameObject</li><li>In the <strong class="userinput"><code>Inspector</code></strong> panel, scroll to the <strong class="userinput"><code>Cucumber Man Manager (Script)</code></strong> component</li><li>Change the <strong class="userinput"><code>Lives Remaining</code></strong> to <code class="literal">0</code> (zero). See the following screenshot for details:</li></ol></div><div class="mediaobject"><img src="/graphics/9781788830102/graphics/882294fd-8838-440d-887f-07c3cdf8c107.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="6" type="1"><li>When your testing is complete, put the <code class="literal">static</code> modifier back into the statement from step 1</li></ol></div></div></div>