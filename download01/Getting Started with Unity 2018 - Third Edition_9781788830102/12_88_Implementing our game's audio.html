<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch12lvl1sec85"></a>Implementing our game's audio</h2></div></div><hr /></div><p>In this section, we will implement the <span>audio</span><a id="id288345145" class="indexterm"></a> requirements listed in the previous section. We will import, configure, and script our game to complete the implementation. Before we get started, you should open your Unity game project. Alternatively, you can download the<strong class="userinput"><code>Starting-Chapter-12</code></strong> Unity project available from the publisher's companion site.</p><p>We will implement our game's audio in <span>three</span> steps, each handled in subsequent sections:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">Importing audio assets</li><li style="list-style-type: disc">Implementing Cucumber Beetle audio</li><li style="list-style-type: disc">Implementing Cucumber Man audio</li></ul></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch12lvl2sec103"></a>Importing audio assets</h3></div></div></div><p>Our first task is to import the <span>audio</span><a id="id288608710" class="indexterm"></a> assets into our game project. Here are the steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Open the game project.</li><li>In the <strong class="userinput"><code>Project</code></strong> panel, right-click <strong class="userinput"><code>Assets</code></strong> and select <strong class="userinput"><code>Create</code></strong> | <strong class="userinput"><code>Folder</code></strong>.</li><li>Name the new folder <code class="literal">Audio</code>.</li><li>Right-click the <code class="literal">Audio</code> folder and select <strong class="userinput"><code>Import Package</code></strong> | <strong class="userinput"><code>Custom Package</code></strong>.</li><li>Navigate to the <code class="literal">cucumber_man_audio.unitypackage</code> file available from the publisher's site for this book. You should see the following screenshot pop up in your Unity interface:</li></ol></div><div class="mediaobject"><img src="/graphics/9781788830102/graphics/12814725-9533-4349-9adb-fd3239941300.png" /></div><div class="orderedlist"><ol class="orderedlist arabic" start="6" type="1"><li>In the <strong class="userinput"><code>Import Unity Package</code></strong> dialog window, ensure all audio files are selected and click the <strong class="userinput"><code>Import</code></strong> button.</li><li>In the <strong class="userinput"><code>Project</code></strong> panel, select the first audio file. Then, in the <strong class="userinput"><code>Inspector</code></strong> panel, use the interface to play the audio clip. 
</li></ol></div><p> </p><div class="orderedlist"><ol class="orderedlist arabic" start="8" type="1"><li>Repeat step 7 for each of the nine audio clips. This will familiarize you with each sound and ensure they can play on your computer.</li></ol></div><p>Now that we have our audio assets in our game project, let's review how each of them will be used. The following table maps each audio file to the appropriate in-game animation or event:</p><div class="informaltable"><table style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; "><colgroup><col /><col /><col /></colgroup><tbody><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>In-Game animation/Event</strong></span></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>Related GameObject</strong></span></p></td><td style="border-bottom: 0.5pt solid ; "><p><span class="strong"><strong>Audio asset</strong></span></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Jump animation</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Cucumber Man</p></td><td style="border-bottom: 0.5pt solid ; "><p><code class="literal">jump.wav</code></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Throw animation</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Cucumber Man</p></td><td style="border-bottom: 0.5pt solid ; "><p><code class="literal">throw.wav</code></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Die animation</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Cucumber Man</p></td><td style="border-bottom: 0.5pt solid ; "><p><code class="literal">cm_die.wav</code></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Respawn event</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Cucumber Man</p></td><td style="border-bottom: 0.5pt solid ; "><p><code class="literal">respawn.wav</code></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Eat animation</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Cucumber Beetle</p></td><td style="border-bottom: 0.5pt solid ; "><p><code class="literal">eating.wav</code></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Standing Run animation</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Cucumber Beetle</p></td><td style="border-bottom: 0.5pt solid ; "><p><code class="literal">attack.wav</code></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span>Die on Ground animation</span></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Cucumber Beetle</p></td><td style="border-bottom: 0.5pt solid ; "><p><code class="literal">beetle_die.wav</code></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p><span>Die Standing animation</span></p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Cucumber Beetle</p></td><td style="border-bottom: 0.5pt solid ; "><p><code class="literal">beetle_die.wav</code></p></td></tr><tr><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Player Defeat event</p></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; "><p>Cucumber Man</p></td><td style="border-bottom: 0.5pt solid ; "><p><code class="literal">game_over.wav</code></p></td></tr><tr><td style="border-right: 0.5pt solid ; "><p>Player Victory event</p></td><td style="border-right: 0.5pt solid ; "><p>Cucumber Man</p></td><td style=""><p><code class="literal">victory.wav</code></p></td></tr></tbody></table></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch12lvl2sec104"></a>Implementing the Cucumber Beetle audio</h3></div></div></div><p>In this section, we will configure the Cucumber Beetle prefab so that it supports <span>audio</span><a id="id288614306" class="indexterm"></a> when the Cucumber Beetles eat, when they run while standing, and when they die. Here are the steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Select the beetle prefab in the <strong class="userinput"><code>Project</code></strong> panel's <code class="literal">Assets</code> | <code class="literal">Prefabs</code> folder. If you have more than one prefab, be sure to use the one that is used in your game.</li><li>In the <strong class="userinput"><code>Inspector</code></strong> panel, scroll to the bottom and click the <strong class="userinput"><code>Add Component</code></strong> button.</li><li>Select <strong class="userinput"><code>Audio</code></strong> | <strong class="userinput"><code>Audio Source</code></strong>.</li><li>Uncheck the <strong class="userinput"><code>Play On Awake</code></strong> box. </li></ol></div><p>Normally, we would assign an <code class="literal">AudioClip</code> to our <strong class="userinput"><code>Audio Source</code></strong> component. Since our Cucumber Beetles will have more than one audio clip, we will not assign one here. </p><p>Our next step is to edit the <code class="literal">BeetleNPC</code> script. Open that script file and make the following modifications:</p><div class="orderedlist"><ol class="orderedlist arabic" start="5" type="1"><li>Add the following member variables:</li></ol></div><pre class="programlisting">      publicAudioSourceaudioSource;
      publicAudioClipeating;
      publicAudioClipattack;
      publicAudioClipdie;</pre><div class="orderedlist"><ol class="orderedlist arabic" start="6" type="1"><li>Add the following statement to the <code class="literal">Start()</code> method:</li></ol></div><pre class="programlisting">      audioSource=GetComponent&lt;AudioSource&gt;();</pre><div class="orderedlist"><ol class="orderedlist arabic" start="7" type="1"><li>Edit the <code class="literal">OnTriggerEnter()</code> method as shown here. You will see two <code class="literal">audioSource.PlayOneShot()</code> statements, one each for the <code class="literal">eating</code> and <code class="literal">attack</code> audio clips:</li></ol></div><pre class="programlisting">      voidOnTriggerEnter(CollidertheObject){
if(theObject.gameObject.CompareTag("Cucumber")){
cucumberToDestroy=theObject.gameObject;
BeetlePatrol.isEating=true;
animator.Play("EatingonGround");
audioSource.PlayOneShot(eating);
StartCoroutine("DestroyCucumber");
}elseif(theObject.gameObject.CompareTag("Cherry")){
_ptsManager=GameObject.Find
              ("Score_Value").GetComponent&lt;PointsManager&gt;();
PointsManager.currentScore=PointsManager.currentScore+10;
BeetlePatrol.isAttacking=true;
cherryHit=true;
animator.Play("Stand");
audioSource.PlayOneShot(attack);
}
      }</pre><div class="orderedlist"><ol class="orderedlist arabic" start="8" type="1"><li>Edit the <code class="literal">DestroySelfOnGround()</code> method, shown as follows. Here you can see that we added the <code class="literal">audioSource.PlayOneShot(die)</code> statement:</li></ol></div><pre class="programlisting">      IEnumeratorDestroySelfOnGround(){
yieldreturnnewWaitForSecondsRealtime(4);
animator.Play("DieonGround");
audioSource.PlayOneShot(die);
Destroy(this.gameObject,4);
      }</pre><div class="orderedlist"><ol class="orderedlist arabic" start="9" type="1"><li>Edit the <code class="literal">DestroySelfStanding()</code> method as shown in the following code block. Here, you can see we added the <code class="literal">audioSource.PlayOneShot(die)</code> statement:</li></ol></div><pre class="programlisting">      IEnumeratorDestroySelfStanding(){
yieldreturnnewWaitForSecondsRealtime(4);
animator.Play("DieStanding");
audioSource.PlayOneShot(die);
Destroy(this.gameObject,4);
cherryHit=false;
      }</pre><p>Now that the scripting task is complete, we need to assign the designated audio clips to the variables we created:</p><div class="orderedlist"><ol class="orderedlist arabic" start="10" type="1"><li>In the <strong class="userinput"><code>Inspector</code></strong> panel, scroll until you see the <strong class="userinput"><code>Beetle NPC (Script)</code></strong> component.</li><li>Drag the <code class="literal">eating</code> audio clip from the <strong class="userinput"><code>Project</code></strong> panel's <code class="literal">Assets</code> | <code class="literal">Audio</code> folder to the appropriate spot in the <strong class="userinput"><code>Beetle NPC (Script)</code></strong>component.</li><li>Repeat step 11 for the <code class="literal">attack</code> and <code class="literal">beetle_die</code> audio clips. Your <strong class="userinput"><code>Beetle NPC (Script)</code></strong>component should look like the following:</li></ol></div><div class="mediaobject"><img src="/graphics/9781788830102/graphics/ece920e8-756f-4e88-8cb3-1edabd125b1c.png" /></div><p>All that's left is for you to test this new functionality by playing the game.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch12lvl2sec105"></a>Implementing the Cucumber Man audio</h3></div></div></div><p>In this section, we will configure the Cucumber Man prefab so that it supports <span>audio</span><a id="id288604728" class="indexterm"></a> when the Cucumber Beetles eat, when they run while standing, and when they die. Here are the steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Select the Cucumber Man in the <strong class="userinput"><code>Hierarchy</code></strong> panel.</li><li>In the <strong class="userinput"><code>Inspector</code></strong> panel, scroll to the bottom and click the <strong class="userinput"><code>Add Component</code></strong> button.</li><li>Select <strong class="userinput"><code>Audio</code></strong> | <strong class="userinput"><code>Audio Source</code></strong>.</li><li>Uncheck the <strong class="userinput"><code>Play On Awake</code></strong> box.</li></ol></div><p>Normally, we would assign an <code class="literal">AudioClip</code> to our <strong class="userinput"><code>Audio Source</code></strong> component. Since our Cucumber Man will have more than one audio clip, we will not assign one here. </p><p>Our next step is to edit the <code class="literal">BeetleNPC</code> script. Open that script file and make the following modifications:</p><div class="orderedlist"><ol class="orderedlist arabic" start="5" type="1"><li>Add the following member variables:</li></ol></div><pre class="programlisting">      publicAudioSourceaudioSource;
      publicAudioClipdying;
      publicAudioCliprespawning;
      public AudioClip gameOver;</pre><div class="orderedlist"><ol class="orderedlist arabic" start="6" type="1"><li>Create a <code class="literal">Start()</code> method, shown as follows:</li></ol></div><pre class="programlisting">      voidStart(){
audioSource=GetComponent&lt;AudioSource&gt;();
      }</pre><div class="orderedlist"><ol class="orderedlist arabic" start="7" type="1"><li>Edit the <code class="literal">Update()</code> method, as shown here, so that it includes the three <code class="literal">audioSource.PlayOneShot()</code> statements:</li></ol></div><pre class="programlisting">      if(livesRemaining==2){
Destroy(GameObject.Find("Life3"));
anim=GetComponent&lt;Animator&gt;();
anim.Play("CM_Die");
audioSource.PlayOneShot(dying);
StartCoroutine("ReSpawnCucumberMan");
      }
      if(livesRemaining==1){
Destroy(GameObject.Find("Life2"));
anim=GetComponent&lt;Animator&gt;();
anim.Play("CM_Die");
audioSource.PlayOneShot(dying);
StartCoroutine("ReSpawnCucumberMan");
      }
      if(livesRemaining==0){
Destroy(GameObject.Find("Life1"));
anim=GetComponent&lt;Animator&gt;();
anim.Play("CM_Die");
audioSource.PlayOneShot(gameOver);
      }</pre><div class="orderedlist"><ol class="orderedlist arabic" start="8" type="1"><li>Edit the <code class="literal">ReSpawnCucumberMan()</code> method as shown here. You can see that we added the <code class="literal">audioSource.PlayOneShot()</code> statement:</li></ol></div><pre class="programlisting">      IEnumeratorReSpawnCucumberMan(){
intrandomNumber=Random.Range(1,4);
if(randomNumber==1){
yieldreturnnewWaitForSecondsRealtime(4);
this.transform.position=SpawnPad1.transform.position;
}elseif(randomNumber==2){
yieldreturnnewWaitForSecondsRealtime(4);
this.transform.position=SpawnPad2.transform.position;
}else{
yieldreturnnewWaitForSecondsRealtime(4);
this.transform.position=SpawnPad3.transform.position;
}
audioSource.PlayOneShot(respawning);
anim.Play("CM_Idle");
      }</pre><p>Now that our script changes for the <code class="literal">CucumberManManager</code> script file are complete, we need to assign the designated audio clips to the variables we created. Here are the steps:</p><div class="orderedlist"><ol class="orderedlist arabic" start="9" type="1"><li>In the <strong class="userinput"><code>Inspector</code></strong> panel, scroll until you see the <strong class="userinput"><code>Cucumber Man Manager (Script)</code></strong> component.</li><li>Drag the <code class="literal">cm_die</code> audio clip from the <strong class="userinput"><code>Project</code></strong> panel's <code class="literal">Assets</code> | <code class="literal">Audio</code> folder to the appropriate spot in the <strong class="userinput"><code>Cucumber Man Manager</code></strong><strong class="userinput"><code>(Script)</code></strong>component.</li><li>Repeat step 10 for the <code class="literal">respawn</code> and <code class="literal">game_over</code> audio clips. Your <strong class="userinput"><code>Cucumber Man Manager (Script)</code></strong>component should look like this:</li></ol></div><div class="mediaobject"><img src="/graphics/9781788830102/graphics/36fcdaea-4e4d-4f4c-8692-f47ad640810e.png" /></div><p>So far, we have taking care of the dying, respawning, and game over audio clips. Next, we will handle the jumping and throwing audio clips:</p><div class="orderedlist"><ol class="orderedlist arabic" start="12" type="1"><li>Open the <code class="literal">PlayerController</code> script for editing.</li><li>Add the following member variables:</li></ol></div><pre class="programlisting">      publicAudioSourceaudioSource;
      publicAudioClipjumping;
      publicAudioClipthrowing;</pre><div class="orderedlist"><ol class="orderedlist arabic" start="14" type="1"><li>Add the following statement to the <code class="literal">Start()</code> method:</li></ol></div><pre class="programlisting">audioSource=GetComponent&lt;AudioSource&gt;();</pre><div class="orderedlist"><ol class="orderedlist arabic" start="15" type="1"><li>Add the following statement to the beginning of the <code class="literal">Jump()</code> method:</li></ol></div><pre class="programlisting">audioSource.PlayOneShot(jumping);</pre><div class="orderedlist"><ol class="orderedlist arabic" start="16" type="1"><li>Add the following statement to the beginning of the <code class="literal">Throw()</code> method:</li></ol></div><pre class="programlisting">audioSource.PlayOneShot(throwing);</pre><p>Now that our script changes for the <code class="literal">PlayerController</code> script file are complete, we need to assign the designated audio clips to the variables we created. Here are the steps:</p><div class="orderedlist"><ol class="orderedlist arabic" start="17" type="1"><li>In the <strong class="userinput"><code>Inspector</code></strong> panel, scroll until you see the <strong class="userinput"><code>Player Controller (Script)</code></strong> component.</li><li>Drag the <code class="literal">jump</code> audio clip from the <strong class="userinput"><code>Project</code></strong> panel's <code class="literal">Assets</code> | <code class="literal">Audio</code> folder to the appropriate spot in the <strong class="userinput"><code>Player Controller</code></strong><strong class="userinput"><code>(Script)</code></strong>component.</li></ol></div><p> </p><div class="orderedlist"><ol class="orderedlist arabic" start="19" type="1"><li>Drag the <code class="literal">throw</code> audio clip from the Project pane's <code class="literal">Assets</code> | <code class="literal">Audio</code> folder to the appropriate spot in the <strong class="userinput"><code>Player Controller</code></strong><strong class="userinput"><code>(Script)</code></strong>component. Your <strong class="userinput"><code>Player Controller (Script)</code></strong>component should look like the following:</li></ol></div><div class="mediaobject"><img src="/graphics/9781788830102/graphics/2b483013-59c2-4d85-8fe4-8c8f9bcdf5e3.png" /></div><p>The last <span>audio</span><a id="id288605160" class="indexterm"></a> clip for us to implement is the victory clip. We will start by editing the <code class="literal">VictoryManager</code> script. Open that script file and make the following modifications:</p><div class="orderedlist"><ol class="orderedlist arabic" start="20" type="1"><li>Add the following member variables:</li></ol></div><pre class="programlisting">      publicAudioSourceaudioSource;
      publicAudioClipvictory;</pre><div class="orderedlist"><ol class="orderedlist arabic" start="21" type="1"><li>Create a  <code class="literal">Start()</code> method, as shown here:</li></ol></div><pre class="programlisting">      void Start () {
          audioSource = GetComponent&lt;AudioSource&gt; ();
      }</pre><div class="orderedlist"><ol class="orderedlist arabic" start="22" type="1"><li>Edit the <code class="literal">Update()</code> method, shown as follows. You will notice that we only added an audio clip playback for the victory condition, as we've already taken care of the defeat condition:</li></ol></div><pre class="programlisting">      voidUpdate(){
beetleCount=BeetleManager.currentBeetleCount;
if(beetleCount==0){
Victory.text=("Youwon!");
audioSource.PlayOneShot(victory);
}

cucumberCount=CucumberManager.currentCucumberCount;

if(cucumberCount==0){
Victory.text=("YouLost!");
}
      }</pre><p>Now that our script changes for the <code class="literal">VictoryManager</code> script file are completed, we need to assign the victory audio clip to the variable we created. Here are the steps:</p><div class="orderedlist"><ol class="orderedlist arabic" start="23" type="1"><li>In the <strong class="userinput"><code>Hierarchy</code></strong> panel, select <code class="literal">HUD_Canvas</code> | <code class="literal">EndOfGame</code> | <strong class="userinput"><code>Victory</code></strong>.</li><li>In the <strong class="userinput"><code>Inspector</code></strong> panel, scroll until you see the <strong class="userinput"><code>Victory Manager (Script)</code></strong> component.</li><li>Drag the <code class="literal">victory</code> audio clip from the <strong class="userinput"><code>Project</code></strong> panel's <code class="literal">Assets</code> | <code class="literal">Audio</code> folder to the appropriate spot in the <strong class="userinput"><code>Victory Manager</code></strong><strong class="userinput"><code>(Script)</code></strong>component. Your <strong class="userinput"><code>Victory Manager (Script)</code></strong>component should look like the following screenshot:</li></ol></div><div class="mediaobject"><img src="/graphics/9781788830102/graphics/b3f06e52-abfd-406b-8f5f-28535d26f305.png" /></div><p>You are now ready to test this new functionality by playing the game.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip45"></a>Note</h3><p>This is an excellent time to save both your scene and your project. </p></div></div></div>