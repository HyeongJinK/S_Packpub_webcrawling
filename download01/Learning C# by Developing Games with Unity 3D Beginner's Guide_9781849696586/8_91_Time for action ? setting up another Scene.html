<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch08lvl1sec91"></a>Time for action â€“ setting up another Scene</h2></div></div><hr /></div><p>We're going to create a new <span class="strong"><strong>Scene</strong></span> for <code class="literal">BeginState</code>. As a result, we don't want the <code class="literal">StateManager</code> object to be a Component of the <span class="strong"><strong>Main Camera</strong></span> anymore. We'll add <code class="literal">StateManager</code> to <a id="id332" class="indexterm"></a>another GameObject in the new <span class="strong"><strong>Scene</strong></span>. In order to do so, perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Remove the <code class="literal">StateManager</code> Component from the <span class="strong"><strong>Main Camera</strong></span>.</p></li><li><p>Make a new <span class="strong"><strong>Scene</strong></span> by selecting on the menu <span class="strong"><strong>File</strong></span> | <span class="strong"><strong>New Scene</strong></span>.</p></li><li><p>In the menu, navigate to <span class="strong"><strong>GameObject</strong></span> | <span class="strong"><strong>Create Empty</strong></span>.</p></li><li><p>Rename the <span class="strong"><strong>GameObject</strong></span> to <span class="strong"><strong>GameManager</strong></span>.</p></li><li><p>Add the <span class="strong"><strong>StateManager</strong></span> script to the <span class="strong"><strong>GameManager</strong></span>.</p></li><li><p>In the menu, navigate to <span class="strong"><strong>File</strong></span> | <span class="strong"><strong>Save Scene as...</strong></span>.</p></li><li><p>Save the Scene as <code class="literal">BeginningScene</code> in the <code class="literal">Scenes</code> folder.</p></li><li><p>Click on <span class="strong"><strong>Play</strong></span> to verify if the State Machine is working as before.</p></li></ol></div><p>At this point, after clicking on <span class="strong"><strong>Play</strong></span>, you will see the <span class="strong"><strong>Press to Play</strong></span> button and the countdown timer in your Scene.</p><p>Add the <a id="id333" class="indexterm"></a>Scenes to the <span class="strong"><strong>Build Settings</strong></span> as shown in the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>In the menu, navigate to <span class="strong"><strong>File</strong></span> | <span class="strong"><strong>Build Settings...</strong></span>.</p></li><li><p>In the <span class="strong"><strong>Build Settings</strong></span> window, click on the <span class="strong"><strong>Add Current</strong></span> button to add the <code class="literal">BeginningScene</code> to the <span class="strong"><strong>Scenes In Build</strong></span> section.</p></li><li><p>Drag <span class="strong"><strong>Scene1</strong></span> into the <span class="strong"><strong>Scenes In Build</strong></span> section.</p></li><li><p>Close the <span class="strong"><strong>Build Settings</strong></span> window.</p><div class="mediaobject"><img src="/graphics/9781849696586/graphics/6586OT_08_18.jpg" /></div></li><li><p>Edit <code class="literal">BeginState</code> to delete line 17, <code class="literal">timeScale = 0;, and 43, timeScale = 1;</code>.</p></li></ol></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch08lvl2sec128"></a>
<span class="emphasis"><em>What just happened?</em></span>
</h3></div></div></div><p>By using a separate <span class="strong"><strong>Scene</strong></span> while <code class="literal">BeginState</code> is active, there's no longer any reason to pause the game.</p><p>In the upper right corner of <span class="strong"><strong>Build Settings,</strong></span> you can see that <span class="strong"><strong>BeginningScene</strong></span> is index <span class="strong"><strong>0</strong></span> and <span class="strong"><strong>Scene1</strong></span> is index <span class="strong"><strong>1</strong></span>. If you build this project, index <span class="strong"><strong>0</strong></span> will be loaded automatically. It doesn't work<a id="id334" class="indexterm"></a> this way in the Editor. Whatever <span class="strong"><strong>Scene</strong></span> is loaded runs when you click on <span class="strong"><strong>Play</strong></span>.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch08lvl2sec129"></a>Changing Scenes destroys the existing GameObjects</h3></div></div></div><p>We have two<a id="id335" class="indexterm"></a> issues when using more than one <span class="strong"><strong>Scene</strong></span> but both can be easily remedied:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>Every GameObject in the current <span class="strong"><strong>Scene</strong></span> gets destroyed when another <span class="strong"><strong>Scene</strong></span> is loaded.</p><p>When the game starts in <span class="strong"><strong>BeginningScene</strong></span>, the <span class="strong"><strong>GameManager</strong></span> is created with the <code class="literal">StateManager</code> Component and <code class="literal">BeginState</code> being active. When <code class="literal">BeginState</code> switches to <code class="literal">PlayState</code>, <span class="strong"><strong>Scene1</strong></span> will be loaded and our <span class="strong"><strong>GameManager</strong></span> will be destroyed.</p></li><li style="list-style-type: disc"><p>Every time <span class="strong"><strong>BeginningScene</strong></span> is reloaded, another <span class="strong"><strong>GameManager</strong></span> with another <code class="literal">StateManager</code> Component is created.</p><p>That simply isn't going to work very well. Throughout the game there needs to be only one <span class="strong"><strong>GameManager</strong></span> with one <code class="literal">StateManager</code>.</p></li></ul></div><p>We want the first <span class="strong"><strong>GameManager</strong></span> with its <code class="literal">StateManager</code> Component to always be available. After all, it's the controller for the whole project. To prevent <span class="strong"><strong>GameManager</strong></span> from being destroyed when switching from <span class="strong"><strong>BeginningScene</strong></span> to <span class="strong"><strong>Scene1</strong></span>, Unity provides a method called <code class="literal">DontDestroyOnLoad()</code>.</p><p>We will add this in a moment, but the second issue has to be dealt with at the same time.</p><p>In our State Machine, we have <code class="literal">LostState</code> switching back to <code class="literal">BeginState</code>. The issue is that when <span class="strong"><strong>BeginningScene</strong></span> is reloaded, another <span class="strong"><strong>GameManager</strong></span> GameObject will be created. We don't want another one. We just want the first one we created when we first clicked on <span class="strong"><strong>Play</strong></span>.</p><p>This is easily remedied as well by detecting that our first <span class="strong"><strong>GameManager</strong></span> already exist and immediately destroying any new ones that are created.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch08lvl3sec06"></a>Keeping GameManager between scenes</h4></div></div></div><p>Both of these<a id="id336" class="indexterm"></a> issues will be fixed in Unity's <code class="literal">Awake()</code> method. This method is called on any Component that invokes <code class="literal">Awake()</code>, right after a Scene is loaded.</p></div></div></div>