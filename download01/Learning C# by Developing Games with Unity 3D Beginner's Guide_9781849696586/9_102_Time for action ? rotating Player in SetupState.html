<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch09lvl1sec101"></a>Time for action â€“ rotating Player in SetupState</h2></div></div><hr /></div><p>There will be a setting in the <span class="strong"><strong>Inspector</strong></span> panel to set the rotating speed. Why is <span class="strong"><strong>Player</strong></span> rotating in <code class="literal">SetupState</code>? It allows <a id="id395" class="indexterm"></a>you to view  the changes made to <span class="strong"><strong>Player</strong></span>. It's also a nice visual effect, much better than just looking at a static screen.</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Create a script containing the code shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781849696586/graphics/6586OT_09_09.jpg" /></div></li><li><p>Create a <span class="strong"><strong>C# Script</strong></span> and name it <code class="literal">PlayerControl</code>.</p></li><li><p>Open it in MonoDevelop.</p></li><li><p>Add the<a id="id396" class="indexterm"></a> <code class="literal">setupSpinSpeed</code> variable as shown on line 6 of the preceding screenshot.</p></li><li><p>Modify <code class="literal">Update()</code> as shown on line 13 of the preceding screenshot.</p></li><li><p>Save the file.</p></li><li><p>Attach this script to the <span class="strong"><strong>Player</strong></span> GameObject.</p></li></ol></div><p>To control the rotation of <span class="strong"><strong>Player</strong></span>, we need to add the code (shown in the following screenshot) to <code class="literal">SetupState</code>.</p><div class="mediaobject"><img src="/graphics/9781849696586/graphics/6586OT_09_10.jpg" /></div><p>The <code class="literal">SetupState</code> class needs to have two pieces of information to be able to control <span class="strong"><strong>Player</strong></span>.</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>It needs to know about the <span class="strong"><strong>Player </strong></span>GameObject</p></li><li style="list-style-type: disc"><p>It needs to know about the <code class="literal">PlayerControl</code> Component script attached to <span class="strong"><strong>Player</strong></span>
</p></li></ul></div><p>Therefore we need two variables<a id="id397" class="indexterm"></a> to store this information in <code class="literal">SetupState</code>. Then it's just a matter of using Dot Syntax to control the <span class="strong"><strong>Player</strong></span>.</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Add a variable named <code class="literal">player</code> as shown on line 10.</p></li><li><p>Add a variable named <code class="literal">controller</code> as shown on line 11.</p></li><li><p>In the <code class="literal">SetupState()</code> constructor method, add lines 19 and 20.</p></li><li><p>In the <code class="literal">StateUpdate()</code> method, add lines 25 and 26.</p></li></ol></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl2sec146"></a>
<span class="emphasis"><em>What just happened?</em></span>
</h3></div></div></div><p>Let us analyze the code shown in the preceding screenshot:</p><p>In <code class="literal">PlayerControl</code>:</p><p>Line 6: <code class="literal">public float setupSpinSpeed = 50.0f;</code>
</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>This variable is <code class="literal">public</code> so it will appear in the <span class="strong"><strong>Inspector</strong></span>
</p></li><li style="list-style-type: disc"><p>It is set for a rotation speed of 50 degrees per second. Why?Just seems to be a nice speed visually</p></li></ul></div><p>Line 13: <code class="literal">public void PlayerUpdate ()</code>
</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>This method needs to be <code class="literal">public</code> because it will be called from a State's <code class="literal">StateUpdate()</code> method</p></li><li style="list-style-type: disc"><p>Since the State Machine is controlling what code is invoked and when, <code class="literal">PlayerControl</code> won't be <a id="id398" class="indexterm"></a>using the usual <code class="literal">Update()</code> method</p></li></ul></div><p>In <code class="literal">SetupState</code>:</p><p>Line 10: <code class="literal">private GameObject player;</code>
</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>The variable <code class="literal">player</code> is going to store a reference to the <span class="strong"><strong>Player</strong></span> GameObject</p></li><li style="list-style-type: disc"><p>It's <code class="literal">private</code> because only <code class="literal">SetupState</code> needs to see this variable</p></li></ul></div><p>Line 11: <code class="literal">private PlayerControl controller;</code>
</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>The variable <code class="literal">controller</code> is going to store a reference to the <code class="literal">PlayerControl</code> Component object that's attached to <span class="strong"><strong>Player</strong></span>
</p></li></ul></div><p>Line 19: <code class="literal">player = GameObject.Find("Player");</code>
</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>
<code class="literal">GameObject.Find()</code> is the method used to find the <span class="strong"><strong>Player</strong></span> GameObject</p></li><li style="list-style-type: disc"><p>When it finds the <span class="strong"><strong>Player</strong></span> GameObject in the memory, a reference to it is stored in the <code class="literal">player</code> variable</p></li></ul></div><p>Line 20: <code class="literal">controller = player.GetComponent&lt;PlayerControl&gt;();</code>
</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>The <code class="literal">GetComponent()</code> method gets the <code class="literal">PlayerControl</code> script Component that's attached to <span class="strong"><strong>Player</strong></span> and stores a reference of <code class="literal">PlayerControl</code> in the <code class="literal">controller</code> variable</p></li><li style="list-style-type: disc"><p>We now have access to any <code class="literal">public</code> variables and methods in the <code class="literal">PlayerControl</code> script</p></li></ul></div><p>Line 26: <code class="literal">controller.transform.Rotate(0, controller.setupSpinSpeed * Time.deltaTime, 0);</code>
</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>The <code class="literal">Rotate()</code> method<a id="id399" class="indexterm"></a> causes the <span class="strong"><strong>Player</strong></span> GameObject to spin</p></li><li style="list-style-type: disc"><p>
<code class="literal">Rotate()</code> is a method available in the <code class="literal">Transform</code> class and it takes a <code class="literal">Vector3</code> parameter</p></li><li style="list-style-type: disc"><p>This means it needs to know the number of degrees of rotation for each axis: <code class="literal">x</code>, <code class="literal">y</code>, and <code class="literal">z</code>
</p></li><li style="list-style-type: disc"><p>
<code class="literal">transform</code> is a variable that stores a reference to the <code class="literal">PlayerControl</code> Transform Component object in memory</p></li><li style="list-style-type: disc"><p>The <code class="literal">x</code> and <code class="literal">z</code> axes are <code class="literal">0</code> because we only want <span class="strong"><strong>Player</strong></span> to spin around the vertical <span class="strong"><strong>y</strong></span> axis</p></li><li style="list-style-type: disc"><p>The <code class="literal">controller.setupSpinSpeed</code> statement retrieves the value stored, <code class="literal">50.0</code>, in the <code class="literal">setupSpinSpeed</code> variable of the <code class="literal">PlayerControl</code> script</p></li><li style="list-style-type: disc"><p>This is multiplied by <code class="literal">Time.deltaTime</code> to give a rotation speed of <code class="literal">50</code> degrees per second</p></li></ul></div><p>Line 25: <code class="literal">if(!Input.GetButton("Jump"))</code>
</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>This <code class="literal">if</code> statement checks to see if the Space bar is not being pressed</p></li><li style="list-style-type: disc"><p>Notice the <span class="strong"><strong>NOT</strong></span> operator being used (exclamation point)</p></li><li style="list-style-type: disc"><p>When the Space bar is not being pressed, line 26 is executed</p></li><li style="list-style-type: disc"><p>Open the <span class="strong"><strong>InputManager</strong></span> from the menu by selecting <span class="strong"><strong>Edit</strong></span> | <span class="strong"><strong>Project Settings</strong></span> | <span class="strong"><strong>Input</strong></span>
</p></li><li style="list-style-type: disc"><p>Expand <code class="literal">Jump</code> and you will see that <code class="literal">Jump</code> is mapped to the Space bar</p></li></ul></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl2sec147"></a>Adding the Player Color option</h3></div></div></div><p>While <span class="strong"><strong>Player</strong></span> is spinning, <a id="id400" class="indexterm"></a>we are going to create some buttons to change its color. For my <span class="strong"><strong>Player</strong></span>, this will change the body color. If you're using a <span class="strong"><strong>Cube</strong></span> as a <span class="strong"><strong>Player </strong></span>GameObject, the whole Cube will change color.</p></div></div>