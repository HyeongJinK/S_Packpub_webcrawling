<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch07lvl1sec53"></a>Reflection probes</h2></div></div><hr /></div><p>Reflections are very<a id="id457" class="indexterm"></a> important to create believable environments where objects feel connected to each other. Reflection probes work in a similar way as light probes in a sense that they sample the surrounding environment and send this information to the affected objects to reflect.</p><div class="mediaobject"><img src="/graphics/9781785282843/graphics/B04214_07_32.jpg" /></div><p>Unlike light probes, reflection probes are useful for both static and dynamic objects.</p><p>Whenever you place a reflection probe in the scene, it samples the environment around itself and creates a cubemap that is later used by the objects that are using it. In order to find out information about which reflection probe is affecting any particular GameObject, we need to look at the <span class="strong"><strong>Mesh Renderer</strong></span> component once again.</p><div class="mediaobject"><img src="/graphics/9781785282843/graphics/B04214_07_33.jpg" /></div><p>The <span class="strong"><strong>Reflection Probes</strong></span> <a id="id458" class="indexterm"></a>parameter determines how this GameObject will work with reflection probes, there are four options available:</p><p>
<span class="strong"><strong>Off</strong></span>: Choosing this option will cause reflection probes to stop affecting this object.</p><p>
<span class="strong"><strong>Simple</strong></span>: GameObject can only be affected by a single reflection probe.</p><p>
<span class="strong"><strong>Blend Probes</strong></span>: This allows the object to be affected by multiple reflection probes.</p><p>
<span class="strong"><strong>Blend Probes and Skybox</strong></span>: This works just like the previous one but also includes the skybox in the blending.</p><p>Every reflection probe has a bounding box, everything that is within this box will be included in the sampling and will have a probe assigned to it (you can see the list of assigned probes at the bottom of the <span class="strong"><strong>Mesh Renderer</strong></span> component). Sometimes reflection probe boxes can overlap; in this case, the objects located at the overlapping area that have either <span class="strong"><strong>Blend Probes</strong></span> or <span class="strong"><strong>Blend Probes and Skybox</strong></span> selected for the <span class="strong"><strong>Reflection Probes</strong></span> parameter will receive reflection from multiple reflection probes. The Reflection probe that covers the greater area of an object will have greater blending weight (this concept is similar to the animation blending we've talked about in the previous chapter).</p><p>If you want objects that are outside of the bounding box to be affected by the reflection probe, simply assign a <span class="strong"><strong>Transform</strong></span> component reference to the <span class="strong"><strong>Anchor Override</strong></span> parameter. This will take the information about the reflection probes affecting the referenced object and assign the same values to the object outside of the bounding box (this also includes the blending information).</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec83"></a>Reflection probe settings</h3></div></div></div><p>Reflection probes<a id="id459" class="indexterm"></a> can be created by navigating to <span class="strong"><strong>GameObject</strong></span> | <span class="strong"><strong>Light</strong></span> | <span class="strong"><strong>Reflection Probe</strong></span> in the top menu.</p><p>There are quite a few parameters available that are worth mentioning.</p><div class="mediaobject"><img src="/graphics/9781785282843/graphics/B04214_07_34.jpg" /></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch07lvl3sec29"></a>Types of reflection probes</h4></div></div></div><p>Just as with lights and <a id="id460" class="indexterm"></a>shadows, we can choose to update reflection probes at realtime, bake them or control them via code by assigning custom cubemaps. The <span class="strong"><strong>Type</strong></span> parameter allows us to choose between three options: <span class="strong"><strong>Realtime</strong></span>, <span class="strong"><strong>Baked</strong></span>, and <span class="strong"><strong>Custom</strong></span>.</p><p>Unlike lights, there is a much greater difference in performance between <span class="strong"><strong>Realtime</strong></span> and <span class="strong"><strong>Baked</strong></span> reflection probes. Choosing the <span class="strong"><strong>Realtime</strong></span> option will expose <span class="strong"><strong>Refresh Mode</strong></span> and <span class="strong"><strong>Time Slicing</strong></span> parameters that will allow us to have a better control, by specifying how often the update should happen and how cube map should be updated; however, let's focus on the difference between the two and why you need to choose.</p><p>Take a look at the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781785282843/graphics/B04214_07_35.jpg" /></div><p>You can clearly see that the sphere in the middle is properly reflecting the cube on the left; however, it ignores the one on the right. Why is this happening? The cube on the left, the one that's being reflected is a static object. The cube on the right is a dynamic object. With our <span class="strong"><strong>Baked</strong></span> type reflection probe, we can't update the reflection at runtime; therefore, dynamic objects that can go in and out of the reflection range are ignored by the reflection probe when it samples the environment. In order to have both cubes properly reflected, we need to change <span class="strong"><strong>Type</strong></span> to <span class="strong"><strong>Realtime</strong></span> and set the exposed <span class="strong"><strong>Reflection Mode</strong></span> parameter to <span class="strong"><strong>Every Frame</strong></span>.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch07lvl3sec30"></a>Runtime settings</h4></div></div></div><p>These settings are affecting the<a id="id461" class="indexterm"></a> objects that are using the cubemap of this particular probe:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>
<span class="strong"><strong>Importance</strong></span>: This parameter helps <span class="strong"><strong>Mesh Renderer</strong></span> to choose which reflection probe to use whenever it has an option. Let's say we have reflection probe A with a gigantic bounding box and a reflection probe B with a smaller area located within the bounds of the previous one. If the <span class="strong"><strong>Importance</strong></span> parameters of both reflection probes are equal, they will be blended based on the percent of the affected area; however, if probe B has a higher <span class="strong"><strong>Importance</strong></span> value, it will completely overwrite the effect of the probe A.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Intensity</strong></span>: This parameter controls how powerful the reflection is.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Box Projection</strong></span>: By default, reflection is treated as if it's coming from far away. <span class="strong"><strong>Box Projection</strong></span>, mostly utilized in enclosed places, allows the addition of proper depth to the reflection.</p></li></ul></div><p>
<span class="strong"><strong>Size</strong></span> and <span class="strong"><strong>Probe Origin</strong></span> control the bounding box of the probe. <span class="strong"><strong>Probe Origin</strong></span> is in relation to the probe's transform (works similar to the <span class="strong"><strong>Center</strong></span> parameter of the <span class="strong"><strong>Box Collider</strong></span> component).</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch07lvl3sec31"></a>Cubemap capture settings</h4></div></div></div><p>There are a few<a id="id462" class="indexterm"></a> parameters worth mentioning:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>
<span class="strong"><strong>Resolution</strong></span>: This sets the resolution for the cubemap</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Shadow Distance</strong></span>: This is a distance in Unity units at which the reflection probe will pick up shadows</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Culling Mask</strong></span>: This allows you to include and exclude objects from being included in the cubemap reflection by putting them on separate layers and checking/unchecking them in the <span class="strong"><strong>Culling Mask</strong></span> list</p></li></ul></div></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec84"></a>Positioning of a reflection probe</h3></div></div></div><p>One of the greatest limitations <a id="id463" class="indexterm"></a>of the reflection probes is that they apply the reflection on to the objects not from the location of each individual object, but from the reflection samples of each probe's location.</p><p>If you are desperate for realistic reflections, you can opt to add reflection probes as components to each individual object by navigating to <span class="strong"><strong>Add Component</strong></span> | <span class="strong"><strong>Rendering</strong></span> | <span class="strong"><strong>Reflection Probe</strong></span>. Just make sure that the bounding boxes of the probes don't include other probes.</p><div class="mediaobject"><img src="/graphics/9781785282843/graphics/B04214_07_36.jpg" /></div><p>Needless to say that<a id="id464" class="indexterm"></a> adding a reflection probe as a component to every GameObject in the level might cause performance issues; therefore, it is recommended that you make the best use of reflection probes by covering an area as big as possible and adding new ones in places where the difference will be noticeable (such as caves or next to important objects that stand out visually).</p></div></div>