<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch10lvl1sec67"></a>Rigidbodies</h2></div></div><hr /></div><p>It is about time <a id="id562" class="indexterm"></a>we finalize our character and make him move around, taking landscape into consideration. For that, we need to rely on physics and, more specifically, a component that will enable our GameObject to follow physical laws—rigidbody.</p><p>Right now, the character that we've imported and set up animations for in <a class="link" href="#" linkend="ch05">Chapter 5</a>, <span class="emphasis"><em>Invite Your Characters to Unity</em></span> and <a class="link" href="#" linkend="ch06">Chapter 6</a>, <span class="emphasis"><em>Using Mecanim for Advanced Animations</em></span> is completely ignoring the environmental obstacles around itself and walks through walls like a ghost. To demonstrate how rigidbodies work, we will eliminate this issue by allowing our character to behave naturally and react to the environment properly. We will do this in four steps, and I would strongly recommend you to test the character in <span class="strong"><strong>Play</strong></span> mode after each step to see <a id="id563" class="indexterm"></a>the difference for yourself:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Attach the <span class="strong"><strong>Rigidbody</strong></span> component to the <span class="strong"><strong>Robot</strong></span> GameObject in the <span class="strong"><strong>Scene</strong></span> window (<span class="strong"><strong>Add Component</strong></span> | <span class="strong"><strong>Physics</strong></span> | <span class="strong"><strong>Rigidbody</strong></span>). This will allow gravity to influence our character model.</p></li><li><p>Check the <span class="strong"><strong>Bake into pose</strong></span> parameters under <span class="strong"><strong>Root Transform Position (Y)</strong></span> for all animation clips used for character animations. This will make sure that animations aren't controlling the <span class="emphasis"><em>Y</em></span> transform for the character and allow it to go up and down via physics.</p></li><li><p>Add the <span class="strong"><strong>Capsule</strong></span> collider to the <span class="strong"><strong>Robot</strong></span> GameObject. This will prevent our character from falling under the ground. Make sure to configure it properly to match the robot's silhouette as close as possible, this will be important when it will start to calculate the collision.</p></li><li><p>Check all three boxes of the <span class="strong"><strong>Freeze Rotation</strong></span> parameter (<span class="emphasis"><em>X</em></span>, <span class="emphasis"><em>Y</em></span>, <span class="emphasis"><em>Z</em></span>). Doing this will prevent the character from falling down when moving. All robot rotations at this point will be controlled by the animations and scripts.</p><div class="mediaobject"><img src="/graphics/9781785282843/graphics/B04214_10_01.jpg" /></div></li></ol></div><p>Testing the robot in <a id="id564" class="indexterm"></a>
<span class="strong"><strong>Play</strong></span> mode should have revealed that, upon adding the <span class="strong"><strong>Rigidbody</strong></span> component, the behavior of our character didn't change. Normally, that is not the case. Any object that has rigidbody added to it starts to get affected by gravity and falls to the ground. However, since our character is playing animations, they overwrite the gravity effect, thus keeping the robot floating.</p><p>When animations are baked into the pose, they are not affecting the objects transform and, therefore, allow gravity to have its way with a robot, causing it to fall.</p><p>Being affected by physics is good, but falling through the ground isn't. Why is this happening, and why isn't rigidbody doing anything to prevent it? The issue here is that rigidbody doesn't know that the robot is colliding with another object. In <a class="link" href="#" linkend="ch02">Chapter 2</a>, <span class="emphasis"><em>Importing and Configuring Props</em></span>, we talked about colliders and that they exist mainly to register when colliders intersect each other. Rigidbody reads this information and communicates to the GameObject how to react when an intersection occurs; in this case, it causes them to collide.</p><p>The parameters of<a id="id565" class="indexterm"></a> rigidbody are explained in the following:</p><div class="mediaobject"><img src="/graphics/9781785282843/graphics/B04214_10_02.jpg" /></div><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>
<span class="strong"><strong>Mass</strong></span>: This determines the mass of an object to help evaluate its physical attributes.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Drag and Angular Drag</strong></span>: This drags coefficients of a rigidbody. <code class="literal">0</code> causes it to have no damping.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Use Gravity</strong></span>: This causes the GameObject to be affected by gravity. Gravity force can be configured by going to <span class="strong"><strong>Edit</strong></span> | <span class="strong"><strong>Project Settings</strong></span> | <span class="strong"><strong>Physics</strong></span>.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Is Kinematic</strong></span>: Checking this box will stop GameObject from being driven by the physics engine. It might sound like it defeats the purpose of having rigidbody attached in the first place. In reality it does not; there are at least three reasons to do so:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>Enable collision when we are moving a GameObject with transform (via code).</p></li><li style="list-style-type: disc"><p>Rigidbody component is rather expensive; making it kinematic will make it significantly cheaper.</p></li><li style="list-style-type: disc"><p>Rigidbodies are detectable by triggers. This requires some explanation.</p><div class="mediaobject"><img src="/graphics/9781785282843/graphics/B04214_10_03.jpg" /></div><p>Triggers are colliders with the enabled <span class="strong"><strong>Is Trigger</strong></span> parameter, which turns them into areas that can detect when GameObjects enter it, and stay there, or leave it. Triggers are invaluable for level design as they are literally used to trigger most of the code in the level. There is one condition, though, in order to be detectable by the trigger area, the GameObject must have a rigidbody attached to it.</p></li></ul></div></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Interpolate</strong></span>: This<a id="id566" class="indexterm"></a> is used to smooth out the transform in case there is jerkiness in rigidbody movement.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Collision</strong></span> <span class="strong"><strong>Detection</strong></span>: To put it simply, this is a way to enhance collision detection for selected objects. This is very useful when you are dealing with fast moving objects, such as bullets, that we need to occasionally go through without being detected.</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Constraints</strong></span>: Checking these boxes will prevent GameObject translation or rotation along specific axes. Going back to our robot: when we've attached a capsule collide to it, a physics engine sees just that, a capsule. A capsule is a very unstable object and might simply roll away when it collides with something. This is not what we wish to see in the case of a robot, which is exactly why we put constrain on those axes – to prevent that from happening to our robot and keep it standing straight at all times.</p></li></ul></div><p>That will finalize our character; it's now capable to follow the landscape properly and even step over small obstacles.</p></div>