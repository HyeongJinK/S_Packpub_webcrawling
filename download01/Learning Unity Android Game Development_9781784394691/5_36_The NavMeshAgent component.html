<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch05lvl1sec39"></a>The NavMeshAgent component</h2></div></div><hr /></div><p>You might be thinking that it is all <a id="id311" class="indexterm"></a>well and good that we have a NavMesh, but there are no characters to navigate it. In this section, we will start the creation of our enemy tank. We will need to import and do a little setup for this second tank before<a id="id312" class="indexterm"></a> we can do any AI type of programming. Using these steps, we can create it:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select <code class="literal">Tanks_Type03.png</code> and <code class="literal">Tanks_Type03.blend</code> from the starting assets for the chapter and import them to the <code class="literal">Tanks</code> folder under the <code class="literal">Models</code> folder.</p></li><li><p>Once Unity has finished importing, select the new tank in the <span class="strong"><strong>Project</strong></span> window and take a look at it in the <span class="strong"><strong>Inspector</strong></span> window.</p></li><li><p>This tank has no animations, so the <span class="strong"><strong>Animation Type</strong></span> can be set to <span class="strong"><strong>None</strong></span> and <span class="strong"><strong>Import Animation</strong></span> can be unchecked from the <span class="strong"><strong>Rig</strong></span> and <span class="strong"><strong>Animations</strong></span> pages respectively.</p></li><li><p>Drag the tank from the <span class="strong"><strong>Project</strong></span> window to the <span class="strong"><strong>Scene</strong></span> window; any clear patch of street will work just fine.</p></li><li><p>For starters, rename the model in the <span class="strong"><strong>Scene</strong></span> view to <code class="literal">EnemyTank</code>.</p></li><li><p>Now, we need to change the parenting of the tank so that the turret can turn and the cannon will follow, just as we did for the player's tank. To do this, create an empty <span class="strong"><strong>GameObject</strong></span> and rename it as <code class="literal">TurretPivot</code>.</p></li><li><p>Position <code class="literal">TurretPivot</code> to be at the base of the turret.</p></li><li><p>In the <span class="strong"><strong>Hierarchy</strong></span> window, drag and drop <code class="literal">TurretPivot</code> onto <code class="literal">EnemyTank</code> to make <code class="literal">EnemyTank</code> its parent.</p></li><li><p>Next, make another empty <span class="strong"><strong>GameObject</strong></span> and rename it as <code class="literal">CannonPivot</code>.</p></li><li><p>The<code class="literal"> CannonPivot</code> GameObject must be made a child of <code class="literal">TurretPivot</code>.</p></li><li><p>In the <span class="strong"><strong>Hierarchy</strong></span> window, make the turret mesh a child of <code class="literal">TurretPivot</code> and the cannon mesh a child of <code class="literal">CannonPivot</code>. When Unity asks whether you are sure that you want to break the prefab connections, be sure to click on <span class="strong"><strong>Yes</strong></span>.</p></li><li><p>The tank is a little large, so adjust the <span class="strong"><strong>Scale Factor</strong></span> of the tank's <span class="strong"><strong>Import Settings</strong></span> in the <span class="strong"><strong>Inspector</strong></span> window to <code class="literal">0.6</code> to give us a tank that is similar to the size of the player's tank.</p></li><li><p>In order for the tank to navigate our new NavMesh, we need to add a <span class="strong"><strong>NavMeshAgent</strong></span> component. First, select <code class="literal">EnemyTank</code> in the <span class="strong"><strong>Hierarchy</strong></span> window, go to Unity's toolbar and navigate to <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>Navigation</strong></span> | <span class="strong"><strong>Nav Mesh Agent</strong></span>. In the <span class="strong"><strong>Inspector</strong></span> window, we can see the new component and the settings associated with it, as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781784394691/graphics/4691OT_05_04.jpg" /></div><p>All of these<a id="id313" class="indexterm"></a> settings let us control how the NavMeshAgent interacts with our game world. Let's take a look at what each of them does:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p><span class="strong"><strong>Radius</strong></span>: This is simply how big the agent is. By working in conjunction with the value of <span class="strong"><strong>Radius</strong></span> that we set in the <span class="strong"><strong>Navigation</strong></span> window, this keeps the object from walking partly in the walls and into other agents.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Height</strong></span>: This setting affects the cylinder that appears in the editor, around the agent. It simply sets the height of the character and affects what overhangs they might be able to walk under.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Base Offset</strong></span>: This is the vertical offset of the colliders that is attached to the agent. It allows you to adjust what the <span class="strong"><strong>NavMeshAgent</strong></span> component considers to be the bottom of your character.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Speed</strong></span>: The <span class="strong"><strong>NavMeshAgent</strong></span> component automatically moves the connected object when it has a path. This value dictates how fast to follow the path in units per second.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Angular Speed</strong></span>: This is the degrees per second that the agent can turn. A person would have a very high angular speed, while a car's angular speed would be low.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Acceleration</strong></span>: This is how many units per second in speed that the agent gains until it reaches its maximum capacity.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Stopping Distance</strong></span>: This is the distance from the target destination at which the agent will start to slow down and stop.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Auto Braking</strong></span>: With <a id="id314" class="indexterm"></a>this box checked, the agent will stop as soon as it reaches the destination, rather than overshooting because of the irregular frame rate that tends to average to around 60 to 90 FPS for most games.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Obstacle Avoidance Quality / Priority</strong></span>: The quality is how much effort the agent will put in to find a smooth path around obstacles. A higher quality means more effort is made to find the path. The <span class="strong"><strong>Priority</strong></span> option dictates who has the right of way. An agent with a high value will go around an agent with a low value.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Auto Traverse Off Mesh Link</strong></span>: With this box checked, the agent will use the off-mesh links when pathfinding, such as jumping gaps and falling off ledges.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Auto Repath</strong></span>: If the path that was found is incomplete for any reason, this checkbox allows Unity to automatically try to find a new one.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Area Mask</strong></span>: Remember the areas that were mentioned earlier when discussing the <span class="strong"><strong>Navigation</strong></span> window? This is where we can set which areas the agent is able to traverse. Only the areas in this list that are checked will be used for pathfinding by the agent.</p></li></ul></div></li><li><p>Now that we understand the settings, let's use them. For the enemy tank, a value of <code class="literal">2.4</code> for the <span class="strong"><strong>Radius</strong></span> and <code class="literal">4</code> for the <span class="strong"><strong>Height</strong></span> will work well. You should be able to see another wire cylinder in the <span class="strong"><strong>Scene</strong></span> window, which is our enemy tank.</p></li><li><p>The last thing to do is to turn <code class="literal">EnemyTank</code> into a prefab. Do this just as we did with the targets, by dragging it from the <span class="strong"><strong>Hierarchy</strong></span> window and dropping it on the <code class="literal">Prefabs</code> folder in the <span class="strong"><strong>Project</strong></span> window.</p></li></ol></div><p>Here, we created an <a id="id315" class="indexterm"></a>enemy tank. We also learned about the settings for the <span class="strong"><strong>NavMeshAgent</strong></span> component. However, if you try to play the game now, nothing will appear to happen. This is because the <span class="strong"><strong>NavMeshAgent</strong></span> component is not being given a destination. We will resolve this in the next section.</p></div>