<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch02lvl1sec21"></a>Rotating devices</h2></div></div><hr /></div><p>If you <a id="id126" class="indexterm"></a>have been testing your game so far, you have probably noticed that the game only looks good when we hold the device in the landscape mode. When it is held in the portrait mode, everything becomes squished as the squares and turn indicator try to share the little amount of horizontal space that is available. As we have already set up our game board in one layout mode, it becomes a fairly simple matter to duplicate it for the other mode. However, it does require duplicating a good portion of our code to make it all work properly:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>To <a id="id127" class="indexterm"></a>make a copy of our game board, right-click on it and select <span class="strong"><strong>Duplicate</strong></span> from the new menu. Rename the duplicate game board <code class="literal">GameBoard_Portrait</code>. This will be the board used when our player's device is in the portrait mode. To see our changes while we are making them, turn off the landscape game board and select <span class="strong"><strong>3:2 Portrait (2:3)</strong></span> from the drop-down list at the top left of the <span class="strong"><strong>Game</strong></span> window.</p></li><li><p>Select the <span class="strong"><strong>Board</strong></span> object that is a child of <span class="strong"><strong>GameBoard_Portrait</strong></span>. In its <span class="strong"><strong>Inspector</strong></span> panel, we need to change the anchors to use the top two-thirds of the screen rather than the left two-thirds. The values of <code class="literal">0</code> for <span class="strong"><strong>Min X</strong></span>, <code class="literal">0.33</code> for <span class="strong"><strong>Min Y</strong></span>, and <code class="literal">1</code> for both <span class="strong"><strong>Max X</strong></span> and <span class="strong"><strong>Max Y</strong></span> will make this happen.</p></li><li><p>Next, <span class="strong"><strong>Turn Indicator</strong></span> needs to be selected and moved to the bottom third of the screen. Values of <code class="literal">0</code> for <span class="strong"><strong>Min X</strong></span> and <span class="strong"><strong>Min Y</strong></span>, <code class="literal">1</code> for <span class="strong"><strong>Max X</strong></span>, and <code class="literal">0.33</code> for <span class="strong"><strong>Max Y</strong></span> will work well here.</p></li><li><p>Now that we have our second board set up, we need to make a place for it in our code. So, open the <code class="literal">TicTacToeControl</code> script and scroll to the top so that we can start with some new variables.</p></li><li><p>The first variable we are going to add will give us access to the turn indicator for the portrait mode of our screen:</p><div class="informalexample"><pre class="programlisting">public Text turnIndicatorPortrait;</pre></div></li><li><p>The next three variables will keep track of the buttons, square images, and owner text information. These are just like the three lists we created earlier to keep track of the board while it is in the landscape mode:</p><div class="informalexample"><pre class="programlisting">public GameObject[] buttonsPortrait;
public Image[] squaresPortrait;
public Text[] squareTextsPortrait;</pre></div></li><li><p>The last two variables we are going to add to the top of our script here are for keeping track of the two canvas objects that actually draw our game boards. We need these so that we can switch between them as the user turns their device around:</p><div class="informalexample"><pre class="programlisting">public GameObject gameBoardGroupLandscape;
public GameObject gameBoardGroupPortrait;</pre></div></li><li><p>Next, we need to update a few of our functions so that they make changes to both boards and not just the landscape board. These first two lines turn the portrait board's buttons off and the squares on when the player clicks on them. They need to go at the beginning of our <code class="literal">ButtonClick</code> function. Put them right after the two lines where we use <code class="literal">SetActive</code> on the buttons and squares for the landscape set:</p><div class="informalexample"><pre class="programlisting">buttonsPortrait[squareIndex].SetActive(false);
squaresPortrait[squareIndex].gameObject.SetActive(true);</pre></div></li><li><p>These<a id="id128" class="indexterm"></a> two lines change the image and text for the controlling square in favor of the X player for the <span class="strong"><strong>Portrait</strong></span> set. They go inside the <code class="literal">if</code> statement of our <code class="literal">ButtonClick</code> function, right after the two lines that do the same thing for the landscape set:</p><div class="informalexample"><pre class="programlisting">squaresPortrait[squareIndex].sprite = xImage;
squareTextsPortrait[squareIndex].text = "X";</pre></div></li><li><p>This line goes at the end of that same <code class="literal">if</code> statement and changes the <span class="strong"><strong>Portrait</strong></span> set's turn indicator text:</p><div class="informalexample"><pre class="programlisting">turnIndicatorPortrait.text = "O's Turn";</pre></div></li><li><p>The next two lines change image and text in favor of the O player. They go after the same lines for the <span class="strong"><strong>Landscape</strong></span> set, inside of the <code class="literal">else</code> statement of our <code class="literal">ButtonClick</code> function:</p><div class="informalexample"><pre class="programlisting">squaresPortrait[squareIndex].sprite = oImage;
squareTextsPortrait[squareIndex].text = "O";</pre></div></li><li><p>This is the last line we need to add to our <code class="literal">ButtonClick</code> function; it needs to be put at the end of the <code class="literal">else</code> statement. It simply changes the text indicating whose turn it is:</p><div class="informalexample"><pre class="programlisting">turnIndicatorPortrait.text = "X's Turn";</pre></div></li><li><p>Next, we need to create a new function to control the changing of our game boards when the player changes the orientation of their device. We will start by defining the <code class="literal">Update</code> function. This is a special function called by Unity for every single frame. It will allow us to check for a change in orientation for every frame:</p><div class="informalexample"><pre class="programlisting">public void Update() {</pre></div></li><li><p>The function begins with an <code class="literal">if</code> statement that uses <code class="literal">Input.deviceOrientation</code> to find out how the player's device is currently being held. It compares the finding to the <code class="literal">LandscapeLeft</code> orientation to see whether the device is begin held sideways, with the home button on the left side. If the result is true, the <span class="strong"><strong>Portrait</strong></span> set of GUI elements are turned off while the <span class="strong"><strong>Landscape</strong></span> set is turned on:</p><div class="informalexample"><pre class="programlisting">if(Input.deviceOrientation == DeviceOrientation.LandscapeLeft) {
  gameBoardGroupPortrait.SetActive(false);
  gameBoardGroupLandscape.SetActive(true);
}</pre></div></li><li><p>The next <code class="literal">else if</code> statement checks for a <code class="literal">Portrait</code> orientation if the home button is down. It turns <span class="strong"><strong>Portrait</strong></span> on and the <span class="strong"><strong>Landscape</strong></span> set off, if <code class="literal">true</code>:</p><div class="informalexample"><pre class="programlisting">else if(Input.deviceOrientation == DeviceOrientation.Portrait) {
  gameBoardGroupPortrait.SetActive(true);
  gameBoardGroupLandscape.SetActive(false);
}</pre></div></li><li><p>This <a id="id129" class="indexterm"></a>
<code class="literal">else if</code> statement is checking <code class="literal">LanscapeRight</code> when the home button is on the right side:</p><div class="informalexample"><pre class="programlisting">else if(Input.deviceOrientation == DeviceOrientation.LandscapeRight) {
  gameBoardGroupPortrait.SetActive(false);
  gameBoardGroupLandscape.SetActive(true);
}</pre></div></li><li><p>Finally, we check the <code class="literal">PortraitUpsideDown</code> orientation, which is when the home button is at the top of the device. Don't forget the extra bracket to close off and end the function:</p><div class="informalexample"><pre class="programlisting">else if(Input.deviceOrientation == DeviceOrientation.PortraitUpsideDown) {
  gameBoardGroupPortrait.SetActive(true);
  gameBoardGroupLandscape.SetActive(false);
}
}</pre></div></li><li><p>We now need to return to Unity and select our <span class="strong"><strong>GameControl</strong></span> object so that we can set up our new <span class="strong"><strong>Inspector</strong></span> properties.</p></li><li><p>Drag and drop the various pieces from the portrait game board in <span class="strong"><strong>Hierarchy</strong></span> to the relevant slot in <span class="strong"><strong>Inspector</strong></span>, <span class="strong"><strong>Turn Indicator</strong></span> to the <span class="strong"><strong>Turn Indicator Portrait</strong></span> slot, the buttons to the <span class="strong"><strong>Buttons Portrait</strong></span> list in order, the squares to <span class="strong"><strong>Squares Portrait</strong></span>, and their text children to the <span class="strong"><strong>Square Texts Portrait</strong></span>.</p></li><li><p>Finally, drop the <span class="strong"><strong>GameBoard_Portrait</strong></span> object in the <span class="strong"><strong>Game Board Group Portrait</strong></span> slot.</p><div class="mediaobject"><img src="/graphics/9781784394691/graphics/4691OT_02_09.jpg" /></div></li></ol></div><p>We should now be able to play our game and see the board switch when we change the orientation of our device. You will have to either build your project on your device or connect using <a id="id130" class="indexterm"></a>Unity Remote because the Editor itself and your computer simply don't have a device orientation like your mobile device. Be sure to set the display mode of your <span class="strong"><strong>Game</strong></span> window to <span class="strong"><strong>Remote</strong></span> in the top-left corner so that it will update along with your device while using Unity Remote.</p></div>