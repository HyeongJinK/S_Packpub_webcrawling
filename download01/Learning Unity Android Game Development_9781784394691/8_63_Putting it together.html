<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch08lvl1sec63"></a>Putting it together</h2></div></div><hr /></div><p>So far, we learned about <a id="id520" class="indexterm"></a>audio effects and <a id="id521" class="indexterm"></a>particle systems on their own. They each can add a lot to the scene, setting the mood and giving that touch of polish that sets a game apart. However, there are many effects that cannot stand on their own. Explosions, for example, are simply not that impressive, unless you have both the visual and auditory effects.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch08lvl2sec57"></a>Exploding bananas</h3></div></div></div><p>It is so <a id="id522" class="indexterm"></a>much more satisfying to destroy things when they explode. It takes both a particle effect and a sound effect to make a proper explosion. We will start by creating an explosion prefab. Then, we will update the bananas to spawn the explosion once they are destroyed. Let's use these steps to create the banana explosions:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>First, we need to create a new particle system and name it <code class="literal">Explosion</code>.</p></li><li><p>We want our explosion to actually look something like an explosion. This is where our second particle texture comes in. Create a new material for it, named <code class="literal">Smoke</code>.</p></li><li><p>This time, set the <span class="strong"><strong>Shader</strong></span> property by going to <span class="strong"><strong>Particles</strong></span> | <span class="strong"><strong>Additive</strong></span>. This will use an additive-blending method that makes the overall particle look brighter, while still blending the alpha of the particle with the things behind.</p></li><li><p>Be sure to set the new material's <span class="strong"><strong>Particle Texture</strong></span> property to <code class="literal">Smoke</code>.</p></li><li><p>Also, drop your <code class="literal">Smoke</code> material into the <span class="strong"><strong>Material</strong></span> slot in the particle system's <span class="strong"><strong>Renderer</strong></span> module.</p></li><li><p>We do not want this explosion to last too long. So, in the <span class="strong"><strong>Initial</strong></span> module, set <span class="strong"><strong>Duration</strong></span> to <code class="literal">0.5</code> and <span class="strong"><strong>Start Lifetime</strong></span> to <code class="literal">1</code>, making it all much shorter than what it was.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note16"></a>Note</h3><p>When working with things such as explosions that occur in short bursts, it can become hard to see how our changes are affecting the look of the particle system. When we are done with this particle system, we will have to uncheck the <span class="strong"><strong>Looping</strong></span> checkbox, but leaving it on for now makes it much easier to view and work with.</p></div></li><li><p>Next, so<a id="id523" class="indexterm"></a> that the particles do not fly excessively far, set <span class="strong"><strong>Start Speed</strong></span> to <code class="literal">0.5</code>, making the explosion contained and centralized.</p></li><li><p>In order to have enough particles for a proper explosion, set <span class="strong"><strong>Rate</strong></span> to <code class="literal">120</code> in the <span class="strong"><strong>Emission</strong></span> module.</p></li><li><p>To actually make the explosion seem legitimate, change <span class="strong"><strong>Shape</strong></span> to <span class="strong"><strong>Sphere</strong></span> in the <span class="strong"><strong>Shape</strong></span> module. Also, set <span class="strong"><strong>Radius</strong></span> to <code class="literal">0.5</code>. If you are interested in changing the size of the explosion, adjust <span class="strong"><strong>Radius</strong></span> and the <span class="strong"><strong>Emission Rate</strong></span>. Increasing both will give you a larger explosion, while decreasing both will give you a smaller one.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note17"></a>Note</h3><p>This basic explosion effect is just a visual explosion, as most are. Making an explosion that changes the environment or alters its appearance based on the environment will require extra scripting and model consideration that is beyond the scope of this book.</p></div></li><li><p>The explosion in our game still isn't colored like an explosion and all of the particles pop out of the existence around the edges. That's where the <span class="strong"><strong>Color over Lifetime</strong></span> module comes in. First, we need to get rid of the particle pop by adding some new flags for the alpha channel. Add two new flags at about <code class="literal">20</code> percent of the way in from the edges and adjust all the four flags, so that the particles fade in at the beginning and out at the end.</p></li><li><p>The flags along the bottom of the gradient bar of <span class="strong"><strong>Gradient Editor</strong></span> control the colors that the particle will transition through over the course of its life. For a decent explosion, we are going to need two more flags, one that is placed one-third of the way in and one flag at two-thirds, spacing all four of them evenly. Explosions tend to start with a moderately bright color, followed by a bright color at the peak of the explosion's energy, then another medium bright color as the energy starts to dissipate, and finally black when all of the energy is gone. Each color you pick will affect the color of the explosion. For a normal explosion, select yellows and oranges. For a sci-fi space explosion, you can select blues or greens. Or, maybe it is an alien spore cloud with the use of purples. Use your imagination and pick something appropriate for what you want to explode.</p><div class="mediaobject"><img src="/graphics/9781784394691/graphics/4691OT_08_20.jpg" /></div></li><li><p>Now that <a id="id524" class="indexterm"></a>we have all our settings in place, ensure that <span class="strong"><strong>Play On Awake</strong></span> is checked, so the explosion will start the moment it is created, and uncheck <span class="strong"><strong>Looping</strong></span>, so that it does not play forever. If you want to test your particle system at this point, take a look at the <span class="strong"><strong>Stop</strong></span>, <span class="strong"><strong>Simulate</strong></span>, and <span class="strong"><strong>Pause</strong></span> buttons that appear in the bottom-right of your <span class="strong"><strong>Scene</strong></span> window when any particle system is selected. These buttons work just like the buttons of your music player, controlling the playback of your particle system.</p></li><li><p>If we were to start creating explosions now, they will just sit there in the scene after spawning their initial group of particles, though the player will never see them. That's why we need a new script to get rid of them once they are done. Create a new script and name it <code class="literal">Explosion</code>.</p></li><li><p>This script has a single variable, that is, to keep track of the particle system that indicates its existence:</p><div class="informalexample"><pre class="programlisting">public ParticleSystem particles;</pre></div></li><li><p>It also has a single function. The <code class="literal">Update</code> function checks every frame to see whether the particle system even exists or if it has stopped playing. In either case, the overall object is destroyed so that we can save resources:</p><div class="informalexample"><pre class="programlisting">public void Update() {
  if(particles == null || !particles.isPlaying)
    Destroy(gameObject);
}</pre></div></li><li><p>Next, we need to add our new script to the <code class="literal">Explosion</code> object. Also, drag the <span class="strong"><strong>Particle System</strong></span> component to the <span class="strong"><strong>Particles</strong></span> slot in the <span class="strong"><strong>Script</strong></span> component.</p></li><li><p>To make the explosion heard, we need to add an <span class="strong"><strong>Audio Source</strong></span> component to the <code class="literal">Explosion</code> object as well.</p></li><li><p>Ensure that its <span class="strong"><strong>Play On Awake</strong></span> box is checked. So that the sound makes sense in 3D space, set the <span class="strong"><strong>Spatial Blend</strong></span> property to <code class="literal">1</code>. Also, set it for <span class="strong"><strong>Linear Rolloff</strong></span> and <code class="literal">50</code> for the <span class="strong"><strong>Max Distance</strong></span>, so that we can hear it.</p></li><li><p>It doesn't make<a id="id525" class="indexterm"></a> much sense for our bananas to have the same explosion sound that a car has. Instead, we have a nice little popping sound that will differentiate the final touch from those that just reduce the health of the banana. To that end, set the <code class="literal">BananaPop</code> audio file in the <span class="strong"><strong>AudioClip</strong></span> slot on the <span class="strong"><strong>Audio Source</strong></span> component.</p></li><li><p>With all of our explosive settings in place, create a new prefab out of the <code class="literal">Explosion</code> object and delete it from the scene.</p></li><li><p>Next, we need to update the <code class="literal">BananaBounce</code> script to actually spawn the explosion when it has run out of health. Open it up now.</p></li><li><p>First, we add a new variable at the beginning of the script. This will simply keep track of the prefab that we want to spawn after the banana runs out of health:</p><div class="informalexample"><pre class="programlisting">public GameObject explosion;</pre></div></li><li><p>Next, we need to add a line to the <code class="literal">Touched</code> function right after we use the <code class="literal">Destroy</code> function. This line just creates a new instance of the explosion at the position of the banana:</p><div class="informalexample"><pre class="programlisting">Instantiate(explosion, transform.position, transform.rotation);</pre></div></li><li><p>Finally, find your <code class="literal">Banana</code> prefab in the <span class="strong"><strong>Project</strong></span> panel and drop the <code class="literal">Explosion</code> prefab into the new <span class="strong"><strong>Explosion</strong></span> slot. If you don't, the explosion will never be created and Unity will give you an error every time a banana runs out of health.</p><div class="mediaobject"><img src="/graphics/9781784394691/graphics/4691OT_08_21.jpg" /></div></li></ol></div><p>As you can see in the preceding screenshot, we have created an explosion. With the help of a few textures from<a id="id526" class="indexterm"></a> Unity's old particle systems, we made it actually look like an explosion, rather than just the puff of colored balls that it would otherwise be. We also gave the explosion a sound effect. Combining both particle systems and audio sources, we can create many effects, such as our explosion, which would be weak if you just use one or the other. We also updated our bananas so that they spawn the explosions when they are destroyed by the player. Try playing around with the balance of the banana's audio, the volume differences between each touch on the banana, and the explosion itself. The more information we can give the player visually with particle systems and in an auditory manner with audio sources, the better will be the effect.</p><p>Bananas aren't the only thing in this world that can explode. In our second game, we were destroying tanks that just disappear. Try adding some new explosions to the Tank Battle game. Every time a tank is destroyed, it should explode in a glorious fashion. Also, shots from a tank tend to explode no matter what they hit. Try spawning an explosion at the point it was shot rather than moving the red sphere around. It will give the player a much better sense and feel of what they are shooting at.</p><p>The Angry Birds game can also use some explosions, especially the black bird. Every time something is <a id="id527" class="indexterm"></a>destroyed, it should throw out some sort of particles and make a little bit of noise. Otherwise, it will continue to look a little weird when things just disappear suddenly.</p></div></div>