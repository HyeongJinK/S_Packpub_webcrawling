<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch05lvl1sec43"></a>Spawning enemy tanks</h2></div></div><hr /></div><p>Having a limited number of <a id="id331" class="indexterm"></a>enemies in the game at the beginning is not suitable for our game to have lasting fun. Therefore, we need to make some spawn points. As tanks are destroyed, these will make new tanks appear to keep the player on their toes.</p><p>The script that we will create in this section will keep our game world populated with all the enemies that our player might want to destroy. These steps will let us spawn the enemy tanks:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>We need another new script for this section. Once this is created, name it <code class="literal">SpawnPoint</code>.</p></li><li><p>This script begins simply with a few variables. The first variable will hold a reference to our <code class="literal">EnemyTank</code> prefab. We need it so that we can spawn duplicates.</p><div class="informalexample"><pre class="programlisting">public GameObject tankPrefab;</pre></div></li><li><p>The second variable tracks the spawned tank. When it is destroyed, we will create a new one. Using this variable, we prevent the game from becoming overwhelmed with the enemy. There will only be as many tanks as spawn points.</p><div class="informalexample"><pre class="programlisting">private GameObject currentTank;</pre></div></li><li><p>The third variable is for setting a distance between the spawning tanks and the player to prevent the spawning tanks from appearing on top of the player. If the player is outside this distance, a new tank can be spawned. If they are within, a new tank will not be spawned.</p><div class="informalexample"><pre class="programlisting">public float minPlayerDistance = 10;</pre></div></li><li><p>The first function that we will use is <code class="literal">FixedUpdate</code>. This will start by checking a function to see whether it needs to spawn a new tank. If it does, it will call the <code class="literal">SpawnTank</code> function to do so:</p><div class="informalexample"><pre class="programlisting">public coid FixedUpdate() {
  if(CanSpawn())
    SpawnTank();
}</pre></div></li><li><p>Next, we create the <code class="literal">CanSpawn</code> function. The first line of the function checks to see whether we <a id="id332" class="indexterm"></a>already have a tank and returns <code class="literal">false</code> if we do. The second line uses <code class="literal">Vector3.Distance</code> to determine how far away the player currently is. The last line compares that distance with the minimum distance that the player needs to be before we can spawn anything, and it then returns the result:</p><div class="informalexample"><pre class="programlisting">public bool CanSpawn() {
  if(current != null) return false;

  float currentDistance = Vector3.Distance(PlayerPosition.position, transform.position);
  return currentDistance &gt; minPlayerDistance;
}</pre></div></li><li><p>The last function, <code class="literal">SpawnTank</code>, starts by checking to make sure that the <code class="literal">tankPrefab</code> reference has been connected. It can't continue if there is nothing to spawn. The second line uses the <code class="literal">Instantiate</code> function to create a duplicate of the prefab. In order to store it in our variable, we use <code class="literal">as GameObject</code> to make it the proper type. The last line moves the new tank to the spawn point's position as we don't want the tanks to appear at random locations.</p><div class="informalexample"><pre class="programlisting">public void SpawnTank() {
  if(tankPrefab == null) return;

  currentTank = Instantiate(tankPrefab) as GameObject;
  currentTank.transform.position = transform.position;
}</pre></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note12"></a>Note</h3><p>We again chose to use the <code class="literal">Instantiate</code> and <code class="literal">Destroy</code> functions to handle the creation and deletion of our enemy tanks due to their simplicity and speed. Alternatively, we could have created a list of available enemies. Then, every time our player kills one, we could turn it off (instead of completely destroying it), just move an old one to where we need it (instead of creating a new one), reset the old one's stats, and turn it on. There will always be multiple ways to program everything, and this is just one alternative.</p></div></li><li><p>Return to Unity, create an empty <span class="strong"><strong>GameObject</strong></span>, and rename it as <code class="literal">SpawnPoint</code>.</p></li><li><p>Add the <code class="literal">SpawnPoint</code> script, which we just created, to it.</p></li><li><p>Next, with the spawn point selected, connect the prefab reference by dragging the <code class="literal">EnemyTank</code> prefab from the <code class="literal">Prefabs</code> folder and drop it on the appropriate value.</p></li><li><p>Now, turn <a id="id333" class="indexterm"></a>the <code class="literal">SpawnPoint</code> object into a prefab by dragging and dropping it from the <span class="strong"><strong>Hierarchy</strong></span> window into the <code class="literal">Prefabs</code> folder.</p></li><li><p>Finally, populate the city with the new points. Positioning one in each corner of the city will work well.</p><div class="mediaobject"><img src="/graphics/9781784394691/graphics/4691OT_05_08.jpg" /></div></li></ol></div><p>Here, we created spawn points for the game. Each point will spawn a new tank. When a tank is destroyed, a new one will be created at the spawn point. Feel free to build the game and try it out on your device. This section and chapter are now complete and ready to be wrapped up.</p><p>Having one spawn point per tank is great, until we want many tanks or we wish them all to spawn from the same location. Your challenge here is to make a single spawn point to track multiple tanks. If any one of the tanks is destroyed, a new one should be created. You will definitely need an array to keep track of all the tanks. In addition, you could implement a delay for the spawn process as you won't want multiple tanks spawning on top of each other. This could cause them to suddenly jump as the <span class="strong"><strong>NavMeshAgent</strong></span> component does its best to keep them from occupying the same space. In addition, the player might also think that they are only fighting one tank, when in fact there are several tanks in the same spot.</p><p>Now that you have<a id="id334" class="indexterm"></a> all the knowledge and tools that you need, as a further challenge, try to create other types of enemy tanks. You can experiment with size and speed. They can also have different strengths, or you could give more points when enemy tanks are destroyed. Perhaps, there is a tank that actually gives the player points when shooting at them. Play around with the game and have some fun with it.</p></div>