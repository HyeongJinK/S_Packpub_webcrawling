<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch08lvl1sec62"></a>Understanding particle systems</h2></div></div><hr /></div><p>Particle systems<a id="id488" class="indexterm"></a> add a lot to the final look of a game. They can take the form of fire, magic waves, rain, or a great many other effects that you can dream up. They are often hard to create well, but are well worth the effort if you do. Keep in mind, especially when working with the mobile platform, that less is more. Larger particles are more effective than a great amount of particles. If your particle system ever contains thousands of particles in a small space or is duplicated on itself to increase the effect, you need to rethink the design and find a more efficient solution.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch08lvl2sec55"></a>Particle system settings</h3></div></div></div><p>Every <a id="id489" class="indexterm"></a>particle system contains a large variety of components, each with its own settings. Most of the available settings have the option to be <span class="strong"><strong>Constant</strong></span>, <span class="strong"><strong>Curve</strong></span>, <span class="strong"><strong>Random Between Two Constants</strong></span>, and <span class="strong"><strong>Random Between Two Curves</strong></span>. The <span class="strong"><strong>Constant</strong></span> option will be a specific value. The <span class="strong"><strong>Curve</strong></span> option will be a set value that changes along the curve over time. The two random settings select a random value between the respective value types. This may seem confusing at first, but as you work through them, they will become more understandable.</p><p>As you will see in the following screenshots and descriptions that follow, we will work through and gain <a id="id490" class="indexterm"></a>an understanding of each piece of a particle system:</p><div class="mediaobject"><img src="/graphics/9781784394691/graphics/4691OT_08_04.jpg" /></div><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>The first portion, the <a id="id491" class="indexterm"></a>
<span class="strong"><strong>Initial</strong></span> module, of the particle system holds all the settings used by every emitter in Unity:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p><span class="strong"><strong>Duration</strong></span>: This denotes the time for which an emitter lasts. A looping system will repeat itself after this amount of time. A nonlooping system will stop emitting new particles after this length of time.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Looping</strong></span>: This checkbox dictates whether or not the system loops.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Prewarm</strong></span>: This checkbox, if checked, will start a looping system if it has already had a chance to loop for a while. This is useful in the case of torches that should already be lit, not start when the player enters the room.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Start Delay</strong></span>: This will stop the particle system from emitting for the given number of seconds, when it is initially triggered.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Start Lifetime</strong></span>: This is the number of seconds for which an individual particle will last.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Start Speed</strong></span>: This is how fast a particle will initially move when spawned.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Start Size</strong></span>: This<a id="id492" class="indexterm"></a> dictates how large a particle is when it is spawned. It is always better to use large particles rather than small and, hence, a greater number of particles.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Start Rotation</strong></span>: This will rotate the emitted particles.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Start Color</strong></span>: This is the color tint of the particles when they are spawned.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Gravity Modifier</strong></span>: This gives the particles a greater or lesser amount of gravity effect.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Inherit Velocity</strong></span>: This will cause particles to gain a portion of their transform's momentum if it is moving.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Simulation Space</strong></span>: This determines whether the particles will stay with the game object as it is moved (that is, local) or remain where they are in the world.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Play On Awake</strong></span>: This checkbox, if checked, will cause the emitter to start emitting as soon as it is spawned or the scene starts.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Max Particles</strong></span>: This limits the total number of particles that this system supports at a single time. This value only comes into play if the rate at which particles are emitted (or their lifespan) is great enough to overbalance their rate of destruction.</p></li></ul></div><div class="mediaobject"><img src="/graphics/9781784394691/graphics/4691OT_08_05.jpg" /></div></li><li style="list-style-type: disc"><p>The <span class="strong"><strong>Emission</strong></span> module<a id="id493" class="indexterm"></a> controls how fast the particles are emitted:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p><span class="strong"><strong>Rate</strong></span>: If this is set to <span class="strong"><strong>Time</strong></span>, it denotes the number of particles that are created per second. If this is set to <span class="strong"><strong>Distance</strong></span>, it denotes the number of particles per unit of the distance that the system travels as it moves.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Bursts</strong></span>: This is only used when the <span class="strong"><strong>Rate</strong></span> option is set to <span class="strong"><strong>Time</strong></span>. It allows you to set points in the system's timeline when a specific number of particles will be emitted.</p></li></ul></div><div class="mediaobject"><img src="/graphics/9781784394691/graphics/4691OT_08_06.jpg" /></div></li><li style="list-style-type: disc"><p>The <a id="id494" class="indexterm"></a>
<span class="strong"><strong>Shape</strong></span> module, as shown in the preceding screenshot, controls how the system emits particles. It has the following options:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p><span class="strong"><strong>Shape</strong></span>: This dictates what form the emission point will take. Each option comes with a few more value fields that determine its size.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Sphere</strong></span>: This is the point from which particles are emitted in all the directions. The <span class="strong"><strong>Radius</strong></span> parameter determines the size of the sphere. The <span class="strong"><strong>Emit from Shell</strong></span> option dictates whether the particles are emitted from the surface of the sphere or from within the volume.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>HemiSphere</strong></span>: This is, as the name suggests, the half of a sphere. The <span class="strong"><strong>Radius</strong></span> parameter and the <span class="strong"><strong>Emit from Shell</strong></span> option work the same here as they do for <span class="strong"><strong>Sphere</strong></span>.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Cone</strong></span>: This emits particles in one direction. The <span class="strong"><strong>Angle</strong></span> parameter determines whether the shape is closer to a cone or cylinder. The <span class="strong"><strong>Radius</strong></span> parameter dictates the size of the emission point of the shape. The <span class="strong"><strong>Length</strong></span> parameter is used when the <span class="strong"><strong>Emit from</strong></span> option is set to <span class="strong"><strong>Volume</strong></span> or <span class="strong"><strong>Volume Shell</strong></span>, to dictate how much space is available for spawning particles. The <span class="strong"><strong>Emit from</strong></span> option will determine where the particles are emitted from. <span class="strong"><strong>Base</strong></span> emits from the base <a id="id495" class="indexterm"></a>disc of the shape. The <span class="strong"><strong>Base Shell</strong></span> option emits from the base of the cone but around the surface of the shape. <span class="strong"><strong>Volume</strong></span> will emit from anywhere inside the shape, and <span class="strong"><strong>Volume Shell</strong></span> emits from the surface of the shape.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Box</strong></span>: This emits particles from a cube-type shape. The <span class="strong"><strong>Box X</strong></span>, <span class="strong"><strong>Box Y</strong></span>, and <span class="strong"><strong>Box Z</strong></span> options determine the size of the box.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Mesh</strong></span>: This allows you to select a model to use as an emission point. You then have the option of emitting particles from each <span class="strong"><strong>Vertex</strong></span>, <span class="strong"><strong>Edge</strong></span>, or <span class="strong"><strong>Triangle</strong></span> that makes up the <span class="strong"><strong>Mesh</strong></span>.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Circle</strong></span>: This emits particles from a single point along a 2D plane. <span class="strong"><strong>Radius</strong></span> determines the size of the emission, and <span class="strong"><strong>Arc</strong></span> dictates how much of the circle is used. <span class="strong"><strong>Emit from Edge</strong></span> decides whether the particles are emitted from the inner or outer edge of the circle.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Edge</strong></span>: This emits particles in a single direction, out from a line. The <span class="strong"><strong>Radius</strong></span> parameter determines how long the emission area is.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Random Direction</strong></span>: This determines whether a particle's direction is determined by the surface normal of the shape chosen or whether it is chosen at random.</p></li></ul></div><div class="mediaobject"><img src="/graphics/9781784394691/graphics/4691OT_08_07.jpg" /></div></li><li style="list-style-type: disc"><p>The <span class="strong"><strong>Velocity over Lifetime</strong></span> module<a id="id496" class="indexterm"></a> allows you to control the momentum of the particles after they have been spawned:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p><span class="strong"><strong>X</strong></span>, <span class="strong"><strong>Y</strong></span>, and <span class="strong"><strong>Z</strong></span>: These define the number of units per second along each axis of the particle's momentum.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Space</strong></span>: This dictates whether the velocity is applied locally to the system's transformation or relative to the world.</p></li></ul></div><div class="mediaobject"><img src="/graphics/9781784394691/graphics/4691OT_08_08.jpg" /></div></li><li style="list-style-type: disc"><p>The <span class="strong"><strong>Limit Velocity over Lifetime</strong></span> module<a id="id497" class="indexterm"></a> dampens a particle's movement if it exceeds the specified value:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p><span class="strong"><strong>Separate Axis</strong></span>: This allows you to define a value unique to each axis and whether that value is local or relative to the world.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Speed</strong></span>: This is how fast the particle has to be moving before the damp is applied.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Dampen</strong></span>: This is a percentage of the speed by which the particle is cut. It can be any value between zero and one.</p></li></ul></div><div class="mediaobject"><img src="/graphics/9781784394691/graphics/4691OT_08_09.jpg" /></div></li><li style="list-style-type: disc"><p>The <span class="strong"><strong>Force over Lifetime</strong></span> module<a id="id498" class="indexterm"></a> adds a constant amount of movement to each particle over the course of its life:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p><span class="strong"><strong>X</strong></span>, <span class="strong"><strong>Y</strong></span>, and<span class="strong"><strong> Z</strong></span>: These define how much force needs to be applied along each axis.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Space</strong></span>: This dictates whether the force is applied local to the system's transformation or in the world space.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Randomize</strong></span>: If <span class="strong"><strong>X</strong></span>, <span class="strong"><strong>Y</strong></span>, and <span class="strong"><strong>Z</strong></span> are random values, this will cause the amount of force to apply to be randomly picked in each frame, resulting in a statistical averaging of the random values.</p></li></ul></div><div class="mediaobject"><img src="/graphics/9781784394691/graphics/4691OT_08_10.jpg" /></div></li><li style="list-style-type: disc"><p>The <span class="strong"><strong>Color over Lifetime</strong></span> module<a id="id499" class="indexterm"></a> allows you to define a series of colors for the particle to transition through after it has been spawned.</p></li><li style="list-style-type: disc"><p>The <span class="strong"><strong>Color by Speed</strong></span> module<a id="id500" class="indexterm"></a> causes the particle to transition through the defined range of colors as its speed changes:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p><span class="strong"><strong>Color</strong></span>: This is the set of colors to transition through.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Speed Range</strong></span>: This defines how fast the particle must go, in order to be at the minimum and maximum ends of the <span class="strong"><strong>Color</strong></span> range.</p></li></ul></div><div class="mediaobject"><img src="/graphics/9781784394691/graphics/4691OT_08_11.jpg" /></div></li><li style="list-style-type: disc"><p>The <span class="strong"><strong>Size over Lifetime</strong></span> module<a id="id501" class="indexterm"></a> changes the size of the particle over the course of its life.</p></li><li style="list-style-type: disc"><p>The <span class="strong"><strong>Size by Speed</strong></span> module<a id="id502" class="indexterm"></a> adjusts the size of each particle, based on how fast it is going, as follows:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p><span class="strong"><strong>Size</strong></span>: This is the adjustment that the particles transition through.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Speed Range</strong></span>: This defines the minimum and maximum values for each of the <span class="strong"><strong>Size</strong></span> values.</p></li></ul></div><div class="mediaobject"><img src="/graphics/9781784394691/graphics/4691OT_08_12.jpg" /></div></li><li style="list-style-type: disc"><p>The <span class="strong"><strong>Rotation over Lifetime</strong></span> module<a id="id503" class="indexterm"></a> rotates particles over time after they have been spawned.</p></li><li style="list-style-type: disc"><p>The <span class="strong"><strong>Rotation by Speed</strong></span> module<a id="id504" class="indexterm"></a> rotates particles more as they go faster:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p><span class="strong"><strong>Angular Velocity</strong></span>: This is the degrees per second speed of the particle's rotation.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Speed Range</strong></span>: This is the minimum and maximum range for the <span class="strong"><strong>Angular Velocity</strong></span> value if it is not set to <span class="strong"><strong>Constant</strong></span>.</p></li></ul></div><div class="mediaobject"><img src="/graphics/9781784394691/graphics/4691OT_08_13.jpg" /></div></li><li style="list-style-type: disc"><p>The <span class="strong"><strong>External Forces</strong></span> module<a id="id505" class="indexterm"></a> multiplies the effect of wind zone objects. Wind zones simulate the effects of wind on particle systems and on Unity's trees.</p></li><li style="list-style-type: disc"><p>The <span class="strong"><strong>Collision</strong></span> module<a id="id506" class="indexterm"></a> allows particles to collide and interact with the physical game world:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>If this is set to <span class="strong"><strong>Planes</strong></span>, you can define a number of flat surfaces for the particles to collide with. This is faster to process than <span class="strong"><strong>World</strong></span> collisions:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p><span class="strong"><strong>Planes</strong></span>: This is a list of transformations that define the surfaces to collide with. Particles will only collide with the local, positive y side of the transform. Any particles on the other side of the point will be destroyed.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Visualization</strong></span>: This gives you the option to view the planes as a <span class="strong"><strong>Solid</strong></span> surface or as a <span class="strong"><strong>Grid</strong></span> surface.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Scale Plane</strong></span>: This adjusts the size of the <span class="strong"><strong>Visualization</strong></span> option. It does not affect the actual size of the surface to collide with.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Particle Radius</strong></span>: This is used to define the size of the sphere that is used to calculate the particle's collision with the planes.</p></li></ul></div></li><li style="list-style-type: disc"><p>If set to <span class="strong"><strong>World</strong></span>, the particles will collide with every collider in your scene. This can be a lot for the processor to handle.</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p><span class="strong"><strong>Collides With</strong></span>: This defines a list of layers that the particles can collide with. Only the colliders on the layers that are checked in this list will be used for the collision calculation.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Collision Quality</strong></span>: This defines how precise the collision calculations are for this particle system. The <span class="strong"><strong>High</strong></span> option will calculate precisely for every single particle. The <span class="strong"><strong>Medium</strong></span> option will use an approximation and a limited number of new calculations in each frame. The <span class="strong"><strong>Low</strong></span> option just calculates less often than <span class="strong"><strong>Medium</strong></span> does. If <span class="strong"><strong>Collision Quality</strong></span> is set to <span class="strong"><strong>Medium</strong></span> or <span class="strong"><strong>Low</strong></span>, the <span class="strong"><strong>Voxel Size</strong></span> parameter dictates how precisely the system estimates the points of collision.</p></li></ul></div></li><li style="list-style-type: disc"><p><span class="strong"><strong>Dampen</strong></span>: This <a id="id507" class="indexterm"></a>removes the defined fraction amount of speed from the particle when it collides with a surface.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Bounce</strong></span>: This allows the particle to maintain the defined fraction of its speed, specifically along the normal of the surface that was hit.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Lifetime Loss</strong></span>: This is the percentage of life. When the particle collides, this percentage of life is removed from the particle. When the particle's life drops to zero over time, or through collision, it is removed.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Min Kill Speed</strong></span>: If, after collision, the particle's speed is below this value, the particle is destroyed.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Send Collision Messages</strong></span>: If this checkbox is checked, scripts attached to the particle system and the object that was collided with will be alerted every frame that the collision took place. Only one message is sent per frame, not per particle.</p></li></ul></div><div class="mediaobject"><img src="/graphics/9781784394691/graphics/4691OT_08_14.jpg" /></div></li><li style="list-style-type: disc"><p>The <span class="strong"><strong>Sub Emitters</strong></span> module<a id="id508" class="indexterm"></a> allows additional particle systems to be spawned at points in the life of each particle of this system:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>Any particle systems in the <span class="strong"><strong>Birth</strong></span> list will be spawned and will follow the particle when it is first created. This can be used to create a fireball or smoke trail.</p></li><li style="list-style-type: disc"><p>The <span class="strong"><strong>Collision</strong></span> list spawns particle systems when the particle hits something. This can be used for rain drop splashes.</p></li><li style="list-style-type: disc"><p>The <span class="strong"><strong>Death</strong></span> list spawns particles when the particles are destroyed. It can be used to spawn a firework explosion.</p></li></ul></div><div class="mediaobject"><img src="/graphics/9781784394691/graphics/4691OT_08_15.jpg" /></div></li><li style="list-style-type: disc"><p>The <span class="strong"><strong>Texture Sheet Animation</strong></span> module<a id="id509" class="indexterm"></a> causes the particle to flip through a number of particles over the course of its life. The texture used is defined in the <span class="strong"><strong>Renderer</strong></span> module:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p><span class="strong"><strong>Tiles</strong></span>: This defines the number of rows and columns in the sheet. This will determine the total number of frames available.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Animation</strong></span>: This gives you the options of <span class="strong"><strong>Whole Sheet</strong></span> and <span class="strong"><strong>Single Row</strong></span>. If this option is set to <span class="strong"><strong>Single Row</strong></span>, the row used can either be chosen at random or specified by using the <span class="strong"><strong>Random Row</strong></span> checkbox and the value of <span class="strong"><strong>Row</strong></span>.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Frame over Time</strong></span>: This defines how the particle transitions between frames. If set to <span class="strong"><strong>Constant</strong></span>, the system will only use a single frame.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Cycles</strong></span>: This<a id="id510" class="indexterm"></a> is the number of times the particle will loop through the animation over the course of its life.</p></li></ul></div><div class="mediaobject"><img src="/graphics/9781784394691/graphics/4691OT_08_16.jpg" /></div></li><li style="list-style-type: disc"><p>The <span class="strong"><strong>Renderer</strong></span> module<a id="id511" class="indexterm"></a> dictates how each particle is drawn on the screen, as follows:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p><span class="strong"><strong>Render Mode</strong></span>: This defines which method a particle should use in order to orient itself in the game world:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p><span class="strong"><strong>Billboard</strong></span>: This will always face the camera directly.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Stretched Billboard</strong></span>: This will face particles at the camera, but it will stretch them based on the speed of the camera, the particle's speed, or by a specific value.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Horizontal Billboard</strong></span>: This is flat on the XZ plane of the game world.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Vertical Billboard</strong></span>: This will always face the player but will always stay straight along the Y axis.</p></li><li style="list-style-type: disc"><p>If set to <span class="strong"><strong>Mesh</strong></span>, you can define a model to be used as a particle, rather than a flat plane.</p></li></ul></div></li><li style="list-style-type: disc"><p><span class="strong"><strong>Normal Direction</strong></span>: This is used for the lighting and shading of the particles by adjusting the normal of each plane. A value of <span class="strong"><strong>1</strong></span> aims the normals directly at the camera, while a value of <span class="strong"><strong>0</strong></span> aims them toward the center of the screen.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Material</strong></span>: This defines the material that was used to render the particles.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Sort Mode</strong></span>: This dictates the order in which the particles should be drawn, by distance or age.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Sorting Fudge</strong></span>: This <a id="id512" class="indexterm"></a>causes particle systems to be drawn earlier than normal. The higher the value, the earlier it will be drawn on the screen. This affects whether the system appears in front of or behind other particle systems or partially transparent objects.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Cast Shadows</strong></span>: This determines whether or not the particles will block light.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Receive Shadows</strong></span>: This determines whether or not the particles are affected by the shadows cast by other objects.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Max Particle Size</strong></span>: This is the total amount of screen space that a single particle is allowed to fill. No matter what the real size of the particle is, it will never fill more than this space of the screen.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Sorting Layer</strong></span> and <span class="strong"><strong>Order in Layer</strong></span>: These are used when working with a 2D game. These dictate what level it is on and where in that level it should be drawn, respectively.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Reflection Probes</strong></span>: These can also be used to reflect the world rather than just a particle. When the world is reflecting rather than a particle, <span class="strong"><strong>Anchor Override</strong></span> can be used to define a custom position to sample reflections from.</p></li></ul></div></li></ul></div><p>That was a whole lot of information. You will use the <span class="strong"><strong>Initial</strong></span>, <span class="strong"><strong>Emission</strong></span>, and <span class="strong"><strong>Shape</strong></span> modules most often. They control the main features of any particle system. To a slightly lesser degree, you will use the <span class="strong"><strong>Renderer</strong></span> module to change the texture used for the particle system and the <span class="strong"><strong>Color over Lifetime</strong></span> module to adjust the fade. All of these pieces, when used together effectively, will give you some really great effects that round out the look of any game. The absolute best way to learn what all they can do is to just play around with the settings and see what happens. Experimentation and a few tutorials, such as the next few sections, are the best ways to become an expert particle system creator.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch08lvl2sec56"></a>Creating dust trails</h3></div></div></div><p>To give our <a id="id513" class="indexterm"></a>players a better sense that characters are actually in the world and touching it, they are often given the ability to kick up little dust clouds as they move around the environment. It is a small effect but adds a good bit of polish to any game. We are going to give our monkey ball the ability to kick up little dust clouds. Let's use these steps to do this:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>First, we need to create a new particle system, by navigating to <span class="strong"><strong>GameObject</strong></span> | <span class="strong"><strong>Particle System</strong></span>. Name it <code class="literal">DustTrail</code>.</p></li><li><p>By default, particle systems shoot out little white balls in a cone shape. For the dust, we need something a little more interesting. Import the textures from the <code class="literal">Starting Assets</code> folder for the chapter to a <code class="literal">Particles</code> folder in your project. These are particle textures, provided by Unity, which were in the older versions of the engine.</p></li><li><p>Next, we need to create a new material in our <code class="literal">Particles</code> folder. Name it <code class="literal">DustPoof</code>.</p></li><li><p>Change the new material's <span class="strong"><strong>Shader</strong></span> property by going to <span class="strong"><strong>Particles</strong></span> | <span class="strong"><strong>Alpha Blended</strong></span> and put the <code class="literal">DustPoof</code> texture into the <span class="strong"><strong>Particle Texture</strong></span> image slot. This changes the material to be partially transparent and to blend well with both the world and the other particles that are being emitted.</p></li><li><p>To change the look of our <code class="literal">DustPoof</code> particle system, put the material in the <span class="strong"><strong>Material</strong></span> slot of the <span class="strong"><strong>Renderer</strong></span> module.</p></li><li><p>The particles in the system last too long and go too far, so set <span class="strong"><strong>Start Lifetime</strong></span> to <code class="literal">0.5</code> and <span class="strong"><strong>Start Speed</strong></span> to <code class="literal">0.2</code>. This will make the particles just rise up a little from the ground before disappearing.</p></li><li><p>We also need to make the particles more appropriate for the size of our monkey. Set <span class="strong"><strong>Start Size</strong></span> to <code class="literal">0.3</code> in order to make them appropriately small.</p></li><li><p>It is a little weird to see all the particles in the exact same orientation. To make the orientations different, change <span class="strong"><strong>Start Rotation</strong></span> to be <span class="strong"><strong>Random Between Two Constants</strong></span> by clicking on the small down arrow to the right-hand side of the input field. Then, set the two new input fields to <code class="literal">-180</code> and <code class="literal">180</code>, so that all the particles have a random rotation.</p></li><li><p>The brownish color of the particle is alright, but it doesn't always make sense with the color and nature of what our level terrain is made of. Click on the color field next to <span class="strong"><strong>Start Color</strong></span> and use the <span class="strong"><strong>Color Picker</strong></span> window that pops up to pick a new color based on the environment. This will allow the particles to make more sense when being kicked up from the surface of our game field.</p></li><li><p>Lastly, for<a id="id514" class="indexterm"></a> the <span class="strong"><strong>Initial</strong></span> module, we need to set <span class="strong"><strong>Simulation Space</strong></span> to <span class="strong"><strong>World</strong></span> so that the particles are left behind as our monkey moves, rather than following him.</p></li><li><p>In <span class="strong"><strong>Emission</strong></span>, we need to make sure that there are enough particles to give us a good amount of dust being kicked up. Set <span class="strong"><strong>Rate</strong></span> to <code class="literal">20</code> for a light dusting.</p></li><li><p>Next, we are going to adjust the <span class="strong"><strong>Shape</strong></span> module so that the particles are emitted under the whole area of the ball. Ensure that the <span class="strong"><strong>Shape</strong></span> is set to <span class="strong"><strong>Cone</strong></span>, the <span class="strong"><strong>Angle</strong></span> to <code class="literal">25</code>, and the <span class="strong"><strong>Radius</strong></span> to <code class="literal">0.5</code>.</p></li><li><p>With the <span class="strong"><strong>Color over Lifetime</strong></span> module, we can ease the sudden appearance and disappearance of the particles. Hit the checkbox at the left-hand side of the module's name to activate it. Click on the white bar at the right-hand side of <span class="strong"><strong>Color</strong></span> to open the <span class="strong"><strong>Gradient Editor</strong></span> window. In <span class="strong"><strong>Gradient Editor</strong></span>, clicking just above the colored bar will add a new flag that will control the transparency of the particles over their lifetime. The left-hand side of this bar corresponds to the very beginning of a particle's life, and the right-hand side corresponds to the end of its life. We need a total of four flags. One at the very beginning, with the value of<span class="strong"><strong> Alpha</strong></span> set to <code class="literal">0</code>, a second flag with a <span class="strong"><strong>Location</strong></span> value of <code class="literal">20</code> and <span class="strong"><strong>Alpha</strong></span> value of <code class="literal">255</code>, the third flag at a <span class="strong"><strong>Location</strong></span> of <code class="literal">50</code> and <span class="strong"><strong>Alpha</strong></span> of <code class="literal">255</code>, and the last flag at the very end with an <span class="strong"><strong>Alpha</strong></span> value of <code class="literal">0</code>. This will cause the dust particles to fade in quickly at the beginning and fade out slowly after that, easing their transition into and out of existence.</p><div class="mediaobject"><img src="/graphics/9781784394691/graphics/4691OT_08_17.jpg" /></div></li><li><p>We can further ease the transition by using the <span class="strong"><strong>Size over Lifetime</strong></span> module to make the particles grow and shrink as they come into and out of existence. Be sure to activate<a id="id515" class="indexterm"></a> it with the checkbox by its name. By clicking on the curve bar at the right-hand side of <span class="strong"><strong>Size</strong></span>, the <span class="strong"><strong>Particle System Curves</strong></span> editor opens in the preview area at the bottom of the <span class="strong"><strong>Inspector</strong></span> panel. Here, we can adjust any of the little diamond-shaped keys to control the size of the particles over the course of its life. Just as in the case of <span class="strong"><strong>Gradient Editor</strong></span>, the left-hand side is the beginning of the particle's life and the right is the end. By right-clicking on it, we can add new keys to control the curve. To create a pop-in effect, put the first key at the bottom in the far left side. The second key should go at the top and correspond with the <code class="literal">0.2</code> value at the bottom. The third will work well at the top and <code class="literal">0.4</code> with the bottom values. The fourth should be at the far right and set at about <code class="literal">0.6</code> with the numbers on the left, which indicate the percentage of its <span class="strong"><strong>Start Size</strong></span> that we set in the <span class="strong"><strong>Initial</strong></span> module, as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781784394691/graphics/4691OT_08_18.jpg" /></div></li><li><p>Finally, to complete the look of our particle system, we are going to use the <span class="strong"><strong>Rotation over Lifetime</strong></span> module to add a little bit of spin to the particles. Change the <a id="id516" class="indexterm"></a>value to <span class="strong"><strong>Random Between Two Constants</strong></span> and set the two value fields to <code class="literal">-45</code> and <code class="literal">45</code> to make the particles spin a little over the course of their lives.</p></li><li><p>So that our monkey can use the particle system, make it a child of the <code class="literal">MonkeyPivot</code> object, and set its position to <code class="literal">0</code> for <span class="strong"><strong>X</strong></span>, <code class="literal">-0.5</code> for <span class="strong"><strong>Y</strong></span>, and <code class="literal">0</code> for <span class="strong"><strong>Z</strong></span>. Also, make sure that the rotation is set to <code class="literal">270</code> for <span class="strong"><strong>X</strong></span>, <code class="literal">0</code> for <span class="strong"><strong>Y</strong></span>, and <code class="literal">0</code> for <span class="strong"><strong>Z</strong></span>. This will keep it at the base of our monkey ball and throw particles into the air. Because it is a child of <code class="literal">MonkeyPivot</code>, it will not spin around with the ball, because we already made the object compensate for the spinning of the ball.</p></li><li><p>Try it out. As our monkey moves around, he leaves a nice little trail of dust in his wake. This effect can be a great bit of polish, especially if we tailor it to the material that the level is made out of, whether it be grass, sand, wood, metal, or anything else.</p></li><li><p>You might notice that the effect continues to play, even as our monkey flies off the edge of our map. We are going to create a new script to toggle the particles based on whether or not our monkey ball is actually touching the ground. Create a new script named <code class="literal">DustTrail</code> now.</p></li><li><p>The first <a id="id517" class="indexterm"></a>variable for this script will hold a reference to the particle system we are trying to control. The second will be a flag that indicates whether or not the ball is actually touching the ground:</p><div class="informalexample"><pre class="programlisting">public ParticleSystem dust;
private bool isTouching = false;</pre></div></li><li><p>We use the <code class="literal">OnCollisionStay</code> function to determine whether the ball is touching anything. This function is similar to the <code class="literal">OnCollisionEnter</code> function we used in the last chapter. While that function was called by Unity the moment one of our birds hit something, this one is called every frame our ball continues to touch another collider. When it is called, we just set our flag to mark that we are touching something:</p><div class="informalexample"><pre class="programlisting">public void OnCollisionStay() {
  isTouching = true;
}</pre></div></li><li><p>Because the physics system only changes during the <code class="literal">FixedUpdate</code> loop, this is the function that we use to update our particle system. Here, we first check whether we are touching something and the particle system is not currently emitting anything, as indicated by its <code class="literal">isPlaying</code> variable. If the conditions are met, we use the <code class="literal">Play</code> function to turn the particle system on. However, if the ball is not touching anything and the particle system is currently playing, we use the <code class="literal">Stop</code> function to turn it off:</p><div class="informalexample"><pre class="programlisting">public void FixedUpdate() {
  if(isTouching &amp;&amp; !dust.isPlaying) {
    dust.Play();
  }
  else if(!isTouching &amp;&amp; dust.isPlaying) {
    dust.Stop();
  }</pre></div></li><li><p>At the very end of the <code class="literal">FixedUpdate</code> function, we set our flag to <code class="literal">false</code> so that it can be re-updated in the next frame as to whether or not we need to turn the particle system on or off:</p><div class="informalexample"><pre class="programlisting">  isTouching = false;
}</pre></div></li><li><p>Next, add <a id="id518" class="indexterm"></a>the new script to the <code class="literal">MonkeyBall</code> object. As we learned in the previous chapter, if we don't attach it to the same object as the ball's <span class="strong"><strong>Rigidbody</strong></span> component, we will not receive the collision messages we need to make the script work.</p></li><li><p>Finally, drop your <code class="literal">DustTrail</code> particle system into the <span class="strong"><strong>Dust</strong></span> slot so that your script can actually take control over it.</p></li><li><p>Try it again. Now our monkey can easily move around and create a little dust trail until it falls off the edge of the level, goes off a jump, or otherwise ends up in the air.</p><div class="mediaobject"><img src="/graphics/9781784394691/graphics/4691OT_08_19.jpg" /></div></li></ol></div><p>We gave our monkey ball the ability to kick up dust. We also made the dust turn on and off, based on whether the ball is actually touching the ground or not. This little effect makes the character feel nice and grounded in the world. It can also give you a sense of the speed of the character, based on the time for which the trail is behind it.</p><p>Another good effect for grounding characters that we have previously discussed is shadows. If you haven't done so <a id="id519" class="indexterm"></a>already, be sure to give your environment some shadow detail. You might notice, though, that due to the partially transparent nature of the ball, real-time shadows do not work on it. That's where the blob shadow we used on the tank will come in.</p><p>Our effect also runs constantly, even if the ball is not moving. Try to adjust whether or not the particle system plays based on the velocity of its <span class="strong"><strong>Rigidbody</strong></span> component. We messed around with the velocity of <span class="strong"><strong>Rigidbody</strong></span> components a little bit in the last chapter, if you need a refresher. For an added challenge, take a look at the particle system's <code class="literal">emissionRate</code> variable. Try to make the effect have more particles as the ball starts going faster.</p></div></div>