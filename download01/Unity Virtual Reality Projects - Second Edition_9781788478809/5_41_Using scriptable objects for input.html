<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch05lvl1sec45"></a>Using scriptable objects for input</h2></div></div><hr /></div><p>In this example, we will further decouple our application from the underlying input device using a technique called <span class="strong"><strong>s<span>cr</span><span>iptable</span></strong></span><span><span class="strong"><strong>objects</strong></span></span><span class="strong"><strong>.</strong></span> These <span>are</span><a id="id325317306" class="indexterm"></a> data objects used for holding information such as game state, player preferences, or any other data that is not necessarily graphical. Scriptable objects are instantiated during runtime, much like MonoBehaviour ones, but do not live in the Hierarchy, have no Transform, nor other physics and rendering behaviors. </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip48"></a>Note</h3><p>It's useful to think of scriptable objects as <span class="emphasis"><em>data containers</em></span> in your projects.</p></div><p></p><p>In the previous implementation, <code class="literal">BalloonController</code> requires a reference to the <code class="literal">MeMyselfEye</code> object to use its <code class="literal">MyInputController</code> component. Although the input controller component does separate you from the underlying SDK calls, if you modify your application to use a different <code class="literal">MeMyselfEye</code> (for example, from OpenVR to Daydream), you will need to find and replace all references to one <code class="literal">MeMyselfEye</code> in the scene and replace them with the new one. Here's will have the input controller populate a scriptable object, and then our <code class="literal">BalloonController</code> reference that object for the data, as illustrated here:</p><div class="mediaobject"><img src="/graphics/9781788478809/graphics/699afead-d326-482b-bc7a-d1d2e52a0366.jpg" /></div><p>The process of implementing scriptable objects is a little more involved than game objects with components. But not much. Let's go!</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note49"></a>Note</h3><p>Keep in mind this is just one example how to use scriptable objects and serves as an introduction to this powerful design pattern in Unity. For more information, see the Unity Tutorial <span class="emphasis"><em>Introduction to</em></span> s<span class="emphasis"><em>criptable</em></span> obj<span class="emphasis"><em>ects</em></span> at <a class="ulink" href="https://unity3d.com/learn/tutorials/modules/beginner/live-training-archive/scriptable-objects" target="_blank">https://unity3d.com/learn/tutorials/modules/beginner/live-training-archive/scriptable-objects</a>. Also, see <a class="link" href="#" linkend="ch09">Chapter 9</a>, Exploring Interactive Spaces, for another example of scriptable objects for data management in a project.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec75"></a>Creating the scriptable object</h3></div></div></div><p>In this example, our object will <span>just</span><a id="id325555193" class="indexterm"></a> have one variable, for the current button action. We'll say the button can have one of three possible values: <code class="literal">PressedDown</code>, <code class="literal">ReleasedUp</code>, or <code class="literal">None</code>. We'll define the action as having occurred current during the current <code class="literal">Update</code>, then it's cleared to <code class="literal">None</code>. That is, rather than record the current button state (for example, is pressed), we are capturing the current button action (was just pressed), to be consistent with other examples in this chapter.</p><p>It's useful to keep scriptable objects in their own folder in the Project <code class="literal">Assets</code>:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>In the <span class="strong"><strong>Project</strong></span> window, create a new folder under <span class="emphasis"><em>Assets</em></span> named <code class="literal">ScriptableObjects</code></li><li>In the new folder, right-click and select <strong class="userinput"><code>Create</code></strong> | <strong class="userinput"><code>C# Script</code></strong></li><li>Name the script <code class="literal">MyInputAction</code></li><li>Then, open the <code class="literal">MyInputAction.cs</code> script for editing</li></ol></div><p>Edit the <code class="literal">MyInputAction.cs</code> script as follows:</p><pre class="programlisting">[CreateAssetMenu(menuName = "My Objects/Input Action")]
public class MyInputAction : ScriptableObject {
  public enum ButtonAction { None, PressedDown, ReleasedUp };
  public ButtonAction buttonAction;
}</pre><p>Rather than inheriting from <code class="literal">MonoBehaviour</code>, we will define the class as a <code class="literal">ScriptableObject</code>. We represent the action using an enum to restrict its possible <span>values</span><a id="id325567582" class="indexterm"></a> to the selection list.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note50"></a>Note</h3><p>"The <span class="strong"><strong>enum</strong></span> keyword is used to declare an enumeration, a distinct type that consists of a set of named constants called the enumerator list." - <a class="ulink" href="https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/enum" target="_blank">https://docs.microsoft.com/en-us/dotnet/csharp/language-reference/keywords/enum</a></p></div><p>Notice the first line of the preceding script. We provide a <span class="emphasis"><em>property attribute</em></span> which generates a menu item in the Unity Editor for our object. Since scriptable objects are not added to the scene Hierarchy, we need a way to create them in the project. Using this attribute makes it easy, as follows:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Save the script and return to Unity.</li><li>In the Unity editor main menu, navigate to <strong class="userinput"><code>Assets</code></strong> | <strong class="userinput"><code>Create</code></strong>.</li><li>You will see a new item, <strong class="userinput"><code>My Objects</code></strong>, with a submenu with an item <strong class="userinput"><code>Input Action</code></strong>, as directed in the <code class="literal">CreateAssetsMenu</code> property attribute in our script. <span>The menu is shown next.</span></li><li>Choose <strong class="userinput"><code>Input Action</code></strong> to create an instance. By default, it will be created in the currently selected Project Assets folder. So if you have the <code class="literal">ScriptableObjects</code> folder open, it will be created there.</li><li>Rename the object <code class="literal">My Input Action Data</code>.</li></ol></div><div class="mediaobject"><img src="/graphics/9781788478809/graphics/c64b708e-889e-4023-87d3-cc12e03384a1.png" /></div><p>If you select the new <code class="literal">My Input Action Data</code> object in your <code class="literal">ScriptableObjects/</code> folder, you can see its properties in the <strong class="userinput"><code>Inspector</code></strong>. In the following screen capture, I have clicked the <span class="strong"><strong><strong class="userinput"><code>Button Action</code></strong></strong></span> drop-down list to reveal the possible enum values we've specified in our code:</p><div class="mediaobject"><img src="/graphics/9781788478809/graphics/9a874857-8748-4b81-b54e-f2fe23eee791.png" /></div><p></p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec76"></a>Populating the input action object</h3></div></div></div><p>The next step is to change <code class="literal">MyInputController.cs</code> to populate <span>the</span><a id="id325577555" class="indexterm"></a> input data object, using a reference to the object, as follows:</p><pre class="programlisting">public MyInputAction myInput;

void Update () 
{
  if (ButtonDown())
  {
    myInput.buttonAction = MyInputAction.ButtonAction.PressedDown;
  } else if (ButtonUp())
  {
    myInput.buttonAction = MyInputAction.ButtonAction.ReleasedUp;
  } else
  {
    myInput.buttonAction = MyInputAction.ButtonAction.None;
  }
}</pre><p>The script uses its own <code class="literal">ButtonDown</code> and <code class="literal">ButtonUp</code> functions to set the <code class="literal">buttonAction</code> as appropriate. These could even be changed from <span class="emphasis"><em>public</em></span> to <span class="emphasis"><em>private</em></span> to further encapsulate it. </p><p>Save the script. Then in Unity:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Select <strong class="userinput"><code><span class="strong"><strong>MeMyselfEye</strong></span></code></strong> object in Hierarchy</li><li>Find the <strong class="userinput"><code>My Input Action Data</code></strong> object in your <code class="literal">ScriptableObjects</code> folder</li><li>Drag it onto the <strong class="userinput"><code>My Input</code></strong> slot of the <strong class="userinput"><code>My Input Controller (Script)</code></strong> component, as shown here for my Steam version of <code class="literal">MeMyselfEye</code>:</li></ol></div><div class="mediaobject"><img src="/graphics/9781788478809/graphics/16ac2b06-d415-4795-9f1d-298bd74aa1ea.png" /></div><p></p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec77"></a>Accessing the input action object</h3></div></div></div><p>Now the <code class="literal">BalloonController</code> can access <span>the</span><a id="id325577582" class="indexterm"></a> input data object rather than <code class="literal">MeMyselfEye</code>. Otherwise is very similar and a simple refactor. Modify <code class="literal">BalloonController.cs</code> as follows.</p><p>First, we can remove any references to <code class="literal">MeMyselfEye</code> in the <code class="literal">BalloonController</code>, including the public variable and the entire <code class="literal">Start()</code> function (we do not need the <code class="literal">GetComponent&lt;MyInputController&gt;</code>).</p><p>Add a variable for the input data object:</p><pre class="programlisting">public MyInputAction myInput;</pre><p>And reference it in the <code class="literal">Update</code> conditions:</p><pre class="programlisting">void Update()
{
  if (myInput.buttonAction == MyInputAction.ButtonAction.PressedDown)
  {
    NewBalloon();
  }
  else if (myInput.buttonAction == MyInputAction.ButtonAction.ReleasedUp)
  {
    ReleaseBalloon();
  }
  else if (balloon != null)
  {
   GrowBalloon();
  }
}</pre><p>Save the script. Then in Unity, as we did previously for <code class="literal">MyInputController</code>:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Select the <strong class="userinput"><code>BalloonController</code></strong> object in <strong class="userinput"><code>Hierarchy</code></strong></li><li>Find the <strong class="userinput"><code>My Input Action Data</code></strong> object in your <code class="literal">ScriptableObjects</code> folder</li><li>Drag it onto the <strong class="userinput"><code>My Input</code></strong> slot of the <strong class="userinput"><code>Balloon Controller</code></strong> component</li></ol></div><p>Press <span class="strong"><strong><strong class="userinput"><code>Play</code></strong></strong></span>. The app should work just like before. Press the button to create a balloon, hold the button to inflate it, and release the button to release the balloon.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec78"></a>Simulation testing with scriptable objects</h3></div></div></div><p>An interesting advantage of this architecture is how it facilitates testing. Having completely decoupled our application objects from <span>the</span><a id="id325578020" class="indexterm"></a> input device, we can simulate input actions without actually using physical input controllers. For example, try this:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Select <strong class="userinput"><code>MeMyselfEye</code></strong> in <strong class="userinput"><code>Hierarchy</code></strong>. Then in <strong class="userinput"><code>Inspector</code></strong>, temporarily disable the <span class="strong"><strong><strong class="userinput"><code>My Input Controller</code></strong></strong></span> component by unchecking its checkbox.</li><li>Select the <strong class="userinput"><code>My Input Action Data</code></strong> object in the Project <code class="literal">ScriptableObjects/</code> folder</li><li>Press <span class="strong"><strong>Play.</strong></span></li><li>While the game is running, in <strong class="userinput"><code>Inspector</code></strong>, change the <strong class="userinput"><code>Button Action</code></strong> from <strong class="userinput"><code>None</code></strong> to <strong class="userinput"><code>PressedDown</code></strong>.</li><li>The <strong class="userinput"><code>BalloonController</code></strong> thinks a <strong class="userinput"><code>PressedDown</code></strong> action has occurred. It creates a new balloon and begins inflating it.</li><li>In <strong class="userinput"><code>Inspector</code></strong>, change the<strong class="userinput"><code>Input Action</code></strong>to<strong class="userinput"><code>PressedUp</code></strong>.</li><li>The <strong class="userinput"><code>BalloonController</code></strong> sees a <span class="strong"><strong><strong class="userinput"><code>PressedUp</code></strong></strong></span> action has occurred and releases the current balloon.</li></ol></div><p>When you're done testing, don't forget to re-enable the input controller component!</p><p>This kind of manual setup of object states for development and testing can be very helpful, especially as your project grows and gets more complex.</p></div></div>