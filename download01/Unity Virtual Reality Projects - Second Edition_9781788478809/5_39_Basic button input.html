<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch05lvl1sec43"></a>Basic button input</h2></div></div><hr /></div><p>Unity includes a standard Input Manager for accessing <span>traditional</span><a id="id325317266" class="indexterm"></a> game controller, keyboard, mouse, and mobile touchscreen input. This can include specific button presses, joystick axes, and the device accelerometer, for example. It also supports input from VR and AR systems.</p><p>The Input Manager provides an abstraction layer over the physical input devices. For example, you can reference logical inputs, such as the <code class="literal">Fire1</code> button, which is mapped to a physical button. The mappings for your project can be set up and modified in <strong class="userinput"><code>Edit</code></strong> | <strong class="userinput"><code>Project Settings</code></strong> | <strong class="userinput"><code>Input</code></strong>. </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note45"></a>Note</h3><p>For a general overview and details of Unity Input Manager, see <a class="ulink" href="https://docs.unity3d.com/Manual/ConventionalGameInput.html" target="_blank">https://docs.unity3d.com/Manual/ConventionalGameInput.html</a>.  For scripting the Input class, see <a class="ulink" href="https://docs.unity3d.com/ScriptReference/Input.html" target="_blank">https://docs.unity3d.com/ScriptReference/Input.html</a>. Input mapping for various VR devices can be found at <a class="ulink" href="https://docs.unity3d.com/Manual/vr-input.html" target="_blank">https://docs.unity3d.com/Manual/vr-input.html</a>.</p></div><p>Let's take a look. To start, we will write a test script to get a specific button state and see how the Unity Input class works. A common logical button is the one named "Fire1." Let's see which button your input device uses for "Fire1."</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec69"></a>Using the Fire1 button</h3></div></div></div><p>We will now write a script, <code class="literal">MyInputController</code>, to detect when <span>your</span><a id="id325549808" class="indexterm"></a> user has pressed the <code class="literal">Fire1</code> button. Add the script to your <code class="literal">MeMyselfEye</code> object as follows:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>In <strong class="userinput"><code>Hierarchy</code></strong>, select the <strong class="userinput"><code>MyMyselfEye</code></strong> object</li><li>In <strong class="userinput"><code>Inspector</code></strong>, click <strong class="userinput"><code>Add</code></strong><strong class="userinput"><code>Component</code></strong>, then <strong class="userinput"><code>New Script</code></strong></li><li>Name it <code class="literal">MyInputController</code> and press <strong class="userinput"><code>Create And Add</code></strong></li><li>Double-click the <code class="literal">MyInputController</code> script to open it for editing</li></ol></div><p>Edit the script as follows:</p><pre class="programlisting">public class MyInputController : MonoBehaviour 
{
  void Update () 
  {
    ButtonTest();
  }

  private void ButtonTest()
  {
    string msg = null;

    if (Input.GetButtonDown("Fire1"))
      msg = "Fire1 down";

    if (Input.GetButtonUp("Fire1"))
       msg = "Fire1 up";

    if (msg != null)
      Debug.Log("Input: " + msg);
  }
}</pre><p>In this script, in each frame Update, we call a private function, <code class="literal">ButtonTest</code>. This function builds a message string named <code class="literal">msg</code> that reports whether the <code class="literal">Fire1</code> button has just been pressed down or released. The call to <code class="literal">Input.GetButtonDown("Fire1")</code>, for example, will return a Boolean (true or false) value, which we check in the <code class="literal">if</code> statement. When either of these situations are true, the <code class="literal">msg</code> string is not empty (null) and gets printed to the Unity Console window:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Press <strong class="userinput"><code>Play</code></strong> in the Unity editor to run the scene</li><li>When you press the Fire1 button on your input controller, you will see the <strong class="userinput"><code>Input: Fire1 down</code></strong> message as output</li><li>When you release the Fire1 button, you will see the <strong class="userinput"><code>Input: Fire1 up</code></strong> message, as shown here:</li></ol></div><div class="mediaobject"><img src="/graphics/9781788478809/graphics/580715ce-df4f-484a-b43c-4a700ef92c2b.png" /></div><p>You can use even use this script to identify which physical button on <span>your</span><a id="id325567250" class="indexterm"></a> input controller maps to the logical <code class="literal">Fire1</code> button. Using OpenVR, for example, <code class="literal">Fire1</code> is triggered with the menu button on a Vive controller or the <span class="strong"><strong>B</strong></span> button on the Oculus Touch controller ("Button.Two") as shown on the Unity Input System Mappings section in the Input for OpenVR Controllers page of the Unity manual  (<a class="ulink" href="https://docs.unity3d.com/Manual/OpenVRControllers.html" target="_blank">https://docs.unity3d.com/Manual/OpenVRControllers.html</a>). Feel free to experiment with using other logical input names, and/or modifying the mappings using the Input project settings (<strong class="userinput"><code>Edit</code></strong> | <strong class="userinput"><code>Project Settings</code></strong> | <strong class="userinput"><code>Input</code></strong>). </p><p>Instead of using Unity logical inputs, it is also common to access the device directly through SDK components. Let's look into that in the  next section.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec70"></a>OpenVR trigger button</h3></div></div></div><p>If you have a VR device <span>supported</span><a id="id325567604" class="indexterm"></a> by OpenVR (HTC Vive, Oculus Rift, or Windows MR), let's modify the <code class="literal">ButtonTest</code> function to check for a pull and release of the trigger button.</p><p>To implement this, we need to provide our script with the specific input component that we want to query. In OpenVR, this is represented by the <code class="literal">SteamVR_TrackedObject</code> component, as shown in the following variation of our script:</p><pre class="programlisting">public class MyInputController : MonoBehaviour 
{
  public SteamVR_TrackedObject rightHand;

  private SteamVR_Controller.Device device;

  void Update () 
  {
    ButtonTest();
  }

  private void ButtonTest()
  {
    string msg = null;

    // SteamVR
    device = SteamVR_Controller.Input((int)rightHand.index);
    if (device != null &amp;&amp;  
      device.GetPressDown(SteamVR_Controller.ButtonMask.Trigger))
    {
      msg = "Trigger press";
      device.TriggerHapticPulse(700);
    }
    if (device != null &amp;&amp;  
      device.GetPressUp(SteamVR_Controller.ButtonMask.Trigger)) 
    {
      msg = "Trigger release";
    }

    if (msg != null)
      Debug.Log("Input: " + msg);
  }
}</pre><p>After saving this script, we need to populate the <code class="literal">rightHand</code> variable:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>In Unity, select <strong class="userinput"><code>MeMyselfEye</code></strong> so you can see the <strong class="userinput"><code>My Input Controller</code></strong> in the <strong class="userinput"><code>Inspector</code></strong></li><li>In the <strong class="userinput"><code>Hierarchy</code></strong>, unfold the <strong class="userinput"><code>[CameraRig]</code></strong> object</li><li>Click the <strong class="userinput"><code>Controller (Right)</code></strong> child object and drag it onto <span>the <strong class="userinput"><code>My Input Controller</code></strong>'s Right Hand slot</span> in the <strong class="userinput"><code>Inspector</code></strong></li></ol></div><p>Given the <code class="literal">rightHand</code> object, we reference its <code class="literal">SteamVR_TrackedObject</code> component directly. In the <code class="literal">ButtonTest</code> function, we get the <span class="emphasis"><em>device</em></span> data using the right hand's device ID (<code class="literal">rightHand.index</code>), and check specifically for the trigger press status. As a bonus, I've shown you how to also provide a haptic buzz pulse on the device when the trigger is pressed. </p><p>Now when you press <strong class="userinput"><code>Play</code></strong>, pulling the controller trigger will be recognized. </p><p>Using the SDK components like this, you can access other inputs specific to the device not supported by the Unity Input Manager. The trigger on some controllers are not just pressed/unpressed but can return a percentage of press, represented as a value between 0.0 and 1.0. Another example is the touch-sensitive grips, buttons, and thumb pad on the Oculus Touch controllers and other controllers.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip46"></a>Note</h3><p>Try modifying the script to recognize the controller <code class="literal">Grip</code> button instead, or other inputs. Hint: try <span class="emphasis"><em><span>SteamVR_Controller</span><span>.</span><span>ButtonMask</span><span>.</span></em></span><span><span class="emphasis"><em>Grip</em></span>.</span></p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec71"></a>Daydream controller clicks</h3></div></div></div><p>Google Daydream VR on Android may <span>not</span><a id="id325577651" class="indexterm"></a> respond, by default, to <code class="literal">Fire1</code> events. The following code shows how to access controller clicks directly:</p><pre class="programlisting">  private void ButtonTest()
  {
    string msg = null;

    if (GvrControllerInput.ClickButtonDown)
      msg = "Button down";
    if (GvrControllerInput.ClickButtonUp)
      msg = "Button up";

    if (msg != null)
      Debug.Log("Input: " + msg);
  }
}</pre><p>In this case, we call the <code class="literal">GvrControllerInput</code> class static functions <code class="literal">ClickButtonDown</code> and <code class="literal">ClickButtonUp</code>. There is no need to identify a specific controller object because <code class="literal">GvrControllerInput</code> is a <span class="emphasis"><em>singleton</em></span>. That is why we're guaranteed to have only one instance of it in the scene, so we can reference its data directly. This makes sense because on Daydream there will only be one hand controller, whereas on OpenVR there will be two.</p></div></div>