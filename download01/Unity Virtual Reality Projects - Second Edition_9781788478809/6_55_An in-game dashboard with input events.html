<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch06lvl1sec58"></a>An in-game dashboard with input events</h2></div></div><hr /></div><p>An in-game dashboard or <span>control</span><a id="id325317294" class="indexterm"></a> panel is a UI display that is integrated into the game itself. A typical scenario is an automobile or a spaceship, where you are seated in a cockpit. At waist level (desk level) is a panel with a set of controls, gauges, information displays, and so on. Dashboards generally feel more natural in a seated VR experience.</p><p>A few pages back, we discussed windshield HUDs. Dashboards are pretty much the same thing. One difference is that the dashboard may be more obviously part of the level environment and not simply an auxiliary information display or a menu.</p><p>In fact, dashboards can be a very effective mechanism to control VR motion sickness. Researchers have found that when a VR user has a better sense of being grounded and has a consistent <span class="emphasis"><em>horizon line</em></span> in view, he's much less likely to experience nausea while moving around a virtual space. In contrast, being a floating one-dimensional eyeball with no sense of self or grounding is asking <span>for</span><a id="id325552585" class="indexterm"></a> trouble! (See the <span class="emphasis"><em>Oculus Best Practices</em></span> for this, and other great tips, by visiting <a class="ulink" href="https://developer.oculus.com/documentation/intro-vr/latest/concepts/bp_intro/" target="_blank"><span>https://developer.oculus.com/documentation/intro-vr/latest/concepts/bp_intro/</span></a>).</p><p>In this example, we'll make a simple dashboard with Start/Stop buttons. For now, the buttons will operate a water hose in the scene to help fend off the zombies. (<span class="emphasis"><em>Why not?</em></span>) Like other examples in this chapter, this project uses the scene created in <a class="link" href="#" linkend="ch04">Chapter 4</a>, <span class="emphasis"><em>Gaze-Based Control</em></span>.</p><p>This project is a bit more complicated than you might expect. However, if you've ever had to build anything in Minecraft, you know that even the simple things may require assembling multiple parts. Here's what we will do:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc">Create a dashboard canvas with two functional buttons—Start and Stop</li><li style="list-style-type: disc">Add a water hose to the scene and wire it to the buttons</li><li style="list-style-type: disc">Write a simple version of the script that activates the buttons</li><li style="list-style-type: disc">Highlight a button by looking at it</li><li style="list-style-type: disc">Improve the script to activate the button only if it's highlighted</li></ul></div><p>So let's get to it.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec85"></a>Creating a dashboard with buttons</h3></div></div></div><p>First, let's create a dashboard <span>with</span><a id="id325563582" class="indexterm"></a> a Start and a Stop button, as follows:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>From the <strong class="userinput"><code>Project</code></strong> window, drag the <code class="literal">DefaultCanvas</code> prefab onto the <code class="literal">MeMyselfEye</code> object in the <strong class="userinput"><code>Hierarchy</code></strong> panel so that it becomes a child.</li><li>Rename it to <code class="literal">Dashboard</code>.</li><li>With <code class="literal">Dashboard</code> selected, set the <strong class="userinput"><code>Rect Transform</code></strong> component's <strong class="userinput"><code>Pos X</code></strong>, <strong class="userinput"><code>Pos Y</code></strong>, <strong class="userinput"><code>Pos Z</code></strong> to (<code class="literal">0</code>, <code class="literal">0.6</code>, <code class="literal">0.6</code>) and its <strong class="userinput"><code>Rotation</code></strong> to (<code class="literal">60</code>, <code class="literal">0</code>, <code class="literal">0</code>). Feel free to adjust the position for preferred comfort zone and your specific VR device camera rig.</li><li>Disable or delete the <strong class="userinput"><code>Text</code></strong> child object of <code class="literal">Dashboard</code>.</li></ol></div><p>This places the dashboard 1 m below your eyes and a little out in front.</p><p>For a <span class="emphasis"><em>work-in-progress</em></span> look, if you'd like, I've included an image sketch of a vehicle dashboard that you can use, as follows:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Import the <code class="literal">DashboardSketch.png</code> file into your <strong class="userinput"><code>Project</code></strong> (such as the <code class="literal">Assets/Textures</code> folder).</li><li>Add a new <strong class="userinput"><code>GameObject</code></strong> | <strong class="userinput"><code>UI</code></strong> | <strong class="userinput"><code>Raw Image</code></strong> as a child of <code class="literal">Dashboard</code>.</li><li>Drag the <code class="literal">DashboardSketch</code> texture from the <strong class="userinput"><code>Project</code></strong> panel onto the <strong class="userinput"><code>Texture</code></strong> field of the <strong class="userinput"><code>Raw Image</code></strong> component.</li><li>Set its <strong class="userinput"><code>Rect Transform</code></strong> component's <strong class="userinput"><code>Pos X</code></strong>, <strong class="userinput"><code>Pos Y</code></strong>, <strong class="userinput"><code>Pos Z</code></strong> to (<code class="literal">0</code>,<code class="literal">0</code>,<code class="literal">0</code>), <strong class="userinput"><code>Width</code></strong> to <code class="literal">140</code>, and <strong class="userinput"><code>Height</code></strong> to <code class="literal">105</code>.</li><li>It should be <strong class="userinput"><code>Anchored</code></strong> at <strong class="userinput"><code>middle</code></strong>-<strong class="userinput"><code>center</code></strong> (<code class="literal">0.5</code>,<code class="literal">0.5</code>) in <strong class="userinput"><code>X</code></strong>, <strong class="userinput"><code>Y</code></strong>, and <strong class="userinput"><code>Pivot</code></strong>, with <strong class="userinput"><code>Rotation</code></strong> (<code class="literal">0</code>,<code class="literal">0</code>,<code class="literal">0</code>).</li><li>Set <strong class="userinput"><code>Scale</code></strong> to (<code class="literal">4.5</code>,<code class="literal">4.5</code>,<code class="literal">4.5</code>).</li></ol></div><p>Next, we will add the Start and Stop buttons. They can go anywhere you'd like on the canvas, but the sketch has two nice spaces predefined for them:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Add a new <strong class="userinput"><code>GameObject</code></strong> | <strong class="userinput"><code>UI</code></strong> | <strong class="userinput"><code>Button</code></strong> as a new child of <code class="literal">Dashboard</code>. Name it <code class="literal">StartButton</code>.</li><li>Set its <strong class="userinput"><code>Rect Transform</code></strong> component's <strong class="userinput"><code>X</code></strong>, <strong class="userinput"><code>Y</code></strong>, <strong class="userinput"><code>Z</code></strong> to (<code class="literal">-48</code>, <code class="literal">117</code>, <code class="literal">0</code>), the <strong class="userinput"><code>Width </code></strong>and <strong class="userinput"><code>Height</code></strong> to (<code class="literal">60</code>, <code class="literal">60</code>), and <strong class="userinput"><code>Anchored</code></strong> to <strong class="userinput"><code>center</code></strong>-<strong class="userinput"><code>middle</code></strong> (<code class="literal">0.5</code>). No <strong class="userinput"><code>Rotation</code></strong> and <strong class="userinput"><code>Scale</code></strong> of <code class="literal">1</code>.</li><li>In the button's <strong class="userinput"><code>Image (Script)</code></strong> component pane, for <strong class="userinput"><code>Source Image</code></strong>, click on the tiny circle on the far right to open the <strong class="userinput"><code>Select Sprite</code></strong> picker and choose <code class="literal">ButtonAcceleratorUpSprite</code> (which you may have imported into the <code class="literal">Assets/Standard Assets/CrossPlatformInput/Sprites</code> folder).</li><li>In the button's <strong class="userinput"><code>Button (Script)</code></strong> component pane, for the <strong class="userinput"><code>Normal Color</code></strong>, I used RGB (<code class="literal">89</code>,<code class="literal">154</code>,<code class="literal">43</code>) and set <strong class="userinput"><code>Highlighted Color</code></strong> to (<code class="literal">105</code>, <code class="literal">255</code>, <code class="literal">0</code>).</li><li>Similarly, create another button named <code class="literal">StopButton</code> with the <strong class="userinput"><code>Rect Transform</code></strong> component's <strong class="userinput"><code>X</code></strong>, <strong class="userinput"><code>Y</code></strong>, <strong class="userinput"><code>Z</code></strong> (<code class="literal">52</code>, <code class="literal">118</code>, <code class="literal">0</code>) and set the <strong class="userinput"><code>Width</code></strong> and<strong class="userinput"><code> </code></strong><strong class="userinput"><code>Height</code></strong> to (<code class="literal">60</code>, <code class="literal">60</code>). For <strong class="userinput"><code>Source Image</code></strong>, select <code class="literal">ButtonBrakeOverSprite</code>, then choose the <strong class="userinput"><code>Normal Color</code></strong> (<code class="literal">236</code>, <code class="literal">141</code>, <code class="literal">141</code>) and <strong class="userinput"><code>Highlighted Color</code></strong> (<code class="literal">235</code>, <code class="literal">45</code>, <code class="literal">0</code>).</li></ol></div><p>The result should look like this:</p><div class="mediaobject"><img src="/graphics/9781788478809/graphics/141eefa1-9396-457b-90c6-0536d3d57a73.png" /></div><p></p><p>One last thing. If you're using the <code class="literal">ReticleCursor</code> that was created earlier in this chapter with the <code class="literal">CursorPositioner.cs</code> script, we want the dashboard itself to have a collider for the script. We can achieve this by performing the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>With <code class="literal">Dashboard</code> selected, right-click for options, and navigate to<strong class="userinput"><code>3D Object</code></strong> | <strong class="userinput"><code>Plane</code></strong>.</li><li>Set its <strong class="userinput"><code>Position</code></strong> to (<code class="literal">0</code>,<code class="literal">0</code>,<code class="literal">0</code>), <strong class="userinput"><code>Rotation</code></strong> to (<code class="literal">270</code>,<code class="literal">0</code>,<code class="literal">0</code>), and <strong class="userinput"><code>Scale</code></strong> to (<code class="literal">64</code>,<code class="literal">1</code>,<code class="literal">48</code>).</li><li>Disable its <strong class="userinput"><code>Mesh Renderer</code></strong> (but leave its <strong class="userinput"><code>Mesh Collider</code></strong> enabled).</li></ol></div><p>Now the dashboard has a plane child that isn't rendered, but its collider will be detected when <code class="literal">CursorPositioner</code> does its ray cast. We do this to see your gaze on this dashboard panel rather than the ground below even when not looking directly at a button.</p><p>Having a single toggle button <span>with</span><a id="id325577757" class="indexterm"></a> pressed and released states might be better than separate <strong class="userinput"><code>Start</code></strong> and <strong class="userinput"><code>Stop</code></strong> buttons. When you're done with this chapter, go ahead and figure out how to do it!</p><p>We just created a world space canvas that should appear in VR at waist or desk level. We decorated it with a dashboard sketch and added two UI buttons. Now, we'll wire up the buttons to specific events.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec86"></a>Linking the water hose to the buttons</h3></div></div></div><p>Let's first give the buttons something to do, such <span>as</span><a id="id325577781" class="indexterm"></a> the action of turning on a water hose. If we aim it strategically, it might even fend off rogue zombies. Coincidentally, the Unity <strong class="userinput"><code>Particle Systems</code></strong> under <strong class="userinput"><code>Standard Assets</code></strong> which we imported earlier has a water hose that we can use. Add it to the scene as follows:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>If you haven't done so already, import the <strong class="userinput"><code>Particle Systems</code></strong> standard asset from the main menu bar by navigating to <strong class="userinput"><code>Assets</code></strong> | <strong class="userinput"><code>Import Package</code></strong> | <strong class="userinput"><code>ParticleSystems</code></strong>.</li><li>In the <strong class="userinput"><code>Project</code></strong> window, find the <code class="literal">Assets/Standard Assets/Particle Systems/Prefabs/Hose</code> prefab and drag it into the <strong class="userinput"><code>Hierarchy</code></strong> window.</li><li>Set its <strong class="userinput"><code>Transform</code></strong> component's <strong class="userinput"><code>X</code></strong>, <strong class="userinput"><code>Y</code></strong>, <strong class="userinput"><code>Z</code></strong> to (<code class="literal">-3</code>, <code class="literal">0</code>, <code class="literal">1.5</code>) and <strong class="userinput"><code>Rotation</code></strong> to (<code class="literal">340</code>, <code class="literal">87</code>, <code class="literal">0</code>).</li><li>Ensure that <strong class="userinput"><code>Hose</code></strong> is enabled (check its <strong class="userinput"><code>Enable</code></strong> checkbox).</li><li>Unfold the <strong class="userinput"><code>Hose</code></strong> in <strong class="userinput"><code>Hierarchy</code></strong> so that you can see its child <strong class="userinput"><code>WaterShower</code></strong> particle system. Select it.</li><li>In <strong class="userinput"><code>Inspector</code></strong>, in the <strong class="userinput"><code>Particle System</code></strong> properties pane, look for <strong class="userinput"><code>Play On Awake</code></strong> and uncheck it.</li></ol></div><p>Note that the <strong class="userinput"><code>Hose</code></strong> object in <strong class="userinput"><code>Hierarchy</code></strong> has a <code class="literal">WaterShower</code> child object. This is the actual particle system that we will control with the buttons. It should start as <span class="emphasis"><em>off</em></span>.</p><p>The <strong class="userinput"><code>Hose</code></strong> prefab itself comes with mouse-driven script that we don't want to use,
so disable it as follows:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>With <strong class="userinput"><code>Hose</code></strong> selected, disable (uncheck) its <strong class="userinput"><code>Hose</code></strong> (<strong class="userinput"><code>Script</code></strong>).</li><li>Also, disable (uncheck) the <strong class="userinput"><code>Simple Mouse Rotator</code></strong> (<strong class="userinput"><code>Script</code></strong>) component.</li></ol></div><p>Now we will wire up <code class="literal">StartButton</code> to the <strong class="userinput"><code>WaterShower</code></strong> particle system by telling the buttons to listen for the <code class="literal">OnClick()</code> events, as follows:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Unfold the <strong class="userinput"><code>Hose</code></strong> in <strong class="userinput"><code>Hierarchy</code></strong> so that you can see its child <strong class="userinput"><code>WaterShower</code></strong> particle system.</li><li>In <strong class="userinput"><code>Hierarchy</code></strong>, select <code class="literal">StartButton</code> (under <code class="literal">MeMyselfEye/Dashboard</code>).</li><li>Note that in the <strong class="userinput"><code>Inspector,</code></strong> the <strong class="userinput"><code>On Click()</code></strong> pane of the <code class="literal">Button</code> component is empty. Click on the <span class="emphasis"><em>Plus</em></span> (<strong class="userinput"><code>+</code></strong>) icon on the lower right of that pane to reveal a new field labeled <strong class="userinput"><code>None</code></strong> (<strong class="userinput"><code>Object</code></strong>).</li><li>Drag the <strong class="userinput"><code>WaterShower</code></strong> particle system from <strong class="userinput"><code>Hierarchy</code></strong> onto the <strong class="userinput"><code>None (Object)</code></strong> field.</li><li>Its function selector, the default value, is <strong class="userinput"><code>No Function</code></strong>. Change it to <strong class="userinput"><code>ParticleSystem</code></strong> | <strong class="userinput"><code>Play()</code></strong>.</li></ol></div><p>OK. The steps are similar for the <code class="literal">StopButton</code>, as follows:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>In <strong class="userinput"><code>Hierarchy</code></strong>, select <code class="literal">StopButton</code>.</li><li>Click on the <span class="emphasis"><em>Plus</em></span> (<strong class="userinput"><code>+</code></strong>) icon on the lower right of it's <strong class="userinput"><code>On Click()</code></strong> pane.</li><li>Drag the <strong class="userinput"><code>WaterShower</code></strong> from <strong class="userinput"><code>Hierarchy</code></strong> onto the <strong class="userinput"><code>None</code></strong> (<strong class="userinput"><code>Object</code></strong>) field.</li><li>Its function selector, the default value, is <strong class="userinput"><code>No Function</code></strong>. Change it to <strong class="userinput"><code>ParticleSystem</code></strong> | <strong class="userinput"><code>Stop()</code></strong>.</li></ol></div><p>The Start and Stop buttons <span class="emphasis"><em>listen for</em></span><code class="literal">OnClick()</code><span class="emphasis"><em>events</em></span>, and when one comes, it will
call the <strong class="userinput"><code>WaterShower</code></strong> particle system's <code class="literal">Play()</code> and <code class="literal">Stop()</code> functions respectively. To make it work, we need to press the buttons.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec87"></a>Activating buttons from the script</h3></div></div></div><p>Before we give the user a <span>way</span><a id="id325552998" class="indexterm"></a> to press the buttons, let's see how we can do this from a script. Create a new script on <code class="literal">GameController</code>, as follows:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>With <code class="literal">GameController</code> selected in Hierarchy, press <strong class="userinput"><code>Add Component</code></strong> | <strong class="userinput"><code>New Script</code></strong> to create a script named <code class="literal">ButtonExecuteTest</code>.</li><li>Open the script in MonoDevelop.</li></ol></div><p>In the following script, we turn the hose on and off in five-second intervals, as follows:</p><pre class="programlisting">using UnityEngine; 
using UnityEngine.UI; 
 
public class ButtonExecuteTest : MonoBehaviour 
{ 
  public Button startButton;
  public Button stopButton;
 
  private bool isOn = false; 
  private float timer = 5.0f; 
  
  void Update () 
  { 
    timer -= Time.deltaTime; 
    if (timer &lt; 0.0f) 
    { 
      isOn = !isOn; 
      timer = 5.0f; 
 
      if (isOn) 
      { 
        stopButton.onClick.Invoke(); 
      } else 
      { 
        startButton.onClick.Invoke(); 
      } 
    } 
  } 
} </pre><p>The script manages a Boolean <code class="literal">isOn</code> value, which says if the hose is on or off. And it has a timer which counts down from 5 seconds on each update. We use the <code class="literal">private</code> keyword for variables that are only used within this script, whereas the <code class="literal">public</code> ones can be viewed and modified via the Unity editor and other scripts. For <code class="literal">startButton</code> and <code class="literal">stopButton</code>,  you'll drag and drop them in the Unity editor.</p><p>In this script, we use the <code class="literal">UnityEngine.UI</code>. As we saw in the previous chapter, <span class="emphasis"><em>Events</em></span> are a way for different components to talk to one another. When an event occurs, such as a button press, a function in another script may get called. In our case, we're going to trigger an event corresponding to the start button press, and another corresponding to the stop button press, as we set up in the Inspector.</p><p>Save the script and click on <strong class="userinput"><code>Play</code></strong>. The hose should turn on and off every five seconds.</p><p>Now that we have tested the event system connection between the button clicks and the hose, we can disable this script before moving on to the next one:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>With <code class="literal">GameController</code> <span>selected,</span></li><li>Disable the <code class="literal">ButtonExecuteTest</code> component by unchecking its <strong class="userinput"><code>Enable</code></strong> checkbox, or remove the component.</li></ol></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip68"></a>Note</h3><p>Breaking down a complex feature into bite-sized pieces and testing them separately is an excellent implementation strategy.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec88"></a>Look to highlight a button</h3></div></div></div><p>Meanwhile, let's detect when the user is <span>looking</span><a id="id325553146" class="indexterm"></a> at a button and highlight it. Although <strong class="userinput"><code>Button</code></strong> is a Unity UI object, it needs to be detected with a ray cast. There may be other ways to accomplish this, as discussed later in this chapter, but here we will add a game object sphere to each button and cast a ray to detect it. First, add the spheres by performing the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>In the <strong class="userinput"><code>Hierarchy</code></strong> panel, select <code class="literal">StartButton</code> (under <code class="literal">MeMyselfEye/Dashboard</code>), right-click for options, and navigate to <strong class="userinput"><code>3D Object</code></strong> | <strong class="userinput"><code>Sphere</code></strong>.</li><li>Set its <strong class="userinput"><code>Transform</code></strong> component's <strong class="userinput"><code>Scale</code></strong> to (<code class="literal">52</code>, <code class="literal">52</code>, <code class="literal">52</code>) so that it fits the
button size.</li><li>Disable the sphere's <strong class="userinput"><code>Mesh Renderer</code></strong>by unchecking the<strong class="userinput"><code>Mesh Renderer</code></strong>checkbox.</li></ol></div><p>Also, repeat these steps for <code class="literal">StopButton</code>. A shortcut is to duplicate the sphere, as follows:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Right-click the Sphere and choose <strong class="userinput"><code>Duplicate</code></strong>.</li><li>Drag the duplicated item (<code class="literal">Sphere (1)</code>) into <code class="literal">StopButton</code>.</li><li>Reset it <strong class="userinput"><code>Position</code></strong> to (<code class="literal">0</code>,<code class="literal">0</code>,<code class="literal">0</code>).</li></ol></div><p>Now, create a new script on <code class="literal">StartButton</code>, as follows:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>With <code class="literal">StartButton</code>selected, navigate to<strong class="userinput"><code>Add Component</code></strong> | <strong class="userinput"><code>New Script</code></strong>to create a script named<code class="literal">RespondToGaze</code>.</li><li>Open the script for editing.</li></ol></div><p>In the following <code class="literal">RespondToGaze.cs</code> script, we tell the button to become highlighted when you look at it, using the child Sphere object's collider:</p><pre class="programlisting">using UnityEngine; 
using UnityEngine.UI; 
 
public class RespondtoGaze : MonoBehaviour 
{ 
  public bool highlight = true;
  private Button button; 
  private bool isSelected;

  void Start ()
  {
    button = GetComponent&lt;Button&gt;();
  }
 
  void Update () 
  { 
    isSelected = false;
    Transform camera = Camera.main.transform; 
    Ray ray = new Ray(camera.position, camera.rotation * Vector3.forward); 
    RaycastHit hit; 
    if (Physics.Raycast (ray, out hit) &amp;&amp;
        (hit.transform.parent != null) &amp;&amp;
        (hit.transform.parent.gameObject == gameObject) 
    { 
      isSelected = true;
    } 

    if (isSelected)
    {
      if (highlight)
        button.Select();
    }
    else {
      UnityEngine.EventSystems.EventSystem.current.SetSelectedGameObject(null);
    }
  } 
}</pre><p>In this script, on each update, we cast a ray from the camera. If it hits this button's sphere collider, then the hit object's parent should be this button. So (after checking that the hit object has a parent), we compare the parent gameObject to this button's gameObject.</p><p>If the gaze has selected this button, we trigger the button's <strong class="userinput"><code>Select</code></strong> to make it highlight. The highlighting is done within Unity's <code class="literal">EventSystem</code>. While the EventSystem has all this implemented for mouse clicks and screen touches, we have to manually tell the button it's been selected by calling <code class="literal">button.Select()</code>.</p><p>Unhighlighting the button is not so obvious. The EventSystem maintains a currently selected object across your runtime scene. We clear it by passing null to <code class="literal">SetSelectedGameObject()</code>.</p><p>Save the script and <span class="emphasis"><em>Play</em></span>. When you gaze at a button, it should highlight, and when you gaze away from it, it should remove the highlight.</p><p>This is also an example of a reusable component script. We just wrote and tested it for the StartButton. We can use the same script for the StopButton:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Select the <strong class="userinput"><code>StopButton</code></strong> from the <strong class="userinput"><code>Hierarchy</code></strong>.</li><li>Drag the <strong class="userinput"><code>RespondToGaze</code></strong> script from the <strong class="userinput"><code>Project Assets</code></strong><span>onto the button, or</span></li><li>Select <strong class="userinput"><code>Add Component</code></strong> | <strong class="userinput"><code>Scripts</code></strong> | <strong class="userinput"><code>RespondToGaze</code></strong>.</li></ol></div><p>Test the project one more time. Both buttons should highlight when you gaze at them.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note69"></a>Note</h3><p>If you are using  Google VR for Cardboard or Daydream, you can include the <code class="literal">GvrEventSystem</code> prefab in your scene. Then this <code class="literal">RespondToGaze</code> script becomes unnecessary and redundant. The <code class="literal">Daydream</code> component already supports gaze-based select, highlight, and clicking with the input controller. But I encourage you to follow along with this project nonetheless to experience how this functionality can be implemented. <span>If so</span>, temporarily disable <code class="literal">GvrEventSystem</code> in your scene.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec89"></a>Looking and then clicking to select</h3></div></div></div><p>To be a functional dashboard, the buttons <span>should</span><a id="id325592435" class="indexterm"></a> operate <span>when</span><a id="id325592478" class="indexterm"></a> they're clicked. In <a class="link" href="#" linkend="ch05">Chapter 5</a>, <span class="emphasis"><em>Handy Interactables</em></span>, we explored the Unity Input system, including the <code class="literal">"Fire1"</code> event and other hand controller buttons. You may want to review that now. And choose which code snippet you want to use, if not the basic <code class="literal">Input.GetButtonDown("Fire1")</code>.</p><p>The changes to make to the <code class="literal">RespondToGaze.cs</code> script are pretty simple. At top of the class, add the following public variables:</p><pre class="programlisting">public bool clicker = true;
public string inputButton = "Fire1";</pre><p> At the bottom of <code class="literal">Update()</code>, make the following changes:</p><pre class="programlisting">  ... 
  if (isSelected)
  {
    if (highlight)
        button.Select();
    if (clicker &amp;&amp; InputGetButtonDown("Fire1"))
        button.onClick.Invoke();
  }</pre><p>When the controller <code class="literal">"Fire1"</code> button is pressed, it will trigger a click of the UI button.</p><p>The component gives you the option to enable highlights and/or clicking with the input controller. You can also choose the logical input button that will trigger the click events.</p><p>We now have an in-game dashboard with buttons that respond to user input, which controls the behavior of an object (water hose) in the scene.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec90"></a>Looking and starting to select</h3></div></div></div><p>Instead of using a clicker, we <span>can</span><a id="id325592537" class="indexterm"></a> use a time-based selection to click on the button. To make this work, we'll keep a countdown timer while staring at a button, much like the one that we used to kill Ethan in the previous chapter.</p><p>Change the <code class="literal">RespondToGaze.cs</code> script. At top of the class, add the following variables:</p><pre class="programlisting">public bool timedClick = true;
public float delay = 2.0f;

private float timer = 0f;</pre><p>In <code class="literal">Update()</code>, make the following changes:</p><pre class="programlisting">... 
  if (isSelected)
  {
    if (highlight)
        button.Select();
    if (clicker &amp;&amp; Input.GetButtonDown("Fire1"))
        button.onClick.Invoke();
    if (timedClick) 
    {
      timer += Time.deltaTime;
      if (timer &gt;= delay)
        button.onClick.Invoke();
  }
  else {
    UnityEngine.EventSystems.EventSystem.current.SetSelectedGameObject(null);
    timer = 0f;
  }</pre><p>Now, not only will a button click get involved on <code class="literal">Input.GetButtonDown</code>, <span>but also if you gaze at the button long enough (when <code class="literal">timedClick</code> is <code class="literal">true</code>)</span>. We begin a timer when the button is selected (highlighted) and count up. When the timer expires the click event is invoked. If the button is deselected before then, the timer is reset to zero.</p><p><span class="emphasis"><em>Does it work for you? Woohoo!</em></span></p><p>So this was a relatively complex project. The goal was to create a dashboard with buttons that turn a hose on and off. We broke it down into discrete steps, added the objects and components a step at a time, and tested each step to make sure that it worked as expected before moving on. If you tried to implement this all at once or blew through it without testing, things can (and will) go wrong, and it'll be much harder to figure out where the problem cropped up.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note70"></a>Note</h3><p>Extra challenge: This feature can be further enhanced for different purposes. For example, it can be used to give the user the information that the countdown is running, perhaps by animating a spinner cursor. Also, further feedback can be given when the click event is executed. For example, the Button UI object has a Transition option called Animation that might be helpful. Also, consider audio cues.</p></div></div></div>