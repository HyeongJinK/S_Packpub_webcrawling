<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch05lvl1sec47"></a>Really using your hands</h2></div></div><hr /></div><p>The last couple of things we'll <span>explore</span><a id="id325317266" class="indexterm"></a> in the chapter involve getting your hands even more into virtual reality. In addition to buttons and touch pads, VR hand controllers can be tracked in 3D space along with your head. PC- and console-based VR, such as Rift, Vive, MR, and PSVR, are really very good at this, with full positionally tracked hand controllers for both left and right hands. Lower-end mobile VR, such as Daydream, has a single hand controller with limited tracking, but better than nothing.</p><p>To start, we'll take advantage of positional tracking by simply parenting the balloon to your hand model. On VR, without actual positional tracking, like Daydream, the location of your hand controller is approximated by the SDK software, but useful enough.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec81"></a>Parenting balloons to your hand</h3></div></div></div><p>Suppose when you press the button, rather <span>than</span><a id="id325317283" class="indexterm"></a> creating the new balloon at a fixed position in space, it spawns and grows from your hand position. One way to accomplish this is to make the balloon instance a child of your hand controller object.</p><p>The BalloonController will need to know which hand pressed the button and parent the balloon to that controller object. Specifically, we'll pass the hand Game Object to the <code class="literal">NewBalloon</code> function as follows:</p><pre class="programlisting">public void NewBalloon(GameObject parentHand)
{
  if (balloon == null)
  {
    balloon = Instantiate(balloonPrefab);
    balloon.transform.SetParent(parentHand.transform);
    balloon.transform.localPosition = Vector3.zero;
  }
}</pre><p>Note that in this function we added an extra test for (<code class="literal">balloon == null</code>), just to make sure we haven't called <code class="literal">NewBalloon</code> twice in a row without releasing the first one yet.</p><p>Like before, we instantiate a new balloon from the prefab.</p><p>Then, we set its parent to the <code class="literal">parentHand</code> object. This is comparable to dragging one object to become a child of another in the Hierarchy. The parent-child relationships between game objects are handled by the built-in <span class="emphasis"><em>Transform</em></span> component so the API functions are on the transform.</p><p>Lastly, we reset the local position of the balloon. If you recall, the prefab was positioned at (0, 1, 1) or something like that. As a child of the hand, we want it attached directly at the pivot point of the hand model. (Alternatively, you could offset the balloon origin to a different attachment point as needed.)</p><p>Worth noting, there are variations of the <span class="emphasis"><em>Instantiate</em></span> function <span>that</span><a id="id325549816" class="indexterm"></a> let you specify the parent and transforms all in one call. See <a class="ulink" href="https://docs.unity3d.com/ScriptReference/Object.Instantiate.html" target="_blank">https://docs.unity3d.com/ScriptReference/Object.Instantiate.html</a> .</p><p>Likewise, the <code class="literal">ReleaseBalloon</code> detaches the balloon from the hand before send it on its way, as follows:</p><pre class="programlisting"> public void ReleaseBalloon()
 {
   if (balloon != null)
   {
     balloon.transform.parent = null;
     balloon.GetComponent&lt;Rigidbody&gt;().AddForce(Vector3.up * floatStrength);
   }
   balloon = null;
 }</pre><p>How do we pass the hand game object to NewBalloon? Assuming your project is presently using the Unity Events we setup in the previous topic, it's very easy. In <strong class="userinput"><code>Inspector</code></strong> we need to update the <strong class="userinput"><code>Button Down Event</code></strong> function, since it now requires the game object argument:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>In Unity editor, select the <strong class="userinput"><code>MeMyselfEye</code></strong> object</li><li>In the <strong class="userinput"><code>Button Down Event</code></strong> list, the function may now say something like <code class="literal">Missing BalloonController.NewBalloon</code></li><li>Select the <strong class="userinput"><code>function</code></strong> dropdown and choose <strong class="userinput"><code>BalloonController</code></strong> | <strong class="userinput"><code>NewBalloon(GameObject)</code></strong></li></ol></div><p> </p><div class="orderedlist"><ol class="orderedlist arabic" start="4" type="1"><li>Unfold the <strong class="userinput"><code>MeMyselfEye</code></strong> object in <strong class="userinput"><code>Hierarchy</code></strong> and look for the hand model, then drag it onto the empty Game Object slot</li><li>If you are using OpenVR, the hand will be called <strong class="userinput"><code>Controller (right)</code></strong></li><li>If you are using Daydream, the hand will be called <strong class="userinput"><code>GvrControllerPointer</code></strong></li></ol></div><p>Here is a screenshot of me generating a bunch of balloons flying "over" the Grand Canyon, fun!</p><div class="mediaobject"><img src="/graphics/9781788478809/graphics/3accbded-7e34-4c03-bf76-32a0833f45de.png" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec82"></a>Popping balloons</h3></div></div></div><p>To be honest, it's really hard to think <span>about</span><a id="id325563594" class="indexterm"></a> creating balloons without also wanting to pop them! For fun, let's do a quick implementation. You can come up with your own ideas how to improve on it.</p><p>The Unity physics engine can detect when two object collide. To do this, each object must have a <span class="emphasis"><em>Collider</em></span> component attached. You can then have the collision trigger an event. And we can subscribe that event to make something else happen, like play an explosion effect. This gets set up on the balloon prefab. So when two balloons collide, they'll explode. Let's do that:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Drag a copy of your Balloon prefab from Project <code class="literal">Assets prefabs</code> folder into the scene <strong class="userinput"><code>Hierarchy</code></strong><span class="strong"><strong>.</strong></span></li><li>Select <strong class="userinput"><code>Add Component</code></strong> | <strong class="userinput"><code>Physics</code></strong> | <strong class="userinput"><code>Sphere Collider</code></strong>.</li><li>To scale and center the collider into position, click the <strong class="userinput"><code>Edit Collider</code></strong> icon in its component.</li><li>In the <span class="strong"><strong>Scene</strong></span> window, the green collider outline has small anchor points you can click to edit. Note that the <span class="emphasis"><em>Alt</em></span> key pins the center position and <span class="emphasis"><em>Shift</em></span> locks the scale ratio.</li><li>Or, you can edit the <span class="strong"><strong><strong class="userinput"><code>Center</code></strong></strong></span> and <strong class="userinput"><code>Radius</code></strong> values directly. I like <strong class="userinput"><code>Radius</code></strong> 0.25 and <strong class="userinput"><code>Center</code></strong> (0, 0.25, 0) on my balloon.</li></ol></div><p>Now, we will add a script to handle the collision events. </p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><strong class="userinput"><code>Add Component</code></strong> to create a new C# script,</li><li>Name it <code class="literal">Poppable</code></li><li>And open it for editing</li></ol></div><p>The <strong class="userinput"><code><code class="literal">Poppable</code></code></strong> script will provide a callback function for <code class="literal">OnCollisionEnter</code> events. When another object with a collider enters this object's collider, our function will get called. At that point, we'll call <code class="literal">PopBalloon</code> which instantiates the explosion and destroys the balloon:</p><pre class="programlisting">public class Poppable : MonoBehaviour
{
 public GameObject popEffect;

 void OnCollisionEnter(Collision collision)
 {
   PopBalloon();
 }

 private void PopBalloon()
 {
   Instantiate(popEffect, transform.position, transform.rotation);
   Destroy(gameObject);
 }
}</pre><p>You can see that the <code class="literal">OnCollisionEnter</code> gets a <code class="literal">Collision</code> argument with information including what game object collided with it. We will ignore this here but you might explore it more: <a class="ulink" href="https://docs.unity3d.com/ScriptReference/Collision.html" target="_blank">https://docs.unity3d.com/ScriptReference/Collision.html</a>.</p><p>Save the script. Now, back in Unity:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Select a particle system prefab from <span class="strong"><strong>Project</strong></span> Assets, such as <code class="literal">Assets/Standard Assets/ParticleSystems/Prefabs/Explosion</code> (this is the one we used to kill Ethan in <a class="link" href="#" linkend="ch04">Chapter 4</a>, <span class="emphasis"><em>Gaze-Based Control</em></span>)</li><li>Drag the <strong class="userinput"><code>effects</code></strong> prefab onto the Poppable's <code class="literal">Pop Effect</code> slot</li><li>Save these changes back to the prefab by pressing <strong class="userinput"><code>Apply</code></strong></li><li>You can now delete the <strong class="userinput"><code><span class="strong"><strong>Balloon</strong></span></code></strong> from the <strong class="userinput"><code>Hierarchy</code></strong></li></ol></div><p>Alright, let's try it. Press <strong class="userinput"><code>Play</code></strong>. Create a balloon. Then, reach out and push the button again so a new balloon collides with that one. Does it explode? Yikes!</p></div></div>