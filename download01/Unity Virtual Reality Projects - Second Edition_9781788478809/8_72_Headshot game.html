<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch08lvl1sec73"></a>Headshot game</h2></div></div><hr /></div><p>Wouldn't it be fun to actually play <span>with</span><a id="id325317266" class="indexterm"></a> these bouncy balls? Let's make a game where you aim the ball at a target using headshots. For this game, balls drop one at a time from above and bounce off your forehead (face), aiming for a target.</p><p>The feature we'll implement here is, when a ball drops from above your head, you bounce it off your face and aim for a target.</p><p>To implement this, create a cube as a child of the camera object (much like we did for the reticle cursor in <a class="link" href="#" linkend="ch06">Chapter 6</a>, <span class="emphasis"><em>World Space UI</em></span>).  This provides a collider parented by the VR camera, so our head pose will move the face of the cube. I decided a cube-shaped collider will be better for this game than a sphere or capsule because it provides a flat face that will make the bounce direction more predictable. Balls will drop out of the sky. For a target, we'll use a flattened cylinder. We'll add audio cues to indicate when a new ball has been released and when a ball hits the target.</p><p>Create a new scene or, more simple, start here by doing a Save As, and implement the head as follows:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Navigate to <strong class="userinput"><code>File</code></strong> | <strong class="userinput"><code>Save Scene As</code></strong> and name it <code class="literal">BallGame</code></li><li>Delete the <code class="literal">BallsFromHeaven</code> script component attached to <code class="literal">GameController</code> using the <span class="emphasis"><em>gear</em></span> icon <strong class="userinput"><code>Remove Component</code></strong>. We won't need it</li><li>In <strong class="userinput"><code>Hierarchy</code></strong>, unfold <code class="literal">MeMyselfEye</code>, drilling down to the<strong class="userinput"><code> </code></strong><code class="literal">Camera</code> object and selecting it (for OpenVR that might be  <code class="literal">[CameraRig]/Camera (head)</code>; for Daydream, it may be  <code class="literal">Player/Main Camera/</code>)</li><li>Create a new <strong class="userinput"><code>3D Object</code></strong> | <strong class="userinput"><code>Cube</code></strong></li><li>With <code class="literal">GameController</code> selected, navigate to <strong class="userinput"><code>Add Component</code></strong> | <strong class="userinput"><code>Audio</code></strong> | <strong class="userinput"><code>Audio Source</code></strong></li><li>Click on the small <span class="emphasis"><em>circle-shaped</em></span> icon on the far right of the <strong class="userinput"><code>AudioClip</code></strong> field of <strong class="userinput"><code>Audio Source</code></strong> to open the <strong class="userinput"><code>Select AudioClip</code></strong> dialog box and choose the clip named <code class="literal">Jump</code></li><li>With <code class="literal">GameController</code> selected, navigate to <strong class="userinput"><code>Add Component</code></strong> | <strong class="userinput"><code>New Script</code></strong>, name it <code class="literal">BallGame</code>, and open it for editing</li></ol></div><p>You can decide to disable the cube's <strong class="userinput"><code>Mesh Renderer</code></strong>, but I think it's cool to watch it in the Scene window as you play. Since the camera is inside the cube, the player will not see it (since only the outward facing surfaces are rendered in the game view).</p><p>We'll play the <code class="literal">Jump</code> sound clip (provided with the <code class="literal">Characters</code> package of Unity's <strong class="userinput"><code>Standard Assets</code></strong>) to indicate when a new ball is dropped. You might try another, perhaps more interesting, effect.</p><p>Here's the <code class="literal">BallGame.cs</code> script. It looks a lot like the <code class="literal">BallsFromHeaven</code> one with just a few differences:</p><pre class="programlisting">using UnityEngine;

public class BallGame : MonoBehaviour 
{
    public Transform dropPoint;
    public float startHeight = 10f;
    public float interval = 3f;

    private float nextBallTime = 0f;
    private ObjectPooler pool;
    private GameObject activeBall;
    private AudioSource soundEffect;

    void Start()
    {
        if (dropPoint == null)
        {
            dropPoint = Camera.main.transform;
        }
        soundEffect = GetComponent&lt;AudioSource&gt;();
        pool = GetComponent&lt;ObjectPooler&gt;();
    }

    void Update()
    {
        if (Time.time &gt; nextBallTime)
        {
            nextBallTime = Time.time + interval;
            soundEffect.Play();
            Vector3 position = new Vector3(
                dropPoint.position.x, 
                startHeight, 
                dropPoint.position.z);

            activeBall = pool.GetPooledObject();
            activeBall.transform.position = position;
            activeBall.transform.rotation = Quaternion.identity;
            activeBall.GetComponent&lt;RigidBody&gt;().velocity = Vector3.zero;
            activeBall.SetActive(true);
        }
    }
} </pre><p>We instantiate a new ball every 3 seconds ( <code class="literal">interval</code> ) from a <code class="literal">startHeight</code> position above the current head position. </p><p>The drop point defaults to directly above the player's head position, as defined by the VR camera. That may feel uncomfortable on your neck, so let's extent it in front a little, 0.2 units:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>As a child of <code class="literal">MeMyselfEye</code> (or as a child of your head or main camera object), create an empty game object and name it <code class="literal">Drop Point</code></li><li>Set its Position to (<code class="literal">0</code>, <code class="literal">0</code>, <code class="literal">0.2</code>)</li><li>Drag this <code class="literal">Drop Point</code> onto the <code class="literal">GameController</code>'s Ball Game Drop Point slot</li></ol></div><p>On positionally tracked VR rigs, if your drop point is relative to the camera, it will follow the player around. If it's relative to <code class="literal">MeMyselfEye</code>, it will be relative to your play space while the player can move around.</p><p>Try it in VR.</p><p>When you hear the ball, look up and aim the angle of your face to direct the bounce of the ball. <span class="emphasis"><em>COOOL!</em></span></p><p>Now, we need the target. Perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Create a flat cylinder for the target, navigate to <strong class="userinput"><code>Game Object</code></strong> | <strong class="userinput"><code>3D Object</code></strong> | <strong class="userinput"><code>Cylinder</code></strong>, and name it <code class="literal">Target</code>.</li><li>Set its <strong class="userinput"><code>Scale</code></strong> to (<code class="literal">3</code>, <code class="literal">0.1</code>, <code class="literal">3</code>) and <strong class="userinput"><code>Position</code></strong> to (<code class="literal">1</code>, <code class="literal">0.2</code>, <code class="literal">2.5</code>) so that it's out in front of you on the ground.</li><li>Drag the <code class="literal">Blue</code> material from the <code class="literal">Project Assets/Materials</code> folder (created in <a class="link" href="#" linkend="ch02"><span>Chapter 2</span></a>, <span class="emphasis"><em>Content, Objects and Scale</em></span>) onto it, or make a new one.</li><li>Note that its default Capsule Collider is domed, and it really won't do. On the Capsule Collider, select its <span class="emphasis"><em>gear</em></span> icon | <strong class="userinput"><code>Remove Component</code></strong>.</li></ol></div><div class="orderedlist"><ol class="orderedlist arabic" start="5" type="1"><li>Then, navigate to <strong class="userinput"><code>Add Component</code></strong> | <strong class="userinput"><code>Physics</code></strong> | <strong class="userinput"><code>Mesh Collider</code></strong>.</li><li>In the new <strong class="userinput"><code>Mesh Collider</code></strong>, enable the <strong class="userinput"><code>Convex</code></strong> checkbox and the <strong class="userinput"><code>Is Trigger</code></strong> checkbox too.</li><li>Add an audio source by navigating to <strong class="userinput"><code>Add Component</code></strong> | <strong class="userinput"><code>Audio</code></strong> | <strong class="userinput"><code>Audio Source</code></strong>.</li><li>With the <code class="literal">Target</code> selected, click on the small <span class="emphasis"><em>circle</em></span> icon on the far right of the <strong class="userinput"><code>AudioClip</code></strong> field to open the <strong class="userinput"><code>Select AudioClip</code></strong> dialog box, and choose the clip named <code class="literal">Land</code> (found in Standard Assets).</li><li>Uncheck the <strong class="userinput"><code>Play On Awake</code></strong> checkbox.</li><li>And a new script, navigate to <strong class="userinput"><code>Add Component</code></strong> | <strong class="userinput"><code>New Script</code></strong>, name it <code class="literal">TriggerSound</code>, and open it in MonoDevelop.</li></ol></div><p>Since we enabled Is Trigger, when <span>something</span><a id="id325577593" class="indexterm"></a> hits the collider, the <code class="literal">OnTriggerEnter</code> and other event handlers will get a call when present on the target object. The following <code class="literal">TriggerSound.cs</code> script will play a sound clip when you hit the target with a ball:</p><pre class="programlisting">using UnityEngine; 
using System.Collections; 
 
public class TriggerSound : MonoBehaviour { 
  public AudioSource hitSound; 
 
  void Start() { 
    hitSound = GetComponent&lt;AudioSource&gt; (); 
  } 
 
  void OnTriggerEnter(Collider other) { 
    hitSound.Play (); 
  } 
} </pre><p>The ball enters the target's collider and the physics engine invokes a trigger enter event. The script uses the <code class="literal">OnTriggerEnter()</code> handler to play the audio clip. </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note80"></a>Note</h3><p>For a full list of the collider properties and trigger events, including <code class="literal">OnTrggerEnter</code> and <code class="literal">OnTriggerExit</code>, see the documentation at <a class="ulink" href="https://docs.unity3d.com/ScriptReference/Collider.html" target="_blank">https://docs.unity3d.com/ScriptReference/Collider.html</a>.</p></div><p>Try it in VR. It's a VR game! The following image shows the scene with the first person's colliders and a ball bouncing off the cube collider towards the target:</p><div class="mediaobject"><img src="/graphics/9781788478809/graphics/dd66ead5-bd29-4220-b877-d6c4f7dadb01.png" /></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note81"></a>Note</h3><p><span class="strong"><strong>Extra challenge</strong></span>: Keep score. Provide an aiming reticle. Add a backboard. Add other features to make the game more challenging. For instance, you can vary the fire interval or increase the initial ball velocity.</p></div><p>Up to this point, we assigned <strong class="userinput"><code>Bounciness</code></strong> through a Physic Material attached to a sphere object. When the ball collides with another object, the Unity physics engine considers this bounciness to determine the ball's new velocity and direction. In the following section, we'll <span>look</span><a id="id325577658" class="indexterm"></a> at how one can transfer a bounce force from one object to another.</p></div>