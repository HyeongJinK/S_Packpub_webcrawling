<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch03lvl1sec31"></a>Building for Windows Immersive MR</h2></div></div><hr /></div><p>Microsoft's 3D media <span class="strong"><strong>Mixed Reality</strong></span> strategy is to <span>support</span><a id="id325549809" class="indexterm"></a> the spectrum of devices and applications from virtual reality to augmented reality. This book and our projects are about VR. At the other end is the Microsoft HoloLens wearable AR device. The MixedRealityToolkit-Unity package that we will use includes support for both immersive MR headsets and HoloLens.</p><p>To allow your app to use a <span class="strong"><strong>Windows immersive Mixed Reality</strong></span> (<span class="strong"><strong>IMR</strong></span>) headset, you will use the Window Mixed Reality SDK, as follows:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Configure your Unity <span class="strong"><strong><strong class="userinput"><code>Build Settings</code></strong></strong></span> to target the <strong class="userinput"><code><span class="strong"><strong>Universal Windows Platform</strong></span></code></strong> platform.</li><li>In <strong class="userinput"><code>Player Settings</code></strong>, under <strong class="userinput"><code>XR Setting</code></strong><span class="strong"><strong>s</strong></span>, set <span class="strong"><strong><strong class="userinput"><code>Virtual Reality Enabled</code></strong></strong></span></li><li>Ensure <span class="strong"><strong><strong class="userinput"><code>Windows</code></strong></strong></span><strong class="userinput"><code>Mi</code></strong><strong class="userinput"><code>xed</code></strong><span class="strong"><strong><strong class="userinput"><code>Reality</code></strong></strong></span> is at the top of the <span class="strong"><strong><strong class="userinput"><code>Virtual Reality</code></strong></strong></span><strong class="userinput"><code><span class="strong"><strong>SDKs</strong></span></code></strong> list.</li><li>Download and install the <strong class="userinput"><code>Mixed Reality Toolkit Unity</code></strong>, as instructed previously.</li><li>We also recommend you install its sister examples unity package from the same location.</li></ol></div><p>Now we will add the <code class="literal">MixedRealityCamera</code> rig to the <code class="literal">MeMyselfEye</code> object in our scene:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Look in your Project window; under the <code class="literal">Assets</code> folder, you should have a folder named <code class="literal">HoloToolkit</code> (or <code class="literal">MixedRealityToolkit</code>).</li><li>Within that is a subfolder called <code class="literal">Prefabs</code>. Drag the prefab named <code class="literal">MixedRealityCameraParent</code> from the <code class="literal">Assets/HoloToolkit/Prefabs/</code> folder into your Hierarchy. Place it as a child object of <code class="literal">MeMyselfEye</code>.</li><li>If necessary, reset its <strong class="userinput"><code>Transform</code></strong> to <span class="strong"><strong><strong class="userinput"><code>Position</code></strong></strong></span> (<code class="literal">0</code>, <code class="literal">0</code>, <code class="literal">0</code>).</li><li>Disable the <code class="literal">Main Camera</code> object, also under <code class="literal">MeMyselfEye</code>. You can disable objects by unchecking the enable checkbox in the top-left of its Inspector window. Alternatively, you can just delete the <code class="literal">Main Camera</code> object.</li><li>Save the prefab by selecting <code class="literal">MeMyselfEye</code> in Hierarchy, then press its <strong class="userinput"><code>Apply</code></strong> button in the Inspector.</li></ol></div><p>Note that the <code class="literal">MixedRealityCameraParent</code> rig <span>y</span> position should be set to 0 as it will use the real-life height of the player to set the camera height in real time.</p><p>To test it out, make sure that the VR device is properly connected and turned on. You should have the MR Portal app opened in the Windows desktop. Click on the game <strong class="userinput"><code>Play</code></strong> button at the top-center of the Unity Editor. Put on the headset, and it should be awesome! Within VR, you can look all around—left, right, up, down, and behind you. You can lean over and lean in. Using the hand controller's thumb pad, you can make Ethan walk, run, and jump just like we did earlier.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec39"></a>Setting up Windows 10 Developer mode</h3></div></div></div><p>For Windows MR, you <span>must</span><a id="id325586434" class="indexterm"></a> be developing on Windows 10, with Developer mode enabled. To set Developer mode:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Go to <span class="strong"><strong><strong class="userinput"><code>Action Center</code></strong></strong></span> | <span class="strong"><strong><strong class="userinput"><code>All Settings</code></strong></strong></span> | <span class="strong"><strong><strong class="userinput"><code>Update &amp; Security</code></strong></strong></span> | <span class="strong"><strong><strong class="userinput"><code>For Developers</code></strong></strong></span>.</li><li>Select <span class="strong"><strong><strong class="userinput"><code>Developer mode</code></strong></strong></span>, as shown:
</li></ol></div><div class="mediaobject"><img src="/graphics/9781788478809/graphics/5c5f09cf-7488-4eb5-929b-76fd6058b3ad.png" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec40"></a>Installing UWP support in Visual Studio</h3></div></div></div><p>When you install Unity, you <span>have</span><a id="id325590412" class="indexterm"></a> the option to install <span class="emphasis"><em>Microsoft Visual Studio Tools for Unity</em></span> as the default script editor. It's a great editor and debugging environment. However, this edition installed with Unity is not a full version of Visual Studio. To target your build as a separate UWP app, you will need to use a full version of Visual Studio. </p><p>Visual Studio is a powerful <span class="strong"><strong>integrated developer environment</strong></span> (<span class="strong"><strong>IDE</strong></span>) for <span>all</span><a id="id325594737" class="indexterm"></a> kinds of projects. When we build for UWP from Unity we will actually build a Visual Studio<span>-ready project folder that you can then open in VS to complete the compile, build and deploy process, to run the app on your device</span>.</p><p>Visual Studio comes in three editions, <span class="emphasis"><em>Community</em></span>, <span class="emphasis"><em>Professional</em></span>, and <span class="emphasis"><em>Enterprise</em></span>; any of these are sufficient for us. The Community version is <span class="emphasis"><em>free</em></span> and can be downloaded from here: <a class="ulink" href="https://www.visualstudio.com/vs/" target="_blank">https://www.visualstudio.com/vs/.</a></p><p>Once the installer is downloaded, open it to choose which components to install. Under the <strong class="userinput"><code>Workloads</code></strong> tab we have selected:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><strong class="userinput"><code>Universal Windows Platform development</code></strong></li><li style="list-style-type: disc"><strong class="userinput"><code>Game development with <span>Unity</span></code></strong></li></ul></div><div class="mediaobject"><img src="/graphics/9781788478809/graphics/e741c99f-b796-4b12-9d5b-241e50183802.png" /></div><p></p><p>Also, select the <strong class="userinput"><code>Game development with Unity</code></strong> options, as follows:</p><div class="mediaobject"><img src="/graphics/9781788478809/graphics/948a87f4-4207-445b-b213-8df1ffae5fce.png" /></div><p>We can now go into Unity. First, we should make sure Unity knows we're using Visual Studio:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>Go to <span class="strong"><strong><strong class="userinput"><code>Edit</code></strong></strong></span> | <span class="strong"><strong><strong class="userinput"><code>Preferences</code></strong></strong></span></li><li>In the <span class="strong"><strong><strong class="userinput"><code>External Tools</code></strong></strong></span> tab, make sure <span class="strong"><strong><strong class="userinput"><code>Visual Studio</code></strong></strong></span> is selected as your <span class="strong"><strong><strong class="userinput"><code>External Script Editor</code></strong></strong></span>, like so:</li></ol></div><div class="mediaobject"><img src="/graphics/9781788478809/graphics/4cec3997-00ae-4831-8ab0-448a51564ad3.png" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec41"></a>UWP build</h3></div></div></div><p>Now, you can build your <span>game</span><a id="id325577714" class="indexterm"></a> as a separate executable app using the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>From the main menu bar, navigate to <strong class="userinput"><code><span class="strong"><strong>File</strong></span></code></strong> | <strong class="userinput"><code><span class="strong"><strong>Build Settings...</strong></span></code></strong></li><li>If the current scene is not already in the <span class="strong"><strong><strong class="userinput"><code>Scenes to Build</code></strong></strong></span> list, press <span class="strong"><strong><strong class="userinput"><code>Add Open Scenes</code></strong></strong></span></li></ol></div><p> </p><div class="orderedlist"><ol class="orderedlist arabic" start="3" type="1"><li>On the right side of the dialog are options:
<div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><strong class="userinput"><code>Target Device: PC</code></strong></li><li style="list-style-type: disc"><strong class="userinput"><code>Build Type: D3D</code></strong></li><li style="list-style-type: disc"><strong class="userinput"><code>SDK: Latest Installed</code></strong> (for example, 10.0.16299.0)</li></ul></div></li><li>Click on <strong class="userinput"><code><span class="strong"><strong>Build</strong></span></code></strong> and set its name</li><li>I like to keep my builds in a subdirectory named Build; create one if you want to</li><li>Click on <strong class="userinput"><code><span class="strong"><strong>Save</strong></span></code></strong></li></ol></div><p>Note that the Mixed Reality ToolKit provides shortcuts to these and other settings and services, as shown:</p><div class="mediaobject"><img src="/graphics/9781788478809/graphics/284e0d93-a179-4cc7-9cf2-7783061c36bf.png" /></div><p>Now open the project in Visual Studio:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li>An easy way is to navigate to the Build folder in File Explorer and look for the <code class="literal">.sln</code> file for the project (SLN is the Microsoft VS <span class="emphasis"><em>solution</em></span> file). Double-click it to open the project in Visual Studio.</li><li>Choose the solution configuration: <strong class="userinput"><code>Debug</code></strong>, <strong class="userinput"><code>Master</code></strong> or <strong class="userinput"><code>Release.</code></strong></li><li>Set the target to <strong class="userinput"><code>x64.</code></strong></li><li>Press <strong class="userinput"><code>Play Local Machine</code></strong> to build the solution.</li></ol></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip30"></a>Note</h3><p>For more information on Unity support for Windows Mixed Reality, see <a class="ulink" href="https://github.com/Microsoft/MixedRealityToolkit-Unity" target="_blank">https://github.com/Microsoft/MixedRealityToolkit-Unity</a>, including the link to the Getting Started page.</p></div></div></div>