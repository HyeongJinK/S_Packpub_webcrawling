<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch07lvl1sec42"></a>Setting up Unity for iOS builds</h2></div></div><hr /></div><p>After you <a id="id437" class="indexterm"></a>have your game files transferred, or if are already working on a Mac, open Unity and then your game scene if it is not already loaded.</p><p>Right-click <a id="id438" class="indexterm"></a>on the <code class="literal">Assets</code> folder in the <span class="strong"><strong>Project</strong></span> window. Then, select <span class="strong"><strong>Create</strong></span> and then <span class="strong"><strong>Folder</strong></span>. Name this folder <code class="literal">IconsAndSplash</code>.</p><p>Right-click on the <code class="literal">IconsAndSplash</code> folder and select<span class="strong"><strong> Import New Asset…</strong></span>. Navigate to the book files and search for the folder named <code class="literal">ChapterSeven_iOSIcons_Splash</code>. Import the files, <span class="emphasis"><em>except</em></span> the one named <code class="literal">Icon_Template.png</code>. This is here so that you have a reference to what the iOS icon sizing should be if you are creating a custom icon, which I recommend because the one I am including here is not specific to any game or product.</p><p>Once the icons and the splash screen are imported, select the icons; icons are the ones with <code class="literal">numberXnumber</code> as its name. In the <span class="strong"><strong>Inspector</strong></span> window, change the settings for the icons as follows:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>Select <span class="strong"><strong>Filter Mode</strong></span> as <span class="strong"><strong>Point</strong></span></p></li><li style="list-style-type: disc"><p>Select <span class="strong"><strong>Max Size</strong></span> as <code class="literal">256</code></p></li><li style="list-style-type: disc"><p>Select <span class="strong"><strong>Format</strong></span> as <span class="strong"><strong>Truecolor</strong></span></p></li></ul></div><p>Next, select the <code class="literal">Splash_Screen.png</code> file and back in the <span class="strong"><strong>Inspector</strong></span> window, use the following settings:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>Select <span class="strong"><strong>Filter Mode</strong></span> as <span class="strong"><strong>Point</strong></span></p></li><li style="list-style-type: disc"><p>Select <span class="strong"><strong>Max Size</strong></span> as <code class="literal">2048</code></p></li><li style="list-style-type: disc"><p>Select <span class="strong"><strong>Format</strong></span> as <span class="strong"><strong>Truecolor</strong></span></p></li></ul></div><p>Apple products have different screen sizes and resolutions, which is why there are so many icons. Unity does have it built-in, so you can import just the 180x180 image. Also, it will match the other resolutions in the list. I included all the sizes so that you can both know them and manipulate and customize them based on icon size if you want.</p><p>Perform the following steps:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Left-click on <span class="strong"><strong>Edit</strong></span> at the top selection bar of the editor, navigate to <span class="strong"><strong>Project Settings</strong></span>, and select <span class="strong"><strong>Player</strong></span> from the list.</p></li><li><p>In the <span class="strong"><strong>Inspector</strong></span> window, change <span class="strong"><strong>Company Name</strong></span> and <span class="strong"><strong>Product Name</strong></span> to what fits your project. For example, I will use <code class="literal">dotVawxGames</code> for the company name and <code class="literal">Endless Rush Runner</code> for the product name.</p></li><li><p>Now, left-click on <span class="strong"><strong>Select</strong></span> for the default icon and search for the <code class="literal">180x180.png</code> image that was imported and left-click on it to select it.</p></li><li><p>Then, left-click on the <span class="strong"><strong>Resolution and Presentation</strong></span> tab. Now, under<span class="strong"><strong> Default Orientation</strong></span>, select <span class="strong"><strong>Landscape</strong></span> <span class="strong"><strong>Right</strong></span>.</p></li><li><p>Now, let's left-click on the <span class="strong"><strong>Icon</strong></span> tab and select <span class="strong"><strong>Override for iPhone.</strong></span></p></li><li><p>Then, click <a id="id439" class="indexterm"></a>on the <span class="strong"><strong>Select</strong></span> tab for the <span class="strong"><strong>180x180</strong></span> option and search for the <code class="literal">180x180.png</code> file we imported. With the <span class="strong"><strong>Override for iPhone</strong></span> box selected, it should fill the rest of the boxes for you. If you want to have your own unique icon images for all the sizes, use the rest of the <a id="id440" class="indexterm"></a>PNG files to enter the selections.</p></li><li><p>Next, left-click on the <span class="strong"><strong>Splash Image</strong></span> tab, and for the image fields, click on <span class="strong"><strong>Select</strong></span> and then the <span class="strong"><strong>Splash_Screen.png</strong></span> file that was imported:</p><div class="mediaobject"><img src="/graphics/9781784399801/graphics/B04063_07_05.jpg" /></div></li><li><p>Finally, left-click on the <span class="strong"><strong>Other Settings</strong></span> tab. Now, under <span class="strong"><strong>Configuration</strong></span>, make sure that <span class="strong"><strong>Scripting</strong></span> <span class="strong"><strong>Backend</strong></span> is set to <span class="strong"><strong>IL2CPP</strong></span>.</p><p>IL2CPP is now the standard to create and submit builds to Apple. If you use <span class="strong"><strong>Mono(2.x)</strong></span>, the build will fail to submit because Apple requires iOS Apps to support the 64-bit iOS platform.</p></li><li><p>Click on <span class="strong"><strong>File</strong></span> in the top-left corner of the editor and then select <span class="strong"><strong>Save Project</strong></span>.</p></li></ol></div><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip42"></a>Tip</h3><p>If you were to use your own art, the fields in the <span class="strong"><strong>Icon</strong></span> and <span class="strong"><strong>Splash Image</strong></span> fields are what you'd fill.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec48"></a>Creating a test build</h3></div></div></div><p>Now that we <a id="id441" class="indexterm"></a>are ready to create a build, left-click on <span class="strong"><strong>File</strong></span> and <a id="id442" class="indexterm"></a>navigate to <span class="strong"><strong>Build Settings</strong></span>. Make sure that your <span class="strong"><strong>Build Settings</strong></span> screen looks similar to the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781784399801/graphics/B04063_07_01.jpg" /></div><p>All of these settings are important.</p><p><span class="strong"><strong>Scenes In Build</strong></span> is the <a id="id443" class="indexterm"></a>scenes that you want to include in your game. In our case, we only have the one, so this is what we include. If the scene is not in the <span class="strong"><strong>Build </strong></span><a id="id444" class="indexterm"></a>
<span class="strong"><strong>Settings</strong></span> list and you have it open, simply click on <span class="strong"><strong>Add Current</strong></span>. If you do <span class="emphasis"><em>not</em></span> have the scene open, open it first and then go back to <span class="strong"><strong>Build Settings</strong></span> and click on <span class="strong"><strong>Add Current</strong></span>.</p><p>The <span class="strong"><strong>Platform</strong></span> is also important. As we will create an iOS game, the engine will compile assets in a specific way to match the platform. If you are <span class="emphasis"><em>not</em></span> on the right platform, select iOS from the list and then select <span class="strong"><strong>Switch Platform.</strong></span> This will take a minute to convert your game assets to the iOS project.</p><p><span class="strong"><strong>Development Build</strong></span> is just that. It is a setting we can use to make sure that the game is build for development and <a id="id445" class="indexterm"></a>allows you to test the game in <span class="strong"><strong>sandbox mode</strong></span>, which allows special cases for achievements, leaderboards, and in app purchases for Game Center.</p><p>Next, click on <span class="strong"><strong>Build</strong></span>. Save the build in a location that you will remember. I generally have a "builds" folder that is stored so that I can keep track of specific versions if I need to go back.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip43"></a>Tip</h3><p>If you do not have your iPad, iPhone, or iPod plugged into your Mac via USB, do so now. You can close any programs that open when you do plug it in, including iTunes.</p></div><p>Navigate to the build <a id="id446" class="indexterm"></a>folder you just created on your machine and <a id="id447" class="indexterm"></a>double-click on it to open the folder. At the bottom of the folder, there is a file named <code class="literal">Unity-iPhone.xcodeproj</code>. Double-click on it to open it, which will open Xcode in the process, as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781784399801/graphics/B04063_07_02.jpg" /></div><p>In the top-left corner of the Xcode project, you will find a <span class="strong"><strong>Unity-iPhone</strong></span> project listed. Click on it to select it.</p><p>You should see a window similar to the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781784399801/graphics/B04063_07_03.jpg" /></div><p>The <span class="strong"><strong>Build Identifier</strong></span> field will be unique to what you had set in the Unity settings, <span class="strong"><strong>Version</strong></span>, and <span class="strong"><strong>Build</strong></span>.</p><p>Select the <span class="strong"><strong>Team</strong></span> drop-down menu. If it asks you to log in and you already have a login save, select it.</p><p>If your device <a id="id448" class="indexterm"></a>orientation is not set to as it is in the image, set the <a id="id449" class="indexterm"></a>following parameters:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>Select <span class="strong"><strong>Portrait</strong></span> as <span class="strong"><strong>OFF</strong></span></p></li><li style="list-style-type: disc"><p>Select <span class="strong"><strong>Upside Down</strong></span> as <span class="strong"><strong>OFF</strong></span></p></li><li style="list-style-type: disc"><p>Select <span class="strong"><strong>Landscape Left</strong></span> as <span class="strong"><strong>ON</strong></span></p></li><li style="list-style-type: disc"><p>Select <span class="strong"><strong>Landscape Right</strong></span> as <span class="strong"><strong>OFF</strong></span></p></li></ul></div><p>Next, click on the <span class="strong"><strong>Capabilities</strong></span> text at the top of the Xcode project and make sure that it looks similar to the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781784399801/graphics/B04063_07_04.jpg" /></div><p>It is very important that you have both <span class="strong"><strong>Game Center</strong></span> and <span class="strong"><strong>In-App Purchase</strong></span> <span class="strong"><strong>ON</strong></span>. If you don't have one of these sets, at best, the project will compile, but it won't work, or you will get a compiling error because we intend to use them.</p><p>When you click on the <span class="strong"><strong>Game Center</strong></span> capability, you will likely be asked to log in. Select the login that is in the list, or if there is not one saved, log in to one and then select it.</p><p>You should now be able to <a id="id450" class="indexterm"></a>click on the small play button in the top-left corner of Xcode, and the project will compile and then automatically deploy to the <a id="id451" class="indexterm"></a>device you have plugged in. The game will also automatically launch on your device. You can now test the game.</p><p>When you are done playing on the device, click on the stop button next to the play button to stop Xcode from running the project.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec49"></a>Making a release build</h3></div></div></div><p>To start, close out of Xcode.</p><p>If you have <a id="id452" class="indexterm"></a>not already, navigate to the <code class="literal">Assets/Scripts</code> folder (you can change this freely on your Mac too if you are working on it now) and double-click on the <code class="literal">GameInfo.cs</code> file to open it. In the Start function, remove the following code:</p><div class="informalexample"><pre class="programlisting">        // DEBUGGING ONLY -- REMOVE FOR FINAL BUILD
        //     Reset Achievements
        GameCenterManager.ResetAchievements( );</pre></div><p>This will make sure <a id="id453" class="indexterm"></a>that the achievements are reset every time the player loads the game. If you have to change this, make sure to save the <code class="literal">GameInfo</code> file and go back to Unity so that it compiles.</p><p>To create a release build, the first step to do is navigate to the <span class="strong"><strong>File</strong></span> | <span class="strong"><strong>Build Settings</strong></span> and make sure to <span class="emphasis"><em>uncheck</em></span> the <span class="strong"><strong>Development</strong></span> checkbox.</p><p>Then, left-click on <span class="strong"><strong>File</strong></span> and select <span class="strong"><strong>Save Project</strong></span>.</p><p>Now, click on the <span class="strong"><strong>Build</strong></span> button, <span class="emphasis"><em>not</em></span> build and run. If you are planning on saving this project in the same location as the test build, go ahead, but make sure to click on <span class="strong"><strong>Replace</strong></span> when the window asks you to.</p><p>When the build is <a id="id454" class="indexterm"></a>done, again navigate to the build folder and double-click on the <code class="literal">Unity-iPhone.xproj</code> file.</p><p>Back in Xcode, again click on the Unity-iPhone project in the top-left corner. Now, on the main screen, change <span class="strong"><strong>Version</strong></span> to 1.0. You can leave <span class="strong"><strong>Build</strong></span> as 0.1.</p><p>You will also want to <a id="id455" class="indexterm"></a>check the <span class="strong"><strong>Capabilities</strong></span> area to make sure that both <span class="strong"><strong>Game Center</strong></span> and <span class="strong"><strong>In-App Purchase</strong></span> are <span class="emphasis"><em>on</em></span> and have the correct account attached.</p><p>Now, in order to make a build that we can upload, which is in the format called <span class="strong"><strong>IPA</strong></span>, navigate to the top menu of Xcode and click on <span class="strong"><strong>Product</strong></span> and then select <span class="strong"><strong>Archive</strong></span>.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip44"></a>Tip</h3><p>The IPA file format is a bit like a ZIP file. It stores all the relevant information the app needs to run. In our case, it will be art assets, code we wrote, and what Unity uses, and so on.</p></div><p>There are a lot of things that could happen here. I want to give you all the issues that I experienced, so if you experience them, you can fix them too.</p><p>The first issue is you get an error that tells you that the app needs to be built in x64 bit.</p><p>This is solved by making sure that in the Player Settings option, you select <span class="strong"><strong>IL2CPP. </strong></span>If you see this, make sure to change the setting in Unity, save the project and then create another build.</p><p>The second issue could be that you get a warning that looks similar to the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781784399801/graphics/B04063_07_07.jpg" /></div><p>In order to fix this, left-click on the part of the warning that says <span class="strong"><strong>Validate Project Settings</strong></span>.</p><p>This will open another window that looks similar to the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781784399801/graphics/B04063_07_08.jpg" /></div><p>Click on Perform Changes and then Enable when the next window opens. What is going on here is that Xcode noticed that there are issues with the build. Also, it is offering to fix them for you.</p><p>You will have to <a id="id456" class="indexterm"></a>recompile the project once you change these settings <a id="id457" class="indexterm"></a>by clicking on <span class="strong"><strong>Perform Changes</strong></span>. To do this, again click on <span class="strong"><strong>Product</strong></span> and then select <span class="strong"><strong>Archive</strong></span>. This will recompile the project and also create another IPA if you already have one.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip45"></a>Tip</h3><p>These are two issues I ran into. If you end up experiencing something different, the Internet is full of support. Also, an answer is often as simple as a Google search away. Part of creating apps and games is fixing the issues that are somewhat unique to them.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec50"></a>Submitting the game to Apple</h3></div></div></div><p>When the <a id="id458" class="indexterm"></a>archive process is complete, it will open the archives <a id="id459" class="indexterm"></a>window. From here, you will be able to select the IPA you want to submit. Before I commit, I usually click on the Validate button. This will run the app through a process that makes sure that it is acceptable. If it is, it will say successful. If is it not, you will see an error as to why.</p><p>If you want to validate, do so now. Alternatively, if you want to submit, make sure that the correct IPA is selected and then left-click on <span class="strong"><strong>Submit</strong></span>:</p><p>You will see a <a id="id460" class="indexterm"></a>window like:</p><div class="mediaobject"><img src="/graphics/9781784399801/graphics/B04063_07_09.jpg" /></div><p>Again, click on <span class="strong"><strong>Submit</strong></span>.</p><p>This will take <a id="id461" class="indexterm"></a>some time. It has to verify the build and then upload it to Apple. Depending on your Internet connection speed, it could take more than ten minutes.</p><p>If all is well, you will be presented with a success screen, and iTunes will send you a e-mail informing you that the build was accepted. It will also offer any suggestions for settings if something is not as they expect.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip46"></a>Tip</h3><p>In my e-mail, it told me Push Notifications were disabled, but the game had settings that could use them. It also mentioned that if I want to use them, I need to update my app settings to allow push notifications. If you see this and do not care, do not worry. Your app will still be accepted and will work fine.</p></div><p>The final step is to log in to <span class="strong"><strong>iTunes Connect</strong></span> and then click on <span class="strong"><strong>My Apps</strong></span>.</p><p>First, add at least one screen shot of the game; you must submit at least <span class="emphasis"><em>one</em></span> for the screen shot option. You should also enter the <span class="strong"><strong>Description</strong></span>, <span class="strong"><strong>Keywords</strong></span>, <span class="strong"><strong>Support URL</strong></span>, <span class="strong"><strong>Marketing URL</strong></span>, and <span class="strong"><strong>Private Policy</strong></span> <span class="strong"><strong>URL</strong></span> parameters if not already done.</p><p>You must include an <span class="strong"><strong>App</strong></span> icon that needs to be sized to 1024 x 1024 pixels and include the copyright as well. I will use my name; you can use your name or a company name if you have one.</p><p>Also, change your version number to 1.0 if it is not already.</p><p>Next, scroll <a id="id462" class="indexterm"></a>down further where it says Build and click on it. It <a id="id463" class="indexterm"></a>should show the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781784399801/graphics/B04063_07_10.jpg" /></div><p>Select the build and then click on <span class="strong"><strong>Done</strong></span>.</p><p>Next, click on the small <span class="strong"><strong>Edit</strong></span> text next to the <span class="strong"><strong>Rating</strong></span> portion. A window will come up with a long list of themes, fill this out as best as you can for how your game is suited. For the game we made in the book, <span class="strong"><strong>Cartoon or Fantasy Violence</strong></span> is checked to <span class="strong"><strong>Infrequent</strong></span> / <span class="strong"><strong>Mild</strong></span> and everything else is selected to <span class="strong"><strong>None</strong></span> or <span class="strong"><strong>No</strong></span>. Made for kids is also selected with <span class="strong"><strong>Ages 9 – 11</strong></span>.</p><p>Then, click on <span class="strong"><strong>Done</strong></span>.</p><p>At the bottom of the page, there is a section called <span class="strong"><strong>Version Release</strong></span>. This allows you to have iTunes automatically release your game when/if its approved. Alternatively, you can manually release this version if you want to release it on a specific date and time.</p><p>In the top-right corner of the screen, click on <span class="strong"><strong>Save</strong></span>.</p><p>Now, in the top-right corner of the page, there is the <span class="strong"><strong>Submit for Review</strong></span> button. If you are ready, you can click on it now. It will load another page asking three questions:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p><span class="strong"><strong>Is your app designed to use cryptography or does it contain or incorporate cryptography? (Select Yes even if your app is only utilizing the encryption available in iOS or OS X.)</strong></span></p><p>This answer is almost always no, but if you have a special case where your app does use cryptography or incorporate cryptography, click on yes.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Does your app contain, display, or access third-party content?</strong></span></p><p>This is most often <span class="emphasis"><em>no</em></span>, but pay attention to your game and make sure that you answer correctly.</p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Does this </strong></span><a id="id464" class="indexterm"></a>
<span class="strong"><strong>app use the Advertising Identifier (IDFA)?</strong></span></p><p>This checks whether you are using a third-party ad revenue service that has an <a id="id465" class="indexterm"></a>IDFA. As we used iAds, we can say no here, but if you are creating a different game and using a service (such as Ad Colony), you will want to select yes.</p></li></ul></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec51"></a>Congratulations!</h3></div></div></div><p>You've made it! The game you created is now awaiting approval by Apple.</p></div></div>