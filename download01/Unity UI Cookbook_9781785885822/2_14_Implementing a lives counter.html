<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch02lvl1sec20"></a>Implementing a lives counter</h2></div></div><hr /></div><p>This recipe teaches<a id="id83" class="indexterm"></a> us how to use a <span class="strong"><strong>Text (Script)</strong></span> component, along with a script, to create a counter. It is similar to the counter in the previous recipe; however, instead of keeping track of the score, here we are managing the number of lives that the player has.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec43"></a>How to do it...</h3></div></div></div><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Like the first step in the previous recipe, we need to create a new UI text to display the number of lives. Right-click on the <span class="strong"><strong>Hierarchy</strong></span> panel and then go to <span class="strong"><strong>UI</strong></span> | <span class="strong"><strong>Text</strong></span>. Finally, rename it to <span class="strong"><strong>LivesCounter</strong></span>.</p></li><li><p>We can also adjust the appearance, as we have done before with the <span class="strong"><strong>ScoreCounter</strong></span>, so change the <span class="strong"><strong>Font</strong></span> and the <span class="strong"><strong>Font size</strong></span>. We can also set the <span class="strong"><strong>Color</strong></span> of the text to white, and, finally, we place it in the scene through the <span class="strong"><strong>Rect Tool</strong></span>, and so on.</p></li><li><p>Ensure again that the <span class="strong"><strong>Rich Text</strong></span> variable is checked in order to use styling tags.</p></li><li><p>Next, let's create the script that manages the number of lives: click on <span class="strong"><strong>Add Component</strong></span> | <span class="strong"><strong>New Script</strong></span> in the <span class="strong"><strong>Inspector</strong></span>, name it <span class="strong"><strong>LivesCounterScript</strong></span> and then press <span class="strong"><strong>Create and Add</strong></span>.</p></li><li><p>Double-click on the script in order to edit it. As the previous recipe, we are going to use<a id="id84" class="indexterm"></a> the <code class="literal">Text</code> class; therefore, we need to add the <code class="literal">using UnityEngine.UI;</code> statement at the beginning of the script.</p></li><li><p>Unlike the previous recipe, we need three variables, two <code class="literal">private</code> and one <code class="literal">public</code>, so that we can set this last one in the <span class="strong"><strong>Inspector</strong></span>. These three variables are as follows:</p><div class="informalexample"><pre class="programlisting">  private Text uiText;
  public intmaxLives;
  private int lives;</pre></div></li><li><p>In the <code class="literal">Start()</code> function, we can set the <code class="literal">uiText</code> and <code class="literal">lives</code> variables and call our <code class="literal">update</code> function that we will write later, so:</p><div class="informalexample"><pre class="programlisting">  void Start () {
    lives = maxLives;
    uiText = this.GetComponent&lt;Text&gt; ();
    updateLivesCounter();
  }</pre></div></li><li><p>Now we can write the <code class="literal">addLife()</code> function. Since we have set the maximum number of <code class="literal">lives</code> in the <code class="literal">maxLives</code> variable, we need to pay attention to not exceed that number. As a result, we need to add some more lines to perform this control. Furthermore, when we call this function, we don't know if it takes effect; thus, we need to  return a value — in this case Boolean — to let us know if this operation succeeded or not. The function is as follows:</p><div class="informalexample"><pre class="programlisting">  public booladdLife(){
    if (lives &lt;maxLives) {
      lives++;
      updateLivesCounter();
      return true;
    }
    return false;
  }</pre></div></li><li><p>Of course, there is also a function for removing lives; it is as follows:</p><div class="informalexample"><pre class="programlisting">  public boolloseLife(){
    lives--;
    if (lives &gt; 0) {
      updateLivesCounter();
      return false;
    }
    lives = 0;
    updateLivesCounter();
    return true;
  }</pre></div></li><li><p>Finally, our <code class="literal">update</code> function:</p><div class="informalexample"><pre class="programlisting">  private void updateLivesCounter(){
    uiText.text = "&lt;color=red&gt;Lives&lt;/color&gt;: " + lives;
  }</pre></div></li><li><p>Save the script, and <a id="id85" class="indexterm"></a>our <span class="strong"><strong>LivesCounter</strong></span> is ready. If we set to <code class="literal">5</code> the <code class="literal">maxLives</code> variable and press play, we should see the following:</p><div class="mediaobject"><img src="/graphics/9781785885822/graphics/B04903_02_02.jpg" /></div></li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec44"></a>How it works...</h3></div></div></div><p>As in the <span class="emphasis"><em>Implementing a score counter</em></span> recipe, we have created a <span class="strong"><strong>Text (Script)</strong></span> component and adjusted it as we desire, and again we have ensured that we have <span class="strong"><strong>Rich Text</strong></span> checked.</p><p>In our script, we have three variables. The <code class="literal">uiText</code> stores the reference to the <span class="strong"><strong>Text (Script)</strong></span> component. We store the maximum number of lives that the player can have in the <code class="literal">maxLives</code> variable and set its value in the <span class="strong"><strong>Inspector</strong></span>. Finally, the <code class="literal">lives</code> contains the number of lives currently possessed by the player.</p><p>In the <code class="literal">Start()</code> function, we first set the number of lives with the maximum number allowed with this line, <code class="literal">lives = maxLives;</code>. Then, we assign the <span class="strong"><strong>Text (Script)</strong></span> component attached in the same game object of this script to the <code class="literal">uiText</code> variable by calling the <code class="literal">this.GetComponent&lt;Text&gt;()</code> function. Finally, we call the <code class="literal">updateLivesCounter()</code> function in order to update the UI, also in the first iteration.</p><p>Furthermore, we<a id="id86" class="indexterm"></a> have also written a <code class="literal">addLife()</code> function to add life to the player that returns a Boolean value: <code class="literal">true</code> if the life is added, otherwise the number of lives is equal to the maximum number of lives, which are allowed and the function returns <code class="literal">false</code>. In fact, at the beginning, there is an <code class="literal">if</code> statement that checks whether lives are less than <code class="literal">maxLives</code>. If so, we increase the lives by one, <code class="literal">lives++;</code>, then we call <code class="literal">updateLivesCounter()</code> function to update the interface, and, finally, we return <code class="literal">true</code>. Otherwise, we just return <code class="literal">false</code>.</p><p>Now, we have a function for <code class="literal">loseLife()</code>, and even this one returns back a Boolean value: <code class="literal">true</code> if the player has no more lives or <code class="literal">false</code> if the player has lives remaining. First, we decrease the number of lives by one, <code class="literal">lives--;</code>, and then we check whether lives are more than zero. If so, we call the <code class="literal">updateLivesCounter()</code> function to update the interface and, finally, we return<code class="literal"> false</code>. Otherwise, we set <code class="literal">lives = 0</code>; since we don't want a negative number of lives, and, after <code class="literal">updateLivesCounter()</code>, we return <code class="literal">true</code>.</p><p>Finally, in the <code class="literal">updateLivesCounter()</code> function, there is just one line of the code. We assign to the <code class="literal">text</code> variable inside the <span class="strong"><strong>Text (Script)</strong></span> component a string, with stylistic tags, along with the <code class="literal">lives</code> variable.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec45"></a>There's more...</h3></div></div></div><p>We can extend the functionalities of our lives counter by following the next section that will explain how to change the maximum number of lives at runtime.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch02lvl3sec10"></a>Changing the number of maxLives</h4></div></div></div><p>Maybe there are some bonus pick-up items in our game that can temporarily increase the maximum <a id="id87" class="indexterm"></a>number of lives. In this case, we will need a some other functions in our script; let's add them:</p><div class="informalexample"><pre class="programlisting">  public void increaseMaxLives(int value){
    maxLives += value;
  }</pre></div><p>This function is very simple: the following line of code adds an amount equal to the value passed as parameter to<a id="id88" class="indexterm"></a> the <code class="literal">maxLives</code> variable:</p><div class="informalexample"><pre class="programlisting">  public void decreaseMaxLives(int value){
    maxLives -= value;
    if (maxLives&lt; 1)
      maxLives = 1;
    if (lives &gt;maxLives)
      lives = maxLives;
  }</pre></div><p>The <code class="literal">descreaseMaxLives()</code> function is a little bit more complex since we have to make more controls. First of all, we decrease the <code class="literal">maxLives</code> variable with the <code class="literal">maxLives -= value;</code> line. Then, we have two <code class="literal">if</code> statements: the first checks whether the <code class="literal">maxLives</code> is less than <code class="literal">1</code>, since the player must have the possibility to have at least one life, and, if so, the <code class="literal">maxLives</code> variable is set to <code class="literal">1</code>. The second checks to see that lives doesn't exceed <code class="literal">maxLives</code>, since the player can't have more lives that the maximum allowed, and, if so, <code class="literal">set lives = maxLives</code>.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch02lvl3sec11"></a>Getting the number of lives</h4></div></div></div><p>If we need to retrieve the value of the variable lives for any reason, such as to display this value somewhere <a id="id89" class="indexterm"></a>else or allow the player to engage in a battle only if he has a certain number of lives, we need to add a <code class="literal">get</code> function, like the following one:</p><div class="informalexample"><pre class="programlisting">  public intgetLives(){
    return lives;
  }</pre></div></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec46"></a>See also</h3></div></div></div><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>For more detail about the <code class="literal">get</code> function, please refer to <span class="emphasis"><em>Implementing a score counter</em></span> recipe in the <span class="emphasis"><em>There's more...</em></span> section.</p></li><li style="list-style-type: disc"><p>Furthermore, if we want to replace the string <code class="literal">lives</code> on the counter with an icon, see the recipe <span class="emphasis"><em>Creating a modular coin counter</em></span>, which teaches you how to add an icon for coins in the counter.</p></li><li style="list-style-type: disc"><p>Instead, if we are looking for more information about <span class="strong"><strong>Rich Text</strong></span>, the official documentation is the best place<a id="id90" class="indexterm"></a> to get it: <a class="ulink" href="http://docs.unity3d.com/Manual/StyledText.html" target="_blank">http://docs.unity3d.com/Manual/StyledText.html</a>.</p></li></ul></div></div></div>