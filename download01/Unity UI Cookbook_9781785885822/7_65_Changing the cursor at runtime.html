<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch07lvl1sec66"></a>Changing the cursor at runtime</h2></div></div><hr /></div><p>The cursor is another important UI element that is not directly controlled by UI classes. This is the case since they are new in Unity, while the cursor was already implemented earlier. However, changing<a id="id416" class="indexterm"></a> the cursor at runtime could be very useful for the<a id="id417" class="indexterm"></a> player to distinguish different actions, and it can also be graphically nicer. For instance, in a <span class="strong"><strong>Real-Time Strategy</strong></span> (<span class="strong"><strong>RTS</strong></span>) game, the cursor can change when the player decides to move units or orders them to attack enemies.</p><p>At this stage, you are also ready to learn other techniques to deal with UI events, directly inside your scripts, instead of setting them through the <span class="strong"><strong>Inspector</strong></span>, maybe also using the <span class="strong"><strong>Event Trigger</strong></span> component. In fact, here you will learn how to use event handlers to triggers events in your script.</p><p>In this example, we will see how to change the cursor when it enters or overlaps another UI element. This is the most common case of cursor changing, and you will come across different games that have this mechanism.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec186"></a>How to do it...</h3></div></div></div><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>To begin, we have to create a UI element that will allow us to change our cursor. In this example, we can create a panel by right-clicking on the <span class="strong"><strong>Hierarchy</strong></span> panel and then navigating to <span class="strong"><strong>UI</strong></span> | <span class="strong"><strong>Panel</strong></span>. Finally, rename it to <span class="strong"><strong>CursorChangingPanel</strong></span>. Of course, as usual, it is possible to resize it, change the <span class="strong"><strong>Source Image</strong></span>, change the text inside, and finally place it as we wish on the <span class="strong"><strong>Canvas</strong></span>.</p></li><li><p>Since our script will be ready to use and it contains handlers, we don't need to set anything. In order to create it, select <span class="strong"><strong>CursorChangingPanel</strong></span> and, in the <span class="strong"><strong>Inspector</strong></span>, navigate to <span class="strong"><strong>Add Component</strong></span> | <span class="strong"><strong>New Script</strong></span>. Name it <span class="strong"><strong>ChangingCursorScript</strong></span> and then click on <span class="strong"><strong>Create and Add</strong></span>.</p></li><li><p>Double-click on the script to edit it. Now, we are going to use event handlers, and in order to do this, we need a new <code class="literal">using</code> statement that we haven't used so far. This is<a id="id418" class="indexterm"></a> because the script needs to import all the functions relative to the event system. So, let's write at the beginning of our script <code class="literal">using</code> <code class="literal">UnityEngine.EventSystems;</code>.</p></li><li><p>The next step is to declare the handlers. In some way, our script depends on them and extends itself with pre-designated functions. So, after <code class="literal">MonoBehaviour</code> add these two interfaces: <code class="literal">IPointerEnterHandler</code> and <code class="literal">IPointerExitHandler</code>, all of them separated by commas. Thus, the entire class line should be as follows:</p><div class="informalexample"><pre class="programlisting">public class ChangingCursorScript : MonoBehaviour, IPointerEnterHandler, IPointerExitHandler {</pre></div></li><li><p>We need three <code class="literal">public</code> variables to store all the parameters that we need for a new cursor. The first one is, of course, its texture. The second one is a vector for storing the hotspot (that is, the distance from the top-left corner of the texture) to place the real pointer of the cursor (the place where we can actually click). Finally, we have the mode of the cursor. Furthermore, we can initialize both the vector and the mode with default values, but in general, they have to be set from the <span class="strong"><strong>Inspector</strong></span>. So let's write this code:</p><div class="informalexample"><pre class="programlisting">  public Texture2D cursorTexture;
  public CursorMode cursorMode = CursorMode.Auto;
  public Vector2 hotSpot = Vector2.zero;</pre></div></li><li><p>Now, it's time to implement the pre-designated functions that we have quoted before. Here, the first functions, that it is called when in the pointer enters the UI element, where this script is attached. We change the cursor to the new one, but calling <code class="literal">SetCursor()</code>, here it is:</p><div class="informalexample"><pre class="programlisting">  public void OnPointerEnter(PointerEventData eventData){
    Cursor.SetCursor(cursorTexture, hotSpot, cursorMode);
  }</pre></div></li><li><p>The next one is the opposite to the previous one, and it resets the cursor when the pointer exits from the UI element:</p><div class="informalexample"><pre class="programlisting">  public void OnPointerExit(PointerEventData eventData){
    Cursor.SetCursor(null, Vector2.zero, cursorMode);
  }</pre></div><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip35"></a>Tip</h3><p>The preceding two functions cannot have a different signature â€” names plus parameters. This is because they are all called, since we are using handlers.</p></div></li><li><p>Save the script. Since the script is ready to work, we only have to set the <code class="literal">texture</code> cursor in the script, and nothing else. The last thing to do is click on play and see whether it works as it should.</p></li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec187"></a>How it works...</h3></div></div></div><p>Here, we created a script that changes the cursor when it enters a UI element.</p><p>When we implement handlers, we have to write specific functions with a specific signature so that they can <a id="id419" class="indexterm"></a>be called when the event that they are "listening" for occurs. In this case, when the pointer enters our panel, the <code class="literal">OnPointerEnter()</code> function is called, because this script is attached to it. A similar thing happens to the <code class="literal">OnPointerExit()</code> function.</p><p>Of course, we can implement this mechanism for the previous recipe in its entirety, where it was needed to trigger a specific function when it occurs. Furthermore, for this specific function, there is also a parameter called <code class="literal">eventData</code>. This is a <code class="literal">PointerEventData</code>, and it contains useful information that we may want to use in order to achieve the goal of the function.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec188"></a>There's more...</h3></div></div></div><p>By changing the cursor at runtime, it is possible to create animated cursors.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch07lvl3sec65"></a>Animating the cursor</h4></div></div></div><p>Besides determining how the change of cursor is performed, in some games, we can also have animated cursors. Unluckily, there isn't a way to do this natively. As a result, we need coroutines to keep changing the cursor in order to animate it.</p><p>First, we need to<a id="id420" class="indexterm"></a> change the <code class="literal">cursorTexture</code> variable to an array of textures so that we can have a different texture, one for each frame. Therefore, we should have the following line:</p><div class="informalexample"><pre class="programlisting">  public Texture2D[] cursorTexture;</pre></div><p>Then, we also need another variable to be set in the <span class="strong"><strong>Inspector</strong></span> that represents how many seconds should elapse before the change to the next frame, like this:</p><div class="informalexample"><pre class="programlisting">  public float secondsBetweenFrames;</pre></div><p>Now, in <code class="literal">OnPointerEnter()</code>, we need to make the <code class="literal">animateCursor()</code> coroutine start. We will write this later, so this is what the function becomes:</p><div class="informalexample"><pre class="programlisting">  public void OnPointerEnter(PointerEventData eventData){
    StartCoroutine (animateCursor());
  }</pre></div><p>Alternatively, in <code class="literal">OnPointerExit()</code>, we need to stop the coroutine and restore the cursor to its original <a id="id421" class="indexterm"></a>state. Therefore, we can write it in this way:</p><div class="informalexample"><pre class="programlisting">  public void OnPointerExit(PointerEventData eventData){
    StopCoroutine (animateCursor());
    Cursor.SetCursor(null, Vector2.zero, cursorMode);
  }</pre></div><p>Now let's create the coroutine. We need to create an infinite loop using a <code class="literal">while(true)</code> cycle so that our cursor keeps changing until we stop the coroutine. Then we need to scan the array of textures. As a result, we can create a <code class="literal">for</code> cycle for it. Finally, we can assign the current texture, the one that our code is scanning, and wait for the amount of time that is specified in the <code class="literal">secondsBetweenFrames</code> variable using a <code class="literal">yield</code> statement. Here is the code:</p><div class="informalexample"><pre class="programlisting">  IEnumerator animateCursor(){
    while (true) {
      for(int i = 0; i&lt;cursorTexture.Length; i++){
        Cursor.SetCursor(cursorTexture[i], hotSpot, cursorMode);
        yield return new WaitForSeconds(secondsBetweenFrames);
      }
    }
  }</pre></div></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec189"></a>See also</h3></div></div></div><p>For more<a id="id422" class="indexterm"></a> information, you can refer to all of the official <a id="id423" class="indexterm"></a>documentation<a id="id424" class="indexterm"></a> related to these topics:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p><span class="strong"><strong>Cursor</strong></span>: <a class="ulink" href="http://docs.unity3d.com/ScriptReference/Cursor.html" target="_blank">http://docs.unity3d.com/ScriptReference/Cursor.html</a></p></li><li style="list-style-type: disc"><p><span class="strong"><strong>SetCursor()</strong></span>: <a class="ulink" href="http://docs.unity3d.com/ScriptReference/Cursor.SetCursor.html" target="_blank">http://docs.unity3d.com/ScriptReference/Cursor.SetCursor.html</a></p></li><li style="list-style-type: disc"><p><span class="strong"><strong>List of</strong></span><a id="id425" class="indexterm"></a>
<span class="strong"><strong> event handlers</strong></span>: <a class="ulink" href="http://docs.unity3d.com/Manual/SupportedEvents.html" target="_blank">http://docs.unity3d.com/Manual/SupportedEvents.html</a></p></li><li style="list-style-type: disc"><p><span class="strong"><strong>Coroutines</strong></span>: <a class="ulink" href="http://docs.unity3d.com/Manual/Coroutines.html" target="_blank">http://docs.unity3d.com/Manual/Coroutines.html</a></p></li></ul></div></div></div>