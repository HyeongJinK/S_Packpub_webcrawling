<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch05lvl1sec47"></a>Creating bars that go up and down</h2></div></div><hr /></div><p>In this recipe, you will learn how to create a bar that goes up and down. This decorative UI element is often used in sci-fi HUDs. In fact, it gives a touch of life to our UI. Bars that go up and down can be a nice addition when we are trying to provide the player with an atmosphere in which many different things are dynamic and are being measured, such as a character gaining or <a id="id270" class="indexterm"></a>even losing an ability over time during a battle, as if monitoring various statistics of a player to demonstrate a dynamic and quite living atmosphere.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec128"></a>How to do it...</h3></div></div></div><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>First of all, we have to create a UI image that should be like a decorative bar for a sci-fi HUD. In this recipe, we are going to use the bar that we used in <a class="link" href="#" linkend="ch02">Chapter 2</a>, <span class="emphasis"><em>Implementing Counters and Health Bars</em></span>. To start, right-click on the <span class="strong"><strong>Hierarchy</strong></span> panel, then navigate to <span class="strong"><strong>UI</strong></span> | <span class="strong"><strong>Image</strong></span>, and finally rename it <span class="strong"><strong>HUDBar</strong></span>. Of course, it is possible to resize it and place the image as we wish. Lastly, we change <span class="strong"><strong>Source Image</strong></span> with the bar that we created in the second chapter, or design one.</p></li><li><p>After we have changed <span class="strong"><strong>Source Image</strong></span>, we need to change <span class="strong"><strong>Image Type</strong></span> to <span class="strong"><strong>Filled</strong></span>.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip21"></a>Tip</h3><p>If we have a vertical bar as the graphic, we have to set <span class="strong"><strong>Fill Method</strong></span> to <span class="strong"><strong>Vertical</strong></span> and <span class="strong"><strong>Fill Origin</strong></span> to <span class="strong"><strong>Bottom</strong></span>. Otherwise, if we have a horizontal bar, like the one that we are using for this example, we have to rotate it. In the <span class="strong"><strong>Rect Transform</strong></span> component, change the rotation along the <span class="strong"><strong>z</strong></span> axis to <span class="strong"><strong>90</strong></span>. Then, change <span class="strong"><strong>Fill Method</strong></span> to <span class="strong"><strong>Horizontal</strong></span> and <span class="strong"><strong>Fill Origin</strong></span> to <span class="strong"><strong>Left</strong></span>.</p></div></li><li><p>Then, we need a script that controls the movement of the image and changes its <code class="literal">fillAmount</code> variable. Thus, let's navigate to <span class="strong"><strong>Add Componen</strong></span>
<span class="strong"><strong>t</strong></span> | <span class="strong"><strong>New Script</strong></span>, name it <span class="strong"><strong>HUDBarScript</strong></span>, and then click on <span class="strong"><strong>Create and Add</strong></span>.</p></li><li><p>Now, double-click on the script in order to edit it. Since we are going to use the <code class="literal">Image</code> class again, we need to add the <code class="literal">using UnityEngine.UI;</code> statement at the beginning of the script. Before the beginning of the class, we can add this line: <code class="literal">[RequireComponent(typeof(Image))]</code> (without the semicolon at<a id="id271" class="indexterm"></a> the end). By doing this, we are saying that to use this script, it requires that an <span class="strong"><strong>Image</strong></span> component be attached to the same game object as that of this script.</p></li><li><p>We don't need any <code class="literal">public</code> variable, but we need one <code class="literal">private</code> variable. This is for storing the reference to the <span class="strong"><strong>Image (Script)</strong></span> component. We can write the following line:</p><div class="informalexample"><pre class="programlisting">public Image uiImage;</pre></div></li><li><p>As usual, in the <code class="literal">Start()</code> function, we store the reference of the game elements inside our variables, in this case only the <code class="literal">uiImage</code> variable. By calling the <code class="literal">GetComponent&lt;Image&gt; ()</code> function, we take the <span class="strong"><strong>Image(Script)</strong></span> component attached to the same game object in which this script is placed. Therefore, we can code the following:</p><div class="informalexample"><pre class="programlisting">  uiImage = GetComponent&lt;Image&gt; ();</pre></div></li><li><p>Next, in the <code class="literal">Update()</code> function, we have to change the <code class="literal">fillAmount</code> variable of our <span class="strong"><strong>Image(Script)</strong></span> component . Let's add this code:</p><div class="informalexample"><pre class="programlisting">  uiImage.fillAmount = ((Mathf.Sin (Time.time) + 1f) / 2f);</pre></div></li><li><p>Save the script, and click on the play button to verify that everything works as it should. Here, you can see a screenshot of the effect:</p><div class="mediaobject"><img src="/graphics/9781785885822/graphics/B04903_05_03.jpg" /></div></li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec129"></a>How it works...</h3></div></div></div><p>The <code class="literal">Mathf.Sin()</code> function<a id="id272" class="indexterm"></a> returns a value between <code class="literal">-1</code> and <code class="literal">+1</code>, and this depends on upon the parameter.</p><p>If we plot the function, we get the following graph:</p><div class="mediaobject"><img src="/graphics/9781785885822/graphics/B04903_05_EXTRA01.jpg" /></div><p>As we can see from the graph, by increasing <code class="literal">x</code>, which is also a parameter of the <code class="literal">Mathf.Sin()</code> function, the value of <code class="literal">y</code> goes up and down. Therefore, if we pass <code class="literal">Time.time</code> as the parameter, the output will be a value that changes over time. Since the function has a value between <code class="literal">-1</code> and <code class="literal">1</code>, we have to crop its returning value. To do so, we added <code class="literal">1f</code>; thus, its <a id="id273" class="indexterm"></a>value was now between <code class="literal">0</code> and <code class="literal">2</code>. Finally, we divided it by <code class="literal">2f</code>, so its value was between <code class="literal">0</code> and <code class="literal">1</code>, as we wanted.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec130"></a>There's more...</h3></div></div></div><p>This decoration is quite nice when used multiple times in the same screen. But to make the effect pleasant for the player, we need to add a phase or some bounds.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch05lvl3sec40"></a>Adding a phase to use more than one bar</h4></div></div></div><p>In many sci-fi HUDs, there is often more than one bar. If we duplicate the one that we created in this recipe, all <a id="id274" class="indexterm"></a>of them will appear the same. For this reason, we need to introduce a displacement phase in our script.</p><p>To do so, let's add a new <code class="literal">public</code> variable so that we can set it in the <span class="strong"><strong>Inspector</strong></span>:</p><div class="informalexample"><pre class="programlisting">public floatphase;</pre></div><p>Now modify the code line in the <code class="literal">Update()</code> function in the following way:</p><div class="informalexample"><pre class="programlisting">uiImage.fillAmount = ((Mathf.Sin (phase + Time.time) + 1f) / 2f);</pre></div><p>In fact, if we set different values for each bar in the <span class="strong"><strong>Inspector</strong></span>, they will be displaced.</p><p>In the following screenshot, we can see the final effect:</p><div class="mediaobject"><img src="/graphics/9781785885822/graphics/B04903_05_04.jpg" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch05lvl3sec41"></a>Adding bounds to our bar</h4></div></div></div><p>We may want to<a id="id275" class="indexterm"></a> limit the bar movement, so that we can try different aesthetic variations within our UI. We can do so by adding a couple of variables to our script:</p><div class="informalexample"><pre class="programlisting">public float startFilling;
public float maximumStretch;</pre></div><p>In fact, as the name suggests, one stores the initial point and the other stores the amount by which the bar is stretched. So, when we set these in the <span class="strong"><strong>Inspector</strong></span>, we need to pay attention to the fact that the sum of their values should be less than <code class="literal">1</code>.</p><p>In the <code class="literal">Update()</code> function, we need to modify our code to include these two variables in the <code class="literal">Sin()</code> function, like this:</p><div class="informalexample"><pre class="programlisting">uiImage.fillAmount = startFilling + ((Mathf.Sin (Time.time) + 1f) / 2f) * maximumStretch;</pre></div><p>Now, the minimum value that can be assigned to <code class="literal">uiImage.fillAmount</code> is <code class="literal">startFilling</code>, and the maximum is <code class="literal">startFilling</code> summed to <code class="literal">maximumStretch</code>.</p><p>In this screenshot, there is a<a id="id276" class="indexterm"></a> visual explanation of the effect of our variables on the bar:</p><div class="mediaobject"><img src="/graphics/9781785885822/graphics/B04903_05_05.jpg" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch05lvl3sec42"></a>Adding bounds and a phase</h4></div></div></div><p>To gain more control over our bars, we can combine the effects of the two previous sections. This is<a id="id277" class="indexterm"></a> particularly useful when we are designing a complex sci-fi HUD in order to <a id="id278" class="indexterm"></a>customize it to better suit our needs.</p><p>After we have added all the variables from both sections, we can write this line in the <code class="literal">Update()</code> function:</p><div class="informalexample"><pre class="programlisting">uiImage.fillAmount = startFilling + ((Mathf.Sin (phase + Time.time) + 1f) / 2f) * maximumStretch;</pre></div><p>As a result, we are able to create different decorative bars for our UI.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec131"></a>See also</h3></div></div></div><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>If you are looking for more information <a id="id279" class="indexterm"></a>about the <code class="literal">Mathf.Sin()</code> function in Unity, you should refer to the official Unity documentation at <a class="ulink" href="http://docs.unity3d.com/ScriptReference/Mathf.Sin.html" target="_blank">http://docs.unity3d.com/ScriptReference/Mathf.Sin.html</a>.</p></li><li style="list-style-type: disc"><p>Other than<a id="id280" class="indexterm"></a> this, if you want to understand the <span class="emphasis"><em>sin</em></span> function from a<a id="id281" class="indexterm"></a> mathematical point of view, any book about trigonometry should be fine.</p></li></ul></div></div></div>