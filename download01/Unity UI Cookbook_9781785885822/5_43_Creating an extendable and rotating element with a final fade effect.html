<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch05lvl1sec46"></a>Creating an extendable and rotating element with a final fade effect</h2></div></div><hr /></div><p>In this recipe, you will learn how to create an extendable and rotating UI element with a final fade effect. This recipe is an<a id="id256" class="indexterm"></a> extension of the previous one. In fact, we will add some controllers to the rotation. By extending the script that we made in the previous recipe, we can create more <a id="id257" class="indexterm"></a>complex decorating elements for our UIs.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec124"></a>How to do it...</h3></div></div></div><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>To begin, we need to create a UI element. In this example, we will use a square, but you can also use any other image, such as a decorative star or a circle. To do this, create the UI element, right-click on the <span class="strong"><strong>Hierarchy</strong></span> panel, and then navigate to <span class="strong"><strong>UI</strong></span> | <span class="strong"><strong>Image</strong></span>. Finally, rename it <span class="strong"><strong>Extendable and Rotating Element</strong></span>. Of course, it is also possible to resize it, change its source image, and place it wherever we wish.</p></li><li><p>Now, we need to create a script that extends and rotates our image on the screen, and gradually decreases the alpha channel of the color. By doing this, we ensure that the image will gradually fade away. So, let's navigate to <span class="strong"><strong>Add Component</strong></span> | <span class="strong"><strong>New Script</strong></span>, name it <span class="strong"><strong>ExtendableElementWithRotationScript</strong></span>, and then click on <span class="strong"><strong>Create and Add</strong></span>.</p></li><li><p>Since this script is very similar to the one in the previous recipe, we can copy the body of <span class="strong"><strong>ExtendableElementScript</strong></span> into it.</p></li><li><p>We must remember to add the <code class="literal">using UnityEngine.UI;</code> statement at the beginning of the script, since we are going to use the <code class="literal">Image</code> class, and it is not included within the body of script that we just copied. As before, we can also add <code class="literal">[RequireComponent(typeof(Image))]</code> to say that to use this script, it requires an <span class="strong"><strong>Image</strong></span> component attached to the same game object of this script.</p></li><li><p>Next, we need to add a new public variable so that we can set it in the <span class="strong"><strong>Inspector</strong></span>. In fact, this variable will store the speed of rotation. So, let's write the following line:</p><div class="informalexample"><pre class="programlisting">public float rotationSpeed;</pre></div></li><li><p>Then, in the <code class="literal">Update()</code> function, we have to change not only <code class="literal">SizeDelta</code>, but also its rotation. For<a id="id258" class="indexterm"></a> this reason, we add this line at the bottom of the function:</p><div class="informalexample"><pre class="programlisting">rectTransform.Rotate (0,0 , Time.deltaTime * rotationSpeed);</pre></div></li><li><p>We can save the <a id="id259" class="indexterm"></a>script and come back to Unity. From the <span class="strong"><strong>Inspector</strong></span>, we can tweak <code class="literal">rotationSpeed</code> as well as the speed and <code class="literal">surviveTime</code>, if we didn't do it before. Just to test, we can set the speed to <code class="literal">20</code>, <code class="literal">rotationSpeed</code> to <code class="literal">30</code>, and <code class="literal">surviveTime</code> to <code class="literal">10</code>. Finally, we can check whether everything works as it should. In the following screenshot, you can see a frame that shows this effect:</p><div class="mediaobject"><img src="/graphics/9781785885822/graphics/B04903_05_02.jpg" /></div></li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec125"></a>How it works...</h3></div></div></div><p>This script works in the same way as the one in the previous recipe. However, here we can also change the rotation. With the<a id="id260" class="indexterm"></a> <code class="literal">rectTransform.Rotate()</code> function, we can modify the orientation of the object within the space. This is done according to these variables: <code class="literal">Time.deltaTime</code>, which is the time passed since the last frame, and <code class="literal">rotationSpeed</code>. If the latter has a positive value, the UI element will rotate clockwise. But if it has a negative value, the element will rotate anticlockwise. Therefore, designers can choose which is <a id="id261" class="indexterm"></a>best for the UI. This is because the sign of the variable changes the direction of the rotation made<a id="id262" class="indexterm"></a> by the <code class="literal">rectTransform.Rotate()</code> function.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec126"></a>There's more...</h3></div></div></div><p>We can definitely improve the effect with slight variations, which can be learnt in the following sections.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch05lvl3sec35"></a>Creating a shining effect</h4></div></div></div><p>In order to create a shining effect, we can use an image of a shining star. We also need a transparent <a id="id263" class="indexterm"></a>background for this image. After we have placed the image in <span class="strong"><strong>Extendable and Rotating Element</strong></span>, let's rescale the image and place it in our UI, where we want to have the shining effect. Set <code class="literal">speed</code> to <code class="literal">10</code>, <code class="literal">rotationSpeed</code> to <code class="literal">30</code>, and <code class="literal">surviveTime</code> to <code class="literal">1</code>. Next, press the play button to see the shining effect. If our image is unique, or if we are not completely satisfied with the effect, we can tweak the variables until we reach a good effect that suits our needs. Otherwise, we can refer to the following section.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch05lvl3sec36"></a>Creating a better shining effect</h4></div></div></div><p>In this section, we <a id="id264" class="indexterm"></a>will see how to improve our shining effect by making it appear and then disappear. To do this, we need to rewrite the code using a coroutine.</p><p>To begin, let's add a new public <code class="literal">bool</code> variable. Thus, we can set it in the <span class="strong"><strong>Inspector</strong></span>. It will store information on whether we want to reverse the rotation or not. Therefore, we can add this line:</p><div class="informalexample"><pre class="programlisting">public bool reverseRotation;</pre></div><p>In the <code class="literal">Start()</code> function, let's consider this line:</p><div class="informalexample"><pre class="programlisting">GetComponent&lt;Image&gt;().CrossFadeAlpha(0f, surviveTime, false);</pre></div><p>Substitute it with these two:</p><div class="informalexample"><pre class="programlisting">GetComponent&lt;Image&gt;().CrossFadeAlpha(0f, 0f, false);
GetComponent&lt;Image&gt;().CrossFadeAlpha(1f, surviveTime, false);</pre></div><p>The explanation of this can be found in the previous recipe, in the <span class="emphasis"><em>Fade in instead of fade out</em></span> section.</p><p>Next, we have to double the time before the object is destroyed, so we rewrite the <code class="literal">Destroy()</code> function in this way:</p><div class="informalexample"><pre class="programlisting">GameObject.Destroy(gameObject, surviveTime*2);</pre></div><p>Finally, at the end of the <code class="literal">Start()</code> function, we have to call our coroutine, even if we haven't created it yet, like this:</p><div class="informalexample"><pre class="programlisting">StartCoroutine ("fadeAway");</pre></div><p>After we have done this, we need to write our coroutine. Hence, we can add this portion of code at the end of <a id="id265" class="indexterm"></a>our script:</p><div class="informalexample"><pre class="programlisting">IEnumeratorfadeAway(){
  yield return new WaitForSeconds(surviveTime);
  GetComponent&lt;Image&gt;().CrossFadeAlpha(0f, surviveTime, false);
  if(reverseRotation)
    rotationSpeed = -rotationSpeed;
}</pre></div><p>The first instruction waits for the initial fade effect to finish. Then, in the second line of the script, we launch another fade effect to make our extendable and rotating UI element fade away. In the <code class="literal">if</code> statement, we check whether the variable that we have set in the <span class="strong"><strong>Inspector</strong></span> is <code class="literal">true</code>, and if it is, it will reverse the sign of the <code class="literal">rotationSpeed</code> variable in order to change the direction of rotation.</p><p>Let's save the script and finally test whether everything works as expected.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch05lvl3sec37"></a>Using more than one axis to create 3D effects</h4></div></div></div><p>We are not limited to using<a id="id266" class="indexterm"></a> only one axis of rotation. In fact, we can substitute the following line with the next one:</p><div class="informalexample"><pre class="programlisting">rectTransform.Rotate (0, 0 , Time.deltaTime * rotationSpeed);</pre></div><p>Here is the line that we can use instead of the preceding one:</p><div class="informalexample"><pre class="programlisting">rectTransform.Rotate (Time.deltaTime * rotationSpeed, 0 , Time.deltaTime * rotationSpeed);</pre></div><p>In this case, we are rotating the object along the <span class="emphasis"><em>x</em></span> axis as well. But feel free to test different combinations as you wish, such as this one:</p><div class="informalexample"><pre class="programlisting">rectTransform.Rotate (Time.deltaTime * rotationSpeed, Time.deltaTime * rotationSpeed , 0);</pre></div><p>In the preceding case, we are rotating only on the <span class="emphasis"><em>x</em></span> and <span class="emphasis"><em>y</em></span> axes.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch05lvl3sec38"></a>Having control over each axis</h4></div></div></div><p>We may want to make the effect more customizable in order to get very nice variations. To do this, we can add more variables to be set in the <span class="strong"><strong>Inspector</strong></span>, and control each axis of rotation. Along with the <span class="emphasis"><em>Changing the speed for each axis</em></span> subsection in the <span class="emphasis"><em>There's more…</em></span> section of the<a id="id267" class="indexterm"></a> previous recipe, this allows us to gain full control over the effect. If we use our imagination, the number of beautiful effects that we can create is endless.</p><p>Let's start! First of all, we have consider the following variable:</p><div class="informalexample"><pre class="programlisting">public float rotationSpeed;</pre></div><p>Substitute it with these:</p><div class="informalexample"><pre class="programlisting">public float rotationSpeedX;
public float rotationSpeedY;
public float rotationSpeedZ;</pre></div><p>By doing this, we can control each axis independently of the others, whereas this didn't happen in the previous section.</p><p>Now, let's look at the following line in the <code class="literal">Update()</code> function:</p><div class="informalexample"><pre class="programlisting">rectTransform.Rotate (0, 0, Time.deltaTime * rotationSpeed);</pre></div><p>Substitute it with this one, in which the <code class="literal">speed</code> variable is different for each axis:</p><div class="informalexample"><pre class="programlisting">rectTransform.Rotate (Time.deltaTime * rotationSpeedX, Time.deltaTime * rotationSpeedY , Time.deltaTime * rotationSpeedZ);</pre></div><p>Save the script, and try different numbers along all the rotation speed variables. Of course, don't forget to use a nice image. Refer to the next section to get an idea on how to use this script.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch05lvl3sec39"></a>Creating a butterfly</h4></div></div></div><p>If we made the<a id="id268" class="indexterm"></a> changes in the previous section, creating a butterfly should not be a problem. In fact, simply use a symmetric image of a butterfly and set both <code class="literal">rotationSpeedX</code> and <code class="literal">rotationSpeedZ</code> to <code class="literal">0</code>. Now, just set a positive number for <code class="literal">rotationSpeedY</code>, maybe more (around <code class="literal">300</code>). Remember that the higher the value, the faster the butterfly's wings flap.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec127"></a>See also</h3></div></div></div><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>Since this recipe is an extension of an effect that has already been implemented, you may want to find the original script. You can find it in the previous recipe, <span class="emphasis"><em>Creating an extendable element with a final fade effect</em></span>.</p></li><li style="list-style-type: disc"><p>Furthermore, we<a id="id269" class="indexterm"></a> have seen how it is possible to create a butterfly. You can improve it to make it fly around the UI using a script that you will learn in another recipe. Hence, you can refer to the <span class="emphasis"><em>Making a floating UI element </em></span>recipe, specifically the <span class="emphasis"><em>Create a better butterfly</em></span> section.</p></li></ul></div></div></div>