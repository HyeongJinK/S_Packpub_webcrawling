<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch06lvl1sec58"></a>Changing animation of the hearts of the symbolic lives counter through the script</h2></div></div><hr /></div><p>In this recipe, we will go<a id="id351" class="indexterm"></a> even further than we went in the previous recipe. Here, we will see how we can control the <span class="strong"><strong>Animator</strong></span> controller through a script. In this specific case, you will learn how<a id="id352" class="indexterm"></a> to change the speed of the controller according to the number of lives that the player has left. In fact, we want to make the hearts beat at a normal speed when the player has all his lives intact and beat faster when the player has fewer lives.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec159"></a>Getting ready...</h3></div></div></div><p>In order to get started, you should have completed the previous recipe, <span class="emphasis"><em>Animating hearts of the symbolic lives counter</em></span>, because you need to have all the hearts animated through an <span class="strong"><strong>Animator</strong></span> controller, called <span class="strong"><strong>HeartAnimationController</strong></span>.</p><p>So first of all, we need to be sure that all the hearts have an <span class="strong"><strong>Animator</strong></span> component attached along with the <span class="strong"><strong>Controller</strong></span> variable filled by <span class="strong"><strong>HeartAnimationController</strong></span>.</p><p>Since we need to change the <span class="strong"><strong>Animator</strong></span> component through the script, we can do this directly inside <span class="strong"><strong>SymbolicLivesCounterScript</strong></span>. We had written it in the second chapter in the <span class="emphasis"><em>Creating a symbolic lives counter</em></span> recipe. You might remember that it handles all of the logic for the lives counter.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip26"></a>Tip</h3><p>If we don't want to override the script and keep the original one as well, we can rename it <span class="strong"><strong>SymbolicLivesCounterAnimatedScript</strong></span>. Also remember to rename the class inside the script with the same name.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec160"></a>How to do it...</h3></div></div></div><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>For the first step, double-click on <span class="strong"><strong>SymbolicLivesCounterAnimatedScript</strong></span> to open it.</p></li><li><p>Next, go through it inside the <code class="literal">updateSymbolicLivesCounter()</code> function. Since this<a id="id353" class="indexterm"></a> function in called<a id="id354" class="indexterm"></a> every time a heart is lost or gained, it is the perfect object for making a general animation over all the hearts of the lives counter.</p></li><li><p>In particular, we need to go inside the <code class="literal">for</code> cycle, immediately after the <code class="literal">hearts[i].SetActive(true);</code> instruction. Since we are dealing with all the active hearts here, we need to change the animation to only these, and not to the other ones that are not on the screen anymore.</p></li><li><p>In this context, <code class="literal">hearts[i]</code> is an active heart, and we need to get its <span class="strong"><strong>Animator</strong></span> component through the <code class="literal">GetComponent&lt;Animator&gt;()</code> function. Then we set the speed to <code class="literal">hearts.Length - lives</code>. So, let's add it to our code:</p><div class="informalexample"><pre class="programlisting">  hearts [i].GetComponent&lt;Animator&gt; ().speed = hearts.Length - lives;</pre></div></li><li><p>Finally, we just save our script, and click on play to test it.</p></li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec161"></a>How it works...</h3></div></div></div><p>We start by getting the <span class="strong"><strong>Animator</strong></span> of each active heart, and then we want to see them beating according to the number of lives the player has left. Therefore, the speed of the animation can be calculated as the difference between the maximum number of lives, which in this case is the length of the array, and the remaining lives. In fact, this difference gives us a bigger number with each life that is lost.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch06lvl2sec162"></a>There's more...</h3></div></div></div><p>In this recipe, we saw how to animate the lives counter differently through script, but maybe we need more control over these animations.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch06lvl3sec52"></a>Adding a speed controller to customize speed in the Inspector and at runtime</h4></div></div></div><p>Right now, our script uses just the difference to calculate the animation speed for each heart. If we want<a id="id355" class="indexterm"></a> to tweak this speed in some way with a parameter but keep it dependent on the number of lives the player has left, we<a id="id356" class="indexterm"></a> can add a new <code class="literal">public</code> variable to our script:</p><div class="informalexample"><pre class="programlisting">public float speedController = 1f;</pre></div><p>As we can see, the default value is <code class="literal">1f</code>. This means that there is no difference in speed compared with before, since this variable will be multiplied.</p><p>Now, change the only line of code added in this recipe in this way:</p><div class="informalexample"><pre class="programlisting">hearts [i].GetComponent&lt;Animator&gt; ().speed = (hearts.Length - lives)*speedController;</pre></div><p>By multiplying the difference of our parameters, we are able to control it through the <span class="strong"><strong>Inspector</strong></span>, or even during runtime if we change this variable through another script, since it is a <code class="literal">public</code> variable. If <code class="literal">speedController</code> stores a number between <code class="literal">0</code> and <code class="literal">1</code>, the animation speed is reduced. Otherwise, if it is greater than <code class="literal">1</code>, the animation speed is increased.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch06lvl3sec53"></a>Customizing each animation</h4></div></div></div><p>On the other hand, if we want to <a id="id357" class="indexterm"></a>customize each animation, we should change the code and write a long series of <code class="literal">if</code> statements. How to change the animation is entirely up to you. For instance, if we want to change only the first heart, we can put it inside the <code class="literal">updateSymbolicLivesCounter()</code> function outside the <code class="literal">for</code> cycle with these lines:</p><div class="informalexample"><pre class="programlisting">if (lives == 1) {
  hearts [0].GetComponent&lt;Animator&gt; ().speed = 2.5f;
} else {
  hearts [0].GetComponent&lt;Animator&gt; ().speed = 1.0f;
}</pre></div></div></div></div>