<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch02lvl1sec23"></a>Implementing a linear health bar</h2></div></div><hr /></div><p>In this recipe, we are <a id="id105" class="indexterm"></a>going to create a linear health bar. The health of the player will be displayed as a bar that shortens when the player's health decreases, and extends with the player's health increases. To achieve this, we will use the <span class="strong"><strong>Image (Script)</strong></span> component in a different way than what we have in previous recipes, and develop a script to manage the length of the bar.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec54"></a>How to do it...</h3></div></div></div><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>First of all, we need to create our health bar, so let's open a graphic program and create it. We can create something that should looks like the following:</p><div class="mediaobject"><img src="/graphics/9781785885822/graphics/B04903_02_09.jpg" /></div></li><li><p>Then, import it in to our project. If the project isn't set to 2D, remember to set the <span class="strong"><strong>Texture Type </strong></span>of the imported image to <span class="strong"><strong>Sprite (2D and UI)</strong></span>, and then click on<span class="strong"><strong> Apply</strong></span>.</p></li><li><p>Next, create a new Image. Right-click on the <span class="strong"><strong>Hierarchy</strong></span> panel and then <span class="strong"><strong>UI</strong></span> | <span class="strong"><strong>Image</strong></span>, and rename it to <span class="strong"><strong>Linear Healthbar</strong></span>.</p></li><li><p>Inside the <span class="strong"><strong>Image (Script)</strong></span> component, we have to change <span class="strong"><strong>Image Type</strong></span> into <span class="strong"><strong>Filled</strong></span>. The component should change a little bit in the <span class="strong"><strong>Inspector</strong></span>.</p></li><li><p>Let's change <span class="strong"><strong>Fill Method </strong></span>into <span class="strong"><strong>Horizontal</strong></span> and <span class="strong"><strong>Fill Origin </strong></span>into <span class="strong"><strong>Left</strong></span>. Of course, we need to add to <span class="strong"><strong>Source Image</strong></span> the health bar that we have created. Finally, we can place the <span class="strong"><strong>Linear Healthbar</strong></span> everywhere we want, always using the <span class="strong"><strong>Rect Tool</strong></span>.</p></li><li><p>In order to keep its original proportion, you can click on <span class="strong"><strong>Set Native Size</strong></span> button on the <span class="strong"><strong>Inspector</strong></span>.</p></li><li><p>The following is how the component should appear:</p><div class="mediaobject"><img src="/graphics/9781785885822/graphics/B04903_02_10.jpg" /></div></li><li><p>Now, in the <span class="strong"><strong>Linear Healthbar,</strong></span> go to <span class="strong"><strong>Add Component</strong></span> | <span class="strong"><strong>New Script</strong></span> and name it <span class="strong"><strong>HealthbarScript</strong></span>, and then press <span class="strong"><strong>Create and Add</strong></span>.</p></li><li><p>Double-click <a id="id106" class="indexterm"></a>on the script to edit it and add the <code class="literal">using UnityEngine.UI;</code> statement at the beginning of the script, since we will use the <code class="literal">Image</code> class.</p></li><li><p>Before we add any functions, we need a three variables, two <code class="literal">private</code> and one <code class="literal">public</code>, so we can set this last one in the <span class="strong"><strong>Inspector</strong></span>. Hence, we can write the following:</p><div class="informalexample"><pre class="programlisting">  private Image healthbarFilling;
  public intmaxHealth = 100;
  private int health;</pre></div></li><li><p>In the <code class="literal">Start()</code> function, we have to set the <code class="literal">health</code> variable along with the <code class="literal">healthbarFilling</code> one, thus:</p><div class="informalexample"><pre class="programlisting">  void Start () {
    healthbarFilling = this.GetComponent&lt;Image&gt; ();
    health = maxHealth;
  }</pre></div></li><li><p>As usual, we need a function for add health, so let's write the following:</p><div class="informalexample"><pre class="programlisting">  public void addHealth(int value){
    health += value;
    if (health &gt;maxHealth)
      health = maxHealth;
    updateHealth ();
  }</pre></div></li><li><p>And also, we need to write a <code class="literal">removeHealth(int value)</code> function:</p><div class="informalexample"><pre class="programlisting">  public boolremoveHealth(int value){
    health -= value;
    if (health &lt;= 0){  
      health = 0;
      updateHealth ();
      return true;
    }
    updateHealth ();
    return false;
  }</pre></div></li><li><p>Next, we need to add our <code class="literal">updateHealth()</code> function to update the health bar on the screen:</p><div class="informalexample"><pre class="programlisting">  private void updateHealth(){
    healthbarFilling.fillAmount = health / maxHealth;
  }</pre></div></li><li><p>Finally, just save the script and we are done.</p></li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec55"></a>How it works...</h3></div></div></div><p>First of all, we<a id="id107" class="indexterm"></a> created our health bar in one of our graphic programs. After importing the image and setting it to be a <span class="strong"><strong>Sprite (2D and UI)</strong></span>, we created a new image and set its <span class="strong"><strong>Fill Method</strong></span> to <span class="strong"><strong>Horizontal</strong></span> so that the image can disappear or appear gradually, as the health goes down or increases. Finally, we implemented a script for the logic.</p><p>Inside it, we have created three variables. The first one is <code class="literal">healthbarFilling</code> and, as usual, it stores the reference to the <span class="strong"><strong>Image (Script)</strong></span> component. The variable <code class="literal">maxHealth = 100</code> is the max health that the player can have, and we can set its value in the <span class="strong"><strong>Inspector</strong></span>, but as default in our script, it has <code class="literal">100</code> as value. Finally, the <code class="literal">health</code> variable contains the health currently possessed by the player.</p><p>In the <code class="literal">Start()</code> function, we first assigned the <span class="strong"><strong>Image (Script)</strong></span> component attached in the same game object of this script to the <code class="literal">healthbarFilling</code> variable by calling the <code class="literal">this.GetComponent&lt;Image&gt;()</code> function. Finally, we set <code class="literal">health</code> equals to <code class="literal">maxHealth</code>.</p><p>Furthermore, we have written a function to <code class="literal">addHealth(int value)</code> to the player. It takes an <code class="literal">int</code> as a parameter, and this <code class="literal">int</code> is the number of health points that will be added to the player. In fact, at the beginning, we add value to the <code class="literal">health</code> variable by <code class="literal">health += value</code>. Then, there is an <code class="literal">if</code> statement that checks if the health is more than <code class="literal">maxHealth</code> and, if so, set the health equals to <code class="literal">maxHealth</code>. At the end, we called our <code class="literal">updateHealth()</code> function in order to update the UI.</p><p>We also have a function to <code class="literal">removeHealth(int value)</code> from the player that returns back a Boolean value: <code class="literal">true</code> if the player has no more health, otherwise it returns <code class="literal">false</code>. The first line subtracts the value to the <code class="literal">health</code> variable, then the <code class="literal">if</code> statement checks to see whether we have negative health and, if so, set the <code class="literal">health</code> variable to zero and, after <code class="literal">updateHealth()</code>, we return <code class="literal">true</code>. Otherwise, we call our <code class="literal">update</code> function and return <code class="literal">false</code>.</p><p>At the end, we<a id="id108" class="indexterm"></a> have the <code class="literal">updateHealth()</code> function, in which we put the ratio between <code class="literal">health</code> and <code class="literal">maxHealth</code> into the <code class="literal">Fill Amount</code> variable contained into <span class="strong"><strong>Image (Script)</strong></span> component in the <span class="strong"><strong>Linear Healthbar</strong></span>. In fact, the ratio is the percentage of how much health has the player and also how much longer our health bar should be.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec56"></a>There's more...</h3></div></div></div><p>We can also consider adding a new image in the scene that encloses the health bar in some graphic elements, such as an artistic border, which also underlines the importance of this UI element. This book does not cover how to do this; however, there are many resources available online that can provide information on how to do this, as well as other UI elements.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec57"></a>See also</h3></div></div></div><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>For more complex health bars, see <span class="emphasis"><em>Implementing a radial health bar</em></span>, <span class="emphasis"><em>Creating a health bar with armor</em></span>, <span class="emphasis"><em>Using multiple bars to make a multibar</em></span>, and <span class="emphasis"><em>Developing a kingdom hearts health bar style</em></span> recipes, all included in this chapter.</p></li></ul></div></div></div>