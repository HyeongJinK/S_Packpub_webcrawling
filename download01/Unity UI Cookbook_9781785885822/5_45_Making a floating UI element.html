<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch05lvl1sec48"></a>Making a floating UI element</h2></div></div><hr /></div><p>In this recipe, you <a id="id282" class="indexterm"></a>will learn how to make a floating UI element. This is a nice effect to use within every kind of user interface. If you are going to use a very slow movement with a small amplitude, you can use this effect even on menus to give them more life and a professional look. A floating element can add yet another type of dynamic element to the UI, ultimately breaking the usually rigid nature that UI elements tend to have.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec132"></a>How to do it...</h3></div></div></div><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>First of all, we need to create an UI element. In this example, we will create a panel that can be the background of a menu. To do this, right-click on the <span class="strong"><strong>Hierarchy</strong></span> panel and then navigate to <span class="strong"><strong>UI</strong></span> | <span class="strong"><strong>Panel</strong></span>. Finally, rename it <span class="strong"><strong>Floating Panel</strong></span>. Of course, it is possible to resize and place the panel as we wish.</p></li><li><p>Next, we need a script that moves our panel on the screen in such a way that it seems to float. Thus, navigate to <span class="strong"><strong>Add Component</strong></span> | <span class="strong"><strong>New Script</strong></span> and name it <span class="strong"><strong>FloatingUIScript</strong></span>. Then, click on <span class="strong"><strong>Create and Add</strong></span>.</p></li><li><p>Now, double-click on the script in order to edit it. Since we are going to use only the <code class="literal">RectTransform</code> class, we don't need to add the <code class="literal">using UnityEngine.UI;</code> statement at the beginning of the script this time. Before the beginning of the class, we can add this line: <code class="literal">[RequireComponent(typeof(RectTransform))]</code> (without the semicolon at the end). By doing this, we are saying that to use this script, it requires a <span class="strong"><strong>Rect Transform</strong></span> component that is attached to the same game object of this script.</p></li><li><p>We need only a <code class="literal">private</code> variable to keep track of the <span class="strong"><strong>Rect Transform</strong></span> component, without seeking it every time we have to update its position. Then we also need four public variables. These will be set in the <span class="strong"><strong>Inspector</strong></span>. There are two variables for the speed, one for each axis, and two variables for the amplitude of the floating movement, again, one for each axis. So, we can write this:</p><div class="informalexample"><pre class="programlisting">private RectTransform rectTransform;
public float xspeed,xAmplitude, yspeed, yAmplitude;</pre></div></li><li><p>As usual, in the <code class="literal">Start()</code> function, we store the reference of the game elements inside our variables; in this case, it is only <code class="literal">rectTransform</code>. By calling the <code class="literal">GetComponent&lt;RectTransform&gt;()</code> function, we take the <span class="strong"><strong>Rect Transform</strong></span> attached to the same game object in which this script is placed:</p><div class="informalexample"><pre class="programlisting">void Start () {
  rectTransform = GetComponent&lt;RectTransform&gt; ();
}</pre></div></li><li><p>In the <code class="literal">Update()</code> function, we need to implement our logic. We change the local position of <code class="literal">rectTransform</code> to new <code class="literal">Vector3</code> wherein the <code class="literal">z</code> component is zero. The <code class="literal">x</code> and <code class="literal">y</code> components depend on <code class="literal">Sin</code>, the <code class="literal">math</code> function that creates the floating <a id="id283" class="indexterm"></a>movement for us. We can control this function through our four public variables. Therefore, we can adjust the amplitude and speed for each axis:</p><div class="informalexample"><pre class="programlisting">void Update () {
  rectTransform.localPosition = new Vector3(xAmplitude*Mathf.Sin(Time.time*xspeed), yAmplitude*Mathf.Sin(Time.time*yspeed), 0);
}</pre></div></li><li><p>Save the script and come back to Unity from MonoDevelop. The next step is to tweak the values of our variables in the <span class="strong"><strong>Inspector</strong></span>. We can create different effects with them, but for a nice floating effect, we can set them in the following way:</p><div class="mediaobject"><img src="/graphics/9781785885822/graphics/B04903_05_06.jpg" /></div></li><li><p>Finally, we can press the play button and see if everything works as expected.</p></li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec133"></a>How it works...</h3></div></div></div><p>We use the <code class="literal">Mathf.Sin()</code> function to create a soft and natural movement over time. In fact, it is a periodic function and is continuous. More information about it can be found in the previous recipe, or in <a id="id284" class="indexterm"></a>any general textbook about trigonometry. We use one of them on each axis, and through our variables we can set the parameters of the movement. In particular, we can change the amplitude of the movement and its speed.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec134"></a>There's more...</h3></div></div></div><p>By setting the parameters of this script properly, it is possible to create many different effects. So that we will have an idea of these effects, we will see some of them in the following sections.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch05lvl3sec43"></a>Creating a shaking effect</h4></div></div></div><p>From this script, we can <a id="id285" class="indexterm"></a>create a shaking effect. We only need to move the image faster than our eyes can notice. In order to do this, let's set <span class="strong"><strong>Xspeed</strong></span> to <span class="strong"><strong>500</strong></span>, <span class="strong"><strong>XAmplitude</strong></span> to <span class="strong"><strong>300</strong></span>, <span class="strong"><strong>Yspeed</strong></span> to <span class="strong"><strong>80</strong></span>, and <span class="strong"><strong>YAmplitude</strong></span> to <span class="strong"><strong>350</strong></span>. In the end, the component should look like the following settings:</p><div class="mediaobject"><img src="/graphics/9781785885822/graphics/B04903_05_07.jpg" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch05lvl3sec44"></a>Creating a sparkle effect</h4></div></div></div><p>We can also create a<a id="id286" class="indexterm"></a> sparkle effect, and again the trick is to move the image faster than our eyes can notice, although this time it should be along both axes and not just one. Therefore let's set <span class="strong"><strong>Xspeed</strong></span> to <span class="strong"><strong>20</strong></span>, <span class="strong"><strong>X Amplitude</strong></span> to <span class="strong"><strong>10</strong></span>, <span class="strong"><strong>Yspeed</strong></span> to <span class="strong"><strong>50</strong></span>, and <span class="strong"><strong>Y Amplitude</strong></span> to <span class="strong"><strong>180</strong></span>. Finally, the component should look like this:</p><div class="mediaobject"><img src="/graphics/9781785885822/graphics/B04903_05_08.jpg" /></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch05lvl3sec45"></a>Creating a better butterfly</h4></div></div></div><p>After creating a butterfly in the <span class="emphasis"><em>Creating an extendable and rotating element with a final fade effect</em></span> recipe, we can improve it using the float script. By doing this, we can give the butterfly the illusion that it is moving around our UI.</p><p>To do this, we need to <a id="id287" class="indexterm"></a>modify <code class="literal">ExtendableElementWithRotationScript</code>. Of course, we need to start from the version of the script created in the <span class="emphasis"><em>Having control over each axis</em></span> section. In fact, we need to remove the fade effect along with the destruction of the object.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip22"></a>Tip</h3><p>If we don't want to override the script, we can duplicate it by selecting it and pressing <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>D</em></span>. Once we have duplicated it, we can rename it to <span class="strong"><strong>ButterflyWingsScript</strong></span>. Don't forget to rename the class with the same name inside the script.</p></div><p>Therefore, from the <code class="literal">Start()</code> function, remove these two functions:</p><div class="informalexample"><pre class="programlisting">GetComponent&lt;Image&gt;().CrossFadeAlpha(0f, surviveTime, false);
GameObject.Destroy(gameObject, surviveTime);</pre></div><p>As a result, the object will not change its alpha, and also it will not be destroyed. Furthermore, we can remove the <code class="literal">surviveTime</code> variable and the <code class="literal">using UnityEngine.UI;</code> statement, since they are no longer required.</p><p>Now let's save the script and create new <code class="literal">Image</code>. Right-click on the <span class="strong"><strong>Hierarchy</strong></span> panel and then select <span class="strong"><strong>UI</strong></span> | <span class="strong"><strong>Image</strong></span>. Rename it <span class="strong"><strong>Butterfly</strong></span>. Of course, it is possible to resize it and place the butterfly as we wish. Finally, change the <span class="strong"><strong>Source Image</strong></span> to an image of a butterfly, but remember that it has to be symmetric.</p><p>The next step is to add this new script to our <span class="strong"><strong>Butterfly</strong></span>. As in the <span class="emphasis"><em>Having control over each axis</em></span> section of the <span class="emphasis"><em>Creating extendable and rotating elements with a final fade effect</em></span> recipe, we need to set both <code class="literal">rotationSpeedX</code> and <code class="literal">rotationSpeedZ</code> to <code class="literal">0</code>, and assign a positive number to <code class="literal">rotationSpeedY</code>, maybe a high value (around <code class="literal">300</code>). Keep in mind that the higher the value, the faster the butterfly's wings will be.</p><p>Moreover, add the <span class="strong"><strong>FloatingUIScript</strong></span> as well and set <span class="strong"><strong>XAmplitude</strong></span> and <span class="strong"><strong>YAmplitude</strong></span> both to <span class="strong"><strong>100</strong></span>, <span class="strong"><strong>Xspeed</strong></span> to <span class="strong"><strong>1</strong></span>, and <span class="strong"><strong>Yspeed</strong></span> to <span class="strong"><strong>2</strong></span>.</p><p>The last step is simply to<a id="id288" class="indexterm"></a> test the scene by clicking on play and to make sure that our butterfly comes to life.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch05lvl2sec135"></a>See also</h3></div></div></div><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>If you are looking for more<a id="id289" class="indexterm"></a> information about the <code class="literal">Mathf.Sin()</code> function, you should check out the official documentation on Unity at <a class="ulink" href="http://docs.unity3d.com/ScriptReference/Mathf.Sin.html" target="_blank">http://docs.unity3d.com/ScriptReference/Mathf.Sin.html</a>.</p></li><li style="list-style-type: disc"><p>If you are looking for more information about the <span class="emphasis"><em>sin</em></span> function from a mathematical point of view, any book about trigonometry should be fine. In addition, we have a brief explanation of why this function is used with time. It is in the previous recipe, in the <span class="emphasis"><em>How it works...</em></span> section.</p></li></ul></div></div></div>