<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch01lvl1sec16"></a>Selecting buttons through the keyboard</h2></div></div><hr /></div><p>Often in games, there<a id="id51" class="indexterm"></a> are menus that have shortcuts as well. For example, if the player has to use a skill quickly, he needs an easier way to access it. In general, where there is the possibility within the UI to choose more than one selectable <a id="id52" class="indexterm"></a>element, such as buttons and toggles, it is possible to select them using a keyboard shortcut.</p><p>This recipe will teach you how to detect when a key is pressed and select a specific UI element by creating a script that is able to be generic enough to be placed on every UI element without changing the code.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec33"></a>How to do it...</h3></div></div></div><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>To begin, create a new panel. Right-click on <span class="strong"><strong>Hierarchy</strong></span> panel and then go to <span class="strong"><strong>UI</strong></span> | <span class="strong"><strong>Panel</strong></span>. We can also rename it to keep the project names ordered.</p></li><li><p>Next, we need to create a button inside the panel. We can do this by right-clicking on the panel and then navigating to <span class="strong"><strong>UI</strong></span> | <span class="strong"><strong>Button</strong></span>.</p></li><li><p>In order to better see, which button is currently selected, let's change some properties of the <span class="strong"><strong>Button (Script)</strong></span> component. For instance, we could choose a different color for <span class="strong"><strong>Normal Color</strong></span>, <span class="strong"><strong>Highlighted Color</strong></span>, and <span class="strong"><strong>Pressed Color</strong></span>. In this example, let's set <span class="strong"><strong>Highlighted Color</strong></span> to red and <span class="strong"><strong>Pressed Color</strong></span> to green, and leave <span class="strong"><strong>Normal Color</strong></span> as white. Finally, we also need to change <span class="strong"><strong>Navigation</strong></span> to <span class="strong"><strong>Vertical</strong></span>.</p></li><li><p>In order to have the ability to choose among different buttons, we need different buttons in the scene. We can achieve this by duplicating the button. This can be done by pressing <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>D</em></span> and then placing the duplicated buttons below<a id="id53" class="indexterm"></a> the original one. Rename the first<a id="id54" class="indexterm"></a> of these to <span class="strong"><strong>Button 1</strong></span> and the second to <span class="strong"><strong>Button 2</strong></span>. Repeat the same with the <span class="strong"><strong>Text</strong></span> variable inside the <span class="strong"><strong>Text (Script)</strong></span> component on the child of the button. As a result, we will be able to distinguish<a id="id55" class="indexterm"></a> buttons on the screen as well. Finally, repeat this step at least two more times to get three buttons. Once we are done, our scene should look similar to the following:</p><div class="mediaobject"><img src="/graphics/9781785885822/graphics/B04903_01_10.jpg" /></div></li><li><p>Now it's time to create our first script. To begin, in the <span class="strong"><strong>Inspector</strong></span>, go to <span class="strong"><strong>Add Component</strong></span> | <span class="strong"><strong>New Script</strong></span> and name it <span class="strong"><strong>ButtonThroughKeySelection</strong></span>. Then click on <span class="strong"><strong>Create and Add</strong></span>. While doing this, ensure that the language selected is <span class="strong"><strong>C Sharp</strong></span>.</p></li><li><p>Double-click on the script in order to open it in MonoDevelop.</p></li><li><p>Every time we work with some UI classes, we need to add a <code class="literal">using</code> clause on top of our script. This will ensure that we don't have any compilation error when the script is compiled by Unity. Furthermore, since we are also using events, we need to add another <code class="literal">using</code> clause. Therefore, at the beginning of our script, we need to get these:</p><div class="informalexample"><pre class="programlisting">
<span class="strong"><strong>using UnityEngine.UI;</strong></span>
using UnityEngine.EventSystems;
using UnityEngine;
using System.Collections;</pre></div></li><li><p>Moreover, we need to add a variable for the key that has been chosen. By doing this, we can set that variable in the <span class="strong"><strong>Inspector</strong></span>:</p><div class="informalexample"><pre class="programlisting">public class ButtonThroughKeySelection: MonoBehaviour {

  public string key;</pre></div></li><li><p>Since we don't need<a id="id56" class="indexterm"></a> to set the initial variables, we can erase the <code class="literal">Start()</code> function. In order to<a id="id57" class="indexterm"></a> implement the detection of the pressed key and change the selected button, we need to write the <code class="literal">Update()</code> function in the following way:</p><div class="informalexample"><pre class="programlisting">public void Update()
  if (Input.GetKeyDown (key))
  {
     EventSystem.current.SetSelectedGameObject(
              this.gameObject);
  }
}</pre></div></li><li><p>Now we can save the script and add it to one of the three buttons.</p></li><li><p>Next, set the <span class="strong"><strong>Key</strong></span> variable with a string that represents a key, for example, <span class="strong"><strong>space</strong></span> for the spacebar. Once we have done this, we should see something like this:</p><div class="mediaobject"><img src="/graphics/9781785885822/graphics/B04903_01_12.jpg" /></div></li><li><p>Finally, we can click on the play button and see whether everything works. After our button is selected, by pressing the key bounded by the variable, we can move through the others with the arrow keys. However, if we re-press our key, which in this example is the spacebar, the selection returns to our button.</p></li></ol></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec34"></a>How it works...</h3></div></div></div><p>To get started, we have created three buttons in the scene, which are our test buttons. We also had to change some of the buttons' properties in order to clearly see the effect that our script had on the buttons. Since we had distributed our buttons vertically, we set the <span class="strong"><strong>Navigation</strong></span> variable to <span class="strong"><strong>Vertical</strong></span>.</p><p>At the beginning of the<a id="id58" class="indexterm"></a> script that we wrote, we added the <code class="literal">using UnityEngine.UI;</code> and the <code class="literal">using UnityEngine.EventSystems;</code> statements. The former needs to use UI elements inside our<a id="id59" class="indexterm"></a> scripts, and it will be the most used through all the recipes of this book. The latter needs to use the <span class="strong"><strong>Event System</strong></span> directly in our script.</p><p>As part of the next step in this recipe, we added a <code class="literal">public</code> string variable. It is public so that it can be set in the <span class="strong"><strong>Inspector</strong></span> later. As a result, we can choose an arbitrary key to bind the specific button where the script is collocated.</p><p>Now, in the <code class="literal">Update()</code> function, we checked through if <code class="literal">(Input.GetKeyDown (key)</code>) to find out whether our key is pressed. In fact, the <code class="literal">Input.GetKeyDown(string)</code> function returns <code class="literal">true</code> if the key specified as a string is pressed, and <code class="literal">false</code> if it is not. It's important to remember that the <span class="strong"><strong>Key</strong></span> variable is set in the <span class="strong"><strong>Inspector</strong></span>, so it could change according to the design of our game. Check out the <span class="emphasis"><em>See also</em></span> section for more information about key press detection.</p><p>Finally, if our key is pressed, we need to select a specific button. This can be done with the <code class="literal">EventSystem.current.SetSelectedGameObject(this.gameObject);</code> line. The first part, <code class="literal">EventSystem.current</code>, returns the current event system that is used. Then, we call on the <code class="literal">SetSelectedGameObject(gameObject)</code> function, which selects the game object passed as a parameter. In this case, we use <code class="literal">this.gameobject</code>, which is the game object where this script is attached, as well as the button that we want to select.</p><p>By keeping everything parametric, such as having a <span class="strong"><strong>Key</strong></span> variable that can be set to every instance of the script, we are able to use this script on many buttons at one time and customize it differently without touching the code again.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch01lvl2sec35"></a>See also</h3></div></div></div><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>During the development of this script, we have seen different functions. The most important was the <code class="literal">GetKeyDown()</code> function. In fact, it allows you to detect whether a particular key is detected. You can<a id="id60" class="indexterm"></a> find more information about it at<a class="ulink" href="http://docs.unity3d.com/ScriptReference/Input.GetKeyDown.html" target="_blank"> http://docs.unity3d.com/ScriptReference/Input.GetKeyDown.html</a>.</p></li><li style="list-style-type: disc"><p>However, this function needs a string as a parameter that specifies a key on our keyboard. You can find the complete<a id="id61" class="indexterm"></a> list of the strings at<a class="ulink" href="http://docs.unity3d.com/ScriptReference/KeyCode.html" target="_blank"> http://docs.unity3d.com/ScriptReference/KeyCode.html</a>.</p></li><li style="list-style-type: disc"><p>Finally, we have also <a id="id62" class="indexterm"></a>used the <code class="literal">EventSystem</code>. This is very wide and can be used in different situations within Unity. Therefore, if you are looking for more information about it, you can refer to <a class="ulink" href="http://ttp://docs.unity3d.com/ScriptReference/EventSystems.EventSystem.html" target="_blank">http://docs.unity3d.com/ScriptReference/EventSystems.EventSystem.html</a>.</p></li></ul></div></div></div>