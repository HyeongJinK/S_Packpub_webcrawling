<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch03lvl1sec15"></a>The Animation window – creating a fly-through</h2></div></div><hr /></div><p>The<a id="id109" class="indexterm"></a> <span class="strong"><strong>Animation</strong></span> window is a fully featured animation editor used to create pre-scripted key frame animation on any numerical properties of GameObjects, such as position, rotation, and scale. In short, it lets you animate GameObjects over time, saving the final animation data as a separate and self-contained asset in the Project panel, called an <a id="id110" class="indexterm"></a>
<span class="strong"><strong>animation clip</strong></span>. If you want to create doors that open and close by rotating on their hinges, elevator platforms that move up and down, rotating floors, moving cars, or enemy spaceships flying around, among other things, then the <span class="strong"><strong>Animation</strong></span> window may be exactly what you need. </p><p>To demonstrate its functionality, in this section, we will create a camera fly-through around an environment. However, it's important to recognize that in creating a fly-through, as we will, a more general and abstract toolset is demonstrated—a toolset that can be reused and applied to create animations for practically any purpose, not just camera fly-throughs. To get started then, you may use your own environment, if you have one, or else open the starting project for this section, which is included in this book's companion files inside the <code class="literal">Chapter03/FlyThroughStart</code> folder. Once you have an environment and a camera, you're ready to follow along.</p><div class="mediaobject"><img src="/graphics/9781782174813/graphics/B04103_03_01.jpg" /><div class="caption"><p>Creating an environment for a camera fly-through</p></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note11"></a>Note</h3><p>The complete project for this section can be found in the companion files inside the <code class="literal">Chapter03/FlyThroughEnd</code> folder.</p></div><p>To <a id="id111" class="indexterm"></a>access the <span class="strong"><strong>Animation</strong></span> window to create key frame animation, go to <span class="strong"><strong>Window</strong></span> | <span class="strong"><strong>Animation</strong></span> from the main menu (or press <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>6</em></span> on the keyboard). Be sure to select <span class="strong"><strong>Animation</strong></span> and <span class="emphasis"><em>not</em></span> <span class="strong"><strong>Animator</strong></span>.</p><div class="mediaobject"><img src="/graphics/9781782174813/graphics/B04103_03_02.jpg" /><div class="caption"><p>Accessing the Animation window from the main menu</p></div></div><p>The <span class="strong"><strong>Animation</strong></span> window<a id="id112" class="indexterm"></a> is best viewed in horizontal alignment, so I typically dock the window at the bottom of the interface, underneath the <span class="strong"><strong>Game</strong></span> and <span class="strong"><strong>Scene</strong></span> tabs. To do this, just <a id="id113" class="indexterm"></a>drag and drop the <span class="strong"><strong>Animation</strong></span> window into the Project panel or Console area, over the tab titles.</p><div class="mediaobject"><img src="/graphics/9781782174813/graphics/B04103_03_03.jpg" /><div class="caption"><p>Docking the Animation window at the bottom of the interface</p></div></div><p>To create a key frame animation for a GameObject, select the object to animate in the scene, or by name through the Hierarchy panel. Then click on the <span class="strong"><strong>Add Property</strong></span> button from the <span class="strong"><strong>Animation</strong></span> window. For an animated camera fly-through, select the scene camera and then choose <span class="strong"><strong>Add Property</strong></span> from the <span class="strong"><strong>Animation</strong></span> window. After you've clicked on this button, Unity prompts you with a <span class="strong"><strong>Save</strong></span> dialog for a physical location within the project folder where the animation data (<span class="strong"><strong>Animation Clip</strong></span>) should be named and saved. Name<a id="id114" class="indexterm"></a> the animation <code class="literal">CameraFlyAnim.anim</code>, and select the <span class="strong"><strong>Assets</strong></span> folder to save inside the root of the project.</p><div class="mediaobject"><img src="/graphics/9781782174813/graphics/B04103_03_04.jpg" /><div class="caption"><p>Creating a new animation clip asset</p></div></div><p>On creating a new <a id="id115" class="indexterm"></a>animation clip, Unity actually performs multiple processes behind the scenes. First, it creates two assets: an <span class="strong"><strong>Animation Clip</strong></span> asset (containing all of the key frame data) and an <span class="strong"><strong>Animation Controller</strong></span> asset, which links to the Mecanim system. Further, an <span class="strong"><strong>Animator</strong></span> component is added to the <span class="strong"><strong>Camera</strong></span> object in the scene, which refers to the <span class="strong"><strong>Animation Controller</strong></span> asset, which in turn is responsible for playing the animation clip data automatically when the scene begins. More details on Mecanim will be covered in the next chapter. For now, it's sufficient to consider only the <span class="strong"><strong>Animation Controller</strong></span> as the active force that will initiate the animation playback.</p><div class="mediaobject"><img src="/graphics/9781782174813/graphics/B04103_03_05.jpg" /><div class="caption"><p>Creating a new animation clip, with an autogenerated Animation Controller</p></div></div><p>Next, having created an <span class="strong"><strong>Animation Clip</strong></span> asset, we'll need to define an animation. Unity can record key frame data for any numerical property. In other words, any field on an object represented by numbers, such as position and rotation, can be animated and blended over time. To animate a camera fly-through, we'll need to record both the position and rotation of the camera as they change over time. To do this, click on the <span class="strong"><strong>Add Property</strong></span> button inside the <span class="strong"><strong>Animation</strong></span> window, and from the context menu that appears, choose the channels to animate. Specifically, click on the <span class="strong"><strong>+</strong></span> button and go to <span class="strong"><strong>Transform</strong></span>. Then you can<a id="id116" class="indexterm"></a> go to either the <span class="strong"><strong>Position</strong></span> channel or the <span class="strong"><strong>Rotation</strong></span> channel. This adds two channels to the <span class="strong"><strong>Animation</strong></span> window (position and rotation), which can now be animated. A channel is simply any property for which we can add key frames.</p><div class="mediaobject"><img src="/graphics/9781782174813/graphics/B04103_03_06.jpg" /><div class="caption"><p>Adding animation channels for position and rotation</p></div></div><p>By default, two key frames are autogenerated for both the position and rotation channels—one frame at animation start (time: 0 seconds) and one at the end (time: 1 second). Key frames are represented graphically by grey diamonds inside the timeline view. You can also click and drag the mouse inside the time-measure bar (at the top of the timeline) to position the play head of the animation, previewing the animation at any time. By default, however, both the start and end key frames for the camera are identical, which means that it will not change during the animation.</p><div class="mediaobject"><img src="/graphics/9781782174813/graphics/B04103_03_07.jpg" /><div class="caption"><p>Setting the animation play head to preview animation frames</p></div></div><p>You can <a id="id117" class="indexterm"></a>create a key frame manually to record the state of any channel (or all channels) for the camera at any time in the animation. This can be done by first clicking on the channel to record, using the left-hand column in the <span class="strong"><strong>Animation</strong></span> window (<span class="strong"><strong>Channel List</strong></span>). Then move the time slider (click and drag) to the relevant time, and finally click on the <span class="strong"><strong>Add Key Frame</strong></span> button from the <span class="strong"><strong>Animation</strong></span> window toolbar. This inserts a new key frame into the timeline at the location of the play head. Remember that multiple key frames can be added for multiple channels simultaneously by pressing <span class="emphasis"><em>Shift</em></span> and selecting the channels in the channel list; that is, hold down the <span class="emphasis"><em>Shift</em></span> key on the keyboard while clicking on the channels. You can also click and drag the key frame diamond icons into the timeline to reposition them for different times, as well as duplicate them with <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>C</em></span> and <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>V</em></span>. You can also delete selected key frames with the <span class="emphasis"><em>Backspace</em></span> or <span class="emphasis"><em>Delete</em></span> key.</p><div class="mediaobject"><img src="/graphics/9781782174813/graphics/B04103_03_08.jpg" /><div class="caption"><p>Creating key frames manually for the selected channels using the Add Keyframe button</p></div></div><p>Creating<a id="id118" class="indexterm"></a> key frames manually, as we've seen, is a legitimate method of defining animation, but it's easier to have Unity generate key frames automatically for us, based on movements of, and changes in, objects in the scene. Creating a camera fly-through using this method is easy; position the animation play head to frame <span class="strong"><strong>0</strong></span> in the <span class="strong"><strong>Animation</strong></span> window, and then simply move and rotate the camera object in the scene to its starting position and orientation. Unity will automatically record the position and rotation channels for the camera at that time. Then click and drag the play head further to time <span class="strong"><strong>0:15</strong></span> in the <span class="strong"><strong>Animation</strong></span> window, and move and rotate the camera in the scene again to a new position and rotation for that time. Unity will generate a new set of key frames in response to the selected time. Repeat this process of key frame generation, defining position and rotation values for the camera at times 0:30, 0:45, and 1:00 to generate a key for each time.</p><div class="mediaobject"><img src="/graphics/9781782174813/graphics/B04103_03_09.jpg" /><div class="caption"><p>Generating key frames for a camera fly-through animation</p></div></div><p>Try to make the first and last key frames identical (using <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>C</em></span> and <span class="emphasis"><em>Ctrl</em></span> + <span class="emphasis"><em>V</em></span>), copying and pasting the first key frame to the end time, at time <span class="strong"><strong>1:00</strong></span>. This means that the animation will end with the same appearance as it begins, making it loopable, that is, the kind of animation that plays seamlessly again and again in a loop. When the animation is fully defined to your satisfaction, try it out. Click on <span class="strong"><strong>Play</strong></span> in the Unity toolbar, and the animation will play automatically, due to the <span class="strong"><strong>Animator</strong></span> component. If the animation plays too fast or too slow, or if it doesn't loop, refer to the previous chapter (<a class="link" href="#" linkend="ch02">Chapter 2</a>, <span class="emphasis"><em>Sprite Animation</em></span>) to control <a id="id119" class="indexterm"></a>sprite animation speed and looping.</p><p>Congratulations! You've just created a camera fly-through animation.</p></div>