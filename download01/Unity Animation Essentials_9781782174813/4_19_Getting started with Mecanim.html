<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch04lvl1sec22"></a>Getting started with Mecanim</h2></div></div><hr /></div><p>When animations<a id="id152" class="indexterm"></a> for both the button and door are created, they will play automatically in a loop every time you play the scene in the <span class="strong"><strong>Game</strong></span> tab. They play automatically because upon creating an animation clip asset, Unity automatically generates an <code class="literal">Animator Controller</code> asset that is assigned to the animated object in the scene. The controller itself is part of the Mecanim system and uses a <span class="strong"><strong>State Machine</strong></span> to define how and when an animation clip should play for an object. By default, it plays the animation clip at the beginning of the scene. The animations play on a loop because all new <span class="strong"><strong>Animation Clip</strong></span> assets are specified as loopable by default. Neither the automatic playback nor the looping behavior are desired for the animation here, because the button animation should play <span class="emphasis"><em>only</em></span> when the player presses the button, and the door should open <span class="emphasis"><em>only</em></span> in response to the button push. Let's first disable the looping behavior of each animation clip. To do this, select each animation clip in the Project panel, and in the Object Inspector, disable<a id="id153" class="indexterm"></a> the <span class="strong"><strong>Loop Time</strong></span> checkbox. This prevents all animations from playing in a loop. Instead, they will play only once and then stop.</p><div class="mediaobject"><img src="/graphics/9781782174813/graphics/B04103_04_08.jpg" /><div class="caption"><p>Disabling loop animations</p></div></div><p>Even if looping <a id="id154" class="indexterm"></a>playback is disabled, the animations will still play automatically when the level begins, albeit once. This is because the <span class="strong"><strong>Animator Controller</strong></span> asset is assigned to each objectâ€”the door and the button. To change this behavior, we'll need to open the Animator window. You can do this by going to <span class="strong"><strong>Window</strong></span> | <span class="strong"><strong>Animator</strong></span> from the application menu, or you can double-click on the <span class="strong"><strong>Animation Controller</strong></span> asset from the Project panel. The controller assets are generated alongside the <span class="strong"><strong>Animation Clip</strong></span> assets.</p><div class="mediaobject"><img src="/graphics/9781782174813/graphics/B04103_04_09.jpg" /><div class="caption"><p>Accessing the Animator Controller</p></div></div><p>When you<a id="id155" class="indexterm"></a> select the button object in the scene and view the Animator window, you'll see a Mecanim state machine, composed of connected nodes (called <a id="id156" class="indexterm"></a>
<span class="strong"><strong>states</strong></span>). The states control how and when animation clips should play on the object at runtime. By default, the green <span class="strong"><strong>Entry</strong></span> state is connected directly to the <span class="strong"><strong>anim_ButtonPush</strong></span> state (or whatever name you assigned to the button push animation). The <span class="strong"><strong>Entry</strong></span> node fires, or is activated, when the scene begins. At this point, the execution (or logic) of the graph follows the connections wherever they lead. For this reason, the button-push animation plays automatically when the scene begins, because the <span class="strong"><strong>Entry</strong></span> nodes connect to the button-push animation clip. Let's rewire this graph to behave differently. To start, right-click anywhere in the graph area, and go to <span class="strong"><strong>Create State</strong></span> | <span class="strong"><strong>Empty</strong></span> from the context menu. When you do this, Mecanim creates a new empty node in the graph. This means the attached object in the scene will <span class="emphasis"><em>do nothing</em></span> when this node is active.</p><div class="mediaobject"><img src="/graphics/9781782174813/graphics/B04103_04_10.jpg" /><div class="caption"><p>Creating an empty state in the Mecanim graph</p></div></div><p>However, the <a id="id157" class="indexterm"></a>newly created node is connected to nothing. This means that it will never be active because there is no connection to it from the <span class="strong"><strong>Entry</strong></span> node, which is where the graph always begins. The <span class="strong"><strong>Entry</strong></span> node always connects to the default node, which is highlighted in orange. For now, select the newly created empty node and name it <code class="literal">Idle</code> by typing in the <span class="strong"><strong>Name</strong></span> field in the Object Inspector.</p><div class="mediaobject"><img src="/graphics/9781782174813/graphics/B04103_04_11.jpg" /><div class="caption"><p>Naming Mecanim nodes</p></div></div><p>As mentioned, the <span class="strong"><strong>Entry</strong></span> node always connects to the default node, which is orange. Let's make the <span class="strong"><strong>Idle</strong></span> node default. To <a id="id158" class="indexterm"></a>do this, right-click on the <span class="strong"><strong>Idle</strong></span> node and select <span class="strong"><strong>Set as Layer Default State</strong></span>. The <span class="strong"><strong>Entry</strong></span> node now connects to the <span class="strong"><strong>Idle</strong></span> node instead. This means that the button-push animation will no longer play automatically when the scene begins, which is what we wanted. Well, it's halfway to what we wanted!</p><div class="mediaobject"><img src="/graphics/9781782174813/graphics/B04103_04_12.jpg" /><div class="caption"><p>Setting the default state</p></div></div></div>