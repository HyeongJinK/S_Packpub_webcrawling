<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch04lvl1sec25"></a>Creating scene interactions</h2></div></div><hr /></div><p>The <a id="id176" class="indexterm"></a>sample scene we're creating here finally has two animation clips (button-push and door-open), and two animation controllers that define how the clips relate to states in a scene object. In the previous sections, the controllers have been configured with triggers so that for both the door and the button, their animations can be played back on demand, simply by activating the respective trigger. Now, the problem is that the player cannot activate the triggers themselves <span class="emphasis"><em>in the game</em></span>. Only we, as developers, can do that using the Unity editor during play mode. Our aim now is to have the player press the button to open the door. This means that a button push should activate both triggers in the animation controllers: one for playing the button animation, and the other for opening the door. There are many ways to achieve this interactivity. One way is through scripting, but we don't need to go that far. We can use the Unity Event System. In this section, we'll see how.</p><p>The Unity Event System detects mouse and keyboard input from a specific camera and automatically determines which object in the scene was clicked on. Then it lets us define the way to appropriately respond to the input using a Visual Scripting system. To get started, create an Event System in the scene by going to <span class="strong"><strong>GameObject</strong></span> | <span class="strong"><strong>UI</strong></span> | <span class="strong"><strong>Event System</strong></span>. Although this option is classified under the <span class="strong"><strong>UI</strong></span> category, it actually has many uses outside UIs.</p><div class="mediaobject"><img src="/graphics/9781782174813/graphics/B04103_04_23.jpg" /><div class="caption"><p>Creating an Event System</p></div></div><p>Next, find the <a id="id177" class="indexterm"></a>main camera in the scene and select it. For the sample scene included in this book's companion files, the camera is attached to the FirstPersonCharacter. Once it is selected, add a <span class="strong"><strong>Physics Raycaster</strong></span> component to the object by going to <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>Event</strong></span> | <span class="strong"><strong>Physics Raycaster</strong></span> from the application menu. Adding this to the camera allows the Event System to detect on-screen clicks and determine which object in the scene was under the cursor at the time of the click, based on where the camera was focusing. It's important to attach this component to the game camera—the camera through which the player sees the world—or else clicks won't necessarily be detected for the appropriate objects.</p><div class="mediaobject"><img src="/graphics/9781782174813/graphics/B04103_04_24.jpg" /><div class="caption"><p>Adding a Physics Raycaster component to the camera</p></div></div><p>After<a id="id178" class="indexterm"></a> adding an Event System to the scene and a <span class="strong"><strong>Physics Raycaster</strong></span> component to the camera, we're ready to start configuring the button object to play the required animations. Select the button object in the scene (the object that should be clicked on by the player to open the door), and add an <span class="strong"><strong>Event Trigger</strong></span> component by going to <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>Event</strong></span> | <span class="strong"><strong>Event Trigger</strong></span> from the application menu.</p><div class="mediaobject"><img src="/graphics/9781782174813/graphics/B04103_04_25.jpg" /><div class="caption"><p>Adding an Event Trigger component to a button object in the scene</p></div></div><p>After adding <a id="id179" class="indexterm"></a>an <span class="strong"><strong>Event Trigger</strong></span> component to the button object, click on the <span class="strong"><strong>Add New Event Type</strong></span> button from the Object Inspector. This indicates that we want to listen for a specific event and be notified when it happens. From the context menu that appears, select the <span class="strong"><strong>PointerClick</strong></span> event.</p><div class="mediaobject"><img src="/graphics/9781782174813/graphics/B04103_04_26.jpg" /><div class="caption"><p>Handling a PointerClick event</p></div></div><p>This adds a new section, or panel, to the component from which we can choose a set of actions to perform when the <span class="strong"><strong>PointerClick</strong></span> event occurs for the button. Specifically, two actions should <a id="id180" class="indexterm"></a>be performed. First, we should activate the button animation using the trigger <span class="strong"><strong>PushButton</strong></span>, and then we should activate the door-open animation using the <span class="strong"><strong>DoorOpen</strong></span> trigger. To achieve this, click on the <span class="strong"><strong>+</strong></span> icon in the <span class="strong"><strong>Event Trigger</strong></span> component to add a new action underneath the <span class="strong"><strong>PointerClick</strong></span> event category. This produces an empty action slot, ready to be defined.</p><div class="mediaobject"><img src="/graphics/9781782174813/graphics/B04103_04_27.jpg" /><div class="caption"><p>Creating a new action for the Event Trigger component and PointerClick event</p></div></div><p>For each action added to the event, several questions must be answered. Firstly, which object in the scene will receive or be affected by our action? Secondly, which function or property of that object must be changed or run? Finally, are any arguments or parameters required? Let's see this in action. The first action we need to perform is to activate the button-push animation. This action occurs on the button object (because the button object features the <span class="strong"><strong>Animation Controller</strong></span>). So, drag and drop the button object into the game object slot to specify the button as the target object.</p><div class="mediaobject"><img src="/graphics/9781782174813/graphics/B04103_04_28.jpg" /><div class="caption"><p>Specifying a target object for an action</p></div></div><p>Next, for the function drop-down, go to <span class="strong"><strong>Animator Component</strong></span> | <span class="strong"><strong>SetTrigger(String)</strong></span>. This indicates that for the button object, Unity should activate a trigger when a click occurs.</p><div class="mediaobject"><img src="/graphics/9781782174813/graphics/B04103_04_29.jpg" /><div class="caption"><p>Setting a function for the button object action</p></div></div><p>Finally, in the <a id="id181" class="indexterm"></a>string field, enter the name of the trigger that should be activated. For the button object, this should be <span class="strong"><strong>PushButton</strong></span>, matching the name of the trigger defined in the Mecanim animation controller.</p><div class="mediaobject"><img src="/graphics/9781782174813/graphics/B04103_04_30.jpg" /><div class="caption"><p>Setting a function for the button object action</p></div></div><p>Click on the <span class="strong"><strong>+</strong></span> icon again to add a second action for the door object, using the <span class="strong"><strong>SetTrigger</strong></span> function to set the <span class="strong"><strong>OpenDoor</strong></span> trigger, which opens the door.</p><div class="mediaobject"><img src="/graphics/9781782174813/graphics/B04103_04_31.jpg" /><div class="caption"><p>The completed Event Trigger component for the button object</p></div></div><p>Now we're ready <a id="id182" class="indexterm"></a>to take the project on a test run, being able to open the door by clicking on the animated button. To test this successfully, make sure that the mouse arrow is over the button when clicked on, and both the button animation and door animation will play automatically. Splendid work! You have now configured an interactive, animated scene using Mecanim.</p><div class="mediaobject"><img src="/graphics/9781782174813/graphics/B04103_04_32.jpg" /><div class="caption"><p>Opening the door using a button press</p></div></div></div>