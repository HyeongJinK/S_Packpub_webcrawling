<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch07lvl1sec40"></a>Blend Shapes</h2></div></div><hr /></div><p>If you <a id="id234" class="indexterm"></a>need to create facial animation, such as facial expressions and lip synching, you'll often need to use <a id="id235" class="indexterm"></a>Blend Shapes or morph animation. This kind of animation is usually created by an artist and animator in 3D software, and then it is imported into Unity. In terms of creation, it requires a two-step process. First, an animator defines all the possible and extreme poses of a face mesh; that is, they position and arrange all the vertices of a face mesh in their extremes, and create a Shape Key, or Blend Shape, to record the state of the mesh in that pose. By recording a series of different poses, the animator can then produce a facial animation in which an average expression is generated as a weighted blend between the ranges of different poses. Consider the next three screenshots, in which a monkey head mesh in<a id="id236" class="indexterm"></a> Blender (<a class="ulink" href="http://www.blender.org" target="_blank">http://www.blender.org</a>) has been set to different and extreme poses. Each pose is recorded in a Shape Key, or Blend Shape. In the<a id="id237" class="indexterm"></a> following screenshot we establish the initial or base pose. Sometimes called the resting pose..</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note22"></a>Note</h3><p>The complete project for this section can be found in this book's companion files inside the <code class="literal">Chapter07/BlendShapes</code> folder.</p></div><div class="mediaobject"><img src="/graphics/9781782174813/graphics/B04103_07_01.jpg" /><div class="caption"><p>Basic pose for the monkey head</p></div></div><p>The following screenshot represents an intermediary pose:</p><div class="mediaobject"><img src="/graphics/9781782174813/graphics/B04103_07_02.jpg" /><div class="caption"><p>Extreme pose 1 for the monkey head</p></div></div><p>The following screenshot defines the final or looping pose:</p><div class="mediaobject"><img src="/graphics/9781782174813/graphics/B04103_07_03.jpg" /><div class="caption"><p>Extreme pose 2 for the monkey head</p></div></div><p>After creating <a id="id238" class="indexterm"></a>a set of vertex arrangements and poses, you can export your mesh from the 3D modelling software via FBX format, as with regular meshes. The export steps differ from package to package. On importing the mesh into Unity, be sure to select the mesh in the Project panel and enable the <span class="strong"><strong>Import</strong></span> <span class="strong"><strong>BlendShapes</strong></span> option from the Object Inspector, as shown in the following screenshot:</p><div class="mediaobject"><img src="/graphics/9781782174813/graphics/B04103_07_04.jpg" /><div class="caption"><p>Importing Blend Shapes with meshes</p></div></div><p>You can easily<a id="id239" class="indexterm"></a> test whether Blend Shapes have been imported properly for your mesh by dragging and dropping the mesh into the scene. Then, from the Object Inspector, expand the <span class="strong"><strong>BlendShapes</strong></span> field. This field will list all the imported Blend Shapes.</p><div class="mediaobject"><img src="/graphics/9781782174813/graphics/B04103_07_05.jpg" /><div class="caption"><p>Accessing Blend Shapes for the selected mesh</p></div></div><p>Typically, the <span class="strong"><strong>BlendShapes</strong></span> fields will map to your model within the 0-100 range. This means that a field will fully apply to your mesh when its value is 100.</p><div class="mediaobject"><img src="/graphics/9781782174813/graphics/B04103_07_06.jpg" /><div class="caption"><p>Testing Blend Shapes for the selected mesh</p></div></div><p>If you need to <a id="id240" class="indexterm"></a>access or change the <span class="strong"><strong>BlendShape</strong></span> weights and values from the script, you can use the <code class="literal">Mesh.BlendShapeCount</code> variable and the <code class="literal">SkinnedMeshRenderer.SetBlendShapeWeight</code> function (<a class="ulink" href="http://docs.unity3d.com/ScriptReference/SkinnedMeshRenderer.SetBlendShapeWeight.html" target="_blank">http://docs.unity3d.com/ScriptReference/SkinnedMeshRenderer.SetBlendShapeWeight.html</a>).</p><p>However, you'll most likely want to animate <span class="strong"><strong>BlendShapes</strong></span>. To do this, you can use the Unity <span class="strong"><strong>Animation</strong></span> window by going to <span class="strong"><strong>Window</strong></span> | <span class="strong"><strong>Animation</strong></span> from the application menu. The details of this window were explained in the previous chapters. As with other mesh properties, you can record keyfames for Blend Shapes. Just scroll through the timeline using the mouse in the <span class="strong"><strong>Animation</strong></span> window, and then set the <span class="strong"><strong>BlendShape</strong></span> values in the Object Inspector for that time. In response, Unity will automatically generate key frames for the Blend Shapes over time.</p><div class="mediaobject"><img src="/graphics/9781782174813/graphics/B04103_07_07.jpg" /><div class="caption"><p>Animating Blend Shapes</p></div></div></div>