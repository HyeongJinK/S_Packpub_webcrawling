<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch07lvl1sec41"></a>Bullets</h2></div></div><hr /></div><p>In this section, we will learn how to create the bullets that our towers will shoot against the enemies.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec22"></a>Creating the bullet prefab</h3></div></div></div><p>Since these bullets are going to be thrown by the towers, we need to create a prefab that allows us to quickly instantiate one of these. In our game environment, the bullets will be arrows. Feel free to use your own graphics, if you have any.</p><p>By right-clicking on the <span class="strong"><strong>Hierarchy</strong></span> panel, we can select <code class="literal">2D Object/Sprite</code> in order to create a new <code class="literal">Sprite</code>. Of course, we need to assign the graphic of the arrow, which can be found in the graphic package, and adjust its scale to fit our game environment. In this case, we can set <code class="literal">1.5</code> to the whole scale vector. Furthermore, we need to set the <span class="emphasis"><em>Z</em></span>-axis of the position to <code class="literal">-2</code>. In the end, the arrow should look like this:</p><p>
</p><div class="mediaobject"><img src="/graphics/9781784393106/graphics/image_07_004.jpg" /></div><p>
</p><p>Next, we need to assign a tag to it. Therefore let's click, in the <span class="strong"><strong>Inspector</strong></span>, on <code class="literal">Tag/New Tag</code>. Now the <span class="strong"><strong>Inspector</strong></span> should display the <span class="strong"><strong>Tags and Layers</strong></span> menu. Since we are interested in tags, expand the <span class="strong"><strong>Tags</strong></span> menu and by clicking on the <span class="strong"><strong>+ </strong></span>we are able to add new tags. In particular, we should add both <code class="literal">Bullet</code> and <code class="literal">Enemy</code>. We will use the last one later on, when we create the enemy. In the end, our screen should look like this:</p><p>
</p><div class="mediaobject"><img src="/graphics/9781784393106/graphics/image_07_005.jpg" /></div><p>
</p><p>Now, come back to our bullet, and finally we can assign the right tag. Furthermore, it's good practice to change the name to <code class="literal">Bullet</code>. As a result, the <span class="strong"><strong>Inspector</strong></span> should appear like this:</p><p>
</p><div class="mediaobject"><img src="/graphics/9781784393106/graphics/image_07_006.jpg" /></div><p>
</p><p>Since the bullet will collide with the enemies, it needs to have a collider attached to it. We can add this by navigating to <span class="strong"><strong>Add Component</strong></span> | <span class="strong"><strong>Physics 2D</strong></span> | <span class="strong"><strong>Box Collider 2D</strong></span>. Of course, if we are using different graphics to the one in the package, we may need to adjust the collider in order to wrap the bullet. In this case, since the graphic is just a rectangle, it is automatically done correctly:</p><p>
</p><div class="mediaobject"><img src="/graphics/9781784393106/graphics/image_07_007.jpg" /></div><p>
</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip21"></a>Tip</h3><p>If we are using our own graphic for the bullet and it has a complex shape, we can also use another kind of collider, such as a <code class="literal">Circle</code> collider or a <code class="literal">Polygon</code> one. Later in the chapter, the enemy's collider can be easily done by using an <code class="literal">Edge</code> collider. However, for the sake of simplicity, we will use the <code class="literal">Box</code> collider 2D throughout the entire project.</p></div><p>Since we want the arrows to be detected from the enemies, inside the collider, we need to set the <span class="strong"><strong>Is Trigger</strong></span> variable to true, as shown in the picture below:</p><p>
</p><div class="mediaobject"><img src="/graphics/9781784393106/graphics/image_07_008.jpg" /></div><p>
</p><p>Another component that we need to detect the collision with the enemies is a <code class="literal">Rigidbody2D</code>. We can add it by navigating to <span class="strong"><strong>Add Component</strong></span> | <span class="strong"><strong>Physics 2D</strong></span> | <span class="strong"><strong>Rigidbody 2D</strong></span>. Furthermore, we need to set its <span class="strong"><strong>Gravity Scale</strong></span> to zero, since our game is top view and we don't want to see our bullet fall off the map. We could also change the gravity in the <span class="strong"><strong>Physics</strong></span> settings, but since we are not going to use it, just keep the <span class="strong"><strong>Gravity Scale</strong></span> at 0. The whole Inspector should now look like the following:</p><p>
</p><div class="mediaobject"><img src="/graphics/9781784393106/graphics/image_07_009.jpg" /></div><p>
</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip22"></a>Tip</h3><p>Another interesting feature that can make our bullet/arrow more realistic is a Trailer Renderer. In this way, when it is thrown, we can easily implement a small tail that, by adjusting the setting properly, could be made to look like the air movement behind the arrow, typical of any comic/toon graphics.</p></div><p>Finally, we need to create a new Prefab by right-clicking on the <span class="strong"><strong>Project</strong></span> panel and then selecting <span class="strong"><strong>Create</strong></span> | <span class="strong"><strong>Prefab</strong></span>. Drag the arrow inside it, and erase the old one from the scene.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch07lvl2sec23"></a>Scripting the bullet</h3></div></div></div><p>After having selected the prefab that we created in the previous section, let's add a new C# script to it by clicking on <span class="strong"><strong>Add Component</strong></span> | <span class="strong"><strong>New Script</strong></span>. The main aim of this script is to move the bullet along a direction, and this can be done in a few lines of code.</p><p>First, we need to create two variables. One is for the speed and the other one is for the direction.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip23"></a>Tip</h3><p>Please note that the direction will be assigned dynamically from the tower when it shoots, whereas the value of the speed will be stored in the prefab and doesn't change at runtime, at least in this implementation. Of course, you can play with this speed value and add more lines to make it change so you have different kinds of bullets.</p></div><p>Therefore, we can write the following:</p><pre class="programlisting">  public float speed = 1f; &#13;
  public Vector3 direction; &#13;
</pre><p>If our bullet cannot hit an enemy, we should prevent it from going on forever. We can achieve this by delaying the destruction of the bullet by 10 seconds. This means that after an amount of time, the bullet will be destroyed. Furthermore, we need to properly rotate the bullet toward the direction where it is heading, so the arrow will point toward that direction. To do this, we first normalize the direction, in case it isn't already, and then we calculate the angle. In doing this, we need to flip both the <span class="emphasis"><em>X</em></span> and <span class="emphasis"><em>Y</em></span>-axes, since our arrow is pointing left. Thus, let's write in the <code class="literal">Start()</code> function the following lines:</p><pre class="programlisting">  void Start () { &#13;
    direction = direction.normalized; &#13;
    float angle = Mathf.Atan2(-direction.y, -direction.x) * Mathf.Rad2Deg; &#13;
    transform.rotation = Quaternion.AngleAxis(angle, Vector3.forward); &#13;
    Destroy(gameObject, 10); &#13;
  }  &#13;
</pre><p>Finally, in the <code class="literal">Update()</code> function, we need to move the bullet in that direction:</p><pre class="programlisting">  void Update () { &#13;
    transform.position += direction * Time.deltaTime * speed; &#13;
  } &#13;
</pre><p>And that's all for the bullet. So, after we have saved the prefab, since we added our script and we therefore need to update it, let's move to the next section to learn how to build the towers that will shoot these bullets.</p></div></div>