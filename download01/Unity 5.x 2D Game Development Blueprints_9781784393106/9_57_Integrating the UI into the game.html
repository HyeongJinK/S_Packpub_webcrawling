<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch09lvl1sec54"></a>Integrating the UI into the game</h2></div></div><hr /></div><p>Now that we have our enemies ready to challenge the player, let's integrate the UI that we have created in the previous chapter into the game.</p><p>In particular, we are going to see how to integrate the <span class="strong"><strong>Lives Counter</strong></span> and the <span class="strong"><strong>Money Counter</strong></span> since they are the two core gameplay elements.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl2sec42"></a>Integrating the Lives Counter</h3></div></div></div><p>We need to integrate the lives counter for situations such as when an enemy reaches the end of its path, the number of lives of the player is decreased. This happens in the following way: the enemy triggers a function in the Game Manager when it has reached the end, and the Game Manager updates the number of lives in the Lives Counter.</p><p>Therefore, let's start by opening our <code class="literal">GameManagerScript</code> and adding another variable. This is required to store the <code class="literal">LivesCounterScript</code> reference, so that we can have access to the lives of the player:</p><pre class="programlisting">private LivesCounterScript livesCounter; &#13;
</pre><p>To get the reference, we can set the variable inside the <code class="literal">Start()</code> function:</p><pre class="programlisting">  void Start () { &#13;
        livesCounter = GameObject.Find("LivesCounter").GetComponent&lt;LivesCounterScript&gt;(); &#13;
  } &#13;
</pre><p>Now we need to add a function that is called from the enemy and updates the number of lives:</p><pre class="programlisting">    public void enemyHasReachedTheFortress() { &#13;
        livesCounter.loseLife(10); &#13;
    } &#13;
</pre><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip28"></a>Tip</h3><p>As you can see, there is a <code class="literal">10</code> in the code. This is the <span class="emphasis"><em>number of lives</em></span> that the player loses for every enemy that has reached the end of its path. A much better solution is to create a public variable that can be freely set in the <span class="strong"><strong>Inspector</strong></span> of the Game Manager, so that we can change this value more quickly. As a result, your code will be more flexible. However, there is also a more flexible solution, where this value is stored inside the <code class="literal">Enemy</code> prefab. In this way, it changes with different enemies, and it can be passed as a parameter to the <code class="literal">enemyHasReachedTheFortress()</code> function. The implementation of both alternatives is left as an exercise.</p></div><p>Save the script and then open the <code class="literal">EnemyScript</code>. Here, we have to call the function that we have just created. From the previous section, we saw how this script receives a reference to the Game Manager inside the variable <code class="literal">gameManager</code>, so we don't need to get the reference again.</p><p>Now, immediately after <code class="literal">if(counter==waypoints.Length){</code> and before <code class="literal">Destroy(gameObject);</code>, we need to add the following line of code that just calls the function in the <code class="literal">GameManager</code>:</p><pre class="programlisting">  void Update () { &#13;
    if(counter==waypoints.Length){ &#13;
              gameManager.enemyHasReachedTheFortress(); &#13;
      Destroy(gameObject); &#13;
      return; &#13;
    }else{ &#13;
    //... &#13;
</pre><p>Finally, save this script so that the Lives Counter is integrated in our game.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch09lvl2sec43"></a>Integrating the Money Counter</h3></div></div></div><p>Integrating the Money Counter is easier than the previous UI element. This is because we don't have to pass through the <code class="literal">GameManagerScript</code>. This is due to the fact that the money doesn't deal directly with the <span class="strong"><strong>Game Over</strong></span> conditions, but we will see this in a little while.</p><p>Open the <code class="literal">EnemyScript</code> and let's add a variable to keep track of our Money Counter:</p><pre class="programlisting">private MoneyCounterScript moneyCounter; &#13;
</pre><p>To get the reference of the <code class="literal">MoneyCounterScript</code> and store it in the variable, as we did for the Lives Counter, we need to add a line in the <code class="literal">Start()</code> function of the enemy:</p><pre class="programlisting">  void Start () { &#13;
        gameManager = GameObject.Find("GameManager").GetComponent&lt;GameManagerScript&gt;(); &#13;
     moneyCounter = GameObject.Find("MoneyCounter").GetComponent&lt;MoneyCounterScript&gt;(); &#13;
        waypoints = gameManager.waypoints; &#13;
  } &#13;
</pre><p>Now, inside the <code class="literal">OnTriggerEnter2D()</code> function, and immediately after the <code class="literal">if(other.tag == "Bullet")</code>, we can call a <code class="literal">changeMoney()</code> function to increase the amount of money that the player has:</p><pre class="programlisting">  void OnTriggerEnter2D(Collider2D other) { &#13;
    if(other.tag == "Bullet"){ &#13;
             moneyCounter.changeMoney(80); &#13;
      Destroy(other.gameObject); &#13;
      Destroy(gameObject); &#13;
    } &#13;
  } &#13;
</pre><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip29"></a>Tip</h3><p>As you can see, there is an <code class="literal">80</code> in the code. This is the <span class="emphasis"><em>amount of money </em></span>that the player has earned when they kill an enemy. A much better solution is to create a public variable. Therefore, it is easily adjusted in the <span class="strong"><strong>Inspector</strong></span> of the prefab for this specific enemy. In addition, we can have different instances of this script with different values. This means having different enemies that give a different amount of money to the player. Furthermore, another interesting way to do this is to set a random value. As a result, your code will be more flexible to improve your gameplay. The implementation of the two alternatives is left as an exercise.</p></div><p>Save the script, and now the Money Counter is integrated into our game.</p></div></div>