<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch02lvl1sec19"></a>Coding with components</h2></div></div><hr /></div><p>
<code class="literal">Components</code> in Unity are the building blocks of any game; almost everything you will use or apply will end up as a <code class="literal">Component</code> on a <code class="literal">GameObject</code> in a scene. When a <code class="literal">GameObject</code> is selected, you can view each of its <code class="literal">Components</code> from its Inspector.</p><p>You will find that you need to access these various components with script. Next we will discuss the various ways on which you can do this.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec26"></a>Accessing components</h3></div></div></div><p>To reference the components of a GameObject from within your code, you need to use the <code class="literal">GetComponent</code> function. The following shows you examples of how this is achieved:</p><pre class="programlisting">Rigidbody myScriptRigidBody; 
void Awake() 
{  
  var renderer = this.GetComponent&lt;Renderer&gt;(); 
  var collider = renderer.GetComponent&lt;Collider&gt;(); 
  myScriptRigidBody = collider.GetComponent&lt;Rigidbody&gt;(); 
} 
void Update() 
{ 
  myScriptRigidBody.angularDrag = 0.2f * Time.deltaTime; 
} 
</pre><p>This way, the <code class="literal">Rigidbody</code> object that we want to affect can simply be discovered once (when the scripts awakes); then, we can just update the reference each time a value needs to be changed instead of discovering it every time.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec27"></a>Referencing a component</h3></div></div></div><p>Now, it has been pointed out (by those who like to test such things) that even the <code class="literal">GetComponent</code> call isn't as fast as it should be because it uses C# generics to determine what type of component you are asking for (it's a two-step process: first, you determine the type, and then get the component).</p><p>However, there is another overload of the <code class="literal">GetComponent</code> function in which, instead of using generics, you just need to supply the type (therefore removing the need to discover it). To do this, we will simply use the following code instead of the preceding <code class="literal">GetComponent&lt;&gt;</code>:</p><pre class="programlisting">myScriptRigidBody =(Rigidbody2D)GetComponent    (typeof(Rigidbody2D)); 
</pre><p>The preceding code is slightly longer and arguably only gives you a marginal increase, but if you need to use every byte of the processing power, it is worth keeping in mind.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec28"></a>Controlling the hero</h3></div></div></div><p>A sprite that only stands on the screen isn't going to make much of a game, so we'll add a script to allow the player to move the hero to the left or right. Before we can do that, we need to add a few more components to the character. More specifically, we need to add the <code class="literal">Rigidbody2D</code> component and the <code class="literal">BoxCollider2D</code> component.</p><p>The <code class="literal">Rigidbody2D</code> component will allow our character to be manipulated by physics. This will give us the ability to give her a velocity (or speed) value. The <code class="literal">BoxCollider2D</code> component gives us the ability to check to see if she is touching other objects.</p><p>Let's add the two components to our character:</p><div class="orderedlist"><ol class="orderedlist arabic" type="1"><li><p>Select the player from either the Hierarchy list or by selecting the sprite in your scene.</p></li><li><p>Add a <code class="literal">Rigidbody2D</code> component by navigating to <span class="strong"><strong>Add Component</strong></span> | <span class="strong"><strong>Physics 2D</strong></span> | <span class="strong"><strong>Rigidbody 2D</strong></span> in the player's <code class="literal">GameObject</code> inspector.</p></li><li><p>Set the <span class="strong"><strong>Gravity Scale</strong></span> parameter to 0 (as we are not using gravity) and check the <span class="strong"><strong>Freeze Rotation Z</strong></span> checkbox.</p></li><li><p>Next, add a <code class="literal">BoxCollider2D</code> component by navigating to <span class="strong"><strong>Add Component</strong></span> | <span class="strong"><strong>Physics2D</strong></span> | <span class="strong"><strong>Box Collider 2D</strong></span>.</p></li><li><p>Select <span class="strong"><strong>Is Trigger</strong></span>. This lets Unity know that we will be using the <code class="literal">BoxCollider2D</code> to check if the character is touching object rather than stopping it from passing through objects.</p></li></ol></div><p>This should give you the following view in the inspector:</p><p>
</p><div class="mediaobject"><img src="/graphics/9781786463456/graphics/image_02_051.jpg" /></div><p>
</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip28"></a>Tip</h3><p>If we were making a game that used gravity, the <code class="literal">Rigidbody2D</code> component would allow our character to be affected by gravity. We would also give our character two <code class="literal">BoxCollider2D</code> components. One component to check to see if the character touched other objects (<span class="strong"><strong>Is Trigger</strong></span> selected) and another to keep our character from passing through other objects (<span class="strong"><strong>Is Trigger</strong></span> not selected).</p></div><p>To finish off this chapter, add a new C# script and save it as <code class="literal">Assets\Scripts\CharacterMovement.cs</code>. Open the script in the editor and replace its contents with the following script:</p><pre class="programlisting">using UnityEngine; 
using System.Collections; 
 
public class CharacterMovement : MonoBehaviour{ 
  // RigidBody component instance for the player 
  private Rigidbody2D playerRigidBody2D; 
 
 
 //Variable to track how much movement is needed from input 
  private float movePlayerHorizontal; 
  private float movePlayerVertical; 
  private Vector2 movement; 
 
  // Speed modifier for player movement 
  public float speed = 4.0f; 
 
  //Initialize any component references 
  void Awake(){ 
        playerRigidBody2D = (Rigidbody2D)GetComponent(typeof(Rigidbody2D)); 
 
  } 
 
  // Update is called once per frame 
  void Update () { 
        movePlayerHorizontal = Input.GetAxis("Horizontal"); 
        movePlayerVertical = Input.GetAxis("Vertical"); 
        movement 
          = new Vector2(movePlayerHorizontal,movePlayerVertical); 
 
        playerRigidBody2D.velocity=movement*speed; 
 
  } 
}  
</pre><p>The preceding script is fairly basic; it simply has some parameters to control the speed and its movement direction. We will adjust the character's sprite later when we learn to animate her. The <code class="literal">update</code> method checks if the player is controlling the game using the default horizontal keys (left and right) and vertical keys (up and down) and then applies force to move the hero accordingly.</p><p>To finish off, add the script to the player's game object by either dragging it to the object in the Hierarchy or navigating to <span class="strong"><strong>Add Component</strong></span> | <span class="strong"><strong>Scripts</strong></span> | <span class="strong"><strong>Character Movement</strong></span>.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note29"></a>Note</h3><p>You should note that this very simple controller code only uses a keyboard input. We will later discuss how to implement this for touchscreen devices.</p></div><p>If you run the project now by pressing the play button at the top of the screen, you should see our hero on the screen, and using arrows on the keyboard, the character will move around the screen.</p></div></div>