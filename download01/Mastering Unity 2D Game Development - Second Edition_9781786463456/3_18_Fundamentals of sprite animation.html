<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch03lvl1sec22"></a>Fundamentals of sprite animation</h2></div></div><hr /></div><p>In this section, we will discuss, in general, the features included in Unity that can be used to create a sprite sheet animation. There are three main features that will be used to create a fully animated sprite character: <span class="strong"><strong>Animation clips</strong></span>, <span class="strong"><strong>Animation Controllers</strong></span>, and <span class="strong"><strong>Animator components</strong></span>.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec29"></a>Animation clips</h3></div></div></div><p>Animation clips are the heart of the animation system within Unity. All animations are saved with the <code class="literal">.anim</code> file extension. The animation <span class="strong"><strong>Dope Sheet</strong></span> system (as shown in the following screenshot) is very advanced; in fact, it tracks almost every change in the Inspector for sprites, allowing you to animate just about everything. You can even control which sprite from a <span class="strong"><strong>sprite sheet</strong></span> is used for each frame of the animation:</p><p>
</p><div class="mediaobject"><img src="/graphics/9781786463456/graphics/image_03_001.jpg" /></div><p>
</p><p>The preceding screenshot shows a three-frame sprite animation and a modified <span class="emphasis"><em>x</em></span> position modifier for the middle image, giving a hopping effect to the sprite as it runs.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip30"></a>Tip</h3><p>Sprites don't have to be picked from the same sprite sheet to be animated. They can come from individual textures or be picked from any sprite sheet you have imported.</p></div><p>Note that you are not limited to the whole character animation with the animation system; you can also construct characters from several sprites and animate them individually, as shown in Unity's own 2D platform sample, which is available at the Unity <span class="strong"><strong>Asset Store</strong></span> (<a class="ulink" href="http://bit.ly/UnityPlatformer2D" target="_blank">http://bit.ly/UnityPlatformer2D</a>):</p><p>
</p><div class="mediaobject"><img src="/graphics/9781786463456/graphics/image_03_002.jpg" /><div class="caption"><p>Character constructed from multiple Sprites</p></div></div><p>
</p><p>In the preceding screenshot, you can see all the parts of the hero in the <span class="strong"><strong>Hierarchy</strong></span>, such as the body, mustache, feet, and bazooka as separate sprites; then, in the animation <span class="strong"><strong>Dope Sheet</strong></span>, the <span class="strong"><strong>Run</strong></span> animation alters the position of each of these sprites to emulate a fast walking effect. This feature can be used in a powerful way once you get your head around what is possible.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch03lvl3sec17"></a>Animation Dope Sheet</h4></div></div></div><p>The animation <span class="strong"><strong>Dope Sheet</strong></span> can be used to make simple or complex animations, as shown in the following screenshot:</p><p>
</p><div class="mediaobject"><img src="/graphics/9781786463456/graphics/image_03_003.jpg" /><div class="caption"><p>Animation Dope Sheet</p></div></div><p>
</p><p>Navigating around the <span class="strong"><strong>Animation</strong></span> editor (as shown in the preceding screenshot), we have the following sections:</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h5 class="title"><a id="ch03lvl4sec3"></a>The time/recording controls (1)</h5></div></div></div><p>The time controls let you play or step through your recorded animation to see how it flows. This is especially useful when combined with the active play in the <span class="strong"><strong>Scene</strong></span> and <span class="strong"><strong>Game</strong></span> views.</p><p>The record button determines whether the changes in the <span class="strong"><strong>Scene</strong></span> or <span class="strong"><strong>Inspector</strong></span> panes will affect the <span class="strong"><strong>Animation</strong></span> properties and will add new ones if a property has not been touched yet.</p><p>There are also the buttons to add new <span class="strong"><strong>KeyFrames</strong></span> (specific points on the timeline at the currently selected time) or <span class="strong"><strong>Animation Events</strong></span> (script launching points based on time).</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h5 class="title"><a id="ch03lvl4sec4"></a>Animation drop-down selection (2)</h5></div></div></div><p>This is a simple list of all the clips in the current animation set/controller. It also has the facility to add more clips directly from this drop-down menu.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h5 class="title"><a id="ch03lvl4sec5"></a>The sample rate (frames per second) (3)</h5></div></div></div><p>The sample rate sets the number of frames per second available in the timeline. It controls the number of key frame points possible between time intervals. It defaults to <code class="literal">60fps</code>.</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip31"></a>Tip</h3><p>Be sure to be aware of what frame rate your sprite sheets where made in. Many 2D animation systems run at <code class="literal">24fps</code>, and you will likely need to adjust this for your animation to perform as expected.</p></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h5 class="title"><a id="ch03lvl4sec6"></a>Animation properties (4)</h5></div></div></div><p>Animation properties list all the different <span class="strong"><strong>Inspector</strong></span> properties that are being controlled by this animation clip. If a property is touched in the editor while the record mode is active, it will create a new property in the animator or alter the existing property in real time.</p><p>While in the record mode, <span class="emphasis"><em>any</em></span> change in the editor will be captured. This includes any child GameObject properties that you change. This becomes very useful if your animated objects comprise multiple sprites in the child GameObjects.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h5 class="title"><a id="ch03lvl4sec7"></a>Timeline (5)</h5></div></div></div><p>The timeline window shows all the key frames being animated over the lifetime of the animation. Setting the sample rate higher and lower will control how many key points/frames will be available between time units.</p><p>You can also use the following keyboard shortcuts to navigate between the frames on the timeline:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>Press comma (<span class="emphasis"><em>,</em></span>) to go to the previous frame</p></li><li style="list-style-type: disc"><p>Press period (<span class="emphasis"><em>.</em></span>) to go to the next frame</p></li><li style="list-style-type: disc"><p>Press <span class="emphasis"><em>Alt</em></span> + Comma (<span class="emphasis"><em>,</em></span>) to go to the previous key frame</p></li><li style="list-style-type: disc"><p>Press <span class="emphasis"><em>Alt</em></span> + Period (<span class="emphasis"><em>.</em></span>) to go to the next key frame</p></li></ul></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h5 class="title"><a id="ch03lvl4sec8"></a>Curve view (6)</h5></div></div></div><p>The timeline view has an alternate view mode to add finer control and curves between the key frame animations, as shown in the following screenshot:</p><p>
</p><div class="mediaobject"><img src="/graphics/9781786463456/graphics/B05553_03_04.jpg" /><div class="caption"><p>Curve view in Animation window</p></div></div><p>
</p><p>Editing the curves takes a little finesse but makes for a better looking transition than the default <code class="literal">Boolean</code> (on/off) effect.</p><p>You can further control the curves by setting the inbound and outbound tangents of the curve, setting either a smooth (linear), sharp (constant), or free-form curve. Simply play with these settings until you have the kind of curve you want.</p><p>We'll cover curves in <a class="link" href="#" linkend="ch09">Chapter 9</a>, <span class="emphasis"><em>Getting Ready to Fight</em></span>, where we'll learn a few of the slightly more complex curves and animations.</p></div></div></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec30"></a>The Animation Controllers</h3></div></div></div><p>Animation Controllers are simply state machines, systems that store states and the transitions between them, that are used to control when an animation should be played and what conditions control the transition between each state. Animation Controllers are saved with the file extension <code class="literal">.controller</code>. An animation cannot play without a controller and a controller can contain many animations.</p><p>Lets look at the following screenshot:</p><p>
</p><div class="mediaobject"><img src="/graphics/9781786463456/graphics/image_03_005.jpg" /><div class="caption"><p>Animation state machine</p></div></div><p>
</p><p>In the preceding screenshot, the gray rectangles represent animation states and the orange rectangle represents the default animation state. The states do not have to be animations, but instead can be a game state. The arrows represent transitions between animation states. <span class="strong"><strong>Entry</strong></span> and <span class="strong"><strong>Exit</strong></span> nodes were added to the <span class="strong"><strong>State Machine Transitions</strong></span> in Unity 5 and they tell the state machine what it should do when it starts and when it should exit. You can have various layers of animation. We will discuss the use of this system to handle game states, rather than just animations, and describe state machines in further detail in <a class="link" href="#" linkend="ch08">Chapter 8</a>, <span class="emphasis"><em>Encountering Enemies and Running Away.</em></span>
</p><p>A parameter is essentially a variable that we will be able to access later from our character controller script. Within our script, we can tell our parameters to take on values, thus making the animations transition when we want them to.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch03lvl2sec31"></a>The Animator component</h3></div></div></div><p>To use an animation prepared in a controller, you need to apply it to a GameObject in the scene. This is done through the <span class="strong"><strong>Animator</strong></span> component, as shown in the following screenshot:</p><p>
</p><div class="mediaobject"><img src="/graphics/9781786463456/graphics/image_03_006.jpg" /><div class="caption"><p>Animator component</p></div></div><p>
</p><p>The only property we actually care about in 2D is the <span class="strong"><strong>Controller</strong></span> property. In it, you specify which controller is to be attached to the GameObject.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note32"></a>Note</h3><p>Other properties only apply to the 3D humanoid models, so we can ignore them for 2D.</p></div></div></div>