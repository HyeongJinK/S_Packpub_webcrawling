<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch02lvl1sec17"></a>Classes</h2></div></div><hr /></div><p>Architecting the core of your game from the beginning is an often-skipped process. Many developers are too eager to build their game and just start placing assets in a scene as they go. This kind of practice is fine for prototypes (mostly, however, even with prototypes, a level of architecture is usually required). When building your actual project, however, without setting up a proper architecture from the beginning, you are heading toward a world of utter mess.</p><p>When we say architecture, it doesn't mean that you need to design everything (but it helps). You just need to ensure that you plan what you are going to build before you build it instead of thinking about stuff and checking Google for information on how to do it. Even if you are using some kind of an agile method, you should have a good framework and goal for each step. This will guide you on what should be done and when, not just designing the project on the fly.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec22"></a>MonoDevelop</h3></div></div></div><p>When you create a new script in Unity, you will create a new class. To create a new script, select <span class="strong"><strong>Create</strong></span> | <span class="strong"><strong>C# Script</strong></span>.</p><p>When you double-click on the script, <span class="strong"><strong>MonoDevelop</strong></span> will open. MonoDevelop is the <span class="strong"><strong>Integrated Development Environment</strong></span> (<span class="strong"><strong>IDE</strong></span>) that comes with Unity:</p><p>
</p><div class="mediaobject"><img src="/graphics/9781786463456/graphics/image_02_043.jpg" /><div class="caption"><p>MonoDevelop an IDE</p></div></div><p>
</p><p>This means that all code will be open, edited, and ran from within MonoDevelop. You can use other editors, such as Microsoft Visual Studio, but we will use MonoDevelop exclusively in this text.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note24"></a>Note</h3><p>If double-clicking on a script causes an editor other than MonoDevelop to open, you can change the default editor back to MonoDevelop by selecting <span class="strong"><strong>Edit</strong></span> | <span class="strong"><strong>Preferences</strong></span> | <span class="strong"><strong>External Tools</strong></span> and making sure MonoDevelop is set as the <span class="strong"><strong>External Script Editor</strong></span>:</p><p>
</p><div class="mediaobject"><img src="/graphics/9781786463456/graphics/image_02_044.jpg" /></div><p>
</p></div><p>When a new script is created, its name must also match the class, as shown in the following screenshot:</p><p>
</p><div class="mediaobject"><img src="/graphics/9781786463456/graphics/image_02_045.jpg" /></div><p>
</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec23"></a>The object-orientated design</h3></div></div></div><p>Unity is a fully <span class="strong"><strong>object-orientated</strong></span> (<span class="strong"><strong>OO</strong></span>) system with strict interfaces to ensure that the engine knows what to expect and when, so why shouldn't your game follow the same pattern? Unity is also component-based, which is something you should take into account while designing how your game will be put together.</p><p>At the core of any OO design, the focus is on reusability. If a set of attributes is repeatedly used across multiple objects, then they should be separated into one common <span class="emphasis"><em>class</em></span> and shared. In addition to this, you should also reduce the amount of code that is doing the same job. This means that we can more easily make changes to this base set without having to re-edit all the classes that might need those attributes. The following diagram shows two approaches of using a base class to define common attributes over multiple code implementations:</p><p>
</p><div class="mediaobject"><img src="/graphics/9781786463456/graphics/image_02_046.jpg" /></div><p>
</p><p>Another facet of OO design is to employ interfaces to govern exactly how a class should look if you have multiple objects of the same type. For example, if you have an <code class="literal">Enemy</code> class structure that defines how enemies in general should work, then, using that same structure, you specify all the enemy implementations. Interfaces can also define behaviors or methods on a class, so you can ensure that all the classes that implement that interface will always have the same common abilities, such as all the enemies will have <code class="literal">patrol</code>, <code class="literal">Fight</code>, and <code class="literal">run away</code> methods. This means that if you have an enemy object, it will always have those methods attached to them when you refer to them in the code.</p><p>The following diagram shows how you can plan for multiple inheritances, allowing you to add a common behavior pattern to each group of entities:</p><p>
</p><div class="mediaobject"><img src="/graphics/9781786463456/graphics/image_02_047.jpg" /></div><p>
</p><p>Knowing this helps us design our game effectively and ensures that we architect it correctly from the beginning.</p><p>We'll discuss these patterns in more detail when we implement them in the following sections.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch02lvl2sec24"></a>The game structure</h3></div></div></div><p>To keep in line with the preceding architecture set, we'll design the layout of the class to support a flexible structure that will be easily extended in the future.</p><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h4 class="title"><a id="ch02lvl3sec16"></a>The common game object</h4></div></div></div><p>As almost every entity in our game will have statistics and some basic behaviors, we start with a generic object (<code class="literal">Entity</code>) to define the attributes that all the entities in our game will have. As there is only one entity type, we don't need to set up an interface for this object as all the other game objects will just use this one definition, as shown in the following diagram:</p><p>
</p><div class="mediaobject"><img src="/graphics/9781786463456/graphics/image_02_048.jpg" /></div><p>
</p><p>This shows that we have several common attributes for things such as health and strength.</p><p>Create a new class within your <code class="literal">Scripts</code> folder by selecting <span class="strong"><strong>Create</strong></span> | <span class="strong"><strong>C# Script</strong></span>. Name the script <code class="literal">Entity</code>.</p><p>Type the following code into your new <code class="literal">Entity</code> class:</p><pre class="programlisting">using UnityEngine; 
public class Entity : ScriptableObject { 
  public string Name; 
  public int Age; 
  string Faction; 
  public string Occupation; 
  public int Level = 1; 
  public int Health = 2; 
  public int Strength = 1; 
  public int Magic = 0; 
  public int Defense = 0; 
  public int Speed = 1; 
  public int Damage = 1; 
  public int Armor = 0; 
  public int NoOfAttacks = 1; 
  public string Weapon; 
  public Vector2 Position; 
} 
</pre><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="tip25"></a>Tip</h3><p>An interesting feature of Unity involves its handling of <code class="literal">public</code> variables. Whenever a variable is set to public, its values can be easily accessed and adjusted from the GameObject's inspector, rather than actually adjusting it within the script.</p></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h5 class="title"><a id="ch02lvl4sec2"></a>The player object</h5></div></div></div><p>Basing the player's character on the <code class="literal">Entity</code> object makes the definition of the player a lot simpler. So, you only need to focus on what is specific to the player's character itself, that is, the differences between the player and all the other game entities:</p><p>
</p><div class="mediaobject"><img src="/graphics/9781786463456/graphics/image_02_049.jpg" /></div><p>
</p><p>So, the player character we see here is the only one who has <span class="strong"><strong>Inventory</strong></span>, <span class="strong"><strong>Money</strong></span>, and <span class="strong"><strong>Skills</strong></span> since they are specific to our hero's work in our game. Create another class within your <code class="literal">Scripts</code> folder. Name the script <code class="literal">Player</code>. In the following code, the player inherits all the properties from the <code class="literal">Entity</code> class:</p><pre class="programlisting">using UnityEngine; 
public class Player : Entity { 
  public string[] inventory; 
  public string[] skills; 
  public int money; 
} 
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note26"></a>Note</h3><p>Preferably, all the attributes of any class should be of the read-only type outside of the class itself (unless there is a very good reason for it). This is to ensure that you don't mistakenly change a class's value without knowing why. It might sound easier to just keep updating everything, but at some point, while you are debugging, you will want to know why things are changing. If any code updates these values, then you will literally spend hours trying to find why. If you need to change values, then you need to implement behaviors (see the following sections).</p></div><p>To show you how to build the architecture progressively in this project, we will add more classes to each section; we'll keep things simple and build the project with a strong foundation.</p><p>We already have our base entity in place from which all the game entities as well as our player are driven, so let's look at implementing them further.</p></div></div></div></div>