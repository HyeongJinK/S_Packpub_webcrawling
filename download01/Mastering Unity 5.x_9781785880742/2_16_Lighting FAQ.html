<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch02lvl1sec20"></a>Lighting FAQ</h2></div></div><hr /></div><p>This section takes time out to explore lighting issues and problems that sometimes arise and common methods for resolving them. The issues listed here may not arise for the <span class="emphasis"><em>Dead Keys</em></span> project specifically, but it's likely you'll encounter them somewhere, on some projects. Consequently, it's good to know how the issues are solved or at least avoided. This section takes a Question and Answer format:</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>
<span class="strong"><strong>Scene lighting appears wrong when opening a scene in the editor</strong></span>: This happens when <span class="strong"><strong>Auto</strong></span> is enabled from the <span class="strong"><strong>Lighting</strong></span> window. As the scene is opened, lighting is rebaked. This may take time or may fail entirely. The result is that scene lighting may not appear correct instantly when a scene is opened. You can resolve this by disabling auto baking from the <span class="strong"><strong>Lighting</strong></span> window and then saving the scene to confirm the change. The next time the scene is opened, the existing baked data will be used instead.</p></li></ul></div><p>
</p><div class="mediaobject"><img src="/graphics/9781785880742/graphics/image_02_047.jpg" /></div><p>
</p><p>Disabling Auto for baking</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>
<span class="strong"><strong>Scene lighting is baked, but appears messed up in the scene</strong></span>: If lighting looks wrong on the meshes, such as a jumbled mess with shadows, colors, and highlights appearing in the wrong places, then you can try the following two steps in order. First, make sure all meshes either have a second UV channel for a lightmap or have the <span class="strong"><strong>Generate Lightmap UV</strong></span> option enabled via the object <span class="strong"><strong>Inspector</strong></span>. This is important because lightmaps are baked to a texture through a second UV channel.</p></li></ul></div><p>
</p><div class="mediaobject"><img src="/graphics/9781785880742/graphics/image_02_048.jpg" /></div><p>
</p><p>Generating Lightmap UVs</p><p>Secondly, you can try enabling the <span class="strong"><strong>Swap UVs</strong></span> option when <span class="strong"><strong>Generate Lightmap UV</strong></span> is disabled, from the object <span class="strong"><strong>Inspector</strong></span>, as the wrong UV channel may have been used for the lightmap. In any case, a complete rebake will be required.</p><p>
</p><div class="mediaobject"><img src="/graphics/9781785880742/graphics/image_02_049.jpg" /></div><p>
</p><p>Swapping Lightmap UVs</p><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>
<span class="strong"><strong>Some lights don't work!</strong></span>: Here's a common problem. You add a light to the scene and it works fine. Then you add a second, and that works fine too. But then, after adding more, you soon discover that additional lights behave differently in an important way. Some have no affect at all or some illuminate the environment with less or more intensity than expected, despite having the same settings as earlier lights. This problem could be related to the light quality settings and per-pixel Lights. In Unity, there are two main light types: vertex-based and pixel-based. Vertex-based lights are less accurate and typically produce lower quality lighting. But they're cheaper to calculate and work better on legacy hardware. This is because they illuminate meshes by interpolating light across their vertices. Pixel-based lights, in contrast, produce better lighting, but are calculated on pixel basis, as opposed to vertices. This makes them computationally expensive. By default, Unity specifies a maximum of four per-pixel lights in the <span class="strong"><strong>QualitySettings</strong></span>, and it makes a determination at runtime as to whether a light should be pixel-based or vertex-based, in line with the <span class="strong"><strong>QualitySettings</strong></span>. </p><p>This means that, after four per-pixel lights are added to the scene and are active, Unity automatically converts additional lights to vertex-based lights, and these illuminate differently. There are two different ways to solve this problem. First, you can increase the number of per-pixel lights permitted at one time in a scene, using the <span class="strong"><strong>Qual</strong></span>
<span class="strong"><strong>
<span class="strong"><strong>ityS</strong></span>ettings</strong></span>. To do this, navigate to <span class="strong"><strong>Edit</strong></span> | <span class="strong"><strong>Project Settings</strong></span> | <span class="strong"><strong>Quality</strong></span> from the application menu, to display <span class="strong"><strong>Quality</strong></span>
<span class="strong"><strong>
<span class="strong"><strong>S</strong></span>ettings</strong></span> in the object <span class="strong"><strong>Inspector</strong></span>.</p><p>
</p><div class="mediaobject"><img src="/graphics/9781785880742/graphics/image_02_050.jpg" /></div><p>
</p><p>Accessing QualitySettings</p><p>From here, specify a new maximum for the <span class="strong"><strong>Pixel Light Count</strong></span> field in the object <span class="strong"><strong>Inspector</strong></span>. This increases the maximum number of pixel lights permitted.</p><p>
</p><div class="mediaobject"><img src="/graphics/9781785880742/graphics/image_02_051.jpg" /></div><p>
</p><p>Setting the maximum number of per-pixel lights</p><p>You can force Unity to recognize a light as either vertex-based or pixel-based, using the <span class="strong"><strong>Render Mode</strong></span> setting for the light object, in the <span class="strong"><strong>Light</strong></span> component from the object <span class="strong"><strong>Inspector</strong></span>. This overrides the determination Unity makes for each light. Simply change the <span class="strong"><strong>Render Mode</strong></span> from <span class="strong"><strong>Auto</strong></span> (let Unity decide) to either <span class="strong"><strong>Important</strong></span> (pixel-based) or <span class="strong"><strong>Not Important</strong></span> (vertex-based).</p><p>
</p><div class="mediaobject"><img src="/graphics/9781785880742/graphics/image_02_052.jpg" /></div><p>
</p><p>Setting the Light Render Mode</p></li><li style="list-style-type: disc"><p>
<span class="strong"><strong>Objects don't cast or receive shadows</strong></span>: If your scene is missing shadows and you don't know why, there are several important stages where problems can occur. First, ensure the selected light is configured for shadow casting. To do this, set the <span class="strong"><strong>Shadow Type</strong></span> field, from the object <span class="strong"><strong>Inspector</strong></span>, to either <span class="strong"><strong>Soft Shadows</strong></span> or <span class="strong"><strong>Hard Shadows</strong></span>.</p><p>
</p><div class="mediaobject"><img src="/graphics/9781785880742/graphics/image_02_053.jpg" /></div><p>
</p><p>Specifying Shadow Type for a light</p><p>Next, make sure other renderable meshes can <span class="emphasis"><em>cast</em></span> and <span class="emphasis"><em>receive</em></span> shadows as needed. Shadow casting is the ability for a mesh to cast a shadow elsewhere; and shadow receiving defines whether the mesh can have shadows cast upon its own surface. To enable these features, select each mesh to cast and/or receive shadows and, from the <span class="strong"><strong>Mesh Renderer</strong></span> component in the object <span class="strong"><strong>Inspector</strong></span>, enable the <span class="strong"><strong>Receive Shadows</strong></span> checkbox. In addition, set <span class="strong"><strong>Cast Shadows</strong></span> to <span class="strong"><strong>On</strong></span>.</p><p>
</p><div class="mediaobject"><img src="/graphics/9781785880742/graphics/image_02_054.jpg" /></div><p>
</p><p>Enabling shadow casting and receiving for meshes</p><p>Finally, from the <span class="strong"><strong>QualitySettings</strong></span> window, ensure shadows are enabled overall, and that your viewport and scene camera are within the <span class="strong"><strong>Shadow Distance</strong></span>. The <span class="strong"><strong>QualitySettings</strong></span> window is displayed by navigating to <span class="strong"><strong>Edit</strong></span> | <span class="strong"><strong>Project Settings</strong></span> | <span class="strong"><strong>Quality</strong></span>. Both values (<span class="strong"><strong>Shadow Casting</strong></span> and <span class="strong"><strong>Shadow Distance</strong></span>) can be controlled from the <span class="strong"><strong>QualitySettings</strong></span> window. Shadows can be enabled and disabled altogether using the <span class="strong"><strong>Shadows</strong></span> drop-down field. A value of <span class="strong"><strong>Hard and Soft Shadows</strong></span> permits all kinds of shadows, while <span class="strong"><strong>None</strong></span> disables any shadows, regardless of light and mesh settings.</p><p>
</p><div class="mediaobject"><img src="/graphics/9781785880742/graphics/image_02_055.jpg" /></div><p>
</p><p>Shadow settings master control</p><p>The <span class="strong"><strong>Shadow Distance</strong></span> field specifies a distance in meters from the camera beyond which any shadow casting or receiving is disabled. Shadows beyond the <span class="strong"><strong>Shadow Distance</strong></span> are not rendered, regardless of other shadow settings. Increasing the <span class="strong"><strong>Shadow Distance</strong></span> brings more shadows into view, at the expense of performance.</p><p>
</p><div class="mediaobject"><img src="/graphics/9781785880742/graphics/image_02_056.jpg" /></div><p>
</p><p>Tweaking Shadow Distance</p></li></ul></div></div>