<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch04lvl1sec37"></a>Creating a WordList class</h2></div></div><hr /></div><p>Now we must build a class to process the word list asset. This involves a class that can open and read the word list itself, select a word at random from the list, and compare two words for a match. The latter is needed to compare the typed word with the selected word from the dictionary. To start with, a new Singleton class<span class="emphasis"><em> </em></span>
<code class="literal">WordList.cs</code> should be created. The basic skeleton follows:</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note29"></a>Note</h3><p>For more information on Singleton objects, see <a class="link" href="#" linkend="ch03">C</a>hapter 3, <span class="emphasis"><em>Player Controls - Movement</em></span>. In addition, you can view the Unity online Wiki here: <a class="ulink" href="http://wiki.unity3d.com/index.php/Singleton" target="_blank">http://wiki.unity3d.com/index.php/Singleton</a>.</p></div><pre class="programlisting">using UnityEngine; &#13;
using System.Collections; &#13;
using System.Collections.Generic; &#13;
//------------------------------------ &#13;
public class WordList : MonoBehaviour &#13;
{ &#13;
   //------------------------------------ &#13;
   //Members for Singleton &#13;
   public static WordList ThisInstance &#13;
   { &#13;
         get &#13;
         { &#13;
               //Get or create singleton instance &#13;
               if (m_WL == null) &#13;
               { &#13;
                     GameObject GO = new GameObject ("WordList"); &#13;
                     ThisInstance = GO.AddComponent&lt;WordList&gt; (); &#13;
               } &#13;
               return m_WL; &#13;
         } &#13;
         set  &#13;
         { &#13;
               //If not null then we already have instance &#13;
               if (m_WL != null)  &#13;
               { &#13;
                     //If different, then remove duplicate immediately &#13;
                     if(m_WL.GetInstanceID() != value.GetInstanceID()) &#13;
                           DestroyImmediate (value.gameObject); &#13;
                     return; &#13;
               } &#13;
               //If new, then create new singleton instance &#13;
               m_WL = value; &#13;
               DontDestroyOnLoad (m_WL.gameObject); &#13;
         } &#13;
   } &#13;
   private static WordList m_WL = null; &#13;
} &#13;
//------------------------------------ &#13;
</pre><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec46"></a>Comments</h3></div></div></div><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>The <code class="literal">WordList</code> class features <code class="literal">Get</code> and <code class="literal">Set</code> properties to control class instantiation, making it a Singleton.</p></li><li style="list-style-type: disc"><p>In addition to being a Singleton, <code class="literal">WordList</code> also calls the <code class="literal">DontDestroyOnLoad</code> function. This prevents the object from being destroyed when the scene ends, allowing it to carry over to the next scene.</p></li><li style="list-style-type: disc"><p>Take care when using <code class="literal">DontDestroyOnLoad</code>, as all child objects and associated texture and mesh resources on the object will also survive and continue to the next scene.</p></li></ul></div><p>The first programmatic step in working with the <code class="literal">WordList</code> is to tokenize the text file. This means we need to generate a complete array of all words in the file; separating the words as distinct units, as opposed to being part of a long string spanning the length of the file. For our word list, each word is separated by a new line. Or rather, there is one word or phrase per line. Each line should therefore become its own entry in the word array. We can achieve the tokenization process simply in the <code class="literal">Awake</code> function.</p><pre class="programlisting">    //------------------------------------ &#13;
    // Use this for initialization &#13;
    <span class="strong"><strong>void</strong></span> Awake ()  &#13;
    { &#13;
        //Set singleton instance &#13;
        ThisInstance = <span class="strong"><strong>this</strong></span>; &#13;
 &#13;
        //Now load word list, if available &#13;
        <span class="strong"><strong>if</strong></span> (FileWordList == <span class="strong"><strong>null</strong></span>) &#13;
            FileWordList = (TextAsset) Resources.Load("WordList"); &#13;
         &#13;
        Words = FileWordList.text.Split (<span class="strong"><strong>new</strong></span>[] { "\r\n" }, System.StringSplitOptions.None); &#13;
     &#13;
    } &#13;
    //------------------------------------ &#13;
</pre></div><div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h3 class="title"><a id="ch04lvl2sec47"></a>Comments</h3></div></div></div><div class="itemizedlist"><ul type="bullet"><li style="list-style-type: disc"><p>Two variables should be added to the class to support the <code class="literal">Awake</code> function: firstly, <code class="literal">FileWordList</code> (declared as <code class="literal">TextAsset FileWordList</code>), which references the Word List text asset, as loaded from the <code class="literal">Resources</code> folder; and, secondly, <code class="literal">Words</code>, which is an array of strings (<code class="literal">string[] Words</code>). This represents the tokenized file (the words from the file separated into unique elements).</p></li><li style="list-style-type: disc"><p>The function <code class="literal">Resources.Load</code> is called to load the text asset resource at runtime from the file, loading the resultant string into <code class="literal">FileWordList</code>.</p></li><li style="list-style-type: disc"><p>After <code class="literal">FileWordList</code> has been created and populated with string data from the word list file, the <code class="literal">Split</code> function is called with the string argument <code class="literal">"\r\n"</code>, indicating that words should be separated by new lines. This returns an array in which each element is a separate word.</p></li></ul></div><p>Next, a random word can be selected from the <code class="literal">Words</code> array by using the <code class="literal">Random.Range</code> function. This function generates a random number between a minimum and a maximum, and this can be passed as an index for the <code class="literal">Words</code> array. Here is a new method for the <code class="literal">WordList</code> class, which selects a random word:</p><pre class="programlisting">    //Returns a random word from the word list &#13;
   <span class="strong"><strong> public string</strong></span> GetRandomWord() &#13;
    { &#13;
        <span class="strong"><strong>return</strong></span> Words[Random.Range(0, Words.Length)].ToLower(); &#13;
    } &#13;
    //------------------------------------  &#13;
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note30"></a>Note</h3><p>All returned words are converted to lower case, if needed, preventing case sensitivity issues disrupting gameplay. You can use a text editor to convert case, but it's useful to safeguard against this in code too. For <span class="emphasis"><em>Dead Keys</em></span>, the player should not have to worry about whether upper or lowercase is used, so either case is acceptable.</p></div></div></div>