<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch02lvl1sec17"></a>Baking lightmaps - resolution and size</h2></div></div><hr /></div><p>Our scene now features marked static objects, complete with Lightmap UVs, and is ready for lightmapping. The default settings for all Unity scenes and projects is not compatible with a full lightmap setup as we require, and so we must access the lighting settings. To do this, display the <span class="strong"><strong>Lighting</strong></span> window by navigating to <span class="strong"><strong>Window</strong></span> | <span class="strong"><strong>Lighting</strong></span> from the application menu. Once opened, dock the free-floating window into the object <span class="strong"><strong>Inspector</strong></span> as a separate tab. This is convenient because we can view the lighting settings and inspect the <span class="strong"><strong>Scene</strong></span> viewport side by side.</p><p>
</p><div class="mediaobject"><img src="/graphics/9781785880742/graphics/image_02_026.jpg" /></div><p>
</p><p>Accessing the Lighting window</p><p>First, let's disable all precomputed GI settings, by removing the check mark from the <span class="strong"><strong>Precomputed Realtime GI</strong></span> rollout in the <span class="strong"><strong>Lighting</strong></span> window. This completely deactivates real-time GI for the scene. In addition, specify the night time skybox (created earlier) for the <span class="strong"><strong>Skybox</strong></span> field. This is important for establishing a base, ambient lighting pervading the scene, even in the darkest and most inaccessible areas. Pixels from the surrounding skybox are projected inward into the scene as minor light sources, which are used for defining the lowest lighting level.</p><p>
</p><div class="mediaobject"><img src="/graphics/9781785880742/graphics/image_02_027.jpg" /></div><p>
</p><p>Deactivating Precomputed Realtime GI and establishing an ambient light source</p><p>Next, I recommend deactivating the <span class="strong"><strong>Auto</strong></span> checkbox, next to the <span class="strong"><strong>Build</strong></span> button as soon as possible. This step is optional. When enabled, Unity continually rebuilds scene lighting automatically, whenever light-relevant changes are detected in the scene (for example, when static objects are moved, light colors change, and so on). This saves us from initiating a build manually, and for simpler scenes it's both quick and effective. But it can slow down the editor speed while building, invalidates scene lighting temporarily, and is associated with some bugs.</p><p>
</p><div class="mediaobject"><img src="/graphics/9781785880742/graphics/image_02_028.jpg" /></div><p>
</p><p>Disabling auto build for lighting</p><p>Now, let's establish texel density for the lightmaps to be generated. This is an important process. For lightmapping to be effective, the surface area of the scene must map the lightmap texture, each face of each static mesh mapping to a unique set of pixels for its lighting information. Unity gives you control over how many pixels in the lightmap texture map to a square unit in the scene. The ratio between pixels to world units is defined by the resolution setting for the baked GI rollout. This defines how one pixel in the lightmap relates to a world unit. Lower values produce smaller and fewer lightmap textures, at the expensive of lightmap quality. Higher values improve quality, but at the expense of texture size. We need to arrive at a balance appropriate for our scene. To start, let's visualize the lightmap density. To do this, change the viewport shading mode to <span class="strong"><strong>Baked</strong></span>. This is achieved via the <span class="strong"><strong>Shading Mode</strong></span> dropdown in the <span class="strong"><strong>Scene</strong></span> tab.</p><p>
</p><div class="mediaobject"><img src="/graphics/9781785880742/graphics/image_02_029.jpg" /></div><p>
</p><p>Enabling baked resolution display</p><p>When baked shading is activated, the <span class="strong"><strong>Scene</strong></span> viewport flood fills a checker pattern across all meshes in the scene. Each square in the pattern represents one pixel in the lightmap. Thus, the scene view expresses how densely packed texture pixels are from the lightmap to the mesh. You can control texel density using the <span class="strong"><strong>Baked </strong></span>
<span class="strong"><strong>Resolution</strong></span> field. Lower values decrease quality, and thus the size of each square increases as fewer pixels are packed onto the mesh.</p><p>
</p><div class="mediaobject"><img src="/graphics/9781785880742/graphics/image_02_030.jpg" /></div><p>
</p><p>Configuring lightmap resolution</p><p>Now, specify an <span class="strong"><strong>Atlas Size.</strong></span> This defines the maximum size in pixels for each square lightmap texture. The number of lightmap textures generated depends on the <span class="strong"><strong>Baked </strong></span>
<span class="strong"><strong>Resolution</strong></span> and <span class="strong"><strong>Atlas Size</strong></span>. If the scene surface area cannot fit into one texture, based on the lightmap resolution, then additional textures are generated. The ideal is to keep lightmap textures as few in number as possible. It's generally better for performance to have one large lightmap than many smaller lightmaps.</p><p>
</p><div class="mediaobject"><img src="/graphics/9781785880742/graphics/image_02_031.jpg" /></div><p>
</p><p>Configuring Atlas Size</p><p>Before tweaking further light-mapping details, let's test the existing settings to see how many lightmaps are generated for the scene. Simply click on the <span class="strong"><strong>Build</strong></span> button, and then repeat this process (while refining <span class="strong"><strong>Baked </strong></span>
<span class="strong"><strong>Resolution</strong></span> and <span class="strong"><strong>Atlas Size</strong></span>) until you arrive at textures sized as needed, avoiding pixel wastage. You can view the generated lightmap textures from the <span class="strong"><strong>Preview</strong></span> pane of the <span class="strong"><strong>Lightmaps</strong></span> tab.</p><p>
</p><div class="mediaobject"><img src="/graphics/9781785880742/graphics/image_02_032.jpg" /></div><p>
</p><p>Previewing generated lightmaps</p><p>The generated lightmap textures themselves also live in the <span class="strong"><strong>Project</strong></span> panel as a texture asset of the project. These are textures marked with the <span class="strong"><strong>Lightmap</strong></span> type from the object <span class="strong"><strong>Inspector</strong></span>. These are found in a subfolder alongside the saved scene asset.</p><p>
</p><div class="mediaobject"><img src="/graphics/9781785880742/graphics/image_02_033.jpg" /></div><p>
</p><p>Lightmaps are generated as texture assets</p><p>You can often identify pixel wastage in a lightmap texture. This happens when your <span class="strong"><strong>Atlas Size</strong></span> is too high and/or <span class="strong"><strong>Baked </strong></span>
<span class="strong"><strong>Resolution</strong></span> is too low, resulting in textures that cannot be filled or maximized with pixels. This leads to redundant pixels, which are not assigned to any meshes. You'll want to avoid this. Aim to fill lightmaps as much as possible. This gives you the best quality attainable for your settings.</p><p>
</p><div class="mediaobject"><img src="/graphics/9781785880742/graphics/image_02_034.jpg" /></div><p>
</p><p>Tweaking lightmap size</p></div>