<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch02lvl1sec25"></a>Music and audio</h2></div></div><hr /></div><p>To complete basic level configuration and structure, let's add music. Specifically, the main background music, which should play continuously throughout the level. In the previous chapter, we imported audio assets, both music and sound effects, and configured these optimally. As discussed previously, it is most important that music is configured for <span class="strong"><strong>Streaming </strong></span>as the <span class="strong"><strong>Load Type</strong></span>, and the <span class="strong"><strong>Compression Format</strong></span> should be set to <span class="strong"><strong>Vorbis</strong></span>. This ensures that Unity doesn't load the complete track into memory, which would be performance prohibitive, especially for mobile devices and legacy hardware.</p><p>
</p><div class="mediaobject"><img src="/graphics/9781785880742/graphics/image_02_083.jpg" /></div><p>
</p><p>Configuring music audio</p><p>In addition to importing music assets, let's create an Audio Mixer asset. This is optional in theory, as Unity can play audio without a mixer. But mixers give you more control over different audio types and their independent volumes and balance (SFX, music, voice, and more). To create an Audio Mixer asset, right-click inside the <span class="strong"><strong>Project</strong></span> panel and navigate to <span class="strong"><strong>Create</strong></span> | <span class="strong"><strong>AudioMixer</strong></span> from the context menu. As with all assets, this should be contained in an appropriately named folder.</p><p>
</p><div class="mediaobject"><img src="/graphics/9781785880742/graphics/image_02_084.jpg" /></div><p>
</p><p>Creating an Audio Mixer asset</p><p>By double-clicking on the <span class="strong"><strong>Audio Mixer</strong></span> asset from the <span class="strong"><strong>Project</strong></span> panel, it'll open automatically in the <span class="strong"><strong>Audio Mixer</strong></span> window, which can also be shown by navigating to <span class="strong"><strong>Window</strong></span> | <span class="strong"><strong>Audio Mixer</strong></span> from the application menu. By default, the Audio Mixer is created with a <span class="strong"><strong>Master</strong></span> group, which controls the volume for all audio (hence, the name <span class="strong"><strong>Master</strong></span>). This is displayed in the Audio Mixer as both a visual controller, and a named listed in the <span class="strong"><strong>Groups h</strong></span>ierarchy.</p><p>
</p><div class="mediaobject"><img src="/graphics/9781785880742/graphics/image_02_085.jpg" /></div><p>
</p><p>A new Audio Mixer</p><p>In addition to the <span class="strong"><strong>Master</strong></span> volume group, we want independent control over the volume for music, sound effects, and voice, as appropriate. This lets us balance volume levels to arrive at a harmonious soundtrack. To achieve this, right-click on the <span class="strong"><strong>Master</strong></span> group from the hierarchy and choose <span class="strong"><strong>Add child group</strong></span>. Repeat this process to create three child groups, and then rename them <span class="strong"><strong>Music</strong></span>, <span class="strong"><strong>SFX, </strong></span>and <span class="strong"><strong>Voice</strong></span>.</p><p>
</p><div class="mediaobject"><img src="/graphics/9781785880742/graphics/image_02_086.jpg" /></div><p>
</p><p>Adding child groups; Music, SFX and Voice</p><p>Because the <span class="strong"><strong>Music</strong></span>, <span class="strong"><strong>SFX,</strong></span> and <span class="strong"><strong>Voice</strong></span> groups are children of the <span class="strong"><strong>Master</strong></span> group, their volume is dependent. That is, volume changes in SFX, music, or voice does not change the master volume, but the master volume cascades downwards to child groups. Having now configured the Audio Mixer in this way, we can now route scene audio through a specific group to have high-level control over its volume. Select the root object in the scene (topmost object), and drag and drop the music asset on to it from the <span class="strong"><strong>Project</strong></span> panel. This creates an Audio Source component automatically on the root object, wired to the music track. Alternatively, you can select the root object and navigate to <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>Audio</strong></span> | <span class="strong"><strong>Audio Source</strong></span> from the application menu to add an Audio Source Component. Once added, you should drag and drop the music track from the <span class="strong"><strong>Project</strong></span> panel into the <span class="strong"><strong>AudioClip</strong></span> slot to assign the track to the component.</p><p>
</p><div class="mediaobject"><img src="/graphics/9781785880742/graphics/image_02_087.jpg" /></div><p>
</p><p>Assigning a music track to the Audio Source component</p><p>The <span class="strong"><strong>Audio Source</strong></span> component features an <span class="strong"><strong>Output</strong></span> field, defining the mixer group to which the audio should be routed. For the music track, this should route to the <span class="strong"><strong>Music</strong></span> child group of the <span class="strong"><strong>Master</strong></span> group. To choose this, simply click on the <span class="strong"><strong>Group Selection</strong></span> button in the object <span class="strong"><strong>Inspector</strong></span>, and then choose the appropriate group.</p><p>
</p><div class="mediaobject"><img src="/graphics/9781785880742/graphics/image_02_088.jpg" /></div><p>
</p><p>Selecting an Output group</p><p>The <span class="strong"><strong>Audio Source</strong></span> component for the music track is almost configured. The music should play as the scene begins and it should play endlessly on a loop. This behavior can be created in code, but we can simply enable the <span class="strong"><strong>Play on Awake</strong></span> and <span class="strong"><strong>Loop</strong></span> checkboxes, from the <span class="strong"><strong>Audio Source</strong></span> component.</p><p>
</p><div class="mediaobject"><img src="/graphics/9781785880742/graphics/image_02_089.jpg" /></div><p>
</p><p>Enabling Play on Awake and Loop</p><p>In addition, the music track should be a 2D type of audio; that is, its volume and speaker-pan is unrelated to player position: the music should play at a consistent volume regardless of player movement. To achieve this, ensure the <span class="strong"><strong>Spatial Blend </strong></span>of the <span class="strong"><strong>Audio Source</strong></span> component is set to <span class="strong"><strong>2D</strong></span>.</p><p>
</p><div class="mediaobject"><img src="/graphics/9781785880742/graphics/image_02_090.jpg" /></div><p>
</p><p>Setting Spatial Blend to 2D</p><p>The <span class="strong"><strong>Audio Source</strong></span> component for the music track is now configured. To hear audio, however, the scene should have one and only one <span class="strong"><strong>Audio Listener</strong></span> component. This is typically attached to the player camera, representing the player ears. Select the player camera, and then navigate to <span class="strong"><strong>Component</strong></span> | <span class="strong"><strong>Audio</strong></span> | <span class="strong"><strong>Audio Listener</strong></span> to attach a listener to the camera, if not present already. That's it! You can now test out the level, complete with music.</p><p>
</p><div class="mediaobject"><img src="/graphics/9781785880742/graphics/image_02_091.jpg" /></div><p>
</p><p>Adding an Audio Listener to the Scene</p></div>