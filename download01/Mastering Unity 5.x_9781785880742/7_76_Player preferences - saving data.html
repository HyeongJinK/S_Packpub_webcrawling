<div class="section" lang="en" xml:lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a id="ch07lvl1sec74"></a>Player preferences - saving data</h2></div></div><hr /></div><p>For <span class="emphasis"><em>Dead Keys</em></span>, the player progresses through a sequence of levels, one after another. On reaching the end of one level, the next begins. As the player moves from level to level, their progress should be saved, so the most recent player can easily resume their progress from the highest attained level on their next play session. To achieve this, we need to use only the <code class="literal">PlayerPrefs</code> class for storing the highest attained level. Progress cannot be resumed within a level. That is, the player may resume play from the highest attained level, but always from the beginning of that level.</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note48"></a>Note</h3><p>As we'll see later in this chapter, the <code class="literal">PlayerPrefs</code> class is all we'll need for saving and loading user data in <span class="emphasis"><em>Dead Keys</em></span>. This makes our persistent data needs very simple. Nevertheless, we'll cover a range of data storage solutions here, for games of all sizes, both small and large.</p></div><p>
</p><div class="mediaobject"><img src="/graphics/9781785880742/graphics/image_07_002.jpg" /></div><p>
</p><p>Preparing to save data for Dead Keys</p><p>Before saving data with <code class="literal">PlayerPrefs</code>, you should specify the title and company name for your project from the <span class="strong"><strong>Project Settings</strong></span> window, as these settings determine how and where the <code class="literal">PlayerPrefs</code> data is stored on the user's computer. To access <span class="strong"><strong>Project Settings</strong></span>, select <span class="strong"><strong>Edit </strong></span>|<span class="strong"><strong> Project Settings </strong></span>|<span class="strong"><strong> Player</strong></span> from the application menu:</p><p>
</p><div class="mediaobject"><img src="/graphics/9781785880742/graphics/image_07_003.jpg" /></div><p>
</p><p>Accessing Project Settings</p><p>Next, enter a title for the project, and a <span class="strong"><strong>Company Name</strong></span>. Here, I've used <code class="literal">Dead Keys</code> as the <span class="strong"><strong>Product Name</strong></span>, and <code class="literal">Packt Publishing</code> as the <span class="strong"><strong>Company Name</strong></span>:</p><p>
</p><div class="mediaobject"><img src="/graphics/9781785880742/graphics/image_07_004.jpg" /></div><p>
</p><p>Entering a Product Name and Company Name</p><p>The <code class="literal">PlayerPrefs</code> class can ultimately save three different kinds of data, namely <span class="emphasis"><em>integers </em></span>(for example: high score), <span class="emphasis"><em>floating point</em></span> numbers (for example: volume and fastest time), and <span class="emphasis"><em>strings </em></span>(for example: player name); and thereby any data derived from these types (for example, a <span class="emphasis"><em>Boolean</em></span> can be converted to a 1 and 0 integer). The class offers three static functions to save this data; <code class="literal">SetInt</code>, <code class="literal">SetFloat</code>, and <code class="literal">SetString</code> respectively, and these can be called anywhere in your script files. Consider the following sample:</p><pre class="programlisting">PlayerPrefs.SetInt("PlayerScore", 999785); 
PlayerPrefs.SetFloat("RemainingTime", 5.5f); 
PlayerPrefs.SetString("PlayerName", "Jon Doe"); 
</pre><p>Each Set function accepts two parameters forming a <span class="strong"><strong>key-value pair</strong></span>; the <span class="strong"><strong>user-defined name</strong></span> of the value to set (for example: <code class="literal">PlayerScore</code>, <code class="literal">RemainingTime</code>, and so on), and the value itself to save. The key should be unique for the application and, is used by the Get functions to retrieve the specified value (discussed later).</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title"><a id="note49"></a>Note</h3><p>More information on the <code class="literal">PlayerPrefs</code> class can be found online here: <a class="ulink" href="https://docs.unity3d.com/ScriptReference/PlayerPrefs.html" target="_blank">https://docs.unity3d.com/ScriptReference/PlayerPrefs.html</a>.</p></div><p>One important question that arises regarding the Set functions for <code class="literal">PlayerPrefs</code>, is about where on the user's computer is the, saved data stored. This varies depending on the operating system. For Windows computers, all data is stored in the Windows registry as separate keys. To access the registry, access the Start menu, and run the <code class="literal">RegEdit</code> command. Next, the Window's <span class="strong"><strong>Registry Editor </strong></span>appears, displaying all system keys and settings. Remember; editing or changing any keys in the registry can cause your computer and software to stop working properly, so be careful!</p><p>
</p><div class="mediaobject"><img src="/graphics/9781785880742/graphics/image_07_005.jpg" /></div><p>
</p><p>Windows Registry Editor</p><p>You can find Unity application settings under the <code class="literal">HKCU</code>
<span class="strong"><strong> </strong></span>| <code class="literal">Software</code>
<span class="strong"><strong> </strong></span>| <code class="literal">[company name]</code> | <code class="literal">[product name]</code> key. The <span class="strong"><strong>Company Name</strong></span> and <span class="strong"><strong>Product Name</strong></span> fields should be substituted for the values specified in the <span class="strong"><strong>Project Settings</strong></span>, as mentioned previously. Here, all applications will save their values. These can be edited directly from the <span class="strong"><strong>Registry Editor</strong></span>, but this is not recommended. Nevertheless, knowing how to find and access the settings can be useful for verifying and debugging your application; making sure the right values are being saved.</p><p>On a Mac computer, all settings can be accessed from Mac Finder, by navigating to <code class="literal">Library/Preferences/ unity.[company name].[product name].plist</code>.</p><p>
</p><div class="mediaobject"><img src="/graphics/9781785880742/graphics/image_07_006.jpg" /></div><p>
</p><p>Accessing PList files</p><p>The Unity setting files contain all preferences in a human-readable, text-based XML format. Like the registry settings, this file can be edited, but this is not recommended.</p><p>
</p><div class="mediaobject"><img src="/graphics/9781785880742/graphics/image_07_007.jpg" /></div><p>
</p><p>Viewing PList Files generated by PlayerPrefs</p><p>For other platforms, such as web and mobile, the storage location for <code class="literal">PlayerPrefs</code> varies widely. Further information on platform specifics can be found online at: <a class="ulink" href="https://docs.unity3d.com/ScriptReference/PlayerPrefs.html" target="_blank">https://docs.unity3d.com/ScriptReference/PlayerPrefs.html</a>.</p><p>The <code class="literal">PlayerPrefs</code> Set functions (<code class="literal">SetInt</code>, <code class="literal">SetFloat</code>, and <code class="literal">SetString</code>) are buffered; that is, the data is not actually committed to the computer until the application terminates. However, if you need the changes committed earlier than application exit, or to protect against a crash or failure, you should additionally call the <code class="literal">Save</code> function once after having called all Set functions. The <code class="literal">Save</code> function requires no arguments and returns no value; it simply commits all the set changes. More information on save can be found online at: <a class="ulink" href="https://docs.unity3d.com/ScriptReference/PlayerPrefs.Save.html" target="_blank">https://docs.unity3d.com/ScriptReference/PlayerPrefs.Save.html</a>.</p></div>